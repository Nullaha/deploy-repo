const __vite__fileDeps=["assets/request-CeWTyDSt.js","assets/index-DYYch56J.js","assets/index-DBlYAhtB.css","assets/IdentityManager-B6sYbOo2.js","assets/substitute-lwb4ISFZ.js","assets/pe-wasm-T9WQDCoc.js","assets/WhereClause-1rTnJQ4s.js","assets/TimeOnly-V9OLRT9L.js","assets/arcadeUtils-CIqWElA3.js","assets/ImmutableArray-BlMso3qf.js","assets/number-BIHvJcF0.js","assets/ElevationLayer-45tsquUZ.js","assets/webStyleSymbolUtils-CndX2Vh9.js","assets/devEnvironmentUtils-Blrp8lZ5.js","assets/portalLayers-DknmRNeC.js","assets/associatedFeatureServiceUtils-CPuAxZB0.js","assets/lazyLayerLoader-7F4NYwDv.js","assets/arcgisLayers-BcberGB7.js","assets/fetchService-DIHNUVwt.js","assets/resourceUtils-DEdV2Y-p.js","assets/geometryEngineBase-C4ZooLoZ.js","assets/hydrated-Djyd9-Vo.js","assets/layersLoader-CzXktpVX.js","assets/layersCreator-rNfBQ72y.js","assets/geometryEngineJSON-CV8iFHkT.js","assets/json-Wa8cmqdu.js","assets/meshFeatureSet-DIdKElin.js","assets/Mesh-DEMk44c-.js","assets/georeference-CIA9Lx4g.js","assets/mat3f64-q3fE-ZOt.js","assets/mat4f64-CSKppSlJ.js","assets/computeTranslationToOriginAndRotation-A1Q7mVK2.js","assets/DoubleArray-CXRBPZYE.js","assets/quat-BVBVTVLY.js","assets/quatf64-Bdb9ZJJK.js","assets/meshVertexSpaceUtils-gfxGPZvF.js","assets/MeshLocalVertexSpace-DM8AJSiV.js","assets/vec3-DqmlWCPL.js","assets/BufferView-BAKTu1Mt.js","assets/imageUtils-CyepRnNr.js","assets/earcut-nF7_mg1s.js","assets/Indices-BSAYzPpM.js","assets/deduplicate-DPIpc6Ol.js","assets/plane-B3YjWyMT.js","assets/triangle-BnRLSSkm.js","assets/Util-BXtGPyQa.js","assets/ObjectStack-DNcrsVuJ.js","assets/lineSegment-DdlROsEZ.js","assets/basicInterfaces-GbxEOYtk.js","assets/VertexAttribute-BlT9lbVY.js","assets/External-DUwmGT1t.js","assets/executeRelationshipQuery-rvs1Cc5o.js","assets/queryAttachments-BEzdvnih.js","assets/executeTopFeaturesQuery-BlIyaEvu.js","assets/queryTopFeatures-CACVZ6sn.js","assets/executeForTopIds-CtTSUbVA.js","assets/executeForTopExtents-D8r4cz5J.js","assets/executeForTopCount-DpkFVqtA.js","assets/symbolLayerUtils-TGiNYFCd.js","assets/statsWorker-t12DKlSD.js","assets/utils-v-KWhYiJ.js","assets/utils-B0B_ys8h.js","assets/utils-DmghkaOY.js","assets/geometryEngineWorker-CeqyRjm2.js","assets/CSVSourceWorker-BDcemc1A.js","assets/date-M6n_RqpC.js","assets/FeatureStore-DOP554KC.js","assets/BoundsStore-dZ6zWSSE.js","assets/PooledRBush-C96k3EJs.js","assets/timeSupport-D5x1kd1_.js","assets/QueryEngine-Ci_j4sOW.js","assets/QueryEngineCapabilities-CTDe3LlQ.js","assets/RenderState-DaVlEYWY.js","assets/clientSideDefaults--0T84vnV.js","assets/EdgeProcessingWorker-CRpTw9C3.js","assets/InterleavedLayout-CJfFhdG-.js","assets/types-D0PSWh4d.js","assets/edgeProcessing-Zr0ZqLpv.js","assets/ElevationSamplerWorker-BJHgkcWr.js","assets/FeatureServiceSnappingSourceWorker-DKuB2Q-Y.js","assets/GeoJSONSourceWorker-BMZf54CP.js","assets/geojson-oPY1mgCI.js","assets/sourceUtils-n5nvE7u9.js","assets/LercWorker-jtITdcrm.js","assets/MemorySourceWorker-Dy4fcUCF.js","assets/objectIdUtils-4dd1rf9p.js","assets/PBFDecoderWorker-C8M1O-OO.js","assets/FeaturePipelineWorker-BCLzSqX1.js","assets/AttributeStore-HIum4cRi.js","assets/LabelMetric-DSa658FL.js","assets/Texture-Bqx2wzNM.js","assets/Program-DdVPCDRH.js","assets/UpdateTracking2D-BscP2HzM.js","assets/TurboLine-C_sxAU6s.js","assets/Rect-CUzevAry.js","assets/BindType-BmZEZMMh.js","assets/highlightReasons-yoxTPAvW.js","assets/constants-D5zmR9t2.js","assets/tileUtils-B7X19rIS.js","assets/geohashUtils-CdyiZUGD.js","assets/ogcFeatureUtils-UeM8gHL_.js","assets/CircularArray-DfLrgW_-.js","assets/createConnection-CMJgZe2S.js","assets/PointCloudWorker-tZhDBN1E.js","assets/vec3f32-nZdmKIgz.js","assets/PointCloudUniqueValueRenderer-BtEXwMh1.js","assets/I3SBinaryReader-DhrJz6r2.js","assets/orientedBoundingBox-v9JcvP2d.js","assets/RasterWorker-B3Zh4kd5.js","assets/utils-DX0gziL-.js","assets/rasterProjectionHelper-fSuwT3_P.js","assets/SceneLayerSnappingSourceWorker-hk4e4a5p.js","assets/sphere-Bgt0cWrU.js","assets/SceneLayerWorker-DOsJnpET.js","assets/I3SUtil-CNAXibyb.js","assets/symbolColorUtils-DGnjATJ0.js","assets/WFSSourceWorker-C4ivB2kg.js","assets/wfsUtils-DrFzwUOF.js","assets/WorkerTileHandler-B1-h0y2S.js","assets/config-MDUrh2eL.js","assets/SourceLayerData-Chenf8rT.js","assets/Lyr3DWorker-hft2iKT0.js","assets/lerc-wasm-0qWN9Wav.js","assets/imageryUtils-GMZjiKLG.js","assets/utils-BECud561.js","assets/originUtils-D69mHv66.js","assets/multiOriginJSONSupportUtils-C0wm8_Yw.js","assets/saveAPIKeyUtils-zymrccA1.js","assets/saveUtils-B9iFyYfu.js","assets/deleteForwardEdits-DZhSgQpc.js","assets/DeleteForwardEditsParameters-CTDhZVo-.js","assets/editingSupport-ChjpwLAv.js","assets/featureLayerUtils-BWRzCnP0.js","assets/FeatureLayerSource-BWltbyo2.js","assets/ElevationQuery-DRKv2UOr.js","assets/Popup-3dHL6NAG.js","assets/geometryServiceUtils-BLCEGd90.js","assets/project-BqJ7-7u0.js","assets/webglDeps-H7qwN1d1.js","assets/NestedMap-DgiGbX8E.js","assets/ProgramTemplate-B21HR47A.js","assets/mapViewDeps-CsV0qR1C.js","assets/SDFHelper--jC7Ic1j.js","assets/floatRGBA-BLP3oShN.js","assets/Container-C0UeY4Z5.js","assets/WGLContainer-CH4IpOoI.js","assets/MagnifierPrograms-CSY7-a3Q.js","assets/testSVGPremultipliedAlpha-B8LduPOi.js","assets/RenderingContext-DJl7Zk_P.js","assets/OrderIndependentTransparency-kKykURw3.js","assets/doublePrecisionUtils-B0owpBza.js","assets/rasterizingUtils-DnyjA-w-.js","assets/utils-CAEo7f8i.js","assets/FeatureCommandQueue-D7O2ocr-.js","assets/GraphicsView2D-BbuaEo9k.js","assets/normalizeUtilsSync-D_jkmj1o.js","assets/GraphicContainer-MZgSZroS.js","assets/AGraphicContainer-DsYK9cId.js","assets/TechniqueInstance-CPiPeQs2.js","assets/TileContainer-CzOVDmSh.js","assets/requestImageUtils-CHVtAaTh.js","assets/TileLayerView2D-C8D50RNM.js","assets/imageUtils-CmlgQk0A.js","assets/Bitmap-D3N2Gnyo.js","assets/LayerView-BwebqHvx.js","assets/HighlightGraphicContainer-CzDZHijn.js","assets/RefreshableLayerView-CLbXWWvP.js","assets/drapedUtils-ne_5QDz9.js","assets/popupUtils-Cwi138ED.js","assets/FeatureLayerView2D-K0WWBk9y.js","assets/HighlightCounter-s6PNUJnS.js","assets/BaseDynamicLayerView2D-CxLhJZl1.js","assets/BitmapContainer-DLkQvKOE.js","assets/ExportStrategy-iqALDboI.js","assets/CatalogLayerView2D-B7PhCfQ9.js","assets/CatalogDynamicGroupLayerView2D-DICMrhPJ.js","assets/CatalogFootprintLayerView2D-CsP9liPJ.js","assets/GeoRSSLayerView2D-CRUyVzqp.js","assets/GraphicsLayerView2D-DuIQ8Amz.js","assets/GroupLayerView2D-Bby6bPiL.js","assets/ImageryLayerView2D-CmFjuQSK.js","assets/RasterVFDisplayObject-CN4twTHu.js","assets/ImageryTileLayerView2D-DoDTuPai.js","assets/rasterUtils-C6HrvHnx.js","assets/RawBlockCache-CVW7tWGy.js","assets/KMLLayerView2D-okK7_Ztw.js","assets/kmlUtils-ny1DDWFB.js","assets/KnowledgeGraphLayerView2D-CTYgxsoW.js","assets/MapImageLayerView2D-BclaJFse.js","assets/MapNotesLayerView2D-B6AmjgR-.js","assets/MediaLayerView2D-UINaZJf3.js","assets/perspectiveUtils-B2D2F9mb.js","assets/OGCFeatureLayerView2D-DxiFKoVe.js","assets/RouteLayerView2D-hlC6JWk_.js","assets/Stop-CLSERLv_.js","assets/StreamLayerView2D-DIkpqXHC.js","assets/SubtypeGroupLayerView2D-BK4w-XM2.js","assets/VectorTileLayerView2D-GSnaL1w6.js","assets/VideoLayerView2D-C9mfIPEn.js","assets/GraphicsLayer-qvEfIj5O.js","assets/WMSLayerView2D-DVY3MsXi.js","assets/WMTSLayerView2D-D4G91Is-.js","assets/calcite-button-CJHVCedX.js","assets/form-BWhghC-s.js","assets/dom-DUJaLYyf.js","assets/guid-0nyEKVNn.js","assets/interactive-Dwd-mL7g.js","assets/label2-BtknhHYu.js","assets/component-C5vxrpq2.js","assets/loadable-w90WwvuI.js","assets/t9n-C1rDC-Oz.js","assets/observers-CdhsNXAK.js","assets/icon-DvZhNyxp.js","assets/loader-DvEMzCn9.js","assets/calcite-icon-ChWXkwhD.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{H as k0,J as _oe,t as Av,s as Kt,b as B,h as Me,o as En,R as Soe,K as oO,c as xoe,z as NN,L as Toe,M as iV,a as aO,q as Qn,_ as ge,N as Ioe,m as Moe,U as $oe,E as Eoe,O as Aoe,j as Roe,P as Coe,Q as nV,n as sV,S as Ooe,T as Poe,V as Lp,W as Rv,X as Ot,Y as Cv,Z as Zt,f as La,g as kp,$ as ut,a0 as ir,a1 as jd,a2 as Ud,i as gr,a3 as oV,a4 as mS,e as Um,a5 as DN,d as FN,a6 as lO,a7 as gS,a8 as dm,a9 as uO,aa as cO,ab as pO,ac as Loe,ad as koe,ae as Noe,af as jN}from"./index-DYYch56J.js";var vS={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */vS.exports;(function(e,t){(function(){var r,i="4.17.21",n=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",o="Expected a function",a="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",c=500,h="__lodash_placeholder__",d=1,y=2,v=4,w=1,b=2,_=1,x=2,T=4,I=8,M=16,$=32,A=64,R=128,L=256,C=512,U=30,F="...",j=800,q=16,K=1,X=2,ne=3,re=1/0,ae=9007199254740991,he=17976931348623157e292,de=NaN,fe=4294967295,Se=fe-1,Ee=fe>>>1,Fe=[["ary",R],["bind",_],["bindKey",x],["curry",I],["curryRight",M],["flip",C],["partial",$],["partialRight",A],["rearg",L]],ht="[object Arguments]",Lt="[object Array]",Nt="[object AsyncFunction]",Ir="[object Boolean]",st="[object Date]",St="[object DOMException]",ei="[object Error]",rn="[object Function]",Dt="[object GeneratorFunction]",yi="[object Map]",On="[object Number]",nn="[object Null]",mi="[object Object]",Dl="[object Promise]",Qu="[object Proxy]",Gi="[object RegExp]",Ri="[object Set]",Pn="[object String]",Re="[object Symbol]",ot="[object Undefined]",bt="[object WeakMap]",Dr="[object WeakSet]",Vt="[object ArrayBuffer]",ti="[object DataView]",Mr="[object Float32Array]",ri="[object Float64Array]",eh="[object Int8Array]",c0="[object Int16Array]",p0="[object Int32Array]",h0="[object Uint8Array]",d0="[object Uint8ClampedArray]",f0="[object Uint16Array]",y0="[object Uint32Array]",nI=/\b__p \+= '';/g,sI=/\b(__p \+=) '' \+/g,oI=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bw=/&(?:amp|lt|gt|quot|#39);/g,_w=/[&<>"']/g,aI=RegExp(bw.source),lI=RegExp(_w.source),uI=/<%-([\s\S]+?)%>/g,cI=/<%([\s\S]+?)%>/g,Sw=/<%=([\s\S]+?)%>/g,pI=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,hI=/^\w*$/,dI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m0=/[\\^$.*+?()[\]{}|]/g,fI=RegExp(m0.source),ee=/^\s+/,sr=/\s/,Mf=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ao=/\{\n\/\* \[wrapped with (.+)\] \*/,g0=/,? & /,ke=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,$f=/[()=,{}\[\]\/\s]/,ii=/\\(\\)?/g,th=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,xw=/\w*$/,zo=/^[-+]0x[0-9a-f]+$/i,Tw=/^0b[01]+$/i,Iw=/^\[object .+?Constructor\]$/,tt=/^0o[0-7]+$/i,yI=/^(?:0|[1-9]\d*)$/,Mw=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ef=/($^)/,mI=/['\n\r\u2028\u2029\\]/g,ec="\\ud800-\\udfff",gI="\\u0300-\\u036f",v0="\\ufe20-\\ufe2f",ni="\\u20d0-\\u20ff",$w=gI+v0+ni,w0="\\u2700-\\u27bf",Ew="a-z\\xdf-\\xf6\\xf8-\\xff",vI="\\xac\\xb1\\xd7\\xf7",wI="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",bI="\\u2000-\\u206f",_I=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ln="A-Z\\xc0-\\xd6\\xd8-\\xde",Aw="\\ufe0e\\ufe0f",Rw=vI+wI+bI+_I,V="['’]",le="["+ec+"]",ye="["+Rw+"]",rt="["+$w+"]",$r="\\d+",Qt="["+w0+"]",kn="["+Ew+"]",rh="[^"+ec+Rw+$r+w0+Ew+Ln+"]",SI="\\ud83c[\\udffb-\\udfff]",xQ="(?:"+rt+"|"+SI+")",_L="[^"+ec+"]",xI="(?:\\ud83c[\\udde6-\\uddff]){2}",TI="[\\ud800-\\udbff][\\udc00-\\udfff]",Af="["+Ln+"]",SL="\\u200d",xL="(?:"+kn+"|"+rh+")",TQ="(?:"+Af+"|"+rh+")",TL="(?:"+V+"(?:d|ll|m|re|s|t|ve))?",IL="(?:"+V+"(?:D|LL|M|RE|S|T|VE))?",ML=xQ+"?",$L="["+Aw+"]?",IQ="(?:"+SL+"(?:"+[_L,xI,TI].join("|")+")"+$L+ML+")*",MQ="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",$Q="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",EL=$L+ML+IQ,EQ="(?:"+[Qt,xI,TI].join("|")+")"+EL,AQ="(?:"+[_L+rt+"?",rt,xI,TI,le].join("|")+")",RQ=RegExp(V,"g"),CQ=RegExp(rt,"g"),II=RegExp(SI+"(?="+SI+")|"+AQ+EL,"g"),OQ=RegExp([Af+"?"+kn+"+"+TL+"(?="+[ye,Af,"$"].join("|")+")",TQ+"+"+IL+"(?="+[ye,Af+xL,"$"].join("|")+")",Af+"?"+xL+"+"+TL,Af+"+"+IL,$Q,MQ,$r,EQ].join("|"),"g"),PQ=RegExp("["+SL+ec+$w+Aw+"]"),LQ=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,kQ=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],NQ=-1,hr={};hr[Mr]=hr[ri]=hr[eh]=hr[c0]=hr[p0]=hr[h0]=hr[d0]=hr[f0]=hr[y0]=!0,hr[ht]=hr[Lt]=hr[Vt]=hr[Ir]=hr[ti]=hr[st]=hr[ei]=hr[rn]=hr[yi]=hr[On]=hr[mi]=hr[Gi]=hr[Ri]=hr[Pn]=hr[bt]=!1;var or={};or[ht]=or[Lt]=or[Vt]=or[ti]=or[Ir]=or[st]=or[Mr]=or[ri]=or[eh]=or[c0]=or[p0]=or[yi]=or[On]=or[mi]=or[Gi]=or[Ri]=or[Pn]=or[Re]=or[h0]=or[d0]=or[f0]=or[y0]=!0,or[ei]=or[rn]=or[bt]=!1;var DQ={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},FQ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},jQ={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},UQ={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},VQ=parseFloat,GQ=parseInt,AL=typeof k0=="object"&&k0&&k0.Object===Object&&k0,BQ=typeof self=="object"&&self&&self.Object===Object&&self,Bi=AL||BQ||Function("return this")(),MI=t&&!t.nodeType&&t,ih=MI&&!0&&e&&!e.nodeType&&e,RL=ih&&ih.exports===MI,$I=RL&&AL.process,lo=function(){try{var Z=ih&&ih.require&&ih.require("util").types;return Z||$I&&$I.binding&&$I.binding("util")}catch{}}(),CL=lo&&lo.isArrayBuffer,OL=lo&&lo.isDate,PL=lo&&lo.isMap,LL=lo&&lo.isRegExp,kL=lo&&lo.isSet,NL=lo&&lo.isTypedArray;function Is(Z,ue,ie){switch(ie.length){case 0:return Z.call(ue);case 1:return Z.call(ue,ie[0]);case 2:return Z.call(ue,ie[0],ie[1]);case 3:return Z.call(ue,ie[0],ie[1],ie[2])}return Z.apply(ue,ie)}function zQ(Z,ue,ie,Oe){for(var at=-1,Ft=Z==null?0:Z.length;++at<Ft;){var gi=Z[at];ue(Oe,gi,ie(gi),Z)}return Oe}function uo(Z,ue){for(var ie=-1,Oe=Z==null?0:Z.length;++ie<Oe&&ue(Z[ie],ie,Z)!==!1;);return Z}function qQ(Z,ue){for(var ie=Z==null?0:Z.length;ie--&&ue(Z[ie],ie,Z)!==!1;);return Z}function DL(Z,ue){for(var ie=-1,Oe=Z==null?0:Z.length;++ie<Oe;)if(!ue(Z[ie],ie,Z))return!1;return!0}function tc(Z,ue){for(var ie=-1,Oe=Z==null?0:Z.length,at=0,Ft=[];++ie<Oe;){var gi=Z[ie];ue(gi,ie,Z)&&(Ft[at++]=gi)}return Ft}function Cw(Z,ue){var ie=Z==null?0:Z.length;return!!ie&&Rf(Z,ue,0)>-1}function EI(Z,ue,ie){for(var Oe=-1,at=Z==null?0:Z.length;++Oe<at;)if(ie(ue,Z[Oe]))return!0;return!1}function vr(Z,ue){for(var ie=-1,Oe=Z==null?0:Z.length,at=Array(Oe);++ie<Oe;)at[ie]=ue(Z[ie],ie,Z);return at}function rc(Z,ue){for(var ie=-1,Oe=ue.length,at=Z.length;++ie<Oe;)Z[at+ie]=ue[ie];return Z}function AI(Z,ue,ie,Oe){var at=-1,Ft=Z==null?0:Z.length;for(Oe&&Ft&&(ie=Z[++at]);++at<Ft;)ie=ue(ie,Z[at],at,Z);return ie}function HQ(Z,ue,ie,Oe){var at=Z==null?0:Z.length;for(Oe&&at&&(ie=Z[--at]);at--;)ie=ue(ie,Z[at],at,Z);return ie}function RI(Z,ue){for(var ie=-1,Oe=Z==null?0:Z.length;++ie<Oe;)if(ue(Z[ie],ie,Z))return!0;return!1}var WQ=CI("length");function JQ(Z){return Z.split("")}function ZQ(Z){return Z.match(ke)||[]}function FL(Z,ue,ie){var Oe;return ie(Z,function(at,Ft,gi){if(ue(at,Ft,gi))return Oe=Ft,!1}),Oe}function Ow(Z,ue,ie,Oe){for(var at=Z.length,Ft=ie+(Oe?1:-1);Oe?Ft--:++Ft<at;)if(ue(Z[Ft],Ft,Z))return Ft;return-1}function Rf(Z,ue,ie){return ue===ue?aee(Z,ue,ie):Ow(Z,jL,ie)}function YQ(Z,ue,ie,Oe){for(var at=ie-1,Ft=Z.length;++at<Ft;)if(Oe(Z[at],ue))return at;return-1}function jL(Z){return Z!==Z}function UL(Z,ue){var ie=Z==null?0:Z.length;return ie?PI(Z,ue)/ie:de}function CI(Z){return function(ue){return ue==null?r:ue[Z]}}function OI(Z){return function(ue){return Z==null?r:Z[ue]}}function VL(Z,ue,ie,Oe,at){return at(Z,function(Ft,gi,er){ie=Oe?(Oe=!1,Ft):ue(ie,Ft,gi,er)}),ie}function KQ(Z,ue){var ie=Z.length;for(Z.sort(ue);ie--;)Z[ie]=Z[ie].value;return Z}function PI(Z,ue){for(var ie,Oe=-1,at=Z.length;++Oe<at;){var Ft=ue(Z[Oe]);Ft!==r&&(ie=ie===r?Ft:ie+Ft)}return ie}function LI(Z,ue){for(var ie=-1,Oe=Array(Z);++ie<Z;)Oe[ie]=ue(ie);return Oe}function XQ(Z,ue){return vr(ue,function(ie){return[ie,Z[ie]]})}function GL(Z){return Z&&Z.slice(0,HL(Z)+1).replace(ee,"")}function Ms(Z){return function(ue){return Z(ue)}}function kI(Z,ue){return vr(ue,function(ie){return Z[ie]})}function b0(Z,ue){return Z.has(ue)}function BL(Z,ue){for(var ie=-1,Oe=Z.length;++ie<Oe&&Rf(ue,Z[ie],0)>-1;);return ie}function zL(Z,ue){for(var ie=Z.length;ie--&&Rf(ue,Z[ie],0)>-1;);return ie}function QQ(Z,ue){for(var ie=Z.length,Oe=0;ie--;)Z[ie]===ue&&++Oe;return Oe}var eee=OI(DQ),tee=OI(FQ);function ree(Z){return"\\"+UQ[Z]}function iee(Z,ue){return Z==null?r:Z[ue]}function Cf(Z){return PQ.test(Z)}function nee(Z){return LQ.test(Z)}function see(Z){for(var ue,ie=[];!(ue=Z.next()).done;)ie.push(ue.value);return ie}function NI(Z){var ue=-1,ie=Array(Z.size);return Z.forEach(function(Oe,at){ie[++ue]=[at,Oe]}),ie}function qL(Z,ue){return function(ie){return Z(ue(ie))}}function ic(Z,ue){for(var ie=-1,Oe=Z.length,at=0,Ft=[];++ie<Oe;){var gi=Z[ie];(gi===ue||gi===h)&&(Z[ie]=h,Ft[at++]=ie)}return Ft}function Pw(Z){var ue=-1,ie=Array(Z.size);return Z.forEach(function(Oe){ie[++ue]=Oe}),ie}function oee(Z){var ue=-1,ie=Array(Z.size);return Z.forEach(function(Oe){ie[++ue]=[Oe,Oe]}),ie}function aee(Z,ue,ie){for(var Oe=ie-1,at=Z.length;++Oe<at;)if(Z[Oe]===ue)return Oe;return-1}function lee(Z,ue,ie){for(var Oe=ie+1;Oe--;)if(Z[Oe]===ue)return Oe;return Oe}function Of(Z){return Cf(Z)?cee(Z):WQ(Z)}function qo(Z){return Cf(Z)?pee(Z):JQ(Z)}function HL(Z){for(var ue=Z.length;ue--&&sr.test(Z.charAt(ue)););return ue}var uee=OI(jQ);function cee(Z){for(var ue=II.lastIndex=0;II.test(Z);)++ue;return ue}function pee(Z){return Z.match(II)||[]}function hee(Z){return Z.match(OQ)||[]}var dee=function Z(ue){ue=ue==null?Bi:Pf.defaults(Bi.Object(),ue,Pf.pick(Bi,kQ));var ie=ue.Array,Oe=ue.Date,at=ue.Error,Ft=ue.Function,gi=ue.Math,er=ue.Object,DI=ue.RegExp,fee=ue.String,co=ue.TypeError,Lw=ie.prototype,yee=Ft.prototype,Lf=er.prototype,kw=ue["__core-js_shared__"],Nw=yee.toString,zt=Lf.hasOwnProperty,mee=0,WL=function(){var f=/[^.]+$/.exec(kw&&kw.keys&&kw.keys.IE_PROTO||"");return f?"Symbol(src)_1."+f:""}(),Dw=Lf.toString,gee=Nw.call(er),vee=Bi._,wee=DI("^"+Nw.call(zt).replace(m0,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Fw=RL?ue.Buffer:r,nc=ue.Symbol,jw=ue.Uint8Array,JL=Fw?Fw.allocUnsafe:r,Uw=qL(er.getPrototypeOf,er),ZL=er.create,YL=Lf.propertyIsEnumerable,Vw=Lw.splice,KL=nc?nc.isConcatSpreadable:r,_0=nc?nc.iterator:r,nh=nc?nc.toStringTag:r,Gw=function(){try{var f=uh(er,"defineProperty");return f({},"",{}),f}catch{}}(),bee=ue.clearTimeout!==Bi.clearTimeout&&ue.clearTimeout,_ee=Oe&&Oe.now!==Bi.Date.now&&Oe.now,See=ue.setTimeout!==Bi.setTimeout&&ue.setTimeout,Bw=gi.ceil,zw=gi.floor,FI=er.getOwnPropertySymbols,xee=Fw?Fw.isBuffer:r,XL=ue.isFinite,Tee=Lw.join,Iee=qL(er.keys,er),vi=gi.max,sn=gi.min,Mee=Oe.now,$ee=ue.parseInt,QL=gi.random,Eee=Lw.reverse,jI=uh(ue,"DataView"),S0=uh(ue,"Map"),UI=uh(ue,"Promise"),kf=uh(ue,"Set"),x0=uh(ue,"WeakMap"),T0=uh(er,"create"),qw=x0&&new x0,Nf={},Aee=ch(jI),Ree=ch(S0),Cee=ch(UI),Oee=ch(kf),Pee=ch(x0),Hw=nc?nc.prototype:r,I0=Hw?Hw.valueOf:r,ek=Hw?Hw.toString:r;function N(f){if(Fr(f)&&!ct(f)&&!(f instanceof xt)){if(f instanceof po)return f;if(zt.call(f,"__wrapped__"))return tN(f)}return new po(f)}var Df=function(){function f(){}return function(g){if(!Er(g))return{};if(ZL)return ZL(g);f.prototype=g;var S=new f;return f.prototype=r,S}}();function Ww(){}function po(f,g){this.__wrapped__=f,this.__actions__=[],this.__chain__=!!g,this.__index__=0,this.__values__=r}N.templateSettings={escape:uI,evaluate:cI,interpolate:Sw,variable:"",imports:{_:N}},N.prototype=Ww.prototype,N.prototype.constructor=N,po.prototype=Df(Ww.prototype),po.prototype.constructor=po;function xt(f){this.__wrapped__=f,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=fe,this.__views__=[]}function Lee(){var f=new xt(this.__wrapped__);return f.__actions__=ns(this.__actions__),f.__dir__=this.__dir__,f.__filtered__=this.__filtered__,f.__iteratees__=ns(this.__iteratees__),f.__takeCount__=this.__takeCount__,f.__views__=ns(this.__views__),f}function kee(){if(this.__filtered__){var f=new xt(this);f.__dir__=-1,f.__filtered__=!0}else f=this.clone(),f.__dir__*=-1;return f}function Nee(){var f=this.__wrapped__.value(),g=this.__dir__,S=ct(f),E=g<0,O=S?f.length:0,D=Jte(0,O,this.__views__),G=D.start,H=D.end,Y=H-G,ce=E?H:G-1,pe=this.__iteratees__,me=pe.length,Te=0,Ve=sn(Y,this.__takeCount__);if(!S||!E&&O==Y&&Ve==Y)return Tk(f,this.__actions__);var Je=[];e:for(;Y--&&Te<Ve;){ce+=g;for(var yt=-1,Ze=f[ce];++yt<me;){var _t=pe[yt],Mt=_t.iteratee,As=_t.type,Fn=Mt(Ze);if(As==X)Ze=Fn;else if(!Fn){if(As==K)continue e;break e}}Je[Te++]=Ze}return Je}xt.prototype=Df(Ww.prototype),xt.prototype.constructor=xt;function sh(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var E=f[g];this.set(E[0],E[1])}}function Dee(){this.__data__=T0?T0(null):{},this.size=0}function Fee(f){var g=this.has(f)&&delete this.__data__[f];return this.size-=g?1:0,g}function jee(f){var g=this.__data__;if(T0){var S=g[f];return S===u?r:S}return zt.call(g,f)?g[f]:r}function Uee(f){var g=this.__data__;return T0?g[f]!==r:zt.call(g,f)}function Vee(f,g){var S=this.__data__;return this.size+=this.has(f)?0:1,S[f]=T0&&g===r?u:g,this}sh.prototype.clear=Dee,sh.prototype.delete=Fee,sh.prototype.get=jee,sh.prototype.has=Uee,sh.prototype.set=Vee;function Fl(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var E=f[g];this.set(E[0],E[1])}}function Gee(){this.__data__=[],this.size=0}function Bee(f){var g=this.__data__,S=Jw(g,f);if(S<0)return!1;var E=g.length-1;return S==E?g.pop():Vw.call(g,S,1),--this.size,!0}function zee(f){var g=this.__data__,S=Jw(g,f);return S<0?r:g[S][1]}function qee(f){return Jw(this.__data__,f)>-1}function Hee(f,g){var S=this.__data__,E=Jw(S,f);return E<0?(++this.size,S.push([f,g])):S[E][1]=g,this}Fl.prototype.clear=Gee,Fl.prototype.delete=Bee,Fl.prototype.get=zee,Fl.prototype.has=qee,Fl.prototype.set=Hee;function jl(f){var g=-1,S=f==null?0:f.length;for(this.clear();++g<S;){var E=f[g];this.set(E[0],E[1])}}function Wee(){this.size=0,this.__data__={hash:new sh,map:new(S0||Fl),string:new sh}}function Jee(f){var g=ob(this,f).delete(f);return this.size-=g?1:0,g}function Zee(f){return ob(this,f).get(f)}function Yee(f){return ob(this,f).has(f)}function Kee(f,g){var S=ob(this,f),E=S.size;return S.set(f,g),this.size+=S.size==E?0:1,this}jl.prototype.clear=Wee,jl.prototype.delete=Jee,jl.prototype.get=Zee,jl.prototype.has=Yee,jl.prototype.set=Kee;function oh(f){var g=-1,S=f==null?0:f.length;for(this.__data__=new jl;++g<S;)this.add(f[g])}function Xee(f){return this.__data__.set(f,u),this}function Qee(f){return this.__data__.has(f)}oh.prototype.add=oh.prototype.push=Xee,oh.prototype.has=Qee;function Ho(f){var g=this.__data__=new Fl(f);this.size=g.size}function ete(){this.__data__=new Fl,this.size=0}function tte(f){var g=this.__data__,S=g.delete(f);return this.size=g.size,S}function rte(f){return this.__data__.get(f)}function ite(f){return this.__data__.has(f)}function nte(f,g){var S=this.__data__;if(S instanceof Fl){var E=S.__data__;if(!S0||E.length<n-1)return E.push([f,g]),this.size=++S.size,this;S=this.__data__=new jl(E)}return S.set(f,g),this.size=S.size,this}Ho.prototype.clear=ete,Ho.prototype.delete=tte,Ho.prototype.get=rte,Ho.prototype.has=ite,Ho.prototype.set=nte;function tk(f,g){var S=ct(f),E=!S&&ph(f),O=!S&&!E&&uc(f),D=!S&&!E&&!O&&Vf(f),G=S||E||O||D,H=G?LI(f.length,fee):[],Y=H.length;for(var ce in f)(g||zt.call(f,ce))&&!(G&&(ce=="length"||O&&(ce=="offset"||ce=="parent")||D&&(ce=="buffer"||ce=="byteLength"||ce=="byteOffset")||Bl(ce,Y)))&&H.push(ce);return H}function rk(f){var g=f.length;return g?f[KI(0,g-1)]:r}function ste(f,g){return ab(ns(f),ah(g,0,f.length))}function ote(f){return ab(ns(f))}function VI(f,g,S){(S!==r&&!Wo(f[g],S)||S===r&&!(g in f))&&Ul(f,g,S)}function M0(f,g,S){var E=f[g];(!(zt.call(f,g)&&Wo(E,S))||S===r&&!(g in f))&&Ul(f,g,S)}function Jw(f,g){for(var S=f.length;S--;)if(Wo(f[S][0],g))return S;return-1}function ate(f,g,S,E){return sc(f,function(O,D,G){g(E,O,S(O),G)}),E}function ik(f,g){return f&&Va(g,Ci(g),f)}function lte(f,g){return f&&Va(g,os(g),f)}function Ul(f,g,S){g=="__proto__"&&Gw?Gw(f,g,{configurable:!0,enumerable:!0,value:S,writable:!0}):f[g]=S}function GI(f,g){for(var S=-1,E=g.length,O=ie(E),D=f==null;++S<E;)O[S]=D?r:S3(f,g[S]);return O}function ah(f,g,S){return f===f&&(S!==r&&(f=f<=S?f:S),g!==r&&(f=f>=g?f:g)),f}function ho(f,g,S,E,O,D){var G,H=g&d,Y=g&y,ce=g&v;if(S&&(G=O?S(f,E,O,D):S(f)),G!==r)return G;if(!Er(f))return f;var pe=ct(f);if(pe){if(G=Yte(f),!H)return ns(f,G)}else{var me=on(f),Te=me==rn||me==Dt;if(uc(f))return $k(f,H);if(me==mi||me==ht||Te&&!O){if(G=Y||Te?{}:Hk(f),!H)return Y?jte(f,lte(G,f)):Fte(f,ik(G,f))}else{if(!or[me])return O?f:{};G=Kte(f,me,H)}}D||(D=new Ho);var Ve=D.get(f);if(Ve)return Ve;D.set(f,G),_N(f)?f.forEach(function(Ze){G.add(ho(Ze,g,S,Ze,f,D))}):wN(f)&&f.forEach(function(Ze,_t){G.set(_t,ho(Ze,g,S,_t,f,D))});var Je=ce?Y?l3:a3:Y?os:Ci,yt=pe?r:Je(f);return uo(yt||f,function(Ze,_t){yt&&(_t=Ze,Ze=f[_t]),M0(G,_t,ho(Ze,g,S,_t,f,D))}),G}function ute(f){var g=Ci(f);return function(S){return nk(S,f,g)}}function nk(f,g,S){var E=S.length;if(f==null)return!E;for(f=er(f);E--;){var O=S[E],D=g[O],G=f[O];if(G===r&&!(O in f)||!D(G))return!1}return!0}function sk(f,g,S){if(typeof f!="function")throw new co(o);return P0(function(){f.apply(r,S)},g)}function $0(f,g,S,E){var O=-1,D=Cw,G=!0,H=f.length,Y=[],ce=g.length;if(!H)return Y;S&&(g=vr(g,Ms(S))),E?(D=EI,G=!1):g.length>=n&&(D=b0,G=!1,g=new oh(g));e:for(;++O<H;){var pe=f[O],me=S==null?pe:S(pe);if(pe=E||pe!==0?pe:0,G&&me===me){for(var Te=ce;Te--;)if(g[Te]===me)continue e;Y.push(pe)}else D(g,me,E)||Y.push(pe)}return Y}var sc=Ok(Ua),ok=Ok(zI,!0);function cte(f,g){var S=!0;return sc(f,function(E,O,D){return S=!!g(E,O,D),S}),S}function Zw(f,g,S){for(var E=-1,O=f.length;++E<O;){var D=f[E],G=g(D);if(G!=null&&(H===r?G===G&&!Es(G):S(G,H)))var H=G,Y=D}return Y}function pte(f,g,S,E){var O=f.length;for(S=dt(S),S<0&&(S=-S>O?0:O+S),E=E===r||E>O?O:dt(E),E<0&&(E+=O),E=S>E?0:xN(E);S<E;)f[S++]=g;return f}function ak(f,g){var S=[];return sc(f,function(E,O,D){g(E,O,D)&&S.push(E)}),S}function zi(f,g,S,E,O){var D=-1,G=f.length;for(S||(S=Qte),O||(O=[]);++D<G;){var H=f[D];g>0&&S(H)?g>1?zi(H,g-1,S,E,O):rc(O,H):E||(O[O.length]=H)}return O}var BI=Pk(),lk=Pk(!0);function Ua(f,g){return f&&BI(f,g,Ci)}function zI(f,g){return f&&lk(f,g,Ci)}function Yw(f,g){return tc(g,function(S){return zl(f[S])})}function lh(f,g){g=ac(g,f);for(var S=0,E=g.length;f!=null&&S<E;)f=f[Ga(g[S++])];return S&&S==E?f:r}function uk(f,g,S){var E=g(f);return ct(f)?E:rc(E,S(f))}function Nn(f){return f==null?f===r?ot:nn:nh&&nh in er(f)?Wte(f):ore(f)}function qI(f,g){return f>g}function hte(f,g){return f!=null&&zt.call(f,g)}function dte(f,g){return f!=null&&g in er(f)}function fte(f,g,S){return f>=sn(g,S)&&f<vi(g,S)}function HI(f,g,S){for(var E=S?EI:Cw,O=f[0].length,D=f.length,G=D,H=ie(D),Y=1/0,ce=[];G--;){var pe=f[G];G&&g&&(pe=vr(pe,Ms(g))),Y=sn(pe.length,Y),H[G]=!S&&(g||O>=120&&pe.length>=120)?new oh(G&&pe):r}pe=f[0];var me=-1,Te=H[0];e:for(;++me<O&&ce.length<Y;){var Ve=pe[me],Je=g?g(Ve):Ve;if(Ve=S||Ve!==0?Ve:0,!(Te?b0(Te,Je):E(ce,Je,S))){for(G=D;--G;){var yt=H[G];if(!(yt?b0(yt,Je):E(f[G],Je,S)))continue e}Te&&Te.push(Je),ce.push(Ve)}}return ce}function yte(f,g,S,E){return Ua(f,function(O,D,G){g(E,S(O),D,G)}),E}function E0(f,g,S){g=ac(g,f),f=Yk(f,g);var E=f==null?f:f[Ga(yo(g))];return E==null?r:Is(E,f,S)}function ck(f){return Fr(f)&&Nn(f)==ht}function mte(f){return Fr(f)&&Nn(f)==Vt}function gte(f){return Fr(f)&&Nn(f)==st}function A0(f,g,S,E,O){return f===g?!0:f==null||g==null||!Fr(f)&&!Fr(g)?f!==f&&g!==g:vte(f,g,S,E,A0,O)}function vte(f,g,S,E,O,D){var G=ct(f),H=ct(g),Y=G?Lt:on(f),ce=H?Lt:on(g);Y=Y==ht?mi:Y,ce=ce==ht?mi:ce;var pe=Y==mi,me=ce==mi,Te=Y==ce;if(Te&&uc(f)){if(!uc(g))return!1;G=!0,pe=!1}if(Te&&!pe)return D||(D=new Ho),G||Vf(f)?Bk(f,g,S,E,O,D):qte(f,g,Y,S,E,O,D);if(!(S&w)){var Ve=pe&&zt.call(f,"__wrapped__"),Je=me&&zt.call(g,"__wrapped__");if(Ve||Je){var yt=Ve?f.value():f,Ze=Je?g.value():g;return D||(D=new Ho),O(yt,Ze,S,E,D)}}return Te?(D||(D=new Ho),Hte(f,g,S,E,O,D)):!1}function wte(f){return Fr(f)&&on(f)==yi}function WI(f,g,S,E){var O=S.length,D=O,G=!E;if(f==null)return!D;for(f=er(f);O--;){var H=S[O];if(G&&H[2]?H[1]!==f[H[0]]:!(H[0]in f))return!1}for(;++O<D;){H=S[O];var Y=H[0],ce=f[Y],pe=H[1];if(G&&H[2]){if(ce===r&&!(Y in f))return!1}else{var me=new Ho;if(E)var Te=E(ce,pe,Y,f,g,me);if(!(Te===r?A0(pe,ce,w|b,E,me):Te))return!1}}return!0}function pk(f){if(!Er(f)||tre(f))return!1;var g=zl(f)?wee:Iw;return g.test(ch(f))}function bte(f){return Fr(f)&&Nn(f)==Gi}function _te(f){return Fr(f)&&on(f)==Ri}function Ste(f){return Fr(f)&&db(f.length)&&!!hr[Nn(f)]}function hk(f){return typeof f=="function"?f:f==null?as:typeof f=="object"?ct(f)?yk(f[0],f[1]):fk(f):LN(f)}function JI(f){if(!O0(f))return Iee(f);var g=[];for(var S in er(f))zt.call(f,S)&&S!="constructor"&&g.push(S);return g}function xte(f){if(!Er(f))return sre(f);var g=O0(f),S=[];for(var E in f)E=="constructor"&&(g||!zt.call(f,E))||S.push(E);return S}function ZI(f,g){return f<g}function dk(f,g){var S=-1,E=ss(f)?ie(f.length):[];return sc(f,function(O,D,G){E[++S]=g(O,D,G)}),E}function fk(f){var g=c3(f);return g.length==1&&g[0][2]?Jk(g[0][0],g[0][1]):function(S){return S===f||WI(S,f,g)}}function yk(f,g){return h3(f)&&Wk(g)?Jk(Ga(f),g):function(S){var E=S3(S,f);return E===r&&E===g?x3(S,f):A0(g,E,w|b)}}function Kw(f,g,S,E,O){f!==g&&BI(g,function(D,G){if(O||(O=new Ho),Er(D))Tte(f,g,G,S,Kw,E,O);else{var H=E?E(f3(f,G),D,G+"",f,g,O):r;H===r&&(H=D),VI(f,G,H)}},os)}function Tte(f,g,S,E,O,D,G){var H=f3(f,S),Y=f3(g,S),ce=G.get(Y);if(ce){VI(f,S,ce);return}var pe=D?D(H,Y,S+"",f,g,G):r,me=pe===r;if(me){var Te=ct(Y),Ve=!Te&&uc(Y),Je=!Te&&!Ve&&Vf(Y);pe=Y,Te||Ve||Je?ct(H)?pe=H:Hr(H)?pe=ns(H):Ve?(me=!1,pe=$k(Y,!0)):Je?(me=!1,pe=Ek(Y,!0)):pe=[]:L0(Y)||ph(Y)?(pe=H,ph(H)?pe=TN(H):(!Er(H)||zl(H))&&(pe=Hk(Y))):me=!1}me&&(G.set(Y,pe),O(pe,Y,E,D,G),G.delete(Y)),VI(f,S,pe)}function mk(f,g){var S=f.length;if(S)return g+=g<0?S:0,Bl(g,S)?f[g]:r}function gk(f,g,S){g.length?g=vr(g,function(D){return ct(D)?function(G){return lh(G,D.length===1?D[0]:D)}:D}):g=[as];var E=-1;g=vr(g,Ms(He()));var O=dk(f,function(D,G,H){var Y=vr(g,function(ce){return ce(D)});return{criteria:Y,index:++E,value:D}});return KQ(O,function(D,G){return Dte(D,G,S)})}function Ite(f,g){return vk(f,g,function(S,E){return x3(f,E)})}function vk(f,g,S){for(var E=-1,O=g.length,D={};++E<O;){var G=g[E],H=lh(f,G);S(H,G)&&R0(D,ac(G,f),H)}return D}function Mte(f){return function(g){return lh(g,f)}}function YI(f,g,S,E){var O=E?YQ:Rf,D=-1,G=g.length,H=f;for(f===g&&(g=ns(g)),S&&(H=vr(f,Ms(S)));++D<G;)for(var Y=0,ce=g[D],pe=S?S(ce):ce;(Y=O(H,pe,Y,E))>-1;)H!==f&&Vw.call(H,Y,1),Vw.call(f,Y,1);return f}function wk(f,g){for(var S=f?g.length:0,E=S-1;S--;){var O=g[S];if(S==E||O!==D){var D=O;Bl(O)?Vw.call(f,O,1):e3(f,O)}}return f}function KI(f,g){return f+zw(QL()*(g-f+1))}function $te(f,g,S,E){for(var O=-1,D=vi(Bw((g-f)/(S||1)),0),G=ie(D);D--;)G[E?D:++O]=f,f+=S;return G}function XI(f,g){var S="";if(!f||g<1||g>ae)return S;do g%2&&(S+=f),g=zw(g/2),g&&(f+=f);while(g);return S}function mt(f,g){return y3(Zk(f,g,as),f+"")}function Ete(f){return rk(Gf(f))}function Ate(f,g){var S=Gf(f);return ab(S,ah(g,0,S.length))}function R0(f,g,S,E){if(!Er(f))return f;g=ac(g,f);for(var O=-1,D=g.length,G=D-1,H=f;H!=null&&++O<D;){var Y=Ga(g[O]),ce=S;if(Y==="__proto__"||Y==="constructor"||Y==="prototype")return f;if(O!=G){var pe=H[Y];ce=E?E(pe,Y,H):r,ce===r&&(ce=Er(pe)?pe:Bl(g[O+1])?[]:{})}M0(H,Y,ce),H=H[Y]}return f}var bk=qw?function(f,g){return qw.set(f,g),f}:as,Rte=Gw?function(f,g){return Gw(f,"toString",{configurable:!0,enumerable:!1,value:I3(g),writable:!0})}:as;function Cte(f){return ab(Gf(f))}function fo(f,g,S){var E=-1,O=f.length;g<0&&(g=-g>O?0:O+g),S=S>O?O:S,S<0&&(S+=O),O=g>S?0:S-g>>>0,g>>>=0;for(var D=ie(O);++E<O;)D[E]=f[E+g];return D}function Ote(f,g){var S;return sc(f,function(E,O,D){return S=g(E,O,D),!S}),!!S}function Xw(f,g,S){var E=0,O=f==null?E:f.length;if(typeof g=="number"&&g===g&&O<=Ee){for(;E<O;){var D=E+O>>>1,G=f[D];G!==null&&!Es(G)&&(S?G<=g:G<g)?E=D+1:O=D}return O}return QI(f,g,as,S)}function QI(f,g,S,E){var O=0,D=f==null?0:f.length;if(D===0)return 0;g=S(g);for(var G=g!==g,H=g===null,Y=Es(g),ce=g===r;O<D;){var pe=zw((O+D)/2),me=S(f[pe]),Te=me!==r,Ve=me===null,Je=me===me,yt=Es(me);if(G)var Ze=E||Je;else ce?Ze=Je&&(E||Te):H?Ze=Je&&Te&&(E||!Ve):Y?Ze=Je&&Te&&!Ve&&(E||!yt):Ve||yt?Ze=!1:Ze=E?me<=g:me<g;Ze?O=pe+1:D=pe}return sn(D,Se)}function _k(f,g){for(var S=-1,E=f.length,O=0,D=[];++S<E;){var G=f[S],H=g?g(G):G;if(!S||!Wo(H,Y)){var Y=H;D[O++]=G===0?0:G}}return D}function Sk(f){return typeof f=="number"?f:Es(f)?de:+f}function $s(f){if(typeof f=="string")return f;if(ct(f))return vr(f,$s)+"";if(Es(f))return ek?ek.call(f):"";var g=f+"";return g=="0"&&1/f==-re?"-0":g}function oc(f,g,S){var E=-1,O=Cw,D=f.length,G=!0,H=[],Y=H;if(S)G=!1,O=EI;else if(D>=n){var ce=g?null:Bte(f);if(ce)return Pw(ce);G=!1,O=b0,Y=new oh}else Y=g?[]:H;e:for(;++E<D;){var pe=f[E],me=g?g(pe):pe;if(pe=S||pe!==0?pe:0,G&&me===me){for(var Te=Y.length;Te--;)if(Y[Te]===me)continue e;g&&Y.push(me),H.push(pe)}else O(Y,me,S)||(Y!==H&&Y.push(me),H.push(pe))}return H}function e3(f,g){return g=ac(g,f),f=Yk(f,g),f==null||delete f[Ga(yo(g))]}function xk(f,g,S,E){return R0(f,g,S(lh(f,g)),E)}function Qw(f,g,S,E){for(var O=f.length,D=E?O:-1;(E?D--:++D<O)&&g(f[D],D,f););return S?fo(f,E?0:D,E?D+1:O):fo(f,E?D+1:0,E?O:D)}function Tk(f,g){var S=f;return S instanceof xt&&(S=S.value()),AI(g,function(E,O){return O.func.apply(O.thisArg,rc([E],O.args))},S)}function t3(f,g,S){var E=f.length;if(E<2)return E?oc(f[0]):[];for(var O=-1,D=ie(E);++O<E;)for(var G=f[O],H=-1;++H<E;)H!=O&&(D[O]=$0(D[O]||G,f[H],g,S));return oc(zi(D,1),g,S)}function Ik(f,g,S){for(var E=-1,O=f.length,D=g.length,G={};++E<O;){var H=E<D?g[E]:r;S(G,f[E],H)}return G}function r3(f){return Hr(f)?f:[]}function i3(f){return typeof f=="function"?f:as}function ac(f,g){return ct(f)?f:h3(f,g)?[f]:eN(Gt(f))}var Pte=mt;function lc(f,g,S){var E=f.length;return S=S===r?E:S,!g&&S>=E?f:fo(f,g,S)}var Mk=bee||function(f){return Bi.clearTimeout(f)};function $k(f,g){if(g)return f.slice();var S=f.length,E=JL?JL(S):new f.constructor(S);return f.copy(E),E}function n3(f){var g=new f.constructor(f.byteLength);return new jw(g).set(new jw(f)),g}function Lte(f,g){var S=g?n3(f.buffer):f.buffer;return new f.constructor(S,f.byteOffset,f.byteLength)}function kte(f){var g=new f.constructor(f.source,xw.exec(f));return g.lastIndex=f.lastIndex,g}function Nte(f){return I0?er(I0.call(f)):{}}function Ek(f,g){var S=g?n3(f.buffer):f.buffer;return new f.constructor(S,f.byteOffset,f.length)}function Ak(f,g){if(f!==g){var S=f!==r,E=f===null,O=f===f,D=Es(f),G=g!==r,H=g===null,Y=g===g,ce=Es(g);if(!H&&!ce&&!D&&f>g||D&&G&&Y&&!H&&!ce||E&&G&&Y||!S&&Y||!O)return 1;if(!E&&!D&&!ce&&f<g||ce&&S&&O&&!E&&!D||H&&S&&O||!G&&O||!Y)return-1}return 0}function Dte(f,g,S){for(var E=-1,O=f.criteria,D=g.criteria,G=O.length,H=S.length;++E<G;){var Y=Ak(O[E],D[E]);if(Y){if(E>=H)return Y;var ce=S[E];return Y*(ce=="desc"?-1:1)}}return f.index-g.index}function Rk(f,g,S,E){for(var O=-1,D=f.length,G=S.length,H=-1,Y=g.length,ce=vi(D-G,0),pe=ie(Y+ce),me=!E;++H<Y;)pe[H]=g[H];for(;++O<G;)(me||O<D)&&(pe[S[O]]=f[O]);for(;ce--;)pe[H++]=f[O++];return pe}function Ck(f,g,S,E){for(var O=-1,D=f.length,G=-1,H=S.length,Y=-1,ce=g.length,pe=vi(D-H,0),me=ie(pe+ce),Te=!E;++O<pe;)me[O]=f[O];for(var Ve=O;++Y<ce;)me[Ve+Y]=g[Y];for(;++G<H;)(Te||O<D)&&(me[Ve+S[G]]=f[O++]);return me}function ns(f,g){var S=-1,E=f.length;for(g||(g=ie(E));++S<E;)g[S]=f[S];return g}function Va(f,g,S,E){var O=!S;S||(S={});for(var D=-1,G=g.length;++D<G;){var H=g[D],Y=E?E(S[H],f[H],H,S,f):r;Y===r&&(Y=f[H]),O?Ul(S,H,Y):M0(S,H,Y)}return S}function Fte(f,g){return Va(f,p3(f),g)}function jte(f,g){return Va(f,zk(f),g)}function eb(f,g){return function(S,E){var O=ct(S)?zQ:ate,D=g?g():{};return O(S,f,He(E,2),D)}}function Ff(f){return mt(function(g,S){var E=-1,O=S.length,D=O>1?S[O-1]:r,G=O>2?S[2]:r;for(D=f.length>3&&typeof D=="function"?(O--,D):r,G&&Dn(S[0],S[1],G)&&(D=O<3?r:D,O=1),g=er(g);++E<O;){var H=S[E];H&&f(g,H,E,D)}return g})}function Ok(f,g){return function(S,E){if(S==null)return S;if(!ss(S))return f(S,E);for(var O=S.length,D=g?O:-1,G=er(S);(g?D--:++D<O)&&E(G[D],D,G)!==!1;);return S}}function Pk(f){return function(g,S,E){for(var O=-1,D=er(g),G=E(g),H=G.length;H--;){var Y=G[f?H:++O];if(S(D[Y],Y,D)===!1)break}return g}}function Ute(f,g,S){var E=g&_,O=C0(f);function D(){var G=this&&this!==Bi&&this instanceof D?O:f;return G.apply(E?S:this,arguments)}return D}function Lk(f){return function(g){g=Gt(g);var S=Cf(g)?qo(g):r,E=S?S[0]:g.charAt(0),O=S?lc(S,1).join(""):g.slice(1);return E[f]()+O}}function jf(f){return function(g){return AI(ON(CN(g).replace(RQ,"")),f,"")}}function C0(f){return function(){var g=arguments;switch(g.length){case 0:return new f;case 1:return new f(g[0]);case 2:return new f(g[0],g[1]);case 3:return new f(g[0],g[1],g[2]);case 4:return new f(g[0],g[1],g[2],g[3]);case 5:return new f(g[0],g[1],g[2],g[3],g[4]);case 6:return new f(g[0],g[1],g[2],g[3],g[4],g[5]);case 7:return new f(g[0],g[1],g[2],g[3],g[4],g[5],g[6])}var S=Df(f.prototype),E=f.apply(S,g);return Er(E)?E:S}}function Vte(f,g,S){var E=C0(f);function O(){for(var D=arguments.length,G=ie(D),H=D,Y=Uf(O);H--;)G[H]=arguments[H];var ce=D<3&&G[0]!==Y&&G[D-1]!==Y?[]:ic(G,Y);if(D-=ce.length,D<S)return jk(f,g,tb,O.placeholder,r,G,ce,r,r,S-D);var pe=this&&this!==Bi&&this instanceof O?E:f;return Is(pe,this,G)}return O}function kk(f){return function(g,S,E){var O=er(g);if(!ss(g)){var D=He(S,3);g=Ci(g),S=function(H){return D(O[H],H,O)}}var G=f(g,S,E);return G>-1?O[D?g[G]:G]:r}}function Nk(f){return Gl(function(g){var S=g.length,E=S,O=po.prototype.thru;for(f&&g.reverse();E--;){var D=g[E];if(typeof D!="function")throw new co(o);if(O&&!G&&sb(D)=="wrapper")var G=new po([],!0)}for(E=G?E:S;++E<S;){D=g[E];var H=sb(D),Y=H=="wrapper"?u3(D):r;Y&&d3(Y[0])&&Y[1]==(R|I|$|L)&&!Y[4].length&&Y[9]==1?G=G[sb(Y[0])].apply(G,Y[3]):G=D.length==1&&d3(D)?G[H]():G.thru(D)}return function(){var ce=arguments,pe=ce[0];if(G&&ce.length==1&&ct(pe))return G.plant(pe).value();for(var me=0,Te=S?g[me].apply(this,ce):pe;++me<S;)Te=g[me].call(this,Te);return Te}})}function tb(f,g,S,E,O,D,G,H,Y,ce){var pe=g&R,me=g&_,Te=g&x,Ve=g&(I|M),Je=g&C,yt=Te?r:C0(f);function Ze(){for(var _t=arguments.length,Mt=ie(_t),As=_t;As--;)Mt[As]=arguments[As];if(Ve)var Fn=Uf(Ze),Rs=QQ(Mt,Fn);if(E&&(Mt=Rk(Mt,E,O,Ve)),D&&(Mt=Ck(Mt,D,G,Ve)),_t-=Rs,Ve&&_t<ce){var Wr=ic(Mt,Fn);return jk(f,g,tb,Ze.placeholder,S,Mt,Wr,H,Y,ce-_t)}var Jo=me?S:this,Hl=Te?Jo[f]:f;return _t=Mt.length,H?Mt=are(Mt,H):Je&&_t>1&&Mt.reverse(),pe&&Y<_t&&(Mt.length=Y),this&&this!==Bi&&this instanceof Ze&&(Hl=yt||C0(Hl)),Hl.apply(Jo,Mt)}return Ze}function Dk(f,g){return function(S,E){return yte(S,f,g(E),{})}}function rb(f,g){return function(S,E){var O;if(S===r&&E===r)return g;if(S!==r&&(O=S),E!==r){if(O===r)return E;typeof S=="string"||typeof E=="string"?(S=$s(S),E=$s(E)):(S=Sk(S),E=Sk(E)),O=f(S,E)}return O}}function s3(f){return Gl(function(g){return g=vr(g,Ms(He())),mt(function(S){var E=this;return f(g,function(O){return Is(O,E,S)})})})}function ib(f,g){g=g===r?" ":$s(g);var S=g.length;if(S<2)return S?XI(g,f):g;var E=XI(g,Bw(f/Of(g)));return Cf(g)?lc(qo(E),0,f).join(""):E.slice(0,f)}function Gte(f,g,S,E){var O=g&_,D=C0(f);function G(){for(var H=-1,Y=arguments.length,ce=-1,pe=E.length,me=ie(pe+Y),Te=this&&this!==Bi&&this instanceof G?D:f;++ce<pe;)me[ce]=E[ce];for(;Y--;)me[ce++]=arguments[++H];return Is(Te,O?S:this,me)}return G}function Fk(f){return function(g,S,E){return E&&typeof E!="number"&&Dn(g,S,E)&&(S=E=r),g=ql(g),S===r?(S=g,g=0):S=ql(S),E=E===r?g<S?1:-1:ql(E),$te(g,S,E,f)}}function nb(f){return function(g,S){return typeof g=="string"&&typeof S=="string"||(g=mo(g),S=mo(S)),f(g,S)}}function jk(f,g,S,E,O,D,G,H,Y,ce){var pe=g&I,me=pe?G:r,Te=pe?r:G,Ve=pe?D:r,Je=pe?r:D;g|=pe?$:A,g&=~(pe?A:$),g&T||(g&=~(_|x));var yt=[f,g,O,Ve,me,Je,Te,H,Y,ce],Ze=S.apply(r,yt);return d3(f)&&Kk(Ze,yt),Ze.placeholder=E,Xk(Ze,f,g)}function o3(f){var g=gi[f];return function(S,E){if(S=mo(S),E=E==null?0:sn(dt(E),292),E&&XL(S)){var O=(Gt(S)+"e").split("e"),D=g(O[0]+"e"+(+O[1]+E));return O=(Gt(D)+"e").split("e"),+(O[0]+"e"+(+O[1]-E))}return g(S)}}var Bte=kf&&1/Pw(new kf([,-0]))[1]==re?function(f){return new kf(f)}:E3;function Uk(f){return function(g){var S=on(g);return S==yi?NI(g):S==Ri?oee(g):XQ(g,f(g))}}function Vl(f,g,S,E,O,D,G,H){var Y=g&x;if(!Y&&typeof f!="function")throw new co(o);var ce=E?E.length:0;if(ce||(g&=~($|A),E=O=r),G=G===r?G:vi(dt(G),0),H=H===r?H:dt(H),ce-=O?O.length:0,g&A){var pe=E,me=O;E=O=r}var Te=Y?r:u3(f),Ve=[f,g,S,E,O,pe,me,D,G,H];if(Te&&nre(Ve,Te),f=Ve[0],g=Ve[1],S=Ve[2],E=Ve[3],O=Ve[4],H=Ve[9]=Ve[9]===r?Y?0:f.length:vi(Ve[9]-ce,0),!H&&g&(I|M)&&(g&=~(I|M)),!g||g==_)var Je=Ute(f,g,S);else g==I||g==M?Je=Vte(f,g,H):(g==$||g==(_|$))&&!O.length?Je=Gte(f,g,S,E):Je=tb.apply(r,Ve);var yt=Te?bk:Kk;return Xk(yt(Je,Ve),f,g)}function Vk(f,g,S,E){return f===r||Wo(f,Lf[S])&&!zt.call(E,S)?g:f}function Gk(f,g,S,E,O,D){return Er(f)&&Er(g)&&(D.set(g,f),Kw(f,g,r,Gk,D),D.delete(g)),f}function zte(f){return L0(f)?r:f}function Bk(f,g,S,E,O,D){var G=S&w,H=f.length,Y=g.length;if(H!=Y&&!(G&&Y>H))return!1;var ce=D.get(f),pe=D.get(g);if(ce&&pe)return ce==g&&pe==f;var me=-1,Te=!0,Ve=S&b?new oh:r;for(D.set(f,g),D.set(g,f);++me<H;){var Je=f[me],yt=g[me];if(E)var Ze=G?E(yt,Je,me,g,f,D):E(Je,yt,me,f,g,D);if(Ze!==r){if(Ze)continue;Te=!1;break}if(Ve){if(!RI(g,function(_t,Mt){if(!b0(Ve,Mt)&&(Je===_t||O(Je,_t,S,E,D)))return Ve.push(Mt)})){Te=!1;break}}else if(!(Je===yt||O(Je,yt,S,E,D))){Te=!1;break}}return D.delete(f),D.delete(g),Te}function qte(f,g,S,E,O,D,G){switch(S){case ti:if(f.byteLength!=g.byteLength||f.byteOffset!=g.byteOffset)return!1;f=f.buffer,g=g.buffer;case Vt:return!(f.byteLength!=g.byteLength||!D(new jw(f),new jw(g)));case Ir:case st:case On:return Wo(+f,+g);case ei:return f.name==g.name&&f.message==g.message;case Gi:case Pn:return f==g+"";case yi:var H=NI;case Ri:var Y=E&w;if(H||(H=Pw),f.size!=g.size&&!Y)return!1;var ce=G.get(f);if(ce)return ce==g;E|=b,G.set(f,g);var pe=Bk(H(f),H(g),E,O,D,G);return G.delete(f),pe;case Re:if(I0)return I0.call(f)==I0.call(g)}return!1}function Hte(f,g,S,E,O,D){var G=S&w,H=a3(f),Y=H.length,ce=a3(g),pe=ce.length;if(Y!=pe&&!G)return!1;for(var me=Y;me--;){var Te=H[me];if(!(G?Te in g:zt.call(g,Te)))return!1}var Ve=D.get(f),Je=D.get(g);if(Ve&&Je)return Ve==g&&Je==f;var yt=!0;D.set(f,g),D.set(g,f);for(var Ze=G;++me<Y;){Te=H[me];var _t=f[Te],Mt=g[Te];if(E)var As=G?E(Mt,_t,Te,g,f,D):E(_t,Mt,Te,f,g,D);if(!(As===r?_t===Mt||O(_t,Mt,S,E,D):As)){yt=!1;break}Ze||(Ze=Te=="constructor")}if(yt&&!Ze){var Fn=f.constructor,Rs=g.constructor;Fn!=Rs&&"constructor"in f&&"constructor"in g&&!(typeof Fn=="function"&&Fn instanceof Fn&&typeof Rs=="function"&&Rs instanceof Rs)&&(yt=!1)}return D.delete(f),D.delete(g),yt}function Gl(f){return y3(Zk(f,r,nN),f+"")}function a3(f){return uk(f,Ci,p3)}function l3(f){return uk(f,os,zk)}var u3=qw?function(f){return qw.get(f)}:E3;function sb(f){for(var g=f.name+"",S=Nf[g],E=zt.call(Nf,g)?S.length:0;E--;){var O=S[E],D=O.func;if(D==null||D==f)return O.name}return g}function Uf(f){var g=zt.call(N,"placeholder")?N:f;return g.placeholder}function He(){var f=N.iteratee||M3;return f=f===M3?hk:f,arguments.length?f(arguments[0],arguments[1]):f}function ob(f,g){var S=f.__data__;return ere(g)?S[typeof g=="string"?"string":"hash"]:S.map}function c3(f){for(var g=Ci(f),S=g.length;S--;){var E=g[S],O=f[E];g[S]=[E,O,Wk(O)]}return g}function uh(f,g){var S=iee(f,g);return pk(S)?S:r}function Wte(f){var g=zt.call(f,nh),S=f[nh];try{f[nh]=r;var E=!0}catch{}var O=Dw.call(f);return E&&(g?f[nh]=S:delete f[nh]),O}var p3=FI?function(f){return f==null?[]:(f=er(f),tc(FI(f),function(g){return YL.call(f,g)}))}:A3,zk=FI?function(f){for(var g=[];f;)rc(g,p3(f)),f=Uw(f);return g}:A3,on=Nn;(jI&&on(new jI(new ArrayBuffer(1)))!=ti||S0&&on(new S0)!=yi||UI&&on(UI.resolve())!=Dl||kf&&on(new kf)!=Ri||x0&&on(new x0)!=bt)&&(on=function(f){var g=Nn(f),S=g==mi?f.constructor:r,E=S?ch(S):"";if(E)switch(E){case Aee:return ti;case Ree:return yi;case Cee:return Dl;case Oee:return Ri;case Pee:return bt}return g});function Jte(f,g,S){for(var E=-1,O=S.length;++E<O;){var D=S[E],G=D.size;switch(D.type){case"drop":f+=G;break;case"dropRight":g-=G;break;case"take":g=sn(g,f+G);break;case"takeRight":f=vi(f,g-G);break}}return{start:f,end:g}}function Zte(f){var g=f.match(ao);return g?g[1].split(g0):[]}function qk(f,g,S){g=ac(g,f);for(var E=-1,O=g.length,D=!1;++E<O;){var G=Ga(g[E]);if(!(D=f!=null&&S(f,G)))break;f=f[G]}return D||++E!=O?D:(O=f==null?0:f.length,!!O&&db(O)&&Bl(G,O)&&(ct(f)||ph(f)))}function Yte(f){var g=f.length,S=new f.constructor(g);return g&&typeof f[0]=="string"&&zt.call(f,"index")&&(S.index=f.index,S.input=f.input),S}function Hk(f){return typeof f.constructor=="function"&&!O0(f)?Df(Uw(f)):{}}function Kte(f,g,S){var E=f.constructor;switch(g){case Vt:return n3(f);case Ir:case st:return new E(+f);case ti:return Lte(f,S);case Mr:case ri:case eh:case c0:case p0:case h0:case d0:case f0:case y0:return Ek(f,S);case yi:return new E;case On:case Pn:return new E(f);case Gi:return kte(f);case Ri:return new E;case Re:return Nte(f)}}function Xte(f,g){var S=g.length;if(!S)return f;var E=S-1;return g[E]=(S>1?"& ":"")+g[E],g=g.join(S>2?", ":" "),f.replace(Mf,`{
/* [wrapped with `+g+`] */
`)}function Qte(f){return ct(f)||ph(f)||!!(KL&&f&&f[KL])}function Bl(f,g){var S=typeof f;return g=g??ae,!!g&&(S=="number"||S!="symbol"&&yI.test(f))&&f>-1&&f%1==0&&f<g}function Dn(f,g,S){if(!Er(S))return!1;var E=typeof g;return(E=="number"?ss(S)&&Bl(g,S.length):E=="string"&&g in S)?Wo(S[g],f):!1}function h3(f,g){if(ct(f))return!1;var S=typeof f;return S=="number"||S=="symbol"||S=="boolean"||f==null||Es(f)?!0:hI.test(f)||!pI.test(f)||g!=null&&f in er(g)}function ere(f){var g=typeof f;return g=="string"||g=="number"||g=="symbol"||g=="boolean"?f!=="__proto__":f===null}function d3(f){var g=sb(f),S=N[g];if(typeof S!="function"||!(g in xt.prototype))return!1;if(f===S)return!0;var E=u3(S);return!!E&&f===E[0]}function tre(f){return!!WL&&WL in f}var rre=kw?zl:R3;function O0(f){var g=f&&f.constructor,S=typeof g=="function"&&g.prototype||Lf;return f===S}function Wk(f){return f===f&&!Er(f)}function Jk(f,g){return function(S){return S==null?!1:S[f]===g&&(g!==r||f in er(S))}}function ire(f){var g=pb(f,function(E){return S.size===c&&S.clear(),E}),S=g.cache;return g}function nre(f,g){var S=f[1],E=g[1],O=S|E,D=O<(_|x|R),G=E==R&&S==I||E==R&&S==L&&f[7].length<=g[8]||E==(R|L)&&g[7].length<=g[8]&&S==I;if(!(D||G))return f;E&_&&(f[2]=g[2],O|=S&_?0:T);var H=g[3];if(H){var Y=f[3];f[3]=Y?Rk(Y,H,g[4]):H,f[4]=Y?ic(f[3],h):g[4]}return H=g[5],H&&(Y=f[5],f[5]=Y?Ck(Y,H,g[6]):H,f[6]=Y?ic(f[5],h):g[6]),H=g[7],H&&(f[7]=H),E&R&&(f[8]=f[8]==null?g[8]:sn(f[8],g[8])),f[9]==null&&(f[9]=g[9]),f[0]=g[0],f[1]=O,f}function sre(f){var g=[];if(f!=null)for(var S in er(f))g.push(S);return g}function ore(f){return Dw.call(f)}function Zk(f,g,S){return g=vi(g===r?f.length-1:g,0),function(){for(var E=arguments,O=-1,D=vi(E.length-g,0),G=ie(D);++O<D;)G[O]=E[g+O];O=-1;for(var H=ie(g+1);++O<g;)H[O]=E[O];return H[g]=S(G),Is(f,this,H)}}function Yk(f,g){return g.length<2?f:lh(f,fo(g,0,-1))}function are(f,g){for(var S=f.length,E=sn(g.length,S),O=ns(f);E--;){var D=g[E];f[E]=Bl(D,S)?O[D]:r}return f}function f3(f,g){if(!(g==="constructor"&&typeof f[g]=="function")&&g!="__proto__")return f[g]}var Kk=Qk(bk),P0=See||function(f,g){return Bi.setTimeout(f,g)},y3=Qk(Rte);function Xk(f,g,S){var E=g+"";return y3(f,Xte(E,lre(Zte(E),S)))}function Qk(f){var g=0,S=0;return function(){var E=Mee(),O=q-(E-S);if(S=E,O>0){if(++g>=j)return arguments[0]}else g=0;return f.apply(r,arguments)}}function ab(f,g){var S=-1,E=f.length,O=E-1;for(g=g===r?E:g;++S<g;){var D=KI(S,O),G=f[D];f[D]=f[S],f[S]=G}return f.length=g,f}var eN=ire(function(f){var g=[];return f.charCodeAt(0)===46&&g.push(""),f.replace(dI,function(S,E,O,D){g.push(O?D.replace(ii,"$1"):E||S)}),g});function Ga(f){if(typeof f=="string"||Es(f))return f;var g=f+"";return g=="0"&&1/f==-re?"-0":g}function ch(f){if(f!=null){try{return Nw.call(f)}catch{}try{return f+""}catch{}}return""}function lre(f,g){return uo(Fe,function(S){var E="_."+S[0];g&S[1]&&!Cw(f,E)&&f.push(E)}),f.sort()}function tN(f){if(f instanceof xt)return f.clone();var g=new po(f.__wrapped__,f.__chain__);return g.__actions__=ns(f.__actions__),g.__index__=f.__index__,g.__values__=f.__values__,g}function ure(f,g,S){(S?Dn(f,g,S):g===r)?g=1:g=vi(dt(g),0);var E=f==null?0:f.length;if(!E||g<1)return[];for(var O=0,D=0,G=ie(Bw(E/g));O<E;)G[D++]=fo(f,O,O+=g);return G}function cre(f){for(var g=-1,S=f==null?0:f.length,E=0,O=[];++g<S;){var D=f[g];D&&(O[E++]=D)}return O}function pre(){var f=arguments.length;if(!f)return[];for(var g=ie(f-1),S=arguments[0],E=f;E--;)g[E-1]=arguments[E];return rc(ct(S)?ns(S):[S],zi(g,1))}var hre=mt(function(f,g){return Hr(f)?$0(f,zi(g,1,Hr,!0)):[]}),dre=mt(function(f,g){var S=yo(g);return Hr(S)&&(S=r),Hr(f)?$0(f,zi(g,1,Hr,!0),He(S,2)):[]}),fre=mt(function(f,g){var S=yo(g);return Hr(S)&&(S=r),Hr(f)?$0(f,zi(g,1,Hr,!0),r,S):[]});function yre(f,g,S){var E=f==null?0:f.length;return E?(g=S||g===r?1:dt(g),fo(f,g<0?0:g,E)):[]}function mre(f,g,S){var E=f==null?0:f.length;return E?(g=S||g===r?1:dt(g),g=E-g,fo(f,0,g<0?0:g)):[]}function gre(f,g){return f&&f.length?Qw(f,He(g,3),!0,!0):[]}function vre(f,g){return f&&f.length?Qw(f,He(g,3),!0):[]}function wre(f,g,S,E){var O=f==null?0:f.length;return O?(S&&typeof S!="number"&&Dn(f,g,S)&&(S=0,E=O),pte(f,g,S,E)):[]}function rN(f,g,S){var E=f==null?0:f.length;if(!E)return-1;var O=S==null?0:dt(S);return O<0&&(O=vi(E+O,0)),Ow(f,He(g,3),O)}function iN(f,g,S){var E=f==null?0:f.length;if(!E)return-1;var O=E-1;return S!==r&&(O=dt(S),O=S<0?vi(E+O,0):sn(O,E-1)),Ow(f,He(g,3),O,!0)}function nN(f){var g=f==null?0:f.length;return g?zi(f,1):[]}function bre(f){var g=f==null?0:f.length;return g?zi(f,re):[]}function _re(f,g){var S=f==null?0:f.length;return S?(g=g===r?1:dt(g),zi(f,g)):[]}function Sre(f){for(var g=-1,S=f==null?0:f.length,E={};++g<S;){var O=f[g];E[O[0]]=O[1]}return E}function sN(f){return f&&f.length?f[0]:r}function xre(f,g,S){var E=f==null?0:f.length;if(!E)return-1;var O=S==null?0:dt(S);return O<0&&(O=vi(E+O,0)),Rf(f,g,O)}function Tre(f){var g=f==null?0:f.length;return g?fo(f,0,-1):[]}var Ire=mt(function(f){var g=vr(f,r3);return g.length&&g[0]===f[0]?HI(g):[]}),Mre=mt(function(f){var g=yo(f),S=vr(f,r3);return g===yo(S)?g=r:S.pop(),S.length&&S[0]===f[0]?HI(S,He(g,2)):[]}),$re=mt(function(f){var g=yo(f),S=vr(f,r3);return g=typeof g=="function"?g:r,g&&S.pop(),S.length&&S[0]===f[0]?HI(S,r,g):[]});function Ere(f,g){return f==null?"":Tee.call(f,g)}function yo(f){var g=f==null?0:f.length;return g?f[g-1]:r}function Are(f,g,S){var E=f==null?0:f.length;if(!E)return-1;var O=E;return S!==r&&(O=dt(S),O=O<0?vi(E+O,0):sn(O,E-1)),g===g?lee(f,g,O):Ow(f,jL,O,!0)}function Rre(f,g){return f&&f.length?mk(f,dt(g)):r}var Cre=mt(oN);function oN(f,g){return f&&f.length&&g&&g.length?YI(f,g):f}function Ore(f,g,S){return f&&f.length&&g&&g.length?YI(f,g,He(S,2)):f}function Pre(f,g,S){return f&&f.length&&g&&g.length?YI(f,g,r,S):f}var Lre=Gl(function(f,g){var S=f==null?0:f.length,E=GI(f,g);return wk(f,vr(g,function(O){return Bl(O,S)?+O:O}).sort(Ak)),E});function kre(f,g){var S=[];if(!(f&&f.length))return S;var E=-1,O=[],D=f.length;for(g=He(g,3);++E<D;){var G=f[E];g(G,E,f)&&(S.push(G),O.push(E))}return wk(f,O),S}function m3(f){return f==null?f:Eee.call(f)}function Nre(f,g,S){var E=f==null?0:f.length;return E?(S&&typeof S!="number"&&Dn(f,g,S)?(g=0,S=E):(g=g==null?0:dt(g),S=S===r?E:dt(S)),fo(f,g,S)):[]}function Dre(f,g){return Xw(f,g)}function Fre(f,g,S){return QI(f,g,He(S,2))}function jre(f,g){var S=f==null?0:f.length;if(S){var E=Xw(f,g);if(E<S&&Wo(f[E],g))return E}return-1}function Ure(f,g){return Xw(f,g,!0)}function Vre(f,g,S){return QI(f,g,He(S,2),!0)}function Gre(f,g){var S=f==null?0:f.length;if(S){var E=Xw(f,g,!0)-1;if(Wo(f[E],g))return E}return-1}function Bre(f){return f&&f.length?_k(f):[]}function zre(f,g){return f&&f.length?_k(f,He(g,2)):[]}function qre(f){var g=f==null?0:f.length;return g?fo(f,1,g):[]}function Hre(f,g,S){return f&&f.length?(g=S||g===r?1:dt(g),fo(f,0,g<0?0:g)):[]}function Wre(f,g,S){var E=f==null?0:f.length;return E?(g=S||g===r?1:dt(g),g=E-g,fo(f,g<0?0:g,E)):[]}function Jre(f,g){return f&&f.length?Qw(f,He(g,3),!1,!0):[]}function Zre(f,g){return f&&f.length?Qw(f,He(g,3)):[]}var Yre=mt(function(f){return oc(zi(f,1,Hr,!0))}),Kre=mt(function(f){var g=yo(f);return Hr(g)&&(g=r),oc(zi(f,1,Hr,!0),He(g,2))}),Xre=mt(function(f){var g=yo(f);return g=typeof g=="function"?g:r,oc(zi(f,1,Hr,!0),r,g)});function Qre(f){return f&&f.length?oc(f):[]}function eie(f,g){return f&&f.length?oc(f,He(g,2)):[]}function tie(f,g){return g=typeof g=="function"?g:r,f&&f.length?oc(f,r,g):[]}function g3(f){if(!(f&&f.length))return[];var g=0;return f=tc(f,function(S){if(Hr(S))return g=vi(S.length,g),!0}),LI(g,function(S){return vr(f,CI(S))})}function aN(f,g){if(!(f&&f.length))return[];var S=g3(f);return g==null?S:vr(S,function(E){return Is(g,r,E)})}var rie=mt(function(f,g){return Hr(f)?$0(f,g):[]}),iie=mt(function(f){return t3(tc(f,Hr))}),nie=mt(function(f){var g=yo(f);return Hr(g)&&(g=r),t3(tc(f,Hr),He(g,2))}),sie=mt(function(f){var g=yo(f);return g=typeof g=="function"?g:r,t3(tc(f,Hr),r,g)}),oie=mt(g3);function aie(f,g){return Ik(f||[],g||[],M0)}function lie(f,g){return Ik(f||[],g||[],R0)}var uie=mt(function(f){var g=f.length,S=g>1?f[g-1]:r;return S=typeof S=="function"?(f.pop(),S):r,aN(f,S)});function lN(f){var g=N(f);return g.__chain__=!0,g}function cie(f,g){return g(f),f}function lb(f,g){return g(f)}var pie=Gl(function(f){var g=f.length,S=g?f[0]:0,E=this.__wrapped__,O=function(D){return GI(D,f)};return g>1||this.__actions__.length||!(E instanceof xt)||!Bl(S)?this.thru(O):(E=E.slice(S,+S+(g?1:0)),E.__actions__.push({func:lb,args:[O],thisArg:r}),new po(E,this.__chain__).thru(function(D){return g&&!D.length&&D.push(r),D}))});function hie(){return lN(this)}function die(){return new po(this.value(),this.__chain__)}function fie(){this.__values__===r&&(this.__values__=SN(this.value()));var f=this.__index__>=this.__values__.length,g=f?r:this.__values__[this.__index__++];return{done:f,value:g}}function yie(){return this}function mie(f){for(var g,S=this;S instanceof Ww;){var E=tN(S);E.__index__=0,E.__values__=r,g?O.__wrapped__=E:g=E;var O=E;S=S.__wrapped__}return O.__wrapped__=f,g}function gie(){var f=this.__wrapped__;if(f instanceof xt){var g=f;return this.__actions__.length&&(g=new xt(this)),g=g.reverse(),g.__actions__.push({func:lb,args:[m3],thisArg:r}),new po(g,this.__chain__)}return this.thru(m3)}function vie(){return Tk(this.__wrapped__,this.__actions__)}var wie=eb(function(f,g,S){zt.call(f,S)?++f[S]:Ul(f,S,1)});function bie(f,g,S){var E=ct(f)?DL:cte;return S&&Dn(f,g,S)&&(g=r),E(f,He(g,3))}function _ie(f,g){var S=ct(f)?tc:ak;return S(f,He(g,3))}var Sie=kk(rN),xie=kk(iN);function Tie(f,g){return zi(ub(f,g),1)}function Iie(f,g){return zi(ub(f,g),re)}function Mie(f,g,S){return S=S===r?1:dt(S),zi(ub(f,g),S)}function uN(f,g){var S=ct(f)?uo:sc;return S(f,He(g,3))}function cN(f,g){var S=ct(f)?qQ:ok;return S(f,He(g,3))}var $ie=eb(function(f,g,S){zt.call(f,S)?f[S].push(g):Ul(f,S,[g])});function Eie(f,g,S,E){f=ss(f)?f:Gf(f),S=S&&!E?dt(S):0;var O=f.length;return S<0&&(S=vi(O+S,0)),fb(f)?S<=O&&f.indexOf(g,S)>-1:!!O&&Rf(f,g,S)>-1}var Aie=mt(function(f,g,S){var E=-1,O=typeof g=="function",D=ss(f)?ie(f.length):[];return sc(f,function(G){D[++E]=O?Is(g,G,S):E0(G,g,S)}),D}),Rie=eb(function(f,g,S){Ul(f,S,g)});function ub(f,g){var S=ct(f)?vr:dk;return S(f,He(g,3))}function Cie(f,g,S,E){return f==null?[]:(ct(g)||(g=g==null?[]:[g]),S=E?r:S,ct(S)||(S=S==null?[]:[S]),gk(f,g,S))}var Oie=eb(function(f,g,S){f[S?0:1].push(g)},function(){return[[],[]]});function Pie(f,g,S){var E=ct(f)?AI:VL,O=arguments.length<3;return E(f,He(g,4),S,O,sc)}function Lie(f,g,S){var E=ct(f)?HQ:VL,O=arguments.length<3;return E(f,He(g,4),S,O,ok)}function kie(f,g){var S=ct(f)?tc:ak;return S(f,hb(He(g,3)))}function Nie(f){var g=ct(f)?rk:Ete;return g(f)}function Die(f,g,S){(S?Dn(f,g,S):g===r)?g=1:g=dt(g);var E=ct(f)?ste:Ate;return E(f,g)}function Fie(f){var g=ct(f)?ote:Cte;return g(f)}function jie(f){if(f==null)return 0;if(ss(f))return fb(f)?Of(f):f.length;var g=on(f);return g==yi||g==Ri?f.size:JI(f).length}function Uie(f,g,S){var E=ct(f)?RI:Ote;return S&&Dn(f,g,S)&&(g=r),E(f,He(g,3))}var Vie=mt(function(f,g){if(f==null)return[];var S=g.length;return S>1&&Dn(f,g[0],g[1])?g=[]:S>2&&Dn(g[0],g[1],g[2])&&(g=[g[0]]),gk(f,zi(g,1),[])}),cb=_ee||function(){return Bi.Date.now()};function Gie(f,g){if(typeof g!="function")throw new co(o);return f=dt(f),function(){if(--f<1)return g.apply(this,arguments)}}function pN(f,g,S){return g=S?r:g,g=f&&g==null?f.length:g,Vl(f,R,r,r,r,r,g)}function hN(f,g){var S;if(typeof g!="function")throw new co(o);return f=dt(f),function(){return--f>0&&(S=g.apply(this,arguments)),f<=1&&(g=r),S}}var v3=mt(function(f,g,S){var E=_;if(S.length){var O=ic(S,Uf(v3));E|=$}return Vl(f,E,g,S,O)}),dN=mt(function(f,g,S){var E=_|x;if(S.length){var O=ic(S,Uf(dN));E|=$}return Vl(g,E,f,S,O)});function fN(f,g,S){g=S?r:g;var E=Vl(f,I,r,r,r,r,r,g);return E.placeholder=fN.placeholder,E}function yN(f,g,S){g=S?r:g;var E=Vl(f,M,r,r,r,r,r,g);return E.placeholder=yN.placeholder,E}function mN(f,g,S){var E,O,D,G,H,Y,ce=0,pe=!1,me=!1,Te=!0;if(typeof f!="function")throw new co(o);g=mo(g)||0,Er(S)&&(pe=!!S.leading,me="maxWait"in S,D=me?vi(mo(S.maxWait)||0,g):D,Te="trailing"in S?!!S.trailing:Te);function Ve(Wr){var Jo=E,Hl=O;return E=O=r,ce=Wr,G=f.apply(Hl,Jo),G}function Je(Wr){return ce=Wr,H=P0(_t,g),pe?Ve(Wr):G}function yt(Wr){var Jo=Wr-Y,Hl=Wr-ce,kN=g-Jo;return me?sn(kN,D-Hl):kN}function Ze(Wr){var Jo=Wr-Y,Hl=Wr-ce;return Y===r||Jo>=g||Jo<0||me&&Hl>=D}function _t(){var Wr=cb();if(Ze(Wr))return Mt(Wr);H=P0(_t,yt(Wr))}function Mt(Wr){return H=r,Te&&E?Ve(Wr):(E=O=r,G)}function As(){H!==r&&Mk(H),ce=0,E=Y=O=H=r}function Fn(){return H===r?G:Mt(cb())}function Rs(){var Wr=cb(),Jo=Ze(Wr);if(E=arguments,O=this,Y=Wr,Jo){if(H===r)return Je(Y);if(me)return Mk(H),H=P0(_t,g),Ve(Y)}return H===r&&(H=P0(_t,g)),G}return Rs.cancel=As,Rs.flush=Fn,Rs}var Bie=mt(function(f,g){return sk(f,1,g)}),zie=mt(function(f,g,S){return sk(f,mo(g)||0,S)});function qie(f){return Vl(f,C)}function pb(f,g){if(typeof f!="function"||g!=null&&typeof g!="function")throw new co(o);var S=function(){var E=arguments,O=g?g.apply(this,E):E[0],D=S.cache;if(D.has(O))return D.get(O);var G=f.apply(this,E);return S.cache=D.set(O,G)||D,G};return S.cache=new(pb.Cache||jl),S}pb.Cache=jl;function hb(f){if(typeof f!="function")throw new co(o);return function(){var g=arguments;switch(g.length){case 0:return!f.call(this);case 1:return!f.call(this,g[0]);case 2:return!f.call(this,g[0],g[1]);case 3:return!f.call(this,g[0],g[1],g[2])}return!f.apply(this,g)}}function Hie(f){return hN(2,f)}var Wie=Pte(function(f,g){g=g.length==1&&ct(g[0])?vr(g[0],Ms(He())):vr(zi(g,1),Ms(He()));var S=g.length;return mt(function(E){for(var O=-1,D=sn(E.length,S);++O<D;)E[O]=g[O].call(this,E[O]);return Is(f,this,E)})}),w3=mt(function(f,g){var S=ic(g,Uf(w3));return Vl(f,$,r,g,S)}),gN=mt(function(f,g){var S=ic(g,Uf(gN));return Vl(f,A,r,g,S)}),Jie=Gl(function(f,g){return Vl(f,L,r,r,r,g)});function Zie(f,g){if(typeof f!="function")throw new co(o);return g=g===r?g:dt(g),mt(f,g)}function Yie(f,g){if(typeof f!="function")throw new co(o);return g=g==null?0:vi(dt(g),0),mt(function(S){var E=S[g],O=lc(S,0,g);return E&&rc(O,E),Is(f,this,O)})}function Kie(f,g,S){var E=!0,O=!0;if(typeof f!="function")throw new co(o);return Er(S)&&(E="leading"in S?!!S.leading:E,O="trailing"in S?!!S.trailing:O),mN(f,g,{leading:E,maxWait:g,trailing:O})}function Xie(f){return pN(f,1)}function Qie(f,g){return w3(i3(g),f)}function ene(){if(!arguments.length)return[];var f=arguments[0];return ct(f)?f:[f]}function tne(f){return ho(f,v)}function rne(f,g){return g=typeof g=="function"?g:r,ho(f,v,g)}function ine(f){return ho(f,d|v)}function nne(f,g){return g=typeof g=="function"?g:r,ho(f,d|v,g)}function sne(f,g){return g==null||nk(f,g,Ci(g))}function Wo(f,g){return f===g||f!==f&&g!==g}var one=nb(qI),ane=nb(function(f,g){return f>=g}),ph=ck(function(){return arguments}())?ck:function(f){return Fr(f)&&zt.call(f,"callee")&&!YL.call(f,"callee")},ct=ie.isArray,lne=CL?Ms(CL):mte;function ss(f){return f!=null&&db(f.length)&&!zl(f)}function Hr(f){return Fr(f)&&ss(f)}function une(f){return f===!0||f===!1||Fr(f)&&Nn(f)==Ir}var uc=xee||R3,cne=OL?Ms(OL):gte;function pne(f){return Fr(f)&&f.nodeType===1&&!L0(f)}function hne(f){if(f==null)return!0;if(ss(f)&&(ct(f)||typeof f=="string"||typeof f.splice=="function"||uc(f)||Vf(f)||ph(f)))return!f.length;var g=on(f);if(g==yi||g==Ri)return!f.size;if(O0(f))return!JI(f).length;for(var S in f)if(zt.call(f,S))return!1;return!0}function dne(f,g){return A0(f,g)}function fne(f,g,S){S=typeof S=="function"?S:r;var E=S?S(f,g):r;return E===r?A0(f,g,r,S):!!E}function b3(f){if(!Fr(f))return!1;var g=Nn(f);return g==ei||g==St||typeof f.message=="string"&&typeof f.name=="string"&&!L0(f)}function yne(f){return typeof f=="number"&&XL(f)}function zl(f){if(!Er(f))return!1;var g=Nn(f);return g==rn||g==Dt||g==Nt||g==Qu}function vN(f){return typeof f=="number"&&f==dt(f)}function db(f){return typeof f=="number"&&f>-1&&f%1==0&&f<=ae}function Er(f){var g=typeof f;return f!=null&&(g=="object"||g=="function")}function Fr(f){return f!=null&&typeof f=="object"}var wN=PL?Ms(PL):wte;function mne(f,g){return f===g||WI(f,g,c3(g))}function gne(f,g,S){return S=typeof S=="function"?S:r,WI(f,g,c3(g),S)}function vne(f){return bN(f)&&f!=+f}function wne(f){if(rre(f))throw new at(s);return pk(f)}function bne(f){return f===null}function _ne(f){return f==null}function bN(f){return typeof f=="number"||Fr(f)&&Nn(f)==On}function L0(f){if(!Fr(f)||Nn(f)!=mi)return!1;var g=Uw(f);if(g===null)return!0;var S=zt.call(g,"constructor")&&g.constructor;return typeof S=="function"&&S instanceof S&&Nw.call(S)==gee}var _3=LL?Ms(LL):bte;function Sne(f){return vN(f)&&f>=-ae&&f<=ae}var _N=kL?Ms(kL):_te;function fb(f){return typeof f=="string"||!ct(f)&&Fr(f)&&Nn(f)==Pn}function Es(f){return typeof f=="symbol"||Fr(f)&&Nn(f)==Re}var Vf=NL?Ms(NL):Ste;function xne(f){return f===r}function Tne(f){return Fr(f)&&on(f)==bt}function Ine(f){return Fr(f)&&Nn(f)==Dr}var Mne=nb(ZI),$ne=nb(function(f,g){return f<=g});function SN(f){if(!f)return[];if(ss(f))return fb(f)?qo(f):ns(f);if(_0&&f[_0])return see(f[_0]());var g=on(f),S=g==yi?NI:g==Ri?Pw:Gf;return S(f)}function ql(f){if(!f)return f===0?f:0;if(f=mo(f),f===re||f===-re){var g=f<0?-1:1;return g*he}return f===f?f:0}function dt(f){var g=ql(f),S=g%1;return g===g?S?g-S:g:0}function xN(f){return f?ah(dt(f),0,fe):0}function mo(f){if(typeof f=="number")return f;if(Es(f))return de;if(Er(f)){var g=typeof f.valueOf=="function"?f.valueOf():f;f=Er(g)?g+"":g}if(typeof f!="string")return f===0?f:+f;f=GL(f);var S=Tw.test(f);return S||tt.test(f)?GQ(f.slice(2),S?2:8):zo.test(f)?de:+f}function TN(f){return Va(f,os(f))}function Ene(f){return f?ah(dt(f),-ae,ae):f===0?f:0}function Gt(f){return f==null?"":$s(f)}var Ane=Ff(function(f,g){if(O0(g)||ss(g)){Va(g,Ci(g),f);return}for(var S in g)zt.call(g,S)&&M0(f,S,g[S])}),IN=Ff(function(f,g){Va(g,os(g),f)}),yb=Ff(function(f,g,S,E){Va(g,os(g),f,E)}),Rne=Ff(function(f,g,S,E){Va(g,Ci(g),f,E)}),Cne=Gl(GI);function One(f,g){var S=Df(f);return g==null?S:ik(S,g)}var Pne=mt(function(f,g){f=er(f);var S=-1,E=g.length,O=E>2?g[2]:r;for(O&&Dn(g[0],g[1],O)&&(E=1);++S<E;)for(var D=g[S],G=os(D),H=-1,Y=G.length;++H<Y;){var ce=G[H],pe=f[ce];(pe===r||Wo(pe,Lf[ce])&&!zt.call(f,ce))&&(f[ce]=D[ce])}return f}),Lne=mt(function(f){return f.push(r,Gk),Is(MN,r,f)});function kne(f,g){return FL(f,He(g,3),Ua)}function Nne(f,g){return FL(f,He(g,3),zI)}function Dne(f,g){return f==null?f:BI(f,He(g,3),os)}function Fne(f,g){return f==null?f:lk(f,He(g,3),os)}function jne(f,g){return f&&Ua(f,He(g,3))}function Une(f,g){return f&&zI(f,He(g,3))}function Vne(f){return f==null?[]:Yw(f,Ci(f))}function Gne(f){return f==null?[]:Yw(f,os(f))}function S3(f,g,S){var E=f==null?r:lh(f,g);return E===r?S:E}function Bne(f,g){return f!=null&&qk(f,g,hte)}function x3(f,g){return f!=null&&qk(f,g,dte)}var zne=Dk(function(f,g,S){g!=null&&typeof g.toString!="function"&&(g=Dw.call(g)),f[g]=S},I3(as)),qne=Dk(function(f,g,S){g!=null&&typeof g.toString!="function"&&(g=Dw.call(g)),zt.call(f,g)?f[g].push(S):f[g]=[S]},He),Hne=mt(E0);function Ci(f){return ss(f)?tk(f):JI(f)}function os(f){return ss(f)?tk(f,!0):xte(f)}function Wne(f,g){var S={};return g=He(g,3),Ua(f,function(E,O,D){Ul(S,g(E,O,D),E)}),S}function Jne(f,g){var S={};return g=He(g,3),Ua(f,function(E,O,D){Ul(S,O,g(E,O,D))}),S}var Zne=Ff(function(f,g,S){Kw(f,g,S)}),MN=Ff(function(f,g,S,E){Kw(f,g,S,E)}),Yne=Gl(function(f,g){var S={};if(f==null)return S;var E=!1;g=vr(g,function(D){return D=ac(D,f),E||(E=D.length>1),D}),Va(f,l3(f),S),E&&(S=ho(S,d|y|v,zte));for(var O=g.length;O--;)e3(S,g[O]);return S});function Kne(f,g){return $N(f,hb(He(g)))}var Xne=Gl(function(f,g){return f==null?{}:Ite(f,g)});function $N(f,g){if(f==null)return{};var S=vr(l3(f),function(E){return[E]});return g=He(g),vk(f,S,function(E,O){return g(E,O[0])})}function Qne(f,g,S){g=ac(g,f);var E=-1,O=g.length;for(O||(O=1,f=r);++E<O;){var D=f==null?r:f[Ga(g[E])];D===r&&(E=O,D=S),f=zl(D)?D.call(f):D}return f}function ese(f,g,S){return f==null?f:R0(f,g,S)}function tse(f,g,S,E){return E=typeof E=="function"?E:r,f==null?f:R0(f,g,S,E)}var EN=Uk(Ci),AN=Uk(os);function rse(f,g,S){var E=ct(f),O=E||uc(f)||Vf(f);if(g=He(g,4),S==null){var D=f&&f.constructor;O?S=E?new D:[]:Er(f)?S=zl(D)?Df(Uw(f)):{}:S={}}return(O?uo:Ua)(f,function(G,H,Y){return g(S,G,H,Y)}),S}function ise(f,g){return f==null?!0:e3(f,g)}function nse(f,g,S){return f==null?f:xk(f,g,i3(S))}function sse(f,g,S,E){return E=typeof E=="function"?E:r,f==null?f:xk(f,g,i3(S),E)}function Gf(f){return f==null?[]:kI(f,Ci(f))}function ose(f){return f==null?[]:kI(f,os(f))}function ase(f,g,S){return S===r&&(S=g,g=r),S!==r&&(S=mo(S),S=S===S?S:0),g!==r&&(g=mo(g),g=g===g?g:0),ah(mo(f),g,S)}function lse(f,g,S){return g=ql(g),S===r?(S=g,g=0):S=ql(S),f=mo(f),fte(f,g,S)}function use(f,g,S){if(S&&typeof S!="boolean"&&Dn(f,g,S)&&(g=S=r),S===r&&(typeof g=="boolean"?(S=g,g=r):typeof f=="boolean"&&(S=f,f=r)),f===r&&g===r?(f=0,g=1):(f=ql(f),g===r?(g=f,f=0):g=ql(g)),f>g){var E=f;f=g,g=E}if(S||f%1||g%1){var O=QL();return sn(f+O*(g-f+VQ("1e-"+((O+"").length-1))),g)}return KI(f,g)}var cse=jf(function(f,g,S){return g=g.toLowerCase(),f+(S?RN(g):g)});function RN(f){return T3(Gt(f).toLowerCase())}function CN(f){return f=Gt(f),f&&f.replace(Mw,eee).replace(CQ,"")}function pse(f,g,S){f=Gt(f),g=$s(g);var E=f.length;S=S===r?E:ah(dt(S),0,E);var O=S;return S-=g.length,S>=0&&f.slice(S,O)==g}function hse(f){return f=Gt(f),f&&lI.test(f)?f.replace(_w,tee):f}function dse(f){return f=Gt(f),f&&fI.test(f)?f.replace(m0,"\\$&"):f}var fse=jf(function(f,g,S){return f+(S?"-":"")+g.toLowerCase()}),yse=jf(function(f,g,S){return f+(S?" ":"")+g.toLowerCase()}),mse=Lk("toLowerCase");function gse(f,g,S){f=Gt(f),g=dt(g);var E=g?Of(f):0;if(!g||E>=g)return f;var O=(g-E)/2;return ib(zw(O),S)+f+ib(Bw(O),S)}function vse(f,g,S){f=Gt(f),g=dt(g);var E=g?Of(f):0;return g&&E<g?f+ib(g-E,S):f}function wse(f,g,S){f=Gt(f),g=dt(g);var E=g?Of(f):0;return g&&E<g?ib(g-E,S)+f:f}function bse(f,g,S){return S||g==null?g=0:g&&(g=+g),$ee(Gt(f).replace(ee,""),g||0)}function _se(f,g,S){return(S?Dn(f,g,S):g===r)?g=1:g=dt(g),XI(Gt(f),g)}function Sse(){var f=arguments,g=Gt(f[0]);return f.length<3?g:g.replace(f[1],f[2])}var xse=jf(function(f,g,S){return f+(S?"_":"")+g.toLowerCase()});function Tse(f,g,S){return S&&typeof S!="number"&&Dn(f,g,S)&&(g=S=r),S=S===r?fe:S>>>0,S?(f=Gt(f),f&&(typeof g=="string"||g!=null&&!_3(g))&&(g=$s(g),!g&&Cf(f))?lc(qo(f),0,S):f.split(g,S)):[]}var Ise=jf(function(f,g,S){return f+(S?" ":"")+T3(g)});function Mse(f,g,S){return f=Gt(f),S=S==null?0:ah(dt(S),0,f.length),g=$s(g),f.slice(S,S+g.length)==g}function $se(f,g,S){var E=N.templateSettings;S&&Dn(f,g,S)&&(g=r),f=Gt(f),g=yb({},g,E,Vk);var O=yb({},g.imports,E.imports,Vk),D=Ci(O),G=kI(O,D),H,Y,ce=0,pe=g.interpolate||Ef,me="__p += '",Te=DI((g.escape||Ef).source+"|"+pe.source+"|"+(pe===Sw?th:Ef).source+"|"+(g.evaluate||Ef).source+"|$","g"),Ve="//# sourceURL="+(zt.call(g,"sourceURL")?(g.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++NQ+"]")+`
`;f.replace(Te,function(Ze,_t,Mt,As,Fn,Rs){return Mt||(Mt=As),me+=f.slice(ce,Rs).replace(mI,ree),_t&&(H=!0,me+=`' +
__e(`+_t+`) +
'`),Fn&&(Y=!0,me+=`';
`+Fn+`;
__p += '`),Mt&&(me+=`' +
((__t = (`+Mt+`)) == null ? '' : __t) +
'`),ce=Rs+Ze.length,Ze}),me+=`';
`;var Je=zt.call(g,"variable")&&g.variable;if(!Je)me=`with (obj) {
`+me+`
}
`;else if($f.test(Je))throw new at(a);me=(Y?me.replace(nI,""):me).replace(sI,"$1").replace(oI,"$1;"),me="function("+(Je||"obj")+`) {
`+(Je?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(Y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+me+`return __p
}`;var yt=PN(function(){return Ft(D,Ve+"return "+me).apply(r,G)});if(yt.source=me,b3(yt))throw yt;return yt}function Ese(f){return Gt(f).toLowerCase()}function Ase(f){return Gt(f).toUpperCase()}function Rse(f,g,S){if(f=Gt(f),f&&(S||g===r))return GL(f);if(!f||!(g=$s(g)))return f;var E=qo(f),O=qo(g),D=BL(E,O),G=zL(E,O)+1;return lc(E,D,G).join("")}function Cse(f,g,S){if(f=Gt(f),f&&(S||g===r))return f.slice(0,HL(f)+1);if(!f||!(g=$s(g)))return f;var E=qo(f),O=zL(E,qo(g))+1;return lc(E,0,O).join("")}function Ose(f,g,S){if(f=Gt(f),f&&(S||g===r))return f.replace(ee,"");if(!f||!(g=$s(g)))return f;var E=qo(f),O=BL(E,qo(g));return lc(E,O).join("")}function Pse(f,g){var S=U,E=F;if(Er(g)){var O="separator"in g?g.separator:O;S="length"in g?dt(g.length):S,E="omission"in g?$s(g.omission):E}f=Gt(f);var D=f.length;if(Cf(f)){var G=qo(f);D=G.length}if(S>=D)return f;var H=S-Of(E);if(H<1)return E;var Y=G?lc(G,0,H).join(""):f.slice(0,H);if(O===r)return Y+E;if(G&&(H+=Y.length-H),_3(O)){if(f.slice(H).search(O)){var ce,pe=Y;for(O.global||(O=DI(O.source,Gt(xw.exec(O))+"g")),O.lastIndex=0;ce=O.exec(pe);)var me=ce.index;Y=Y.slice(0,me===r?H:me)}}else if(f.indexOf($s(O),H)!=H){var Te=Y.lastIndexOf(O);Te>-1&&(Y=Y.slice(0,Te))}return Y+E}function Lse(f){return f=Gt(f),f&&aI.test(f)?f.replace(bw,uee):f}var kse=jf(function(f,g,S){return f+(S?" ":"")+g.toUpperCase()}),T3=Lk("toUpperCase");function ON(f,g,S){return f=Gt(f),g=S?r:g,g===r?nee(f)?hee(f):ZQ(f):f.match(g)||[]}var PN=mt(function(f,g){try{return Is(f,r,g)}catch(S){return b3(S)?S:new at(S)}}),Nse=Gl(function(f,g){return uo(g,function(S){S=Ga(S),Ul(f,S,v3(f[S],f))}),f});function Dse(f){var g=f==null?0:f.length,S=He();return f=g?vr(f,function(E){if(typeof E[1]!="function")throw new co(o);return[S(E[0]),E[1]]}):[],mt(function(E){for(var O=-1;++O<g;){var D=f[O];if(Is(D[0],this,E))return Is(D[1],this,E)}})}function Fse(f){return ute(ho(f,d))}function I3(f){return function(){return f}}function jse(f,g){return f==null||f!==f?g:f}var Use=Nk(),Vse=Nk(!0);function as(f){return f}function M3(f){return hk(typeof f=="function"?f:ho(f,d))}function Gse(f){return fk(ho(f,d))}function Bse(f,g){return yk(f,ho(g,d))}var zse=mt(function(f,g){return function(S){return E0(S,f,g)}}),qse=mt(function(f,g){return function(S){return E0(f,S,g)}});function $3(f,g,S){var E=Ci(g),O=Yw(g,E);S==null&&!(Er(g)&&(O.length||!E.length))&&(S=g,g=f,f=this,O=Yw(g,Ci(g)));var D=!(Er(S)&&"chain"in S)||!!S.chain,G=zl(f);return uo(O,function(H){var Y=g[H];f[H]=Y,G&&(f.prototype[H]=function(){var ce=this.__chain__;if(D||ce){var pe=f(this.__wrapped__),me=pe.__actions__=ns(this.__actions__);return me.push({func:Y,args:arguments,thisArg:f}),pe.__chain__=ce,pe}return Y.apply(f,rc([this.value()],arguments))})}),f}function Hse(){return Bi._===this&&(Bi._=vee),this}function E3(){}function Wse(f){return f=dt(f),mt(function(g){return mk(g,f)})}var Jse=s3(vr),Zse=s3(DL),Yse=s3(RI);function LN(f){return h3(f)?CI(Ga(f)):Mte(f)}function Kse(f){return function(g){return f==null?r:lh(f,g)}}var Xse=Fk(),Qse=Fk(!0);function A3(){return[]}function R3(){return!1}function eoe(){return{}}function toe(){return""}function roe(){return!0}function ioe(f,g){if(f=dt(f),f<1||f>ae)return[];var S=fe,E=sn(f,fe);g=He(g),f-=fe;for(var O=LI(E,g);++S<f;)g(S);return O}function noe(f){return ct(f)?vr(f,Ga):Es(f)?[f]:ns(eN(Gt(f)))}function soe(f){var g=++mee;return Gt(f)+g}var ooe=rb(function(f,g){return f+g},0),aoe=o3("ceil"),loe=rb(function(f,g){return f/g},1),uoe=o3("floor");function coe(f){return f&&f.length?Zw(f,as,qI):r}function poe(f,g){return f&&f.length?Zw(f,He(g,2),qI):r}function hoe(f){return UL(f,as)}function doe(f,g){return UL(f,He(g,2))}function foe(f){return f&&f.length?Zw(f,as,ZI):r}function yoe(f,g){return f&&f.length?Zw(f,He(g,2),ZI):r}var moe=rb(function(f,g){return f*g},1),goe=o3("round"),voe=rb(function(f,g){return f-g},0);function woe(f){return f&&f.length?PI(f,as):0}function boe(f,g){return f&&f.length?PI(f,He(g,2)):0}return N.after=Gie,N.ary=pN,N.assign=Ane,N.assignIn=IN,N.assignInWith=yb,N.assignWith=Rne,N.at=Cne,N.before=hN,N.bind=v3,N.bindAll=Nse,N.bindKey=dN,N.castArray=ene,N.chain=lN,N.chunk=ure,N.compact=cre,N.concat=pre,N.cond=Dse,N.conforms=Fse,N.constant=I3,N.countBy=wie,N.create=One,N.curry=fN,N.curryRight=yN,N.debounce=mN,N.defaults=Pne,N.defaultsDeep=Lne,N.defer=Bie,N.delay=zie,N.difference=hre,N.differenceBy=dre,N.differenceWith=fre,N.drop=yre,N.dropRight=mre,N.dropRightWhile=gre,N.dropWhile=vre,N.fill=wre,N.filter=_ie,N.flatMap=Tie,N.flatMapDeep=Iie,N.flatMapDepth=Mie,N.flatten=nN,N.flattenDeep=bre,N.flattenDepth=_re,N.flip=qie,N.flow=Use,N.flowRight=Vse,N.fromPairs=Sre,N.functions=Vne,N.functionsIn=Gne,N.groupBy=$ie,N.initial=Tre,N.intersection=Ire,N.intersectionBy=Mre,N.intersectionWith=$re,N.invert=zne,N.invertBy=qne,N.invokeMap=Aie,N.iteratee=M3,N.keyBy=Rie,N.keys=Ci,N.keysIn=os,N.map=ub,N.mapKeys=Wne,N.mapValues=Jne,N.matches=Gse,N.matchesProperty=Bse,N.memoize=pb,N.merge=Zne,N.mergeWith=MN,N.method=zse,N.methodOf=qse,N.mixin=$3,N.negate=hb,N.nthArg=Wse,N.omit=Yne,N.omitBy=Kne,N.once=Hie,N.orderBy=Cie,N.over=Jse,N.overArgs=Wie,N.overEvery=Zse,N.overSome=Yse,N.partial=w3,N.partialRight=gN,N.partition=Oie,N.pick=Xne,N.pickBy=$N,N.property=LN,N.propertyOf=Kse,N.pull=Cre,N.pullAll=oN,N.pullAllBy=Ore,N.pullAllWith=Pre,N.pullAt=Lre,N.range=Xse,N.rangeRight=Qse,N.rearg=Jie,N.reject=kie,N.remove=kre,N.rest=Zie,N.reverse=m3,N.sampleSize=Die,N.set=ese,N.setWith=tse,N.shuffle=Fie,N.slice=Nre,N.sortBy=Vie,N.sortedUniq=Bre,N.sortedUniqBy=zre,N.split=Tse,N.spread=Yie,N.tail=qre,N.take=Hre,N.takeRight=Wre,N.takeRightWhile=Jre,N.takeWhile=Zre,N.tap=cie,N.throttle=Kie,N.thru=lb,N.toArray=SN,N.toPairs=EN,N.toPairsIn=AN,N.toPath=noe,N.toPlainObject=TN,N.transform=rse,N.unary=Xie,N.union=Yre,N.unionBy=Kre,N.unionWith=Xre,N.uniq=Qre,N.uniqBy=eie,N.uniqWith=tie,N.unset=ise,N.unzip=g3,N.unzipWith=aN,N.update=nse,N.updateWith=sse,N.values=Gf,N.valuesIn=ose,N.without=rie,N.words=ON,N.wrap=Qie,N.xor=iie,N.xorBy=nie,N.xorWith=sie,N.zip=oie,N.zipObject=aie,N.zipObjectDeep=lie,N.zipWith=uie,N.entries=EN,N.entriesIn=AN,N.extend=IN,N.extendWith=yb,$3(N,N),N.add=ooe,N.attempt=PN,N.camelCase=cse,N.capitalize=RN,N.ceil=aoe,N.clamp=ase,N.clone=tne,N.cloneDeep=ine,N.cloneDeepWith=nne,N.cloneWith=rne,N.conformsTo=sne,N.deburr=CN,N.defaultTo=jse,N.divide=loe,N.endsWith=pse,N.eq=Wo,N.escape=hse,N.escapeRegExp=dse,N.every=bie,N.find=Sie,N.findIndex=rN,N.findKey=kne,N.findLast=xie,N.findLastIndex=iN,N.findLastKey=Nne,N.floor=uoe,N.forEach=uN,N.forEachRight=cN,N.forIn=Dne,N.forInRight=Fne,N.forOwn=jne,N.forOwnRight=Une,N.get=S3,N.gt=one,N.gte=ane,N.has=Bne,N.hasIn=x3,N.head=sN,N.identity=as,N.includes=Eie,N.indexOf=xre,N.inRange=lse,N.invoke=Hne,N.isArguments=ph,N.isArray=ct,N.isArrayBuffer=lne,N.isArrayLike=ss,N.isArrayLikeObject=Hr,N.isBoolean=une,N.isBuffer=uc,N.isDate=cne,N.isElement=pne,N.isEmpty=hne,N.isEqual=dne,N.isEqualWith=fne,N.isError=b3,N.isFinite=yne,N.isFunction=zl,N.isInteger=vN,N.isLength=db,N.isMap=wN,N.isMatch=mne,N.isMatchWith=gne,N.isNaN=vne,N.isNative=wne,N.isNil=_ne,N.isNull=bne,N.isNumber=bN,N.isObject=Er,N.isObjectLike=Fr,N.isPlainObject=L0,N.isRegExp=_3,N.isSafeInteger=Sne,N.isSet=_N,N.isString=fb,N.isSymbol=Es,N.isTypedArray=Vf,N.isUndefined=xne,N.isWeakMap=Tne,N.isWeakSet=Ine,N.join=Ere,N.kebabCase=fse,N.last=yo,N.lastIndexOf=Are,N.lowerCase=yse,N.lowerFirst=mse,N.lt=Mne,N.lte=$ne,N.max=coe,N.maxBy=poe,N.mean=hoe,N.meanBy=doe,N.min=foe,N.minBy=yoe,N.stubArray=A3,N.stubFalse=R3,N.stubObject=eoe,N.stubString=toe,N.stubTrue=roe,N.multiply=moe,N.nth=Rre,N.noConflict=Hse,N.noop=E3,N.now=cb,N.pad=gse,N.padEnd=vse,N.padStart=wse,N.parseInt=bse,N.random=use,N.reduce=Pie,N.reduceRight=Lie,N.repeat=_se,N.replace=Sse,N.result=Qne,N.round=goe,N.runInContext=Z,N.sample=Nie,N.size=jie,N.snakeCase=xse,N.some=Uie,N.sortedIndex=Dre,N.sortedIndexBy=Fre,N.sortedIndexOf=jre,N.sortedLastIndex=Ure,N.sortedLastIndexBy=Vre,N.sortedLastIndexOf=Gre,N.startCase=Ise,N.startsWith=Mse,N.subtract=voe,N.sum=woe,N.sumBy=boe,N.template=$se,N.times=ioe,N.toFinite=ql,N.toInteger=dt,N.toLength=xN,N.toLower=Ese,N.toNumber=mo,N.toSafeInteger=Ene,N.toString=Gt,N.toUpper=Ase,N.trim=Rse,N.trimEnd=Cse,N.trimStart=Ose,N.truncate=Pse,N.unescape=Lse,N.uniqueId=soe,N.upperCase=kse,N.upperFirst=T3,N.each=uN,N.eachRight=cN,N.first=sN,$3(N,function(){var f={};return Ua(N,function(g,S){zt.call(N.prototype,S)||(f[S]=g)}),f}(),{chain:!1}),N.VERSION=i,uo(["bind","bindKey","curry","curryRight","partial","partialRight"],function(f){N[f].placeholder=N}),uo(["drop","take"],function(f,g){xt.prototype[f]=function(S){S=S===r?1:vi(dt(S),0);var E=this.__filtered__&&!g?new xt(this):this.clone();return E.__filtered__?E.__takeCount__=sn(S,E.__takeCount__):E.__views__.push({size:sn(S,fe),type:f+(E.__dir__<0?"Right":"")}),E},xt.prototype[f+"Right"]=function(S){return this.reverse()[f](S).reverse()}}),uo(["filter","map","takeWhile"],function(f,g){var S=g+1,E=S==K||S==ne;xt.prototype[f]=function(O){var D=this.clone();return D.__iteratees__.push({iteratee:He(O,3),type:S}),D.__filtered__=D.__filtered__||E,D}}),uo(["head","last"],function(f,g){var S="take"+(g?"Right":"");xt.prototype[f]=function(){return this[S](1).value()[0]}}),uo(["initial","tail"],function(f,g){var S="drop"+(g?"":"Right");xt.prototype[f]=function(){return this.__filtered__?new xt(this):this[S](1)}}),xt.prototype.compact=function(){return this.filter(as)},xt.prototype.find=function(f){return this.filter(f).head()},xt.prototype.findLast=function(f){return this.reverse().find(f)},xt.prototype.invokeMap=mt(function(f,g){return typeof f=="function"?new xt(this):this.map(function(S){return E0(S,f,g)})}),xt.prototype.reject=function(f){return this.filter(hb(He(f)))},xt.prototype.slice=function(f,g){f=dt(f);var S=this;return S.__filtered__&&(f>0||g<0)?new xt(S):(f<0?S=S.takeRight(-f):f&&(S=S.drop(f)),g!==r&&(g=dt(g),S=g<0?S.dropRight(-g):S.take(g-f)),S)},xt.prototype.takeRightWhile=function(f){return this.reverse().takeWhile(f).reverse()},xt.prototype.toArray=function(){return this.take(fe)},Ua(xt.prototype,function(f,g){var S=/^(?:filter|find|map|reject)|While$/.test(g),E=/^(?:head|last)$/.test(g),O=N[E?"take"+(g=="last"?"Right":""):g],D=E||/^find/.test(g);O&&(N.prototype[g]=function(){var G=this.__wrapped__,H=E?[1]:arguments,Y=G instanceof xt,ce=H[0],pe=Y||ct(G),me=function(_t){var Mt=O.apply(N,rc([_t],H));return E&&Te?Mt[0]:Mt};pe&&S&&typeof ce=="function"&&ce.length!=1&&(Y=pe=!1);var Te=this.__chain__,Ve=!!this.__actions__.length,Je=D&&!Te,yt=Y&&!Ve;if(!D&&pe){G=yt?G:new xt(this);var Ze=f.apply(G,H);return Ze.__actions__.push({func:lb,args:[me],thisArg:r}),new po(Ze,Te)}return Je&&yt?f.apply(this,H):(Ze=this.thru(me),Je?E?Ze.value()[0]:Ze.value():Ze)})}),uo(["pop","push","shift","sort","splice","unshift"],function(f){var g=Lw[f],S=/^(?:push|sort|unshift)$/.test(f)?"tap":"thru",E=/^(?:pop|shift)$/.test(f);N.prototype[f]=function(){var O=arguments;if(E&&!this.__chain__){var D=this.value();return g.apply(ct(D)?D:[],O)}return this[S](function(G){return g.apply(ct(G)?G:[],O)})}}),Ua(xt.prototype,function(f,g){var S=N[g];if(S){var E=S.name+"";zt.call(Nf,E)||(Nf[E]=[]),Nf[E].push({name:g,func:S})}}),Nf[tb(r,x).name]=[{name:"wrapper",func:r}],xt.prototype.clone=Lee,xt.prototype.reverse=kee,xt.prototype.value=Nee,N.prototype.at=pie,N.prototype.chain=hie,N.prototype.commit=die,N.prototype.next=fie,N.prototype.plant=mie,N.prototype.reverse=gie,N.prototype.toJSON=N.prototype.valueOf=N.prototype.value=vie,N.prototype.first=N.prototype.head,_0&&(N.prototype[_0]=yie),N},Pf=dee();ih?((ih.exports=Pf)._=Pf,MI._=Pf):Bi._=Pf}).call(k0)})(vS,vS.exports);var Doe=vS.exports;const hO=_oe(Doe);function l(e,t,r,i){var n,s=arguments.length,o=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,r):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(o=(s<3?n(o):s>3?n(t,r,o):n(t,r))||o);return s>3&&o&&Object.defineProperty(t,r,o),o}function tNe(e,t){return function(r,i){t(r,i,e)}}function rNe(e,t,r,i){function n(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(h){try{c(i.next(h))}catch(d){o(d)}}function u(h){try{c(i.throw(h))}catch(d){o(d)}}function c(h){h.done?s(h.value):n(h.value).then(a,u)}c((i=i.apply(e,[])).next())})}const Foe=/\{([^\}]+)\}/g;function UN(e){return e??""}function Nx(e,t){return t?e.replaceAll(Foe,typeof t=="object"?(r,i)=>UN(Av(i,t)):(r,i)=>UN(t(i))):e}function iNe(e,t){return e.replaceAll(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,r=>t&&t.includes(r)?r:`\\${r}`)}function aV(e){let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r),t|=0;return t}function nNe(e){return new DOMParser().parseFromString(e||"","text/html").body.innerText||""}function sNe(e,t){return new RegExp(`{${t}}`,"ig").test(e)}const VN={info:0,warn:1,error:2,none:3};let oe=class hn{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},t.level!=null&&(this.level=t.level),t.writer!=null&&(this.writer=t.writer),this._module=t.module,hn._loggers.set(this.module,this);const r=this.module.lastIndexOf(".");r!==-1&&(this._parent=hn.getLogger(this.module.slice(0,r)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get test(){return{resetLoggers(t=new Map){const r=hn._loggers;return hn._loggers=t,r},set throttlingDisabled(t){hn._throttlingDisabled=t}}}static getLogger(t){return t=typeof t!="string"?t.declaredClass:t,hn._loggers.get(t)||new hn({module:t})}_log(t,r,...i){if(this._matchLevel(t)){if(r!=="always"&&!hn._throttlingDisabled){const n=this._argsToKey(i),s=this._loggedMessages[t].get(n);if(r==="once"&&s!=null||r==="oncePerTick"&&s&&s>=hn._tickCounter)return;this._loggedMessages[t].set(n,hn._tickCounter),hn._scheduleTickCounterIncrement()}for(const n of Kt.log.interceptors)if(n(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}}_parentWithMember(t,r){let i=this;for(;i!=null;){const n=i[t];if(n!=null)return n;i=i.parent}return r}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,r,...i){console[t](`[${r}]`,...i)}_matchLevel(t){const r=Kt.log.level||"warn";return VN[this._parentWithMember("level",r)]<=VN[t]}_argsToKey(...t){return aV(JSON.stringify(t,(i,n)=>typeof n!="object"||Array.isArray(n)?n:"[Object]"))}static _scheduleTickCounterIncrement(){hn._tickCounterScheduled||(hn._tickCounterScheduled=!0,Promise.resolve().then(()=>{hn._tickCounter++,hn._tickCounterScheduled=!1}))}};oe._loggers=new Map,oe._tickCounter=0,oe._tickCounterScheduled=!1,oe._throttlingDisabled=!1;function Dx(e,t){for(const[r,i]of e)if(t(i,r))return!0;return!1}function Ov(e,t,r){const i=e.get(t);if(i!==void 0)return i;const n=r();return e.set(t,n),n}function oNe(e){const t=new Map;return r=>(t.has(r)||t.set(r,e(r)),t.get(r))}const Yy=()=>oe.getLogger("esri.core.accessorSupport.ensureTypes");function joe(e){return e==null?e:new Date(e)}function Uoe(e){return e==null?e:!!e}function Pv(e){return e==null?e:e.toString()}function Ws(e){return e==null?e:(e=parseFloat(e),isNaN(e)?0:e)}function Fx(e){return e==null?e:Math.round(parseFloat(e))}function lV(e){return(e==null?void 0:e.constructor)&&e.constructor.__accessorMetadata__!==void 0}function wS(e,t){return t!=null&&e&&!(t instanceof e)}function uV(e){return e&&"isCollection"in e}function GN(e){return e!=null&&e.Type?typeof e.Type=="function"?e.Type:e.Type.base:null}function Voe(e,t){if(!(t!=null&&t.constructor)||!uV(t.constructor))return T$(e,t)?t:new e(t);const r=GN(e.prototype.itemType),i=GN(t.constructor.prototype.itemType);return r?i?r===i?t:r.prototype.isPrototypeOf(i.prototype)?new e(t):(T$(e,t),t):new e(t):t}function T$(e,t){return!!lV(t)&&(Yy().error("Accessor#set","Assigning an instance of '"+(t.declaredClass||"unknown")+"' which is not a subclass of '"+jx(e)+"'"),!0)}function rr(e,t){return t==null?t:uV(e)?Voe(e,t):wS(e,t)?T$(e,t)?t:new e(t):t}function jx(e){var t;return((t=e==null?void 0:e.prototype)==null?void 0:t.declaredClass)||"unknown"}const Goe=new WeakMap;function Boe(e){switch(e){case Number:return Ws;case Ke:return Fx;case Boolean:return Uoe;case String:return Pv;case Date:return joe;default:return Ov(Goe,e,()=>rr.bind(null,e))}}function Lr(e,t){const r=Boe(e);return arguments.length===1?r:r(t)}function Y1(e,t,r){return arguments.length===1?Y1.bind(null,e):t&&(Array.isArray(t)?t.map(i=>e(i,r)):[e(t,r)])}function zoe(e,t){return arguments.length===1?Y1(r=>Lr(e,r)):Y1(r=>Lr(e,r),t)}function cV(e,t,r){return t!==0&&Array.isArray(r)?r.map(i=>cV(e,t-1,i)):e(r)}function bS(e,t,r){if(arguments.length===2)return s=>bS(e,t,s);if(!r)return r;r=cV(e,t,r);let i=t,n=r;for(;i>0&&Array.isArray(n);)i--,n=n[0];if(n!==void 0)for(let s=0;s<i;s++)r=[r];return r}function qoe(e,t,r){return arguments.length===2?bS(i=>Lr(e,i),t):bS(i=>Lr(e,i),t,r)}function pV(e){return!!Array.isArray(e)&&!e.some(t=>{const r=typeof t;return!(r==="string"||r==="number"||r==="function"&&e.length>1)})}function I$(e,t){if(arguments.length===2)return I$(e).call(null,t);const r=new Set,i=e.filter(a=>typeof a!="function"),n=e.filter(a=>typeof a=="function");for(const a of e)typeof a!="string"&&typeof a!="number"||r.add(a);let s=null,o=null;return(a,u)=>{if(a==null)return a;const c=typeof a,h=c==="string"||c==="number";return h&&(r.has(a)||n.some(d=>c==="string"&&d===String||c==="number"&&d===Number))||c==="object"&&n.some(d=>!wS(a,d))?a:(h&&i.length?(s||(s=i.map(d=>typeof d=="string"?`'${d}'`:`${d}`).join(", ")),Yy().error("Accessor#set",`'${a}' is not a valid value for this property, only the following values are valid: ${s}`)):typeof a=="object"&&n.length?(o||(o=n.map(d=>jx(d)).join(", ")),Yy().error("Accessor#set",`'${a}' is not a valid value for this property, value must be one of ${o}`)):Yy().error("Accessor#set",`'${a}' is not a valid value for this property`),u&&(u.valid=!1),null)}}function Tl(e,t){if(arguments.length===2)return Tl(e).call(null,t);const r={},i=[],n=[];for(const u in e.typeMap){const c=e.typeMap[u];r[u]=Lr(c),i.push(jx(c)),n.push(u)}const s=()=>`'${i.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a=typeof e.key=="string"?u=>u[e.key]:e.key;return u=>{if(e.base&&!wS(e.base,u)||u==null)return u;const c=a(u)||e.defaultKeyValue,h=r[c];if(!h)return Yy().error("Accessor#set",`Invalid property value, value needs to be one of ${s()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!wS(e.typeMap[c],u))return u;if(typeof e.key=="string"&&!lV(u)){const d={};for(const y in u)y!==e.key&&(d[y]=u[y]);return h(d)}return h(u)}}let Ke=class{};const N0={native:e=>({type:"native",value:e}),array:e=>({type:"array",value:e}),oneOf:e=>({type:"one-of",values:e})};function Hoe(e){if(!e||!("type"in e))return!1;switch(e.type){case"native":case"array":case"one-of":return!0}return!1}function hV(e){switch(e.type){case"native":return Lr(e.value);case"array":return Y1(hV(e.value));case"one-of":return Woe(e);default:return null}}function Woe(e){let t=null;return(r,i)=>$$(r,e)?r:(t==null&&(t=M$(e)),Yy().error("Accessor#set",`Invalid property value, value needs to be of type ${t}`),i&&(i.valid=!1),null)}function M$(e){switch(e.type){case"native":switch(e.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Ke:return"integer";case Date:return"date";default:return jx(e.value)}case"array":return`array of ${M$(e.value)}`;case"one-of":{const t=e.values.map(r=>M$(r));return`one of ${t.slice(0,-1)} or ${t[t.length-1]}`}}return"unknown"}function $$(e,t){if(e==null)return!0;switch(t.type){case"native":switch(t.value){case Number:case Ke:return typeof e=="number";case Boolean:return typeof e=="boolean";case String:return typeof e=="string"}return e instanceof t.value;case"array":return!!Array.isArray(e)&&!e.some(r=>!$$(r,t.value));case"one-of":return t.values.some(r=>$$(e,r))}}const Joe={remove:()=>{}};function Xt(e){return e?{remove(){e&&(e(),e=void 0)}}:Joe}function Zoe(e){e.forEach(t=>t==null?void 0:t.remove())}function Lv(e){return Xt(()=>Zoe(e))}function Mi(e){return e.__accessor__??null}function Yoe(e,t){var r;return((r=e==null?void 0:e.metadata)==null?void 0:r[t])!=null}function R_(e,t,r){return r?_S(e,t,{policy:r,path:""}):_S(e,t,null)}function _S(e,t,r){return t?Object.keys(t).reduce((i,n)=>{const s=n;let o=null,a="merge";if(r&&(o=r.path?`${r.path}.${n}`:n,a=r.policy(o)),a==="replace"||a==="replace-arrays"&&Array.isArray(i[s]))return i[s]=t[s],i;if(i[s]===void 0)return i[s]=B(t[s]),i;let u=i[s],c=t[s];if(u===c)return i;if(Array.isArray(c)||Array.isArray(i))u=u?Array.isArray(u)?i[s]=u.concat():i[s]=[u]:i[s]=[],c&&(Array.isArray(c)||(c=[c]),c.forEach(h=>{u.includes(h)||u.push(h)}));else if(c&&typeof c=="object")if(r){const h=r.path;r.path=o,i[s]=_S(u,c,r),r.path=h}else i[s]=_S(u,c,null);else i.hasOwnProperty(n)&&!t.hasOwnProperty(n)||(i[s]=c);return i},e||{}):e}function dV(e){return Array.isArray(e)?e:e.split(".")}function BN(e){return e.includes(",")?e.split(",").map(t=>t.trim()):[e.trim()]}function Koe(e){if(Array.isArray(e)){const t=[];for(const r of e)t.push(...BN(r));return t}return BN(e)}function fV(e,t,r,i){const n=Koe(t);if(n.length!==1){const s=n.map(o=>i(e,o,r));return Lv(s)}return i(e,n[0],r)}function yV(e,t){const r=e[e.length-1]==="?"?e.slice(0,-1):e;if(t.getItemAt!=null||Array.isArray(t)){const n=parseInt(r,10);if(!isNaN(n))return Array.isArray(t)?t[n]:t.at(n)}const i=Mi(t);return Yoe(i,r)?i.get(r):t[r]}function mV(e,t,r){if(e==null)return e;const i=yV(t[r],e);return!i&&r<t.length-1?void 0:r===t.length-1?i:mV(i,t,r+1)}function kv(e,t,r=0){return typeof t!="string"||t.includes(".")?mV(e,dV(t),r):yV(t,e)}function Ra(e,t){return kv(e,t)}function zN(e,t){return kv(t,e)!==void 0}function Nv(e){let t=e.constructor.__accessorMetadata__;const r=Object.prototype.hasOwnProperty.call(e.constructor,"__accessorMetadata__");if(t){if(!r){t=Object.create(t);for(const i in t)t[i]=B(t[i]);Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0})}}else t={},Object.defineProperty(e.constructor,"__accessorMetadata__",{value:t,enumerable:!1,configurable:!0,writable:!0});return e.constructor.__accessorMetadata__}function Ux(e,t){const r=Nv(e);let i=r[t];return i||(i=r[t]={}),i}function Xoe(e,t){return R_(e,t,eae)}const Qoe=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function eae(e){return Qoe.test(e)?"replace":"merge"}function tae(e,t){return e.replaceAll(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(r,i)=>i===""?"$":(Av(i,t)??"").toString())}let gV=class{constructor(t,r,i){this.name=t,this.details=i,this.message=(r&&tae(r,i))??""}toString(){return"["+this.name+"]: "+this.message}},z=class vV extends gV{constructor(t,r,i){super(t,r,i)}toJSON(){if(this.details!=null)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,(t,r)=>{if(r&&typeof r=="object"&&typeof r.toJSON=="function")return r;try{return B(r)}catch{return"[object]"}}))}}catch(t){throw oe.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new vV(t.name,t.message,t.details)}};z.prototype.type="error";function SS(e,t,r){if(e&&t)if(typeof t=="object")for(const i of Object.getOwnPropertyNames(t))SS(e,i,t[i]);else{if(t.includes(".")){const n=t.split("."),s=n.splice(-1,1)[0];return void SS(Ra(e,n),s,r)}const i=e.__accessor__;i!=null&&rae(t,i),e[t]=r}}function rae(e,t){if(Me("esri-unknown-property-errors")&&!iae(e,t))throw new z("set:unknown-property",nae(e,t))}function iae(e,t){return t.metadata[e]!=null}function nae(e,t){return"setting unknown property '"+e+"' on instance of "+t.host.declaredClass}function p(e={}){return(t,r)=>{if(t===Function.prototype)throw new Error(`Inappropriate use of @property() on a static field: ${t.name}.${r}. Accessor does not support static properties.`);const i=Object.getOwnPropertyDescriptor(t,r),n=Ux(t,r);i&&(i.get||i.set?(n.get=i.get||n.get,n.set=i.set||n.set):"value"in i&&("value"in e&&oe.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${r}" on "${t.constructor.name}" already defined in the metadata`,e),n.value=e.value=i.value)),e.readOnly!=null&&(n.readOnly=e.readOnly);const s=e.aliasOf;if(s){const u=typeof s=="string"?s:s.source,c=typeof s=="string"?null:s.overridable===!0;let h;n.dependsOn=[u],n.get=function(){let d=Ra(this,u);if(typeof d=="function"){h||(h=u.split(".").slice(0,-1).join("."));const y=Ra(this,h);y&&(d=d.bind(y))}return d},n.readOnly||(n.set=c?function(d){this._override(r,d)}:function(d){SS(this,u,d)})}const o=e.type,a=e.types;n.cast||(o?n.cast=sae(o):a&&(Array.isArray(a)?n.cast=Y1(Tl(a[0])):n.cast=Tl(a))),Xoe(n,e),e.range&&(n.cast=bV(n.cast,e.range))}}function wV(e,t,r){const i=Ux(e,r);i.json||(i.json={});let n=i.json;return t!==void 0&&(n.origins||(n.origins={}),n.origins[t]||(n.origins[t]={}),n=n.origins[t]),n}function sae(e){let t=0,r=e;if(Hoe(e))return hV(e);for(;Array.isArray(r)&&r.length===1&&typeof r[0]!="string"&&typeof r[0]!="number";)r=r[0],t++;const i=r;if(pV(i))return t===0?I$(i):bS(I$(i),t);if(t===1)return zoe(i);if(t>1)return qoe(i,t);const n=e;return n.from?n.from:Lr(n)}function bV(e,t){return r=>{let i=+e(r);return t.step!=null&&(i=Math.round(i/t.step)*t.step),t.min!=null&&(i=Math.max(t.min,i)),t.max!=null&&(i=Math.min(t.max,i)),i}}const _V=Symbol("Accessor-beforeDestroy");var gs;(function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.CONSTRUCTING=1]="CONSTRUCTING",e[e.CONSTRUCTED=2]="CONSTRUCTED",e[e.DESTROYED=3]="DESTROYED"})(gs||(gs={}));var Bt;(function(e){e[e.Dirty=1]="Dirty",e[e.Overridden=2]="Overridden",e[e.Computing=4]="Computing",e[e.NonNullable=8]="NonNullable",e[e.HasDefaultValue=16]="HasDefaultValue",e[e.DepTrackingInitialized=32]="DepTrackingInitialized",e[e.AutoTracked=64]="AutoTracked",e[e.ExplicitlyTracking=128]="ExplicitlyTracking"})(Bt||(Bt={}));const xS={onObservableAccessed:()=>{},onTrackingEnd:()=>{}},pg=[];let y1=xS;function Ge(e){y1.onObservableAccessed(e)}let C_=!1,O_=!1;function Vu(e,t,r){if(C_)return dO(e,t,r);SV(e);const i=t.call(r);return xV(),i}function oae(e,t){return Vu(xS,e,t)}function dO(e,t,r){const i=C_;C_=!0,SV(e);let n=null;try{n=t.call(r)}catch(s){O_&&oe.getLogger("esri.core.accessorSupport.tracking").error(s)}return xV(),C_=i,n}function SV(e){y1=e,pg.push(e)}function xV(){const e=pg.length;if(e>1){const t=pg.pop();y1=pg[e-2],t.onTrackingEnd()}else if(e===1){const t=pg.pop();y1=xS,t.onTrackingEnd()}else y1=xS}function TV(e,t){if(t.flags&Bt.DepTrackingInitialized)return;const r=O_;O_=!1,t.flags&Bt.AutoTracked?dO(t,t.metadata.get,e):IV(e,t),O_=r}const aae=[];function IV(e,t){t.flags&Bt.ExplicitlyTracking||(t.flags|=Bt.ExplicitlyTracking,dO(t,()=>{const r=t.metadata.dependsOn||aae;for(const i of r)if(typeof i!="string"||i.includes(".")){const n=dV(i);for(let s=0,o=e;s<n.length&&o!=null&&typeof o=="object";++s)o=qN(o,n[s],s!==n.length-1)}else qN(e,i,!1)}),t.flags&=~Bt.ExplicitlyTracking)}function qN(e,t,r){const i=t[t.length-1]==="?"?t.slice(0,-1):t;if(e.getItemAt!=null||Array.isArray(e)){const s=parseInt(i,10);if(!isNaN(s))return Array.isArray(e)?e[s]:e.at(s)}const n=Mi(e);if(n){const s=n.propertiesByName.get(i);s&&(Ge(s),TV(e,s))}return r?e[i]:void 0}function lae(e){if(e.json&&e.json.origins){const t=e.json.origins,r={"web-document":["web-scene","web-map"]};for(const i in r)if(t[i]){const n=t[i];r[i].forEach(s=>{t[s]=n}),delete t[i]}}}let eo=class extends gV{constructor(t,r,i){super(t,r,i)}};eo.prototype.type="warning";function MV(e){var t;return!!e&&((t=e.prototype)==null?void 0:t.declaredClass)&&e.prototype.declaredClass.indexOf("esri.core.Collection")===0}const E$=()=>oe.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function HN(e,t,r){var i,n;e&&(!r&&!t.read||(i=t.read)!=null&&i.reader||((n=t.read)==null?void 0:n.enabled)===!1||pae(e)&&En("read.reader",Vm(e),t))}function Vm(e){var r,i;const t=e.ndimArray??0;if(t>1)return cae(e);if(t===1)return WN(e);if("type"in e&&EV(e.type)){const n=(i=(r=e.type.prototype)==null?void 0:r.itemType)==null?void 0:i.Type,s=WN(typeof n=="function"?{type:n}:{types:n});return(o,a,u)=>{const c=s(o,a,u);return c&&new e.type(c)}}return fO(e)}function fO(e){return"type"in e?uae(e.type):hae(e.types)}function uae(e){return e.prototype.read?(t,r,i)=>{if(t==null)return t;const n=typeof t;if(n!=="object")return void E$().error(`Expected JSON value of type 'object' to deserialize type '${e.prototype.declaredClass}', but got '${n}'`);const s=new e;return s.read(t,i),s}:e.fromJSON}function $V(e,t,r,i){return i!==0&&Array.isArray(t)?t.map(n=>$V(e,n,r,i-1)):e(t,void 0,r)}function cae(e){const t=fO(e),r=$V.bind(null,t),i=e.ndimArray??0;return(n,s,o)=>{if(n==null)return n;n=r(n,o,i);let a=i,u=n;for(;a>0&&Array.isArray(u);)a--,u=u[0];if(u!==void 0)for(let c=0;c<a;c++)n=[n];return n}}function WN(e){const t=fO(e);return(r,i,n)=>{if(r==null)return r;if(Array.isArray(r)){const o=[];for(const a of r){const u=t(a,void 0,n);u!==void 0&&o.push(u)}return o}const s=t(r,void 0,n);return s!==void 0?[s]:void 0}}function EV(e){if(!MV(e))return!1;const t=e.prototype.itemType;return!(!t||!t.Type)&&(typeof t.Type=="function"?yO(t.Type):AV(t.Type))}function pae(e){return"types"in e?AV(e.types):yO(e.type)}function yO(e){return!Array.isArray(e)&&!!e&&e.prototype&&("read"in e.prototype||"fromJSON"in e||EV(e))}function AV(e){for(const t in e.typeMap)if(!yO(e.typeMap[t]))return!1;return!0}function hae(e){let t=null;const r=e.errorContext??"type",i=e.validate;return(n,s,o)=>{if(n==null)return n;const a=typeof n;if(a!=="object")return void E$().error(`Expected JSON value of type 'object' to deserialize, but got '${a}'`);t||(t=dae(e));const u=e.key;if(typeof u!="string")return;const c=n[u],h=c?t[c]:e.defaultKeyValue?e.typeMap[e.defaultKeyValue]:void 0;if(!h){const y=`Type '${c||"unknown"}' is not supported`;return o!=null&&o.messages&&n&&o.messages.push(new eo(`${r}:unsupported`,y,{definition:n,context:o})),void E$().error(y)}const d=new h;return d.read(n,o),i?i(d):d}}function dae(e){var r,i;const t={};for(const n in e.typeMap){const s=e.typeMap[n],o=Nv(s.prototype);if(typeof e.key=="function")continue;const a=o[e.key];if(!a)continue;(r=a.json)!=null&&r.type&&Array.isArray(a.json.type)&&a.json.type.length===1&&typeof a.json.type[0]=="string"&&(t[a.json.type[0]]=s);const u=(i=a.json)==null?void 0:i.write;if(!(u!=null&&u.writer)){t[n]=s;continue}const c=u.target,h=typeof c=="string"?c:e.key,d={};u.writer(n,d,h),d[h]&&(t[d[h]]=s)}return t}function fae(e){if(e.json||(e.json={}),ZN(e.json),YN(e.json),JN(e.json),e.json.origins)for(const t in e.json.origins)ZN(e.json.origins[t]),YN(e.json.origins[t]),JN(e.json.origins[t]);return!0}function JN(e){e.name&&(e.read&&typeof e.read=="object"?e.read.source===void 0&&(e.read.source=e.name):e.read={source:e.name},e.write&&typeof e.write=="object"?e.write.target===void 0&&(e.write.target=e.name):e.write={target:e.name})}function ZN(e){typeof e.read=="boolean"?e.read={enabled:e.read}:typeof e.read=="function"?e.read={enabled:!0,reader:e.read}:e.read&&typeof e.read=="object"&&e.read.enabled===void 0&&(e.read.enabled=!0)}function YN(e){typeof e.write=="boolean"?e.write={enabled:e.write}:typeof e.write=="function"?e.write={enabled:!0,writer:e.write}:e.write&&typeof e.write=="object"&&e.write.enabled===void 0&&(e.write.enabled=!0)}function KN(e,t){if(!t.write||t.write.writer||t.write.enabled===!1&&!t.write.overridePolicy)return;const r=(e==null?void 0:e.ndimArray)??0;e&&(r===1||"type"in e&&MV(e.type))?t.write.writer=gae:r>1?t.write.writer=vae(r):t.types?Array.isArray(t.types)?t.write.writer=mae(t.types[0]):t.write.writer=yae(t.types):t.write.writer=K1}function yae(e){return(t,r,i,n)=>t?RV(t,e,n)?K1(t,r,i,n):void 0:K1(t,r,i,n)}function RV(e,t,r){for(const i in t.typeMap)if(e instanceof t.typeMap[i])return!0;if(r!=null&&r.messages){const i=t.errorContext??"type",n=`Values of type '${(typeof t.key!="function"?e[t.key]:e.declaredClass)??"Unknown"}' cannot be written`;r&&r.messages&&e&&r.messages.push(new z(`${i}:unsupported`,n,{definition:e,context:r})),oe.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer").error(n)}return!1}function mae(e){return(t,r,i,n)=>!t||!Array.isArray(t)?K1(t,r,i,n):K1(t.filter(s=>RV(s,e,n)),r,i,n)}function K1(e,t,r,i){En(r,TS(e,i),t)}function TS(e,t){return e&&typeof e.write=="function"?e.write({},t):e&&typeof e.toJSON=="function"?e.toJSON():typeof e=="number"?IS(e):e}function IS(e){return e===-1/0?-Number.MAX_VALUE:e===1/0?Number.MAX_VALUE:isNaN(e)?null:e}function gae(e,t,r,i){let n;e===null?n=null:e&&typeof e.map=="function"?(n=e.map(s=>TS(s,i)),typeof n.toArray=="function"&&(n=n.toArray())):n=[TS(e,i)],En(r,n,t)}function CV(e,t,r){return r!==0&&Array.isArray(e)?e.map(i=>CV(i,t,r-1)):TS(e,t)}function vae(e){return(t,r,i,n)=>{let s;if(t===null)s=null;else{s=CV(t,n,e);let o=e,a=s;for(;o>0&&Array.isArray(a);)o--,a=a[0];if(a!==void 0)for(let u=0;u<o;u++)s=[s]}En(i,s,r)}}function wae(e,t){return mO(e,"any",t==null?void 0:t.origin)}function A$(e,t){return mO(e,"read",t==null?void 0:t.origin)}function OV(e,t){return mO(e,"write",t==null?void 0:t.origin)}function mO(e,t,r){let i=e==null?void 0:e.json;if(i!=null&&i.origins&&r){let n;n=r==="link-chart"?i.origins[r]&&(t==="any"||t in i.origins[r])?i.origins[r]:i.origins["web-map"]:i.origins[r],n&&(t==="any"||t in n)&&(i=n)}return i}function bae(e){const t=_ae(e);if(e.json.origins)for(const r in e.json.origins){const i=e.json.origins[r],n=i.types?Sae(i):t;HN(n,i,!1),i.types&&!i.write&&e.json.write&&e.json.write.enabled&&(i.write={...e.json.write}),KN(n,i)}HN(t,e.json,!0),KN(t,e.json)}function _ae(e){return e.json.types?R$(e.json):e.type?PV(e):R$(e)}function Sae(e){return e.type?PV(e):R$(e)}function PV(e){if(!e.type)return;let t=0,r=e.type;for(;Array.isArray(r)&&!pV(r);)r=r[0],t++;return{type:r,ndimArray:t}}function R$(e){if(!e.types)return;let t=0,r=e.types;for(;Array.isArray(r);)r=r[0],t++;return{types:r,ndimArray:t}}function xae(e){fae(e)&&(lae(e),bae(e))}const C3=new Set,O3=new Set;function k(e){return t=>{e??(e="esri.core.Accessor"),t.prototype.declaredClass=e,Iae(t);const r=[],i=[];let n=t.prototype;for(;n;)n.hasOwnProperty("initialize")&&!C3.has(n.initialize)&&(C3.add(n.initialize),r.push(n.initialize)),n.hasOwnProperty("destroy")&&!O3.has(n.destroy)&&(O3.add(n.destroy),i.push(n.destroy)),n=Object.getPrototypeOf(n);C3.clear(),O3.clear();const s=class extends t{constructor(...a){if(super(...a),this.constructor===s&&typeof this.postscript=="function"){if(r.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let u=r.length-1;u>=0;u--)r[u].call(this)}}),i.length){let u=!1;const c=this[_V];Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!u){u=!0,c.call(this);for(let h=0;h<i.length;h++)i[h].call(this)}}})}Object.defineProperty(this,Symbol.dispose,{enumerable:!1,configurable:!0,value(){this.destroy()}}),this.postscript(...a)}}};s.__accessorMetadata__=Nv(t.prototype),s.prototype.declaredClass=e;const o=(e||"AccessorSubclass").split(".").slice(-1)[0];return Object.defineProperty(s,"name",{value:o,configurable:!0}),s}}function Tae(e,t){return t.get==null?function(){const r=this.__accessor__,i=r.propertiesByName.get(e);if(i===void 0)return;Ge(i);const n=r.store;return n.has(e)?n.get(e):i.metadata.value}:function(){const r=this.__accessor__,i=r.propertiesByName.get(e);if(i!==void 0)return i.getComputed(r)}}function Iae(e){const t=e.prototype,r=Nv(t),i={};for(const n of Object.getOwnPropertyNames(r)){const s=r[n];xae(s),i[n]={enumerable:!0,configurable:!0,get:Tae(n,s),set(o){const a=this.__accessor__;if(a!==void 0){if(!Object.isFrozen(this)){if(a.initialized&&s.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${n}' of ${this.declaredClass}`);if(a.lifecycle===gs.CONSTRUCTED&&s.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${n}' of ${this.declaredClass}`);a.set(n,o)}}else Object.defineProperty(this,n,{enumerable:!0,configurable:!0,writable:!0,value:o})}}}Object.defineProperties(e.prototype,i)}const XN=new WeakMap;function Mae(e,t,r=!1){const i=`🛑 DEPRECATED - ${t}`;if(!r)return void e.warn(i);let n=XN.get(e);n||(n=new Set,XN.set(e,n)),n.has(t)||(n.add(t),e.warn(i))}function LV(e,t,r={}){if(Me("esri-deprecation-warnings")){const{moduleName:i}=r;fm(e,`Function: ${(i?i+"::":"")+t+"()"}`,r)}}function Ma(e,t,r={}){if(Me("esri-deprecation-warnings")){const{moduleName:i}=r;fm(e,`Property: ${(i?i+"::":"")+t}`,r)}}function fm(e,t,r={}){if(Me("esri-deprecation-warnings")){const{replacement:i,version:n,see:s,warnOnce:o}=r;let a=t;i&&(a+=`
	🛠️ Replacement: ${i}`),n&&(a+=`
	⚙️ Version: ${n}`),s&&(a+=`
	🔗 See ${s} for more details.`),Mae(e,a,o)}}function cNe(e){const t=[];return function*(){yield*t;for(const r of e)t.push(r),yield r}}function $ae(e,t){for(const r of e)if(r!=null&&t(r))return r}function MS(e){return e!=null&&typeof e[Symbol.iterator]=="function"}let gO=class C${constructor(){this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach(r=>{t+=r.length}),t}add(t,r){if(MS(t)){const i=this._getOrCreateGroup(r);for(const n of t)this._isHandle(n)&&i.push(n)}else this._isHandle(t)&&this._getOrCreateGroup(r).push(t);return this}forEach(t,r){if(typeof t=="function")this._groups.forEach(i=>i.forEach(t));else{const i=this._getGroup(t);i&&r&&i.forEach(r)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(typeof t!="string"&&MS(t)){for(const r of t)this.remove(r);return this}return this.has(t)?(this._removeAllFromGroup(this._getGroup(t)),this._groups.delete(this._ensureGroupKey(t)),this):this}removeAll(){return this._groups.forEach(t=>this._removeAllFromGroup(t)),this._groups.clear(),this}_isHandle(t){return t&&(!!t.remove||t instanceof C$)}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const r=[];return this._groups.set(this._ensureGroupKey(t),r),r}_getGroup(t){return this._groups.get(this._ensureGroupKey(t))}_ensureGroupKey(t){return t||"_default_"}_removeAllFromGroup(t){for(const r of t)r instanceof C$?r.removeAll():r.remove()}};function wp(e,t){if(e==null)throw new Error(t??"value is None")}function cr(e){return e==null||e.destroy(),null}function pNe(e){return e==null||e.dispose(),null}function Tr(e){return e==null||e.remove(),null}function X1(e){return e==null||e.abort(),null}function hNe(e){return e==null||e.release(),null}function Eae(e,t,r){return e!=null&&t!=null?r!=null?r(e,t):e.equals(t):e===t}function Aae(e,t){let r;return e.some((i,n)=>(r=t(i,n),r!=null)),r??void 0}function Rae(e){return(e==null?void 0:e.release)&&typeof e.release=="function"}function Cae(e){return(e==null?void 0:e.acquire)&&typeof e.acquire=="function"}let Np=class O${constructor(t,r,i,n=1,s=0){if(this._ctor=t,this._acquireFunction=r,this._releaseFunction=i,this.allocationSize=n,this._pool=new Array(s),this._initialSize=s,this._ctor)for(let o=0;o<s;o++)this._pool[o]=new this._ctor;this.allocationSize=Math.max(n,1)}destroy(){this.prune(0)}acquire(...t){let r;if(O$.test.disabled)r=new this._ctor;else{if(this._pool.length===0){const i=this.allocationSize;for(let n=0;n<i;n++)this._pool[n]=new this._ctor}r=this._pool.pop()}return this._acquireFunction?this._acquireFunction(r,...t):Cae(r)&&r.acquire(...t),r}release(t){t&&!O$.test.disabled&&(this._releaseFunction?this._releaseFunction(t):Rae(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let r=t;r<this._pool.length;++r){const i=this._pool[r];this._dispose(i)}this._pool.length=t}}_dispose(t){t.dispose&&typeof t.dispose=="function"&&t.dispose()}};Np.test={disabled:!1};let Oae=class{constructor(t,r){this._observers=t,this._observer=r}remove(){Soe(this._observers,this._observer)}},kV=class{constructor(){this._observers=null,this.destroyed=!1}observe(t){if(this.destroyed||t.destroyed)return Pae;this._observers==null&&(this._observers=[]);const r=this._observers;let i=!1,n=!1;const s=r.length;for(let o=0;o<s;++o){const a=r[o];if(a.destroyed)n=!0;else if(a===t){i=!0;break}}return i||(r.push(t),n&&this._removeDestroyedObservers()),new Oae(r,t)}_removeDestroyedObservers(){const t=this._observers;if(!t||t.length===0)return;const r=t.length;let i=0;for(let n=0;n<r;++n){for(;n+i<r&&t[n+i].destroyed;)++i;if(i>0){if(!(n+i<r))break;t[n]=t[n+i]}}t.length=r-i}destroy(){if(this.destroyed)return;this.destroyed=!0;const t=this._observers;if(t!=null){for(const r of t)r.onCommitted();this._observers=null}}};const Pae=Xt();var _e;(function(e){e[e.DEFAULTS=0]="DEFAULTS",e[e.COMPUTED=1]="COMPUTED",e[e.SERVICE=2]="SERVICE",e[e.PORTAL_ITEM=3]="PORTAL_ITEM",e[e.WEB_SCENE=4]="WEB_SCENE",e[e.WEB_MAP=5]="WEB_MAP",e[e.LINK_CHART=6]="LINK_CHART",e[e.USER=7]="USER"})(_e||(_e={}));const P$=_e.USER+1;function Zn(e){switch(e){case"defaults":return _e.DEFAULTS;case"service":return _e.SERVICE;case"portal-item":return _e.PORTAL_ITEM;case"web-scene":return _e.WEB_SCENE;case"web-map":return _e.WEB_MAP;case"link-chart":return _e.LINK_CHART;case"user":return _e.USER;default:return null}}function Q1(e){switch(e){case _e.DEFAULTS:return"defaults";case _e.SERVICE:return"service";case _e.PORTAL_ITEM:return"portal-item";case _e.WEB_SCENE:return"web-scene";case _e.WEB_MAP:return"web-map";case _e.LINK_CHART:return"link-chart";case _e.USER:return"user"}}function Lae(e){return Q1(e)}let QN=class extends kV{constructor(t,r){super(),this.propertyName=t,this.metadata=r,this._accessed=null,this._handles=null,this.flags=0,this.flags=Bt.Dirty|(r.nonNullable?Bt.NonNullable:0)|(r.hasOwnProperty("value")?Bt.HasDefaultValue:0)|(r.get===void 0?Bt.DepTrackingInitialized:0)|(r.dependsOn===void 0?Bt.AutoTracked:0)}destroy(){this.flags&Bt.Dirty&&this.onCommitted(),super.destroy(),this._accessed=null,this._clearObservationHandles()}getComputed(t){Ge(this);const r=t.store,i=this.propertyName,n=this.flags,s=r.get(i);if(n&Bt.Computing||~n&Bt.Dirty&&r.has(i))return s;this.flags|=Bt.Computing;const o=t.host;let a;n&Bt.AutoTracked?a=Vu(this,this.metadata.get,o):(IV(o,this),a=this.metadata.get.call(o)),r.set(i,a,_e.COMPUTED);const u=r.get(i);return u===s?this.flags&=~Bt.Dirty:oae(this.commit,this),this.flags&=~Bt.Computing,u}onObservableAccessed(t){if(t===this)return;let r=this._accessed;if(r==null)r=[],this._accessed=r;else if(r.includes(t))return;r.push(t)}onTrackingEnd(){this._clearObservationHandles(),this.flags|=Bt.DepTrackingInitialized;const t=this._accessed;if(t==null||t.length===0)return;let r=this._handles;r==null&&(r=[],this._handles=r);for(let i=0;i<t.length;++i)r.push(t[i].observe(this));t.length=0}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}commit(){this.flags&=~Bt.Dirty,this.onCommitted()}_clearObservationHandles(){const t=this._handles;if(t!==null){for(let r=0;r<t.length;++r)t[r].remove();t.length=0}}onInvalidated(){~this.flags&Bt.Overridden&&(this.flags|=Bt.Dirty);const t=this._observers;if(t&&t.length>0)for(const r of t)r.onInvalidated()}onCommitted(){const t=this._observers;if(t&&t.length>0){const r=t.slice();for(const i of r)i.onCommitted()}}},kae=class NV{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const r=new NV;return this._values.forEach((i,n)=>{t&&t.has(n)||r.set(n,B(i))}),r}get(t){return this._values.get(t)}originOf(){return _e.USER}keys(){return[...this._values.keys()]}set(t,r){this._values.set(t,r)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}};function mb(e,t,r){return e!==void 0}function eD(e,t,r,i){return e!==void 0&&(!(r==null&&e.flags&Bt.NonNullable)||(i.lifecycle,gs.INITIALIZING,!1))}let Nae=class{constructor(t){this.host=t,this.propertiesByName=new Map,this.ctorArgs=null,this.lifecycle=gs.INITIALIZING,this.store=new kae,this._origin=_e.USER;const r=this.host.constructor.__accessorMetadata__;for(const i in r){const n=new QN(i,r[i]);this.propertiesByName.set(i,n)}this.metadata=r}initialize(){this.lifecycle=gs.CONSTRUCTING}constructed(){this.lifecycle=gs.CONSTRUCTED}destroy(){this.lifecycle=gs.DESTROYED,this.propertiesByName.forEach(t=>t.destroy())}get initialized(){return this.lifecycle!==gs.INITIALIZING}get(t){const r=this.propertiesByName.get(t);if(r.metadata.get)return r.getComputed(this);Ge(r);const i=this.store;return i.has(t)?i.get(t):r.metadata.value}originOf(t){const r=this.store.originOf(t);if(r===void 0){const i=this.propertiesByName.get(t);if(i!==void 0&&i.flags&Bt.HasDefaultValue)return"defaults"}return Q1(r)}has(t){return this.propertiesByName.has(t)&&this.store.has(t)}keys(){return[...this.propertiesByName.keys()]}internalGet(t){const r=this.propertiesByName.get(t);if(mb(r))return this.store.has(t)?this.store.get(t):r.metadata.value}internalSet(t,r){const i=this.propertiesByName.get(t);mb(i)&&this._internalSet(i,r)}getDependsInfo(t,r,i){const n=this.propertiesByName.get(r);if(!mb(n))return"";const s=new Set,o=Vu({onObservableAccessed:u=>s.add(u),onTrackingEnd:()=>{}},()=>{var u;return(u=n.metadata.get)==null?void 0:u.call(t)});let a=`${i}${t.declaredClass.split(".").pop()}.${r}: ${o}
`;if(s.size===0)return a;i+="  ";for(const u of s)u instanceof QN&&(a+=`${i}${u.propertyName}: undefined
`);return a}setAtOrigin(t,r,i){const n=this.propertiesByName.get(t);if(mb(n))return this._setAtOrigin(n,r,i)}isOverridden(t){const r=this.propertiesByName.get(t);return r!==void 0&&!!(r.flags&Bt.Overridden)}clearOverride(t){const r=this.propertiesByName.get(t);r&&r.flags&Bt.Overridden&&(r.flags&=~Bt.Overridden,r.notifyChange())}override(t,r){const i=this.propertiesByName.get(t);if(!eD(i,t,r,this))return;const n=i.metadata.cast;if(n){const s=this._cast(n,r),{valid:o,value:a}=s;if(P3.release(s),!o)return;r=a}i.flags|=Bt.Overridden,this._internalSet(i,r)}set(t,r){const i=this.propertiesByName.get(t);if(!eD(i,t,r,this))return;const n=i.metadata.cast;if(n){const o=this._cast(n,r),{valid:a,value:u}=o;if(P3.release(o),!a)return;r=u}const s=i.metadata.set;s?s.call(this.host,r):this._internalSet(i,r)}setDefaultOrigin(t){this._origin=Zn(t)}getDefaultOrigin(){return Q1(this._origin)}notifyChange(t){const r=this.propertiesByName.get(t);r!==void 0&&r.notifyChange()}invalidate(t){const r=this.propertiesByName.get(t);r!==void 0&&r.invalidate()}commit(t){const r=this.propertiesByName.get(t);r!==void 0&&r.commit()}_internalSet(t,r){const i=this.lifecycle!==gs.INITIALIZING?this._origin:_e.DEFAULTS;this._setAtOrigin(t,r,i)}_setAtOrigin(t,r,i){const n=this.store,s=t.propertyName;n.has(s,i)&&oO(r,n.get(s))&&~t.flags&Bt.Overridden&&i===n.originOf(s)||(t.invalidate(),n.set(s,r,i),t.commit(),TV(this.host,t))}_cast(t,r){const i=P3.acquire();return i.valid=!0,i.value=r,t&&(i.value=t.call(this.host,r,i)),i}},Dae=class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}};const P3=new Np(Dae);let Fae;function jae(){return Fae}var tD;(function(e){e[e.Ignore=0]="Ignore",e[e.Destroy=1]="Destroy",e[e.ThrowError=2]="ThrowError"})(tD||(tD={}));function Uae(e){e.length=0}let Jn=class{constructor(t=50,r=50){this._pool=new Np(Array,void 0,Uae,r,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return L3.acquire()}static release(t){return L3.release(t)}static prune(){L3.prune()}};const L3=new Jn(100);let DV=class extends Np{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const r=super.acquire(...t);return this._set.delete(r),r}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}};const gb=[];function $S(e){gb.push(e),gb.length===1&&queueMicrotask(()=>{const t=gb.slice();gb.length=0;for(const r of t)r()})}let FV=class{constructor(t,r=30){this.name=t,this._counter=0,this._samples=new Array(r)}record(t){t!=null&&(this._samples[++this._counter%this._samples.length]=t)}get median(){return this._samples.slice().sort((t,r)=>t-r)[Math.floor(this._samples.length/2)]}get average(){return this._samples.reduce((t,r)=>t+r,0)/this._samples.length}get last(){return this._samples[this._counter%this._samples.length]}};var L$;(function(e){const t=(s,o,a,u)=>{let c=o,h=o;const d=a>>>1,y=s[c-1];for(;h<=d;){h=c<<1,h<a&&u(s[h-1],s[h])<0&&++h;const v=s[h-1];if(u(v,y)<=0)break;s[c-1]=v,c=h}s[c-1]=y},r=(s,o)=>s<o?-1:s>o?1:0;function i(s,o,a,u){o===void 0&&(o=0),a===void 0&&(a=s.length),u===void 0&&(u=r);for(let h=a>>>1;h>o;h--)t(s,h,a,u);const c=o+1;for(let h=a-1;h>o;h--){const d=s[o];s[o]=s[h],s[h]=d,t(s,c,h,u)}}function*n(s,o,a,u){o===void 0&&(o=0),a===void 0&&(a=s.length),u===void 0&&(u=r);for(let h=a>>>1;h>o;h--)t(s,h,a,u),yield;const c=o+1;for(let h=a-1;h>o;h--){const d=s[o];s[o]=s[h],s[h]=d,t(s,c,h,u),yield}}e.sort=i,e.iterableSort=n})(L$||(L$={}));const rD=L$,Vae=1.5,Gae=1.1;let ev=class{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new xoe,t&&(t.initialSize&&(this.data=new Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),t.deallocator!==void 0&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>iD(this)))}toArray(){return this.data.slice(0,this.length)}filter(t){const r=new Array;for(let i=0;i<this._length;i++){const n=this.data[i];t(n)&&r.push(n)}return r}at(t){if((t=Math.trunc(t)||0)<0&&(t+=this._length),!(t<0||t>=this._length))return this.data[t]}includes(t,r){const i=this.data.indexOf(t,r);return i!==-1&&i<this.length}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let r=t;r<this._length;++r)this.data[r]=this._deallocator(this.data[r]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,r=t.length){for(let i=0;i<r;i++)this.data[this._length++]=t[i]}fill(t,r){for(let i=0;i<r;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,iD(this)}pop(){if(this.length===0)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const r=NN(this.data,t,this.length,this._hint);if(r!==-1)return this.data.splice(r,1),this.length=this.length-1,t}removeUnordered(t){return this.removeUnorderedIndex(NN(this.data,t,this.length,this._hint))}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,r=t.length,i){this.length=Toe(this.data,t,this.length,r,this._hint,i),this._shrink()}front(){if(this.length!==0)return this.data[0]}back(){if(this.length!==0)return this.data[this.length-1]}swapElements(t,r){if(t>=this.length||r>=this.length||t===r)return;const i=this.data[t];this.data[t]=this.data[r],this.data[r]=i}sort(t){rD.sort(this.data,0,this.length,t)}iterableSort(t){return rD.iterableSort(this.data,0,this.length,t)}some(t,r){for(let i=0;i<this.length;++i)if(t.call(r,this.data[i],i,this.data))return!0;return!1}find(t,r){for(let i=0;i<this.length;++i){const n=this.data[i];if(t.call(r,n,i))return n}}filterInPlace(t,r){let i=0;for(let n=0;n<this._length;++n){const s=this.data[n];t.call(r,s,n,this.data)&&(this.data[n]=this.data[i],this.data[i]=s,i++)}if(this._deallocator)for(let n=i;n<this._length;n++)this.data[n]=this._deallocator(this.data[n]);return this._length=i,this._shrink(),this}forAll(t,r){const{data:i,length:n}=this;for(let s=0;s<n;++s)t.call(r,i[s],s,i)}forEach(t,r){this.data.slice(0,this.length).forEach(t,r)}map(t,r){const i=new Array(this.length);for(let n=0;n<this.length;++n)i[n]=t.call(r,this.data[n],n,this.data);return i}reduce(t,r){let i=r;for(let n=0;n<this.length;++n)i=t(i,this.data[n],n,this.data);return i}has(t){const r=this.length,i=this.data;for(let n=0;n<r;++n)if(i[n]===t)return!0;return!1}*[Symbol.iterator](){for(let t=0;t<this.length;t++)yield this.data[t]}};function iD(e){e.data.length>Vae*e.length&&(e.data.length=Math.floor(e.length*Gae))}function Bae(e){return{setTimeout:(t,r)=>{const i=e.setTimeout(t,r);return Xt(()=>e.clearTimeout(i))}}}const Gm=Bae(globalThis);function Vx(e){return zae(e)||jV(e)}function zae(e){return e!=null&&typeof e=="object"&&"on"in e&&typeof e.on=="function"}function jV(e){return e!=null&&typeof e=="object"&&"addEventListener"in e&&typeof e.addEventListener=="function"}function Dv(e,t,r){if(!Vx(e))throw new TypeError("target is not a Evented or EventTarget object");return jV(e)?qae(e,t,r):e.on(t,r)}function qae(e,t,r,i){if(Array.isArray(t)){const n=t.slice();for(const s of n)e.addEventListener(s,r,i);return Xt(()=>{for(const s of n)e.removeEventListener(s,r,i)})}return e.addEventListener(t,r,i),Xt(()=>e.removeEventListener(t,r,i))}function UV(e,t,r){if(!Vx(e))throw new TypeError("target is not a Evented or EventTarget object");if("once"in e)return e.once(t,r);const i=Dv(e,t,n=>{i.remove(),r.call(e,n)});return i}function Pr(e="Aborted"){return new z("AbortError",e)}function Ut(e,t="Aborted"){if(to(e))throw Pr(t)}function Gx(e){return e instanceof AbortSignal?e:e==null?void 0:e.signal}function to(e){const t=Gx(e);return t!=null&&t.aborted}function Ti(e){if(Ei(e))throw e}function nD(e){if(!Ei(e))throw e}function bs(e,t){const r=Gx(e);if(r!=null){if(!r.aborted)return UV(r,"abort",()=>t());t()}}function vO(e,t){const r=Gx(e);if(r!=null)return Ut(r),UV(r,"abort",()=>t(Pr()))}function hl(e,t){return Gx(t)==null?e:new Promise((r,i)=>{let n=bs(t,()=>i(Pr()));const s=()=>{n=Tr(n)};e.then(s,s),e.then(r,i)})}function Ei(e){return(e==null?void 0:e.name)==="AbortError"}async function k$(e){try{return await e}catch(t){if(!Ei(t))throw t;return}}async function wO(e){if(!e)return;if(typeof e.forEach!="function"){const r=Object.keys(e),i=r.map(o=>e[o]),n=await wO(i),s={};return r.map((o,a)=>s[o]=n[a]),s}const t=e;return Promise.allSettled(t).then(r=>Array.from(t,(i,n)=>{const s=r[n];return s.status==="fulfilled"?{promise:i,value:s.value}:{promise:i,error:s.reason}}))}async function Hae(e){return(await Promise.allSettled(e)).filter(t=>t.status==="fulfilled").map(t=>t.value)}async function SNe(e){return(await Promise.allSettled(e)).filter(t=>t.status==="rejected").map(t=>t.reason)}function VV(e,t=void 0,r){const i=new AbortController;return bs(r,()=>i.abort()),new Promise((n,s)=>{let o=setTimeout(()=>{o=0,n(t)},e);bs(i,()=>{o&&(clearTimeout(o),s(Pr()))})})}function Wae(e,t){const r=new AbortController,i=setTimeout(()=>r.abort(),t);return bs(e,()=>{r.abort(),clearTimeout(i)}),{...e,signal:r.signal}}function Dp(e){return e&&typeof e.then=="function"}function sD(e){return Dp(e)?e:Promise.resolve(e)}function Bx(e,t=-1){let r,i,n,s,o=null;const a=(...u)=>{if(r){i=u,s&&s.reject(Pr()),s=ro();const y=s.promise;if(o){const v=o;o=null,v.abort()}return y}if(n=s||ro(),s=null,t>0){const y=new AbortController;r=sD(e(...u,y.signal));const v=r;VV(t).then(()=>{r===v&&(s?y.abort():o=y)})}else r=1,r=sD(e(...u));const c=()=>{const y=i;i=n=r=o=null,y!=null&&a(...y)},h=r,d=n;return h.then(c,c),h.then(d.resolve,d.reject),d.promise};return a}function ro(){let e,t;const r=new Promise((n,s)=>{e=n,t=s}),i=n=>{e(n)};return i.resolve=n=>e(n),i.reject=n=>t(n),i.timeout=(n,s)=>Gm.setTimeout(()=>i.reject(s),n),i.promise=r,i}async function ES(e){await Promise.resolve(),Ut(e)}function xNe(e){return e}function TNe(e){return 1e3*e}function INe(e){return e}let Jae=class{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}},Zae=class{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}},N$=0;const D0={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},D$=["prepare","preRender","render","postRender","update","finish"],F$=[],ef=new ev;let Yae=class{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}};function Kae(){Vd!=null&&(cancelAnimationFrame(Vd),Vd=requestAnimationFrame(bO))}const AS={frameTasks:ef,willDispatch:!1,clearFrameTasks:Xae,dispatch:BV,executeFrameTasks:Qae,reschedule:Kae};function Bm(e){const t=new Zae(e);return F$.push(t),AS.willDispatch||(AS.willDispatch=!0,$S(BV)),t}function ym(e){const t=new Jae(e);return ef.push(t),Vd==null&&(N$=performance.now(),Vd=requestAnimationFrame(bO)),new Yae(t)}let Vd=null;function Xae(e=!1){ef.forAll(t=>{t.removed=!0}),e&&GV()}function bO(){const e=performance.now();Vd=null,Vd=ef.length>0?requestAnimationFrame(bO):null,AS.executeFrameTasks(e)}function Qae(e){const t=e-N$;N$=e;const r=1e3/60,i=Math.max(0,t-r);D0.time=e,D0.frameDuration=r-i;for(let n=0;n<D$.length;n++){const s=performance.now(),o=D$[n];ef.forAll(a=>{var u;a.paused||a.removed||(n===0&&a.ticks++,a.phases[o]&&(D0.elapsedFrameTime=performance.now()-e,D0.deltaTime=a.ticks===0?0:t,(u=a.phases[o])==null||u.call(a,D0)))}),tle[n].record(performance.now()-s)}GV(),rle.record(performance.now()-e)}const vb=new ev;function GV(){ef.forAll(e=>{e.removed&&vb.push(e)}),ef.removeUnorderedMany(vb.data,vb.length),vb.clear()}function BV(){for(;F$.length;){const e=F$.shift();e.isActive&&e.callback()}AS.willDispatch=!1}function ele(e=1,t){const r=ro(),i=()=>{to(t)?r.reject(Pr()):e===0?r():(--e,$S(()=>i()))};return i(),r.promise}const tle=D$.map(e=>new FV(e)),rle=new FV("total");function ile(e,t){for(const r of e.entries())if(t(r[0]))return!0;return!1}function oD(e,t){if(!t)return e;for(const r of t)e.add(r);return e}function zV(e,t){const r=new Set;return oD(r,e),oD(r,t),r}function nle(e,t){const r=new Set;for(const i of t)e.has(i)&&r.add(i);return r}function ANe(e,t){if(!e||!t)return!1;if(e===t)return!0;for(const r of e)if(!t.has(r))return!1;return!0}function RNe(e,t){if(e==null&&t==null)return!0;if(e==null||t==null||e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}function sle(e,t){const r=new Set(e);for(const i of t)r.delete(i);return r}function ole(e,t){return sle(zV(e,t),nle(e,t))}let ale=0;function m1(){return++ale}let zx=class{constructor(t){this._accessed=[],this._handles=[],this._observerObject=new lle(t),aD.register(this,new WeakRef(this._observerObject),this)}destroy(){var t;aD.unregister(this._observerObject),this._accessed.length=0,(t=this._observerObject)==null||t.destroy(),this.clear()}onObservableAccessed(t){const r=this._accessed;r.includes(t)||r.push(t)}onTrackingEnd(){const t=this._handles,r=this._accessed,i=this._observerObject;for(let n=0;n<r.length;++n)t.push(r[n].observe(i));r.length=0}clear(){const t=this._handles;for(let r=0;r<t.length;++r)t[r].remove();t.length=0}},lle=class{constructor(t){this._notify=t,this._invalidCount=0,this.destroyed=!1}onInvalidated(){this._invalidCount++}onCommitted(){if(this.destroyed)return;const t=this._invalidCount;if(t===1)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}destroy(){this.destroyed=!0,this._notify=ule}};const aD=new FinalizationRegistry(e=>{var t;(t=e.deref())==null||t.destroy()});function ule(){}let Ky=!1;const RS=[];function qV(e,t){let r=new zx(s),i=null,n=!1;function s(){if(!r||n)return;if(Ky)return void JV(s);const a=i;r.clear(),Ky=!0,n=!0,i=Vu(r,e),n=!1,Ky=!1,t(i,a),ZV()}function o(){r&&(r.destroy(),r=null,i=null)}return n=!0,i=Vu(r,e),n=!1,Xt(o)}function HV(e,t){let r=new zx(n),i=null;function n(){t(i,o)}function s(){r&&(r.destroy(),r=null),i=null}function o(){return r?(r.clear(),i=Vu(r,e),i):null}return o(),Xt(s)}function WV(e){let t=new zx(i),r=!1;function i(){t&&!r&&(Ky?JV(i):(t.clear(),Ky=!0,r=!0,Vu(t,e),r=!1,Ky=!1,ZV()))}function n(){t&&(t.destroy(),t=null)}return r=!0,Vu(t,e),r=!1,Xt(n)}function JV(e){RS.includes(e)||RS.unshift(e)}function ZV(){for(;RS.length;)RS.pop()()}var g1;(function(e){e[e.Untracked=0]="Untracked",e[e.Tracked=1]="Tracked"})(g1||(g1={}));let tv=class{constructor(){this.uid=m1(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,r,i,n,s){return this.pool.acquire(g1.Untracked,t,r,i,n,s,oO)}static acquireTracked(t,r,i,n){return this.pool.acquire(g1.Tracked,t,r,i,null,null,n)}notify(t,r){this.type===g1.Untracked?this.callback.call(this.target,t,r,this.path,this.target):this.callback.call(null,t,r,void 0,void 0)}acquire(t,r,i,n,s,o,a){this.uid=m1(),this.removed=!1,this.type=t,this.oldValue=r,this.callback=i,this.getValue=n,this.target=s,this.path=o,this.equals=a}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=m1(),this.removed=!0}};tv.pool=new DV(tv);const P_=new Jn,Lu=new Set;let CS;function OS(e){Lu.delete(e),Lu.add(e),CS||(CS=Bm(hle))}function cle(e){if(e.removed)return;const t=e.oldValue,r=e.getValue();e.equals(t,r)||(e.oldValue=r,e.notify(r,t))}function ple(e){for(const t of Lu.values())t.target===e&&(t.removed=!0)}function hle(){let e=10;for(;CS&&e--;){CS=null;const t=dle(),r=P_.acquire();for(const i of t){const n=i.uid;cle(i),n===i.uid&&i.removed&&r.push(i)}for(const i of Lu)i.removed&&(r.push(i),Lu.delete(i));for(const i of r)tv.pool.release(i);P_.release(r),P_.release(t),j$.forEach(i=>i())}}function dle(){const e=P_.acquire();e.length=Lu.size;let t=0;for(const r of Lu)e[t]=r,++t;return Lu.clear(),e}const j$=new Set;function fle(e){return j$.add(e),Xt(()=>j$.delete(e))}function yle(e,t,r){let i=fV(e,t,r,(n,s,o)=>{let a,u,c=HV(()=>kv(n,s),(h,d)=>{var y;((y=n.__accessor__)==null?void 0:y.lifecycle)===gs.DESTROYED||a&&a.uid!==u?i.remove():(a||(a=tv.acquireUntracked(h,o,d,n,s),u=a.uid),OS(a))});return Xt(()=>{c.remove(),a&&(a.uid!==u||a.removed||(a.removed=!0,OS(a)),a=null),i=c=null})});return i}function mle(e,t,r){const i=fV(e,t,r,(n,s,o)=>{let a=!1;return qV(()=>kv(n,s),(u,c)=>{n.__accessor__.lifecycle!==gs.DESTROYED?a||(a=!0,oO(c,u)||o.call(n,u,c,s,n),a=!1):i.remove()})});return i}function gle(e,t,r,i=!1){return e.__accessor__&&e.__accessor__.lifecycle!==gs.DESTROYED?i?mle(e,t,r):yle(e,t,r):Xt()}function vle(e,t,r){let i,n,s=HV(e,(o,a)=>{i&&i.uid!==n?s.remove():(i||(i=tv.acquireTracked(o,t,a,r),n=i.uid),OS(i))});return Xt(()=>{s.remove(),i&&(i.uid!==n||i.removed||(i.removed=!0,OS(i)),i=null),s=null})}function wle(e,t,r){let i=!1;return qV(e,(n,s)=>{i||(i=!0,r(s,n)||t(n,s),i=!1)})}function ble(e,t,r=!1,i=iV){return r?wle(e,t,i):vle(e,t,i)}function lD(e){return ile(Lu,t=>t.oldValue===e)}var YV,KV;function _le(e){var t;if(e==null)return{value:e};if(Array.isArray(e))return{type:[e[0]],value:null};switch(typeof e){case"object":return(t=e.constructor)!=null&&t.__accessorMetadata__||e instanceof Date?{type:e.constructor,value:e}:e;case"boolean":return{type:Boolean,value:e};case"string":return{type:String,value:e};case"number":return{type:Number,value:e};case"function":return{type:e,value:null};default:return}}const _c=Symbol("Accessor-Handles"),U$=Symbol("Accessor-Initialized");let De=class XV{static createSubclass(t={}){if(Array.isArray(t))throw new Error("Multi-inheritance unsupported since 4.16");const{properties:r,declaredClass:i,constructor:n}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const s=this;class o extends s{constructor(...u){super(...u),this.inherited=null,n&&n.apply(this,u)}}Nv(o.prototype);for(const a in t){const u=t[a];o.prototype[a]=typeof u=="function"?function(...c){const h=this.inherited;let d;this.inherited=function(...y){if(s.prototype[a])return s.prototype[a].apply(this,y)};try{d=u.apply(this,c)}catch(y){throw this.inherited=h,y}return this.inherited=h,d}:t[a]}for(const a in r){const u=_le(r[a]);p(u)(o.prototype,a)}return k(i)(o)}constructor(...t){if(this[YV]=null,this[KV]=!1,this.constructor===XV)throw new Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");const r=new Nae(this);Object.defineProperty(this,"__accessor__",{enumerable:!1,value:r}),t.length>0&&this.normalizeCtorArgs&&(r.ctorArgs=this.normalizeCtorArgs.apply(this,t))}postscript(t){const r=this.__accessor__,i=r.ctorArgs||t;r.initialize(),i&&(this.set(i),r.ctorArgs=null),r.constructed(),this.initialize(),this[U$]=!0}initialize(){}[_V](){this[_c]=cr(this[_c])}destroy(){var t;this.destroyed||(ple(this),this.__accessor__.destroy(),(t=jae())==null||t.onInstanceDestroy(this))}[Symbol.dispose](){this.destroy()}get constructed(){return this.__accessor__&&this.__accessor__.initialized||!1}get initialized(){return this[U$]}get destroyed(){var t;return((t=this.__accessor__)==null?void 0:t.lifecycle)===gs.DESTROYED||!1}commitProperty(t){Ra(this,t)}get(t){return LV(oe.getLogger(this),"`Accessor.get` is deprecated in favor of using optional chaining",{version:"4.28",see:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Optional_chaining"}),Ra(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,r){return SS(this,t,r),this}watch(t,r,i){return gle(this,t,r,i)}addHandles(t,r){if(this.destroyed){const n=Array.isArray(t)?t:[t];for(const s of n)s.remove();return}let i=this[_c];i==null&&(i=this[_c]=new gO),i.add(t,r)}removeHandles(t){const r=this[_c];r!=null&&r.remove(t)}removeAllHandles(){const t=this[_c];t!=null&&t.removeAll()}hasHandles(t){const r=this[_c];return r!=null&&r.has(t)}_override(t,r){r===void 0?this.__accessor__.clearOverride(t):this.__accessor__.override(t,r)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_overrideIfSome(t,r){r==null?this.__accessor__.clearOverride(t):this.__accessor__.override(t,r)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,r){return this.__accessor__.internalSet(t,r),this}};YV=_c,KV=U$;let Sle=class QV{constructor(){this._values=new Map,this.multipleOriginsSupported=!1}clone(t){const r=new QV;return this._values.forEach((i,n)=>{t&&t.has(n)||r.set(n,B(i.value),i.origin)}),r}get(t,r){r=this._normalizeOrigin(r);const i=this._values.get(t);return r==null||(i==null?void 0:i.origin)===r?i==null?void 0:i.value:void 0}originOf(t){var r;return((r=this._values.get(t))==null?void 0:r.origin)??_e.USER}keys(t){t=this._normalizeOrigin(t);const r=[...this._values.keys()];return t==null?r:r.filter(i=>{var n;return((n=this._values.get(i))==null?void 0:n.origin)===t})}set(t,r,i){if((i=this._normalizeOrigin(i))===_e.DEFAULTS){const n=this._values.get(t);if((n==null?void 0:n.origin)!=null&&n.origin>i)return}this._values.set(t,new xle(r,i))}delete(t,r){var i;(r=this._normalizeOrigin(r))!=null&&((i=this._values.get(t))==null?void 0:i.origin)!==r||this._values.delete(t)}has(t,r){var i;return(r=this._normalizeOrigin(r))!=null?((i=this._values.get(t))==null?void 0:i.origin)===r:this._values.has(t)}forEach(t){this._values.forEach(({value:r},i)=>t(r,i))}_normalizeOrigin(t){if(t!=null)return t===_e.DEFAULTS?t:_e.USER}},xle=class{constructor(t,r){this.value=t,this.origin=r}};function eG(e,t,r){t.keys().forEach(n=>{r.set(n,t.get(n),_e.DEFAULTS)});const i=e.metadata;Object.keys(i).forEach(n=>{e.internalGet(n)&&r.set(n,e.internalGet(n),_e.DEFAULTS)})}function Tle(e,t,r){if(!(e!=null&&e.read)||e.read.enabled===!1||!e.read.source)return!1;const i=e.read.source;if(typeof i=="string"){if(i===t||i.includes(".")&&i.indexOf(t)===0&&zN(i,r))return!0}else for(const n of i)if(n===t||n.includes(".")&&n.indexOf(t)===0&&zN(n,r))return!0;return!1}function Ile(e){return e&&(!e.read||e.read.enabled!==!1&&!e.read.source)}function Mle(e,t,r,i,n){let s=A$(t[r],n);Ile(s)&&(e[r]=!0);for(const o of Object.getOwnPropertyNames(t))s=A$(t[o],n),Tle(s,r,i)&&(e[o]=!0)}function $le(e,t,r,i){const n=r.metadata,s=wae(n[t],i),o=s==null?void 0:s.default;if(o===void 0)return;const a=typeof o=="function"?o.call(e,t,i):o;a!==void 0&&r.set(t,a)}const tG={origin:"service"};function rG(e,t,r=tG){if(!t||typeof t!="object")return;const i=Mi(e),n=i.metadata,s={};for(const o of Object.getOwnPropertyNames(t))Mle(s,n,o,t,r);i.setDefaultOrigin(r.origin);for(const o of Object.getOwnPropertyNames(s)){const a=A$(n[o],r).read,u=a==null?void 0:a.source;let c;c=u&&typeof u=="string"?kv(t,u):t[o],a!=null&&a.reader&&(c=a.reader.call(e,c,t,r)),c!==void 0&&i.set(o,c)}if(!r||!r.ignoreDefaults){i.setDefaultOrigin("defaults");for(const o of Object.getOwnPropertyNames(n))s[o]||$le(e,o,i,r)}i.setDefaultOrigin("user")}function Ele(e,t,r,i=tG){var s;const n={...i,messages:[]};r(n),(s=n.messages)==null||s.forEach(o=>{o.type!=="warning"||e.loaded?i!=null&&i.messages&&i.messages.push(o):e.loadWarnings.push(o)})}function Ale(e,t,r,i,n){var o,a;const s={};return(a=(o=t.write)==null?void 0:o.writer)==null||a.call(e,i,s,r,n),s}function iG(e,t,r,i,n,s){if(!(i!=null&&i.write))return!1;const o=Ra(e,r);if(!n&&i.write.overridePolicy){const a=i.write.overridePolicy.call(e,o,r,s??void 0);a!==void 0&&(n=a)}if(n||(n=i.write),!n||n.enabled===!1||n.layerContainerTypes&&(s!=null&&s.layerContainerType)&&!n.layerContainerTypes.includes(s.layerContainerType))return!1;if((o===null&&!n.allowNull&&!n.writerEnsuresNonNull||o===void 0)&&n.isRequired){const a=new z("web-document-write:property-required",`Missing value for required property '${r}' on '${e.declaredClass}'`,{propertyName:r,target:e});return a&&(s!=null&&s.messages)?s.messages.push(a):a&&!s&&oe.getLogger("esri.core.accessorSupport.write").error(a.name,a.message),!1}return!(o===void 0||o===null&&!n.allowNull&&!n.writerEnsuresNonNull||!n.alwaysWriteDefaults&&(!t.store.multipleOriginsSupported||t.store.originOf(r)===_e.DEFAULTS)&&Rle(e,r,s,i,o)||!n.ignoreOrigin&&(s!=null&&s.origin)&&t.store.multipleOriginsSupported&&t.store.originOf(r)<Zn(s.origin))}function Rle(e,t,r,i,n){const s=i.default;if(s===void 0)return!1;if(i.defaultEquals!=null)return i.defaultEquals(n);if(typeof s=="function"){if(Array.isArray(n)){const o=s.call(e,t,r??void 0);return aO(o,n)}return!1}return s===n}function nG(e,t,r,i){const n=Mi(e),s=n.metadata,o=OV(s[t],i);return!!o&&iG(e,n,t,o,r,i)}function sG(e,t,r){var s,o;if(e&&typeof e.toJSON=="function"&&(!e.toJSON.isDefaultToJSON||!e.write))return R_(t,e.toJSON(r));const i=Mi(e),n=i.metadata;for(const a in n){const u=OV(n[a],r);if(!iG(e,i,a,u,void 0,r))continue;const c=Ra(e,a),h=Ale(e,u,u.write&&typeof u.write.target=="string"?u.write.target:a,c,r);Object.keys(h).length>0&&(t=R_(t,h),(o=(s=r==null?void 0:r.resources)==null?void 0:s.pendingOperations)!=null&&o.length&&r.resources.pendingOperations.push(Promise.all(r.resources.pendingOperations).then(()=>R_(t,h,()=>"replace-arrays"))),r!=null&&r.writtenProperties&&r.writtenProperties.push({target:e,propName:a,oldOrigin:Lae(i.store.originOf(a)),newOrigin:r.origin}))}return t}const Fv=e=>{let t=class extends e{constructor(...r){super(...r);const i=Mi(this),n=i.store,s=new Sle;i.store=s,eG(i,n,s)}read(r,i){rG(this,r,i)}write(r,i){return sG(this,r??{},i)}toJSON(r){return this.write({},r)}static fromJSON(r,i){return Cle.call(this,r,i)}};return t=l([k("esri.core.JSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function Cle(e,t){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const r=new this;return r.read(e,t),r}function rv(e){return e&&typeof e=="object"&&"toJSON"in e&&typeof e.toJSON=="function"}let Q=class extends Fv(De){};Q=l([k("esri.core.JSONSupport")],Q);function te(e,t,r){let i,n;return t===void 0||Array.isArray(t)?(n=e,r=t,i=[void 0]):(n=t,i=Array.isArray(e)?e:[e]),(s,o)=>{const a=s.constructor.prototype;i.forEach(u=>{const c=wV(s,u,n);c.read&&typeof c.read=="object"||(c.read={}),c.read.reader=a[o],r&&(c.read.source=(c.read.source||[]).concat(r))})}}let We=class{constructor(t,r={ignoreUnknown:!1,useNumericKeys:!1}){this._jsonToAPI=t,this._options=r,this.apiValues=[],this.jsonValues=[],this._apiToJSON=this._invertMap(t),this.apiValues=this._getKeysSorted(this._apiToJSON),this.jsonValues=this._getKeysSorted(this._jsonToAPI),this.read=i=>this.fromJSON(i),this.write=(i,n,s)=>{const o=this.toJSON(i);o!==void 0&&En(s,o,n)},this.write.isJSONMapWriter=!0}toJSON(t){if(t==null)return null;if(this._apiToJSON.hasOwnProperty(t)){const r=this._apiToJSON[t];return this._options.useNumericKeys?+r:r}return this._options.ignoreUnknown?void 0:t}fromJSON(t){return t!=null&&this._jsonToAPI.hasOwnProperty(t)?this._jsonToAPI[t]:this._options.ignoreUnknown?void 0:t}_invertMap(t){const r={};for(const i in t)r[t[i]]=i;return r}_getKeysSorted(t){const r=[];for(const i in t)r.push(i);return r.sort(),r}};function Qr(){return function(e,t){return new We(e,{ignoreUnknown:!0,...t})}}let _O=class{constructor(t,r,i,n){this.semiMajorAxis=t,this.flattening=r,this.outerAtmosphereRimWidth=i;const s=1-this.flattening;this.semiMinorAxis=this.semiMajorAxis*s,this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=n||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}};const kr=new _O(6378137,1/298.257223563,3e5,.006694379990137799),wl=new _O(3396190,1/169.8944472236118,23e4),Tp=new _O(1737400,0,0),Ole=/^https:\/\/([a-z\d-]+)(\.maps([^.]*))?\.arcgis\.com/i,Ple={devext:{customBaseUrl:"mapsdevext.arcgis.com",portalHostname:"devext.arcgis.com"},qaext:{customBaseUrl:"mapsqa.arcgis.com",portalHostname:"qaext.arcgis.com"},www:{customBaseUrl:"maps.arcgis.com",portalHostname:"www.arcgis.com"}};function V$(e){const t=e==null?void 0:e.match(Ole);if(!t)return null;const[,r,i,n]=t;if(!r)return null;let s=null,o=null,a=null;const{devext:u,qaext:c,www:h}=Ple;if(i)if(s=r,n)switch(n.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=u);break;case"qa":({customBaseUrl:o,portalHostname:a}=c);break;default:return null}else({customBaseUrl:o,portalHostname:a}=h);else switch(r.toLowerCase()){case"devext":({customBaseUrl:o,portalHostname:a}=u);break;case"qaext":({customBaseUrl:o,portalHostname:a}=c);break;case"www":({customBaseUrl:o,portalHostname:a}=h);break;default:return null}return{customBaseUrl:o,isPortal:!1,portalHostname:a,urlKey:s}}function Lle(e){return/\/(sharing|usrsvcs)\/(appservices|servers)\//i.test(e)}function kle(e){const t=atob(e),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r.buffer}function Nle(e){const t=new Uint8Array(e);let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return btoa(r)}const Dle=()=>oe.getLogger("esri.core.urlUtils"),zm=Kt.request,uD="esri/config: esriConfig.request.proxyUrl is not set.",oG=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,aG=/^\s*http:/i,Fle=/^\s*https:/i,jle=/^\s*file:/i,Ule=/:\d+$/,Vle=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Gle=new RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?$"),Ble=new RegExp("^((([^\\[:]+):)?([^@]+)@)?(\\[([^\\]]+)\\]|([^\\[:]*))(:([0-9]+))?$");let bl=class{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let r=this.uri.match(Gle);this.scheme=r[2]||(r[1]?"":null),this.authority=r[4]||(r[3]?"":null),this.path=r[5],this.query=r[7]||(r[6]?"":null),this.fragment=r[9]||(r[8]?"":null),this.authority!=null&&(r=this.authority.match(Ble),this.user=r[3]||null,this.password=r[4]||null,this.host=r[6]||r[7],this.port=r[9]||null)}toString(){return this.uri}};const wb={},zle=new bl(Kt.applicationUrl);let Tn=zle;const qle=Hle();let SO=qle;const xO=()=>Tn,lG=()=>SO;function Hle(){const e=Tn.path,t=e.substring(0,e.lastIndexOf(e.split("/")[e.split("/").length-1]));return`${`${Tn.scheme}://${Tn.host}${Tn.port!=null?`:${Tn.port}`:""}`}${t}`}function Pt(e){if(!e)return null;const t={path:null,query:null},r=new bl(e),i=e.indexOf("?");return r.query===null?t.path=e:(t.path=e.substring(0,i),t.query=TO(r.query)),r.fragment&&(t.hash=r.fragment,r.query===null&&(t.path=t.path.substring(0,t.path.length-(r.fragment.length+1)))),t}function TO(e){const t=e.split("&"),r={};for(const i of t){if(!i)continue;const n=i.indexOf("=");let s,o;n<0?(s=decodeURIComponent(i),o=""):(s=decodeURIComponent(i.slice(0,n)),o=decodeURIComponent(i.slice(n+1)));let a=r[s];typeof a=="string"&&(a=r[s]=[a]),Array.isArray(a)?a.push(o):r[s]=o}return r}function Il(e,t){return e?Object.keys(e).map(r=>{const i=e[r];if(i==null)return"";const n=encodeURIComponent(r)+"=",s=t==null?void 0:t[r];return s?n+encodeURIComponent(s(i)):Array.isArray(i)?i.map(o=>rv(o)?n+encodeURIComponent(JSON.stringify(o)):n+encodeURIComponent(o)).join("&"):rv(i)?n+encodeURIComponent(JSON.stringify(i)):n+encodeURIComponent(i)}).filter(r=>r).join("&"):""}function Wle(e=!1){let t,r=zm.proxyUrl;if(typeof e=="string"){t=tue(e);const i=qx(e);i&&(r=i.proxyUrl)}else t=!!e;if(!r)throw Dle().warn(uD),new z("urlUtils:proxy-not-set",uD);return t&&G$()&&(r=AO(r)),Pt(r)}function Jle(e){const t=qx(e);let r,i;if(t){const n=IO(t.proxyUrl);r=n.path,i=n.query?TO(n.query):null}if(r){const n=Pt(e);e=r+"?"+n.path;const s=Il({...i,...n.query});s&&(e=`${e}?${s}`)}return e}const F0={path:"",query:""};function IO(e){const t=e.indexOf("?");return t!==-1?(F0.path=e.slice(0,t),F0.query=e.slice(t+1)):(F0.path=e,F0.query=null),F0}function uG(e){return e=(e=LS(e=fG(e=IO(e).path),!0)).toLowerCase()}function Zle(e){const t={proxyUrl:e.proxyUrl,urlPrefix:uG(e.urlPrefix)},r=zm.proxyRules,i=t.urlPrefix;let n=r.length;for(let s=0;s<r.length;s++){const o=r[s].urlPrefix;if(i.indexOf(o)===0){if(i.length===o.length)return-1;n=s;break}o.indexOf(i)===0&&(n=s+1)}return r.splice(n,0,t),n}function qx(e){const t=zm.proxyRules,r=uG(e);for(let i=0;i<t.length;i++)if(r.indexOf(t[i].urlPrefix)===0)return t[i]}function Yle(e,t){if(!e||!t)return!1;e=PS(e),t=PS(t);const r=V$(e),i=V$(t);return r!=null&&i!=null?r.portalHostname===i.portalHostname:r==null&&i==null&&mm(e,t,!0)}function cG(e,t){return e=PS(e),t=PS(t),LS(e)===LS(t)}function PS(e){const t=(e=_s(e)).indexOf("/sharing");return t>0?e.substring(0,t):e.replace(/\/+$/,"")}function pG(e){const t=i=>i==null||i instanceof RegExp&&i.test(e)||typeof i=="string"&&e.startsWith(i),r=zm.interceptors;if(r){for(const i of r)if(Array.isArray(i.urls)){if(i.urls.some(t))return i}else if(t(i.urls))return i}return null}function mm(e,t,r=!1){if(!e||!t)return!1;const i=z$(e),n=z$(t);return!(!r&&i.scheme!==n.scheme)&&i.host!=null&&n.host!=null&&i.host.toLowerCase()===n.host.toLowerCase()&&i.port===n.port}function MO(e){if(typeof e=="string"){if(!Kn(e))return!0;e=z$(e)}if(mm(e,Tn))return!0;const t=zm.trustedServers||[];for(let r=0;r<t.length;r++){const i=Kle(t[r]);for(let n=0;n<i.length;n++)if(mm(e,i[n]))return!0}return!1}function Kle(e){return wb[e]||(EO(e)||io(e)?wb[e]=[new bl(Js(e))]:wb[e]=[new bl(`http://${e}`),new bl(`https://${e}`)]),wb[e]}function Js(e,t=SO,r){return io(e)?r&&r.preserveProtocolRelative?e:Tn.scheme==="http"&&Tn.authority===Ca(e).slice(2)?`http:${e}`:`https:${e}`:EO(e)?e:jo(e[0]==="/"?sue(t):t,e)}function $O(e,t=SO,r){if(e==null||!Kn(e))return e;const i=_s(e),n=i.toLowerCase(),s=_s(t).toLowerCase().replace(/\/+$/,""),o=r?_s(r).toLowerCase().replace(/\/+$/,""):null;if(o&&s.indexOf(o)!==0)return e;const a=(d,y,v)=>(v=d.indexOf(y,v))===-1?d.length:v;let u=a(n,"/",n.indexOf("//")+2),c=-1;for(;n.slice(0,u+1)===s.slice(0,u)+"/"&&(c=u+1,u!==n.length);)u=a(n,"/",u+1);if(c===-1||o&&c<o.length)return e;e=i.slice(c);const h=s.slice(c-1).replaceAll(/[^/]+/g,"").length;if(h>0)for(let d=0;d<h;d++)e=`../${e}`;else e=`./${e}`;return e}function _s(e){return e=lue(e=aue(e=oue(e=Js(e=e.trim()))))}function jo(...e){const t=e.filter(Qn);if(!(t!=null&&t.length))return;const r=[];if(Kn(t[0])){const n=t[0],s=n.indexOf("//");s!==-1&&(r.push(n.slice(0,s+1)),iue(t[0])&&(r[0]+="/"),t[0]=n.slice(s+2))}else t[0][0]==="/"&&r.push("");const i=t.reduce((n,s)=>s?n.concat(s.split("/")):n,[]);for(let n=0;n<i.length;n++){const s=i[n];s===".."&&r.length>0&&r[r.length-1]!==".."?r.pop():(!s&&n===i.length-1||s&&(s!=="."||r.length===0))&&r.push(s)}return r.join("/")}function Ca(e,t=!1){if(e==null||Hx(e)||wf(e))return null;let r=e.indexOf("://");if(r===-1&&io(e))r=2;else{if(r===-1)return null;r+=3}const i=e.indexOf("/",r);return i!==-1&&(e=e.slice(0,i)),t&&(e=LS(e,!0)),e}function Kn(e){return io(e)||EO(e)}function Hx(e){return e!=null&&e.slice(0,5)==="blob:"}function wf(e){return e!=null&&e.slice(0,5)==="data:"}function Xle(e){const t=iv(e);return t&&t.isBase64?kle(t.data):null}function jNe(e){return Nle(e).replaceAll("+","-").replaceAll("/","_").replace(/=+$/,"")}const Qle=/^data:(.*?)(;base64)?,(.*)$/;function iv(e){const t=e.match(Qle);if(!t)return null;const[,r,i,n]=t;return{mediaType:r,isBase64:!!i,data:n}}function hG(e){return e.isBase64?`data:${e.mediaType};base64,${e.data}`:`data:${e.mediaType},${e.data}`}async function UNe(e){return(await fetch(e)).blob()}function VNe(e){const t=Xle(e);if(!t)return null;const r=iv(e);return new Blob([t],{type:r.mediaType})}function GNe(e,t){eue(e,t)}function eue(e,t){if(!e)return!1;const r=document.createElement("a");if(!("download"in r))return!1;const i=URL.createObjectURL(e);return r.download=t,r.href=i,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(i),!0}function io(e){return e!=null&&e[0]==="/"&&e[1]==="/"}function EO(e){return e!=null&&oG.test(e)}function tue(e){return e!=null&&Fle.test(e)||Tn.scheme==="https"&&io(e)}function rue(e){return e!=null&&aG.test(e)||Tn.scheme==="http"&&io(e)}function iue(e){return e!=null&&jle.test(e)}function AO(e){return io(e)?`https:${e}`:e.replace(aG,"https:")}function nue(){return Tn.scheme==="http"}function G$(){return Tn.scheme==="https"}function LS(e,t=!1){return io(e)?e.slice(2):(e=e.replace(oG,""),t&&e.length>1&&e[0]==="/"&&e[1]==="/"&&(e=e.slice(2)),e)}function sue(e){const t=e.indexOf("//"),r=e.indexOf("/",t+2);return r===-1?e:e.slice(0,r)}function dG(e){let t=0;if(Kn(e)){const i=e.indexOf("//");i!==-1&&(t=i+2)}const r=e.lastIndexOf("/");return r<t?e:e.slice(0,r+1)}function BNe(e,t){if(!e)return"";const r=Pt(e).path.replace(/\/+$/,""),i=r.substring(r.lastIndexOf("/")+1);if(!(t!=null&&t.length))return i;const n=new RegExp(`.(${t.join("|")})$`,"ig");return i.replace(n,"")}function fG(e){return e.endsWith("/")?e:`${e}/`}function Wx(e){return e.replace(/\/+$/,"")}function oue(e){if(/^https?:\/\//i.test(e)){const t=IO(e);e=(e=t.path.replaceAll(/\/{2,}/g,"/")).replace("/","//"),t.query&&(e+=`?${t.query}`)}return e}function aue(e){return e.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}function lue(e){const t=zm.httpsDomains;if(!rue(e))return e;const r=e.indexOf("/",7);let i;if(i=r===-1?e:e.slice(0,r),i=i.toLowerCase().slice(7),Ule.test(i)){if(!i.endsWith(":80"))return e;i=i.slice(0,-3),e=e.replace(":80","")}return nue()&&i===Tn.authority&&!Vle.test(e)||(G$()&&i===Tn.authority||t&&t.some(n=>i===n||i.endsWith(`.${n}`))||G$()&&!qx(e))&&(e=AO(e)),e}function B$(e,t,r){if(!(t&&r&&e&&Kn(e)))return e;const i=e.indexOf("//"),n=e.indexOf("/",i+2),s=e.indexOf(":",i+2),o=Math.min(n<0?e.length:n,s<0?e.length:s);return e.slice(i+2,o).toLowerCase()!==t.toLowerCase()?e:`${e.slice(0,i+2)}${r}${e.slice(o)}`}function z$(e){return typeof e=="string"?new bl(Js(e)):(e.scheme||(e.scheme=Tn.scheme),e)}function zNe(e){return cue.test(e)}function yG(e,t){const r=Pt(e),i=Object.keys(r.query||{});return i.length>0&&t&&t.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${i.join(", ")}.`),r.path}function uue(e,t,r){const i=Pt(e),n=i.query||{};return n[t]=String(r),`${i.path}?${Il(n)}`}function No(e,t){if(!t)return e;const r=Pt(e),i=r.query||{};for(const[s,o]of Object.entries(t))o!=null&&(i[s]=o);const n=Il(i);return n?`${r.path}?${n}`:r.path}function qNe(e){if(e==null)return null;const t=e.match(mG);return t?t[2]:null}function cD(e){if(e==null)return null;const t=e.match(mG);return t?{path:t[1],extension:t[2]}:{path:e,extension:null}}async function HNe(e){return typeof e=="string"?iv(e)??{data:e}:new Promise((t,r)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>t(iv(i.result)),i.onerror=n=>r(n)})}const mG=/([^.]*)\.([^\/]*)$/,cue=/(^data:image\/svg|\.svg$)/i,gG="20240321",vG="9cf5a4b8555fda94595b625a40b922e012baf071";Symbol.dispose??(Symbol.dispose=Symbol("Symbol.dispose")),Symbol.asyncDispose??(Symbol.asyncDispose=Symbol("Symbol.asyncDispose"));const pue="4.29";let pt,RO=pue;RO="4.29.10";function WNe(e){pt=e}function JNe(e){const t=pt==null?void 0:pt.findCredential(e);return t!=null&&t.token?uue(e,"token",t.token):e}Me("host-webworker");const hue=new Set(["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"]);function wG(e){const t=Ca(e,!0);return!!t&&t.endsWith(".arcgis.com")&&!hue.has(t)&&!e.endsWith("/sharing/rest/generateToken")}function due(e,t,r=!1,i){return new Promise((n,s)=>{if(to(i))return void s(pD());let o=()=>{c(),s(new Error(`Unable to load ${t}`))},a=()=>{const h=e;c(),n(h)},u=()=>{if(!e)return;const h=e;c(),h.src="",s(pD())};const c=()=>{Me("esri-image-decode")||(e.removeEventListener("error",o),e.removeEventListener("load",a)),o=null,a=null,e=null,i!=null&&i.removeEventListener("abort",u),u=null,r&&URL.revokeObjectURL(t)};i!=null&&i.addEventListener("abort",u),Me("esri-image-decode")?e.decode().then(a,o):(e.addEventListener("error",o),e.addEventListener("load",a))})}function pD(){try{return new DOMException("Aborted","AbortError")}catch{const e=new Error;return e.name="AbortError",e}}const fue="Timeout exceeded";function yue(){return new Error(fue)}function mue(e){Kt.request.crossOriginNoCorsDomains||(Kt.request.crossOriginNoCorsDomains={});const t=Kt.request.crossOriginNoCorsDomains;for(let r of e)r=r.toLowerCase(),/^https?:\/\//.test(r)?t[Ca(r)??""]=0:(t[Ca("http://"+r)??""]=0,t[Ca("https://"+r)??""]=0)}function gue(e){const t=Kt.request.crossOriginNoCorsDomains;if(t){let r=Ca(e);if(r)return r=r.toLowerCase(),!mm(r,xO())&&t[r]<Date.now()-36e5}return!1}async function vue(e){var n;const t=Kt.request.crossOriginNoCorsDomains,r=Ca(e);t&&r&&(t[r.toLowerCase()]=Date.now());const i=Pt(e);e=i.path,((n=i.query)==null?void 0:n.f)==="json"&&(e+="?f=json");try{await fetch(e,{mode:"no-cors",credentials:"include"})}catch{}}async function be(e,t){var c;e instanceof URL&&(e=e.toString()),(t==null?void 0:t.query)instanceof URLSearchParams&&(t.query=TO(t.query.toString().replaceAll("+"," ")));const r=wf(e),i=Hx(e);i||r||(e=_s(e));const n={url:e,requestOptions:{...t}};let s=pG(e);if(s){const h=await Mue(s,n);if(h!=null)return{data:h,getAllHeaders:gm,getHeader:gm,httpStatus:200,requestOptions:n.requestOptions,url:n.url};s.after||s.error||(s=null)}if(e=n.url,(t=n.requestOptions).responseType==="image"&&(Me("host-webworker")||Me("host-node")))throw _l("request:invalid-parameters",new Error("responseType 'image' is not supported in Web Workers or Node environment"),n);if(t.method==="head"){if(t.body)throw _l("request:invalid-parameters",new Error("body parameter cannot be set when method is 'head'"),n);if(r||i)throw _l("request:invalid-parameters",new Error("data and blob URLs are not supported for method 'head'"),n)}if(await xue(),kS)return kS.execute(e,t);const o=new AbortController;bs(t,()=>o.abort());const a={controller:o,credential:void 0,credentialToken:void 0,fetchOptions:void 0,hasToken:!1,interceptor:s,params:n,redoRequest:!1,useIdentity:ba.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},u=await Eue(a);return(c=s==null?void 0:s.after)==null||c.call(s,u),u}let kS;const ba=Kt.request,bG="FormData"in globalThis,wue=new Set([499,498,403,401]),bue=new Set(["COM_0056","COM_0057","SB_0008"]),_ue=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],gm=()=>null,NS=Symbol();function Sue(e){const t=Ca(e);t&&!be._corsServers.includes(t)&&be._corsServers.push(t)}function hD(e){const t=Ca(e);return!t||t.endsWith(".arcgis.com")||be._corsServers.includes(t)||MO(t)}function _l(e,t,r,i){let n="Error";const s={url:r.url,requestOptions:r.requestOptions,getAllHeaders:gm,getHeader:gm,ssl:!1};if(t instanceof z)return t.details?(t.details=B(t.details),t.details.url=r.url,t.details.requestOptions=r.requestOptions):t.details=s,t;if(t){const o=i&&(()=>Array.from(i.headers)),a=i&&(h=>i.headers.get(h)),u=i==null?void 0:i.status,c=t.message;c&&(n=c),o&&a&&(s.getAllHeaders=o,s.getHeader=a),s.httpStatus=(t.httpCode!=null?t.httpCode:t.code)||u||0,s.subCode=t.subcode,s.messageCode=t.messageCode,typeof t.details=="string"?s.messages=[t.details]:s.messages=t.details,s.raw=NS in t?t[NS]:t}return Ei(t)?Pr():new z(e,n,s)}async function xue(){Me("host-webworker")&&!kS&&(kS=await ge(()=>import("./request-CeWTyDSt.js"),__vite__mapDeps([0,1,2])))}async function q$(){pt||await ge(()=>import("./IdentityManager-B6sYbOo2.js"),__vite__mapDeps([3,1,2,4]))}async function Tue(e){var a;const t=e.params.url,r=e.params.requestOptions,i=e.controller.signal,n=r.body;let s=null,o=null;if(bG&&"HTMLFormElement"in globalThis&&(n instanceof FormData?s=n:n instanceof HTMLFormElement&&(s=new FormData(n))),typeof n=="string"&&(o=n),e.fetchOptions={cache:r.cacheBust?"no-cache":"default",credentials:"same-origin",headers:r.headers||{},method:r.method==="head"?"HEAD":"GET",mode:"cors",priority:ba.priority,redirect:"follow",signal:i},(s||o)&&(e.fetchOptions.body=s||o),r.authMode==="anonymous"&&(e.useIdentity=!1),e.hasToken=!!(/token=/i.test(t)||(a=r.query)!=null&&a.token||s!=null&&s.get("token")),!e.hasToken&&Kt.apiKey&&wG(t)&&(r.query||(r.query={}),r.query.token=Kt.apiKey,e.hasToken=!0),e.useIdentity&&!e.hasToken&&!e.credentialToken&&!_G(t)&&!to(i)){let u;r.authMode==="immediate"?(await q$(),u=await pt.getCredential(t,{signal:i}),e.credential=u):r.authMode==="no-prompt"?(await q$(),u=await pt.getCredential(t,{prompt:!1,signal:i}).catch(()=>{}),e.credential=u):pt&&(u=pt.findCredential(t)),u&&(e.credentialToken=u.token,e.useSSL=!!u.ssl)}}function _G(e){return _ue.some(t=>t.test(e))}async function Iue(e){let t=e.params.url;const r=e.params.requestOptions,i=e.fetchOptions??{},n=Hx(t)||wf(t),s=r.responseType||"json",o=n?0:r.timeout!=null?r.timeout:ba.timeout;let a=!1;if(!n){e.useSSL&&(t=AO(t));let y={...r.query};e.credentialToken&&(y.token=e.credentialToken);let v=Il(y);Me("esri-url-encodes-apostrophe")&&(v=v.replaceAll("'","%27"));const w=t.length+1+v.length;let b;a=r.method==="delete"||r.method==="post"||r.method==="put"||!!r.body||w>ba.maxUrlLength;const _=r.useProxy||!!qx(t);if(_){const x=Wle(t);b=x.path,!a&&b.length+1+w>ba.maxUrlLength&&(a=!0),x.query&&(y={...x.query,...y})}if(i.method==="HEAD"&&(a||_)){if(a)throw w>ba.maxUrlLength?_l("request:invalid-parameters",new Error("URL exceeds maximum length"),e.params):_l("request:invalid-parameters",new Error("cannot use POST request when method is 'head'"),e.params);if(_)throw _l("request:invalid-parameters",new Error("cannot use proxy when method is 'head'"),e.params)}if(a?(i.method=r.method==="delete"?"DELETE":r.method==="put"?"PUT":"POST",r.body?t=No(t,y):(i.body=Il(y),i.headers||(i.headers={}),i.headers["Content-Type"]="application/x-www-form-urlencoded")):t=No(t,y),_&&(e.useProxy=!0,t=`${b}?${t}`),y.token&&bG&&i.body instanceof FormData&&!Lle(t)&&i.body.set("token",y.token),r.hasOwnProperty("withCredentials"))e.withCredentials=r.withCredentials;else if(!mm(t,xO())){if(MO(t))e.withCredentials=!0;else if(pt){const x=pt.findServerInfo(t);x!=null&&x.webTierAuth&&(e.withCredentials=!0)}}e.withCredentials&&(i.credentials="include",gue(t)&&await vue(a?No(t,y):t))}let u,c,h=0,d=!1;o>0&&(h=setTimeout(()=>{d=!0,e.controller.abort()},o));try{if(r.responseType==="native-request-init")c=i,c.url=t;else if(r.responseType!=="image"||i.cache!=="default"||i.method!=="GET"||a||$ue(r.headers)||!n&&!e.useProxy&&ba.proxyUrl&&!hD(t)){if(be._beforeFetch&&await be._beforeFetch(t,i),u=await fetch(t,i),be._afterFetch&&await be._afterFetch(u),e.useProxy||Sue(t),r.responseType==="native")c=u;else if(i.method!=="HEAD")if(u.ok){switch(s){case"array-buffer":c=await u.arrayBuffer();break;case"blob":case"image":c=await u.blob();break;default:c=await u.text()}if(h&&(clearTimeout(h),h=0),s==="json"||s==="xml"||s==="document")if(c)switch(s){case"json":c=JSON.parse(c);break;case"xml":c=dD(c,"application/xml");break;case"document":c=dD(c,"text/html")}else c=null;if(c){if(s==="array-buffer"||s==="blob"){const y=u.headers.get("Content-Type");if(y&&/application\/json|text\/plain/i.test(y)&&c[s==="blob"?"size":"byteLength"]<=750)try{const v=await new Response(c).json();v.error&&(c=v)}catch{}}s==="image"&&c instanceof Blob&&(c=await fD(URL.createObjectURL(c),e,!0))}}else{c=await u.text();try{c=JSON.parse(c)}catch{}}}else c=await fD(t,e)}catch(y){if(y.name==="AbortError")throw d?yue():Pr("Request canceled");if(!(!u&&y instanceof TypeError&&ba.proxyUrl)||r.body||r.method==="delete"||r.method==="head"||r.method==="post"||r.method==="put"||e.useProxy||hD(t))throw y;e.redoRequest=!0,Zle({proxyUrl:ba.proxyUrl,urlPrefix:Ca(t)??""})}finally{h&&clearTimeout(h)}return[u,c]}async function Mue(e,t){if(e.responseData!=null)return e.responseData;if(e.headers&&(t.requestOptions.headers={...t.requestOptions.headers,...e.headers}),e.query&&(t.requestOptions.query={...t.requestOptions.query,...e.query}),e.before){let r,i;try{i=await e.before(t)}catch(n){r=_l("request:interceptor",n,t)}if((i instanceof Error||i instanceof z)&&(r=_l("request:interceptor",i,t)),r)throw e.error&&e.error(r),r;return i}}function $ue(e){if(e){for(const t of Object.getOwnPropertyNames(e))if(e[t])return!0}return!1}function dD(e,t){let r;try{r=new DOMParser().parseFromString(e,t)}catch{}if(!r||r.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return r}async function Eue(e){var s,o;let t,r;await Tue(e);try{do[t,r]=await Iue(e);while(!await Aue(e,t,r))}catch(a){const u=_l("request:server",a,e.params,t);throw u.details.ssl=e.useSSL,(s=e.interceptor)!=null&&s.error&&e.interceptor.error(u),u}const i=e.params.url;if(r&&/\/sharing\/rest\/(accounts|portals)\/self/i.test(i)){if(!e.hasToken&&!e.credentialToken&&((o=r.user)!=null&&o.username)&&!MO(i)){const a=Ca(i,!0);a&&ba.trustedServers.push(a)}Array.isArray(r.authorizedCrossOriginNoCorsDomains)&&mue(r.authorizedCrossOriginNoCorsDomains)}const n=e.credential;if(n&&pt){const a=pt.findServerInfo(n.server);let u=a==null?void 0:a.owningSystemUrl;if(u){u=u.replace(/\/?$/,"/sharing");const c=pt.findCredential(u,n.userId);c&&pt._getIdenticalSvcIdx(u,c)===-1&&c.resources.unshift(u)}}return{data:r,getAllHeaders:t?()=>Array.from(t.headers):gm,getHeader:t?a=>t.headers.get(a):gm,httpStatus:(t==null?void 0:t.status)??200,requestOptions:e.params.requestOptions,ssl:e.useSSL,url:e.params.url}}async function Aue(e,t,r){var c;if(e.redoRequest)return e.redoRequest=!1,!1;const i=e.params.requestOptions;if(!t||i.responseType==="native"||i.responseType==="native-request-init")return!0;let n,s;if(r&&(r.error?n=r.error:r.status==="error"&&Array.isArray(r.messages)&&(n={...r},n[NS]=r,n.details=r.messages)),!n&&!t.ok)throw n=new Error(`Unable to load ${t.url} status: ${t.status}`),n[NS]=r,n;let o,a=null;n&&(s=Number(n.code),a=n.hasOwnProperty("subcode")?Number(n.subcode):null,o=n.messageCode,o=o==null?void 0:o.toUpperCase());const u=i.authMode;if(s===403&&(a===4||(c=n.message)!=null&&c.toLowerCase().includes("ssl")&&!n.message.toLowerCase().includes("permission"))){if(!e.useSSL)return e.useSSL=!0,!1}else if(!e.hasToken&&e.useIdentity&&(u!=="no-prompt"||s===498)&&s!==void 0&&wue.has(s)&&!_G(e.params.url)&&(s!==403||(!o||!bue.has(o))&&(a==null||a===2&&e.credentialToken))){await q$();try{const h=await pt.getCredential(e.params.url,{error:_l("request:server",n,e.params),prompt:u!=="no-prompt",signal:e.controller.signal,token:e.credentialToken});return e.credential=h,e.credentialToken=h.token,e.useSSL=e.useSSL||h.ssl,!1}catch(h){if(u==="no-prompt")return e.credential=void 0,e.credentialToken=void 0,!1;n=h}}if(n)throw n;return!0}function fD(e,t,r=!1){const i=t.controller.signal,n=new Image;return t.withCredentials?n.crossOrigin="use-credentials":n.crossOrigin="anonymous",n.alt="",n.fetchPriority=ba.priority,n.src=e,due(n,e,r,i)}be._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"],be._beforeFetch=void 0,be._afterFetch=void 0;function Rt(e){if(!Kt.assetsPath)throw oe.getLogger("esri.assets").errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new z("assets:path-not-set","config.assetsPath is not set");return jo(Kt.assetsPath,e)}let k3,J=null;function CO(){return!!J}function Rue(){return!!Me("esri-wasm")}function SG(){return k3||(k3=ge(()=>import("./pe-wasm-T9WQDCoc.js"),__vite__mapDeps([5,1,2])).then(e=>e.p).then(({default:e})=>e({locateFile:t=>Rt(`esri/geometry/support/${t}`)})).then(e=>{TG(e)}),k3)}var H$,mr,W$;(function(e){function t(s,o,a){J.ensureCache.prepare();const u=md(a),c=a===u,h=J.ensureFloat64(u),d=J._pe_geog_to_proj(J.getPointer(s),o,h);return d&&lp(a,o,h,c),d}function r(s,o,a,u){switch(u){case mr.PE_TRANSFORM_P_TO_G:return i(s,o,a);case mr.PE_TRANSFORM_G_TO_P:return t(s,o,a)}return 0}function i(s,o,a){return n(s,o,a,0)}function n(s,o,a,u){J.ensureCache.prepare();const c=md(a),h=a===c,d=J.ensureFloat64(c),y=J._pe_proj_to_geog_center(J.getPointer(s),o,d,u);return y&&lp(a,o,d,h),y}e.geogToProj=t,e.projGeog=r,e.projToGeog=i,e.projToGeogCenter=n})(H$||(H$={})),function(e){function t(){e.PE_BUFFER_MAX=J.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=J.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=J.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=J.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=J.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=J.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=J.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=J.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=J.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=J.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=J.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=J.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=J.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=J.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=J.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=J.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=J.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=J.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=J.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=J.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_STR_FMT_WKT=J.PeDefs.prototype.PE_STR_FMT_WKT,e.PE_STR_FMT_WKT2=J.PeDefs.prototype.PE_STR_FMT_WKT2,e.PE_PARM_X0=J.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=J.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=J.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=J.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=J.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=J.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=J.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=J.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=J.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=J.PeDefs.prototype.PE_HORIZON_DELTA}e.init=t}(mr||(mr={})),function(e){const t={},r={},i=v=>{if(v){const w=v.getType();switch(w){case mr.PE_TYPE_GEOGCS:v=J.castObject(v,J.PeGeogcs);break;case mr.PE_TYPE_PROJCS:v=J.castObject(v,J.PeProjcs);break;case mr.PE_TYPE_GEOGTRAN:v=J.castObject(v,J.PeGeogtran);break;default:w&mr.PE_TYPE_UNIT&&(v=J.castObject(v,J.PeUnit))}}return v};function n(){J.PeFactory.prototype.initialize(null)}function s(v){return o(mr.PE_TYPE_COORDSYS,v)}function o(v,w){let b=null,_=t[v];if(_||(_={},t[v]=_),_.hasOwnProperty(String(w)))b=_[w];else{const x=J.PeFactory.prototype.factoryByType(v,w);J.compare(x,J.NULL)||(b=x,_[w]=b)}return b=i(b),b}function a(v,w){let b=null,_=r[v];if(_||(_={},r[v]=_),_.hasOwnProperty(w))b=_[w];else{const x=J.PeFactory.prototype.fromString(v,w);J.compare(x,J.NULL)||(b=x,_[w]=b)}return b=i(b),b}function u(v){return o(mr.PE_TYPE_GEOGCS,v)}function c(v){return o(mr.PE_TYPE_GEOGTRAN,v)}function h(v){return J.PeFactory.prototype.getCode(v)}function d(v){return o(mr.PE_TYPE_PROJCS,v)}function y(v){return o(mr.PE_TYPE_UNIT,v)}e.initialize=n,e.coordsys=s,e.factoryByType=o,e.fromString=a,e.geogcs=u,e.geogtran=c,e.getCode=h,e.projcs=d,e.unit=y}(W$||(W$={}));let xG=null;var DS,J$,Z$,Y$,FS,K$,jS,US,X$;function TG(e){function t(s,o,a){s[o]=a(s[o])}J=e,mr.init(),DS.init(),FS.init(),jS.init(),US.init(),xG=class extends J.PeGCSExtent{destroy(){J.destroy(this)}};const r=[J.PeDatum,J.PeGeogcs,J.PeGeogtran,J.PeObject,J.PeParameter,J.PePrimem,J.PeProjcs,J.PeSpheroid,J.PeUnit];for(const s of r)t(s.prototype,"getName",o=>function(){return o.call(this,new Array(mr.PE_NAME_MAX))});for(const s of[J.PeGeogtran,J.PeProjcs])t(s.prototype,"getParameters",o=>function(){const a=new Array(mr.PE_PARM_MAX);let u=o.call(this);for(let c=0;c<a.length;c++){const h=J.getValue(u,"*");a[c]=h?J.wrapPointer(h,J.PeParameter):null,u+=Int32Array.BYTES_PER_ELEMENT}return a});t(J.PeHorizon.prototype,"getCoord",s=>function(){const o=this.getSize();if(!o)return null;const a=[];return lp(a,o,s.call(this)),a}),t(J.PeGTlistExtendedEntry.prototype,"getEntries",s=>{const o=J._pe_getPeGTlistExtendedGTsSize();return function(){let a=null;const u=s.call(this);if(!J.compare(u,J.NULL)){a=[u];const c=this.getSteps();if(c>1){const h=J.getPointer(u);for(let d=1;d<c;d++)a.push(J.wrapPointer(h+o*d,J.PeGTlistExtendedGTs))}}return a}});const i=J._pe_getPeHorizonSize(),n=s=>function(){let o=this._cache;if(o||(o=new Map,this._cache=o),o.has(s))return o.get(s);let a=null;const u=s.call(this);if(!J.compare(u,J.NULL)){a=[u];const c=u.getNump();if(c>1){const h=J.getPointer(u);for(let d=1;d<c;d++)a.push(J.wrapPointer(h+i*d,J.PeHorizon))}}return o.set(s,a),a};t(J.PeProjcs.prototype,"horizonGcsGenerate",n),t(J.PeProjcs.prototype,"horizonPcsGenerate",n),J.PeObject.prototype.toString=function(s=mr.PE_STR_OPTS_NONE){J.ensureCache.prepare();const o=J.getPointer(this),a=J.ensureInt8(new Array(mr.PE_BUFFER_MAX));return J.UTF8ToString(J._pe_object_to_string_ext(o,s,a))}}function Wl(e){if(!e)return;const t=J.getClass(e);if(!t)return;const r=J.getCache(t);if(!r)return;const i=J.getPointer(e);i&&delete r[i]}function bb(e,t){const r=[],i=new Array(t);for(let n=0;n<e;n++)r.push(J.ensureInt8(i));return r}function md(e){let t;return Array.isArray(e[0])?(t=[],e.forEach(r=>{t.push(r[0],r[1])})):t=e,t}function lp(e,t,r,i=!1){if(i)for(let n=0;n<2*t;n++)e[n]=J.getValue(r+n*Float64Array.BYTES_PER_ELEMENT,"double");else{const n=e.length===0;for(let s=0;s<t;s++)n&&(e[s]=new Array(2)),e[s][0]=J.getValue(r,"double"),e[s][1]=J.getValue(r+Float64Array.BYTES_PER_ELEMENT,"double"),r+=2*Float64Array.BYTES_PER_ELEMENT}}(function(e){let t;function r(){e.PE_GTLIST_OPTS_COMMON=J.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=J._pe_getPeGTlistExtendedEntrySize()}function i(n,s,o,a,u,c){let h=null;const d=new J.PeInteger(c);try{const y=J.PeGTlistExtended.prototype.getGTlist(n,s,o,a,u,d);if((c=d.val)&&(h=[y],c>1)){const v=J.getPointer(y);for(let w=1;w<c;w++)h.push(J.wrapPointer(v+t*w,J.PeGTlistExtendedEntry))}}finally{J.destroy(d)}return h}e.init=r,e.getGTlist=i})(DS||(DS={})),function(e){function t(r){if(r!=null&&r.length){for(const i of r)Wl(i),i.getEntries().forEach(n=>{Wl(n);const s=n.getGeogtran();Wl(s),s.getParameters().forEach(Wl),[s.getGeogcs1(),s.getGeogcs2()].forEach(o=>{Wl(o);const a=o.getDatum();Wl(a),Wl(a.getSpheroid()),Wl(o.getPrimem()),Wl(o.getUnit())})});J.PeGTlistExtendedEntry.prototype.Delete(r[0])}}e.destroy=t}(J$||(J$={})),function(e){function t(r,i,n,s,o){J.ensureCache.prepare();const a=md(n),u=n===a,c=J.ensureFloat64(a);let h=0;s&&(h=J.ensureFloat64(s));const d=J._pe_geog_to_geog(J.getPointer(r),i,c,h,o);return d&&lp(n,i,c,u),d}e.geogToGeog=t}(Z$||(Z$={})),function(e){const t=(c,h,d,y,v,w)=>{let b,_;switch(J.ensureCache.prepare(),c){case"dd":b=J._pe_geog_to_dd,_=mr.PE_DD_MAX;break;case"ddm":b=J._pe_geog_to_ddm,_=mr.PE_DDM_MAX;break;case"dms":b=J._pe_geog_to_dms,_=mr.PE_DMS_MAX}let x=0;h&&(x=J.getPointer(h));const T=md(y),I=J.ensureFloat64(T),M=bb(d,_),$=b(x,d,I,v,J.ensureInt32(M));if($)for(let A=0;A<d;A++)w[A]=J.UTF8ToString(M[A]);return $},r=(c,h,d,y,v)=>{let w;switch(J.ensureCache.prepare(),c){case"dd":w=J._pe_dd_to_geog;break;case"ddm":w=J._pe_ddm_to_geog;break;case"dms":w=J._pe_dms_to_geog}let b=0;h&&(b=J.getPointer(h));const _=y.map(M=>J.ensureString(M)),x=J.ensureInt32(_),T=J.ensureFloat64(new Array(2*d)),I=w(b,d,x,T);return I&&lp(v,d,T),I};function i(c,h,d,y,v){return t("dms",c,h,d,y,v)}function n(c,h,d,y){return r("dms",c,h,d,y)}function s(c,h,d,y,v){return t("ddm",c,h,d,y,v)}function o(c,h,d,y){return r("ddm",c,h,d,y)}function a(c,h,d,y,v){return t("dd",c,h,d,y,v)}function u(c,h,d,y){return r("dd",c,h,d,y)}e.geogToDms=i,e.dmsToGeog=n,e.geogToDdm=s,e.ddmToGeog=o,e.geogToDd=a,e.ddToGeog=u}(Y$||(Y$={})),function(e){function t(){e.PE_MGRS_STYLE_NEW=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=J.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=J.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=J.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES}function r(n,s,o,a,u,c,h){J.ensureCache.prepare();let d=0;n&&(d=J.getPointer(n));const y=md(o),v=J.ensureFloat64(y),w=bb(s,mr.PE_MGRS_MAX),b=J.ensureInt32(w),_=J._pe_geog_to_mgrs_extended(d,s,v,a,u,c,b);if(_)for(let x=0;x<s;x++)h[x]=J.UTF8ToString(w[x]);return _}function i(n,s,o,a,u){J.ensureCache.prepare();let c=0;n&&(c=J.getPointer(n));const h=o.map(w=>J.ensureString(w)),d=J.ensureInt32(h),y=J.ensureFloat64(new Array(2*s)),v=J._pe_mgrs_to_geog_extended(c,s,d,a,y);return v&&lp(u,s,y),v}e.init=t,e.geogToMgrsExtended=r,e.mgrsToGeogExtended=i}(FS||(FS={})),function(e){function t(i,n,s,o,a,u,c){J.ensureCache.prepare();let h=0;i&&(h=J.getPointer(i));const d=md(s),y=J.ensureFloat64(d),v=bb(n,mr.PE_MGRS_MAX),w=J.ensureInt32(v),b=J._pe_geog_to_usng(h,n,y,o,a,u,w);if(b)for(let _=0;_<n;_++)c[_]=J.UTF8ToString(v[_]);return b}function r(i,n,s,o){J.ensureCache.prepare();let a=0;i&&(a=J.getPointer(i));const u=s.map(y=>J.ensureString(y)),c=J.ensureInt32(u),h=J.ensureFloat64(new Array(2*n)),d=J._pe_usng_to_geog(a,n,c,h);return d&&lp(o,n,h),d}e.geogToUsng=t,e.usngToGeog=r}(K$||(K$={})),function(e){function t(){e.PE_UTM_OPTS_NONE=J.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=J.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=J.PeNotationUtm.prototype.PE_UTM_OPTS_NS}function r(n,s,o,a,u){J.ensureCache.prepare();let c=0;n&&(c=J.getPointer(n));const h=md(o),d=J.ensureFloat64(h),y=bb(s,mr.PE_UTM_MAX),v=J.ensureInt32(y),w=J._pe_geog_to_utm(c,s,d,a,v);if(w)for(let b=0;b<s;b++)u[b]=J.UTF8ToString(y[b]);return w}function i(n,s,o,a,u){J.ensureCache.prepare();let c=0;n&&(c=J.getPointer(n));const h=o.map(w=>J.ensureString(w)),d=J.ensureInt32(h),y=J.ensureFloat64(new Array(2*s)),v=J._pe_utm_to_geog(c,s,d,a,y);return v&&lp(u,s,y),v}e.init=t,e.geogToUtm=r,e.utmToGeog=i}(jS||(jS={})),function(e){const t=new Map;function r(){e.PE_PCSINFO_OPTION_NONE=J.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=J.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=J.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=J.PePCSInfo.prototype.PE_POLE_POINT}function i(n,s=e.PE_PCSINFO_OPTION_DOMAIN){let o=null,a=null;return t.has(n)&&(a=t.get(n),a[s]&&(o=a[s])),o||(o=J.PePCSInfo.prototype.generate(n,s),a||(a=[],t.set(n,a)),a[s]=o),o}e.init=r,e.generate=i}(US||(US={})),function(e){function t(){return J.PeVersion.prototype.version_string()}e.versionString=t}(X$||(X$={}));const Cue=Object.freeze(Object.defineProperty({__proto__:null,get PeCSTransformations(){return H$},get PeDefs(){return mr},get PeFactory(){return W$},get PeGCSExtent(){return xG},get PeGTTransformations(){return Z$},get PeGTlistExtended(){return DS},get PeGTlistExtendedEntry(){return J$},get PeNotationDms(){return Y$},get PeNotationMgrs(){return FS},get PeNotationUsng(){return K$},get PeNotationUtm(){return jS},get PePCSInfo(){return US},get PeVersion(){return X$},_init:TG,get _pe(){return J},isLoaded:CO,isSupported:Rue,load:SG},Symbol.toStringTag,{value:"Module"}));var tf;(function(e){e[e.CGCS2000=4490]="CGCS2000",e[e.GCSMARS2000=104971]="GCSMARS2000",e[e.GCSMARS2000_SPHERE=104905]="GCSMARS2000_SPHERE",e[e.GCSMOON2000=104903]="GCSMOON2000"})(tf||(tf={}));let m;const P={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.1168,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:14,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5041:0,5042:0,5048:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,9709:0,9712:0,9713:0,9716:0,9741:0,9748:2,9749:2,9761:0,9766:0,9793:0,9794:0,9869:0,9874:0,9875:0,9880:0,9895:0,9943:0,9945:0,9947:0,9967:0,9972:0,9977:0,10160:0,10183:0,10188:0,10194:0,10199:0,10207:0,10212:0,10217:0,10222:0,10227:0,10235:0,10240:0,10250:0,10254:0,10270:0,10275:0,10280:0,10306:0,10329:0,10471:0,20002:0,20042:0,20050:1,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22239:0,22240:0,22332:0,22337:0,22338:0,22391:0,22392:0,22639:0,22700:0,22739:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:15,102069:16,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102731:0,102732:0,102759:1,102760:1,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2,103897:1};for(m=2e3;m<=2045;m++)P[m]=0;for(m=2056;m<=2065;m++)P[m]=0;for(m=2067;m<=2135;m++)P[m]=0;for(m=2137;m<=2154;m++)P[m]=0;for(m=2161;m<=2170;m++)P[m]=0;for(m=2172;m<=2193;m++)P[m]=0;for(m=2195;m<=2198;m++)P[m]=0;for(m=2200;m<=2203;m++)P[m]=0;for(m=2205;m<=2217;m++)P[m]=0;for(m=2222;m<=2224;m++)P[m]=1;for(m=2225;m<=2250;m++)P[m]=2;for(m=2251;m<=2253;m++)P[m]=1;for(m=2257;m<=2264;m++)P[m]=2;for(m=2274;m<=2279;m++)P[m]=2;for(m=2280;m<=2282;m++)P[m]=1;for(m=2283;m<=2289;m++)P[m]=2;for(m=2290;m<=2292;m++)P[m]=0;for(m=2308;m<=2313;m++)P[m]=0;for(m=2315;m<=2491;m++)P[m]=0;for(m=2494;m<=2866;m++)P[m]=0;for(m=2867;m<=2869;m++)P[m]=1;for(m=2870;m<=2888;m++)P[m]=2;for(m=2891;m<=2895;m++)P[m]=2;for(m=2896;m<=2898;m++)P[m]=1;for(m=2902;m<=2908;m++)P[m]=2;for(m=2915;m<=2920;m++)P[m]=2;for(m=2921;m<=2923;m++)P[m]=1;for(m=2924;m<=2930;m++)P[m]=2;for(m=2931;m<=2962;m++)P[m]=0;for(m=2964;m<=2968;m++)P[m]=2;for(m=2969;m<=2973;m++)P[m]=0;for(m=2975;m<=2991;m++)P[m]=0;for(m=2995;m<=3051;m++)P[m]=0;for(m=3054;m<=3079;m++)P[m]=0;for(m=3081;m<=3088;m++)P[m]=0;for(m=3092;m<=3101;m++)P[m]=0;for(m=3106;m<=3138;m++)P[m]=0;for(m=3146;m<=3151;m++)P[m]=0;for(m=3153;m<=3166;m++)P[m]=0;for(m=3168;m<=3172;m++)P[m]=0;for(m=3174;m<=3203;m++)P[m]=0;for(m=3294;m<=3358;m++)P[m]=0;for(m=3367;m<=3403;m++)P[m]=0;for(m=3408;m<=3416;m++)P[m]=0;for(m=3417;m<=3438;m++)P[m]=2;for(m=3441;m<=3446;m++)P[m]=2;for(m=3447;m<=3450;m++)P[m]=0;for(m=3451;m<=3459;m++)P[m]=2;for(m=3460;m<=3478;m++)P[m]=0;for(m=3554;m<=3559;m++)P[m]=0;for(m=3560;m<=3570;m++)P[m]=2;for(m=3571;m<=3581;m++)P[m]=0;for(m=3594;m<=3597;m++)P[m]=0;for(m=3601;m<=3604;m++)P[m]=0;for(m=3637;m<=3639;m++)P[m]=0;for(m=3665;m<=3667;m++)P[m]=0;for(m=3693;m<=3695;m++)P[m]=0;for(m=3701;m<=3727;m++)P[m]=0;for(m=3728;m<=3739;m++)P[m]=2;for(m=3740;m<=3751;m++)P[m]=0;for(m=3753;m<=3760;m++)P[m]=2;for(m=3761;m<=3773;m++)P[m]=0;for(m=3775;m<=3777;m++)P[m]=0;for(m=3779;m<=3781;m++)P[m]=0;for(m=3783;m<=3785;m++)P[m]=0;for(m=3788;m<=3791;m++)P[m]=0;for(m=3797;m<=3802;m++)P[m]=0;for(m=3814;m<=3816;m++)P[m]=0;for(m=3825;m<=3829;m++)P[m]=0;for(m=3832;m<=3841;m++)P[m]=0;for(m=3844;m<=3852;m++)P[m]=0;for(m=3873;m<=3885;m++)P[m]=0;for(m=3890;m<=3893;m++)P[m]=0;for(m=3907;m<=3912;m++)P[m]=0;for(m=3942;m<=3950;m++)P[m]=0;for(m=3968;m<=3970;m++)P[m]=0;for(m=3973;m<=3976;m++)P[m]=0;for(m=3986;m<=3989;m++)P[m]=0;for(m=3994;m<=3997;m++)P[m]=0;for(m=4048;m<=4051;m++)P[m]=0;for(m=4056;m<=4063;m++)P[m]=0;for(m=4093;m<=4096;m++)P[m]=0;for(m=4390;m<=4398;m++)P[m]=0;for(m=4399;m<=4413;m++)P[m]=2;for(m=4418;m<=4433;m++)P[m]=2;for(m=4455;m<=4457;m++)P[m]=2;for(m=4484;m<=4489;m++)P[m]=0;for(m=4491;m<=4554;m++)P[m]=0;for(m=4568;m<=4589;m++)P[m]=0;for(m=4652;m<=4656;m++)P[m]=0;for(m=4766;m<=4800;m++)P[m]=0;for(m=5014;m<=5016;m++)P[m]=0;for(m=5069;m<=5072;m++)P[m]=0;for(m=5105;m<=5130;m++)P[m]=0;for(m=5167;m<=5188;m++)P[m]=0;for(m=5253;m<=5259;m++)P[m]=0;for(m=5269;m<=5275;m++)P[m]=0;for(m=5292;m<=5311;m++)P[m]=0;for(m=5329;m<=5331;m++)P[m]=0;for(m=5343;m<=5349;m++)P[m]=0;for(m=5355;m<=5357;m++)P[m]=0;for(m=5387;m<=5389;m++)P[m]=0;for(m=5459;m<=5463;m++)P[m]=0;for(m=5479;m<=5482;m++)P[m]=0;for(m=5518;m<=5520;m++)P[m]=0;for(m=5530;m<=5539;m++)P[m]=0;for(m=5550;m<=5552;m++)P[m]=0;for(m=5562;m<=5583;m++)P[m]=0;for(m=5623;m<=5625;m++)P[m]=2;for(m=5631;m<=5639;m++)P[m]=0;for(m=5649;m<=5653;m++)P[m]=0;for(m=5663;m<=5680;m++)P[m]=0;for(m=5682;m<=5685;m++)P[m]=0;for(m=5875;m<=5877;m++)P[m]=0;for(m=5896;m<=5899;m++)P[m]=0;for(m=5921;m<=5940;m++)P[m]=0;for(m=6050;m<=6125;m++)P[m]=0;for(m=6244;m<=6275;m++)P[m]=0;for(m=6328;m<=6348;m++)P[m]=0;for(m=6350;m<=6356;m++)P[m]=0;for(m=6366;m<=6372;m++)P[m]=0;for(m=6381;m<=6387;m++)P[m]=0;for(m=6393;m<=6404;m++)P[m]=0;for(m=6480;m<=6483;m++)P[m]=0;for(m=6511;m<=6514;m++)P[m]=0;for(m=6579;m<=6581;m++)P[m]=0;for(m=6619;m<=6624;m++)P[m]=0;for(m=6625;m<=6627;m++)P[m]=2;for(m=6628;m<=6632;m++)P[m]=0;for(m=6634;m<=6637;m++)P[m]=0;for(m=6669;m<=6692;m++)P[m]=0;for(m=6707;m<=6709;m++)P[m]=0;for(m=6720;m<=6723;m++)P[m]=0;for(m=6732;m<=6738;m++)P[m]=0;for(m=6931;m<=6933;m++)P[m]=0;for(m=6956;m<=6959;m++)P[m]=0;for(m=7005;m<=7007;m++)P[m]=0;for(m=7057;m<=7070;m++)P[m]=2;for(m=7074;m<=7082;m++)P[m]=0;for(m=7109;m<=7118;m++)P[m]=0;for(m=7119;m<=7127;m++)P[m]=1;for(m=7374;m<=7376;m++)P[m]=0;for(m=7528;m<=7586;m++)P[m]=0;for(m=7587;m<=7645;m++)P[m]=2;for(m=7692;m<=7696;m++)P[m]=0;for(m=7755;m<=7787;m++)P[m]=0;for(m=7791;m<=7795;m++)P[m]=0;for(m=7799;m<=7801;m++)P[m]=0;for(m=7803;m<=7805;m++)P[m]=0;for(m=7825;m<=7831;m++)P[m]=0;for(m=7845;m<=7859;m++)P[m]=0;for(m=8013;m<=8032;m++)P[m]=0;for(m=8065;m<=8068;m++)P[m]=1;for(m=8518;m<=8529;m++)P[m]=2;for(m=8533;m<=8536;m++)P[m]=2;for(m=8538;m<=8540;m++)P[m]=2;for(m=8677;m<=8679;m++)P[m]=0;for(m=8836;m<=8840;m++)P[m]=0;for(m=8857;m<=8859;m++)P[m]=0;for(m=8908;m<=8910;m++)P[m]=0;for(m=9154;m<=9159;m++)P[m]=0;for(m=9205;m<=9218;m++)P[m]=0;for(m=9271;m<=9273;m++)P[m]=0;for(m=9295;m<=9297;m++)P[m]=0;for(m=9356;m<=9360;m++)P[m]=0;for(m=9404;m<=9407;m++)P[m]=0;for(m=9476;m<=9482;m++)P[m]=0;for(m=9487;m<=9494;m++)P[m]=0;for(m=9697;m<=9699;m++)P[m]=0;for(m=9821;m<=9865;m++)P[m]=0;for(m=10285;m<=10291;m++)P[m]=0;for(m=10314;m<=10317;m++)P[m]=0;for(m=10448;m<=10465;m++)P[m]=0;for(m=11114;m<=11118;m++)P[m]=0;for(m=20004;m<=20032;m++)P[m]=0;for(m=20047;m<=20049;m++)P[m]=0;for(m=20062;m<=20092;m++)P[m]=0;for(m=20135;m<=20138;m++)P[m]=0;for(m=20248;m<=20258;m++)P[m]=0;for(m=20348;m<=20358;m++)P[m]=0;for(m=20436;m<=20440;m++)P[m]=0;for(m=20822;m<=20824;m++)P[m]=0;for(m=20904;m<=20932;m++)P[m]=0;for(m=20934;m<=20936;m++)P[m]=0;for(m=21004;m<=21032;m++)P[m]=0;for(m=21035;m<=21037;m++)P[m]=0;for(m=21095;m<=21097;m++)P[m]=0;for(m=21148;m<=21150;m++)P[m]=0;for(m=21207;m<=21264;m++)P[m]=0;for(m=21307;m<=21364;m++)P[m]=0;for(m=21413;m<=21423;m++)P[m]=0;for(m=21453;m<=21463;m++)P[m]=0;for(m=21473;m<=21483;m++)P[m]=0;for(m=21780;m<=21782;m++)P[m]=0;for(m=21891;m<=21894;m++)P[m]=0;for(m=21896;m<=21899;m++)P[m]=0;for(m=22171;m<=22177;m++)P[m]=0;for(m=22181;m<=22187;m++)P[m]=0;for(m=22191;m<=22197;m++)P[m]=0;for(m=22207;m<=22222;m++)P[m]=0;for(m=22229;m<=22232;m++)P[m]=0;for(m=22234;m<=22236;m++)P[m]=0;for(m=22243;m<=22250;m++)P[m]=0;for(m=22262;m<=22265;m++)P[m]=0;for(m=22307;m<=22322;m++)P[m]=0;for(m=22348;m<=22357;m++)P[m]=0;for(m=22407;m<=22422;m++)P[m]=0;for(m=22462;m<=22465;m++)P[m]=0;for(m=22521;m<=22525;m++)P[m]=0;for(m=22607;m<=22622;m++)P[m]=0;for(m=22641;m<=22646;m++)P[m]=0;for(m=22648;m<=22657;m++)P[m]=0;for(m=22707;m<=22722;m++)P[m]=0;for(m=22762;m<=22765;m++)P[m]=0;for(m=22807;m<=22822;m++)P[m]=0;for(m=22991;m<=22994;m++)P[m]=0;for(m=23028;m<=23038;m++)P[m]=0;for(m=23301;m<=23333;m++)P[m]=2;for(m=23830;m<=23853;m++)P[m]=0;for(m=23866;m<=23872;m++)P[m]=0;for(m=23877;m<=23884;m++)P[m]=0;for(m=23886;m<=23894;m++)P[m]=0;for(m=23946;m<=23948;m++)P[m]=0;for(m=24311;m<=24313;m++)P[m]=0;for(m=24342;m<=24347;m++)P[m]=0;for(m=24370;m<=24374;m++)P[m]=10;for(m=24375;m<=24381;m++)P[m]=0;for(m=24718;m<=24721;m++)P[m]=0;for(m=24817;m<=24821;m++)P[m]=0;for(m=24877;m<=24882;m++)P[m]=0;for(m=24891;m<=24893;m++)P[m]=0;for(m=25391;m<=25395;m++)P[m]=0;for(m=25828;m<=25838;m++)P[m]=0;for(m=26191;m<=26195;m++)P[m]=0;for(m=26391;m<=26393;m++)P[m]=0;for(m=26701;m<=26722;m++)P[m]=0;for(m=26729;m<=26799;m++)P[m]=2;for(m=26801;m<=26803;m++)P[m]=2;for(m=26811;m<=26813;m++)P[m]=2;for(m=26847;m<=26870;m++)P[m]=2;for(m=26891;m<=26899;m++)P[m]=0;for(m=26901;m<=26923;m++)P[m]=0;for(m=26929;m<=26946;m++)P[m]=0;for(m=26948;m<=26998;m++)P[m]=0;for(m=27037;m<=27040;m++)P[m]=0;for(m=27205;m<=27232;m++)P[m]=0;for(m=27258;m<=27260;m++)P[m]=0;for(m=27391;m<=27398;m++)P[m]=0;for(m=27561;m<=27564;m++)P[m]=0;for(m=27571;m<=27574;m++)P[m]=0;for(m=27581;m<=27584;m++)P[m]=0;for(m=27591;m<=27594;m++)P[m]=0;for(m=28191;m<=28193;m++)P[m]=0;for(m=28348;m<=28358;m++)P[m]=0;for(m=28402;m<=28432;m++)P[m]=0;for(m=28462;m<=28492;m++)P[m]=0;for(m=29118;m<=29122;m++)P[m]=0;for(m=29168;m<=29172;m++)P[m]=0;for(m=29177;m<=29185;m++)P[m]=0;for(m=29187;m<=29195;m++)P[m]=0;for(m=29900;m<=29903;m++)P[m]=0;for(m=30161;m<=30179;m++)P[m]=0;for(m=30491;m<=30494;m++)P[m]=0;for(m=30729;m<=30732;m++)P[m]=0;for(m=31251;m<=31259;m++)P[m]=0;for(m=31265;m<=31268;m++)P[m]=0;for(m=31275;m<=31279;m++)P[m]=0;for(m=31281;m<=31297;m++)P[m]=0;for(m=31461;m<=31469;m++)P[m]=0;for(m=31491;m<=31495;m++)P[m]=0;for(m=31917;m<=31922;m++)P[m]=0;for(m=31965;m<=32e3;m++)P[m]=0;for(m=32001;m<=32003;m++)P[m]=2;for(m=32005;m<=32031;m++)P[m]=2;for(m=32033;m<=32060;m++)P[m]=2;for(m=32064;m<=32067;m++)P[m]=2;for(m=32074;m<=32077;m++)P[m]=2;for(m=32081;m<=32086;m++)P[m]=0;for(m=32107;m<=32130;m++)P[m]=0;for(m=32133;m<=32159;m++)P[m]=0;for(m=32164;m<=32167;m++)P[m]=2;for(m=32180;m<=32199;m++)P[m]=0;for(m=32201;m<=32260;m++)P[m]=0;for(m=32301;m<=32360;m++)P[m]=0;for(m=32401;m<=32460;m++)P[m]=0;for(m=32501;m<=32560;m++)P[m]=0;for(m=32601;m<=32662;m++)P[m]=0;for(m=32664;m<=32667;m++)P[m]=2;for(m=32701;m<=32761;m++)P[m]=0;for(m=53001;m<=53004;m++)P[m]=0;for(m=53008;m<=53019;m++)P[m]=0;for(m=53021;m<=53032;m++)P[m]=0;for(m=53034;m<=53037;m++)P[m]=0;for(m=53042;m<=53046;m++)P[m]=0;for(m=53074;m<=53080;m++)P[m]=0;for(m=54001;m<=54004;m++)P[m]=0;for(m=54008;m<=54019;m++)P[m]=0;for(m=54021;m<=54032;m++)P[m]=0;for(m=54034;m<=54037;m++)P[m]=0;for(m=54042;m<=54046;m++)P[m]=0;for(m=54048;m<=54053;m++)P[m]=0;for(m=54074;m<=54080;m++)P[m]=0;for(m=54098;m<=54101;m++)P[m]=0;for(m=102001;m<=102040;m++)P[m]=0;for(m=102042;m<=102063;m++)P[m]=0;for(m=102065;m<=102067;m++)P[m]=0;for(m=102070;m<=102117;m++)P[m]=0;for(m=102122;m<=102216;m++)P[m]=0;for(m=102221;m<=102377;m++)P[m]=0;for(m=102382;m<=102388;m++)P[m]=0;for(m=102389;m<=102398;m++)P[m]=2;for(m=102399;m<=102444;m++)P[m]=0;for(m=102445;m<=102447;m++)P[m]=2;for(m=102448;m<=102458;m++)P[m]=0;for(m=102459;m<=102468;m++)P[m]=2;for(m=102469;m<=102499;m++)P[m]=0;for(m=102500;m<=102519;m++)P[m]=1;for(m=102520;m<=102524;m++)P[m]=0;for(m=102525;m<=102529;m++)P[m]=2;for(m=102530;m<=102588;m++)P[m]=0;for(m=102590;m<=102598;m++)P[m]=0;for(m=102601;m<=102603;m++)P[m]=0;for(m=102605;m<=102628;m++)P[m]=0;for(m=102629;m<=102646;m++)P[m]=2;for(m=102648;m<=102700;m++)P[m]=2;for(m=102701;m<=102703;m++)P[m]=0;for(m=102707;m<=102730;m++)P[m]=2;for(m=102733;m<=102758;m++)P[m]=2;for(m=102767;m<=102900;m++)P[m]=0;for(m=102901;m<=102933;m++)P[m]=2;for(m=102934;m<=102950;m++)P[m]=13;for(m=102951;m<=102955;m++)P[m]=0;for(m=102961;m<=102963;m++)P[m]=0;for(m=102965;m<=102969;m++)P[m]=0;for(m=102971;m<=102973;m++)P[m]=0;for(m=102975;m<=102989;m++)P[m]=0;for(m=102990;m<=102992;m++)P[m]=1;for(m=102997;m<=103002;m++)P[m]=0;for(m=103003;m<=103008;m++)P[m]=2;for(m=103009;m<=103011;m++)P[m]=0;for(m=103012;m<=103014;m++)P[m]=2;for(m=103019;m<=103021;m++)P[m]=0;for(m=103022;m<=103024;m++)P[m]=2;for(m=103029;m<=103031;m++)P[m]=0;for(m=103032;m<=103034;m++)P[m]=2;for(m=103065;m<=103068;m++)P[m]=0;for(m=103074;m<=103076;m++)P[m]=0;for(m=103077;m<=103079;m++)P[m]=1;for(m=103080;m<=103082;m++)P[m]=0;for(m=103083;m<=103085;m++)P[m]=2;for(m=103090;m<=103093;m++)P[m]=0;for(m=103097;m<=103099;m++)P[m]=0;for(m=103100;m<=103102;m++)P[m]=2;for(m=103107;m<=103109;m++)P[m]=0;for(m=103110;m<=103112;m++)P[m]=2;for(m=103113;m<=103116;m++)P[m]=0;for(m=103117;m<=103120;m++)P[m]=2;for(m=103153;m<=103157;m++)P[m]=0;for(m=103158;m<=103162;m++)P[m]=2;for(m=103163;m<=103165;m++)P[m]=0;for(m=103166;m<=103168;m++)P[m]=1;for(m=103169;m<=103171;m++)P[m]=2;for(m=103186;m<=103188;m++)P[m]=0;for(m=103189;m<=103191;m++)P[m]=2;for(m=103192;m<=103195;m++)P[m]=0;for(m=103196;m<=103199;m++)P[m]=2;for(m=103200;m<=103224;m++)P[m]=0;for(m=103225;m<=103227;m++)P[m]=1;for(m=103232;m<=103237;m++)P[m]=0;for(m=103238;m<=103243;m++)P[m]=2;for(m=103244;m<=103246;m++)P[m]=0;for(m=103247;m<=103249;m++)P[m]=2;for(m=103254;m<=103256;m++)P[m]=0;for(m=103257;m<=103259;m++)P[m]=2;for(m=103264;m<=103266;m++)P[m]=0;for(m=103267;m<=103269;m++)P[m]=2;for(m=103300;m<=103375;m++)P[m]=0;for(m=103381;m<=103383;m++)P[m]=0;for(m=103384;m<=103386;m++)P[m]=1;for(m=103387;m<=103389;m++)P[m]=0;for(m=103390;m<=103392;m++)P[m]=2;for(m=103397;m<=103399;m++)P[m]=0;for(m=103400;m<=103471;m++)P[m]=2;for(m=103476;m<=103478;m++)P[m]=0;for(m=103479;m<=103481;m++)P[m]=2;for(m=103486;m<=103488;m++)P[m]=0;for(m=103489;m<=103491;m++)P[m]=2;for(m=103492;m<=103495;m++)P[m]=0;for(m=103496;m<=103499;m++)P[m]=2;for(m=103528;m<=103543;m++)P[m]=0;for(m=103544;m<=103548;m++)P[m]=2;for(m=103549;m<=103551;m++)P[m]=0;for(m=103552;m<=103554;m++)P[m]=1;for(m=103555;m<=103557;m++)P[m]=2;for(m=103558;m<=103560;m++)P[m]=0;for(m=103571;m<=103573;m++)P[m]=0;for(m=103574;m<=103576;m++)P[m]=2;for(m=103577;m<=103580;m++)P[m]=0;for(m=103581;m<=103583;m++)P[m]=2;for(m=103595;m<=103694;m++)P[m]=0;for(m=103696;m<=103699;m++)P[m]=0;for(m=103700;m<=103793;m++)P[m]=2;for(m=103794;m<=103890;m++)P[m]=0;for(m=103891;m<=103896;m++)P[m]=2;for(m=103900;m<=103971;m++)P[m]=2;for(m=103972;m<=103977;m++)P[m]=0;for(m=112e3;m<=112101;m++)P[m]=0;const IG=[102100,102113,3857,3785],Oue=[104905,104971],Pue=[4326,...IG,...Oue],yD='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',_b=[-20037508342788905e-9,20037508342788905e-9],Sb=[-20037508342787e-6,20037508342787e-6],MG={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:_b,origin:Sb,dx:1e-5},102100:{wkTemplate:yD,valid:_b,origin:Sb,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:_b,origin:Sb,dx:1e-5},3857:{wkTemplate:yD,valid:_b,origin:Sb,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function fi(e,t){if(e===t)return!0;if(e==null||t==null)return!1;const r=e.wkid,i=t.wkid;if(r!=null||i!=null){if(r===i||rf(e)&&rf(t))return!0;const o=e.latestWkid;if(o!=null&&i===o)return!0;const a=t.latestWkid;return a!=null&&r===a}let n,s;return e.wkt2&&t.wkt2?(n=e.wkt2,s=t.wkt2):e.wkt&&t.wkt&&(n=e.wkt,s=t.wkt),!(!n||!s)&&n.toUpperCase()===s.toUpperCase()}function Xn(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&MG[t]||null}function Ip(e){if(!e)return;const{wkid:t,vcsWkid:r}=e;if(t)return r?JSON.stringify({wkid:t,vcsWkid:r}):String(t);const i=e.wkt||e.wkt2;return JSON.stringify(i?r?{wkt:i,vcsWkid:r}:{wkt:i}:{})}function OO(e){if(!$a(e))return!1;const{wkid:t}=e;if(t)return P[t]==null;const r=e.wkt2||e.wkt;return!!r&&/^\s*(?:GEOGCS|GEOGCRS|GEOGRAPHICCRS)/i.test(r)}function Lue(e){return!($G(e)||EG(e))}function nv(e){return(e==null?void 0:e.wkid)===4326}function ZNe(e){return/^\s*(?:GEOD|GEODETIC|GEOG|GEOGRAPHIC|PROJ|PROJECTED|VERT|VERTICAL|ENG|ENGINEERING|PARAMETRIC|TIME|DERIVEDPROJ|COMPOUND|BOUND)CRS/i.test(e)}function YNe(e){return(e==null?void 0:e.wkid)===tf.CGCS2000}function rf(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&IG.includes(t)}function kue(e){return(e==null?void 0:e.wkid)===32662}function Jx(e){return e===tf.GCSMARS2000||e===tf.GCSMARS2000_SPHERE}function $G(e){return Jx(e==null?void 0:e.wkid)}function Zx(e){return e===tf.GCSMOON2000}function EG(e){return Zx(e==null?void 0:e.wkid)}function Nue(e){const t=e==null?void 0:e.wkid;return t!=null&&t>=2e3&&Pue.includes(t)}function $a(e){if(e==null)return!1;const t=e.wkid;return t!=null&&t>=2e3||e.wkt2!=null||e.wkt!=null}const VS={wkid:4326,wkt:Nx(MG[4326].wkTemplate,{Central_Meridian:"0.0"})},GS={wkid:102100,latestWkid:3857},Due={wkid:32662};function PO(e){return{wkt:`GEOCCS["Spherical geocentric",
    DATUM["Not specified",
      SPHEROID["Sphere",${e.radius},0]],
    PRIMEM["Greenwich",0.0,
      AUTHORITY["EPSG","8901"]],
    UNIT["m",1.0],
    AXIS["Geocentric X",OTHER],
    AXIS["Geocentric Y",EAST],
    AXIS["Geocentric Z",NORTH]
  ]`}}const Fue=PO(kr),LO=PO(wl),kO=PO(Tp),jue={wkt:`GEOCCS["WGS 84",
  DATUM["WGS_1984",
    SPHEROID["WGS 84",${kr.radius},298.257223563,
      AUTHORITY["EPSG","7030"]],
    AUTHORITY["EPSG","6326"]],
  PRIMEM["Greenwich",0,
    AUTHORITY["EPSG","8901"]],
  UNIT["m",1.0,
    AUTHORITY["EPSG","9001"]],
  AXIS["Geocentric X",OTHER],
  AXIS["Geocentric Y",OTHER],
  AXIS["Geocentric Z",NORTH],
  AUTHORITY["EPSG","4978"]
]`},Uue=LO.wkt.toUpperCase(),Vue=kO.wkt.toUpperCase();function Gue(e){if(e!=null&&$a(e)){const t=e.wkid,r=e.wkt2??e.wkt;if(Jx(t))return wl;const i=r==null?void 0:r.toUpperCase();if(r&&i===Uue)return wl;if(Zx(t)||i&&i===Vue)return Tp}return kr}function Bue(e){return Jx(e)?wl:Zx(e)?Tp:kr}function BS(e){return fi(e,Fue)}function Mp(e){return BS(e)||fi(e,LO)||fi(e,kO)}const AG=39.37,zue=kr.radius*Math.PI/200,RG=/(?:LENGTH)?UNIT\[([^\]]+)]]$/i,Gd=P,CG=/UNIT\[([^\]]+)]/i,que=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),Hue=Qr()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),Ba=e=>e*e,cc=e=>e*e*e,sv={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:Ba(.001)},"square-centimeters":{inBaseUnits:Ba(.01)},"square-decimeters":{inBaseUnits:Ba(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:Ba(1e3)},"square-inches":{inBaseUnits:Ba(.0254)},"square-feet":{inBaseUnits:Ba(.3048)},"square-yards":{inBaseUnits:Ba(.9144)},"square-miles":{inBaseUnits:Ba(1609.344)},"square-us-feet":{inBaseUnits:Ba(1200/3937)},acres:{inBaseUnits:.0015625*Ba(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*cc(.001)},"cubic-centimeters":{inBaseUnits:1e3*cc(.01)},"cubic-decimeters":{inBaseUnits:1e3*cc(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*cc(1e3)},"cubic-inches":{inBaseUnits:1e3*cc(.0254)},"cubic-feet":{inBaseUnits:1e3*cc(.3048)},"cubic-yards":{inBaseUnits:1e3*cc(.9144)},"cubic-miles":{inBaseUnits:1e3*cc(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Wue=(()=>{const e={};for(const t in sv)for(const r in sv[t].units)e[r]=t;return e})();function Jue(e,t,r){return e*sv[r].units[t].inBaseUnits}function Zue(e,t,r){return e/sv[r].units[t].inBaseUnits}function Q$(e){const t=Wue[e];if(!t)throw new Error("unknown type");return t}function mD(e,t=null){return t=t||Q$(e),sv[t].baseUnit===e}function bo(e,t,r){if(t===r)return e;const i=Q$(t);if(i!==Q$(r))throw new Error("incompatible units");const n=mD(t,i)?e:Jue(e,t,i);return mD(r,i)?n:Zue(n,r,i)}function Yue(e,t,r){return bo(e,t,"meters")/(r*Math.PI/180)}function OG(e){return Hue.fromJSON(e.toLowerCase())||null}function vm(e){if(e!=null&&!Lue(e))return 1;const t=Wu(e);return t>1e5?1:t}function Kue(e){return Wu(e)>=Gue(e).metersPerDegree?"meters":LG(e)}function Wu(e,t=kr.metersPerDegree){return Xue(e,!0)??t}function Xue(e,t=!1){const r=(e==null?void 0:e.wkid)??null,i=(e==null?void 0:e.wkt2)??(e==null?void 0:e.wkt)??null;let n=null;if(r){if(Jx(r))return wl.metersPerDegree;if(Zx(r))return Tp.metersPerDegree;n=Gd.values[Gd[r]],!n&&t&&que.has(r)&&(n=zue)}else i&&(NG(i)?n=gD(RG.exec(i),n):kG(i)&&(n=gD(CG.exec(i),n)));return n}function KNe(e){return OO(e)?1:Wu(e)}function gD(e,t){return e!=null&&e[1]?PG(e[1]):t}function PG(e){return parseFloat(e.split(",")[1])}function LG(e){const t=(e==null?void 0:e.wkid)??null,r=(e==null?void 0:e.wkt2)??(e==null?void 0:e.wkt)??null;let i=null;if(t)i=Gd.units[Gd[t]];else if(r){const n=NG(r)?RG:kG(r)?CG:null;if(n){const s=n.exec(r);s!=null&&s[1]&&(i=ece(s[1]))}}return i!=null?OG(i):null}function kG(e){return/^GEOCCS/i.test(e)}function NG(e){return/^\s*(?:PROJCS|PROJCRS|PROJECTEDCRS)/i.test(e)}const Que=1e-7;function ece(e){const t=/[\\"']{1}([^\\"']+)/.exec(e);let r=t==null?void 0:t[1];if(!r||!Gd.units.includes(r)){const i=PG(e);r=null;const n=Gd.values;for(let s=0;s<n.length;++s)if(Math.abs(i-n[s])<Que){r=Gd.units[s];break}}return r}const tce={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},rce={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},ice={esriDUDecimalDegrees:"degrees",esriDURadians:"radians"},ov=Qr()(tce),Gu=Qr()(rce),zS=Qr()(ice);function se(e,t,r){let i,n;return t===void 0?(n=e,i=[void 0]):typeof t!="string"?(n=e,i=[void 0],r=t):(n=t,i=Array.isArray(e)?e:[e]),(s,o)=>{const a=s.constructor.prototype;for(const u of i){const c=wV(s,u,n);c.write&&typeof c.write=="object"||(c.write={}),r&&(c.write.target=r),c.write.writer=a[o]}}}var Ha;let $t=Ha=class extends Q{static fromJSON(e){if(!e)return null;if(e.wkid){if(e.wkid===102100)return Ha.WebMercator;if(e.wkid===4326)return Ha.WGS84}const t=new Ha;return t.read(e),t}constructor(e){super(e),this.latestWkid=null,this.wkid=null,this.wkt=null,this.wkt2=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}normalizeCtorArgs(e){return e&&typeof e=="object"?e:{[typeof e=="string"?"wkt":"wkid"]:e}}get isWGS84(){return nv(this)}get isWebMercator(){return rf(this)}get isGeographic(){return OO(this)}get isWrappable(){return Nue(this)}get metersPerUnit(){return Wu(this)}get unit(){return LG(this)||(this.isGeographic?"degrees":null)}writeWkt(e,t){this.wkid||(t.wkt=e)}clone(){if(this===Ha.WGS84)return new Ha(VS);if(this===Ha.WebMercator)return new Ha(GS);const e=new Ha;return this.wkid!=null?(e.wkid=this.wkid,this.latestWkid!=null&&(e.latestWkid=this.latestWkid),this.vcsWkid!=null&&(e.vcsWkid=this.vcsWkid),this.latestVcsWkid!=null&&(e.latestVcsWkid=this.latestVcsWkid)):(this.wkt!=null&&(e.wkt=this.wkt),this.wkt2!=null&&(e.wkt2=this.wkt2)),this.imageCoordinateSystem&&(e.imageCoordinateSystem=B(this.imageCoordinateSystem)),e}equals(e){if(e==null)return!1;if(this.imageCoordinateSystem||e.imageCoordinateSystem){if(this.imageCoordinateSystem==null||e.imageCoordinateSystem==null)return!1;const{id:t,referenceServiceName:r}=e.imageCoordinateSystem,{geodataXform:i}=e.imageCoordinateSystem,n=this.imageCoordinateSystem;return t==null||i?JSON.stringify(n)===JSON.stringify(e.imageCoordinateSystem):r?n.id===t&&n.referenceServiceName===r:n.id===t}return fi(this,e)}toJSON(e){return this.write(void 0,e)}};$t.GCS_NAD_1927=null,$t.WGS84=null,$t.WebMercator=null,$t.PlateCarree=null,l([p({readOnly:!0})],$t.prototype,"isWGS84",null),l([p({readOnly:!0})],$t.prototype,"isWebMercator",null),l([p({readOnly:!0})],$t.prototype,"isGeographic",null),l([p({readOnly:!0})],$t.prototype,"isWrappable",null),l([p({type:Ke,json:{write:!0}})],$t.prototype,"latestWkid",void 0),l([p({readOnly:!0})],$t.prototype,"metersPerUnit",null),l([p({readOnly:!0})],$t.prototype,"unit",null),l([p({type:Ke,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkt==null}}}}}}})],$t.prototype,"wkid",void 0),l([p({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:this.wkid==null}}}}}}})],$t.prototype,"wkt",void 0),l([se("wkt"),se("web-scene","wkt")],$t.prototype,"writeWkt",null),l([p({type:String,json:{write:!1}})],$t.prototype,"wkt2",void 0),l([p({type:Ke,json:{write:!0}})],$t.prototype,"vcsWkid",void 0),l([p({type:Ke,json:{write:!0}})],$t.prototype,"latestVcsWkid",void 0),l([p()],$t.prototype,"imageCoordinateSystem",void 0),$t=Ha=l([k("esri.geometry.SpatialReference")],$t),$t.prototype.toJSON.isDefaultToJSON=!0,$t.GCS_NAD_1927=new $t({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),$t.WGS84=new $t(VS),$t.WebMercator=new $t(GS),$t.PlateCarree=new $t(Due),Object.freeze&&(Object.freeze($t.GCS_NAD_1927),Object.freeze($t.WGS84),Object.freeze($t.WebMercator),Object.freeze($t.PlateCarree));const xe=$t;let Wa=class extends Q{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=xe.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,r){if(t instanceof xe)return t;if(t!=null){const i=new xe;return i.read(t,r),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,r){this.cache[t]=r}};l([p()],Wa.prototype,"type",void 0),l([p({readOnly:!0})],Wa.prototype,"cache",null),l([p({readOnly:!0})],Wa.prototype,"extent",null),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Wa.prototype,"hasM",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Wa.prototype,"hasZ",void 0),l([p({type:xe,json:{write:!0},value:xe.WGS84})],Wa.prototype,"spatialReference",void 0),l([te("spatialReference")],Wa.prototype,"readSpatialReference",null),Wa=l([k("esri.geometry.Geometry")],Wa);const Ju=Wa,nce=Object.prototype.toString;function sce(e){const t="__accessorMetadata__"in e?Lr(e):e;return function(...r){if(r.push(t),typeof r[2]=="number")throw new Error("Using @cast has parameter decorator is not supported since 4.16");return oce.apply(this,r)}}function oce(e,t,r,i){Ux(e,t).cast=i}function ace(e){return(t,r)=>{Ux(t,e).cast=t[r]}}function Tt(...e){if(e.length!==3||typeof e[1]!="string")return e.length===1&&nce.call(e[0])==="[object Function]"?sce(e[0]):e.length===1&&typeof e[0]=="string"?ace(e[0]):void 0}function lce(e,t){const r=e.x-t.x,i=e.y-t.y,n=e.hasZ&&t.hasZ?e.z-t.z:0;return Math.sqrt(r*r+i*i+n*n)}const uce=57.29577951308232,cce=.017453292519943;function vD(e){return e*uce}function wD(e){return e*cce}function QNe(e){return Math.PI/2-2*Math.atan(Math.exp(-e/kr.radius))}function eE(e){return e.wkid!=null||e.wkt!=null}const N3=[0,0];function qS(e,t,r,i,n){const s=e,o=n;if(o.spatialReference=r,"x"in s&&"x"in o)[o.x,o.y]=t(s.x,s.y,N3,i);else if("xmin"in s&&"xmin"in o)[o.xmin,o.ymin]=t(s.xmin,s.ymin,N3,i),[o.xmax,o.ymax]=t(s.xmax,s.ymax,N3,i);else if("paths"in s&&"paths"in o||"rings"in s&&"rings"in o){const a="paths"in s?s.paths:s.rings,u=[];let c;for(let h=0;h<a.length;h++){const d=a[h];c=[],u.push(c);for(let y=0;y<d.length;y++)c.push(t(d[y][0],d[y][1],[0,0],i)),d[y].length>2&&c[y].push(d[y][2]),d[y].length>3&&c[y].push(d[y][3])}"paths"in o?o.paths=u:o.rings=u}else if("points"in s&&"points"in o){const a=s.points,u=[];for(let c=0;c<a.length;c++)u[c]=t(a[c][0],a[c][1],[0,0],i),a[c].length>2&&u[c].push(a[c][2]),a[c].length>3&&u[c].push(a[c][3]);o.points=u}return n}function L_(e,t){const r=e&&(eE(e)?e:e.spatialReference),i=t&&(eE(t)?t:t.spatialReference);return!(e&&"type"in e&&e.type==="mesh"||t&&"type"in t&&t.type==="mesh"||!r||!i)&&(!!fi(i,r)||rf(i)&&nv(r)||rf(r)&&nv(i))}function Yx(e,t){if(e==null)return null;const r=e.spatialReference,i=t&&(eE(t)?t:t.spatialReference);return L_(r,i)?fi(r,i)?B(e):rf(i)?qS(e,Uy,xe.WebMercator,!1,B(e)):nv(i)?qS(e,v1,xe.WGS84,!1,B(e)):null:null}function Uy(e,t,r=[0,0]){t>89.99999?t=89.99999:t<-89.99999&&(t=-89.99999);const i=wD(t);return r[0]=wD(e)*kr.radius,r[1]=kr.halfSemiMajorAxis*Math.log((1+Math.sin(i))/(1-Math.sin(i))),r}function v1(e,t,r=[0,0],i=!1){const n=vD(e/kr.radius);return r[0]=i?n:n-360*Math.floor((n+180)/360),r[1]=vD(Math.PI/2-2*Math.atan(Math.exp(-t/kr.radius))),r}function ku(e,t=!1,r=B(e)){return qS(e,Uy,xe.WebMercator,t,r)}function Vy(e,t=!1,r=B(e)){return qS(e,v1,xe.WGS84,t,r)}var k_;const j0=[0,0];function bD(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let Un=k_=class extends Ju{static copy(e,t){t._set("x",e._get("x")),t._set("y",e._get("y")),t._set("z",e._get("z")),t._set("m",e._get("m"));const r=e._get("spatialReference");t._set("spatialReference",Object.isFrozen(r)?r:r.clone())}constructor(...e){super(...e),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}normalizeCtorArgs(e,t,r,i,n){let s;if(Array.isArray(e))s=e,n=t,e=s[0],t=s[1],r=s[2],i=s[3];else if(e&&typeof e=="object"){if(s=e,e=s.x!=null?s.x:s.longitude,t=s.y!=null?s.y:s.latitude,r=s.z,i=s.m,(n=s.spatialReference)&&n.declaredClass!=="esri.geometry.SpatialReference"&&(n=new xe(n)),s.longitude!=null||s.latitude!=null){if(s.longitude==null)oe.getLogger(this).warn(".longitude=","Latitude was defined without longitude");else if(s.latitude==null)oe.getLogger(this).warn(".latitude=","Longitude was defined without latitude");else if(!s.declaredClass&&n&&n.isWebMercator){const a=Uy(s.longitude,s.latitude,j0);e=a[0],t=a[1]}}}else bD(r)?(n=r,r=null):bD(i)&&(n=i,i=null);const o={x:e,y:t};return o.x==null&&o.y!=null?oe.getLogger(this).warn(".y=","Y coordinate was defined without an X coordinate"):o.y==null&&o.x!=null&&oe.getLogger(this).warn(".x=","X coordinate was defined without a Y coordinate"),n!=null&&(o.spatialReference=n),r!=null&&(o.z=r),i!=null&&(o.m=i),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return this.m!==void 0}set hasM(e){e!==(this._get("m")!==void 0)&&(this._set("m",e?0:void 0),this._set("hasM",e))}get hasZ(){return this.z!==void 0}set hasZ(e){e!==(this._get("z")!==void 0)&&(this._set("z",e?0:void 0),this._set("hasZ",e))}get latitude(){const{spatialReference:e,x:t,y:r}=this;if(e){if(e.isWebMercator)return v1(t,r,j0)[1];if(e.isGeographic)return r}return null}set latitude(e){const{spatialReference:t,x:r}=this;e!=null&&t&&(t.isWebMercator?this._set("y",Uy(r,e,j0)[1]):t.isGeographic&&this._set("y",e),this._set("latitude",e))}get longitude(){const{x:e,y:t,spatialReference:r}=this;if(r){if(r.isWebMercator)return v1(e,t,j0)[0];if(r.isGeographic)return e}return null}set longitude(e){const{y:t,spatialReference:r}=this;e!=null&&r&&(r.isWebMercator?this._set("x",Uy(e,t,j0)[0]):r.isGeographic&&this._set("x",e),this._set("longitude",e))}writeX(e,t,r){t[r]=isNaN(e)?"NaN":e}readX(e){return typeof e=="string"?NaN:e}clone(){const e=new k_;return e.x=this.x,e.y=this.y,e.z=this.z,e.m=this.m,e.spatialReference=this.spatialReference,e}copy(e){return k_.copy(e,this),this}equals(e){if(e==null)return!1;const{x:t,y:r,z:i,m:n,spatialReference:s}=this,{z:o,m:a}=e;let{x:u,y:c,spatialReference:h}=e;if(!s.equals(h))if(s.isWebMercator&&h.isWGS84)[u,c]=Uy(u,c),h=s;else{if(!s.isWGS84||!h.isWebMercator)return!1;[u,c]=v1(u,c),h=s}return t===u&&r===c&&i===o&&n===a&&s.wkid===h.wkid}offset(e,t,r){return this.x+=e,this.y+=t,r!=null&&(this.z=(this.z??0)+r),this}normalize(){if(!this.spatialReference)return this;const e=Xn(this.spatialReference);if(!e)return this;let t=this.x;const[r,i]=e.valid,n=2*i;let s;return t>i?(s=Math.ceil(Math.abs(t-i)/n),t-=s*n):t<r&&(s=Math.ceil(Math.abs(t-r)/n),t+=s*n),this._set("x",t),this}distance(e){return lce(this,e)}toArray(){const e=this.hasZ,t=this.hasM;return e&&t?[this.x,this.y,this.z,this.m]:e?[this.x,this.y,this.z]:t?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(e){return this.write({},e)}};l([p({readOnly:!0})],Un.prototype,"cache",null),l([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Un.prototype,"hasM",null),l([p({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Un.prototype,"hasZ",null),l([p({type:Number})],Un.prototype,"latitude",null),l([p({type:Number})],Un.prototype,"longitude",null),l([p({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),Tt(e=>isNaN(e)?e:Ws(e))],Un.prototype,"x",void 0),l([se("x")],Un.prototype,"writeX",null),l([te("x")],Un.prototype,"readX",null),l([p({type:Number,json:{write:!0}})],Un.prototype,"y",void 0),l([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Un.prototype,"z",void 0),l([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Un.prototype,"m",void 0),Un=k_=l([k("esri.geometry.Point")],Un),Un.prototype.toJSON.isDefaultToJSON=!0;const Ae=Un,D3=[0,0];function Kx(e,t){return t!=null&&Hn(e,t.x,t.y,t.z)}function eDe(e,t){if(!t.points||t.points.length)return!1;for(const r of t.points)if(!wm(e,r))return!1;return!0}function pce(e,t){const{xmin:r,ymin:i,zmin:n,xmax:s,ymax:o,zmax:a}=t;return e.hasZ&&t.hasZ?Hn(e,r,i,n)&&Hn(e,r,o,n)&&Hn(e,s,o,n)&&Hn(e,s,i,n)&&Hn(e,r,i,a)&&Hn(e,r,o,a)&&Hn(e,s,o,a)&&Hn(e,s,i,a):Hn(e,r,i)&&Hn(e,r,o)&&Hn(e,s,o)&&Hn(e,s,i)}function wm(e,t){return Hn(e,t[0],t[1])}function hce(e,t){return Hn(e,t[0],t[1],t[2])}function Hn(e,t,r,i){return t>=e.xmin&&t<=e.xmax&&r>=e.ymin&&r<=e.ymax&&(i==null||!e.hasZ||i>=e.zmin&&i<=e.zmax)}function DG(e,t){return D3[1]=t.y,D3[0]=t.x,dce(e,D3)}function dce(e,t){return FG(e.rings,t)}function FG(e,t){if(!e)return!1;if(fce(e))return _D(!1,e,t);let r=!1;for(let i=0,n=e.length;i<n;i++)r=_D(r,e[i],t);return r}function fce(e){return!Array.isArray(e[0][0])}function _D(e,t,r){const[i,n]=r;let s=e,o=0;for(let a=0,u=t.length;a<u;a++){o++,o===u&&(o=0);const[c,h]=t[a],[d,y]=t[o];(h<n&&y>=n||y<n&&h>=n)&&c+(n-h)/(y-h)*(d-c)<i&&(s=!s)}return s}function yce(e,t){return Kx(e,t)}function mce(e,t){const r=e.hasZ&&t.hasZ;let i,n,s;if(e.xmin<=t.xmin){if(i=t.xmin,e.xmax<i)return!1}else if(i=e.xmin,t.xmax<i)return!1;if(e.ymin<=t.ymin){if(n=t.ymin,e.ymax<n)return!1}else if(n=e.ymin,t.ymax<n)return!1;if(r&&t.hasZ){if(e.zmin<=t.zmin){if(s=t.zmin,e.zmax<s)return!1}else if(s=e.zmin,t.zmax<s)return!1}return!0}function gce(e,t){const{points:r,hasZ:i}=t,n=i?hce:wm;for(const s of r)if(n(e,s))return!0;return!1}const nf=[0,0],sf=[0,0],of=[0,0],af=[0,0],vce=[nf,sf,of,af],jG=[[of,nf],[nf,sf],[sf,af],[af,of]];function wce(e,t){return bce(e,t.rings)}function bce(e,t){nf[0]=e.xmin,nf[1]=e.ymax,sf[0]=e.xmax,sf[1]=e.ymax,of[0]=e.xmin,of[1]=e.ymin,af[0]=e.xmax,af[1]=e.ymin;for(const r of vce)if(FG(t,r))return!0;for(const r of t){if(!r.length)continue;let i=r[0];if(wm(e,i))return!0;for(let n=1;n<r.length;n++){const s=r[n];if(wm(e,s)||UG(i,s,jG))return!0;i=s}}return!1}function _ce(e,t){nf[0]=e.xmin,nf[1]=e.ymax,sf[0]=e.xmax,sf[1]=e.ymax,of[0]=e.xmin,of[1]=e.ymin,af[0]=e.xmax,af[1]=e.ymin;const r=t.paths;for(const i of r){if(!r.length)continue;let n=i[0];if(wm(e,n))return!0;for(let s=1;s<i.length;s++){const o=i[s];if(wm(e,o)||UG(n,o,jG))return!0;n=o}}return!1}const Oi=[0,0];function Sce(e){for(let t=0;t<e.length;t++){const r=e[t];for(let n=0;n<r.length-1;n++){const s=r[n],o=r[n+1];for(let a=t+1;a<e.length;a++)for(let u=0;u<e[a].length-1;u++){const c=e[a][u],h=e[a][u+1];if(tE(s,o,c,h,Oi)&&!(Oi[0]===s[0]&&Oi[1]===s[1]||Oi[0]===c[0]&&Oi[1]===c[1]||Oi[0]===o[0]&&Oi[1]===o[1]||Oi[0]===h[0]&&Oi[1]===h[1]))return!0}}const i=r.length;if(!(i<=4))for(let n=0;n<i-3;n++){let s=i-1;n===0&&(s=i-2);const o=r[n],a=r[n+1];for(let u=n+2;u<s;u++){const c=r[u],h=r[u+1];if(tE(o,a,c,h,Oi)&&!(Oi[0]===o[0]&&Oi[1]===o[1]||Oi[0]===c[0]&&Oi[1]===c[1]||Oi[0]===a[0]&&Oi[1]===a[1]||Oi[0]===h[0]&&Oi[1]===h[1]))return!0}}}return!1}function UG(e,t,r){for(let i=0;i<r.length;i++)if(tE(e,t,r[i][0],r[i][1]))return!0;return!1}function tE(e,t,r,i,n){const[s,o]=e,[a,u]=t,[c,h]=r,[d,y]=i,v=d-c,w=s-c,b=a-s,_=y-h,x=o-h,T=u-o,I=_*b-v*T;if(I===0)return!1;const M=(v*x-_*w)/I,$=(b*x-T*w)/I;return M>=0&&M<=1&&$>=0&&$<=1&&(n&&(n[0]=s+M*(a-s),n[1]=o+M*(u-o)),!0)}function xce(e){switch(e){case"esriGeometryEnvelope":case"extent":return mce;case"esriGeometryMultipoint":case"multipoint":return gce;case"esriGeometryPoint":case"point":return yce;case"esriGeometryPolygon":case"polygon":return wce;case"esriGeometryPolyline":case"polyline":return _ce}}var _o;function Tce(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}function pc(e,t,r){return t==null?r:r==null?t:e(t,r)}let wi=_o=class extends Ju{constructor(...e){super(...e),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(e,t,r,i,n){return Tce(e)?{spatialReference:e,xmin:0,ymin:0,xmax:0,ymax:0}:typeof e=="object"?(e.spatialReference=e.spatialReference==null?xe.WGS84:e.spatialReference,e):{xmin:e,ymin:t,xmax:r,ymax:i,spatialReference:n??xe.WGS84}}static fromBounds(e,t){return new _o({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}static fromPoint(e){return new _o({xmin:e.x,ymin:e.y,zmin:e.z,xmax:e.x,ymax:e.y,zmax:e.z,spatialReference:e.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const e=new Ae({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(e.z=.5*(this.zmin+this.zmax)),this.hasM&&(e.m=.5*(this.mmin+this.mmax)),e}get extent(){return this.clone()}get hasM(){return this.mmin!=null&&this.mmax!=null}get hasZ(){return this.zmin!=null&&this.zmax!=null}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(e){const t=this.center;return e.z!=null&&this.hasZ?this.offset(e.x-t.x,e.y-t.y,e.z-t.z):this.offset(e.x-t.x,e.y-t.y)}clone(){const e=new _o;return e.xmin=this.xmin,e.ymin=this.ymin,e.xmax=this.xmax,e.ymax=this.ymax,e.spatialReference=this.spatialReference,this.zmin!=null&&(e.zmin=this.zmin,e.zmax=this.zmax),this.mmin!=null&&(e.mmin=this.mmin,e.mmax=this.mmax),e}contains(e){if(!e)return!1;const t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&L_(t,r)&&(e=t.isWebMercator?ku(e):Vy(e,!0)),e.type==="point"?Kx(this,e):e.type==="extent"&&pce(this,e)}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,r=e.spatialReference;return t&&r&&!t.equals(r)&&L_(t,r)&&(e=t.isWebMercator?ku(e):Vy(e,!0)),this.xmin===e.xmin&&this.ymin===e.ymin&&this.zmin===e.zmin&&this.mmin===e.mmin&&this.xmax===e.xmax&&this.ymax===e.ymax&&this.zmax===e.zmax&&this.mmax===e.mmax}expand(e){const t=.5*(1-e),r=this.width*t,i=this.height*t;if(this.xmin+=r,this.ymin+=i,this.xmax-=r,this.ymax-=i,this.hasZ){const n=(this.zmax-this.zmin)*t;this.zmin+=n,this.zmax-=n}if(this.hasM){const n=(this.mmax-this.mmin)*t;this.mmin+=n,this.mmax-=n}return this}intersects(e){if(e==null)return!1;e.type==="mesh"&&(e=e.extent);const t=this.spatialReference,r=e.spatialReference;return t&&r&&!fi(t,r)&&L_(t,r)&&(e=t.isWebMercator?ku(e):Vy(e,!0)),xce(e.type)(this,e)}normalize(){const e=this._normalize(!1,!0);return Array.isArray(e)?e:[e]}offset(e,t,r){return this.xmin+=e,this.ymin+=t,this.xmax+=e,this.ymax+=t,r!=null&&(this.zmin+=r,this.zmax+=r),this}shiftCentralMeridian(){return this._normalize(!0)}union(e){return this===e||(this.xmin=Math.min(this.xmin,e.xmin),this.ymin=Math.min(this.ymin,e.ymin),this.xmax=Math.max(this.xmax,e.xmax),this.ymax=Math.max(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=pc(Math.min,this.zmin,e.zmin),this.zmax=pc(Math.max,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=pc(Math.min,this.mmin,e.mmin),this.mmax=pc(Math.max,this.mmax,e.mmax))),this}intersection(e){return this===e?this:e!=null&&this.intersects(e)?(this.xmin=Math.max(this.xmin,e.xmin),this.ymin=Math.max(this.ymin,e.ymin),this.xmax=Math.min(this.xmax,e.xmax),this.ymax=Math.min(this.ymax,e.ymax),(this.hasZ||e.hasZ)&&(this.zmin=pc(Math.max,this.zmin,e.zmin),this.zmax=pc(Math.min,this.zmax,e.zmax)),(this.hasM||e.hasM)&&(this.mmin=pc(Math.max,this.mmin,e.mmin),this.mmax=pc(Math.min,this.mmax,e.mmax)),this):null}toJSON(e){return this.write({},e)}_shiftCM(e=Xn(this.spatialReference)){if(!e||!this.spatialReference)return this;const t=this.spatialReference,r=this._getCM(e);if(r){const i=t.isWebMercator?Vy(r):r;this.xmin-=r.x,this.xmax-=r.x,t.isWebMercator||(i.x=this._normalizeX(i.x,e).x),this.spatialReference=new xe(Nx((t.isWGS84?e.altTemplate:null)??e.wkTemplate,{Central_Meridian:i.x}))}return this}_getCM(e){let t=null;const[r,i]=e.valid,n=this.xmin,s=this.xmax;return n>=r&&n<=i&&s>=r&&s<=i||(t=this.center),t}_normalize(e,t,r){const i=this.spatialReference;if(!i)return this;const n=r??Xn(i);if(n==null)return this;const s=this._getParts(n).map(u=>u.extent);if(s.length<2)return s[0]||this;if(s.length>2)return e?this._shiftCM(n):this.set({xmin:n.valid[0],xmax:n.valid[1]});if(e)return this._shiftCM(n);if(t)return s;let o=!0,a=!0;return s.forEach(u=>{u.hasZ||(o=!1),u.hasM||(a=!1)}),{rings:s.map(u=>{const c=[[u.xmin,u.ymin],[u.xmin,u.ymax],[u.xmax,u.ymax],[u.xmax,u.ymin],[u.xmin,u.ymin]];if(o){const h=(u.zmax-u.zmin)/2;for(let d=0;d<c.length;d++)c[d].push(h)}if(a){const h=(u.mmax-u.mmin)/2;for(let d=0;d<c.length;d++)c[d].push(h)}return c}),hasZ:o,hasM:a,spatialReference:i}}_getParts(e){let t=this.cache._parts;if(!t){t=[];const{ymin:n,ymax:s,spatialReference:o}=this,a=this.width,u=this.xmin,c=this.xmax;let h;e=e||Xn(o);const[d,y]=e.valid;h=this._normalizeX(this.xmin,e);const v=h.x,w=h.frameId;h=this._normalizeX(this.xmax,e);const b=h.x,_=h.frameId,x=v===b&&a>0;if(a>2*y){const T=new _o(u<c?v:b,n,y,s,o),I=new _o(d,n,u<c?b:v,s,o),M=new _o(0,n,y,s,o),$=new _o(d,n,0,s,o),A=[],R=[];T.contains(M)&&A.push(w),T.contains($)&&R.push(w),I.contains(M)&&A.push(_),I.contains($)&&R.push(_);for(let L=w+1;L<_;L++)A.push(L),R.push(L);t.push({extent:T,frameIds:[w]},{extent:I,frameIds:[_]},{extent:M,frameIds:A},{extent:$,frameIds:R})}else v>b||x?t.push({extent:new _o(v,n,y,s,o),frameIds:[w]},{extent:new _o(d,n,b,s,o),frameIds:[_]}):t.push({extent:new _o(v,n,b,s,o),frameIds:[w]});this.cache._parts=t}const r=this.hasZ,i=this.hasM;if(r||i){const n={};r&&(n.zmin=this.zmin,n.zmax=this.zmax),i&&(n.mmin=this.mmin,n.mmax=this.mmax);for(let s=0;s<t.length;s++)t[s].extent.set(n)}return t}_normalizeX(e,t){const[r,i]=t.valid,n=2*i;let s,o=0;return e>i?(s=Math.ceil(Math.abs(e-i)/n),e-=s*n,o=s):e<r&&(s=Math.ceil(Math.abs(e-r)/n),e+=s*n,o=-s),{x:e,frameId:o}}};l([p({readOnly:!0})],wi.prototype,"cache",null),l([p({readOnly:!0})],wi.prototype,"center",null),l([p({readOnly:!0})],wi.prototype,"extent",null),l([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],wi.prototype,"hasM",null),l([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],wi.prototype,"hasZ",null),l([p({readOnly:!0})],wi.prototype,"height",null),l([p({readOnly:!0})],wi.prototype,"width",null),l([p({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],wi.prototype,"xmin",void 0),l([p({type:Number,json:{write:!0}})],wi.prototype,"ymin",void 0),l([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],wi.prototype,"mmin",void 0),l([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],wi.prototype,"zmin",void 0),l([p({type:Number,json:{write:!0}})],wi.prototype,"xmax",void 0),l([p({type:Number,json:{write:!0}})],wi.prototype,"ymax",void 0),l([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],wi.prototype,"mmax",void 0),l([p({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],wi.prototype,"zmax",void 0),wi=_o=l([k("esri.geometry.Extent")],wi),wi.prototype.toJSON.isDefaultToJSON=!0;const Ne=wi;function bm(e,t,r=!1){let{hasM:i,hasZ:n}=e;Array.isArray(t)?t.length!==4||i||n?t.length===3&&r&&!i?(n=!0,i=!1):t.length===3&&i&&n&&(i=!1,n=!1):(i=!0,n=!0):(n=!n&&t.hasZ&&(!i||t.hasM),i=!i&&t.hasM&&(!n||t.hasZ)),e.hasZ=n,e.hasM=i}var rE;function SD(e){return(t,r)=>t==null?r:r==null?t:e(t,r)}function Ice(e){return e&&(e.declaredClass==="esri.geometry.SpatialReference"||e.wkid!=null)}let Sc=rE=class extends Ju{constructor(...e){super(...e),this.points=[],this.type="multipoint"}normalizeCtorArgs(e,t){var n;if(!e&&!t)return{};const r={};Array.isArray(e)?(r.points=e,r.spatialReference=t):Ice(e)?r.spatialReference=e:(e.points&&(r.points=e.points),e.spatialReference&&(r.spatialReference=e.spatialReference),e.hasZ&&(r.hasZ=e.hasZ),e.hasM&&(r.hasM=e.hasM));const i=(n=r.points)==null?void 0:n[0];return i&&(r.hasZ===void 0&&r.hasM===void 0?(r.hasZ=i.length>2,r.hasM=!1):r.hasZ===void 0?r.hasZ=i.length>3:r.hasM===void 0&&(r.hasM=i.length>3)),r}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const e=this.points;if(!e.length)return null;const t=new Ne,r=this.hasZ,i=this.hasM,n=r?3:2,s=e[0],o=SD(Math.min),a=SD(Math.max);let u,c,h,d,[y,v]=s,[w,b]=s;for(let _=0,x=e.length;_<x;_++){const T=e[_],[I,M]=T;if(y=o(y,I),v=o(v,M),w=a(w,I),b=a(b,M),r&&T.length>2){const $=T[2];u=o(u,$),h=a(h,$)}if(i&&T.length>n){const $=T[n];c=o(c,$),d=a(d,$)}}return t.xmin=y,t.ymin=v,t.xmax=w,t.ymax=b,t.spatialReference=this.spatialReference,r?(t.zmin=u,t.zmax=h):(t.zmin=void 0,t.zmax=void 0),i?(t.mmin=c,t.mmax=d):(t.mmin=void 0,t.mmax=void 0),t}writePoints(e,t){t.points=B(this.points)}addPoint(e){return bm(this,e),Array.isArray(e)?this.points.push(e):this.points.push(e.toArray()),this.notifyChange("points"),this}clone(){const e={points:B(this.points),spatialReference:this.spatialReference};return this.hasZ&&(e.hasZ=!0),this.hasM&&(e.hasM=!0),new rE(e)}getPoint(e){if(!this._validateInputs(e))return null;const t=this.points[e],r={x:t[0],y:t[1],spatialReference:this.spatialReference};let i=2;return this.hasZ&&(r.z=t[2],i=3),this.hasM&&(r.m=t[i]),new Ae(r)}removePoint(e){if(!this._validateInputs(e))return null;const t=new Ae(this.points.splice(e,1)[0],this.spatialReference);return this.notifyChange("points"),t}setPoint(e,t){return this._validateInputs(e)?(bm(this,t),Array.isArray(t)||(t=t.toArray()),this.points[e]=t,this.notifyChange("points"),this):this}toJSON(e){return this.write({},e)}_validateInputs(e){return e!=null&&e>=0&&e<this.points.length}};l([p({readOnly:!0})],Sc.prototype,"cache",null),l([p()],Sc.prototype,"extent",null),l([p({type:[[Number]],json:{write:{isRequired:!0}}})],Sc.prototype,"points",void 0),l([se("points")],Sc.prototype,"writePoints",null),Sc=rE=l([k("esri.geometry.Multipoint")],Sc),Sc.prototype.toJSON.isDefaultToJSON=!0;const jv=Sc;function tDe(e){const t=[];for(e.reset();e.nextPath();){const r=[];for(;e.nextPoint();)r.push([e.x,e.y]);t.push(r)}return e.reset(),t}function Mce(e){const t=[];for(;e.nextPoint();)t.push([e.x,e.y]);return e.seekPathStart(),t}var HS;(function(e){e[e.X=0]="X",e[e.Y=1]="Y",e[e.Z=2]="Z"})(HS||(HS={}));function VG(e,t){const r=t[0]-e[0],i=t[1]-e[1];if(e.length>2&&t.length>2){const n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)}return Math.sqrt(r*r+i*i)}function $ce(e,t,r){const i=e[0]+r*(t[0]-e[0]),n=e[1]+r*(t[1]-e[1]);return e.length>2&&t.length>2?[i,n,e[2]+r*(t[2]-e[2])]:[i,n]}function Ece(e,t,r,i){return Ace(e,t,r[i],r[i+1])}function Ace(e,t,r,i){const[n,s]=t,[o,a]=r,[u,c]=i,h=u-o,d=c-a,y=h*h+d*d,v=(n-o)*h+(s-a)*d,w=Math.min(1,Math.max(0,v/y));return e[0]=o+h*w,e[1]=a+d*w,e}function Rce(e,t,r,i,n,s){let o=r,a=i,u=n-o,c=s-a;if(u!==0||c!==0){const h=((e-o)*u+(t-a)*c)/(u*u+c*c);h>1?(o=n,a=s):h>0&&(o+=u*h,a+=c*h)}return u=e-o,c=t-a,u*u+c*c}function GG(e,t){return $ce(e,t,.5)}function BG(e,t=HS.X,r=HS.Y){let i=0;const n=e.length;let s=e[0];for(let o=0;o<n-1;o++){const a=e[o+1];i+=(a[t]-s[t])*(a[r]+s[r]),s=a}return i>=0}function Cce(e){const t=e.length;return t>2&&aO(e[0],e[t-1])}function rDe(e){if("rings"in e&&(Oce(e),e.rings.length>0&&!BG(e.rings[0])))for(const t of e.rings)t.reverse()}function Oce(e){if("rings"in e)for(const t of e.rings)Cce(t)||t.push(t[0].slice())}function iDe(e){return e?e.hasZ?[e.xmax-e.xmin/2,e.ymax-e.ymin/2,e.zmax-e.zmin/2]:[e.xmax-e.xmin/2,e.ymax-e.ymin/2]:null}function Pce(e){return e?Lce(e.rings,e.hasZ??!1):null}function Lce(e,t){if(!(e!=null&&e.length))return null;const r=[],i=[],n=t?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let s=0,o=e.length;s<o;s++){const a=zG(e[s],t,n);a&&i.push(a)}if(i.sort((s,o)=>{let a=s[2]-o[2];return a===0&&t&&(a=s[4]-o[4]),a}),i.length&&(r[0]=i[0][0],r[1]=i[0][1],t&&(r[2]=i[0][3]),(r[0]<n[0]||r[0]>n[1]||r[1]<n[2]||r[1]>n[3]||t&&(r[2]<n[4]||r[2]>n[5]))&&(r.length=0)),!r.length){const s=e[0]&&e[0].length?kce(e[0],t):null;if(!s)return null;r[0]=s[0],r[1]=s[1],t&&s.length>2&&(r[2]=s[2])}return r}function zG(e,t,r){let i=0,n=0,s=0,o=0,a=0;const u=e.length?e[0][0]:0,c=e.length?e[0][1]:0,h=e.length&&t?e[0][2]:0;for(let y=0;y<e.length;y++){const v=e[y],w=e[(y+1)%e.length],[b,_,x]=v,T=b-u,I=_-c,[M,$,A]=w,R=M-u,L=$-c,C=T*L-R*I;if(o+=C,i+=(T+R)*C,n+=(I+L)*C,t&&v.length>2&&w.length>2){const U=x-h,F=A-h,j=T*F-R*U;s+=(U+F)*j,a+=j}b<r[0]&&(r[0]=b),b>r[1]&&(r[1]=b),_<r[2]&&(r[2]=_),_>r[3]&&(r[3]=_),t&&(x<r[4]&&(r[4]=x),x>r[5]&&(r[5]=x))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const d=[i/(6*o)+u,n/(6*o)+c,o];return t&&(r[4]===r[5]||a===0?(d[3]=(r[4]+r[5])/2,d[4]=0):(d[3]=s/(6*a)+h,d[4]=a)),d}function nDe(e,t){let r=0,i=0,n=0;e.nextPoint();const s=e.pathSize?e.x:0,o=e.pathSize?e.y:0;for(let a=0;a<e.pathSize;a++){e.seekInPath(a);const u=[e.x,e.y];e.seekInPath((a+1)%e.pathSize);const c=[e.x,e.y],[h,d]=u,y=h-s,v=d-o,[w,b]=c,_=w-s,x=b-o,T=y*x-_*v;n+=T,r+=(y+_)*T,i+=(v+x)*T,h<t[0]&&(t[0]=h),h>t[1]&&(t[1]=h),d<t[2]&&(t[2]=d),d>t[3]&&(t[3]=d)}return n>0&&(n*=-1),n?(n*=.5,[r/(6*n)+s,i/(6*n)+o,n]):null}function kce(e,t){const r=t?[0,0,0]:[0,0],i=t?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;for(let u=0,c=e.length;u<c-1;u++){const h=e[u],d=e[u+1];if(h&&d){r[0]=h[0],r[1]=h[1],i[0]=d[0],i[1]=d[1],t&&h.length>2&&d.length>2&&(r[2]=h[2],i[2]=d[2]);const y=VG(r,i);if(y){n+=y;const v=GG(h,d);s+=y*v[0],o+=y*v[1],t&&v.length>2&&(a+=y*v[2])}}}return n>0?t?[s/n,o/n,a/n]:[s/n,o/n]:e.length?e[0]:null}function Nce(e){const{hasZ:t,totalSize:r}=e;if(r===0)return null;const i=[],n=[],s=t?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];for(e.reset();e.nextPath();){const o=zG(Mce(e),e.hasZ,s);o&&n.push(o)}if(n.sort((o,a)=>{let u=o[2]-a[2];return u===0&&t&&(u=o[4]-a[4]),u}),n.length&&(i[0]=n[0][0],i[1]=n[0][1],t&&(i[2]=n[0][3]),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||t&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)),!i.length){e.reset(),e.nextPath();const o=e.pathSize?Dce(e):null;if(!o)return null;i[0]=o[0],i[1]=o[1],t&&o.length>2&&(i[2]=o[2])}return i}function Dce(e){const{hasZ:t}=e,r=t?[0,0,0]:[0,0],i=t?[0,0,0]:[0,0];let n=0,s=0,o=0,a=0;if(e.nextPoint()){let u=e.x,c=e.y,h=e.z;for(;e.nextPoint();){const d=e.x,y=e.y,v=e.z;r[0]=u,r[1]=c,i[0]=d,i[1]=y,t&&(r[2]=h,i[2]=v);const w=VG(r,i);if(w){n+=w;const b=GG(r,i);s+=w*b[0],o+=w*b[1],t&&b.length>2&&(a+=w*b[2])}u=d,c=y,h=v}}return n>0?t?[s/n,o/n,a/n]:[s/n,o/n]:e.pathSize?(e.seekPathStart(),e.nextPoint(),[e.x,e.y]):null}const Fce=1e-6;function sDe(e){let t=0;for(e.reset();e.nextPath();)t+=e.getCurrentRingArea();if(t<Fce){const n=Nce(e);return n?[n[0],n[1]]:null}const r=[0,0];if(e.reset(),!e.nextPath()||!e.nextPoint())return null;const i=[e.x,e.y];for(e.reset();e.nextPath();)Uce(r,i,e);return r[0]*=1/t,r[1]*=1/t,r[0]+=i[0],r[1]+=i[1],r}const jce=1/3;function Uce(e,t,r){if(!e||!r||r.pathSize<3)return null;r.nextPoint();const i=r.x,n=r.y;r.nextPoint();let s,o=r.x-i,a=r.y-n,u=0,c=0;for(;r.nextPoint();)u=r.x-i,c=r.y-n,s=.5*jce*(u*a-c*o),e[0]+=s*(o+u),e[1]+=s*(a+c),o=u,a=c;const h=r.getCurrentRingArea(),d=[i,n];return d[0]-=t[0],d[1]-=t[1],d[0]*=h,d[1]*=h,e[0]+=d[0],e[1]+=d[1],e}function Fp(){return[0,0,0]}function Vce(e){return[e[0],e[1],e[2]]}function Uv(e,t,r){return[e,t,r]}function Gce(e,t=Fp()){const r=Math.min(3,e.length);for(let i=0;i<r;++i)t[i]=e[i];return t}function Bce(e,t){return new Float64Array(e,t,3)}function qG(){return Fp()}function HG(){return Uv(1,1,1)}function WG(){return Uv(1,0,0)}function JG(){return Uv(0,1,0)}function ZG(){return Uv(0,0,1)}const zce=qG(),YG=HG(),qce=WG(),Hce=JG(),Wce=ZG();Object.freeze(Object.defineProperty({__proto__:null,ONES:YG,UNIT_X:qce,UNIT_Y:Hce,UNIT_Z:Wce,ZEROS:zce,clone:Vce,create:Fp,createView:Bce,fromArray:Gce,fromValues:Uv,ones:HG,unitX:WG,unitY:JG,unitZ:ZG,zeros:qG},Symbol.toStringTag,{value:"Module"}));let NO=1e-6;function Bo(){return NO}function Jce(e){NO=e}const Xx=Math.random,Zce=Math.PI/180,Yce=180/Math.PI;function DO(e){return e*Zce}function Kce(e){return e*Yce}function Xce(e,t){return Math.abs(e-t)<=NO*Math.max(1,Math.abs(e),Math.abs(t))}Object.freeze(Object.defineProperty({__proto__:null,RANDOM:Xx,equals:Xce,getEpsilon:Bo,setEpsilon:Jce,toDegree:Kce,toRadian:DO},Symbol.toStringTag,{value:"Module"}));function FO(e){const t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)}function Qce(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function KG(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function epe(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function XG(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function QG(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function eB(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function tpe(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function rpe(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function ipe(e,t){return e[0]=Math.abs(t[0]),e[1]=Math.abs(t[1]),e[2]=Math.abs(t[2]),e}function npe(e,t){return e[0]=Math.sign(t[0]),e[1]=Math.sign(t[1]),e[2]=Math.sign(t[2]),e}function spe(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function ope(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function ape(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function tB(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function lpe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function rB(e,t){const r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return Math.sqrt(r*r+i*i+n*n)}function iB(e,t){const r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2];return r*r+i*i+n*n}function nB(e){const t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function upe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function cpe(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function iE(e,t){const r=t[0],i=t[1],n=t[2];let s=r*r+i*i+n*n;return s>0&&(s=1/Math.sqrt(s),e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s),e}function sB(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ppe(e,t,r){const i=t[0],n=t[1],s=t[2],o=r[0],a=r[1],u=r[2];return e[0]=n*u-s*a,e[1]=s*o-i*u,e[2]=i*a-n*o,e}function hpe(e,t,r,i){const n=t[0],s=t[1],o=t[2];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=o+i*(r[2]-o),e}function dpe(e,t,r,i,n,s){const o=s*s,a=o*(2*s-3)+1,u=o*(s-2)+s,c=o*(s-1),h=o*(3-2*s);return e[0]=t[0]*a+r[0]*u+i[0]*c+n[0]*h,e[1]=t[1]*a+r[1]*u+i[1]*c+n[1]*h,e[2]=t[2]*a+r[2]*u+i[2]*c+n[2]*h,e}function fpe(e,t,r,i,n,s){const o=1-s,a=o*o,u=s*s,c=a*o,h=3*s*a,d=3*u*o,y=u*s;return e[0]=t[0]*c+r[0]*h+i[0]*d+n[0]*y,e[1]=t[1]*c+r[1]*h+i[1]*d+n[1]*y,e[2]=t[2]*c+r[2]*h+i[2]*d+n[2]*y,e}function ype(e,t){t=t||1;const r=Xx,i=2*r()*Math.PI,n=2*r()-1,s=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(i)*s,e[1]=Math.sin(i)*s,e[2]=n*t,e}function mpe(e,t,r){const i=t[0],n=t[1],s=t[2];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12],e[1]=r[1]*i+r[5]*n+r[9]*s+r[13],e[2]=r[2]*i+r[6]*n+r[10]*s+r[14],e}function gpe(e,t,r){const i=t[0],n=t[1],s=t[2];return e[0]=i*r[0]+n*r[3]+s*r[6],e[1]=i*r[1]+n*r[4]+s*r[7],e[2]=i*r[2]+n*r[5]+s*r[8],e}function vpe(e,t,r){const i=r[0],n=r[1],s=r[2],o=r[3],a=t[0],u=t[1],c=t[2],h=n*c-s*u,d=s*a-i*c,y=i*u-n*a,v=n*y-s*d,w=s*h-i*y,b=i*d-n*h,_=2*o;return e[0]=a+h*_+2*v,e[1]=u+d*_+2*w,e[2]=c+y*_+2*b,e}function wpe(e,t,r,i){const n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0],s[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),s[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function bpe(e,t,r,i){const n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),s[1]=n[1],s[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function _pe(e,t,r,i){const n=[],s=[];return n[0]=t[0]-r[0],n[1]=t[1]-r[1],n[2]=t[2]-r[2],s[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),s[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),s[2]=n[2],e[0]=s[0]+r[0],e[1]=s[1]+r[1],e[2]=s[2]+r[2],e}function Spe(e,t){iE(xD,e),iE(TD,t);const r=sB(xD,TD);return r>1?0:r<-1?Math.PI:Math.acos(r)}const xD=Fp(),TD=Fp();function xpe(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function Tpe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Ipe(e,t){if(e===t)return!0;const r=e[0],i=e[1],n=e[2],s=t[0],o=t[1],a=t[2],u=Bo();return Math.abs(r-s)<=u*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-o)<=u*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(n-a)<=u*Math.max(1,Math.abs(n),Math.abs(a))}function Mpe(e,t,r){const i=r[0]-t[0],n=r[1]-t[1],s=r[2]-t[2];let o=i*i+n*n+s*s;return o>0?(o=1/Math.sqrt(o),e[0]=i*o,e[1]=n*o,e[2]=s*o,e):(e[0]=0,e[1]=0,e[2]=0,e)}const $pe=XG,Epe=QG,Ape=eB,Rpe=rB,Cpe=iB,Ope=FO,Ppe=nB;Object.freeze(Object.defineProperty({__proto__:null,abs:ipe,add:epe,angle:Spe,bezier:fpe,ceil:tpe,copy:Qce,cross:ppe,direction:Mpe,dist:Rpe,distance:rB,div:Ape,divide:eB,dot:sB,equals:Ipe,exactEquals:Tpe,floor:rpe,hermite:dpe,inverse:cpe,len:Ope,length:FO,lerp:hpe,max:ope,min:spe,mul:Epe,multiply:QG,negate:upe,normalize:iE,random:ype,rotateX:wpe,rotateY:bpe,rotateZ:_pe,round:ape,scale:tB,scaleAndAdd:lpe,set:KG,sign:npe,sqrDist:Cpe,sqrLen:Ppe,squaredDistance:iB,squaredLength:nB,str:xpe,sub:$pe,subtract:XG,transformMat3:gpe,transformMat4:mpe,transformQuat:vpe},Symbol.toStringTag,{value:"Module"}));const ID=new Float32Array(1);function oDe(e){--e;for(let t=1;t<32;t<<=1)e|=e>>t;return e+1}function ka(e,t,r){return Math.min(Math.max(e,t),r)}function aDe(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e}function Lpe(e,t,r){return e+(t-e)*r}function lDe(e,t,r,i,n){return Lpe(i,n,(e-t)/(r-t))}function jO(e){return e*Math.PI/180}function oB(e){return 180*e/Math.PI}function uDe(e){return Math.acos(ka(e,-1,1))}function aB(e){return Math.asin(ka(e,-1,1))}function w1(e,t,r=1e-6){return e===t?!0:!Number.isFinite(e)||!Number.isFinite(t)?!1:(e>t?e-t:t-e)<=r}const WS=new DataView(new ArrayBuffer(Float64Array.BYTES_PER_ELEMENT));function kpe(e){return WS.setFloat64(0,e),WS.getBigInt64(0)}function Npe(e){return WS.setBigInt64(0,e),WS.getFloat64(0)}const F3=BigInt("1000000");Dpe(1);function Dpe(e){const t=kpe(e=Math.abs(e)),r=Npe(t<=F3?F3:t-F3);return Math.abs(e-r)}function cDe(e){return lB(Math.max(-MD,Math.min(e,MD)))}function lB(e){return ID[0]=e,ID[0]}function pDe(e,t){const r=FO(e),i=aB(e[2]/r),n=Math.atan2(e[1]/r,e[0]/r);return KG(t,r,i,n),t}function hDe(e){const t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[3]*e[3]+e[4]*e[4]+e[5]*e[5],i=e[6]*e[6]+e[7]*e[7]+e[8]*e[8];return!(w1(t,1)&&w1(r,1)&&w1(i,1))}const MD=lB(34028234663852886e22);function ws(e=jpe){return[e[0],e[1],e[2],e[3]]}function uB(e,t){return e!==t&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3]),e}function cB(e,t,r,i,n=ws()){return n[0]=e,n[1]=t,n[2]=r,n[3]=i,n}function dDe(e,t=ws()){return t[0]=e.xmin,t[1]=e.ymin,t[2]=e.xmax,t[3]=e.ymax,t}function fDe(e,t){return new Ne({xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:t})}function yDe(e,t){t[0]<e[0]&&(e[0]=t[0]),t[0]>e[2]&&(e[2]=t[0]),t[1]<e[1]&&(e[1]=t[1]),t[1]>e[3]&&(e[3]=t[1])}function mDe(e,t,r){if(t!=null)if("length"in t)nE(t)?(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[2]),r[3]=Math.max(e[3],t[3])):t.length!==2&&t.length!==3||(r[0]=Math.min(e[0],t[0]),r[1]=Math.min(e[1],t[1]),r[2]=Math.max(e[2],t[0]),r[3]=Math.max(e[3],t[1]));else switch(t.type){case"extent":r[0]=Math.min(e[0],t.xmin),r[1]=Math.min(e[1],t.ymin),r[2]=Math.max(e[2],t.xmax),r[3]=Math.max(e[3],t.ymax);break;case"point":r[0]=Math.min(e[0],t.x),r[1]=Math.min(e[1],t.y),r[2]=Math.max(e[2],t.x),r[3]=Math.max(e[3],t.y)}else uB(r,e)}function pB(e){return e==null||e[0]>=e[2]?0:e[2]-e[0]}function hB(e){return e==null||e[1]>=e[3]?0:e[3]-e[1]}function gDe(e){return pB(e)*hB(e)}function vDe(e,t,r){return t>=e[0]&&r>=e[1]&&t<=e[2]&&r<=e[3]}function wDe(e,t){return Math.max(t[0],e[0])<=Math.min(t[2],e[2])&&Math.max(t[1],e[1])<=Math.min(t[3],e[3])}function Fpe(e,t){return t[0]>=e[0]&&t[2]<=e[2]&&t[1]>=e[1]&&t[3]<=e[3]}function bDe(e){return e?uB(e,$D):ws($D)}function nE(e){return e!=null&&e.length===4}function _De(e,t){return nE(e)&&nE(t)?e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]:e===t}const $D=[1/0,1/0,-1/0,-1/0],jpe=[0,0,0,0];function dB(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function fB(e){return e.points!==void 0}function yB(e){return e.x!==void 0&&e.y!==void 0}function mB(e){return e.paths!==void 0}function gB(e){return e.rings!==void 0}function vB(e){function t(r,i){return r==null?i:i==null?r:e(r,i)}return t}const hp=vB(Math.min),dp=vB(Math.max);function SDe(e,t){return mB(t)?_m(e,t.paths,!1,!1):gB(t)?_m(e,t.rings,!1,!1):fB(t)?UO(e,t.points,!1,!1,!1,!1):dB(t)?wB(e,t):(yB(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.x,e[3]=t.y),e)}function xDe(e){let t,r,i,n;for(e.reset(),t=i=1/0,r=n=-1/0;e.nextPath();){const s=Upe(e);t=Math.min(s[0],t),i=Math.min(s[1],i),r=Math.max(s[2],r),n=Math.max(s[3],n)}return ws([t,i,r,n])}function Upe(e){let t,r,i,n;for(t=i=1/0,r=n=-1/0;e.nextPoint();)t=Math.min(e.x,t),i=Math.min(e.y,i),r=Math.max(e.x,r),n=Math.max(e.y,n);return ws([t,i,r,n])}function TDe(e,t){return mB(t)?_m(e,t.paths,!0,!1):gB(t)?_m(e,t.rings,!0,!1):fB(t)?UO(e,t.points,!0,!1,!0,!1):dB(t)?wB(e,t,!0,!1,!0,!1):(yB(t)&&(e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.x,e[4]=t.y,e[5]=t.z),e)}function _m(e,t,r,i){const n=r?3:2;if(!t.length||!t[0].length)return null;let s,o,a,u,[c,h]=t[0][0],[d,y]=t[0][0];for(let v=0;v<t.length;v++){const w=t[v];for(let b=0;b<w.length;b++){const _=w[b],[x,T]=_;if(c=hp(c,x),h=hp(h,T),d=dp(d,x),y=dp(y,T),r&&_.length>2){const I=_[2];s=hp(s,I),o=dp(o,I)}if(i&&_.length>n){const I=_[n];a=hp(s,I),u=dp(o,I)}}}return r?i?(e[0]=c,e[1]=h,e[2]=s,e[3]=a,e[4]=d,e[5]=y,e[6]=o,e[7]=u,e.length=8,e):(e[0]=c,e[1]=h,e[2]=s,e[3]=d,e[4]=y,e[5]=o,e.length=6,e):i?(e[0]=c,e[1]=h,e[2]=a,e[3]=d,e[4]=y,e[5]=u,e.length=6,e):(e[0]=c,e[1]=h,e[2]=d,e[3]=y,e.length=4,e)}function wB(e,t,r,i,n,s){const o=t.xmin,a=t.xmax,u=t.ymin,c=t.ymax;let h=t.zmin,d=t.zmax,y=t.mmin,v=t.mmax;return n?(h=h||0,d=d||0,s?(y=y||0,v=v||0,e[0]=o,e[1]=u,e[2]=h,e[3]=y,e[4]=a,e[5]=c,e[6]=d,e[7]=v,e):(e[0]=o,e[1]=u,e[2]=h,e[3]=a,e[4]=c,e[5]=d,e)):s?(y=y||0,v=v||0,e[0]=o,e[1]=u,e[2]=y,e[3]=a,e[4]=c,e[5]=v,e):(e[0]=o,e[1]=u,e[2]=a,e[3]=c,e)}function UO(e,t,r,i,n,s){const o=r?3:2,a=i&&s,u=r&&n;if(!t.length||!t[0].length)return null;let c,h,d,y,[v,w]=t[0],[b,_]=t[0];for(let x=0;x<t.length;x++){const T=t[x],[I,M]=T;if(v=hp(v,I),w=hp(w,M),b=dp(b,I),_=dp(_,M),u&&T.length>2){const $=T[2];c=hp(c,$),h=dp(h,$)}if(a&&T.length>o){const $=T[o];d=hp(c,$),y=dp(h,$)}}return n?(c=c||0,h=h||0,s?(d=d||0,y=y||0,e[0]=v,e[1]=w,e[2]=c,e[3]=d,e[4]=b,e[5]=_,e[6]=h,e[7]=y,e):(e[0]=v,e[1]=w,e[2]=c,e[3]=b,e[4]=_,e[5]=h,e)):s?(d=d||0,y=y||0,e[0]=v,e[1]=w,e[2]=d,e[3]=b,e[4]=_,e[5]=y,e):(e[0]=v,e[1]=w,e[2]=b,e[3]=_,e)}function Vpe(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function Gpe(e){return e.points!==void 0}function Bpe(e){return e.x!==void 0&&e.y!==void 0}function zpe(e){return e.paths!==void 0}function qpe(e){return e.rings!==void 0}const VO=[];function bB(e,t,r,i){return{xmin:e,ymin:t,xmax:r,ymax:i}}function _B(e,t,r,i,n,s){return{xmin:e,ymin:t,zmin:r,xmax:i,ymax:n,zmax:s}}function SB(e,t,r,i,n,s){return{xmin:e,ymin:t,mmin:r,xmax:i,ymax:n,mmax:s}}function xB(e,t,r,i,n,s,o,a){return{xmin:e,ymin:t,zmin:r,mmin:i,xmax:n,ymax:s,zmax:o,mmax:a}}function GO(e,t=!1,r=!1){return t?r?xB(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]):_B(e[0],e[1],e[2],e[3],e[4],e[5]):r?SB(e[0],e[1],e[2],e[3],e[4],e[5]):bB(e[0],e[1],e[2],e[3])}function IDe(e){return e?Vpe(e)?e:Bpe(e)?Wpe(e):qpe(e)?TB(e):zpe(e)?IB(e):Gpe(e)?Hpe(e):null:null}function Hpe(e){const{hasZ:t,hasM:r,points:i}=e;return GO(UO(VO,i,t??!1,r??!1),t,r)}function Wpe(e){const{x:t,y:r,z:i,m:n}=e,s=n!=null;return i!=null?s?xB(t,r,i,n,t,r,i,n):_B(t,r,i,t,r,i):s?SB(t,r,n,t,r,n):bB(t,r,t,r)}function TB(e){const{hasZ:t,hasM:r,rings:i}=e,n=_m(VO,i,t??!1,r??!1);return n?GO(n,t,r):null}function IB(e){const{hasZ:t,hasM:r,paths:i}=e,n=_m(VO,i,t??!1,r??!1);return n?GO(n,t,r):null}var N_;function ED(e){return!Array.isArray(e[0])}let Ja=N_=class extends Ju{static fromExtent(e){const t=e.clone().normalize(),r=e.spatialReference;let i=!1,n=!1;for(const o of t)o.hasZ&&(i=!0),o.hasM&&(n=!0);const s={rings:t.map(o=>{const a=[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]];if(i&&o.hasZ){const u=o.zmin+.5*(o.zmax-o.zmin);for(let c=0;c<a.length;c++)a[c].push(u)}if(n&&o.hasM){const u=o.mmin+.5*(o.mmax-o.mmin);for(let c=0;c<a.length;c++)a[c].push(u)}return a}),spatialReference:r};return i&&(s.hasZ=!0),n&&(s.hasM=!0),new N_(s)}constructor(...e){super(...e),this.rings=[],this.type="polygon"}normalizeCtorArgs(e,t){var o,a;let r,i,n=null,s=null;return e&&!Array.isArray(e)?(n=e.rings??null,t||(e.spatialReference?t=e.spatialReference:e.rings||(t=e)),r=e.hasZ,i=e.hasM):n=e,n=n||[],t=t||xe.WGS84,n.length&&((o=n[0])==null?void 0:o[0])!=null&&typeof n[0][0]=="number"&&(n=[n]),s=(a=n[0])==null?void 0:a[0],s&&(r===void 0&&i===void 0?(r=s.length>2,i=s.length>3):r===void 0?r=i?s.length>3:s.length>2:i===void 0&&(i=r?s.length>3:s.length>2)),{rings:n,spatialReference:t,hasZ:r,hasM:i}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const e=Pce(this);if(!e||isNaN(e[0])||isNaN(e[1])||this.hasZ&&isNaN(e[2]))return null;const t=new Ae;return t.x=e[0],t.y=e[1],t.spatialReference=this.spatialReference,this.hasZ&&(t.z=e[2]),t}get extent(){const{spatialReference:e}=this,t=TB(this);if(!t)return null;const r=new Ne(t);return r.spatialReference=e,r}get isSelfIntersecting(){return Sce(this.rings)}writeRings(e,t){t.rings=B(this.rings)}addRing(e){if(!e)return;const t=this.rings,r=t.length;if(ED(e)){const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n].toArray();t[r]=i}else t[r]=e.concat();return this.notifyChange("rings"),this}clone(){const e=new N_;return e.spatialReference=this.spatialReference,e.rings=B(this.rings),e.hasZ=this.hasZ,e.hasM=this.hasM,e}equals(e){if(this===e)return!0;if(e==null)return!1;const t=this.spatialReference,r=e.spatialReference;if(t!=null!=(r!=null)||t!=null&&r!=null&&!t.equals(r)||this.rings.length!==e.rings.length)return!1;const i=([n,s,o,a],[u,c,h,d])=>n===u&&s===c&&(o==null&&h==null||o===h)&&(a==null&&d==null||a===d);for(let n=0;n<this.rings.length;n++){const s=this.rings[n],o=e.rings[n];if(!aO(s,o,i))return!1}return!0}contains(e){if(!e)return!1;const t=Yx(e,this.spatialReference);return DG(this,t??e)}isClockwise(e){let t;return t=ED(e)?e.map(r=>this.hasZ?this.hasM?[r.x,r.y,r.z,r.m]:[r.x,r.y,r.z]:[r.x,r.y]):e,BG(t)}getPoint(e,t){if(!this._validateInputs(e,t))return null;const r=this.rings[e][t],i=this.hasZ,n=this.hasM;return i&&!n?new Ae(r[0],r[1],r[2],void 0,this.spatialReference):n&&!i?new Ae(r[0],r[1],void 0,r[2],this.spatialReference):i&&n?new Ae(r[0],r[1],r[2],r[3],this.spatialReference):new Ae(r[0],r[1],this.spatialReference)}insertPoint(e,t,r){return this._validateInputs(e,t,!0)?(bm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e].splice(t,0,r),this.notifyChange("rings"),this):this}removePoint(e,t){if(!this._validateInputs(e,t))return null;const r=new Ae(this.rings[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("rings"),r}removeRing(e){if(!this._validateInputs(e,null))return null;const t=this.rings.splice(e,1)[0],r=this.spatialReference,i=t.map(n=>new Ae(n,r));return this.notifyChange("rings"),i}setPoint(e,t,r){return this._validateInputs(e,t)?(bm(this,r),Array.isArray(r)||(r=r.toArray()),this.rings[e][t]=r,this.notifyChange("rings"),this):this}_validateInputs(e,t,r=!1){if(e==null||e<0||e>=this.rings.length)return!1;if(t!=null){const i=this.rings[e];if(r&&(t<0||t>i.length)||!r&&(t<0||t>=i.length))return!1}return!0}toJSON(e){return this.write({},e)}};l([p({readOnly:!0})],Ja.prototype,"cache",null),l([p({readOnly:!0})],Ja.prototype,"centroid",null),l([p({readOnly:!0})],Ja.prototype,"extent",null),l([p({readOnly:!0})],Ja.prototype,"isSelfIntersecting",null),l([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],Ja.prototype,"rings",void 0),l([se("rings")],Ja.prototype,"writeRings",null),Ja=N_=l([k("esri.geometry.Polygon")],Ja),Ja.prototype.toJSON.isDefaultToJSON=!0;const Ss=Ja;var sE;function Jpe(e){return!Array.isArray(e[0])}let xc=sE=class extends Ju{constructor(...e){super(...e),this.paths=[],this.type="polyline"}normalizeCtorArgs(e,t){var o,a;let r,i,n=null,s=null;return e&&!Array.isArray(e)?(n=e.paths??null,t||(e.spatialReference?t=e.spatialReference:e.paths||(t=e)),r=e.hasZ,i=e.hasM):n=e,n=n||[],t=t||xe.WGS84,n.length&&((o=n[0])==null?void 0:o[0])!=null&&typeof n[0][0]=="number"&&(n=[n]),s=(a=n[0])==null?void 0:a[0],s&&(r===void 0&&i===void 0?(r=s.length>2,i=!1):r===void 0?r=!i&&s.length>3:i===void 0&&(i=!r&&s.length>3)),{paths:n,spatialReference:t,hasZ:r,hasM:i}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:e}=this,t=IB(this);if(!t)return null;const r=new Ne(t);return r.spatialReference=e,r}writePaths(e,t){t.paths=B(this.paths)}addPath(e){if(!e)return;const t=this.paths,r=t.length;if(Jpe(e)){const i=[];for(let n=0,s=e.length;n<s;n++)i[n]=e[n].toArray();t[r]=i}else t[r]=e.concat();return this.notifyChange("paths"),this}clone(){const e=new sE;return e.spatialReference=this.spatialReference,e.paths=B(this.paths),e.hasZ=this.hasZ,e.hasM=this.hasM,e}getPoint(e,t){if(!this._validateInputs(e,t))return null;const r=this.paths[e][t],i=this.hasZ,n=this.hasM;return i&&!n?new Ae(r[0],r[1],r[2],void 0,this.spatialReference):n&&!i?new Ae(r[0],r[1],void 0,r[2],this.spatialReference):i&&n?new Ae(r[0],r[1],r[2],r[3],this.spatialReference):new Ae(r[0],r[1],this.spatialReference)}insertPoint(e,t,r){return this._validateInputs(e,t,!0)?(bm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e].splice(t,0,r),this.notifyChange("paths"),this):this}removePath(e){if(!this._validateInputs(e,null))return null;const t=this.paths.splice(e,1)[0],r=this.spatialReference,i=t.map(n=>new Ae(n,r));return this.notifyChange("paths"),i}removePoint(e,t){if(!this._validateInputs(e,t))return null;const r=new Ae(this.paths[e].splice(t,1)[0],this.spatialReference);return this.notifyChange("paths"),r}setPoint(e,t,r){return this._validateInputs(e,t)?(bm(this,r),Array.isArray(r)||(r=r.toArray()),this.paths[e][t]=r,this.notifyChange("paths"),this):this}_validateInputs(e,t,r=!1){if(e==null||e<0||e>=this.paths.length)return!1;if(t!=null){const i=this.paths[e];if(r&&(t<0||t>i.length)||!r&&(t<0||t>=i.length))return!1}return!0}toJSON(e){return this.write({},e)}};l([p({readOnly:!0})],xc.prototype,"cache",null),l([p({readOnly:!0})],xc.prototype,"extent",null),l([p({type:[[[Number]]],json:{write:{isRequired:!0}}})],xc.prototype,"paths",void 0),l([se("paths")],xc.prototype,"writePaths",null),xc=sE=l([k("esri.geometry.Polyline")],xc),xc.prototype.toJSON.isDefaultToJSON=!0;const Ea=xc,JS=Qr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),AD=Qr()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function MB(e){return e.xmin!==void 0&&e.ymin!==void 0&&e.xmax!==void 0&&e.ymax!==void 0}function BO(e){return e.points!==void 0}function zO(e){return e.x!==void 0&&e.y!==void 0}function qO(e){return e.paths!==void 0}function Bd(e){return e.rings!==void 0}function Xr(e){return e==null?null:e instanceof Ju?e:zO(e)?Ae.fromJSON(e):qO(e)?Ea.fromJSON(e):Bd(e)?Ss.fromJSON(e):BO(e)?jv.fromJSON(e):MB(e)?Ne.fromJSON(e):null}function Rn(e){return e?zO(e)?"esriGeometryPoint":qO(e)?"esriGeometryPolyline":Bd(e)?"esriGeometryPolygon":MB(e)?"esriGeometryEnvelope":BO(e)?"esriGeometryMultipoint":null:null}const Zpe={esriGeometryPoint:Ae,esriGeometryPolyline:Ea,esriGeometryPolygon:Ss,esriGeometryEnvelope:Ne,esriGeometryMultipoint:jv};function Ype(e){return e&&Zpe[e]||null}const Vi={base:Ju,key:"type",typeMap:{extent:Ne,multipoint:jv,point:Ae,polyline:Ea,polygon:Ss}};Tl(Vi);const It=e=>{let t=class extends e{clone(){var u;const r=Mi(this);wp(r,"unable to clone instance of non-accessor class");const i=r.metadata,n=r.store,s={},o=new Map;for(const c in i){const h=i[c],d=n==null?void 0:n.originOf(c),y=h.clonable;if(h.readOnly||y===!1||d!==_e.USER&&d!==_e.DEFAULTS&&d!==_e.WEB_MAP&&d!==_e.WEB_SCENE)continue;const v=this[c];let w=null;w=typeof y=="function"?y(v):y==="reference"?v:Ioe(v),v!=null&&w==null||(d===_e.DEFAULTS?o.set(c,w):s[c]=w)}const a=new(Object.getPrototypeOf(this)).constructor(s);if(o.size){const c=(u=Mi(a))==null?void 0:u.store;if(c)for(const[h,d]of o)c.set(h,d,_e.DEFAULTS)}return a}};return t=l([k("esri.core.Clonable")],t),t};let oE=class extends It(De){};oE=l([k("esri.core.Clonable")],oE);let D_=class $B{constructor(){this._emitter=new $B.EventEmitter(this)}emit(t,r){return this._emitter.emit(t,r)}on(t,r){return this._emitter.on(t,r)}once(t,r){return this._emitter.once(t,r)}hasEventListener(t){return this._emitter.hasEventListener(t)}};(function(e){class t{constructor(n=null){this._target=n,this._listenersMap=null}clear(){var n;(n=this._listenersMap)==null||n.clear(),this._listenersMap=null}destroy(){this.clear()}emit(n,s){var c;let o=(c=this._listenersMap)==null?void 0:c.get(n);if(!o)return!1;const a=this._target||this;let u=!1;for(const h of o.slice()){const d="deref"in h?h.deref():h;d?d==null||d.call(a,s):u=!0}return u&&(o=o.filter(h=>!("deref"in h)||h.deref()!=null),this._listenersMap.set(n,o)),o.length>0}on(n,s){if(Array.isArray(n)){const a=n.map(u=>this.on(u,s));return Lv(a)}if(n.includes(","))throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap??(this._listenersMap=new Map);const o=this._listenersMap.get(n)||[];return o.push(s),this._listenersMap.set(n,o),Xt(()=>{var c;const a=(c=this._listenersMap)==null?void 0:c.get(n),u=(a==null?void 0:a.indexOf(s))??-1;u>=0&&a.splice(u,1)})}once(n,s){const o=this.on(n,a=>{o.remove();const u="deref"in s?s.deref():s;u==null||u.call(null,a)});return o}hasEventListener(n){var o;const s=(o=this._listenersMap)==null?void 0:o.get(n);return s!=null&&s.length>0}}e.EventEmitter=t,e.EventedMixin=i=>{let n=class extends i{constructor(){super(...arguments),this._emitter=new t}destroy(){this._emitter.clear()}emit(s,o){return this._emitter.emit(s,o)}on(s,o){return this._emitter.on(s,o)}once(s,o){return this._emitter.once(s,o)}hasEventListener(s){return this._emitter.hasEventListener(s)}};return n=l([k("esri.core.Evented")],n),n};let r=class extends De{constructor(){super(...arguments),this._emitter=new D_.EventEmitter(this)}destroy(){this._emitter.clear()}emit(i,n){return this._emitter.emit(i,n)}on(i,n){return this._emitter.on(i,n)}once(i,n){return this._emitter.once(i,n)}hasEventListener(i){return this._emitter.hasEventListener(i)}};r=l([k("esri.core.Evented")],r),e.EventedAccessor=r})(D_||(D_={}));const Zu=D_;var kt;(function(e){e[e.ADD=1]="ADD",e[e.REMOVE=2]="REMOVE",e[e.MOVE=4]="MOVE"})(kt||(kt={}));function HO(e){return(t,r)=>{t[r]=e}}let Vv=class extends kV{notify(){const t=this._observers;if(t&&t.length>0){const r=t.slice();for(const i of r)i.onInvalidated(),i.onCommitted()}}};var Au;let Kpe=class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},Xpe=class{constructor(t,r,i,n,s){this.target=t,this.added=r,this.removed=i,this.start=n,this.deleteCount=s}};const go=new Np(Kpe,void 0,e=>{e.item=null,e.target=null,e.defaultPrevented=!1,e.cancellable=!1});function j3(e){return e?e instanceof Tu?e.toArray():e.length?Array.prototype.slice.apply(e):[]:[]}function U3(e){if(e!=null&&e.length)return e[0]}function Qpe(e,t,r,i){const n=Math.min(e.length-r,t.length-i);let s=0;for(;s<n&&e[r+s]===t[i+s];)s++;return s}function EB(e,t,r,i){t&&t.forEach((n,s,o)=>{e.push(n),EB(e,r.call(i,n,s,o),r,i)})}const hc=new Set,dc=new Set,fc=new Set,V3=new Map;let ehe=0,Tu=Au=class extends Zu.EventedAccessor{static isCollection(e){return e!=null&&e instanceof Au}constructor(e){super(e),this._chgListeners=[],this._notifications=null,this._updating=!1,this._timer=null,this._observable=new Vv,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:ehe++})}normalizeCtorArgs(e){return e?Array.isArray(e)||e instanceof Au?{items:e}:e:{}}destroy(){this._removeAllRaw()}*[Symbol.iterator](){yield*this.items}get items(){return Ge(this._observable),this._items}set items(e){this._emitBeforeChanges(kt.ADD)||(this._splice(0,this.length,j3(e)),this._emitAfterChanges(kt.ADD))}hasEventListener(e){return e==="change"?this._chgListeners.length>0:this._emitter.hasEventListener(e)}on(e,t){if(e==="change"){const r=this._chgListeners,i={removed:!1,callback:t};return r.push(i),this._notifications&&this._notifications.push({listeners:r.slice(),items:this._items.slice(),changes:[]}),Xt(()=>{i.removed=!0,r.splice(r.indexOf(i),1)})}return this._emitter.on(e,t)}once(e,t){const r="deref"in t?()=>t.deref():()=>t,i=this.on(e,n=>{var s;(s=r())==null||s.call(null,n),i.remove()});return i}add(e,t){if(Ge(this._observable),this._emitBeforeChanges(kt.ADD))return this;const r=this.getNextIndex(t??null);return this._splice(r,0,[e]),this._emitAfterChanges(kt.ADD),this}addMany(e,t=this._items.length){if(Ge(this._observable),!(e!=null&&e.length))return this;if(this._emitBeforeChanges(kt.ADD))return this;const r=this.getNextIndex(t);return this._splice(r,0,j3(e)),this._emitAfterChanges(kt.ADD),this}at(e){if(Ge(this._observable),(e=Math.trunc(e)||0)<0&&(e+=this.length),!(e<0||e>=this.length))return this._items[e]}removeAll(){if(Ge(this._observable),!this.length||this._emitBeforeChanges(kt.REMOVE))return[];const e=this._removeAllRaw();return this._emitAfterChanges(kt.REMOVE),e}_removeAllRaw(){return this.length===0?[]:this._splice(0,this.length)||[]}clone(){return Ge(this._observable),this._createNewInstance({items:this._items.map(B)})}concat(...e){Ge(this._observable);const t=e.map(j3);return this._createNewInstance({items:this._items.concat(...t)})}drain(e,t){if(Ge(this._observable),!this.length||this._emitBeforeChanges(kt.REMOVE))return;const r=this._splice(0,this.length),i=r.length;for(let n=0;n<i;n++)e.call(t,r[n],n,r);this._emitAfterChanges(kt.REMOVE)}every(e,t){return Ge(this._observable),this._items.every(e,t)}filter(e,t){let r;return Ge(this._observable),r=arguments.length===2?this._items.filter(e,t):this._items.filter(e),this._createNewInstance({items:r})}find(e,t){return Ge(this._observable),this._items.find(e,t)}findIndex(e,t){return Ge(this._observable),this._items.findIndex(e,t)}flatten(e,t){Ge(this._observable);const r=[];return EB(r,this,e,t),new Au(r)}forEach(e,t){return Ge(this._observable),this._items.forEach(e,t)}getItemAt(e){return Ge(this._observable),this._items[e]}getNextIndex(e){Ge(this._observable);const t=this.length;return(e=e??t)<0?e=0:e>t&&(e=t),e}includes(e,t=0){return Ge(this._observable),this._items.includes(e,t)}indexOf(e,t=0){return Ge(this._observable),this._items.indexOf(e,t)}join(e=","){return Ge(this._observable),this._items.join(e)}lastIndexOf(e,t=this.length-1){return Ge(this._observable),this._items.lastIndexOf(e,t)}map(e,t){Ge(this._observable);const r=this._items.map(e,t);return new Au({items:r})}reorder(e,t=this.length-1){Ge(this._observable);const r=this.indexOf(e);if(r!==-1){if(t<0?t=0:t>=this.length&&(t=this.length-1),r!==t){if(this._emitBeforeChanges(kt.MOVE))return e;this._splice(r,1),this._splice(t,0,[e]),this._emitAfterChanges(kt.MOVE)}return e}}pop(){if(Ge(this._observable),!this.length||this._emitBeforeChanges(kt.REMOVE))return;const e=U3(this._splice(this.length-1,1));return this._emitAfterChanges(kt.REMOVE),e}push(...e){return Ge(this._observable),this._emitBeforeChanges(kt.ADD)||(this._splice(this.length,0,e),this._emitAfterChanges(kt.ADD)),this.length}reduce(e,t){Ge(this._observable);const r=this._items;return arguments.length===2?r.reduce(e,t):r.reduce(e)}reduceRight(e,t){Ge(this._observable);const r=this._items;return arguments.length===2?r.reduceRight(e,t):r.reduceRight(e)}remove(e){return Ge(this._observable),this.removeAt(this.indexOf(e))}removeAt(e){if(Ge(this._observable),e<0||e>=this.length||this._emitBeforeChanges(kt.REMOVE))return;const t=U3(this._splice(e,1));return this._emitAfterChanges(kt.REMOVE),t}removeMany(e){if(Ge(this._observable),!(e!=null&&e.length)||this._emitBeforeChanges(kt.REMOVE))return[];const t=e instanceof Au?e.toArray():e,r=this._items,i=[],n=t.length;for(let s=0;s<n;s++){const o=t[s],a=r.indexOf(o);if(a>-1){const u=1+Qpe(t,r,s+1,a+1),c=this._splice(a,u);c&&c.length>0&&i.push.apply(i,c),s+=u-1}}return this._emitAfterChanges(kt.REMOVE),i}reverse(){if(Ge(this._observable),this._emitBeforeChanges(kt.MOVE))return this;const e=this._splice(0,this.length);return e&&(e.reverse(),this._splice(0,0,e)),this._emitAfterChanges(kt.MOVE),this}shift(){if(Ge(this._observable),!this.length||this._emitBeforeChanges(kt.REMOVE))return;const e=U3(this._splice(0,1));return this._emitAfterChanges(kt.REMOVE),e}slice(e=0,t=this.length){return Ge(this._observable),this._createNewInstance({items:this._items.slice(e,t)})}some(e,t){return Ge(this._observable),this._items.some(e,t)}sort(e){if(Ge(this._observable),!this.length||this._emitBeforeChanges(kt.MOVE))return this;const t=this._splice(0,this.length);return arguments.length?t.sort(e):t.sort(),this._splice(0,0,t),this._emitAfterChanges(kt.MOVE),this}splice(e,t,...r){Ge(this._observable);const i=(t?kt.REMOVE:0)|(r.length?kt.ADD:0);if(this._emitBeforeChanges(i))return[];const n=this._splice(e,t,r)||[];return this._emitAfterChanges(i),n}toArray(){return Ge(this._observable),this._items.slice()}toJSON(){return Ge(this._observable),this.toArray()}toLocaleString(){return Ge(this._observable),this._items.toLocaleString()}toString(){return Ge(this._observable),this._items.toString()}unshift(...e){return Ge(this._observable),!e.length||this._emitBeforeChanges(kt.ADD)||(this._splice(0,0,e),this._emitAfterChanges(kt.ADD)),this.length}_createNewInstance(e){return new this.constructor(e)}_splice(e,t,r){const i=this._items,n=this.itemType;let s,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._updating=!0,this._timer=Bm(()=>this._dispatchChange())),e<0&&(e+=this.length),t){if(o=i.splice(e,t),this.hasEventListener("before-remove")){const a=go.acquire();a.target=this,a.cancellable=!0;for(let u=0,c=o.length;u<c;u++)s=o[u],a.reset(s),this.emit("before-remove",a),a.defaultPrevented&&(o.splice(u,1),i.splice(e,0,s),e+=1,u-=1,c-=1);go.release(a)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const a=go.acquire();a.target=this,a.cancellable=!1;const u=o.length;for(let c=0;c<u;c++)a.reset(o[c]),this.emit("after-remove",a);go.release(a)}}if(r!=null&&r.length){if(n){const h=[];for(const d of r){const y=n.ensureType(d);y==null&&d!=null||h.push(y)}r=h}const a=this.hasEventListener("before-add"),u=this.hasEventListener("after-add"),c=e===this.length;if(a||u){const h=go.acquire();h.target=this,h.cancellable=!0;const d=go.acquire();d.target=this,d.cancellable=!1;for(const y of r)a?(h.reset(y),this.emit("before-add",h),h.defaultPrevented||(c?i.push(y):i.splice(e++,0,y),this._set("length",i.length),u&&(d.reset(y),this.emit("after-add",d)))):(c?i.push(y):i.splice(e++,0,y),this._set("length",i.length),d.reset(y),this.emit("after-add",d));go.release(d),go.release(h)}else{if(c)for(const h of r)i.push(h);else i.splice(e,0,...r);this._set("length",i.length)}}if((r!=null&&r.length||o!=null&&o.length)&&this._notifyChangeEvent(r,o),this.hasEventListener("after-splice")){const a=new Xpe(this,r,o,e,t);this.emit("after-splice",a)}return o}_emitBeforeChanges(e){let t=!1;if(this.hasEventListener("before-changes")){const r=go.acquire();r.target=this,r.cancellable=!0,r.type=e,this.emit("before-changes",r),t=r.defaultPrevented,go.release(r)}return t}_emitAfterChanges(e){if(this.hasEventListener("after-changes")){const t=go.acquire();t.target=this,t.cancellable=!1,t.type=e,this.emit("after-changes",t),go.release(t)}this._observable.notify()}_notifyChangeEvent(e,t){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:e,removed:t})}get updating(){return this._updating}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),this._updating=!1,!this._notifications)return;const e=this._notifications;this._notifications=null;for(const t of e){const r=t.changes;hc.clear(),dc.clear(),fc.clear();for(const{added:u,removed:c}of r){if(u)if(fc.size===0&&dc.size===0)for(const h of u)hc.add(h);else for(const h of u)dc.has(h)?(fc.add(h),dc.delete(h)):fc.has(h)||hc.add(h);if(c)if(fc.size===0&&hc.size===0)for(const h of c)dc.add(h);else for(const h of c)hc.has(h)?hc.delete(h):(fc.delete(h),dc.add(h))}const i=Jn.acquire();hc.forEach(u=>{i.push(u)});const n=Jn.acquire();dc.forEach(u=>{n.push(u)});const s=this._items,o=t.items,a=Jn.acquire();if(fc.forEach(u=>{o.indexOf(u)!==s.indexOf(u)&&a.push(u)}),t.listeners&&(i.length||n.length||a.length)){const u={target:this,added:i,removed:n,moved:a},c=t.listeners.length;for(let h=0;h<c;h++){const d=t.listeners[h];d.removed||d.callback.call(this,u)}}Jn.release(i),Jn.release(n),Jn.release(a)}hc.clear(),dc.clear(),fc.clear()}};Tu.ofType=e=>{if(!e)return Au;if(V3.has(e))return V3.get(e);let t=null;if(typeof e=="function")t=e.prototype.declaredClass;else if(e.base)t=e.base.prototype.declaredClass;else for(const i in e.typeMap){const n=e.typeMap[i].prototype.declaredClass;t?t+=` | ${n}`:t=n}let r=class extends Au{};return l([HO({Type:e,ensureType:typeof e=="function"?Lr(e):Tl(e)})],r.prototype,"itemType",void 0),r=l([k(`esri.core.Collection<${t}>`)],r),V3.set(e,r),r},l([p()],Tu.prototype,"_updating",void 0),l([p()],Tu.prototype,"length",void 0),l([p()],Tu.prototype,"items",null),l([p({readOnly:!0})],Tu.prototype,"updating",null),Tu=Au=l([k("esri.core.Collection")],Tu);const $e=Tu;async function AB(e,t){const{WhereClause:r}=await ge(()=>import("./WhereClause-1rTnJQ4s.js").then(i=>i.W),__vite__mapDeps([6,7,1,2]));return r.create(e,t)}function WO(e,t){return e!=null&&e!==""?t!=null&&t!==""?`(${e}) AND (${t})`:e:t}let b1;var eV,tV;const the=((eV=globalThis.esriConfig)==null?void 0:eV.locale)??((tV=globalThis.dojoConfig)==null?void 0:tV.locale);function RB(){var e;return the??((e=globalThis.navigator)==null?void 0:e.language)??"en"}function Zs(){return b1===void 0&&(b1=RB()),b1}function rhe(e=Zs()){const t=/^([a-zA-Z]{2,3})(?:[_\-]\w+)*$/.exec(e);return t==null?void 0:t[1].toLowerCase()}const _1=[];function JO(e){return _1.push(e),Xt(()=>_1.splice(_1.indexOf(e),1))}const aE=[];function ZO(e){return aE.push(e),Xt(()=>_1.splice(aE.indexOf(e),1))}function ihe(){const e=RB();b1!==e&&(b1=e,[...aE].forEach(t=>{t.call(null,e)}),[..._1].forEach(t=>{t.call(null,e)}))}var rV;(rV=globalThis.addEventListener)==null||rV.call(globalThis,"languagechange",ihe);const RD=new Map([["AUS Central Standard Time","Australia/Darwin"],["AUS Eastern Standard Time","Australia/Sydney"],["Afghanistan Standard Time","Asia/Kabul"],["Alaskan Standard Time","America/Anchorage"],["Aleutian Standard Time","America/Adak"],["Altai Standard Time","Asia/Barnaul"],["Arab Standard Time","Asia/Riyadh"],["Arabian Standard Time","Asia/Dubai"],["Arabic Standard Time","Asia/Baghdad"],["Argentina Standard Time","America/Buenos_Aires"],["Astrakhan Standard Time","Europe/Astrakhan"],["Atlantic Standard Time","America/Halifax"],["Aus Central W. Standard Time","Australia/Eucla"],["Azerbaijan Standard Time","Asia/Baku"],["Azores Standard Time","Atlantic/Azores"],["Bahia Standard Time","America/Bahia"],["Bangladesh Standard Time","Asia/Dhaka"],["Belarus Standard Time","Europe/Minsk"],["Bougainville Standard Time","Pacific/Bougainville"],["Canada Central Standard Time","America/Regina"],["Cape Verde Standard Time","Atlantic/Cape_Verde"],["Caucasus Standard Time","Asia/Yerevan"],["Cen. Australia Standard Time","Australia/Adelaide"],["Central America Standard Time","America/Guatemala"],["Central Asia Standard Time","Asia/Almaty"],["Central Brazilian Standard Time","America/Cuiaba"],["Central Europe Standard Time","Europe/Budapest"],["Central European Standard Time","Europe/Warsaw"],["Central Pacific Standard Time","Pacific/Guadalcanal"],["Central Standard Time","America/Chicago"],["Central Standard Time (Mexico)","America/Mexico_City"],["Chatham Islands Standard Time","Pacific/Chatham"],["China Standard Time","Asia/Shanghai"],["Cuba Standard Time","America/Havana"],["Dateline Standard Time","Etc/GMT+12"],["E. Africa Standard Time","Africa/Nairobi"],["E. Australia Standard Time","Australia/Brisbane"],["E. Europe Standard Time","Europe/Chisinau"],["E. South America Standard Time","America/Sao_Paulo"],["Easter Island Standard Time","Pacific/Easter"],["Eastern Standard Time","America/New_York"],["Eastern Standard Time (Mexico)","America/Cancun"],["Egypt Standard Time","Africa/Cairo"],["Ekaterinburg Standard Time","Asia/Yekaterinburg"],["FLE Standard Time","Europe/Kiev"],["Fiji Standard Time","Pacific/Fiji"],["GMT Standard Time","Europe/London"],["GTB Standard Time","Europe/Bucharest"],["Georgian Standard Time","Asia/Tbilisi"],["Greenland Standard Time","America/Godthab"],["Greenwich Standard Time","Atlantic/Reykjavik"],["Haiti Standard Time","America/Port-au-Prince"],["Hawaiian Standard Time","Pacific/Honolulu"],["India Standard Time","Asia/Calcutta"],["Iran Standard Time","Asia/Tehran"],["Israel Standard Time","Asia/Jerusalem"],["Jordan Standard Time","Asia/Amman"],["Kaliningrad Standard Time","Europe/Kaliningrad"],["Korea Standard Time","Asia/Seoul"],["Libya Standard Time","Africa/Tripoli"],["Line Islands Standard Time","Pacific/Kiritimati"],["Lord Howe Standard Time","Australia/Lord_Howe"],["Magadan Standard Time","Asia/Magadan"],["Magallanes Standard Time","America/Punta_Arenas"],["Marquesas Standard Time","Pacific/Marquesas"],["Mauritius Standard Time","Indian/Mauritius"],["Middle East Standard Time","Asia/Beirut"],["Montevideo Standard Time","America/Montevideo"],["Morocco Standard Time","Africa/Casablanca"],["Mountain Standard Time","America/Denver"],["Mountain Standard Time (Mexico)","America/Mazatlan"],["Myanmar Standard Time","Asia/Rangoon"],["N. Central Asia Standard Time","Asia/Novosibirsk"],["Namibia Standard Time","Africa/Windhoek"],["Nepal Standard Time","Asia/Katmandu"],["New Zealand Standard Time","Pacific/Auckland"],["Newfoundland Standard Time","America/St_Johns"],["Norfolk Standard Time","Pacific/Norfolk"],["North Asia East Standard Time","Asia/Irkutsk"],["North Asia Standard Time","Asia/Krasnoyarsk"],["North Korea Standard Time","Asia/Pyongyang"],["Omsk Standard Time","Asia/Omsk"],["Pacific SA Standard Time","America/Santiago"],["Pacific Standard Time","America/Los_Angeles"],["Pacific Standard Time (Mexico)","America/Tijuana"],["Pakistan Standard Time","Asia/Karachi"],["Paraguay Standard Time","America/Asuncion"],["Qyzylorda Standard Time","Asia/Qyzylorda"],["Romance Standard Time","Europe/Paris"],["Russia Time Zone 10","Asia/Srednekolymsk"],["Russia Time Zone 11","Asia/Kamchatka"],["Russia Time Zone 3","Europe/Samara"],["Russian Standard Time","Europe/Moscow"],["SA Eastern Standard Time","America/Cayenne"],["SA Pacific Standard Time","America/Bogota"],["SA Western Standard Time","America/La_Paz"],["SE Asia Standard Time","Asia/Bangkok"],["Saint Pierre Standard Time","America/Miquelon"],["Sakhalin Standard Time","Asia/Sakhalin"],["Samoa Standard Time","Pacific/Apia"],["Sao Tome Standard Time","Africa/Sao_Tome"],["Saratov Standard Time","Europe/Saratov"],["Singapore Standard Time","Asia/Singapore"],["South Africa Standard Time","Africa/Johannesburg"],["South Sudan Standard Time","Africa/Juba"],["Sri Lanka Standard Time","Asia/Colombo"],["Sudan Standard Time","Africa/Khartoum"],["Syria Standard Time","Asia/Damascus"],["Taipei Standard Time","Asia/Taipei"],["Tasmania Standard Time","Australia/Hobart"],["Tocantins Standard Time","America/Araguaina"],["Tokyo Standard Time","Asia/Tokyo"],["Tomsk Standard Time","Asia/Tomsk"],["Tonga Standard Time","Pacific/Tongatapu"],["Transbaikal Standard Time","Asia/Chita"],["Turkey Standard Time","Europe/Istanbul"],["Turks And Caicos Standard Time","America/Grand_Turk"],["US Eastern Standard Time","America/Indianapolis"],["US Mountain Standard Time","America/Phoenix"],["UTC","Etc/GMT"],["UTC+01","Etc/GMT-1"],["UTC+02","Etc/GMT-2"],["UTC+03","Etc/GMT-3"],["UTC+04","Etc/GMT-4"],["UTC+05","Etc/GMT-5"],["UTC+06","Etc/GMT-6"],["UTC+07","Etc/GMT-7"],["UTC+08","Etc/GMT-8"],["UTC+09","Etc/GMT-9"],["UTC+10","Etc/GMT-10"],["UTC+11","Etc/GMT-11"],["UTC+12","Etc/GMT-12"],["UTC+13","Etc/GMT-13"],["UTC+14","Etc/GMT-14"],["UTC-01","Etc/GMT+1"],["UTC-02","Etc/GMT+2"],["UTC-03","Etc/GMT+3"],["UTC-04","Etc/GMT+4"],["UTC-05","Etc/GMT+5"],["UTC-06","Etc/GMT+6"],["UTC-07","Etc/GMT+7"],["UTC-08","Etc/GMT+8"],["UTC-09","Etc/GMT+9"],["UTC-10","Etc/GMT+10"],["UTC-11","Etc/GMT+11"],["UTC-12","Etc/GMT+12"],["Ulaanbaatar Standard Time","Asia/Ulaanbaatar"],["Venezuela Standard Time","America/Caracas"],["Vladivostok Standard Time","Asia/Vladivostok"],["Volgograd Standard Time","Europe/Volgograd"],["W. Australia Standard Time","Australia/Perth"],["W. Central Africa Standard Time","Africa/Lagos"],["W. Europe Standard Time","Europe/Berlin"],["W. Mongolia Standard Time","Asia/Hovd"],["West Asia Standard Time","Asia/Tashkent"],["West Bank Standard Time","Asia/Hebron"],["West Pacific Standard Time","Pacific/Port_Moresby"],["Yakutsk Standard Time","Asia/Yakutsk"],["Yukon Standard Time","America/Whitehorse"]]);class bf extends Error{}class nhe extends bf{constructor(t){super(`Invalid DateTime: ${t.toMessage()}`)}}class she extends bf{constructor(t){super(`Invalid Interval: ${t.toMessage()}`)}}class ohe extends bf{constructor(t){super(`Invalid Duration: ${t.toMessage()}`)}}class Gy extends bf{}class CB extends bf{constructor(t){super(`Invalid unit ${t}`)}}class vs extends bf{}class yc extends bf{constructor(){super("Zone is an abstract class")}}const Ie="numeric",Na="short",Ys="long",ZS={year:Ie,month:Ie,day:Ie},OB={year:Ie,month:Na,day:Ie},ahe={year:Ie,month:Na,day:Ie,weekday:Na},PB={year:Ie,month:Ys,day:Ie},LB={year:Ie,month:Ys,day:Ie,weekday:Ys},kB={hour:Ie,minute:Ie},NB={hour:Ie,minute:Ie,second:Ie},DB={hour:Ie,minute:Ie,second:Ie,timeZoneName:Na},FB={hour:Ie,minute:Ie,second:Ie,timeZoneName:Ys},jB={hour:Ie,minute:Ie,hourCycle:"h23"},UB={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23"},VB={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23",timeZoneName:Na},GB={hour:Ie,minute:Ie,second:Ie,hourCycle:"h23",timeZoneName:Ys},BB={year:Ie,month:Ie,day:Ie,hour:Ie,minute:Ie},zB={year:Ie,month:Ie,day:Ie,hour:Ie,minute:Ie,second:Ie},qB={year:Ie,month:Na,day:Ie,hour:Ie,minute:Ie},HB={year:Ie,month:Na,day:Ie,hour:Ie,minute:Ie,second:Ie},lhe={year:Ie,month:Na,day:Ie,weekday:Na,hour:Ie,minute:Ie},WB={year:Ie,month:Ys,day:Ie,hour:Ie,minute:Ie,timeZoneName:Na},JB={year:Ie,month:Ys,day:Ie,hour:Ie,minute:Ie,second:Ie,timeZoneName:Na},ZB={year:Ie,month:Ys,day:Ie,weekday:Ys,hour:Ie,minute:Ie,timeZoneName:Ys},YB={year:Ie,month:Ys,day:Ie,weekday:Ys,hour:Ie,minute:Ie,second:Ie,timeZoneName:Ys};class qm{get type(){throw new yc}get name(){throw new yc}get ianaName(){return this.name}get isUniversal(){throw new yc}offsetName(t,r){throw new yc}formatOffset(t,r){throw new yc}offset(t){throw new yc}equals(t){throw new yc}get isValid(){throw new yc}}let G3=null;class Qx extends qm{static get instance(){return G3===null&&(G3=new Qx),G3}get type(){return"system"}get name(){return new Intl.DateTimeFormat().resolvedOptions().timeZone}get isUniversal(){return!1}offsetName(t,{format:r,locale:i}){return sz(t,r,i)}formatOffset(t,r){return S1(this.offset(t),r)}offset(t){return-new Date(t).getTimezoneOffset()}equals(t){return t.type==="system"}get isValid(){return!0}}let F_={};function uhe(e){return F_[e]||(F_[e]=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",era:"short"})),F_[e]}const che={year:0,month:1,day:2,era:3,hour:4,minute:5,second:6};function phe(e,t){const r=e.format(t).replace(/\u200E/g,""),i=/(\d+)\/(\d+)\/(\d+) (AD|BC),? (\d+):(\d+):(\d+)/.exec(r),[,n,s,o,a,u,c,h]=i;return[o,n,s,a,u,c,h]}function hhe(e,t){const r=e.formatToParts(t),i=[];for(let n=0;n<r.length;n++){const{type:s,value:o}=r[n],a=che[s];s==="era"?i[a]=o:lt(a)||(i[a]=parseInt(o,10))}return i}let xb={};class no extends qm{static create(t){return xb[t]||(xb[t]=new no(t)),xb[t]}static resetCache(){xb={},F_={}}static isValidSpecifier(t){return this.isValidZone(t)}static isValidZone(t){if(!t)return!1;try{return new Intl.DateTimeFormat("en-US",{timeZone:t}).format(),!0}catch{return!1}}constructor(t){super(),this.zoneName=t,this.valid=no.isValidZone(t)}get type(){return"iana"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(t,{format:r,locale:i}){return sz(t,r,i,this.name)}formatOffset(t,r){return S1(this.offset(t),r)}offset(t){const r=new Date(t);if(isNaN(r))return NaN;const i=uhe(this.name);let[n,s,o,a,u,c,h]=i.formatToParts?hhe(i,r):phe(i,r);a==="BC"&&(n=-Math.abs(n)+1);const y=tT({year:n,month:s,day:o,hour:u===24?0:u,minute:c,second:h,millisecond:0});let v=+r;const w=v%1e3;return v-=w>=0?w:1e3+w,(y-v)/(60*1e3)}equals(t){return t.type==="iana"&&t.name===this.name}get isValid(){return this.valid}}let CD={};function dhe(e,t={}){const r=JSON.stringify([e,t]);let i=CD[r];return i||(i=new Intl.ListFormat(e,t),CD[r]=i),i}let lE={};function uE(e,t={}){const r=JSON.stringify([e,t]);let i=lE[r];return i||(i=new Intl.DateTimeFormat(e,t),lE[r]=i),i}let cE={};function fhe(e,t={}){const r=JSON.stringify([e,t]);let i=cE[r];return i||(i=new Intl.NumberFormat(e,t),cE[r]=i),i}let pE={};function yhe(e,t={}){const{base:r,...i}=t,n=JSON.stringify([e,i]);let s=pE[n];return s||(s=new Intl.RelativeTimeFormat(e,t),pE[n]=s),s}let hg=null;function mhe(){return hg||(hg=new Intl.DateTimeFormat().resolvedOptions().locale,hg)}let OD={};function ghe(e){let t=OD[e];if(!t){const r=new Intl.Locale(e);t="getWeekInfo"in r?r.getWeekInfo():r.weekInfo,OD[e]=t}return t}function vhe(e){const t=e.indexOf("-x-");t!==-1&&(e=e.substring(0,t));const r=e.indexOf("-u-");if(r===-1)return[e];{let i,n;try{i=uE(e).resolvedOptions(),n=e}catch{const u=e.substring(0,r);i=uE(u).resolvedOptions(),n=u}const{numberingSystem:s,calendar:o}=i;return[n,s,o]}}function whe(e,t,r){return(r||t)&&(e.includes("-u-")||(e+="-u"),r&&(e+=`-ca-${r}`),t&&(e+=`-nu-${t}`)),e}function bhe(e){const t=[];for(let r=1;r<=12;r++){const i=et.utc(2009,r,1);t.push(e(i))}return t}function _he(e){const t=[];for(let r=1;r<=7;r++){const i=et.utc(2016,11,13+r);t.push(e(i))}return t}function Tb(e,t,r,i){const n=e.listingMode();return n==="error"?null:n==="en"?r(t):i(t)}function She(e){return e.numberingSystem&&e.numberingSystem!=="latn"?!1:e.numberingSystem==="latn"||!e.locale||e.locale.startsWith("en")||new Intl.DateTimeFormat(e.intl).resolvedOptions().numberingSystem==="latn"}class xhe{constructor(t,r,i){this.padTo=i.padTo||0,this.floor=i.floor||!1;const{padTo:n,floor:s,...o}=i;if(!r||Object.keys(o).length>0){const a={useGrouping:!1,...i};i.padTo>0&&(a.minimumIntegerDigits=i.padTo),this.inf=fhe(t,a)}}format(t){if(this.inf){const r=this.floor?Math.floor(t):t;return this.inf.format(r)}else{const r=this.floor?Math.floor(t):QO(t,3);return hi(r,this.padTo)}}}class The{constructor(t,r,i){this.opts=i,this.originalZone=void 0;let n;if(this.opts.timeZone)this.dt=t;else if(t.zone.type==="fixed"){const o=-1*(t.offset/60),a=o>=0?`Etc/GMT+${o}`:`Etc/GMT${o}`;t.offset!==0&&no.create(a).valid?(n=a,this.dt=t):(n="UTC",this.dt=t.offset===0?t:t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone)}else t.zone.type==="system"?this.dt=t:t.zone.type==="iana"?(this.dt=t,n=t.zone.name):(n="UTC",this.dt=t.setZone("UTC").plus({minutes:t.offset}),this.originalZone=t.zone);const s={...this.opts};s.timeZone=s.timeZone||n,this.dtf=uE(r,s)}format(){return this.originalZone?this.formatToParts().map(({value:t})=>t).join(""):this.dtf.format(this.dt.toJSDate())}formatToParts(){const t=this.dtf.formatToParts(this.dt.toJSDate());return this.originalZone?t.map(r=>{if(r.type==="timeZoneName"){const i=this.originalZone.offsetName(this.dt.ts,{locale:this.dt.locale,format:this.opts.timeZoneName});return{...r,value:i}}else return r}):t}resolvedOptions(){return this.dtf.resolvedOptions()}}class Ihe{constructor(t,r,i){this.opts={style:"long",...i},!r&&iz()&&(this.rtf=yhe(t,i))}format(t,r){return this.rtf?this.rtf.format(t,r):qhe(r,t,this.opts.numeric,this.opts.style!=="long")}formatToParts(t,r){return this.rtf?this.rtf.formatToParts(t,r):[]}}const Mhe={firstDay:1,minimalDays:4,weekend:[6,7]};class Yt{static fromOpts(t){return Yt.create(t.locale,t.numberingSystem,t.outputCalendar,t.weekSettings,t.defaultToEN)}static create(t,r,i,n,s=!1){const o=t||Kr.defaultLocale,a=o||(s?"en-US":mhe()),u=r||Kr.defaultNumberingSystem,c=i||Kr.defaultOutputCalendar,h=hE(n)||Kr.defaultWeekSettings;return new Yt(a,u,c,h,o)}static resetCache(){hg=null,lE={},cE={},pE={}}static fromObject({locale:t,numberingSystem:r,outputCalendar:i,weekSettings:n}={}){return Yt.create(t,r,i,n)}constructor(t,r,i,n,s){const[o,a,u]=vhe(t);this.locale=o,this.numberingSystem=r||a||null,this.outputCalendar=i||u||null,this.weekSettings=n,this.intl=whe(this.locale,this.numberingSystem,this.outputCalendar),this.weekdaysCache={format:{},standalone:{}},this.monthsCache={format:{},standalone:{}},this.meridiemCache=null,this.eraCache={},this.specifiedLocale=s,this.fastNumbersCached=null}get fastNumbers(){return this.fastNumbersCached==null&&(this.fastNumbersCached=She(this)),this.fastNumbersCached}listingMode(){const t=this.isEnglish(),r=(this.numberingSystem===null||this.numberingSystem==="latn")&&(this.outputCalendar===null||this.outputCalendar==="gregory");return t&&r?"en":"intl"}clone(t){return!t||Object.getOwnPropertyNames(t).length===0?this:Yt.create(t.locale||this.specifiedLocale,t.numberingSystem||this.numberingSystem,t.outputCalendar||this.outputCalendar,hE(t.weekSettings)||this.weekSettings,t.defaultToEN||!1)}redefaultToEN(t={}){return this.clone({...t,defaultToEN:!0})}redefaultToSystem(t={}){return this.clone({...t,defaultToEN:!1})}months(t,r=!1){return Tb(this,t,lz,()=>{const i=r?{month:t,day:"numeric"}:{month:t},n=r?"format":"standalone";return this.monthsCache[n][t]||(this.monthsCache[n][t]=bhe(s=>this.extract(s,i,"month"))),this.monthsCache[n][t]})}weekdays(t,r=!1){return Tb(this,t,pz,()=>{const i=r?{weekday:t,year:"numeric",month:"long",day:"numeric"}:{weekday:t},n=r?"format":"standalone";return this.weekdaysCache[n][t]||(this.weekdaysCache[n][t]=_he(s=>this.extract(s,i,"weekday"))),this.weekdaysCache[n][t]})}meridiems(){return Tb(this,void 0,()=>hz,()=>{if(!this.meridiemCache){const t={hour:"numeric",hourCycle:"h12"};this.meridiemCache=[et.utc(2016,11,13,9),et.utc(2016,11,13,19)].map(r=>this.extract(r,t,"dayperiod"))}return this.meridiemCache})}eras(t){return Tb(this,t,dz,()=>{const r={era:t};return this.eraCache[t]||(this.eraCache[t]=[et.utc(-40,1,1),et.utc(2017,1,1)].map(i=>this.extract(i,r,"era"))),this.eraCache[t]})}extract(t,r,i){const n=this.dtFormatter(t,r),s=n.formatToParts(),o=s.find(a=>a.type.toLowerCase()===i);return o?o.value:null}numberFormatter(t={}){return new xhe(this.intl,t.forceSimple||this.fastNumbers,t)}dtFormatter(t,r={}){return new The(t,this.intl,r)}relFormatter(t={}){return new Ihe(this.intl,this.isEnglish(),t)}listFormatter(t={}){return dhe(this.intl,t)}isEnglish(){return this.locale==="en"||this.locale.toLowerCase()==="en-us"||new Intl.DateTimeFormat(this.intl).resolvedOptions().locale.startsWith("en-us")}getWeekSettings(){return this.weekSettings?this.weekSettings:nz()?ghe(this.locale):Mhe}getStartOfWeek(){return this.getWeekSettings().firstDay}getMinDaysInFirstWeek(){return this.getWeekSettings().minimalDays}getWeekendDays(){return this.getWeekSettings().weekend}equals(t){return this.locale===t.locale&&this.numberingSystem===t.numberingSystem&&this.outputCalendar===t.outputCalendar}}let B3=null;class Yi extends qm{static get utcInstance(){return B3===null&&(B3=new Yi(0)),B3}static instance(t){return t===0?Yi.utcInstance:new Yi(t)}static parseSpecifier(t){if(t){const r=t.match(/^utc(?:([+-]\d{1,2})(?::(\d{2}))?)?$/i);if(r)return new Yi(rT(r[1],r[2]))}return null}constructor(t){super(),this.fixed=t}get type(){return"fixed"}get name(){return this.fixed===0?"UTC":`UTC${S1(this.fixed,"narrow")}`}get ianaName(){return this.fixed===0?"Etc/UTC":`Etc/GMT${S1(-this.fixed,"narrow")}`}offsetName(){return this.name}formatOffset(t,r){return S1(this.fixed,r)}get isUniversal(){return!0}offset(){return this.fixed}equals(t){return t.type==="fixed"&&t.fixed===this.fixed}get isValid(){return!0}}class $he extends qm{constructor(t){super(),this.zoneName=t}get type(){return"invalid"}get name(){return this.zoneName}get isUniversal(){return!1}offsetName(){return null}formatOffset(){return""}offset(){return NaN}equals(){return!1}get isValid(){return!1}}function up(e,t){if(lt(e)||e===null)return t;if(e instanceof qm)return e;if(Rhe(e)){const r=e.toLowerCase();return r==="default"?t:r==="local"||r==="system"?Qx.instance:r==="utc"||r==="gmt"?Yi.utcInstance:Yi.parseSpecifier(r)||no.create(e)}else return zd(e)?Yi.instance(e):typeof e=="object"&&"offset"in e&&typeof e.offset=="function"?e:new $he(e)}let PD=()=>Date.now(),LD="system",kD=null,ND=null,DD=null,FD=60,jD,UD=null;class Kr{static get now(){return PD}static set now(t){PD=t}static set defaultZone(t){LD=t}static get defaultZone(){return up(LD,Qx.instance)}static get defaultLocale(){return kD}static set defaultLocale(t){kD=t}static get defaultNumberingSystem(){return ND}static set defaultNumberingSystem(t){ND=t}static get defaultOutputCalendar(){return DD}static set defaultOutputCalendar(t){DD=t}static get defaultWeekSettings(){return UD}static set defaultWeekSettings(t){UD=hE(t)}static get twoDigitCutoffYear(){return FD}static set twoDigitCutoffYear(t){FD=t%100}static get throwOnInvalid(){return jD}static set throwOnInvalid(t){jD=t}static resetCaches(){Yt.resetCache(),no.resetCache()}}class Aa{constructor(t,r){this.reason=t,this.explanation=r}toMessage(){return this.explanation?`${this.reason}: ${this.explanation}`:this.reason}}const KB=[0,31,59,90,120,151,181,212,243,273,304,334],XB=[0,31,60,91,121,152,182,213,244,274,305,335];function Lo(e,t){return new Aa("unit out of range",`you specified ${t} (of type ${typeof t}) as a ${e}, which is invalid`)}function YO(e,t,r){const i=new Date(Date.UTC(e,t-1,r));e<100&&e>=0&&i.setUTCFullYear(i.getUTCFullYear()-1900);const n=i.getUTCDay();return n===0?7:n}function QB(e,t,r){return r+(Gv(e)?XB:KB)[t-1]}function ez(e,t){const r=Gv(e)?XB:KB,i=r.findIndex(s=>s<t),n=t-r[i];return{month:i+1,day:n}}function KO(e,t){return(e-t+7)%7+1}function YS(e,t=4,r=1){const{year:i,month:n,day:s}=e,o=QB(i,n,s),a=KO(YO(i,n,s),r);let u=Math.floor((o-a+14-t)/7),c;return u<1?(c=i-1,u=av(c,t,r)):u>av(i,t,r)?(c=i+1,u=1):c=i,{weekYear:c,weekNumber:u,weekday:a,...iT(e)}}function VD(e,t=4,r=1){const{weekYear:i,weekNumber:n,weekday:s}=e,o=KO(YO(i,1,t),r),a=Xy(i);let u=n*7+s-o-7+t,c;u<1?(c=i-1,u+=Xy(c)):u>a?(c=i+1,u-=Xy(i)):c=i;const{month:h,day:d}=ez(c,u);return{year:c,month:h,day:d,...iT(e)}}function z3(e){const{year:t,month:r,day:i}=e,n=QB(t,r,i);return{year:t,ordinal:n,...iT(e)}}function GD(e){const{year:t,ordinal:r}=e,{month:i,day:n}=ez(t,r);return{year:t,month:i,day:n,...iT(e)}}function BD(e,t){if(!lt(e.localWeekday)||!lt(e.localWeekNumber)||!lt(e.localWeekYear)){if(!lt(e.weekday)||!lt(e.weekNumber)||!lt(e.weekYear))throw new Gy("Cannot mix locale-based week fields with ISO-based week fields");return lt(e.localWeekday)||(e.weekday=e.localWeekday),lt(e.localWeekNumber)||(e.weekNumber=e.localWeekNumber),lt(e.localWeekYear)||(e.weekYear=e.localWeekYear),delete e.localWeekday,delete e.localWeekNumber,delete e.localWeekYear,{minDaysInFirstWeek:t.getMinDaysInFirstWeek(),startOfWeek:t.getStartOfWeek()}}else return{minDaysInFirstWeek:4,startOfWeek:1}}function Ehe(e,t=4,r=1){const i=eT(e.weekYear),n=ko(e.weekNumber,1,av(e.weekYear,t,r)),s=ko(e.weekday,1,7);return i?n?s?!1:Lo("weekday",e.weekday):Lo("week",e.weekNumber):Lo("weekYear",e.weekYear)}function Ahe(e){const t=eT(e.year),r=ko(e.ordinal,1,Xy(e.year));return t?r?!1:Lo("ordinal",e.ordinal):Lo("year",e.year)}function tz(e){const t=eT(e.year),r=ko(e.month,1,12),i=ko(e.day,1,KS(e.year,e.month));return t?r?i?!1:Lo("day",e.day):Lo("month",e.month):Lo("year",e.year)}function rz(e){const{hour:t,minute:r,second:i,millisecond:n}=e,s=ko(t,0,23)||t===24&&r===0&&i===0&&n===0,o=ko(r,0,59),a=ko(i,0,59),u=ko(n,0,999);return s?o?a?u?!1:Lo("millisecond",n):Lo("second",i):Lo("minute",r):Lo("hour",t)}function lt(e){return typeof e>"u"}function zd(e){return typeof e=="number"}function eT(e){return typeof e=="number"&&e%1===0}function Rhe(e){return typeof e=="string"}function Che(e){return Object.prototype.toString.call(e)==="[object Date]"}function iz(){try{return typeof Intl<"u"&&!!Intl.RelativeTimeFormat}catch{return!1}}function nz(){try{return typeof Intl<"u"&&!!Intl.Locale&&("weekInfo"in Intl.Locale.prototype||"getWeekInfo"in Intl.Locale.prototype)}catch{return!1}}function Ohe(e){return Array.isArray(e)?e:[e]}function zD(e,t,r){if(e.length!==0)return e.reduce((i,n)=>{const s=[t(n),n];return i&&r(i[0],s[0])===i[0]?i:s},null)[1]}function Phe(e,t){return t.reduce((r,i)=>(r[i]=e[i],r),{})}function Sm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function hE(e){if(e==null)return null;if(typeof e!="object")throw new vs("Week settings must be an object");if(!ko(e.firstDay,1,7)||!ko(e.minimalDays,1,7)||!Array.isArray(e.weekend)||e.weekend.some(t=>!ko(t,1,7)))throw new vs("Invalid week settings");return{firstDay:e.firstDay,minimalDays:e.minimalDays,weekend:Array.from(e.weekend)}}function ko(e,t,r){return eT(e)&&e>=t&&e<=r}function Lhe(e,t){return e-t*Math.floor(e/t)}function hi(e,t=2){const r=e<0;let i;return r?i="-"+(""+-e).padStart(t,"0"):i=(""+e).padStart(t,"0"),i}function tp(e){if(!(lt(e)||e===null||e===""))return parseInt(e,10)}function hh(e){if(!(lt(e)||e===null||e===""))return parseFloat(e)}function XO(e){if(!(lt(e)||e===null||e==="")){const t=parseFloat("0."+e)*1e3;return Math.floor(t)}}function QO(e,t,r=!1){const i=10**t;return(r?Math.trunc:Math.round)(e*i)/i}function Gv(e){return e%4===0&&(e%100!==0||e%400===0)}function Xy(e){return Gv(e)?366:365}function KS(e,t){const r=Lhe(t-1,12)+1,i=e+(t-r)/12;return r===2?Gv(i)?29:28:[31,null,31,30,31,30,31,31,30,31,30,31][r-1]}function tT(e){let t=Date.UTC(e.year,e.month-1,e.day,e.hour,e.minute,e.second,e.millisecond);return e.year<100&&e.year>=0&&(t=new Date(t),t.setUTCFullYear(e.year,e.month-1,e.day)),+t}function qD(e,t,r){return-KO(YO(e,1,t),r)+t-1}function av(e,t=4,r=1){const i=qD(e,t,r),n=qD(e+1,t,r);return(Xy(e)-i+n)/7}function dE(e){return e>99?e:e>Kr.twoDigitCutoffYear?1900+e:2e3+e}function sz(e,t,r,i=null){const n=new Date(e),s={hourCycle:"h23",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"};i&&(s.timeZone=i);const o={timeZoneName:t,...s},a=new Intl.DateTimeFormat(r,o).formatToParts(n).find(u=>u.type.toLowerCase()==="timezonename");return a?a.value:null}function rT(e,t){let r=parseInt(e,10);Number.isNaN(r)&&(r=0);const i=parseInt(t,10)||0,n=r<0||Object.is(r,-0)?-i:i;return r*60+n}function oz(e){const t=Number(e);if(typeof e=="boolean"||e===""||Number.isNaN(t))throw new vs(`Invalid unit value ${e}`);return t}function XS(e,t){const r={};for(const i in e)if(Sm(e,i)){const n=e[i];if(n==null)continue;r[t(i)]=oz(n)}return r}function S1(e,t){const r=Math.trunc(Math.abs(e/60)),i=Math.trunc(Math.abs(e%60)),n=e>=0?"+":"-";switch(t){case"short":return`${n}${hi(r,2)}:${hi(i,2)}`;case"narrow":return`${n}${r}${i>0?`:${i}`:""}`;case"techie":return`${n}${hi(r,2)}${hi(i,2)}`;default:throw new RangeError(`Value format ${t} is out of range for property format`)}}function iT(e){return Phe(e,["hour","minute","second","millisecond"])}const khe=["January","February","March","April","May","June","July","August","September","October","November","December"],az=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Nhe=["J","F","M","A","M","J","J","A","S","O","N","D"];function lz(e){switch(e){case"narrow":return[...Nhe];case"short":return[...az];case"long":return[...khe];case"numeric":return["1","2","3","4","5","6","7","8","9","10","11","12"];case"2-digit":return["01","02","03","04","05","06","07","08","09","10","11","12"];default:return null}}const uz=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],cz=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Dhe=["M","T","W","T","F","S","S"];function pz(e){switch(e){case"narrow":return[...Dhe];case"short":return[...cz];case"long":return[...uz];case"numeric":return["1","2","3","4","5","6","7"];default:return null}}const hz=["AM","PM"],Fhe=["Before Christ","Anno Domini"],jhe=["BC","AD"],Uhe=["B","A"];function dz(e){switch(e){case"narrow":return[...Uhe];case"short":return[...jhe];case"long":return[...Fhe];default:return null}}function Vhe(e){return hz[e.hour<12?0:1]}function Ghe(e,t){return pz(t)[e.weekday-1]}function Bhe(e,t){return lz(t)[e.month-1]}function zhe(e,t){return dz(t)[e.year<0?0:1]}function qhe(e,t,r="always",i=!1){const n={years:["year","yr."],quarters:["quarter","qtr."],months:["month","mo."],weeks:["week","wk."],days:["day","day","days"],hours:["hour","hr."],minutes:["minute","min."],seconds:["second","sec."]},s=["hours","minutes","seconds"].indexOf(e)===-1;if(r==="auto"&&s){const d=e==="days";switch(t){case 1:return d?"tomorrow":`next ${n[e][0]}`;case-1:return d?"yesterday":`last ${n[e][0]}`;case 0:return d?"today":`this ${n[e][0]}`}}const o=Object.is(t,-0)||t<0,a=Math.abs(t),u=a===1,c=n[e],h=i?u?c[1]:c[2]||c[1]:u?n[e][0]:e;return o?`${a} ${h} ago`:`in ${a} ${h}`}function HD(e,t){let r="";for(const i of e)i.literal?r+=i.val:r+=t(i.val);return r}const Hhe={D:ZS,DD:OB,DDD:PB,DDDD:LB,t:kB,tt:NB,ttt:DB,tttt:FB,T:jB,TT:UB,TTT:VB,TTTT:GB,f:BB,ff:qB,fff:WB,ffff:ZB,F:zB,FF:HB,FFF:JB,FFFF:YB};class In{static create(t,r={}){return new In(t,r)}static parseFormat(t){let r=null,i="",n=!1;const s=[];for(let o=0;o<t.length;o++){const a=t.charAt(o);a==="'"?(i.length>0&&s.push({literal:n||/^\s+$/.test(i),val:i}),r=null,i="",n=!n):n||a===r?i+=a:(i.length>0&&s.push({literal:/^\s+$/.test(i),val:i}),i=a,r=a)}return i.length>0&&s.push({literal:n||/^\s+$/.test(i),val:i}),s}static macroTokenToFormatOpts(t){return Hhe[t]}constructor(t,r){this.opts=r,this.loc=t,this.systemLoc=null}formatWithSystemDefault(t,r){return this.systemLoc===null&&(this.systemLoc=this.loc.redefaultToSystem()),this.systemLoc.dtFormatter(t,{...this.opts,...r}).format()}dtFormatter(t,r={}){return this.loc.dtFormatter(t,{...this.opts,...r})}formatDateTime(t,r){return this.dtFormatter(t,r).format()}formatDateTimeParts(t,r){return this.dtFormatter(t,r).formatToParts()}formatInterval(t,r){return this.dtFormatter(t.start,r).dtf.formatRange(t.start.toJSDate(),t.end.toJSDate())}resolvedOptions(t,r){return this.dtFormatter(t,r).resolvedOptions()}num(t,r=0){if(this.opts.forceSimple)return hi(t,r);const i={...this.opts};return r>0&&(i.padTo=r),this.loc.numberFormatter(i).format(t)}formatDateTimeFromString(t,r){const i=this.loc.listingMode()==="en",n=this.loc.outputCalendar&&this.loc.outputCalendar!=="gregory",s=(v,w)=>this.loc.extract(t,v,w),o=v=>t.isOffsetFixed&&t.offset===0&&v.allowZ?"Z":t.isValid?t.zone.formatOffset(t.ts,v.format):"",a=()=>i?Vhe(t):s({hour:"numeric",hourCycle:"h12"},"dayperiod"),u=(v,w)=>i?Bhe(t,v):s(w?{month:v}:{month:v,day:"numeric"},"month"),c=(v,w)=>i?Ghe(t,v):s(w?{weekday:v}:{weekday:v,month:"long",day:"numeric"},"weekday"),h=v=>{const w=In.macroTokenToFormatOpts(v);return w?this.formatWithSystemDefault(t,w):v},d=v=>i?zhe(t,v):s({era:v},"era"),y=v=>{switch(v){case"S":return this.num(t.millisecond);case"u":case"SSS":return this.num(t.millisecond,3);case"s":return this.num(t.second);case"ss":return this.num(t.second,2);case"uu":return this.num(Math.floor(t.millisecond/10),2);case"uuu":return this.num(Math.floor(t.millisecond/100));case"m":return this.num(t.minute);case"mm":return this.num(t.minute,2);case"h":return this.num(t.hour%12===0?12:t.hour%12);case"hh":return this.num(t.hour%12===0?12:t.hour%12,2);case"H":return this.num(t.hour);case"HH":return this.num(t.hour,2);case"Z":return o({format:"narrow",allowZ:this.opts.allowZ});case"ZZ":return o({format:"short",allowZ:this.opts.allowZ});case"ZZZ":return o({format:"techie",allowZ:this.opts.allowZ});case"ZZZZ":return t.zone.offsetName(t.ts,{format:"short",locale:this.loc.locale});case"ZZZZZ":return t.zone.offsetName(t.ts,{format:"long",locale:this.loc.locale});case"z":return t.zoneName;case"a":return a();case"d":return n?s({day:"numeric"},"day"):this.num(t.day);case"dd":return n?s({day:"2-digit"},"day"):this.num(t.day,2);case"c":return this.num(t.weekday);case"ccc":return c("short",!0);case"cccc":return c("long",!0);case"ccccc":return c("narrow",!0);case"E":return this.num(t.weekday);case"EEE":return c("short",!1);case"EEEE":return c("long",!1);case"EEEEE":return c("narrow",!1);case"L":return n?s({month:"numeric",day:"numeric"},"month"):this.num(t.month);case"LL":return n?s({month:"2-digit",day:"numeric"},"month"):this.num(t.month,2);case"LLL":return u("short",!0);case"LLLL":return u("long",!0);case"LLLLL":return u("narrow",!0);case"M":return n?s({month:"numeric"},"month"):this.num(t.month);case"MM":return n?s({month:"2-digit"},"month"):this.num(t.month,2);case"MMM":return u("short",!1);case"MMMM":return u("long",!1);case"MMMMM":return u("narrow",!1);case"y":return n?s({year:"numeric"},"year"):this.num(t.year);case"yy":return n?s({year:"2-digit"},"year"):this.num(t.year.toString().slice(-2),2);case"yyyy":return n?s({year:"numeric"},"year"):this.num(t.year,4);case"yyyyyy":return n?s({year:"numeric"},"year"):this.num(t.year,6);case"G":return d("short");case"GG":return d("long");case"GGGGG":return d("narrow");case"kk":return this.num(t.weekYear.toString().slice(-2),2);case"kkkk":return this.num(t.weekYear,4);case"W":return this.num(t.weekNumber);case"WW":return this.num(t.weekNumber,2);case"n":return this.num(t.localWeekNumber);case"nn":return this.num(t.localWeekNumber,2);case"ii":return this.num(t.localWeekYear.toString().slice(-2),2);case"iiii":return this.num(t.localWeekYear,4);case"o":return this.num(t.ordinal);case"ooo":return this.num(t.ordinal,3);case"q":return this.num(t.quarter);case"qq":return this.num(t.quarter,2);case"X":return this.num(Math.floor(t.ts/1e3));case"x":return this.num(t.ts);default:return h(v)}};return HD(In.parseFormat(r),y)}formatDurationFromString(t,r){const i=u=>{switch(u[0]){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":return"hour";case"d":return"day";case"w":return"week";case"M":return"month";case"y":return"year";default:return null}},n=u=>c=>{const h=i(c);return h?this.num(u.get(h),c.length):c},s=In.parseFormat(r),o=s.reduce((u,{literal:c,val:h})=>c?u:u.concat(h),[]),a=t.shiftTo(...o.map(i).filter(u=>u));return HD(s,n(a))}}const fz=/[A-Za-z_+-]{1,256}(?::?\/[A-Za-z0-9_+-]{1,256}(?:\/[A-Za-z0-9_+-]{1,256})?)?/;function Hm(...e){const t=e.reduce((r,i)=>r+i.source,"");return RegExp(`^${t}$`)}function Wm(...e){return t=>e.reduce(([r,i,n],s)=>{const[o,a,u]=s(t,n);return[{...r,...o},a||i,u]},[{},null,1]).slice(0,2)}function Jm(e,...t){if(e==null)return[null,null];for(const[r,i]of t){const n=r.exec(e);if(n)return i(n)}return[null,null]}function yz(...e){return(t,r)=>{const i={};let n;for(n=0;n<e.length;n++)i[e[n]]=tp(t[r+n]);return[i,null,r+n]}}const mz=/(?:(Z)|([+-]\d\d)(?::?(\d\d))?)/,Whe=`(?:${mz.source}?(?:\\[(${fz.source})\\])?)?`,e4=/(\d\d)(?::?(\d\d)(?::?(\d\d)(?:[.,](\d{1,30}))?)?)?/,gz=RegExp(`${e4.source}${Whe}`),t4=RegExp(`(?:T${gz.source})?`),Jhe=/([+-]\d{6}|\d{4})(?:-?(\d\d)(?:-?(\d\d))?)?/,Zhe=/(\d{4})-?W(\d\d)(?:-?(\d))?/,Yhe=/(\d{4})-?(\d{3})/,Khe=yz("weekYear","weekNumber","weekDay"),Xhe=yz("year","ordinal"),Qhe=/(\d{4})-(\d\d)-(\d\d)/,vz=RegExp(`${e4.source} ?(?:${mz.source}|(${fz.source}))?`),ede=RegExp(`(?: ${vz.source})?`);function Qy(e,t,r){const i=e[t];return lt(i)?r:tp(i)}function tde(e,t){return[{year:Qy(e,t),month:Qy(e,t+1,1),day:Qy(e,t+2,1)},null,t+3]}function Zm(e,t){return[{hours:Qy(e,t,0),minutes:Qy(e,t+1,0),seconds:Qy(e,t+2,0),milliseconds:XO(e[t+3])},null,t+4]}function Bv(e,t){const r=!e[t]&&!e[t+1],i=rT(e[t+1],e[t+2]),n=r?null:Yi.instance(i);return[{},n,t+3]}function zv(e,t){const r=e[t]?no.create(e[t]):null;return[{},r,t+1]}const rde=RegExp(`^T?${e4.source}$`),ide=/^-?P(?:(?:(-?\d{1,20}(?:\.\d{1,20})?)Y)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20}(?:\.\d{1,20})?)W)?(?:(-?\d{1,20}(?:\.\d{1,20})?)D)?(?:T(?:(-?\d{1,20}(?:\.\d{1,20})?)H)?(?:(-?\d{1,20}(?:\.\d{1,20})?)M)?(?:(-?\d{1,20})(?:[.,](-?\d{1,20}))?S)?)?)$/;function nde(e){const[t,r,i,n,s,o,a,u,c]=e,h=t[0]==="-",d=u&&u[0]==="-",y=(v,w=!1)=>v!==void 0&&(w||v&&h)?-v:v;return[{years:y(hh(r)),months:y(hh(i)),weeks:y(hh(n)),days:y(hh(s)),hours:y(hh(o)),minutes:y(hh(a)),seconds:y(hh(u),u==="-0"),milliseconds:y(XO(c),d)}]}const sde={GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function r4(e,t,r,i,n,s,o){const a={year:t.length===2?dE(tp(t)):tp(t),month:az.indexOf(r)+1,day:tp(i),hour:tp(n),minute:tp(s)};return o&&(a.second=tp(o)),e&&(a.weekday=e.length>3?uz.indexOf(e)+1:cz.indexOf(e)+1),a}const ode=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|(?:([+-]\d\d)(\d\d)))$/;function ade(e){const[,t,r,i,n,s,o,a,u,c,h,d]=e,y=r4(t,n,i,r,s,o,a);let v;return u?v=sde[u]:c?v=0:v=rT(h,d),[y,new Yi(v)]}function lde(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}const ude=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun), (\d\d) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) (\d{4}) (\d\d):(\d\d):(\d\d) GMT$/,cde=/^(Monday|Tuesday|Wednesday|Thursday|Friday|Saturday|Sunday), (\d\d)-(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-(\d\d) (\d\d):(\d\d):(\d\d) GMT$/,pde=/^(Mon|Tue|Wed|Thu|Fri|Sat|Sun) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ( \d|\d\d) (\d\d):(\d\d):(\d\d) (\d{4})$/;function WD(e){const[,t,r,i,n,s,o,a]=e;return[r4(t,n,i,r,s,o,a),Yi.utcInstance]}function hde(e){const[,t,r,i,n,s,o,a]=e;return[r4(t,a,r,i,n,s,o),Yi.utcInstance]}const dde=Hm(Jhe,t4),fde=Hm(Zhe,t4),yde=Hm(Yhe,t4),mde=Hm(gz),wz=Wm(tde,Zm,Bv,zv),gde=Wm(Khe,Zm,Bv,zv),vde=Wm(Xhe,Zm,Bv,zv),wde=Wm(Zm,Bv,zv);function bde(e){return Jm(e,[dde,wz],[fde,gde],[yde,vde],[mde,wde])}function _de(e){return Jm(lde(e),[ode,ade])}function Sde(e){return Jm(e,[ude,WD],[cde,WD],[pde,hde])}function xde(e){return Jm(e,[ide,nde])}const Tde=Wm(Zm);function Ide(e){return Jm(e,[rde,Tde])}const Mde=Hm(Qhe,ede),$de=Hm(vz),Ede=Wm(Zm,Bv,zv);function Ade(e){return Jm(e,[Mde,wz],[$de,Ede])}const JD="Invalid Duration",bz={weeks:{days:7,hours:7*24,minutes:7*24*60,seconds:7*24*60*60,milliseconds:7*24*60*60*1e3},days:{hours:24,minutes:24*60,seconds:24*60*60,milliseconds:24*60*60*1e3},hours:{minutes:60,seconds:60*60,milliseconds:60*60*1e3},minutes:{seconds:60,milliseconds:60*1e3},seconds:{milliseconds:1e3}},Rde={years:{quarters:4,months:12,weeks:52,days:365,hours:365*24,minutes:365*24*60,seconds:365*24*60*60,milliseconds:365*24*60*60*1e3},quarters:{months:3,weeks:13,days:91,hours:91*24,minutes:91*24*60,seconds:91*24*60*60,milliseconds:91*24*60*60*1e3},months:{weeks:4,days:30,hours:30*24,minutes:30*24*60,seconds:30*24*60*60,milliseconds:30*24*60*60*1e3},...bz},vo=146097/400,Bf=146097/4800,Cde={years:{quarters:4,months:12,weeks:vo/7,days:vo,hours:vo*24,minutes:vo*24*60,seconds:vo*24*60*60,milliseconds:vo*24*60*60*1e3},quarters:{months:3,weeks:vo/28,days:vo/4,hours:vo*24/4,minutes:vo*24*60/4,seconds:vo*24*60*60/4,milliseconds:vo*24*60*60*1e3/4},months:{weeks:Bf/7,days:Bf,hours:Bf*24,minutes:Bf*24*60,seconds:Bf*24*60*60,milliseconds:Bf*24*60*60*1e3},...bz},$d=["years","quarters","months","weeks","days","hours","minutes","seconds","milliseconds"],Ode=$d.slice(0).reverse();function mc(e,t,r=!1){const i={values:r?t.values:{...e.values,...t.values||{}},loc:e.loc.clone(t.loc),conversionAccuracy:t.conversionAccuracy||e.conversionAccuracy,matrix:t.matrix||e.matrix};return new Ct(i)}function _z(e,t){let r=t.milliseconds??0;for(const i of Ode.slice(1))t[i]&&(r+=t[i]*e[i].milliseconds);return r}function ZD(e,t){const r=_z(e,t)<0?-1:1;$d.reduceRight((i,n)=>{if(lt(t[n]))return i;if(i){const s=t[i]*r,o=e[n][i],a=Math.floor(s/o);t[n]+=a*r,t[i]-=a*o*r}return n},null),$d.reduce((i,n)=>{if(lt(t[n]))return i;if(i){const s=t[i]%1;t[i]-=s,t[n]+=s*e[i][n]}return n},null)}function Pde(e){const t={};for(const[r,i]of Object.entries(e))i!==0&&(t[r]=i);return t}class Ct{constructor(t){const r=t.conversionAccuracy==="longterm"||!1;let i=r?Cde:Rde;t.matrix&&(i=t.matrix),this.values=t.values,this.loc=t.loc||Yt.create(),this.conversionAccuracy=r?"longterm":"casual",this.invalid=t.invalid||null,this.matrix=i,this.isLuxonDuration=!0}static fromMillis(t,r){return Ct.fromObject({milliseconds:t},r)}static fromObject(t,r={}){if(t==null||typeof t!="object")throw new vs(`Duration.fromObject: argument expected to be an object, got ${t===null?"null":typeof t}`);return new Ct({values:XS(t,Ct.normalizeUnit),loc:Yt.fromObject(r),conversionAccuracy:r.conversionAccuracy,matrix:r.matrix})}static fromDurationLike(t){if(zd(t))return Ct.fromMillis(t);if(Ct.isDuration(t))return t;if(typeof t=="object")return Ct.fromObject(t);throw new vs(`Unknown duration argument ${t} of type ${typeof t}`)}static fromISO(t,r){const[i]=xde(t);return i?Ct.fromObject(i,r):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static fromISOTime(t,r){const[i]=Ide(t);return i?Ct.fromObject(i,r):Ct.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static invalid(t,r=null){if(!t)throw new vs("need to specify a reason the Duration is invalid");const i=t instanceof Aa?t:new Aa(t,r);if(Kr.throwOnInvalid)throw new ohe(i);return new Ct({invalid:i})}static normalizeUnit(t){const r={year:"years",years:"years",quarter:"quarters",quarters:"quarters",month:"months",months:"months",week:"weeks",weeks:"weeks",day:"days",days:"days",hour:"hours",hours:"hours",minute:"minutes",minutes:"minutes",second:"seconds",seconds:"seconds",millisecond:"milliseconds",milliseconds:"milliseconds"}[t&&t.toLowerCase()];if(!r)throw new CB(t);return r}static isDuration(t){return t&&t.isLuxonDuration||!1}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}toFormat(t,r={}){const i={...r,floor:r.round!==!1&&r.floor!==!1};return this.isValid?In.create(this.loc,i).formatDurationFromString(this,t):JD}toHuman(t={}){if(!this.isValid)return JD;const r=$d.map(i=>{const n=this.values[i];return lt(n)?null:this.loc.numberFormatter({style:"unit",unitDisplay:"long",...t,unit:i.slice(0,-1)}).format(n)}).filter(i=>i);return this.loc.listFormatter({type:"conjunction",style:t.listStyle||"narrow",...t}).format(r)}toObject(){return this.isValid?{...this.values}:{}}toISO(){if(!this.isValid)return null;let t="P";return this.years!==0&&(t+=this.years+"Y"),(this.months!==0||this.quarters!==0)&&(t+=this.months+this.quarters*3+"M"),this.weeks!==0&&(t+=this.weeks+"W"),this.days!==0&&(t+=this.days+"D"),(this.hours!==0||this.minutes!==0||this.seconds!==0||this.milliseconds!==0)&&(t+="T"),this.hours!==0&&(t+=this.hours+"H"),this.minutes!==0&&(t+=this.minutes+"M"),(this.seconds!==0||this.milliseconds!==0)&&(t+=QO(this.seconds+this.milliseconds/1e3,3)+"S"),t==="P"&&(t+="T0S"),t}toISOTime(t={}){if(!this.isValid)return null;const r=this.toMillis();return r<0||r>=864e5?null:(t={suppressMilliseconds:!1,suppressSeconds:!1,includePrefix:!1,format:"extended",...t,includeOffset:!1},et.fromMillis(r,{zone:"UTC"}).toISOTime(t))}toJSON(){return this.toISO()}toString(){return this.toISO()}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Duration { values: ${JSON.stringify(this.values)} }`:`Duration { Invalid, reason: ${this.invalidReason} }`}toMillis(){return this.isValid?_z(this.matrix,this.values):NaN}valueOf(){return this.toMillis()}plus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t),i={};for(const n of $d)(Sm(r.values,n)||Sm(this.values,n))&&(i[n]=r.get(n)+this.get(n));return mc(this,{values:i},!0)}minus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t);return this.plus(r.negate())}mapUnits(t){if(!this.isValid)return this;const r={};for(const i of Object.keys(this.values))r[i]=oz(t(this.values[i],i));return mc(this,{values:r},!0)}get(t){return this[Ct.normalizeUnit(t)]}set(t){if(!this.isValid)return this;const r={...this.values,...XS(t,Ct.normalizeUnit)};return mc(this,{values:r})}reconfigure({locale:t,numberingSystem:r,conversionAccuracy:i,matrix:n}={}){const o={loc:this.loc.clone({locale:t,numberingSystem:r}),matrix:n,conversionAccuracy:i};return mc(this,o)}as(t){return this.isValid?this.shiftTo(t).get(t):NaN}normalize(){if(!this.isValid)return this;const t=this.toObject();return ZD(this.matrix,t),mc(this,{values:t},!0)}rescale(){if(!this.isValid)return this;const t=Pde(this.normalize().shiftToAll().toObject());return mc(this,{values:t},!0)}shiftTo(...t){if(!this.isValid)return this;if(t.length===0)return this;t=t.map(o=>Ct.normalizeUnit(o));const r={},i={},n=this.toObject();let s;for(const o of $d)if(t.indexOf(o)>=0){s=o;let a=0;for(const c in i)a+=this.matrix[c][o]*i[c],i[c]=0;zd(n[o])&&(a+=n[o]);const u=Math.trunc(a);r[o]=u,i[o]=(a*1e3-u*1e3)/1e3}else zd(n[o])&&(i[o]=n[o]);for(const o in i)i[o]!==0&&(r[s]+=o===s?i[o]:i[o]/this.matrix[s][o]);return ZD(this.matrix,r),mc(this,{values:r},!0)}shiftToAll(){return this.isValid?this.shiftTo("years","months","weeks","days","hours","minutes","seconds","milliseconds"):this}negate(){if(!this.isValid)return this;const t={};for(const r of Object.keys(this.values))t[r]=this.values[r]===0?0:-this.values[r];return mc(this,{values:t},!0)}get years(){return this.isValid?this.values.years||0:NaN}get quarters(){return this.isValid?this.values.quarters||0:NaN}get months(){return this.isValid?this.values.months||0:NaN}get weeks(){return this.isValid?this.values.weeks||0:NaN}get days(){return this.isValid?this.values.days||0:NaN}get hours(){return this.isValid?this.values.hours||0:NaN}get minutes(){return this.isValid?this.values.minutes||0:NaN}get seconds(){return this.isValid?this.values.seconds||0:NaN}get milliseconds(){return this.isValid?this.values.milliseconds||0:NaN}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}equals(t){if(!this.isValid||!t.isValid||!this.loc.equals(t.loc))return!1;function r(i,n){return i===void 0||i===0?n===void 0||n===0:i===n}for(const i of $d)if(!r(this.values[i],t.values[i]))return!1;return!0}}const zf="Invalid Interval";function Lde(e,t){return!e||!e.isValid?Gr.invalid("missing or invalid start"):!t||!t.isValid?Gr.invalid("missing or invalid end"):t<e?Gr.invalid("end before start",`The end of an interval must be after its start, but you had start=${e.toISO()} and end=${t.toISO()}`):null}class Gr{constructor(t){this.s=t.start,this.e=t.end,this.invalid=t.invalid||null,this.isLuxonInterval=!0}static invalid(t,r=null){if(!t)throw new vs("need to specify a reason the Interval is invalid");const i=t instanceof Aa?t:new Aa(t,r);if(Kr.throwOnInvalid)throw new she(i);return new Gr({invalid:i})}static fromDateTimes(t,r){const i=V0(t),n=V0(r),s=Lde(i,n);return s??new Gr({start:i,end:n})}static after(t,r){const i=Ct.fromDurationLike(r),n=V0(t);return Gr.fromDateTimes(n,n.plus(i))}static before(t,r){const i=Ct.fromDurationLike(r),n=V0(t);return Gr.fromDateTimes(n.minus(i),n)}static fromISO(t,r){const[i,n]=(t||"").split("/",2);if(i&&n){let s,o;try{s=et.fromISO(i,r),o=s.isValid}catch{o=!1}let a,u;try{a=et.fromISO(n,r),u=a.isValid}catch{u=!1}if(o&&u)return Gr.fromDateTimes(s,a);if(o){const c=Ct.fromISO(n,r);if(c.isValid)return Gr.after(s,c)}else if(u){const c=Ct.fromISO(i,r);if(c.isValid)return Gr.before(a,c)}}return Gr.invalid("unparsable",`the input "${t}" can't be parsed as ISO 8601`)}static isInterval(t){return t&&t.isLuxonInterval||!1}get start(){return this.isValid?this.s:null}get end(){return this.isValid?this.e:null}get isValid(){return this.invalidReason===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}length(t="milliseconds"){return this.isValid?this.toDuration(t).get(t):NaN}count(t="milliseconds",r){if(!this.isValid)return NaN;const i=this.start.startOf(t,r);let n;return r!=null&&r.useLocaleWeeks?n=this.end.reconfigure({locale:i.locale}):n=this.end,n=n.startOf(t,r),Math.floor(n.diff(i,t).get(t))+(n.valueOf()!==this.end.valueOf())}hasSame(t){return this.isValid?this.isEmpty()||this.e.minus(1).hasSame(this.s,t):!1}isEmpty(){return this.s.valueOf()===this.e.valueOf()}isAfter(t){return this.isValid?this.s>t:!1}isBefore(t){return this.isValid?this.e<=t:!1}contains(t){return this.isValid?this.s<=t&&this.e>t:!1}set({start:t,end:r}={}){return this.isValid?Gr.fromDateTimes(t||this.s,r||this.e):this}splitAt(...t){if(!this.isValid)return[];const r=t.map(V0).filter(o=>this.contains(o)).sort((o,a)=>o.toMillis()-a.toMillis()),i=[];let{s:n}=this,s=0;for(;n<this.e;){const o=r[s]||this.e,a=+o>+this.e?this.e:o;i.push(Gr.fromDateTimes(n,a)),n=a,s+=1}return i}splitBy(t){const r=Ct.fromDurationLike(t);if(!this.isValid||!r.isValid||r.as("milliseconds")===0)return[];let{s:i}=this,n=1,s;const o=[];for(;i<this.e;){const a=this.start.plus(r.mapUnits(u=>u*n));s=+a>+this.e?this.e:a,o.push(Gr.fromDateTimes(i,s)),i=s,n+=1}return o}divideEqually(t){return this.isValid?this.splitBy(this.length()/t).slice(0,t):[]}overlaps(t){return this.e>t.s&&this.s<t.e}abutsStart(t){return this.isValid?+this.e==+t.s:!1}abutsEnd(t){return this.isValid?+t.e==+this.s:!1}engulfs(t){return this.isValid?this.s<=t.s&&this.e>=t.e:!1}equals(t){return!this.isValid||!t.isValid?!1:this.s.equals(t.s)&&this.e.equals(t.e)}intersection(t){if(!this.isValid)return this;const r=this.s>t.s?this.s:t.s,i=this.e<t.e?this.e:t.e;return r>=i?null:Gr.fromDateTimes(r,i)}union(t){if(!this.isValid)return this;const r=this.s<t.s?this.s:t.s,i=this.e>t.e?this.e:t.e;return Gr.fromDateTimes(r,i)}static merge(t){const[r,i]=t.sort((n,s)=>n.s-s.s).reduce(([n,s],o)=>s?s.overlaps(o)||s.abutsStart(o)?[n,s.union(o)]:[n.concat([s]),o]:[n,o],[[],null]);return i&&r.push(i),r}static xor(t){let r=null,i=0;const n=[],s=t.map(u=>[{time:u.s,type:"s"},{time:u.e,type:"e"}]),o=Array.prototype.concat(...s),a=o.sort((u,c)=>u.time-c.time);for(const u of a)i+=u.type==="s"?1:-1,i===1?r=u.time:(r&&+r!=+u.time&&n.push(Gr.fromDateTimes(r,u.time)),r=null);return Gr.merge(n)}difference(...t){return Gr.xor([this].concat(t)).map(r=>this.intersection(r)).filter(r=>r&&!r.isEmpty())}toString(){return this.isValid?`[${this.s.toISO()} – ${this.e.toISO()})`:zf}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`Interval { start: ${this.s.toISO()}, end: ${this.e.toISO()} }`:`Interval { Invalid, reason: ${this.invalidReason} }`}toLocaleString(t=ZS,r={}){return this.isValid?In.create(this.s.loc.clone(r),t).formatInterval(this):zf}toISO(t){return this.isValid?`${this.s.toISO(t)}/${this.e.toISO(t)}`:zf}toISODate(){return this.isValid?`${this.s.toISODate()}/${this.e.toISODate()}`:zf}toISOTime(t){return this.isValid?`${this.s.toISOTime(t)}/${this.e.toISOTime(t)}`:zf}toFormat(t,{separator:r=" – "}={}){return this.isValid?`${this.s.toFormat(t)}${r}${this.e.toFormat(t)}`:zf}toDuration(t,r){return this.isValid?this.e.diff(this.s,t,r):Ct.invalid(this.invalidReason)}mapEndpoints(t){return Gr.fromDateTimes(t(this.s),t(this.e))}}class Ib{static hasDST(t=Kr.defaultZone){const r=et.now().setZone(t).set({month:12});return!t.isUniversal&&r.offset!==r.set({month:6}).offset}static isValidIANAZone(t){return no.isValidZone(t)}static normalizeZone(t){return up(t,Kr.defaultZone)}static getStartOfWeek({locale:t=null,locObj:r=null}={}){return(r||Yt.create(t)).getStartOfWeek()}static getMinimumDaysInFirstWeek({locale:t=null,locObj:r=null}={}){return(r||Yt.create(t)).getMinDaysInFirstWeek()}static getWeekendWeekdays({locale:t=null,locObj:r=null}={}){return(r||Yt.create(t)).getWeekendDays().slice()}static months(t="long",{locale:r=null,numberingSystem:i=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||Yt.create(r,i,s)).months(t)}static monthsFormat(t="long",{locale:r=null,numberingSystem:i=null,locObj:n=null,outputCalendar:s="gregory"}={}){return(n||Yt.create(r,i,s)).months(t,!0)}static weekdays(t="long",{locale:r=null,numberingSystem:i=null,locObj:n=null}={}){return(n||Yt.create(r,i,null)).weekdays(t)}static weekdaysFormat(t="long",{locale:r=null,numberingSystem:i=null,locObj:n=null}={}){return(n||Yt.create(r,i,null)).weekdays(t,!0)}static meridiems({locale:t=null}={}){return Yt.create(t).meridiems()}static eras(t="short",{locale:r=null}={}){return Yt.create(r,null,"gregory").eras(t)}static features(){return{relative:iz(),localeWeek:nz()}}}function YD(e,t){const r=n=>n.toUTC(0,{keepLocalTime:!0}).startOf("day").valueOf(),i=r(t)-r(e);return Math.floor(Ct.fromMillis(i).as("days"))}function kde(e,t,r){const i=[["years",(u,c)=>c.year-u.year],["quarters",(u,c)=>c.quarter-u.quarter+(c.year-u.year)*4],["months",(u,c)=>c.month-u.month+(c.year-u.year)*12],["weeks",(u,c)=>{const h=YD(u,c);return(h-h%7)/7}],["days",YD]],n={},s=e;let o,a;for(const[u,c]of i)r.indexOf(u)>=0&&(o=u,n[u]=c(e,t),a=s.plus(n),a>t?(n[u]--,e=s.plus(n),e>t&&(a=e,n[u]--,e=s.plus(n))):e=a);return[e,n,a,o]}function Nde(e,t,r,i){let[n,s,o,a]=kde(e,t,r);const u=t-n,c=r.filter(d=>["hours","minutes","seconds","milliseconds"].indexOf(d)>=0);c.length===0&&(o<t&&(o=n.plus({[a]:1})),o!==n&&(s[a]=(s[a]||0)+u/(o-n)));const h=Ct.fromObject(s,i);return c.length>0?Ct.fromMillis(u,i).shiftTo(...c).plus(h):h}const i4={arab:"[٠-٩]",arabext:"[۰-۹]",bali:"[᭐-᭙]",beng:"[০-৯]",deva:"[०-९]",fullwide:"[０-９]",gujr:"[૦-૯]",hanidec:"[〇|一|二|三|四|五|六|七|八|九]",khmr:"[០-៩]",knda:"[೦-೯]",laoo:"[໐-໙]",limb:"[᥆-᥏]",mlym:"[൦-൯]",mong:"[᠐-᠙]",mymr:"[၀-၉]",orya:"[୦-୯]",tamldec:"[௦-௯]",telu:"[౦-౯]",thai:"[๐-๙]",tibt:"[༠-༩]",latn:"\\d"},KD={arab:[1632,1641],arabext:[1776,1785],bali:[6992,7001],beng:[2534,2543],deva:[2406,2415],fullwide:[65296,65303],gujr:[2790,2799],khmr:[6112,6121],knda:[3302,3311],laoo:[3792,3801],limb:[6470,6479],mlym:[3430,3439],mong:[6160,6169],mymr:[4160,4169],orya:[2918,2927],tamldec:[3046,3055],telu:[3174,3183],thai:[3664,3673],tibt:[3872,3881]},Dde=i4.hanidec.replace(/[\[|\]]/g,"").split("");function Fde(e){let t=parseInt(e,10);if(isNaN(t)){t="";for(let r=0;r<e.length;r++){const i=e.charCodeAt(r);if(e[r].search(i4.hanidec)!==-1)t+=Dde.indexOf(e[r]);else for(const n in KD){const[s,o]=KD[n];i>=s&&i<=o&&(t+=i-s)}}return parseInt(t,10)}else return t}function Zo({numberingSystem:e},t=""){return new RegExp(`${i4[e||"latn"]}${t}`)}const jde="missing Intl.DateTimeFormat.formatToParts support";function jt(e,t=r=>r){return{regex:e,deser:([r])=>t(Fde(r))}}const Ude=" ",Sz=`[ ${Ude}]`,xz=new RegExp(Sz,"g");function Vde(e){return e.replace(/\./g,"\\.?").replace(xz,Sz)}function XD(e){return e.replace(/\./g,"").replace(xz," ").toLowerCase()}function Yo(e,t){return e===null?null:{regex:RegExp(e.map(Vde).join("|")),deser:([r])=>e.findIndex(i=>XD(r)===XD(i))+t}}function QD(e,t){return{regex:e,deser:([,r,i])=>rT(r,i),groups:t}}function Mb(e){return{regex:e,deser:([t])=>t}}function Gde(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function Bde(e,t){const r=Zo(t),i=Zo(t,"{2}"),n=Zo(t,"{3}"),s=Zo(t,"{4}"),o=Zo(t,"{6}"),a=Zo(t,"{1,2}"),u=Zo(t,"{1,3}"),c=Zo(t,"{1,6}"),h=Zo(t,"{1,9}"),d=Zo(t,"{2,4}"),y=Zo(t,"{4,6}"),v=_=>({regex:RegExp(Gde(_.val)),deser:([x])=>x,literal:!0}),b=(_=>{if(e.literal)return v(_);switch(_.val){case"G":return Yo(t.eras("short"),0);case"GG":return Yo(t.eras("long"),0);case"y":return jt(c);case"yy":return jt(d,dE);case"yyyy":return jt(s);case"yyyyy":return jt(y);case"yyyyyy":return jt(o);case"M":return jt(a);case"MM":return jt(i);case"MMM":return Yo(t.months("short",!0),1);case"MMMM":return Yo(t.months("long",!0),1);case"L":return jt(a);case"LL":return jt(i);case"LLL":return Yo(t.months("short",!1),1);case"LLLL":return Yo(t.months("long",!1),1);case"d":return jt(a);case"dd":return jt(i);case"o":return jt(u);case"ooo":return jt(n);case"HH":return jt(i);case"H":return jt(a);case"hh":return jt(i);case"h":return jt(a);case"mm":return jt(i);case"m":return jt(a);case"q":return jt(a);case"qq":return jt(i);case"s":return jt(a);case"ss":return jt(i);case"S":return jt(u);case"SSS":return jt(n);case"u":return Mb(h);case"uu":return Mb(a);case"uuu":return jt(r);case"a":return Yo(t.meridiems(),0);case"kkkk":return jt(s);case"kk":return jt(d,dE);case"W":return jt(a);case"WW":return jt(i);case"E":case"c":return jt(r);case"EEE":return Yo(t.weekdays("short",!1),1);case"EEEE":return Yo(t.weekdays("long",!1),1);case"ccc":return Yo(t.weekdays("short",!0),1);case"cccc":return Yo(t.weekdays("long",!0),1);case"Z":case"ZZ":return QD(new RegExp(`([+-]${a.source})(?::(${i.source}))?`),2);case"ZZZ":return QD(new RegExp(`([+-]${a.source})(${i.source})?`),2);case"z":return Mb(/[a-z_+-/]{1,256}?/i);case" ":return Mb(/[^\S\n\r]/);default:return v(_)}})(e)||{invalidReason:jde};return b.token=e,b}const zde={year:{"2-digit":"yy",numeric:"yyyyy"},month:{numeric:"M","2-digit":"MM",short:"MMM",long:"MMMM"},day:{numeric:"d","2-digit":"dd"},weekday:{short:"EEE",long:"EEEE"},dayperiod:"a",dayPeriod:"a",hour12:{numeric:"h","2-digit":"hh"},hour24:{numeric:"H","2-digit":"HH"},minute:{numeric:"m","2-digit":"mm"},second:{numeric:"s","2-digit":"ss"},timeZoneName:{long:"ZZZZZ",short:"ZZZ"}};function qde(e,t,r){const{type:i,value:n}=e;if(i==="literal"){const u=/^\s+$/.test(n);return{literal:!u,val:u?" ":n}}const s=t[i];let o=i;i==="hour"&&(t.hour12!=null?o=t.hour12?"hour12":"hour24":t.hourCycle!=null?t.hourCycle==="h11"||t.hourCycle==="h12"?o="hour12":o="hour24":o=r.hour12?"hour12":"hour24");let a=zde[o];if(typeof a=="object"&&(a=a[s]),a)return{literal:!1,val:a}}function Hde(e){return[`^${e.map(r=>r.regex).reduce((r,i)=>`${r}(${i.source})`,"")}$`,e]}function Wde(e,t,r){const i=e.match(t);if(i){const n={};let s=1;for(const o in r)if(Sm(r,o)){const a=r[o],u=a.groups?a.groups+1:1;!a.literal&&a.token&&(n[a.token.val[0]]=a.deser(i.slice(s,s+u))),s+=u}return[i,n]}else return[i,{}]}function Jde(e){const t=s=>{switch(s){case"S":return"millisecond";case"s":return"second";case"m":return"minute";case"h":case"H":return"hour";case"d":return"day";case"o":return"ordinal";case"L":case"M":return"month";case"y":return"year";case"E":case"c":return"weekday";case"W":return"weekNumber";case"k":return"weekYear";case"q":return"quarter";default:return null}};let r=null,i;return lt(e.z)||(r=no.create(e.z)),lt(e.Z)||(r||(r=new Yi(e.Z)),i=e.Z),lt(e.q)||(e.M=(e.q-1)*3+1),lt(e.h)||(e.h<12&&e.a===1?e.h+=12:e.h===12&&e.a===0&&(e.h=0)),e.G===0&&e.y&&(e.y=-e.y),lt(e.u)||(e.S=XO(e.u)),[Object.keys(e).reduce((s,o)=>{const a=t(o);return a&&(s[a]=e[o]),s},{}),r,i]}let q3=null;function Zde(){return q3||(q3=et.fromMillis(1555555555555)),q3}function Yde(e,t){if(e.literal)return e;const r=In.macroTokenToFormatOpts(e.val),i=Mz(r,t);return i==null||i.includes(void 0)?e:i}function Tz(e,t){return Array.prototype.concat(...e.map(r=>Yde(r,t)))}function Iz(e,t,r){const i=Tz(In.parseFormat(r),e),n=i.map(o=>Bde(o,e)),s=n.find(o=>o.invalidReason);if(s)return{input:t,tokens:i,invalidReason:s.invalidReason};{const[o,a]=Hde(n),u=RegExp(o,"i"),[c,h]=Wde(t,u,a),[d,y,v]=h?Jde(h):[null,null,void 0];if(Sm(h,"a")&&Sm(h,"H"))throw new Gy("Can't include meridiem when specifying 24-hour format");return{input:t,tokens:i,regex:u,rawMatches:c,matches:h,result:d,zone:y,specificOffset:v}}}function Kde(e,t,r){const{result:i,zone:n,specificOffset:s,invalidReason:o}=Iz(e,t,r);return[i,n,s,o]}function Mz(e,t){if(!e)return null;const i=In.create(t,e).dtFormatter(Zde()),n=i.formatToParts(),s=i.resolvedOptions();return n.map(o=>qde(o,e,s))}const H3="Invalid DateTime",e8=864e13;function $b(e){return new Aa("unsupported zone",`the zone "${e.name}" is not supported`)}function W3(e){return e.weekData===null&&(e.weekData=YS(e.c)),e.weekData}function J3(e){return e.localWeekData===null&&(e.localWeekData=YS(e.c,e.loc.getMinDaysInFirstWeek(),e.loc.getStartOfWeek())),e.localWeekData}function dh(e,t){const r={ts:e.ts,zone:e.zone,c:e.c,o:e.o,loc:e.loc,invalid:e.invalid};return new et({...r,...t,old:r})}function $z(e,t,r){let i=e-t*60*1e3;const n=r.offset(i);if(t===n)return[i,t];i-=(n-t)*60*1e3;const s=r.offset(i);return n===s?[i,n]:[e-Math.min(n,s)*60*1e3,Math.max(n,s)]}function Eb(e,t){e+=t*60*1e3;const r=new Date(e);return{year:r.getUTCFullYear(),month:r.getUTCMonth()+1,day:r.getUTCDate(),hour:r.getUTCHours(),minute:r.getUTCMinutes(),second:r.getUTCSeconds(),millisecond:r.getUTCMilliseconds()}}function j_(e,t,r){return $z(tT(e),t,r)}function t8(e,t){const r=e.o,i=e.c.year+Math.trunc(t.years),n=e.c.month+Math.trunc(t.months)+Math.trunc(t.quarters)*3,s={...e.c,year:i,month:n,day:Math.min(e.c.day,KS(i,n))+Math.trunc(t.days)+Math.trunc(t.weeks)*7},o=Ct.fromObject({years:t.years-Math.trunc(t.years),quarters:t.quarters-Math.trunc(t.quarters),months:t.months-Math.trunc(t.months),weeks:t.weeks-Math.trunc(t.weeks),days:t.days-Math.trunc(t.days),hours:t.hours,minutes:t.minutes,seconds:t.seconds,milliseconds:t.milliseconds}).as("milliseconds"),a=tT(s);let[u,c]=$z(a,r,e.zone);return o!==0&&(u+=o,c=e.zone.offset(u)),{ts:u,o:c}}function U0(e,t,r,i,n,s){const{setZone:o,zone:a}=r;if(e&&Object.keys(e).length!==0||t){const u=t||a,c=et.fromObject(e,{...r,zone:u,specificOffset:s});return o?c:c.setZone(a)}else return et.invalid(new Aa("unparsable",`the input "${n}" can't be parsed as ${i}`))}function Ab(e,t,r=!0){return e.isValid?In.create(Yt.create("en-US"),{allowZ:r,forceSimple:!0}).formatDateTimeFromString(e,t):null}function Z3(e,t){const r=e.c.year>9999||e.c.year<0;let i="";return r&&e.c.year>=0&&(i+="+"),i+=hi(e.c.year,r?6:4),t?(i+="-",i+=hi(e.c.month),i+="-",i+=hi(e.c.day)):(i+=hi(e.c.month),i+=hi(e.c.day)),i}function r8(e,t,r,i,n,s){let o=hi(e.c.hour);return t?(o+=":",o+=hi(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!r)&&(o+=":")):o+=hi(e.c.minute),(e.c.millisecond!==0||e.c.second!==0||!r)&&(o+=hi(e.c.second),(e.c.millisecond!==0||!i)&&(o+=".",o+=hi(e.c.millisecond,3))),n&&(e.isOffsetFixed&&e.offset===0&&!s?o+="Z":e.o<0?(o+="-",o+=hi(Math.trunc(-e.o/60)),o+=":",o+=hi(Math.trunc(-e.o%60))):(o+="+",o+=hi(Math.trunc(e.o/60)),o+=":",o+=hi(Math.trunc(e.o%60)))),s&&(o+="["+e.zone.ianaName+"]"),o}const Ez={month:1,day:1,hour:0,minute:0,second:0,millisecond:0},Xde={weekNumber:1,weekday:1,hour:0,minute:0,second:0,millisecond:0},Qde={ordinal:1,hour:0,minute:0,second:0,millisecond:0},Az=["year","month","day","hour","minute","second","millisecond"],efe=["weekYear","weekNumber","weekday","hour","minute","second","millisecond"],tfe=["year","ordinal","hour","minute","second","millisecond"];function rfe(e){const t={year:"year",years:"year",month:"month",months:"month",day:"day",days:"day",hour:"hour",hours:"hour",minute:"minute",minutes:"minute",quarter:"quarter",quarters:"quarter",second:"second",seconds:"second",millisecond:"millisecond",milliseconds:"millisecond",weekday:"weekday",weekdays:"weekday",weeknumber:"weekNumber",weeksnumber:"weekNumber",weeknumbers:"weekNumber",weekyear:"weekYear",weekyears:"weekYear",ordinal:"ordinal"}[e.toLowerCase()];if(!t)throw new CB(e);return t}function i8(e){switch(e.toLowerCase()){case"localweekday":case"localweekdays":return"localWeekday";case"localweeknumber":case"localweeknumbers":return"localWeekNumber";case"localweekyear":case"localweekyears":return"localWeekYear";default:return rfe(e)}}function n8(e,t){const r=up(t.zone,Kr.defaultZone),i=Yt.fromObject(t),n=Kr.now();let s,o;if(lt(e.year))s=n;else{for(const c of Az)lt(e[c])&&(e[c]=Ez[c]);const a=tz(e)||rz(e);if(a)return et.invalid(a);const u=r.offset(n);[s,o]=j_(e,u,r)}return new et({ts:s,zone:r,loc:i,o})}function s8(e,t,r){const i=lt(r.round)?!0:r.round,n=(o,a)=>(o=QO(o,i||r.calendary?0:2,!0),t.loc.clone(r).relFormatter(r).format(o,a)),s=o=>r.calendary?t.hasSame(e,o)?0:t.startOf(o).diff(e.startOf(o),o).get(o):t.diff(e,o).get(o);if(r.unit)return n(s(r.unit),r.unit);for(const o of r.units){const a=s(o);if(Math.abs(a)>=1)return n(a,o)}return n(e>t?-0:0,r.units[r.units.length-1])}function o8(e){let t={},r;return e.length>0&&typeof e[e.length-1]=="object"?(t=e[e.length-1],r=Array.from(e).slice(0,e.length-1)):r=Array.from(e),[t,r]}class et{constructor(t){const r=t.zone||Kr.defaultZone;let i=t.invalid||(Number.isNaN(t.ts)?new Aa("invalid input"):null)||(r.isValid?null:$b(r));this.ts=lt(t.ts)?Kr.now():t.ts;let n=null,s=null;if(!i)if(t.old&&t.old.ts===this.ts&&t.old.zone.equals(r))[n,s]=[t.old.c,t.old.o];else{const a=r.offset(this.ts);n=Eb(this.ts,a),i=Number.isNaN(n.year)?new Aa("invalid input"):null,n=i?null:n,s=i?null:a}this._zone=r,this.loc=t.loc||Yt.create(),this.invalid=i,this.weekData=null,this.localWeekData=null,this.c=n,this.o=s,this.isLuxonDateTime=!0}static now(){return new et({})}static local(){const[t,r]=o8(arguments),[i,n,s,o,a,u,c]=r;return n8({year:i,month:n,day:s,hour:o,minute:a,second:u,millisecond:c},t)}static utc(){const[t,r]=o8(arguments),[i,n,s,o,a,u,c]=r;return t.zone=Yi.utcInstance,n8({year:i,month:n,day:s,hour:o,minute:a,second:u,millisecond:c},t)}static fromJSDate(t,r={}){const i=Che(t)?t.valueOf():NaN;if(Number.isNaN(i))return et.invalid("invalid input");const n=up(r.zone,Kr.defaultZone);return n.isValid?new et({ts:i,zone:n,loc:Yt.fromObject(r)}):et.invalid($b(n))}static fromMillis(t,r={}){if(zd(t))return t<-e8||t>e8?et.invalid("Timestamp out of range"):new et({ts:t,zone:up(r.zone,Kr.defaultZone),loc:Yt.fromObject(r)});throw new vs(`fromMillis requires a numerical input, but received a ${typeof t} with value ${t}`)}static fromSeconds(t,r={}){if(zd(t))return new et({ts:t*1e3,zone:up(r.zone,Kr.defaultZone),loc:Yt.fromObject(r)});throw new vs("fromSeconds requires a numerical input")}static fromObject(t,r={}){t=t||{};const i=up(r.zone,Kr.defaultZone);if(!i.isValid)return et.invalid($b(i));const n=Yt.fromObject(r),s=XS(t,i8),{minDaysInFirstWeek:o,startOfWeek:a}=BD(s,n),u=Kr.now(),c=lt(r.specificOffset)?i.offset(u):r.specificOffset,h=!lt(s.ordinal),d=!lt(s.year),y=!lt(s.month)||!lt(s.day),v=d||y,w=s.weekYear||s.weekNumber;if((v||h)&&w)throw new Gy("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(y&&h)throw new Gy("Can't mix ordinal dates with month/day");const b=w||s.weekday&&!v;let _,x,T=Eb(u,c);b?(_=efe,x=Xde,T=YS(T,o,a)):h?(_=tfe,x=Qde,T=z3(T)):(_=Az,x=Ez);let I=!1;for(const U of _){const F=s[U];lt(F)?I?s[U]=x[U]:s[U]=T[U]:I=!0}const M=b?Ehe(s,o,a):h?Ahe(s):tz(s),$=M||rz(s);if($)return et.invalid($);const A=b?VD(s,o,a):h?GD(s):s,[R,L]=j_(A,c,i),C=new et({ts:R,zone:i,o:L,loc:n});return s.weekday&&v&&t.weekday!==C.weekday?et.invalid("mismatched weekday",`you can't specify both a weekday of ${s.weekday} and a date of ${C.toISO()}`):C}static fromISO(t,r={}){const[i,n]=bde(t);return U0(i,n,r,"ISO 8601",t)}static fromRFC2822(t,r={}){const[i,n]=_de(t);return U0(i,n,r,"RFC 2822",t)}static fromHTTP(t,r={}){const[i,n]=Sde(t);return U0(i,n,r,"HTTP",r)}static fromFormat(t,r,i={}){if(lt(t)||lt(r))throw new vs("fromFormat requires an input string and a format");const{locale:n=null,numberingSystem:s=null}=i,o=Yt.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0}),[a,u,c,h]=Kde(o,t,r);return h?et.invalid(h):U0(a,u,i,`format ${r}`,t,c)}static fromString(t,r,i={}){return et.fromFormat(t,r,i)}static fromSQL(t,r={}){const[i,n]=Ade(t);return U0(i,n,r,"SQL",t)}static invalid(t,r=null){if(!t)throw new vs("need to specify a reason the DateTime is invalid");const i=t instanceof Aa?t:new Aa(t,r);if(Kr.throwOnInvalid)throw new nhe(i);return new et({invalid:i})}static isDateTime(t){return t&&t.isLuxonDateTime||!1}static parseFormatForOpts(t,r={}){const i=Mz(t,Yt.fromObject(r));return i?i.map(n=>n?n.val:null).join(""):null}static expandFormat(t,r={}){return Tz(In.parseFormat(t),Yt.fromObject(r)).map(n=>n.val).join("")}get(t){return this[t]}get isValid(){return this.invalid===null}get invalidReason(){return this.invalid?this.invalid.reason:null}get invalidExplanation(){return this.invalid?this.invalid.explanation:null}get locale(){return this.isValid?this.loc.locale:null}get numberingSystem(){return this.isValid?this.loc.numberingSystem:null}get outputCalendar(){return this.isValid?this.loc.outputCalendar:null}get zone(){return this._zone}get zoneName(){return this.isValid?this.zone.name:null}get year(){return this.isValid?this.c.year:NaN}get quarter(){return this.isValid?Math.ceil(this.c.month/3):NaN}get month(){return this.isValid?this.c.month:NaN}get day(){return this.isValid?this.c.day:NaN}get hour(){return this.isValid?this.c.hour:NaN}get minute(){return this.isValid?this.c.minute:NaN}get second(){return this.isValid?this.c.second:NaN}get millisecond(){return this.isValid?this.c.millisecond:NaN}get weekYear(){return this.isValid?W3(this).weekYear:NaN}get weekNumber(){return this.isValid?W3(this).weekNumber:NaN}get weekday(){return this.isValid?W3(this).weekday:NaN}get isWeekend(){return this.isValid&&this.loc.getWeekendDays().includes(this.weekday)}get localWeekday(){return this.isValid?J3(this).weekday:NaN}get localWeekNumber(){return this.isValid?J3(this).weekNumber:NaN}get localWeekYear(){return this.isValid?J3(this).weekYear:NaN}get ordinal(){return this.isValid?z3(this.c).ordinal:NaN}get monthShort(){return this.isValid?Ib.months("short",{locObj:this.loc})[this.month-1]:null}get monthLong(){return this.isValid?Ib.months("long",{locObj:this.loc})[this.month-1]:null}get weekdayShort(){return this.isValid?Ib.weekdays("short",{locObj:this.loc})[this.weekday-1]:null}get weekdayLong(){return this.isValid?Ib.weekdays("long",{locObj:this.loc})[this.weekday-1]:null}get offset(){return this.isValid?+this.o:NaN}get offsetNameShort(){return this.isValid?this.zone.offsetName(this.ts,{format:"short",locale:this.locale}):null}get offsetNameLong(){return this.isValid?this.zone.offsetName(this.ts,{format:"long",locale:this.locale}):null}get isOffsetFixed(){return this.isValid?this.zone.isUniversal:null}get isInDST(){return this.isOffsetFixed?!1:this.offset>this.set({month:1,day:1}).offset||this.offset>this.set({month:5}).offset}getPossibleOffsets(){if(!this.isValid||this.isOffsetFixed)return[this];const t=864e5,r=6e4,i=tT(this.c),n=this.zone.offset(i-t),s=this.zone.offset(i+t),o=this.zone.offset(i-n*r),a=this.zone.offset(i-s*r);if(o===a)return[this];const u=i-o*r,c=i-a*r,h=Eb(u,o),d=Eb(c,a);return h.hour===d.hour&&h.minute===d.minute&&h.second===d.second&&h.millisecond===d.millisecond?[dh(this,{ts:u}),dh(this,{ts:c})]:[this]}get isInLeapYear(){return Gv(this.year)}get daysInMonth(){return KS(this.year,this.month)}get daysInYear(){return this.isValid?Xy(this.year):NaN}get weeksInWeekYear(){return this.isValid?av(this.weekYear):NaN}get weeksInLocalWeekYear(){return this.isValid?av(this.localWeekYear,this.loc.getMinDaysInFirstWeek(),this.loc.getStartOfWeek()):NaN}resolvedLocaleOptions(t={}){const{locale:r,numberingSystem:i,calendar:n}=In.create(this.loc.clone(t),t).resolvedOptions(this);return{locale:r,numberingSystem:i,outputCalendar:n}}toUTC(t=0,r={}){return this.setZone(Yi.instance(t),r)}toLocal(){return this.setZone(Kr.defaultZone)}setZone(t,{keepLocalTime:r=!1,keepCalendarTime:i=!1}={}){if(t=up(t,Kr.defaultZone),t.equals(this.zone))return this;if(t.isValid){let n=this.ts;if(r||i){const s=t.offset(this.ts),o=this.toObject();[n]=j_(o,s,t)}return dh(this,{ts:n,zone:t})}else return et.invalid($b(t))}reconfigure({locale:t,numberingSystem:r,outputCalendar:i}={}){const n=this.loc.clone({locale:t,numberingSystem:r,outputCalendar:i});return dh(this,{loc:n})}setLocale(t){return this.reconfigure({locale:t})}set(t){if(!this.isValid)return this;const r=XS(t,i8),{minDaysInFirstWeek:i,startOfWeek:n}=BD(r,this.loc),s=!lt(r.weekYear)||!lt(r.weekNumber)||!lt(r.weekday),o=!lt(r.ordinal),a=!lt(r.year),u=!lt(r.month)||!lt(r.day),c=a||u,h=r.weekYear||r.weekNumber;if((c||o)&&h)throw new Gy("Can't mix weekYear/weekNumber units with year/month/day or ordinals");if(u&&o)throw new Gy("Can't mix ordinal dates with month/day");let d;s?d=VD({...YS(this.c,i,n),...r},i,n):lt(r.ordinal)?(d={...this.toObject(),...r},lt(r.day)&&(d.day=Math.min(KS(d.year,d.month),d.day))):d=GD({...z3(this.c),...r});const[y,v]=j_(d,this.o,this.zone);return dh(this,{ts:y,o:v})}plus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t);return dh(this,t8(this,r))}minus(t){if(!this.isValid)return this;const r=Ct.fromDurationLike(t).negate();return dh(this,t8(this,r))}startOf(t,{useLocaleWeeks:r=!1}={}){if(!this.isValid)return this;const i={},n=Ct.normalizeUnit(t);switch(n){case"years":i.month=1;case"quarters":case"months":i.day=1;case"weeks":case"days":i.hour=0;case"hours":i.minute=0;case"minutes":i.second=0;case"seconds":i.millisecond=0;break}if(n==="weeks")if(r){const s=this.loc.getStartOfWeek(),{weekday:o}=this;o<s&&(i.weekNumber=this.weekNumber-1),i.weekday=s}else i.weekday=1;if(n==="quarters"){const s=Math.ceil(this.month/3);i.month=(s-1)*3+1}return this.set(i)}endOf(t,r){return this.isValid?this.plus({[t]:1}).startOf(t,r).minus(1):this}toFormat(t,r={}){return this.isValid?In.create(this.loc.redefaultToEN(r)).formatDateTimeFromString(this,t):H3}toLocaleString(t=ZS,r={}){return this.isValid?In.create(this.loc.clone(r),t).formatDateTime(this):H3}toLocaleParts(t={}){return this.isValid?In.create(this.loc.clone(t),t).formatDateTimeParts(this):[]}toISO({format:t="extended",suppressSeconds:r=!1,suppressMilliseconds:i=!1,includeOffset:n=!0,extendedZone:s=!1}={}){if(!this.isValid)return null;const o=t==="extended";let a=Z3(this,o);return a+="T",a+=r8(this,o,r,i,n,s),a}toISODate({format:t="extended"}={}){return this.isValid?Z3(this,t==="extended"):null}toISOWeekDate(){return Ab(this,"kkkk-'W'WW-c")}toISOTime({suppressMilliseconds:t=!1,suppressSeconds:r=!1,includeOffset:i=!0,includePrefix:n=!1,extendedZone:s=!1,format:o="extended"}={}){return this.isValid?(n?"T":"")+r8(this,o==="extended",r,t,i,s):null}toRFC2822(){return Ab(this,"EEE, dd LLL yyyy HH:mm:ss ZZZ",!1)}toHTTP(){return Ab(this.toUTC(),"EEE, dd LLL yyyy HH:mm:ss 'GMT'")}toSQLDate(){return this.isValid?Z3(this,!0):null}toSQLTime({includeOffset:t=!0,includeZone:r=!1,includeOffsetSpace:i=!0}={}){let n="HH:mm:ss.SSS";return(r||t)&&(i&&(n+=" "),r?n+="z":t&&(n+="ZZ")),Ab(this,n,!0)}toSQL(t={}){return this.isValid?`${this.toSQLDate()} ${this.toSQLTime(t)}`:null}toString(){return this.isValid?this.toISO():H3}[Symbol.for("nodejs.util.inspect.custom")](){return this.isValid?`DateTime { ts: ${this.toISO()}, zone: ${this.zone.name}, locale: ${this.locale} }`:`DateTime { Invalid, reason: ${this.invalidReason} }`}valueOf(){return this.toMillis()}toMillis(){return this.isValid?this.ts:NaN}toSeconds(){return this.isValid?this.ts/1e3:NaN}toUnixInteger(){return this.isValid?Math.floor(this.ts/1e3):NaN}toJSON(){return this.toISO()}toBSON(){return this.toJSDate()}toObject(t={}){if(!this.isValid)return{};const r={...this.c};return t.includeConfig&&(r.outputCalendar=this.outputCalendar,r.numberingSystem=this.loc.numberingSystem,r.locale=this.loc.locale),r}toJSDate(){return new Date(this.isValid?this.ts:NaN)}diff(t,r="milliseconds",i={}){if(!this.isValid||!t.isValid)return Ct.invalid("created by diffing an invalid DateTime");const n={locale:this.locale,numberingSystem:this.numberingSystem,...i},s=Ohe(r).map(Ct.normalizeUnit),o=t.valueOf()>this.valueOf(),a=o?this:t,u=o?t:this,c=Nde(a,u,s,n);return o?c.negate():c}diffNow(t="milliseconds",r={}){return this.diff(et.now(),t,r)}until(t){return this.isValid?Gr.fromDateTimes(this,t):this}hasSame(t,r,i){if(!this.isValid)return!1;const n=t.valueOf(),s=this.setZone(t.zone,{keepLocalTime:!0});return s.startOf(r,i)<=n&&n<=s.endOf(r,i)}equals(t){return this.isValid&&t.isValid&&this.valueOf()===t.valueOf()&&this.zone.equals(t.zone)&&this.loc.equals(t.loc)}toRelative(t={}){if(!this.isValid)return null;const r=t.base||et.fromObject({},{zone:this.zone}),i=t.padding?this<r?-t.padding:t.padding:0;let n=["years","months","days","hours","minutes","seconds"],s=t.unit;return Array.isArray(t.unit)&&(n=t.unit,s=void 0),s8(r,this.plus(i),{...t,numeric:"always",units:n,unit:s})}toRelativeCalendar(t={}){return this.isValid?s8(t.base||et.fromObject({},{zone:this.zone}),this,{...t,numeric:"auto",units:["years","months","days"],calendary:!0}):null}static min(...t){if(!t.every(et.isDateTime))throw new vs("min requires all arguments be DateTimes");return zD(t,r=>r.valueOf(),Math.min)}static max(...t){if(!t.every(et.isDateTime))throw new vs("max requires all arguments be DateTimes");return zD(t,r=>r.valueOf(),Math.max)}static fromFormatExplain(t,r,i={}){const{locale:n=null,numberingSystem:s=null}=i,o=Yt.fromOpts({locale:n,numberingSystem:s,defaultToEN:!0});return Iz(o,t,r)}static fromStringExplain(t,r,i={}){return et.fromFormatExplain(t,r,i)}static get DATE_SHORT(){return ZS}static get DATE_MED(){return OB}static get DATE_MED_WITH_WEEKDAY(){return ahe}static get DATE_FULL(){return PB}static get DATE_HUGE(){return LB}static get TIME_SIMPLE(){return kB}static get TIME_WITH_SECONDS(){return NB}static get TIME_WITH_SHORT_OFFSET(){return DB}static get TIME_WITH_LONG_OFFSET(){return FB}static get TIME_24_SIMPLE(){return jB}static get TIME_24_WITH_SECONDS(){return UB}static get TIME_24_WITH_SHORT_OFFSET(){return VB}static get TIME_24_WITH_LONG_OFFSET(){return GB}static get DATETIME_SHORT(){return BB}static get DATETIME_SHORT_WITH_SECONDS(){return zB}static get DATETIME_MED(){return qB}static get DATETIME_MED_WITH_SECONDS(){return HB}static get DATETIME_MED_WITH_WEEKDAY(){return lhe}static get DATETIME_FULL(){return WB}static get DATETIME_FULL_WITH_SECONDS(){return JB}static get DATETIME_HUGE(){return ZB}static get DATETIME_HUGE_WITH_SECONDS(){return YB}}function V0(e){if(et.isDateTime(e))return e;if(e&&e.valueOf&&zd(e.valueOf()))return et.fromJSDate(e);if(e&&typeof e=="object")return et.fromObject(e);throw new vs(`Unknown datetime argument: ${e}, of type ${typeof e}`)}const Ml="system",lf="unknown",$p="UTC",ife=Intl.DateTimeFormat().resolvedOptions().timeZone,nfe="shortOffset";function sfe(e){return"timeZoneIANA"in e}function ofe(e){return e.startsWith("UTC")}function xm(e,t=!1){return{json:{read:{source:e,reader:(r,i)=>i[e]?U_(i[e]):null},write:!!t&&{allowNull:!0,writer(r,i){i[e]=r?afe(r):null}}}}}function U_(e,t=Ml){return e?sfe(e)?e.timeZoneIANA:lfe(e,t):t}function afe(e){return{timeZoneIANA:e}}function lfe(e,t=Ml){if(!e||!RD.has(e.timeZone))return t;const r=RD.get(e.timeZone);return ofe(e.timeZone)||e.respectsDaylightSaving?r:ufe(r)}function ufe(e){const t=et.local().setZone(e),r=Math.min(t.set({month:1,day:1}).offset,t.set({month:5}).offset);return r===0?"Etc/UTC":`Etc/GMT${Yi.instance(-r).formatOffset(0,"narrow")}`}function RDe(e,t,r,i,n){if(t&&n==="date")return{timeZone:$p,timeZoneName:void 0};const s=i.timeStyle||i.hour,o=r===lf;return{timeZone:o?n==="timestamp-offset"?void 0:e??$p:r,timeZoneName:o&&s?nfe:void 0}}const cfe={year:void 0,month:void 0,day:void 0,weekday:void 0},pfe={hour:void 0,minute:void 0,second:void 0},Rz={timeZone:$p},za={year:"numeric",month:"numeric",day:"numeric"},G0={year:"numeric",month:"long",day:"numeric"},B0={year:"numeric",month:"short",day:"numeric"},z0={year:"numeric",month:"long",weekday:"long",day:"numeric"},rp={hour:"numeric",minute:"numeric"},xh={...rp,second:"numeric"},Cz={hourCycle:"h23"},q0={...rp,...Cz},H0={...xh,...Cz},Oz={"short-date":za,"short-date-short-time":{...za,...rp},"short-date-short-time-24":{...za,...q0},"short-date-long-time":{...za,...xh},"short-date-long-time-24":{...za,...H0},"short-date-le":za,"short-date-le-short-time":{...za,...rp},"short-date-le-short-time-24":{...za,...q0},"short-date-le-long-time":{...za,...xh},"short-date-le-long-time-24":{...za,...H0},"long-month-day-year":G0,"long-month-day-year-short-time":{...G0,...rp},"long-month-day-year-short-time-24":{...G0,...q0},"long-month-day-year-long-time":{...G0,...xh},"long-month-day-year-long-time-24":{...G0,...H0},"day-short-month-year":B0,"day-short-month-year-short-time":{...B0,...rp},"day-short-month-year-short-time-24":{...B0,...q0},"day-short-month-year-long-time":{...B0,...xh},"day-short-month-year-long-time-24":{...B0,...H0},"long-date":z0,"long-date-short-time":{...z0,...rp},"long-date-short-time-24":{...z0,...q0},"long-date-long-time":{...z0,...xh},"long-date-long-time-24":{...z0,...H0},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":rp,"long-time":xh},hfe=Qr()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"}),Pz={ar:"ar-u-nu-latn-ca-gregory"};let fE=new WeakMap;const nT=Oz["short-date-short-time"];function dfe(e){let t=fE.get(e);if(!t){const r=Zs(),i=Pz[r]||r,n=s4(e.timeZone??Ml),s={...e,timeZone:n};t=new Intl.DateTimeFormat(i,s),fE.set(e,t)}return t}function CDe(e){return Oz[e]}function n4(e,t=nT){return dfe(t).format(e)}function ODe(e,t=nT){return n4(new Date(e),{...t,...Rz,...pfe})}function PDe(e,t=nT){return n4(new Date(`1970-01-01T${e}Z`),{...t,...Rz,...cfe})}function LDe(e,t=nT){if(t.timeZone)return n4(new Date(e),t);const r=et.fromISO(e,{setZone:!0}),i=Zs(),n=Pz[i]??i,s=r.offset===0?$p:t.timeZone,o={...t,timeZone:s};return r.toLocaleString(o,{locale:n})}function s4(e){switch(e){case Ml:return ife;case lf:return $p;default:return e}}ZO(()=>{fE=new WeakMap});const ffe={ar:"ar-u-nu-latn"};let V_=new WeakMap,Lz={};function yfe(e){const t=e||Lz;if(!V_.has(t)){const r=Zs(),i=ffe[Zs()]||r;V_.set(t,new Intl.NumberFormat(i,e))}return V_.get(t)}function kDe(e={}){const t={};return e.digitSeparator!=null&&(t.useGrouping=e.digitSeparator),e.places!=null&&(t.minimumFractionDigits=t.maximumFractionDigits=e.places),t}function NDe(e,t){return Object.is(e,-0)&&(e=0),yfe(t).format(e)}ZO(()=>{V_=new WeakMap,Lz={}});const a8=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,mfe={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function l8(e){return e in mfe}const dg=[],em=new Map;function u8(e){for(const t of em.keys())kz(e.pattern,t)&&em.delete(t)}function gfe(e){return dg.includes(e)||(u8(e),dg.unshift(e)),Xt(()=>{const t=dg.indexOf(e);t>-1&&(dg.splice(t,1),u8(e))})}async function o4(e){const t=Zs();em.has(e)||em.set(e,wfe(e,t));const r=em.get(e);return r&&await bfe.add(r),r}function vfe(e){if(!a8.test(e))return null;const t=a8.exec(e);if(t===null)return null;const[,r,i]=t,n=r+(i?"-"+i.toUpperCase():"");return l8(n)?n:l8(r)?r:null}async function wfe(e,t){const r=[];for(const i of dg)if(kz(i.pattern,e))try{return await i.fetchMessageBundle(e,t)}catch(n){r.push(n)}throw r.length?new z("intl:message-bundle-error",`Errors occurred while loading "${e}"`,{errors:r}):new z("intl:no-message-bundle-loader",`No loader found for message bundle "${e}"`)}function kz(e,t){return typeof e=="string"?t.startsWith(e):e.test(t)}ZO(()=>{em.clear()});const bfe=new class{constructor(){this._numLoading=0,this._dfd=null}async waitForAll(){this._dfd&&await this._dfd.promise}add(e){return this._increase(),e.then(()=>this._decrease(),()=>this._decrease()),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=ro())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&this._numLoading===0&&(this._dfd.resolve(),this._dfd=null)}};async function _fe(e,t,r,i){const n=t.exec(r);if(!n)throw new z("esri-intl:invalid-bundle",`Bundle id "${r}" is not compatible with the pattern "${t}"`);const s=n[1]?`${n[1]}/`:"",o=n[2],a=vfe(i),u=`${s}${o}.json`,c=a?`${s}${o}_${a}.json`:u;let h;try{h=await c8(e(c))}catch(d){if(c===u)throw new z("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:d});try{h=await c8(e(u))}catch(y){throw new z("intl:unknown-bundle",`Bundle "${r}" cannot be loaded`,{error:y})}}return h}async function c8(e){if(p8.fetchBundleAsset!=null)return p8.fetchBundleAsset(e);const t=await be(e,{responseType:"text"});return JSON.parse(t.data)}let Sfe=class{constructor({base:t="",pattern:r,location:i=new URL(window.location.href)}){let n;n=typeof i=="string"?s=>new URL(s,new URL(i,window.location.href)).href:i instanceof URL?s=>new URL(s,i).href:i,this.pattern=typeof r=="string"?new RegExp(`^${r}`):r,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=new RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,r){return _fe(this.getAssetUrl,this.matcher,t,r)}};function xfe(e){return new Sfe(e)}const p8={};gfe(xfe({pattern:"esri/",location:Rt}));function FDe(e){return typeof e=="number"}function a4(e){return typeof e=="string"||e instanceof String}const Tfe="yyyy-MM-dd",Ife="TT";var x1;(function(e){e.HM="HH:mm",e.HMS="HH:mm:ss",e.HMS_MS="HH:mm:ss.SSS"})(x1||(x1={}));const Mfe=[x1.HMS_MS,x1.HMS,x1.HM,Ife];function h8(e){if(!e||!a4(e))return null;const t=et.fromFormat(e,Tfe);return t.isValid?t:null}function d8(e){return e&&a4(e)?Aae(Mfe,t=>{const r=et.fromFormat(e,t);return r.isValid?r:null})??null:null}function f8(e){if(!e||!a4(e))return null;const t=et.fromISO(e);return t.isValid?t:null}var Tm;(function(e){e.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",e.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"})(Tm||(Tm={}));const $fe=new Set(["integer","small-integer","big-integer","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"]);function Efe(e){return e!=null&&$fe.has(e.type)}function Nz(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function Dz(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function Fz(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function Afe(e,t){const r=e==null?void 0:e.domain;if(!r)return null;switch(r.type){case"range":{const{min:i,max:n}=Rfe(e);if(i!=null&&+t<i||n!=null&&+t>n)return Tm.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(r.codedValues==null||r.codedValues.every(i=>i==null||i.code!==t))return Tm.INVALID_CODED_VALUE}return null}function Rfe(e,t){const r=e==null?void 0:e.domain;if(!r||r.type!=="range")return;const i="range"in r?r.range[0]:r.minValue,n="range"in r?r.range[1]:r.maxValue,s=Efe(e);return Nz(e)||Fz(e)||Dz(e)?{...Cfe(e,n,i),isInteger:s}:{min:i!=null&&typeof i=="number"?i:null,max:n!=null&&typeof n=="number"?n:null,rawMin:i,rawMax:n,isInteger:s}}function Cfe(e,t,r){var i,n,s,o,a,u;return Nz(e)?{min:(i=h8(r))==null?void 0:i.toMillis(),max:(n=h8(t))==null?void 0:n.toMillis(),rawMin:r,rawMax:t}:Fz(e)?{min:(s=d8(r))==null?void 0:s.toMillis(),max:(o=d8(t))==null?void 0:o.toMillis(),rawMin:r,rawMax:t}:Dz(e)?{min:(a=f8(r))==null?void 0:a.toMillis(),max:(u=f8(t))==null?void 0:u.toMillis(),rawMin:r,rawMax:t}:{max:null,min:null}}const Ofe=()=>oe.getLogger("esri.support.arcadeOnDemand");let Y3;function uf(){return Y3||(Y3=(async()=>{const e=await ge(()=>import("./arcadeUtils-CIqWElA3.js").then(t=>t.aK),__vite__mapDeps([8,1,2,7,9,10]));return{arcade:e.arcade,arcadeUtils:e,Dictionary:e.Dictionary,Feature:e.arcadeFeature}})()),Y3}const Pfe=(e,t,r)=>jz.create(e,t,r,null,["$feature","$view"],[]),Lfe=(e,t,r,i)=>jz.create(e,t,r,i,["$feature","$view"],[]);let jz=class Uz{constructor(t,r,i,n,s,o,a){this.services=null,this.script=t,this.evaluate=n;const u=Array.isArray(o)?o:o==null?void 0:o.fields;this.fields=u??[],this._syntaxTree=i,this._arcade=r,this._arcadeFeature=s,this._spatialReference=a,this._referencesGeometry=r.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,r,i,n,s,o){const{arcade:a,Feature:u,Dictionary:c}=await uf(),h=xe.fromJSON(r);let d;try{d=a.parseScript(t,o)}catch(L){return Ofe().error(new z("arcade-bad-expression","Failed to parse arcade script",{script:t,error:L})),null}const y=s.reduce((L,C)=>({...L,[C]:null}),{});let v=null;n!=null&&(v=new c(n),v.immutable=!0,y.$config=null);const w=a.scriptUsesGeometryEngine(d),b=w&&a.enableGeometrySupport(),_=a.scriptUsesFeatureSet(d)&&a.enableFeatureSetSupport(),x=a.scriptIsAsync(d),T=x&&a.enableAsyncSupport(),I={vars:y,spatialReference:h,useAsync:!!T};await Promise.all([b,_,T]);const M=new Set;await a.loadDependentModules(M,d,null,x,w);const $=new c;$.immutable=!1,$.setField("scale",0);const A=a.compileScript(d,I),R=(L,C)=>{var F;const U=(F=L.$view)==null?void 0:F.timeZone;return"$view"in L&&L.$view&&($.setField("scale",typeof L.$view=="object"&&"scale"in L.$view?L.$view.scale:void 0),L.$view=$),v&&(L.$config=v),A({vars:L,spatialReference:h,services:C,timeZone:U})};return new Uz(t,a,d,R,new u,i,h)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}};const kfe=/^([0-9_])/,Nfe=/[^a-z0-9_\u0080-\uffff]+/gi;function Dfe(e){return e==null?null:e.trim().replaceAll(Nfe,"_").replace(kfe,"F$1")||null}const Ffe=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],jfe=["field","normalizationField"];function y8(e,t){if(e!=null&&t!=null){for(const r of Array.isArray(e)?e:[e])if(m8(Ffe,r,t),"visualVariables"in r&&r.visualVariables)for(const i of r.visualVariables)m8(jfe,i,t)}}function m8(e,t,r){if(e)for(const i of e){const n=Av(i,t),s=n&&typeof n!="function"&&r.get(n);s&&En(i,s.name,t)}}function Vz(e,t){var r;if(e!=null&&((r=t==null?void 0:t.fields)!=null&&r.length))if("startField"in e){const i=t.get(e.startField),n=t.get(e.endField);e.startField=(i==null?void 0:i.name)??null,e.endField=(n==null?void 0:n.name)??null}else{const i=t.get(e.startTimeField),n=t.get(e.endTimeField);e.startTimeField=(i==null?void 0:i.name)??null,e.endTimeField=(n==null?void 0:n.name)??null}}const K3=new Set;function sT(e,t){return e&&t?(K3.clear(),lv(K3,e,t),Array.from(K3).sort()):[]}function lv(e,t,r){var i;if(r)if((i=t==null?void 0:t.fields)!=null&&i.length)if(r.includes("*"))for(const{name:n}of t.fields)e.add(n);else for(const n of r)Ks(e,t,n);else{if(r.includes("*"))return e.clear(),void e.add("*");for(const n of r)n!=null&&e.add(n)}}function Ks(e,t,r){if(typeof r=="string")if(t){const i=t.get(r);i&&e.add(i.name)}else e.add(r)}function jDe(e,t){return t==null||e==null?[]:t.includes("*")?(e.fields??[]).map(r=>r.name):t}function UDe(e,t,r=1){if(!t||!e)return[];if(t.includes("*"))return["*"];const i=sT(e,t);return i.length/e.fields.length>=r?["*"]:i}async function es(e,t,r){var s;if(!r)return;const{arcadeUtils:i}=await uf(),n=i.extractFieldNames(r,(s=t==null?void 0:t.fields)==null?void 0:s.map(o=>o.name));for(const o of n)Ks(e,t,o)}async function Gz(e,t,r){if(r&&r!=="1=1"){const i=await AB(r,t);if(!i.isStandardized)throw new z("fieldUtils:collectFilterFields","Where clause is not standardized",{where:r});lv(e,t,i.fieldNames)}}function Ufe({displayField:e,fields:t}){return e||(t!=null&&t.length?X3(t,"name-or-title")||X3(t,"unique-identifier")||X3(t,"type-or-category")||Vfe(t):null)}function Vfe(e){for(const t of e){if(!(t!=null&&t.name))continue;const r=t.name.toLowerCase();if(r.includes("name")||r.includes("title"))return t.name}return null}function X3(e,t){for(const r of e)if(r!=null&&r.valueType&&r.valueType===t)return r.name;return null}async function VDe(e,t){var i;if(!t)return;const r=(i=t.elevationInfo)==null?void 0:i.featureExpressionInfo;return r?r.collectRequiredFields(e,t.fieldsIndex):void 0}function Gfe(e,t,r){r.onStatisticExpression?es(e,t,r.onStatisticExpression.expression):e.add(r.onStatisticField)}async function GDe(e,t,r){if(!t||!r||!("fields"in r))return;const i=[],n=r.popupTemplate;i.push(Bfe(e,t,n)),r.fields&&i.push(...r.fields.map(async s=>Gfe(e,t.fieldsIndex,s))),await Promise.all(i)}async function Bfe(e,t,r){const i=[];r!=null&&r.expressionInfos&&i.push(...r.expressionInfos.map(s=>es(e,t.fieldsIndex,s.expression)));const n=r==null?void 0:r.content;if(Array.isArray(n))for(const s of n)s.type==="expression"&&s.expressionInfo&&i.push(es(e,t.fieldsIndex,s.expressionInfo.expression));await Promise.all(i)}async function BDe(e,t,r){t&&(t.timeInfo&&(r!=null&&r.timeExtent)&&lv(e,t.fieldsIndex,[t.timeInfo.startField,t.timeInfo.endField]),t.floorInfo&&lv(e,t.fieldsIndex,[t.floorInfo.floorField]),(r==null?void 0:r.where)!=null&&await Gz(e,t.fieldsIndex,r.where))}async function zDe(e,t,r){t&&r&&await Promise.all(r.map(i=>zfe(e,t,i)))}async function zfe(e,t,r){t&&r&&(r.valueExpression?await es(e,t.fieldsIndex,r.valueExpression):r.field&&Ks(e,t.fieldsIndex,r.field))}function qDe(e){return e?sT(e.fieldsIndex,Bz(e)):[]}function qfe(e){if(!e)return[];const t=e.geometryFieldsInfo;return t?sT(e.fieldsIndex,[t.shapeAreaField,t.shapeLengthField]):[]}const Hfe=new Set(["oid","global-id","guid"]),Wfe=new Set(["oid","global-id"]),Jfe=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^shape$/i,/^shape_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/perimeter/i,/objectid/i,/_i$/i];function Zfe(e){const t=new Set;zz(e).forEach(i=>t.add(i)),qfe(e).forEach(i=>t.add(i.toLowerCase()));const r=e&&"infoFor3D"in e?e.infoFor3D:void 0;return r&&(Object.values(r.assetMapFieldRoles).forEach(i=>t.add(i.toLowerCase())),Object.values(r.transformFieldRoles).forEach(i=>t.add(i.toLowerCase()))),Array.from(t)}function Bz(e){if(!e)return[];const t="editFieldsInfo"in e&&e.editFieldsInfo;if(!t)return[];const{creationDateField:r,creatorField:i,editDateField:n,editorField:s}=t;return[r,i,n,s].filter(Boolean)}function zz(e){return Bz(e).map(t=>t.toLowerCase())}function Yfe(e,t){var r;return e.editable&&!Hfe.has(e.type)&&!zz(t).includes(((r=e.name)==null?void 0:r.toLowerCase())??"")}function Kfe(e,t){var i;const r=((i=e.name)==null?void 0:i.toLowerCase())??"";return!((t==null?void 0:t.objectIdField)!=null&&r===t.objectIdField.toLowerCase()||(t==null?void 0:t.globalIdField)!=null&&r===t.globalIdField.toLowerCase()||Zfe(t).includes(r)||Wfe.has(e.type)||Jfe.some(n=>n.test(r)))}async function HDe(e,t){const{labelingInfo:r,fieldsIndex:i}=t;r!=null&&r.length&&await Promise.all(r.map(n=>Xfe(e,i,n)))}async function Xfe(e,t,r){if(!r)return;const i=r.getLabelExpression(),n=r.where;if(i.type==="arcade")await es(e,t,i.expression);else{const s=i.expression.match(/{[^}]*}/g);s&&s.forEach(o=>{Ks(e,t,o.slice(1,-1))})}await Gz(e,t,n)}function Qfe(e){const t=e.defaultValue;return t!==void 0&&Wz(e,t)?t:e.nullable?null:void 0}function WDe(e){const t=typeof e=="string"?{type:e}:e;return pye(t)?255:t.type==="esriFieldTypeDate"||t.type==="date"?8:void 0}function qz(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}function eye(e){return e===null||qz(e)}function tye(e){return e===null||Number.isInteger(e)}function Hz(e){return e!=null&&typeof e=="string"}function rye(e){return e===null||Hz(e)}function iye(){return!0}function Wz(e,t){let r;switch(e.type){case"date":case"integer":case"long":case"small-integer":case"big-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":case"esriFieldTypeBigInteger":r=e.nullable?tye:Number.isInteger;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":r=e.nullable?eye:qz;break;case"string":case"esriFieldTypeString":r=e.nullable?rye:Hz;break;default:r=iye}return arguments.length===1?r:r(t)}const nye=["integer","small-integer","big-integer"],sye=["single","double"],oye=["esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeBigInteger"],aye=["esriFieldTypeSingle","esriFieldTypeDouble"],lye=new Set([...nye,...oye]),uye=new Set([...sye,...aye]),cye=zV(lye,uye);function Jz(e){return e!=null&&cye.has(e.type)}function pye(e){return e!=null&&(e.type==="string"||e.type==="esriFieldTypeString")}function hye(e){return e!=null&&(e.type==="date"||e.type==="esriFieldTypeDate")}function JDe(e){return e!=null&&(e.type==="date-only"||e.type==="esriFieldTypeDateOnly")}function ZDe(e){return e!=null&&(e.type==="timestamp-offset"||e.type==="esriFieldTypeTimestampOffset")}function dye(e){return e!=null&&(e.type==="time-only"||e.type==="esriFieldTypeTimeOnly")}function g8(e){return e!=null&&(e.type==="oid"||e.type==="esriFieldTypeOID")}function v8(e){return e!=null&&(e.type==="global-id"||e.type==="esriFieldTypeGlobalID")}function YDe(e,t){return fye(e,t)===null}var QS,ex;function KDe(e){return e==null||typeof e=="number"&&isNaN(e)?null:e}function fye(e,t){return e==null||e.nullable&&t===null?null:Jz(e)&&!yye(e.type,Number(t))?QS.OUT_OF_RANGE:Wz(e,t)?e.domain?Afe(e,t):null:ex.INVALID_TYPE}function yye(e,t){const r=typeof e=="string"?Zz(e):e;if(!r)return!1;const i=r.min,n=r.max;return r.isInteger?Number.isInteger(t)&&t>=i&&t<=n:t>=i&&t<=n}function Zz(e){switch(e){case"esriFieldTypeSmallInteger":case"small-integer":return mye;case"esriFieldTypeInteger":case"integer":return gye;case"esriFieldTypeBigInteger":case"big-integer":return vye;case"esriFieldTypeSingle":case"single":return wye;case"esriFieldTypeDouble":case"double":return bye}}(function(e){e.OUT_OF_RANGE="numeric-range-validation-error::out-of-range"})(QS||(QS={})),function(e){e.INVALID_TYPE="type-validation-error::invalid-type"}(ex||(ex={}));const mye={min:-32768,max:32767,isInteger:!0,rawMin:-32768,rawMax:32767},gye={min:-2147483648,max:2147483647,isInteger:!0,rawMin:-2147483648,rawMax:2147483647},vye={min:-Number.MAX_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,isInteger:!0,rawMin:-Number.MAX_SAFE_INTEGER,rawMax:Number.MAX_SAFE_INTEGER},wye={min:-34e37,max:12e37,isInteger:!1,rawMin:-34e37,rawMax:12e37},bye={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1,rawMin:-Number.MAX_VALUE,rawMax:Number.MAX_VALUE};function XDe(e,t,r){switch(e){case Tm.INVALID_CODED_VALUE:return`Value ${r} is not in the coded domain - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case Tm.VALUE_OUT_OF_RANGE:return`Value ${r} is out of the range of valid values - field: ${t.name}, domain: ${JSON.stringify(t.domain)}`;case ex.INVALID_TYPE:return`Value ${r} is not a valid value for the field type - field: ${t.name}, type: ${t.type}, nullable: ${t.nullable}`;case QS.OUT_OF_RANGE:{const{min:i,max:n}=Zz(t.type);return`Value ${r} is out of range for the number type - field: ${t.name}, type: ${t.type}, value range is ${i} to ${n}`}}}function QDe(e,t){return!_ye(e,t,null)}function _ye(e,t,r){if(!(t!=null&&t.attributes)||!e)return!0;const i=new Set(Object.keys(t.attributes));let n=!1;for(const s of e)if(!i.has(s)&&(n=!0,r==null))break;return n}function Sye(e){return!!e&&["raster.itempixelvalue","raster.servicepixelvalue"].some(t=>e.toLowerCase().startsWith(t))}let G_=class extends Q{constructor(t){super(t),this.type=null}};l([p({type:["attachments","custom","fields","media","text","expression","relationship"],readOnly:!0,json:{read:!1,write:!0}})],G_.prototype,"type",void 0),G_=l([k("esri.popup.content.Content")],G_);const jp=G_;var yE;let Th=yE=class extends jp{constructor(e){super(e),this.description=null,this.displayType="auto",this.title=null,this.type="attachments"}clone(){return new yE({description:this.description,displayType:this.displayType,title:this.title})}};l([p({type:String,json:{write:!0}})],Th.prototype,"description",void 0),l([p({type:["auto","preview","list"],json:{write:!0}})],Th.prototype,"displayType",void 0),l([p({type:String,json:{write:!0}})],Th.prototype,"title",void 0),l([p({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],Th.prototype,"type",void 0),Th=yE=l([k("esri.popup.content.AttachmentsContent")],Th);const uv=Th;var mE;let Ih=mE=class extends jp{constructor(e){super(e),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new mE({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?B(this.outFields):null})}};l([p()],Ih.prototype,"creator",void 0),l([p()],Ih.prototype,"destroyer",void 0),l([p()],Ih.prototype,"outFields",void 0),l([p({type:["custom"],readOnly:!0})],Ih.prototype,"type",void 0),Ih=mE=l([k("esri.popup.content.CustomContent")],Ih);const xye=Ih;var gE;let ey=gE=class extends Q{constructor(e){super(e),this.title=null,this.expression=null,this.returnType="dictionary"}clone(){return new gE({title:this.title,expression:this.expression})}};l([p({type:String,json:{write:!0}})],ey.prototype,"title",void 0),l([p({type:String,json:{write:!0}})],ey.prototype,"expression",void 0),l([p({type:["dictionary"],readOnly:!0,json:{read:!1,write:!0}})],ey.prototype,"returnType",void 0),ey=gE=l([k("esri.popup.ElementExpressionInfo")],ey);const Tye=ey;var vE;let fg=vE=class extends jp{constructor(e){super(e),this.expressionInfo=null,this.type="expression"}clone(){var e;return new vE({expressionInfo:(e=this.expressionInfo)==null?void 0:e.clone()})}};l([p({type:Tye,json:{write:!0}})],fg.prototype,"expressionInfo",void 0),l([p({type:["expression"],readOnly:!0,json:{read:!1,write:!0}})],fg.prototype,"type",void 0),fg=vE=l([k("esri.popup.content.ExpressionContent")],fg);const l4=fg;function Ce(e,t={}){const r=e instanceof We?e:new We(e,t),i={type:(t==null?void 0:t.ignoreUnknown)??1?r.apiValues:String,json:{type:r.jsonValues,read:!(t!=null&&t.readOnly)&&{reader:r.read},write:{writer:r.write}}};return(t==null?void 0:t.readOnly)!==void 0&&(i.readOnly=!!t.readOnly),(t==null?void 0:t.default)!==void 0&&(i.json.default=t.default),(t==null?void 0:t.name)!==void 0&&(i.json.name=t.name),(t==null?void 0:t.nonNullable)!==void 0&&(i.nonNullable=t.nonNullable),p(i)}let ty=class extends It(Q){constructor(t){super(t),this.dateFormat=null,this.digitSeparator=!1,this.places=null}};l([Ce(hfe)],ty.prototype,"dateFormat",void 0),l([p({type:Boolean,json:{write:!0}})],ty.prototype,"digitSeparator",void 0),l([p({type:Ke,json:{write:!0}})],ty.prototype,"places",void 0),ty=l([k("esri.popup.support.FieldInfoFormat")],ty);const B_=ty;var wE;let ta=wE=class extends Q{constructor(e){super(e),this.fieldName=null,this.format=null,this.isEditable=!0,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new wE({fieldName:this.fieldName,format:this.format?B(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};l([p({type:String,json:{write:!0}})],ta.prototype,"fieldName",void 0),l([p({type:B_,json:{write:!0}})],ta.prototype,"format",void 0),l([p({type:Boolean,json:{write:{alwaysWriteDefaults:!0},default:!0}})],ta.prototype,"isEditable",void 0),l([p({type:String,json:{write:!0}})],ta.prototype,"label",void 0),l([Ce(new We({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],ta.prototype,"stringFieldOption",void 0),l([p({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],ta.prototype,"statisticType",void 0),l([p({type:String,json:{write:!0}})],ta.prototype,"tooltip",void 0),l([p({type:Boolean,json:{write:!0}})],ta.prototype,"visible",void 0),ta=wE=l([k("esri.popup.FieldInfo")],ta);const u4=ta;var bE;let Ql=bE=class extends jp{constructor(e){super(e),this.attributes=null,this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(e,t){t.fieldInfos=e&&e.map(r=>r.toJSON())}clone(){return new bE(B({attributes:this.attributes,description:this.description,fieldInfos:this.fieldInfos,title:this.title}))}};l([p({type:Object,json:{write:!0}})],Ql.prototype,"attributes",void 0),l([p({type:String,json:{write:!0}})],Ql.prototype,"description",void 0),l([p({type:[u4]})],Ql.prototype,"fieldInfos",void 0),l([se("fieldInfos")],Ql.prototype,"writeFieldInfos",null),l([p({type:String,json:{write:!0}})],Ql.prototype,"title",void 0),l([p({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],Ql.prototype,"type",void 0),Ql=bE=l([k("esri.popup.content.FieldsContent")],Ql);const cv=Ql;let Mh=class extends Q{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};l([p({type:String,json:{write:!0}})],Mh.prototype,"altText",void 0),l([p({type:String,json:{write:!0}})],Mh.prototype,"caption",void 0),l([p({type:String,json:{write:!0}})],Mh.prototype,"title",void 0),l([p({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Mh.prototype,"type",void 0),Mh=l([k("esri.popup.content.mixins.MediaInfo")],Mh);const c4=Mh,tx={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function Yz(e){return!!tx[e]||!!tx[e.toLowerCase()]}function p4(e){return tx[e]??tx[e.toLowerCase()]}function Iye(e){return[...p4(e)]}function Q3(e,t,r){r<0&&++r,r>1&&--r;const i=6*r;return i<1?e+(t-e)*i:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}function Kz(e,t,r,i=1){const n=(e%360+360)%360/360,s=r<=.5?r*(t+1):r+t-r*t,o=2*r-s;return[Math.round(255*Q3(o,s,n+1/3)),Math.round(255*Q3(o,s,n)),Math.round(255*Q3(o,s,n-1/3)),i]}function Mye(e){const t=e.length>5,r=t?8:4,i=(1<<r)-1,n=t?1:17,s=t?e.length===9:e.length===5;let o=+("0x"+e.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let u;return s&&(u=o&i,o>>=r,a[3]=n*u/255),u=o&i,o>>=r,a[2]=n*u,u=o&i,o>>=r,a[1]=n*u,u=o&i,o>>=r,a[0]=n*u,a}function Rb(e){return ka(Fx(e),0,255)}function Cb(e,t,r){return e=Number(e),isNaN(e)?r:e<t?t:e>r?r:e}function Ob(e,t){const r=e.toString(16).padStart(2,"0");return t?r.substring(0,1):r}let z_=class bi{static blendColors(t,r,i,n=new bi){return n.r=Math.round(t.r+(r.r-t.r)*i),n.g=Math.round(t.g+(r.g-t.g)*i),n.b=Math.round(t.b+(r.b-t.b)*i),n.a=t.a+(r.a-t.a)*i,n._sanitize()}static fromRgb(t,r){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const n=i[2].split(/\s*,\s*/),s=i[1];if(s==="rgb"&&n.length===3||s==="rgba"&&n.length===4){const o=n[0];if(o.charAt(o.length-1)==="%"){const a=n.map(u=>2.56*parseFloat(u));return n.length===4&&(a[3]=parseFloat(n[3])),bi.fromArray(a,r)}return bi.fromArray(n.map(a=>parseFloat(a)),r)}if(s==="hsl"&&n.length===3||s==="hsla"&&n.length===4)return bi.fromArray(Kz(parseFloat(n[0]),parseFloat(n[1])/100,parseFloat(n[2])/100,parseFloat(n[3])),r)}return null}static fromHex(t,r=new bi){if(t[0]!=="#"||isNaN(+`0x${t.substring(1)}`))return null;switch(t.length){case 4:case 5:{const i=parseInt(t.substring(1,2),16),n=parseInt(t.substring(2,3),16),s=parseInt(t.substring(3,4),16),o=t.length===5?15:parseInt(t.substring(4),16);return bi.fromArray([i+16*i,n+16*n,s+16*s,(o+16*o)/255],r)}case 7:case 9:{const i=parseInt(t.substring(1,3),16),n=parseInt(t.substring(3,5),16),s=parseInt(t.substring(5,7),16),o=t.length===7?255:parseInt(t.substring(7),16);return bi.fromArray([i,n,s,o/255],r)}default:return null}}static fromArray(t,r=new bi){return r._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(r.a)&&(r.a=1),r._sanitize()}static fromString(t,r){const i=Yz(t)?p4(t):null;return i&&bi.fromArray(i,r)||bi.fromRgb(t,r)||bi.fromHex(t,r)}static fromJSON(t){return t!=null?new bi([t[0],t[1],t[2],(t[3]??255)/255]):void 0}static toUnitRGB(t){return t!=null?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return t!=null?[t.r/255,t.g/255,t.b/255,t.a!=null?t.a:1]:null}constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}get isBright(){return .299*this.r+.587*this.g+.114*this.b>=127}setColor(t){return typeof t=="string"?bi.fromString(t,this):Array.isArray(t)?bi.fromArray(t,this):(this._set(t.r??0,t.g??0,t.b??0,t.a??1),t instanceof bi||this._sanitize()),this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(t){const r=(t==null?void 0:t.capitalize)??!1,i=(t==null?void 0:t.digits)??6,n=i===3||i===4,s=i===4||i===8,o=`#${Ob(this.r,n)}${Ob(this.g,n)}${Ob(this.b,n)}${s?Ob(Math.round(255*this.a),n):""}`;return r?o.toUpperCase():o}toCss(t=!1){const r=this.r+", "+this.g+", "+this.b;return t?`rgba(${r}, ${this.a})`:`rgb(${r})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=bi.AlphaMode.ALWAYS){const r=Rb(this.r),i=Rb(this.g),n=Rb(this.b);return t===bi.AlphaMode.ALWAYS||this.a!==1?[r,i,n,Rb(255*this.a)]:[r,i,n]}clone(){return new bi(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}equals(t){return t!=null&&t.r===this.r&&t.g===this.g&&t.b===this.b&&t.a===this.a}_sanitize(){return this.r=Math.round(Cb(this.r,0,255)),this.g=Math.round(Cb(this.g,0,255)),this.b=Math.round(Cb(this.b,0,255)),this.a=Cb(this.a,0,1),this}_set(t,r,i,n){this.r=t,this.g=r,this.b=i,this.a=n}};z_.prototype.declaredClass="esri.Color",function(e){var t;(t=e.AlphaMode||(e.AlphaMode={}))[t.ALWAYS=0]="ALWAYS",t[t.UNLESS_OPAQUE=1]="UNLESS_OPAQUE"}(z_||(z_={}));const ve=z_;var _E;let $h=_E=class extends De{constructor(e){super(e),this.color=null,this.fieldName=null,this.tooltip=null,this.value=null}clone(){return new _E({fieldName:this.fieldName,tooltip:this.tooltip,value:this.value})}};l([p()],$h.prototype,"color",void 0),l([p()],$h.prototype,"fieldName",void 0),l([p()],$h.prototype,"tooltip",void 0),l([p()],$h.prototype,"value",void 0),$h=_E=l([k("esri.popup.content.support.ChartMediaInfoValueSeries")],$h);const $ye=$h;var SE;let Tc=SE=class extends Q{constructor(e){super(e),this.colors=null,this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new SE({colors:B(this.colors),fields:B(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};l([p({type:[ve],json:{type:[[Ke]],write:!0}})],Tc.prototype,"colors",void 0),l([p({type:[String],json:{write:!0}})],Tc.prototype,"fields",void 0),l([p({type:String,json:{write:!0}})],Tc.prototype,"normalizeField",void 0),l([p({type:[$ye],json:{read:!1}})],Tc.prototype,"series",void 0),l([p({type:String,json:{write:!0}})],Tc.prototype,"tooltipField",void 0),Tc=SE=l([k("esri.popup.content.support.ChartMediaInfoValue")],Tc);const Eye=Tc;let yg=class extends c4{constructor(t){super(t),this.type=null,this.value=null}};l([p({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],yg.prototype,"type",void 0),l([p({type:Eye,json:{write:!0}})],yg.prototype,"value",void 0),yg=l([k("esri.popup.content.mixins.ChartMediaInfo")],yg);const oT=yg,aT=Qr()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var xE;let q_=xE=class extends oT{constructor(e){super(e),this.type="bar-chart"}clone(){return new xE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};l([p({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:aT.write}})],q_.prototype,"type",void 0),q_=xE=l([k("esri.popup.content.BarChartMediaInfo")],q_);const Xz=q_;var TE;let H_=TE=class extends oT{constructor(e){super(e),this.type="column-chart"}clone(){return new TE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};l([p({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:aT.write}})],H_.prototype,"type",void 0),H_=TE=l([k("esri.popup.content.ColumnChartMediaInfo")],H_);const Qz=H_;var IE;let mg=IE=class extends Q{constructor(e){super(e),this.linkURL=null,this.sourceURL=null}clone(){return new IE({linkURL:this.linkURL,sourceURL:this.sourceURL})}};l([p({type:String,json:{write:!0}})],mg.prototype,"linkURL",void 0),l([p({type:String,json:{write:!0}})],mg.prototype,"sourceURL",void 0),mg=IE=l([k("esri.popup.content.support.ImageMediaInfoValue")],mg);const Aye=mg;var ME;let ry=ME=class extends c4{constructor(e){super(e),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new ME({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};l([p({type:Number,json:{write:!0}})],ry.prototype,"refreshInterval",void 0),l([p({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],ry.prototype,"type",void 0),l([p({type:Aye,json:{write:!0}})],ry.prototype,"value",void 0),ry=ME=l([k("esri.popup.content.ImageMediaInfo")],ry);const eq=ry;var $E;let W_=$E=class extends oT{constructor(e){super(e),this.type="line-chart"}clone(){return new $E({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};l([p({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:aT.write}})],W_.prototype,"type",void 0),W_=$E=l([k("esri.popup.content.LineChartMediaInfo")],W_);const tq=W_;var EE;let J_=EE=class extends oT{constructor(e){super(e),this.type="pie-chart"}clone(){return new EE({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};l([p({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:aT.write}})],J_.prototype,"type",void 0),J_=EE=l([k("esri.popup.content.PieChartMediaInfo")],J_);const rq=J_,iq={base:c4,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":Xz,"column-chart":Qz,"line-chart":tq,"pie-chart":rq,image:eq}};var AE;let ra=AE=class extends jp{constructor(e){super(e),this.activeMediaInfoIndex=null,this.attributes=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(e){return e&&e.map(t=>t.type==="image"?eq.fromJSON(t):t.type==="barchart"?Xz.fromJSON(t):t.type==="columnchart"?Qz.fromJSON(t):t.type==="linechart"?tq.fromJSON(t):t.type==="piechart"?rq.fromJSON(t):void 0).filter(Boolean)}writeMediaInfos(e,t){t.mediaInfos=e&&e.map(r=>r.toJSON())}clone(){return new AE(B({activeMediaInfoIndex:this.activeMediaInfoIndex,attributes:this.attributes,description:this.description,mediaInfos:this.mediaInfos,title:this.title}))}};l([p()],ra.prototype,"activeMediaInfoIndex",void 0),l([p({type:Object,json:{write:!0}})],ra.prototype,"attributes",void 0),l([p({type:String,json:{write:!0}})],ra.prototype,"description",void 0),l([p({types:[iq]})],ra.prototype,"mediaInfos",void 0),l([te("mediaInfos")],ra.prototype,"readMediaInfos",null),l([se("mediaInfos")],ra.prototype,"writeMediaInfos",null),l([p({type:String,json:{write:!0}})],ra.prototype,"title",void 0),l([p({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],ra.prototype,"type",void 0),ra=AE=l([k("esri.popup.content.MediaContent")],ra);const rx=ra;var RE;let gg=RE=class extends Q{constructor(e){super(e),this.field=null,this.order=null}clone(){return new RE({field:this.field,order:this.order})}};l([p({type:String,json:{write:!0}})],gg.prototype,"field",void 0),l([p({type:["asc","desc"],json:{write:!0}})],gg.prototype,"order",void 0),gg=RE=l([k("esri.popup.support.RelatedRecordsInfoFieldOrder")],gg);const h4=gg;let Za=class extends It(jp){constructor(t){super(t),this.description=null,this.displayCount=null,this.displayType="list",this.orderByFields=null,this.relationshipId=null,this.title=null,this.type="relationship"}};l([p({type:String,json:{write:!0}})],Za.prototype,"description",void 0),l([p({type:Number,json:{type:Ke,write:!0}})],Za.prototype,"displayCount",void 0),l([p({type:["list"],json:{write:!0}})],Za.prototype,"displayType",void 0),l([p({type:[h4],json:{write:!0}})],Za.prototype,"orderByFields",void 0),l([p({type:Number,json:{type:Ke,write:!0}})],Za.prototype,"relationshipId",void 0),l([p({type:String,json:{write:!0}})],Za.prototype,"title",void 0),l([p({type:["relationship"],readOnly:!0,json:{read:!1,write:!0}})],Za.prototype,"type",void 0),Za=l([k("esri.popup.content.RelationshipContent")],Za);const ix=Za;var CE;let vg=CE=class extends jp{constructor(e){super(e),this.text=null,this.type="text"}clone(){return new CE({text:this.text})}};l([p({type:String,json:{write:!0}})],vg.prototype,"text",void 0),l([p({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],vg.prototype,"type",void 0),vg=CE=l([k("esri.popup.content.TextContent")],vg);const nx=vg,Rye={base:null,key:"type",typeMap:{attachment:uv,media:rx,text:nx,expression:l4,field:cv,relationship:ix}};var OE;let Eh=OE=class extends Q{constructor(e){super(e),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new OE({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};l([p({type:String,json:{write:!0}})],Eh.prototype,"name",void 0),l([p({type:String,json:{write:!0}})],Eh.prototype,"title",void 0),l([p({type:String,json:{write:!0}})],Eh.prototype,"expression",void 0),l([p({type:["string","number"],json:{write:!0}})],Eh.prototype,"returnType",void 0),Eh=OE=l([k("esri.popup.ExpressionInfo")],Eh);const Cye=Eh;var PE;let wg=PE=class extends Q{constructor(e){super(e),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new PE({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};l([p({type:Boolean,json:{write:!0}})],wg.prototype,"returnTopmostRaster",void 0),l([p({type:Boolean,json:{write:!0}})],wg.prototype,"showNoDataRecords",void 0),wg=PE=l([k("esri.popup.LayerOptions")],wg);const Oye=wg;var LE;let bg=LE=class extends Q{constructor(e){super(e),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new LE({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?B(this.orderByFields):null})}};l([p({type:Boolean,json:{write:!0}})],bg.prototype,"showRelatedRecords",void 0),l([p({type:[h4],json:{write:!0}})],bg.prototype,"orderByFields",void 0),bg=LE=l([k("esri.popup.RelatedRecordsInfo")],bg);const Pye=bg;let nq=0;const qv=e=>{let t=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+nq++})}};return t=l([k("esri.core.Identifiable")],t),t},d4=e=>{let t=class extends e{constructor(...r){super(...r),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:nq++})}};return t=l([k("esri.core.NumericIdentifiable")],t),t};let w8=class extends qv(class{}){};w8=l([k("esri.core.Identifiable")],w8);var kE;let So=kE=class extends qv(De){constructor(e){super(e),this.active=!1,this.className=null,this.disabled=!1,this.icon=null,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new kE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};l([p()],So.prototype,"active",void 0),l([p()],So.prototype,"className",void 0),l([p()],So.prototype,"disabled",void 0),l([p()],So.prototype,"icon",void 0),l([p()],So.prototype,"id",void 0),l([p()],So.prototype,"indicator",void 0),l([p()],So.prototype,"title",void 0),l([p()],So.prototype,"type",void 0),l([p()],So.prototype,"visible",void 0),So=kE=l([k("esri.support.actions.ActionBase")],So);const f4=So;var NE;let Z_=NE=class extends f4{constructor(e){super(e),this.image=null,this.type="button"}clone(){return new NE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};l([p()],Z_.prototype,"image",void 0),Z_=NE=l([k("esri.support.Action.ActionButton")],Z_);const Lye=Z_;var DE;let _g=DE=class extends f4{constructor(e){super(e),this.image=null,this.type="toggle",this.value=!1}clone(){return new DE({active:this.active,className:this.className,disabled:this.disabled,icon:this.icon,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};l([p()],_g.prototype,"image",void 0),l([p()],_g.prototype,"value",void 0),_g=DE=l([k("esri.support.Action.ActionToggle")],_g);const kye=_g,W0="relationships/",b8="expression/",Nye=$e.ofType({key:"type",defaultKeyValue:"button",base:f4,typeMap:{button:Lye,toggle:kye}}),Dye={base:jp,key:"type",typeMap:{media:rx,custom:xye,text:nx,attachments:uv,fields:cv,expression:l4,relationship:ix}},Fye=new Set(["attachments","fields","media","text","expression","relationship"]);let _i=class extends It(Q){constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title=""}castContent(t){return Array.isArray(t)?t.map(r=>Tl(Dye,r)):typeof t=="string"||typeof t=="function"||t instanceof HTMLElement||Dp(t)?t:(oe.getLogger(this).error("content error","unsupported content value",{value:t}),null)}readContent(t,r){const{popupElements:i}=r;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(r.description,r.mediaInfos,i):this._readPopupInfo(r)}writeContent(t,r,i,n){typeof t!="string"?Array.isArray(t)&&(r.popupElements=t.filter(s=>Fye.has(s.type)).map(s=>s==null?void 0:s.toJSON(n)),r.popupElements.forEach(s=>{s.type==="attachments"?this._writeAttachmentContent(r):s.type==="media"?this._writeMediaContent(s,r):s.type==="text"?this._writeTextContent(s,r):s.type==="relationship"&&this._writeRelationshipContent(s,r)})):r.description=t}writeFieldInfos(t,r,i,n){const{content:s}=this,o=Array.isArray(s)?s:null;if(t){const a=o?o.filter(c=>c.type==="fields"):[],u=a.length&&a.every(c=>{var h;return(h=c.fieldInfos)==null?void 0:h.length});r.fieldInfos=t.filter(Boolean).map(c=>{const h=c.toJSON(n);return u&&(h.visible=!1),h})}if(o)for(const a of o)a.type==="fields"&&this._writeFieldsContent(a,r)}writeLayerOptions(t,r,i,n){r[i]=!t||t.showNoDataRecords===null&&t.returnTopmostRaster===null?null:t.toJSON(n)}writeTitle(t,r){r.title=t||""}async collectRequiredFields(t,r){const i=this.expressionInfos||[];await this._collectExpressionInfoFields(t,r,[...i,...this._getContentExpressionInfos(this.content,i)]),lv(t,r,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const r=new Set;return await this.collectRequiredFields(r,t),[...r].sort()}_writeFieldsContent(t,r){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=B(t.fieldInfos);Array.isArray(r.fieldInfos)?i.forEach(n=>{const s=r.fieldInfos.find(o=>o.fieldName.toLowerCase()===n.fieldName.toLowerCase());s?s.visible=!0:r.fieldInfos.push(n)}):r.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeRelationshipContent(t,r){var s,o;const i=((s=t.orderByFields)==null?void 0:s.map(a=>this._toFieldOrderJSON(a,t.relationshipId)))||[],n=[...((o=r.relatedRecordsInfo)==null?void 0:o.orderByFields)||[],...i];r.relatedRecordsInfo={showRelatedRecords:!0,...(n==null?void 0:n.length)&&{orderByFields:n}}}_writeTextContent(t,r){!r.description&&t.text&&(r.description=t.text)}_writeMediaContent(t,r){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=B(t.mediaInfos);Array.isArray(r.mediaInfos)?r.mediaInfos=[...r.mediaInfos,...i]:r.mediaInfos=i}_readPopupInfoElements(t,r,i){const n={description:!1,mediaInfos:!1};return i.map(s=>s.type==="media"?(s.mediaInfos||!r||n.mediaInfos||(s.mediaInfos=r,n.mediaInfos=!0),rx.fromJSON(s)):s.type==="text"?(s.text||!t||n.description||(s.text=t,n.description=!0),nx.fromJSON(s)):s.type==="attachments"?uv.fromJSON(s):s.type==="fields"?cv.fromJSON(s):s.type==="expression"?l4.fromJSON(s):s.type==="relationship"?ix.fromJSON(s):void 0).filter(Boolean)}_toRelationshipContent(t){const{field:r,order:i}=t;if(!(r!=null&&r.startsWith(W0)))return null;const n=r.replace(W0,"").split("/");if(n.length!==2)return null;const s=parseInt(n[0],10),o=n[1];return typeof s=="number"&&o?ix.fromJSON({relationshipId:s,orderByFields:[{field:o,order:i}]}):null}_toFieldOrderJSON(t,r){const{order:i,field:n}=t;return{field:`${W0}${r}/${n}`,order:i}}_readPopupInfo({description:t,mediaInfos:r,showAttachments:i,relatedRecordsInfo:n={showRelatedRecords:!1}}){const s=[];t?s.push(new nx({text:t})):s.push(new cv),Array.isArray(r)&&r.length&&s.push(rx.fromJSON({mediaInfos:r})),i&&s.push(uv.fromJSON({displayType:"auto"}));const{showRelatedRecords:o,orderByFields:a}=n;return o&&(a!=null&&a.length)&&a.forEach(u=>{const c=this._toRelationshipContent(u);c&&s.push(c)}),s.length?s:t}_getContentElementFields(t){const r=t==null?void 0:t.type;if(r==="attachments")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description)];if(r==="custom")return t.outFields||[];if(r==="fields")return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...this._getFieldInfoFields(t.fieldInfos??this.fieldInfos)];if(r==="media"){const i=t.mediaInfos||[];return[...this._extractFieldNames(t.title),...this._extractFieldNames(t.description),...i.reduce((n,s)=>[...n,...this._getMediaInfoFields(s)],[])]}return r==="text"?this._extractFieldNames(t.text):[]}_getMediaInfoFields(t){const{caption:r,title:i,value:n}=t,s=n||{},{fields:o,normalizeField:a,tooltipField:u,sourceURL:c,linkURL:h}=s,d=[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(c),...this._extractFieldNames(h),...o??[]];return a&&d.push(a),u&&d.push(u),d}_getContentExpressionInfos(t,r){return Array.isArray(t)?t.reduce((i,n)=>[...i,...n.type==="expression"&&n.expressionInfo?[n.expressionInfo]:[]],r):[]}_getContentFields(t){return typeof t=="string"?this._extractFieldNames(t):Array.isArray(t)?t.reduce((r,i)=>[...r,...this._getContentElementFields(i)],[]):[]}async _collectExpressionInfoFields(t,r,i){i&&await Promise.all(i.map(n=>es(t,r,n.expression)))}_getFieldInfoFields(t){return t?t.filter(r=>r.visible===void 0||!!r.visible).map(r=>r.fieldName).filter(r=>!r.startsWith(W0)&&!r.startsWith(b8)):[]}_getActionsFields(t){return t?t.toArray().reduce((r,i)=>[...r,...this._getActionFields(i)],[]):[]}_getActionFields(t){const{className:r,title:i,type:n}=t,s=n==="button"||n==="toggle"?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(r),...this._extractFieldNames(s)]}_getTitleFields(t){return typeof t=="string"?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||typeof t!="string")return[];const r=/{[^}]*}/g,i=t.match(r);if(!i)return[];const n=/\{(\w+):.+\}/,s=i.filter(o=>!(o.indexOf(`{${W0}`)===0||o.indexOf(`{${b8}`)===0)).map(o=>o.replace(n,"{$1}"));return s?s.map(o=>o.slice(1,-1)):[]}};l([p({type:Nye})],_i.prototype,"actions",void 0),l([p()],_i.prototype,"content",void 0),l([Tt("content")],_i.prototype,"castContent",null),l([te("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments","relatedRecordsInfo"])],_i.prototype,"readContent",null),l([se("content",{popupElements:{type:$e.ofType(Rye)},showAttachments:{type:Boolean},mediaInfos:{type:$e.ofType(iq)},description:{type:String},relatedRecordsInfo:{type:Pye}})],_i.prototype,"writeContent",null),l([p({type:[Cye],json:{write:!0}})],_i.prototype,"expressionInfos",void 0),l([p({type:[u4]})],_i.prototype,"fieldInfos",void 0),l([se("fieldInfos")],_i.prototype,"writeFieldInfos",null),l([p({type:Oye})],_i.prototype,"layerOptions",void 0),l([se("layerOptions")],_i.prototype,"writeLayerOptions",null),l([p({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],_i.prototype,"lastEditInfoEnabled",void 0),l([p()],_i.prototype,"outFields",void 0),l([p()],_i.prototype,"overwriteActions",void 0),l([p()],_i.prototype,"returnGeometry",void 0),l([p({json:{type:String}})],_i.prototype,"title",void 0),l([se("title")],_i.prototype,"writeTitle",null),_i=l([k("esri.PopupTemplate")],_i);const Up=_i,_8=new We({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let jye=0,iy=class extends Q{constructor(t){super(t),this.id="sym"+jye++,this.type=null,this.color=new ve([0,0,0,1])}readColor(t){return(t==null?void 0:t[0])!=null?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,r){}hash(){return JSON.stringify(this.toJSON())}clone(){}};l([p({type:_8.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:_8.write}}})],iy.prototype,"type",void 0),l([p({type:ve,json:{write:{allowNull:!0}}})],iy.prototype,"color",void 0),l([te("color")],iy.prototype,"readColor",null),iy=l([k("esri.symbols.Symbol")],iy);const Ts=iy;var FE;let Ic=FE=class extends Ts{constructor(e){super(e),this.data=null,this.type="cim"}readData(e,t){return t}writeData(e,t){Object.assign(t,e)}async collectRequiredFields(e,t){var r;if(((r=this.data)==null?void 0:r.type)==="CIMSymbolReference"){const i=this.data.primitiveOverrides;if(i){const n=i.map(s=>{const o=s.valueExpressionInfo;return o?es(e,t,o.expression):null});await Promise.all(n)}}}clone(){return new FE({data:B(this.data)})}hash(){return aV(JSON.stringify(this.data)).toString()}};l([p({json:{write:!1}})],Ic.prototype,"color",void 0),l([p({json:{write:!0}})],Ic.prototype,"data",void 0),l([te("data",["symbol"])],Ic.prototype,"readData",null),l([se("data",{})],Ic.prototype,"writeData",null),l([Ce({CIMSymbolReference:"cim"},{readOnly:!0})],Ic.prototype,"type",void 0),Ic=FE=l([k("esri.symbols.CIMSymbol")],Ic);const Hv=Ic;let ny=class extends Q{constructor(t){super(t),this.enabled=!0,this.type=null,this.ignoreDrivers=!1}writeEnabled(t,r,i){t||(r[i]=t)}};l([p({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ny.prototype,"enabled",void 0),l([se("enabled")],ny.prototype,"writeEnabled",null),l([p({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],ny.prototype,"type",void 0),ny=l([k("esri.symbols.Symbol3DLayer")],ny);const Pl=ny,Uye=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i,Vye="screenUtils.toPt: input not recognized!",sq=96;function Gye(e){return e?e/72*sq:0}function Bu(e){return e?72*e/sq:0}function wt(e){if(typeof e=="string"){const t=e.match(Uye);if(t){const r=Number(t[1]),i=t[3]&&t[3].toLowerCase(),n=e.charAt(0)==="-",s=i==="px"?Bu(r):r;return n?-s:s}return console.warn(Vye),null}return e}function Yn(e=0,t=0){return{x:e,y:t}}function u8e(e=0,t=0){return[e,t]}function lT(e){const t=Fx(100*(1-e));return Math.max(0,Math.min(t,100))}function pv(e){const t=1-e/100;return Math.max(0,Math.min(t,1))}function Bye(e,t){const r=t.transparency!=null?pv(t.transparency):1,i=t.color;return i&&Array.isArray(i)?new ve([i[0]||0,i[1]||0,i[2]||0,r]):null}function zye(e,t){t.color=e.toJSON().slice(0,3);const r=lT(e.a);r!==0&&(t.transparency=r)}const Vp={type:ve,json:{type:[Ke],default:null,read:{source:["color","transparency"],reader:Bye},write:{target:{color:{type:[Ke]},transparency:{type:Ke}},writer:zye}}},$l={type:Number,cast:wt,json:{write:!0}};let Ah=class extends Q{constructor(t){super(t),this.color=new ve([0,0,0,1]),this.extensionLength=0,this.size=Bu(1)}clone(){}cloneProperties(){return{color:B(this.color),size:this.size,extensionLength:this.extensionLength}}};l([p({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Ah.prototype,"type",void 0),l([p(Vp)],Ah.prototype,"color",void 0),l([p({...$l,json:{write:{overridePolicy:e=>({enabled:!!e})}}})],Ah.prototype,"extensionLength",void 0),l([p($l)],Ah.prototype,"size",void 0),Ah=l([k("esri.symbols.edges.Edges3D")],Ah);const y4=Ah;var jE;let Y_=jE=class extends y4{constructor(e){super(e),this.type="sketch"}clone(){return new jE(this.cloneProperties())}};l([Ce({sketch:"sketch"},{readOnly:!0})],Y_.prototype,"type",void 0),Y_=jE=l([k("esri.symbols.edges.SketchEdges3D")],Y_);const qye=Y_;var UE;let K_=UE=class extends y4{constructor(e){super(e),this.type="solid"}clone(){return new UE(this.cloneProperties())}};l([Ce({solid:"solid"},{readOnly:!0})],K_.prototype,"type",void 0),K_=UE=l([k("esri.symbols.support.SolidEdges3D")],K_);const Hye=K_,oq={types:{key:"type",base:y4,typeMap:{solid:Hye,sketch:qye}},json:{write:!0}};var VE;let Xs=VE=class extends Q{constructor(e){super(e),this.color=null}clone(){const e={color:this.color!=null?this.color.clone():null};return new VE(e)}};l([p(Vp)],Xs.prototype,"color",void 0),Xs=VE=l([k("esri.symbols.support.Symbol3DMaterial")],Xs);var GE;let Mc=GE=class extends Pl{constructor(e){super(e),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new GE({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};l([Ce({Extrude:"extrude"},{readOnly:!0})],Mc.prototype,"type",void 0),l([p({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Mc.prototype,"size",void 0),l([p({type:Xs,json:{write:!0}})],Mc.prototype,"material",void 0),l([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Mc.prototype,"castShadows",void 0),l([p(oq)],Mc.prototype,"edges",void 0),Mc=GE=l([k("esri.symbols.ExtrudeSymbol3DLayer")],Mc);const aq=Mc;let Sg=class extends Ts{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};l([Ce({esriSLS:"simple-line"},{readOnly:!0})],Sg.prototype,"type",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],Sg.prototype,"width",void 0),Sg=l([k("esri.symbols.LineSymbol")],Sg);const Wye=Sg,Jye=["begin","end","begin-end"],lq=["arrow","circle","square","diamond","cross","x"];var BE;let Ya=BE=class extends Q{constructor(e){super(e),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(e,t,r,i){t[r]=(i==null?void 0:i.origin)==="web-map"?"arrow":e}set color(e){this._set("color",e)}readColor(e){return(e==null?void 0:e[0])!=null?[e[0],e[1],e[2],e[3]/255]:e}writeColor(e,t,r,i){(i==null?void 0:i.origin)==="web-map"||(t[r]=e)}clone(){return new BE({color:B(this.color),placement:this.placement,style:this.style})}hash(){var e;return`${this.placement}.${(e=this.color)==null?void 0:e.hash()}.${this.style}`}};l([p({type:["begin","end","begin-end"],json:{write:!0}})],Ya.prototype,"placement",void 0),l([Ce({"line-marker":"line-marker"},{readOnly:!0}),p({json:{origins:{"web-map":{write:!1}}}})],Ya.prototype,"type",void 0),l([p({type:lq})],Ya.prototype,"style",void 0),l([se("style")],Ya.prototype,"writeStyle",null),l([p({type:ve,value:null,json:{write:{allowNull:!0}}})],Ya.prototype,"color",null),l([te("color")],Ya.prototype,"readColor",null),l([se("color")],Ya.prototype,"writeColor",null),Ya=BE=l([k("esri.symbols.LineSymbolMarker")],Ya);const Zye=Ya;var zE;const eM=new We({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let eu=zE=class extends Wye{constructor(...e){super(...e),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(e,t,r,i,n,s){if(e&&typeof e!="string")return e;const o={};return e!=null&&(o.style=e),t!=null&&(o.color=t),r!=null&&(o.width=wt(r)),i!=null&&(o.cap=i),n!=null&&(o.join=n),s!=null&&(o.miterLimit=wt(s)),o}clone(){var e;return new zE({color:B(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:(e=this.marker)==null?void 0:e.clone()})}hash(){var e,t;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${(t=this.marker)==null?void 0:t.hash()}`}};l([Ce({esriSLS:"simple-line"},{readOnly:!0})],eu.prototype,"type",void 0),l([p({type:eM.apiValues,json:{read:eM.read,write:eM.write}})],eu.prototype,"style",void 0),l([p({type:["butt","round","square"],json:{write:{overridePolicy:(e,t,r)=>({enabled:e!=="round"&&(r==null?void 0:r.origin)==null})}}})],eu.prototype,"cap",void 0),l([p({type:["miter","round","bevel"],json:{write:{overridePolicy:(e,t,r)=>({enabled:e!=="round"&&(r==null?void 0:r.origin)==null})}}})],eu.prototype,"join",void 0),l([p({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Zye}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],eu.prototype,"marker",void 0),l([p({type:Number,json:{read:!1,write:!1}})],eu.prototype,"miterLimit",void 0),eu=zE=l([k("esri.symbols.SimpleLineSymbol")],eu);const oo=eu;let xg=class extends Ts{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};l([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":oo}},json:{default:null,write:!0}})],xg.prototype,"outline",void 0),l([p({type:["simple-fill","picture-fill"],readOnly:!0})],xg.prototype,"type",void 0),xg=l([k("esri.symbols.FillSymbol")],xg);const uq=xg;let X_=class extends Q{constructor(t){super(t)}clone(){}};l([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],X_.prototype,"type",void 0),X_=l([k("esri.symbols.patterns.LinePattern3D")],X_);const cq=X_,Yye=["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"];var qE;const Kye=Qr()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Tg=qE=class extends cq{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new qE(e)}};l([p({type:["style"]})],Tg.prototype,"type",void 0),l([Ce(Kye),p({type:Yye})],Tg.prototype,"style",void 0),Tg=qE=l([k("esri.symbols.patterns.LineStylePattern3D")],Tg);const m4=Tg;let Q_=class extends Q{constructor(t){super(t)}clone(){}};l([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Q_.prototype,"type",void 0),Q_=l([k("esri.symbols.patterns.Pattern3D")],Q_);const pq=Q_,Xye=["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"];var HE;let Ig=HE=class extends pq{constructor(e){super(e),this.type="style",this.style="solid"}clone(){const e={style:this.style};return new HE(e)}};l([p({type:["style"]})],Ig.prototype,"type",void 0),l([p({type:Xye,json:{read:!0,write:!0}})],Ig.prototype,"style",void 0),Ig=HE=l([k("esri.symbols.patterns.StylePattern3D")],Ig);const hq=Ig,Qye={types:{key:"type",base:pq,typeMap:{style:hq}},json:{write:!0}},dq={types:{key:"type",base:cq,typeMap:{style:m4}},json:{write:!0}},T1=new ve("white");new ve("black");const eme=new ve([255,255,255,0]);function tme(e){return e.r===0&&e.g===0&&e.b===0}var WE;let I1=WE=class extends Xs{constructor(e){super(e),this.colorMixMode=null}clone(){const e={color:this.color!=null?this.color.clone():null,colorMixMode:this.colorMixMode};return new WE(e)}};l([Ce({multiply:"multiply",replace:"replace",tint:"tint"})],I1.prototype,"colorMixMode",void 0),I1=WE=l([k("esri.symbols.support.Symbol3DFillMaterial")],I1);function g4(e=ame){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function v4(e,t,r,i,n,s,o=g4()){return o[0]=e,o[1]=t,o[2]=r,o[3]=i,o[4]=n,o[5]=s,o}function y8e(e,t){const r=isFinite(e[2])||isFinite(e[5]);return new Ne(r?{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],zmin:e[2],zmax:e[5],spatialReference:t}:{xmin:e[0],xmax:e[3],ymin:e[1],ymax:e[4],spatialReference:t})}function m8e(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[3]),e[4]=Math.max(e[4],t[4]),e[5]=Math.max(e[5],t[5])}function g8e(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.min(e[2],t[2]),e[3]=Math.max(e[3],t[0]),e[4]=Math.max(e[4],t[1]),e[5]=Math.max(e[5],t[2])}function v8e(e,t,r=0,i=t.length/3){let n=e[0],s=e[1],o=e[2],a=e[3],u=e[4],c=e[5];for(let h=0;h<i;h++)n=Math.min(n,t[r+3*h]),s=Math.min(s,t[r+3*h+1]),o=Math.min(o,t[r+3*h+2]),a=Math.max(a,t[r+3*h]),u=Math.max(u,t[r+3*h+1]),c=Math.max(c,t[r+3*h+2]);e[0]=n,e[1]=s,e[2]=o,e[3]=a,e[4]=u,e[5]=c}function rme(e){return e[0]>=e[3]?0:e[3]-e[0]}function ime(e){return e[1]>=e[4]?0:e[4]-e[1]}function nme(e){return e[2]>=e[5]?0:e[5]-e[2]}function w8e(e,t=[0,0,0]){return t[0]=rme(e),t[1]=ime(e),t[2]=nme(e),t}function b8e(e,t,r=e){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r!==e&&(r[3]=e[3],r[4]=e[4],r[5]=e[5]),r}function _8e(e,t,r=e){return r[3]=t[0],r[4]=t[1],r[5]=t[2],r!==e&&(r[0]=e[0],r[1]=e[1],r[2]=e[2]),e}function sme(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function S8e(e){return e?sme(e,S8):g4(S8)}function x8e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=Number.NEGATIVE_INFINITY,e[3]=t[2],e[4]=t[3],e[5]=Number.POSITIVE_INFINITY,e}function ome(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=Number.NEGATIVE_INFINITY,e[3]=i,e[4]=n,e[5]=Number.POSITIVE_INFINITY,e}function JE(e){return e.length===6}function T8e(e,t,r){if(e==null||t==null)return e===t;if(!JE(e)||!JE(t))return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}const S8=[1/0,1/0,1/0,-1/0,-1/0,-1/0],ame=[0,0,0,0,0,0];g4();const lme=v4(-.5,-.5,-.5,.5,.5,.5),ume=v4(-.5,-.5,0,.5,.5,1),cme=v4(-.5,-.5,0,.5,.5,.5);function I8e(e){switch(e){case"sphere":case"cube":case"diamond":return lme;case"cylinder":case"cone":case"inverted-cone":return ume;case"tetrahedron":return cme;default:return}}const w4=["butt","square","round"],pme=[...w4,"none"],fq=["miter","bevel","round"];var ZE;let Rh=ZE=class extends Q{constructor(e){super(e),this.color=new ve([0,0,0,1]),this.size=Bu(1),this.pattern=null,this.patternCap="butt"}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size,pattern:this.pattern!=null?this.pattern.clone():null,patternCap:this.patternCap};return new ZE(e)}};l([p(Vp)],Rh.prototype,"color",void 0),l([p($l)],Rh.prototype,"size",void 0),l([p(dq)],Rh.prototype,"pattern",void 0),l([p({type:w4,json:{default:"butt",write:{overridePolicy(){return{enabled:this.pattern!=null}}}}})],Rh.prototype,"patternCap",void 0),Rh=ZE=l([k("esri.symbols.support.Symbol3DOutline")],Rh);var e2;let tu=e2=class extends Pl{constructor(e){super(e),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const e={edges:this.edges!=null?this.edges.clone():null,enabled:this.enabled,material:this.material!=null?this.material.clone():null,pattern:this.pattern!=null?this.pattern.clone():null,castShadows:this.castShadows,outline:this.outline!=null?this.outline.clone():null};return new e2(e)}static fromSimpleFillSymbol(e){var i,n,s;const t=e.outline&&e.outline.style&&e.outline.style!=="inside-frame"&&e.outline.style!=="solid"?new m4({style:e.outline.style}):null,r={size:((i=e.outline)==null?void 0:i.width)??0,color:(((n=e.outline)==null?void 0:n.color)??T1).clone(),pattern:t};return t&&((s=e.outline)!=null&&s.cap)&&(r.patternCap=e.outline.cap),new e2({material:new I1({color:(e.color??eme).clone()}),pattern:e.style&&e.style!=="solid"?new hq({style:e.style}):null,outline:r})}};l([Ce({Fill:"fill"},{readOnly:!0})],tu.prototype,"type",void 0),l([p({type:I1,json:{write:!0}})],tu.prototype,"material",void 0),l([p(Qye)],tu.prototype,"pattern",void 0),l([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],tu.prototype,"castShadows",void 0),l([p({type:Rh,json:{write:!0}})],tu.prototype,"outline",void 0),l([p(oq)],tu.prototype,"edges",void 0),tu=e2=l([k("esri.symbols.FillSymbol3DLayer")],tu);const Wv=tu,hme=["none","underline","line-through"],dme=["normal","italic","oblique"],fme=["normal","lighter","bold","bolder"],yq={type:Number,cast:e=>{const t=Ws(e);return t===0?1:ka(t,.1,4)},nonNullable:!0},yme=["left","right","center"],mme=["baseline","top","middle","bottom"],mq={type:yme,nonNullable:!0},gq={type:mme,nonNullable:!0},M8e=8;var YE;let ru=YE=class extends Q{constructor(e){super(e),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(e){return wt(e)}clone(){return new YE({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};l([p({type:hme,json:{default:"none",write:!0}})],ru.prototype,"decoration",void 0),l([p({type:String,json:{write:!0}})],ru.prototype,"family",void 0),l([p({type:Number,json:{write:{overridePolicy:(e,t,r)=>({enabled:!r||!r.textSymbol3D})}}})],ru.prototype,"size",void 0),l([Tt("size")],ru.prototype,"castSize",null),l([p({type:dme,json:{default:"normal",write:!0}})],ru.prototype,"style",void 0),l([p({type:fme,json:{default:"normal",write:!0}})],ru.prototype,"weight",void 0),ru=YE=l([k("esri.symbols.Font")],ru);const uT=ru;function Ym(e,t){var i;const r=(i=t==null?void 0:t.url)==null?void 0:i.path;if(e&&r&&(e=Js(e,r,{preserveProtocolRelative:!0}),t.portalItem&&t.readResourcePaths)){const n=$O(e,t.portalItem.itemUrl);n!=null&&gme.test(n)&&t.readResourcePaths.push(t.portalItem.resourceFromPath(n).path)}return(e=KE(e,t==null?void 0:t.portal))&&cT.test(e)?S4(e):e}function Jv(e,t,r=hv.YES){var n,s;if((e=e&&cT.test(e)?vq(e):e)==null)return e;!Kn(e)&&(t!=null&&t.blockedRelativeUrls)&&t.blockedRelativeUrls.push(e);let i=Js(e);if(t){const o=((n=t.verifyItemRelativeUrls)==null?void 0:n.rootPath)||((s=t.url)==null?void 0:s.path);if(o){const a=KE(o,t.portal),u=KE(i,t.portal);i=$O(u,a,a),i!=null&&i!==u&&i!==e&&t.verifyItemRelativeUrls&&t.verifyItemRelativeUrls.writtenUrls.push(i)}}return i=_4(i,t==null?void 0:t.portal),Kn(i)&&(i=_s(i)),t!=null&&t.resources&&(t!=null&&t.portalItem)&&!Kn(i)&&!wf(i)&&r===hv.YES&&t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(i),compress:!1}),i}function b4(e,t,r){return Ym(e,r)}function cf(e,t,r,i){const n=Jv(e,i);n!==void 0&&(t[r]=n)}const cT=/\/items\/([^\/]+)\/resources\/(.*)/,gme=/^\.\/resources\//;function vme(e){const t=(e==null?void 0:e.match(cT))??null;return(t==null?void 0:t[1])??null}function wme(e){const t=(e==null?void 0:e.match(cT))??null;if(t==null)return null;const r=t[2],i=r.lastIndexOf("/");if(i===-1){const{path:o,extension:a}=cD(r);return{prefix:null,filename:o,extension:a}}const{path:n,extension:s}=cD(r.slice(i+1));return{prefix:r.slice(0,i),filename:n,extension:s}}function _4(e,t){return t&&!t.isPortal&&t.urlKey&&t.customBaseUrl?B$(e,`${t.urlKey}.${t.customBaseUrl}`,t.portalHostname):e}function KE(e,t){if(!t||t.isPortal||!t.urlKey||!t.customBaseUrl)return e;const r=`${t.urlKey}.${t.customBaseUrl}`,i=xO();return mm(i,`${i.scheme}://${r}`)?B$(e,t.portalHostname,r):B$(e,r,t.portalHostname)}function S4(e){if(!e)return e||null;let t=e;return t&&pt&&!pt.findCredential(t)&&(t=pt._normalizeAGOLorgDomain(t),t=t.replace(/^https?:\/\/www\.arcgis\.com/,"https://cdn.arcgis.com"),t=t.replace(/^https?:\/\/devext\.arcgis\.com/,"https://cdndev.arcgis.com"),t=t.replace(/^https?:\/\/qaext\.arcgis\.com/,"https://cdnqa.arcgis.com")),t}function vq(e){if(!e)return e||null;let t=e;return t=t.replace(/^https?:\/\/cdn\.arcgis\.com/,"https://www.arcgis.com"),t=t.replace(/^https?:\/\/cdndev\.arcgis\.com/,"https://devext.arcgis.com"),t=t.replace(/^https?:\/\/cdnqa\.arcgis\.com/,"https://qaext.arcgis.com"),t&&pt&&!pt.findCredential(t)&&(t=pt._normalizeAGOLorgDomain(t)),t}var hv;(function(e){e[e.YES=0]="YES",e[e.NO=1]="NO"})(hv||(hv={}));const $8e=Object.freeze(Object.defineProperty({__proto__:null,get MarkKeep(){return hv},ensureMainOnlineDomain:_4,fromCDNUrl:vq,fromJSON:Ym,itemIdFromResourceUrl:vme,prefixAndFilenameFromResourceUrl:wme,read:b4,toCDNUrl:S4,toJSON:Jv,write:cf},Symbol.toStringTag,{value:"Module"}));var XE;const bme=Qr()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Ch=XE=class extends Q{constructor(e){super(e)}readHref(e,t,r){return e?Ym(e,r):t.dataURI}writeHref(e,t,r,i){e&&(wf(e)?t.dataURI=e:(t.href=Jv(e,i),Kn(t.href)&&(t.href=_s(t.href))))}clone(){return new XE({href:this.href,primitive:this.primitive})}};l([p({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Ch.prototype,"href",void 0),l([te("href")],Ch.prototype,"readHref",null),l([se("href",{href:{type:String},dataURI:{type:String}})],Ch.prototype,"writeHref",null),l([Ce(bme)],Ch.prototype,"primitive",void 0),Ch=XE=l([k("esri.symbols.support.IconSymbol3DLayerResource")],Ch);var QE;let By=QE=class extends De{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new QE({x:this.x,y:this.y})}};l([p({type:Number})],By.prototype,"x",void 0),l([p({type:Number})],By.prototype,"y",void 0),By=QE=l([k("esri.symbols.support.Symbol3DAnchorPosition2D")],By);var eA;let Mg=eA=class extends Q{constructor(e){super(e),this.color=new ve([0,0,0,1]),this.size=Bu(1)}clone(){const e={color:this.color!=null?this.color.clone():null,size:this.size};return new eA(e)}};l([p(Vp)],Mg.prototype,"color",void 0),l([p($l)],Mg.prototype,"size",void 0),Mg=eA=l([k("esri.symbols.support.Symbol3DIconOutline")],Mg);var sy;const wq="esri.symbols.IconSymbol3DLayer";let Ka=sy=class extends Pl{constructor(e){super(e),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=null,this.outline=null}clone(){return new sy({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:this.material!=null?this.material.clone():null,outline:this.outline!=null?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(e){const t=e.color||T1,r=x8(e),i=e.outline&&e.outline.width>0?{size:e.outline.width,color:(e.outline.color||T1).clone()}:null;return new sy({size:e.size,resource:{primitive:Sme(e.style)},material:{color:t},outline:i,anchor:r?"relative":void 0,anchorPosition:r})}static fromPictureMarkerSymbol(e){const t=!e.color||tme(e.color)?T1:e.color,r=x8(e);return new sy({size:e.width<=e.height?e.height:e.width,resource:{href:e.url},material:{color:t.clone()},anchor:r?"relative":void 0,anchorPosition:r})}static fromCIMSymbol(e){return new sy({resource:{href:hG({mediaType:"application/json",data:JSON.stringify(e.data)})}})}};function x8(e){const t="width"in e?e.width:e.size,r="height"in e?e.height:e.size,i=T8(e.xoffset),n=T8(e.yoffset);return(i||n)&&t&&r?{x:-i/t,y:n/r}:null}function T8(e){return isFinite(e)?e:0}l([p({type:Xs,json:{write:!0}})],Ka.prototype,"material",void 0),l([p({type:Ch,json:{write:!0}})],Ka.prototype,"resource",void 0),l([Ce({Icon:"icon"},{readOnly:!0})],Ka.prototype,"type",void 0),l([p($l)],Ka.prototype,"size",void 0),l([Ce({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),p({json:{default:"center"}})],Ka.prototype,"anchor",void 0),l([p({type:By,json:{type:[Number],read:{reader:e=>new By({x:e[0],y:e[1]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],Ka.prototype,"anchorPosition",void 0),l([p({type:Mg,json:{write:!0}})],Ka.prototype,"outline",void 0),Ka=sy=l([k(wq)],Ka);const _me={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Sme(e){return _me[e]||(oe.getLogger(wq).warn(`${e} cannot be mapped to Icon symbol. Fallback to "circle"`),"circle")}const Ed=Ka;function pf(e,t,r=$e){return t||(t=new r),t===e||(t.removeAll(),xme(e)?t.addMany(e):e&&t.add(e)),t}function bq(e){return e}function xme(e){return e&&(Array.isArray(e)||"items"in e&&Array.isArray(e.items))}var ip;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(ip||(ip={}));let Tme=class{constructor(){this._resolver=ro(),this._status=ip.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=ip.RESOLVED,this._cleanUp()},()=>{this._status=ip.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return this._status===ip.RESOLVED}isRejected(){return this._status===ip.REJECTED}isFulfilled(){return this._status!==ip.PENDING}abort(){this._resolver.reject(Pr())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;const t=ro(),r=[...this._resolvingPromises,t.promise],i=this._allPromise=Promise.all(r);i.then(()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve()},n=>{this.isFulfilled()||this._allPromise!==i||Ei(n)||this._resolver.reject(n)}),t.resolve()}};const pT=e=>{let t=class extends e{constructor(...r){super(...r),this._promiseProps=new Tme,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(r,i){return this._promiseProps.promise.then(()=>this).then(r,i)}catch(r){return this.when(null,r)}addResolvingPromise(r){r&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in r?r.when():r)}};return t=l([k("esri.core.Promise")],t),t};let sx=class extends pT(De){};sx=l([k("esri.core.Promise")],sx);const Ime="not-loaded",Mme="loading",$me="failed",I8="loaded",_q=e=>{let t=class extends e{constructor(...r){super(...r),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise(i=>{const n=this.load.bind(this);this.load=s=>{const o=new Promise((a,u)=>{const c=vO(s,u);this.destroyed&&u(new z("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this.when(a,u).finally(()=>{c&&c.remove()})});if(this.loadStatus===Ime){this._set("loadStatus",Mme);const a=this._loadController=new AbortController;n({signal:a.signal})}return i(),o}})),this.when(()=>{this._set("loadStatus",I8),this._loadController=null},i=>{this._set("loadStatus",$me),this._set("loadError",i),this._loadController=null})}destroy(){this._loadController&&(this._loadController=X1(this._loadController),this._promiseProps.abort()),this._set("loadError",null),this._set("loadWarnings",[])}get loaded(){return this.loadStatus===I8}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var r;return this.isFulfilled()||(this._set("loadError",new z("load:cancelled","Cancelled")),(r=this._loadController)==null||r.abort(),this._promiseProps.abort()),this}};return l([p({readOnly:!0})],t.prototype,"loaded",null),l([p({readOnly:!0})],t.prototype,"loadError",void 0),l([p({clonable:!1})],t.prototype,"loadStatus",void 0),l([p({type:[eo],readOnly:!0})],t.prototype,"loadWarnings",null),t=l([k("esri.core.Loadable")],t),t};let $g=class extends _q(sx){};$g=l([k("esri.core.Loadable")],$g),function(e){function t(r){return!(!r||!r.load)}e.LoadableMixin=_q,e.isLoadable=t}($g||($g={}));const El=$g;let Pb;function Eme(e){return Pb&&!Pb.destroyed||(Pb=e()),Pb}var tA;const Ame=new We({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let xo=tA=class extends De{constructor(e){super(e),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(e){e!=="asc"&&e!=="desc"||this._set("sortOrder",e)}clone(){return new tA({categories:this.categories?B(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(e,t){let r=[];this.categories&&(r=this.categories.map(o=>Array.isArray(o)?JSON.stringify(o):o));let i="";if(this.extent){const o=Yx(this.extent,xe.WGS84);o!=null&&(i=`${o.xmin},${o.ymin},${o.xmax},${o.ymax}`)}let n=this.query;!this.disableExtraQuery&&e.extraQuery&&(n="("+n+")"+e.extraQuery);const s={categories:r,bbox:i,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(s.sortField=this.sortField.split(",").map(o=>Ame.toJSON(o.trim())).join(","),s.sortOrder=this.sortOrder),{query:{...t,...s}}}};l([p()],xo.prototype,"categories",void 0),l([p()],xo.prototype,"disableExtraQuery",void 0),l([p({type:Ne})],xo.prototype,"extent",void 0),l([p()],xo.prototype,"filter",void 0),l([p()],xo.prototype,"num",void 0),l([p()],xo.prototype,"query",void 0),l([p()],xo.prototype,"sortField",void 0),l([p()],xo.prototype,"sortOrder",null),l([p()],xo.prototype,"start",void 0),xo=tA=l([k("esri.portal.PortalQueryParams")],xo);const ml=xo;var rA;let si=rA=class extends Q{constructor(e){super(e),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.sourceJSON=null,this.tags=null,this.title=null}get thumbnailUrl(){var r;const e=this.url,t=this.thumbnail;return e&&t&&this.portal?(r=this.portal)==null?void 0:r.normalizeUrl(`${e}/info/${t}?f=json`):null}get url(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?e+"/community/groups/"+this.id:null}fetchCategorySchema(e){return this.portal.request(this.url+"/categorySchema",e).then(t=>{const r=t.categorySchema||[];return r.some(i=>i.source==="contentCategorySetsGroupQuery.LivingAtlas")?this._fetchCategorySchemaSet("LivingAtlas",e):r})}fetchMembers(e){return this.portal.request(this.url+"/users",e)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}toJSON(){throw new z("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new rA;return t.sourceJSON=e,t.read(e),t}queryItems(e,t){let r=Lr(ml,e);const i=this.portal;return parseFloat(i.currentVersion)>5?(r=r||new ml,i.queryPortal(`/content/groups/${this.id}/search`,r,"PortalItem",t)):(r=r?r.clone():new ml,r.query="group:"+this.id+(r.query?" "+r.query:""),i.queryItems(r,t))}_fetchCategorySchemaSet(e,t){const r=this.portal;return r.fetchSelf(r.authMode,!0,t).then(i=>{const n=i.contentCategorySetsGroupQuery;if(n){const s=new ml;return s.disableExtraQuery=!0,s.num=1,s.query=n,r.queryGroups(s,t)}throw new z("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")}).then(i=>{if(i.total){const n=i.results[0],s=new ml;return s.num=1,s.query=`typekeywords:"${e}"`,n.queryItems(s,t)}throw new z("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")}).then(i=>i.total?i.results[0].fetchData("json",t).then(n=>{const s=n==null?void 0:n.categorySchema;return s!=null&&s.length?s:[]}):[])}};l([p()],si.prototype,"access",void 0),l([p({type:Date})],si.prototype,"created",void 0),l([p()],si.prototype,"description",void 0),l([p()],si.prototype,"id",void 0),l([p()],si.prototype,"isInvitationOnly",void 0),l([p({type:Date})],si.prototype,"modified",void 0),l([p()],si.prototype,"owner",void 0),l([p()],si.prototype,"portal",void 0),l([p()],si.prototype,"snippet",void 0),l([p()],si.prototype,"sortField",void 0),l([p()],si.prototype,"sortOrder",void 0),l([p()],si.prototype,"sourceJSON",void 0),l([p()],si.prototype,"tags",void 0),l([p()],si.prototype,"thumbnail",void 0),l([p({readOnly:!0})],si.prototype,"thumbnailUrl",null),l([p()],si.prototype,"title",void 0),l([p({readOnly:!0})],si.prototype,"url",null),si=rA=l([k("esri.portal.PortalGroup")],si);const iA=si;let Oh=class extends De{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};l([p()],Oh.prototype,"nextQueryParams",void 0),l([p()],Oh.prototype,"queryParams",void 0),l([p()],Oh.prototype,"results",void 0),l([p()],Oh.prototype,"total",void 0),Oh=l([k("esri.portal.PortalQueryResult")],Oh);const Rme=Oh;let iu=class extends Q{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){var r;const t=(r=this.portal)==null?void 0:r.restUrl;return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new z("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};l([p({type:Date})],iu.prototype,"created",void 0),l([p()],iu.prototype,"id",void 0),l([p()],iu.prototype,"portal",void 0),l([p()],iu.prototype,"title",void 0),l([p({readOnly:!0})],iu.prototype,"url",null),l([p()],iu.prototype,"username",void 0),iu=l([k("esri.portal.PortalFolder")],iu);const Cme=iu;var nA;let ar=nA=class extends Q{constructor(...e){super(...e),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const e=this.url,t=this.thumbnail;return e&&t?this.portal.normalizeUrl(`${e}/info/${t}?f=json`):null}get userContentUrl(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?`${e}/content/users/${this.username}`:null}get url(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e?`${e}/community/users/${this.username}`:null}addItem(e){const t=e&&e.item,r=e==null?void 0:e.data,i=e==null?void 0:e.folder,n={method:"post"};t&&(n.query=t.createPostQuery(),r!=null&&(typeof r=="string"?n.query.text=r:typeof r=="object"&&(n.query.text=JSON.stringify(r))));let s=this.userContentUrl;return i&&(s+="/"+(typeof i=="string"?i:i.id)),this.portal.request(s+"/addItem",n).then(o=>(t.id=o.id,t.portal=this.portal,t.loaded?t.reload():t.load()))}deleteItem(e){let t=this.userContentUrl;return e.ownerFolder&&(t+="/"+e.ownerFolder),this.portal.request(t+`/items/${e.id}/delete`,{method:"post"}).then(()=>{e.id=null,e.portal=null})}deleteItems(e){const t=this.userContentUrl+"/deleteItems",r=e.map(i=>i.id);if(r.length){const i={method:"post",query:{items:r.join(",")}};return this.portal.request(t,i).then(()=>{e.forEach(n=>{n.id=null,n.portal=null})})}return Promise.resolve(void 0)}fetchFolders(){const e={query:{num:1}};return this.portal.request(this.userContentUrl??"",e).then(t=>{let r;return r=t&&t.folders?t.folders.map(i=>{const n=Cme.fromJSON(i);return n.portal=this.portal,n}):[],r})}fetchGroups(){return this.portal.request(this.url??"").then(e=>{let t;return t=e&&e.groups?e.groups.map(r=>{const i=iA.fromJSON(r);return i.portal=this.portal,i}):[],t})}fetchItems(e){const t=e??{};let r,i=this.userContentUrl??"";return t.folder&&(i+="/"+t.folder.id),ge(()=>Promise.resolve().then(()=>yH),void 0).then(({default:n})=>{r=n;const s={folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"};return this.portal.request(i,{query:s})}).then(n=>{let s;return n!=null&&n.items?(s=n.items.map(o=>{const a=r.fromJSON(o);return a.portal=this.portal,a}),Promise.all(s.map(o=>o.load())).catch(o=>o).then(()=>({items:s,nextStart:n.nextStart,total:n.total}))):{items:[],nextStart:-1,total:0}})}fetchTags(){return this.portal.request(this.url+"/tags").then(e=>e.tags)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}queryFavorites(e){return this.favGroupId?(this._favGroup||(this._favGroup=new iA({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(e)):Promise.reject(new z("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new z("internal:not-yet-implemented","PortalUser.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");const t=new nA;return t.sourceJSON=e,t.read(e),t}};l([p()],ar.prototype,"access",void 0),l([p({type:Date})],ar.prototype,"created",void 0),l([p()],ar.prototype,"culture",void 0),l([p()],ar.prototype,"description",void 0),l([p()],ar.prototype,"email",void 0),l([p()],ar.prototype,"favGroupId",void 0),l([p()],ar.prototype,"fullName",void 0),l([p({type:Date})],ar.prototype,"modified",void 0),l([p()],ar.prototype,"orgId",void 0),l([p()],ar.prototype,"portal",void 0),l([p()],ar.prototype,"preferredView",void 0),l([p()],ar.prototype,"privileges",void 0),l([p()],ar.prototype,"region",void 0),l([p()],ar.prototype,"role",void 0),l([p()],ar.prototype,"roleId",void 0),l([p()],ar.prototype,"sourceJSON",void 0),l([p()],ar.prototype,"thumbnail",void 0),l([p({readOnly:!0})],ar.prototype,"thumbnailUrl",null),l([p()],ar.prototype,"units",void 0),l([p({readOnly:!0})],ar.prototype,"userContentUrl",null),l([p({readOnly:!0})],ar.prototype,"url",null),l([p()],ar.prototype,"username",void 0),l([p()],ar.prototype,"userType",void 0),ar=nA=l([k("esri.portal.PortalUser")],ar);const x4=ar;var Os;let Lb;const M8={PortalGroup:()=>Promise.resolve({default:iA}),PortalItem:()=>ge(()=>Promise.resolve().then(()=>yH),void 0),PortalUser:()=>Promise.resolve({default:x4})};let we=Os=class extends Fv(El){constructor(e){super(e),this._esriIdCredentialCreateHandle=null,this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.basemapGalleryGroupQuery3D=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.layoutGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=Kt.portalUrl,this.urlKey=null,this.user=null,this.use3dBasemaps=!0,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(e){return typeof e=="string"?{url:e}:e}destroy(){$8.unregister(this),this.defaultBasemap=cr(this.defaultBasemap),this.defaultDevBasemap=cr(this.defaultDevBasemap),this.defaultVectorBasemap=cr(this.defaultVectorBasemap),this._esriIdCredentialCreateHandle=Tr(this._esriIdCredentialCreateHandle)}readAuthorizedCrossOriginDomains(e){if(e)for(const t of e)Kt.request.trustedServers.includes(t)||Kt.request.trustedServers.push(t);return e}readDefaultBasemap(e){return this._readBasemap(e)}readDefaultDevBasemap(e){return this._readBasemap(e)}readDefaultVectorBasemap(e){return this._readBasemap(e)}get extraQuery(){var r;const e=(r=this.user)==null?void 0:r.orgId,t=!e||this.canSearchPublic;return this.id&&!t?` AND orgid:${this.id}`:null}get isOrganization(){return!!this.access}get itemPageUrl(){return this.url?`${this.url}/home/item.html`:null}get restUrl(){let e=this.url;if(e){const t=e.indexOf("/sharing");e=t>0?e.substring(0,t):this.url.replace(/\/+$/,""),e+="/sharing/rest"}return e}get thumbnailUrl(){const e=this.restUrl,t=this.thumbnail;return e&&t?this._normalizeSSL(e+"/portals/self/resources/"+t):null}readUrlKey(e){return e&&e.toLowerCase()}readUser(e){let t=null;return e&&(t=x4.fromJSON(e),t.portal=this),t}load(e){const t=ge(()=>Promise.resolve().then(()=>PAe),void 0).then(({default:r})=>{Ut(e),Lb=r}).then(()=>this.sourceJSON?this.sourceJSON:this.fetchSelf(this.authMode,!1,e)).then(r=>{var i;if(pt){const n=pt;this.credential=n.findCredential(this.restUrl),this.credential||this.authMode!==Os.AUTH_MODE_AUTO&&this.authMode!==Os.AUTH_MODE_NO_PROMPT||((i=this._esriIdCredentialCreateHandle)==null||i.remove(),this._esriIdCredentialCreateHandle=n.on("credential-create",Ome(new WeakRef(this))),$8.register(this,this._esriIdCredentialCreateHandle,this))}this.sourceJSON=r,this.read(r)});return this.addResolvingPromise(t),Promise.resolve(this)}async createElevationLayers(){await this.load();const e=this._getHelperService("defaultElevationLayers"),t=(await ge(async()=>{const{default:r}=await import("./ElevationLayer-45tsquUZ.js");return{default:r}},__vite__mapDeps([11,1,2]))).default;return e?e.map(r=>new t({id:r.id,url:r.url})):[]}async fetchBasemaps(e,t){const r=await this._fetchBasemaps(e,t);if((t==null?void 0:t.include3d)===!0&&this.use3dBasemaps!==!1){const i=await this._fetchBasemaps3D(e,t);r.unshift(...i)}return r}fetchCategorySchema(e){return this.hasCategorySchema?this.request(this.restUrl+"/portals/self/categorySchema",e).then(t=>t.categorySchema):to(e)?Promise.reject(Pr()):Promise.resolve([])}fetchFeaturedGroups(e){const t=this.featuredGroups,r=new ml;if(r.num=100,r.sortField="title",t&&t.length){const i=[];for(const n of t)i.push(`(title:"${n.title}" AND owner:${n.owner})`);return r.query=i.join(" OR "),this.queryGroups(r,e).then(n=>n.results)}return to(e)?Promise.reject(Pr()):Promise.resolve([])}fetchRegions(e){var r;const t=((r=this.user)==null?void 0:r.culture)||this.culture||Zs();return this.request(this.restUrl+"/portals/regions",{...e,query:{culture:t}})}fetchSettings(e){var r;const t=((r=this.user)==null?void 0:r.culture)||this.culture||Zs();return this.request(this.restUrl+"/portals/self/settings",{...e,query:{culture:t}})}static getDefault(){return Eme(()=>new Os)}queryGroups(e,t){return this.queryPortal("/community/groups",e,"PortalGroup",t)}queryItems(e,t){return this.queryPortal("/search",e,"PortalItem",t)}queryUsers(e,t){return e.sortField||(e.sortField="username"),this.queryPortal("/community/users",e,"PortalUser",t)}fetchSelf(e=this.authMode,t=!1,r){const i=this.restUrl+"/portals/self",n={authMode:e,query:{culture:Zs().toLowerCase()},withCredentials:!0,...r};return n.authMode==="auto"&&(n.authMode="no-prompt"),t&&(n.query.default=!0),this.request(i,n)}queryPortal(e,t,r,i){const n=Lr(ml,t),s=o=>this.request(this.restUrl+e,{...n.toRequestOptions(this),...i}).then(a=>{const u=n.clone();return u.start=a.nextStart,new Rme({nextQueryParams:u,queryParams:n,total:a.total,results:Os._resultsToTypedArray(o,{portal:this},a,i)})}).then(a=>Promise.all(a.results.map(u=>typeof u.when=="function"?u.when():a)).then(()=>a,u=>(Ti(u),a)));return r&&M8[r]?M8[r]().then(({default:o})=>(Ut(i),s(o))):s()}signIn(){if(this.authMode===Os.AUTH_MODE_ANONYMOUS||this.authMode===Os.AUTH_MODE_NO_PROMPT&&!pt)return Promise.reject(new z("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if(this.loadStatus==="failed")return Promise.reject(this.loadError);const e=t=>Promise.resolve().then(()=>this.loadStatus==="not-loaded"?(t||(this.authMode="immediate"),this.load().then(()=>null)):this.loadStatus==="loading"?this.load().then(()=>this.credential?null:(this.credential=t,this.fetchSelf("immediate"))):this.user&&this.credential===t?null:(this.credential=t,this.fetchSelf("immediate"))).then(r=>{r&&(this.sourceJSON=r,this.read(r))});return pt?pt.getCredential(this.restUrl,{prompt:this.authMode!==Os.AUTH_MODE_NO_PROMPT}).then(t=>e(t)):e(this.credential)}normalizeUrl(e){var r;const t=(r=this.credential)==null?void 0:r.token;return this._normalizeSSL(t?e+(e.includes("?")?"&":"?")+"token="+t:e)}requestToTypedArray(e,t,r){return this.request(e,t).then(i=>{const n=Os._resultsToTypedArray(r,{portal:this},i);return Promise.all(n.map(s=>typeof s.when=="function"?s.when():i)).then(()=>n,()=>n)})}request(e,t={}){const r={f:"json",...t.query},{authMode:i=this.authMode===Os.AUTH_MODE_ANONYMOUS||this.authMode===Os.AUTH_MODE_NO_PROMPT?this.authMode:"auto",body:n=null,cacheBust:s=!1,method:o="auto",responseType:a="json",signal:u}=t,c={authMode:i,body:n,cacheBust:s,method:o,query:r,responseType:a,timeout:0,signal:u};return t.withCredentials&&(c.withCredentials=!0),be(this._normalizeSSL(e),c).then(h=>h.data)}toJSON(){throw new z("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Os({sourceJSON:e})}_getHelperService(e){const t=this.helperServices&&this.helperServices[e];if(!t)throw new z("portal:service-not-found",`The \`helperServices\` do not include an entry named "${e}"`);return t}async _fetchBasemaps(e,t){const r=new ml;r.query=e||(Kt.apiKey&&wG(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),r.disableExtraQuery=!0;const i=await this.queryGroups(r,t);if(!i.total)return[];const n=i.results[0];r.num=100,r.query='type:"Web Map" -type:"Web Application"',r.sortField=n.sortField||"name",r.sortOrder=n.sortOrder||"desc";const s=await n.queryItems(r,t);return s.total?s.results.filter(o=>o.type==="Web Map").map(o=>new Lb({portalItem:o})):[]}async _fetchBasemaps3D(e,t){const r=e||this.basemapGalleryGroupQuery3D;if(!r)return[];const i=new ml({query:r,disableExtraQuery:!0}),n=await this.queryGroups(i,t);if(!n.total)return[];const s=n.results[0];i.num=100,i.query='type:"Web Scene"',i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc";const o=await s.queryItems(i,t);return o.total?o.results.filter(a=>a.type==="Web Scene").map(a=>new Lb({portalItem:a})):[]}_normalizeSSL(e){return e.replace(/^http:/i,"https:").replace(":7080",":7443")}_readBasemap(e){if(e){const t=Lb.fromJSON(e);return t.portalItem={portal:this},t}return null}static _resultsToTypedArray(e,t,r,i){let n=[];if(r){const s=i!=null?i.signal:null;n=r.listings||r.notifications||r.userInvitations||r.tags||r.items||r.groups||r.comments||r.provisions||r.results||r.relatedItems||r,(e||t)&&(n=n.map(o=>{const a=Object.assign(e?e.fromJSON(o):o,t);return typeof a.load=="function"&&a.load(s),a}))}else n=[];return n}};we.AUTH_MODE_ANONYMOUS="anonymous",we.AUTH_MODE_AUTO="auto",we.AUTH_MODE_IMMEDIATE="immediate",we.AUTH_MODE_NO_PROMPT="no-prompt",l([p()],we.prototype,"access",void 0),l([p()],we.prototype,"allSSL",void 0),l([p()],we.prototype,"authMode",void 0),l([p()],we.prototype,"authorizedCrossOriginDomains",void 0),l([te("authorizedCrossOriginDomains")],we.prototype,"readAuthorizedCrossOriginDomains",null),l([p()],we.prototype,"basemapGalleryGroupQuery",void 0),l([p({json:{name:"3DBasemapGalleryGroupQuery"}})],we.prototype,"basemapGalleryGroupQuery3D",void 0),l([p()],we.prototype,"bingKey",void 0),l([p()],we.prototype,"canListApps",void 0),l([p()],we.prototype,"canListData",void 0),l([p()],we.prototype,"canListPreProvisionedItems",void 0),l([p()],we.prototype,"canProvisionDirectPurchase",void 0),l([p()],we.prototype,"canSearchPublic",void 0),l([p()],we.prototype,"canShareBingPublic",void 0),l([p()],we.prototype,"canSharePublic",void 0),l([p()],we.prototype,"canSignInArcGIS",void 0),l([p()],we.prototype,"canSignInIDP",void 0),l([p()],we.prototype,"colorSetsGroupQuery",void 0),l([p()],we.prototype,"commentsEnabled",void 0),l([p({type:Date})],we.prototype,"created",void 0),l([p()],we.prototype,"credential",void 0),l([p()],we.prototype,"culture",void 0),l([p()],we.prototype,"currentVersion",void 0),l([p()],we.prototype,"customBaseUrl",void 0),l([p()],we.prototype,"defaultBasemap",void 0),l([te("defaultBasemap")],we.prototype,"readDefaultBasemap",null),l([p()],we.prototype,"defaultDevBasemap",void 0),l([te("defaultDevBasemap")],we.prototype,"readDefaultDevBasemap",null),l([p({type:Ne})],we.prototype,"defaultExtent",void 0),l([p()],we.prototype,"defaultVectorBasemap",void 0),l([te("defaultVectorBasemap")],we.prototype,"readDefaultVectorBasemap",null),l([p()],we.prototype,"description",void 0),l([p()],we.prototype,"devBasemapGalleryGroupQuery",void 0),l([p()],we.prototype,"eueiEnabled",void 0),l([p({readOnly:!0})],we.prototype,"extraQuery",null),l([p()],we.prototype,"featuredGroups",void 0),l([p()],we.prototype,"featuredItemsGroupQuery",void 0),l([p()],we.prototype,"galleryTemplatesGroupQuery",void 0),l([p()],we.prototype,"layoutGroupQuery",void 0),l([p()],we.prototype,"livingAtlasGroupQuery",void 0),l([p()],we.prototype,"hasCategorySchema",void 0),l([p()],we.prototype,"helpBase",void 0),l([p()],we.prototype,"helperServices",void 0),l([p()],we.prototype,"helpMap",void 0),l([p()],we.prototype,"homePageFeaturedContent",void 0),l([p()],we.prototype,"homePageFeaturedContentCount",void 0),l([p()],we.prototype,"httpPort",void 0),l([p()],we.prototype,"httpsPort",void 0),l([p()],we.prototype,"id",void 0),l([p()],we.prototype,"ipCntryCode",void 0),l([p({readOnly:!0})],we.prototype,"isOrganization",null),l([p()],we.prototype,"isPortal",void 0),l([p()],we.prototype,"isReadOnly",void 0),l([p({readOnly:!0})],we.prototype,"itemPageUrl",null),l([p()],we.prototype,"layerTemplatesGroupQuery",void 0),l([p()],we.prototype,"maxTokenExpirationMinutes",void 0),l([p({type:Date})],we.prototype,"modified",void 0),l([p()],we.prototype,"name",void 0),l([p()],we.prototype,"portalHostname",void 0),l([p()],we.prototype,"portalMode",void 0),l([p()],we.prototype,"portalProperties",void 0),l([p()],we.prototype,"region",void 0),l([p({readOnly:!0})],we.prototype,"restUrl",null),l([p()],we.prototype,"rotatorPanels",void 0),l([p()],we.prototype,"showHomePageDescription",void 0),l([p()],we.prototype,"sourceJSON",void 0),l([p()],we.prototype,"staticImagesUrl",void 0),l([p({json:{name:"2DStylesGroupQuery"}})],we.prototype,"stylesGroupQuery2d",void 0),l([p({json:{name:"stylesGroupQuery"}})],we.prototype,"stylesGroupQuery3d",void 0),l([p()],we.prototype,"supportsHostedServices",void 0),l([p()],we.prototype,"symbolSetsGroupQuery",void 0),l([p()],we.prototype,"templatesGroupQuery",void 0),l([p()],we.prototype,"thumbnail",void 0),l([p({readOnly:!0})],we.prototype,"thumbnailUrl",null),l([p()],we.prototype,"units",void 0),l([p()],we.prototype,"url",void 0),l([p()],we.prototype,"urlKey",void 0),l([te("urlKey")],we.prototype,"readUrlKey",null),l([p()],we.prototype,"user",void 0),l([te("user")],we.prototype,"readUser",null),l([p()],we.prototype,"use3dBasemaps",void 0),l([p()],we.prototype,"useStandardizedQuery",void 0),l([p()],we.prototype,"useVectorBasemaps",void 0),l([p()],we.prototype,"vectorBasemapGalleryGroupQuery",void 0),we=Os=l([k("esri.portal.Portal")],we);const ts=we,$8=new FinalizationRegistry(e=>{e.remove()});function Ome(e){const t=pt;return()=>{const r=e.deref();r&&t.findCredential(r.restUrl)&&r.signIn().catch(()=>{})}}let Ph=class extends It(Q){constructor(t){super(t),this.type="style",this.placement="begin-end",this.style="arrow",this.color=null}equals(t){return t!=null&&t.placement===this.placement&&t.style===this.style&&(this.color==null&&t.color==null||this.color!=null&&t.color!=null&&this.color.toJSON()===t.color.toJSON())}};l([p({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Ph.prototype,"type",void 0),l([p({type:Jye,json:{default:"begin-end",write:!0}})],Ph.prototype,"placement",void 0),l([p({type:lq,json:{default:"arrow",write:!0}})],Ph.prototype,"style",void 0),l([p({type:ve,json:{type:[Ke],default:null,write:!0}})],Ph.prototype,"color",void 0),Ph=l([k("esri.symbols.LineStyleMarker3D")],Ph);const sA=Ph;var t2;let Xa=t2=class extends Pl{constructor(e){super(e),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=Bu(1),this.pattern=null,this.marker=null}clone(){const e={enabled:this.enabled,material:this.material!=null?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:this.pattern!=null?this.pattern.clone():null,marker:this.marker!=null?this.marker.clone():null};return new t2(e)}static fromSimpleLineSymbol(e){var r;const t={enabled:!0,size:e.width??Bu(1),cap:e.cap||"butt",join:e.join||"miter",pattern:e.style&&e.style!=="inside-frame"?new m4({style:e.style}):null,material:new Xs({color:(e.color||T1).clone()}),marker:e.marker?new sA({placement:e.marker.placement,style:e.marker.style,color:((r=e.marker.color)==null?void 0:r.clone())??null}):null};return new t2(t)}};l([p({type:Xs,json:{write:!0}})],Xa.prototype,"material",void 0),l([Ce({Line:"line"},{readOnly:!0})],Xa.prototype,"type",void 0),l([p({type:fq,json:{write:!0,default:"miter"}})],Xa.prototype,"join",void 0),l([p({type:w4,json:{write:!0,default:"butt"}})],Xa.prototype,"cap",void 0),l([p($l)],Xa.prototype,"size",void 0),l([p(dq)],Xa.prototype,"pattern",void 0),l([p({types:{key:"type",base:sA,typeMap:{style:sA}},json:{write:!0}})],Xa.prototype,"marker",void 0),Xa=t2=l([k("esri.symbols.LineSymbol3DLayer")],Xa);const Zv=Xa;var oA;const Pme=Qr()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let Eg=oA=class extends Q{clone(){return new oA({href:this.href,primitive:this.primitive})}};l([p({type:String,json:{read:b4,write:cf}})],Eg.prototype,"href",void 0),l([Ce(Pme)],Eg.prototype,"primitive",void 0),Eg=oA=l([k("esri.symbols.support.ObjectSymbol3DLayerResource")],Eg);var aA;let gd=aA=class extends De{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new aA({x:this.x,y:this.y,z:this.z})}};l([p({type:Number})],gd.prototype,"x",void 0),l([p({type:Number})],gd.prototype,"y",void 0),l([p({type:Number})],gd.prototype,"z",void 0),gd=aA=l([k("esri.symbols.support.Symbol3DAnchorPosition3D")],gd);var lA;let dn=lA=class extends Pl{constructor(e){super(e),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){var e,t,r;return new lA({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:(e=this.anchorPosition)==null?void 0:e.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:((t=this.material)==null?void 0:t.clone())??null,castShadows:this.castShadows,resource:(r=this.resource)==null?void 0:r.clone(),width:this.width})}get isPrimitive(){return!this.resource||typeof this.resource.href!="string"}};l([p({type:Xs,json:{write:!0}})],dn.prototype,"material",void 0),l([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],dn.prototype,"castShadows",void 0),l([p({type:Eg,json:{write:!0}})],dn.prototype,"resource",void 0),l([Ce({Object:"object"},{readOnly:!0})],dn.prototype,"type",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"width",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"height",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"depth",void 0),l([Ce({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),p({json:{default:"origin"}})],dn.prototype,"anchor",void 0),l([p({type:gd,json:{type:[Number],read:{reader:e=>new gd({x:e[0],y:e[1],z:e[2]})},write:{writer:(e,t)=>{t.anchorPosition=[e.x,e.y,e.z]},overridePolicy(){return{enabled:this.anchor==="relative"}}}}})],dn.prototype,"anchorPosition",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"heading",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"tilt",void 0),l([p({type:Number,json:{write:!0}})],dn.prototype,"roll",void 0),l([p({readOnly:!0})],dn.prototype,"isPrimitive",null),dn=lA=l([k("esri.symbols.ObjectSymbol3DLayer")],dn);const T4=dn;var uA;let Vn=uA=class extends Pl{constructor(e){super(e),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(e,t){return e??(t.height==null&&t.size!=null?t.size:void 0)}readHeight(e,t){return e??(t.width==null&&t.size!=null?t.size:void 0)}clone(){return new uA({enabled:this.enabled,material:this.material!=null?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};l([p({type:Xs,json:{write:!0}})],Vn.prototype,"material",void 0),l([p({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Vn.prototype,"castShadows",void 0),l([Ce({Path:"path"},{readOnly:!0})],Vn.prototype,"type",void 0),l([p({type:["circle","quad"],json:{write:!0,default:"circle"}})],Vn.prototype,"profile",void 0),l([p({type:fq,json:{write:!0,default:"miter"}})],Vn.prototype,"join",void 0),l([p({type:pme,json:{write:!0,default:"butt"}})],Vn.prototype,"cap",void 0),l([p({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],Vn.prototype,"width",void 0),l([te("width",["width","size","height"])],Vn.prototype,"readWidth",null),l([p({type:Number,json:{write:!0}})],Vn.prototype,"height",void 0),l([te("height",["height","size","width"])],Vn.prototype,"readHeight",null),l([p({type:["center","bottom","top"],json:{write:!0,default:"center"}})],Vn.prototype,"anchor",void 0),l([p({type:["heading","all"],json:{write:!0,default:"all"}})],Vn.prototype,"profileRotation",void 0),Vn=uA=l([k("esri.symbols.PathSymbol3DLayer")],Vn);const I4=Vn;var cA;let zy=cA=class extends Q{constructor(){super(...arguments),this.color=new ve([0,0,0,1]),this.size=0}clone(){const e={color:B(this.color),size:this.size};return new cA(e)}};l([p(Vp)],zy.prototype,"color",void 0),l([p($l)],zy.prototype,"size",void 0),zy=cA=l([k("esri.symbols.support.Symbol3DHalo")],zy);let M1=class extends It(Q){constructor(t){super(t),this.color=null}};l([p(Vp)],M1.prototype,"color",void 0),M1=l([k("esri.symbols.support.Symbol3DTextBackground")],M1);var r2;let us=r2=class extends Pl{constructor(e){super(e),this._userSize=void 0,this.halo=null,this.horizontalAlignment="center",this.lineHeight=1,this.material=null,this.background=null,this.text=null,this.type="text",this.verticalAlignment="baseline"}get font(){return this._get("font")||null}set font(e){e!=null&&this._userSize!=null&&(e.size=this._userSize),this._set("font",e)}writeFont(e,t,r,i){const n={...i,textSymbol3D:!0};t.font=e.write({},n),delete t.font.size}get size(){var e;return this._userSize!=null?this._userSize:((e=this.font)==null?void 0:e.size)!=null?this.font.size:9}set size(e){this._userSize=e,this.font!=null&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){const e=new r2({enabled:this.enabled,font:this.font&&B(this.font),halo:this.halo&&B(this.halo),horizontalAlignment:this.horizontalAlignment,lineHeight:this.lineHeight,material:this.material!=null?this.material.clone():null,text:this.text,verticalAlignment:this.verticalAlignment,background:B(this.background)});return e._userSize=this._userSize,e}static fromTextSymbol(e){return new r2({font:e.font!=null?e.font.clone():new uT,halo:Lme(e.haloColor,e.haloSize),horizontalAlignment:e.horizontalAlignment,lineHeight:e.lineHeight,material:e.color?new Xs({color:e.color.clone()}):null,text:e.text,verticalAlignment:e.verticalAlignment,background:e.backgroundColor?new M1({color:e.backgroundColor.clone()}):null})}};function Lme(e,t){return e&&t!=null&&t>0?new zy({color:B(e),size:t}):null}l([p({type:uT,json:{write:!0}})],us.prototype,"font",null),l([se("font")],us.prototype,"writeFont",null),l([p({type:zy,json:{write:!0}})],us.prototype,"halo",void 0),l([p({...mq,json:{default:"center",write:!0}})],us.prototype,"horizontalAlignment",void 0),l([p({...yq,json:{default:1,write:!0}})],us.prototype,"lineHeight",void 0),l([p({type:Xs,json:{write:!0}})],us.prototype,"material",void 0),l([p({type:M1,json:{write:!0}})],us.prototype,"background",void 0),l([p($l)],us.prototype,"size",null),l([p({type:String,json:{write:!0}})],us.prototype,"text",void 0),l([Ce({Text:"text"},{readOnly:!0})],us.prototype,"type",void 0),l([p({...gq,json:{default:"baseline",write:!0}})],us.prototype,"verticalAlignment",void 0),us=r2=l([k("esri.symbols.TextSymbol3DLayer")],us);const Km=us;var pA;let $c=pA=class extends Pl{constructor(e){super(e),this.color=hA.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new pA({color:B(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};l([p({type:ve,nonNullable:!0,json:{type:[Ke],write:(e,t,r)=>t[r]=e.toArray(ve.AlphaMode.UNLESS_OPAQUE),default:()=>hA.clone(),defaultEquals:e=>e.toCss(!0)===hA.toCss(!0)}})],$c.prototype,"color",void 0),l([Ce({Water:"water"},{readOnly:!0})],$c.prototype,"type",void 0),l([p({type:["small","medium","large"],json:{write:!0,default:"medium"}})],$c.prototype,"waterbodySize",void 0),l([p({type:Number,json:{write:!0,default:null}})],$c.prototype,"waveDirection",void 0),l([p({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],$c.prototype,"waveStrength",void 0),$c=pA=l([k("esri.symbols.WaterSymbol3DLayer")],$c);const hA=new ve([0,119,190]),Sq=$c;var dA;let Lh=dA=class extends De{constructor(e){super(e),this.name=null,this.styleUrl=null,this.styleName=null,this.portal=null}clone(){return new dA({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};l([p({type:String})],Lh.prototype,"name",void 0),l([p({type:String})],Lh.prototype,"styleUrl",void 0),l([p({type:String})],Lh.prototype,"styleName",void 0),l([p({type:ts})],Lh.prototype,"portal",void 0),Lh=dA=l([k("esri.symbols.support.StyleOrigin")],Lh);const fA=Lh;var yA;let $1=yA=class extends De{constructor(){super(...arguments),this.url=""}clone(){return new yA({url:this.url})}};l([p({type:String})],$1.prototype,"url",void 0),$1=yA=l([k("esri.symbols.support.Thumbnail")],$1);const xq={icon:Ed,object:T4,line:Zv,path:I4,fill:Wv,extrude:aq,text:Km,water:Sq},kme=$e.ofType({base:Pl,key:"type",typeMap:xq,errorContext:"symbol-layer"});let Qa=class extends Ts{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const r=this.__accessor__&&this.__accessor__.metadata&&this.__accessor__.metadata.symbolLayers,i=r==null?void 0:r.type,n=i||$e;this._set("symbolLayers",new n)}get color(){return null}set color(t){this.constructed&&oe.getLogger(this).error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){pf(t,this._get("symbolLayers"))}readStyleOrigin(t,r,i){if(t.styleUrl&&t.name){const n=Ym(t.styleUrl,i);return new fA({styleUrl:n,name:t.name})}if(t.styleName&&t.name)return new fA({portal:(i==null?void 0:i.portal)||ts.getDefault(),styleName:t.styleName,name:t.name});i!=null&&i.messages&&i.messages.push(new eo("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,r,i,n){if(t.styleUrl&&t.name){let s=Jv(t.styleUrl,n);Kn(s)&&(s=_s(s)),r.styleOrigin={styleUrl:s,name:t.name}}else t.styleName&&t.name&&(t.portal&&(n!=null&&n.portal)&&!cG(t.portal.restUrl,n.portal.restUrl)?n!=null&&n.messages&&n.messages.push(new eo("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):r.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof Pl||t&&xq[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};l([p({json:{read:!1,write:!1}})],Qa.prototype,"color",null),l([p({type:kme,nonNullable:!0,json:{write:!0}}),Tt(bq)],Qa.prototype,"symbolLayers",null),l([p({type:fA})],Qa.prototype,"styleOrigin",void 0),l([te("styleOrigin")],Qa.prototype,"readStyleOrigin",null),l([se("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Qa.prototype,"writeStyleOrigin",null),l([p({type:$1,json:{read:!1}})],Qa.prototype,"thumbnail",void 0),l([p({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Qa.prototype,"type",void 0),Qa=l([k("esri.symbols.Symbol3D")],Qa);const Xm=Qa;let Ag=class extends Q{constructor(t){super(t),this.visible=!0}clone(){}};l([p({type:["line"],constructOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],Ag.prototype,"type",void 0),l([p({readOnly:!0})],Ag.prototype,"visible",void 0),Ag=l([k("esri.symbols.callouts.Callout3D")],Ag);const Tq=Ag;var mA;let i2=mA=class extends Q{constructor(e){super(e),this.color=new ve("white")}clone(){return new mA({color:B(this.color)})}};l([p(Vp)],i2.prototype,"color",void 0),i2=mA=l([k("esri.symbols.callouts.LineCallout3DBorder")],i2);const Nme=i2;var gA;let Ec=gA=class extends Tq{constructor(e){super(e),this.type="line",this.color=new ve([0,0,0,1]),this.size=Bu(1),this.border=null}get visible(){return this.size>0&&this.color!=null&&this.color.a>0}clone(){return new gA({color:B(this.color),size:this.size,border:B(this.border)})}};l([Ce({line:"line"})],Ec.prototype,"type",void 0),l([p(Vp)],Ec.prototype,"color",void 0),l([p($l)],Ec.prototype,"size",void 0),l([p({type:Nme,json:{write:!0}})],Ec.prototype,"border",void 0),l([p({readOnly:!0})],Ec.prototype,"visible",null),Ec=gA=l([k("esri.symbols.callouts.LineCallout3D")],Ec);const Iq=Ec;function M4(e){if(!e)return!1;const t=e.verticalOffset;return!!t&&!(t.screenLength<=0||t.maxWorldLength!=null&&t.maxWorldLength<=0)}function Mq(e){if(!e||!e.supportsCallout||!e.supportsCallout())return!1;const t=e.callout;return!!t&&!!t.visible&&!!M4(e)}const $q={types:{key:"type",base:Tq,typeMap:{line:Iq}},json:{write:!0}};var vA;let oy=vA=class extends Q{constructor(e){super(e),this.screenLength=0,this.minWorldLength=0,this.maxWorldLength=null}clone(){return new vA({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};l([p($l)],oy.prototype,"screenLength",void 0),l([p({type:Number,nonNullable:!0,json:{write:!0,default:0}})],oy.prototype,"minWorldLength",void 0),l([p({type:Number,json:{write:!0}})],oy.prototype,"maxWorldLength",void 0),oy=vA=l([k("esri.symbols.support.Symbol3DVerticalOffset")],oy);const $4=oy;var n2;const Eq=$e.ofType({base:null,key:"type",typeMap:{text:Km}});let Ac=n2=class extends Xm{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new Eq,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Mq(this)}hasVisibleVerticalOffset(){return M4(this)}clone(){return new n2({styleOrigin:B(this.styleOrigin),symbolLayers:B(this.symbolLayers),thumbnail:B(this.thumbnail),callout:B(this.callout),verticalOffset:B(this.verticalOffset)})}static fromTextSymbol(e){return new n2({symbolLayers:new $e([Km.fromTextSymbol(e)])})}};l([p({type:$4,json:{write:!0}})],Ac.prototype,"verticalOffset",void 0),l([p($q)],Ac.prototype,"callout",void 0),l([p({json:{read:!1,write:!1}})],Ac.prototype,"styleOrigin",void 0),l([p({type:Eq})],Ac.prototype,"symbolLayers",void 0),l([Ce({LabelSymbol3D:"label-3d"},{readOnly:!0})],Ac.prototype,"type",void 0),Ac=n2=l([k("esri.symbols.LabelSymbol3D")],Ac);const hT=Ac;var s2;const Aq=$e.ofType({base:null,key:"type",typeMap:{line:Zv,path:I4}}),Dme=$e.ofType({base:null,key:"type",typeMap:{line:Zv,path:I4}});let Rg=s2=class extends Xm{constructor(e){super(e),this.symbolLayers=new Aq,this.type="line-3d"}clone(){return new s2({styleOrigin:B(this.styleOrigin),symbolLayers:B(this.symbolLayers),thumbnail:B(this.thumbnail)})}static fromSimpleLineSymbol(e){return new s2({symbolLayers:new $e([Zv.fromSimpleLineSymbol(e)])})}};l([p({type:Aq,json:{type:Dme}})],Rg.prototype,"symbolLayers",void 0),l([Ce({LineSymbol3D:"line-3d"},{readOnly:!0})],Rg.prototype,"type",void 0),Rg=s2=l([k("esri.symbols.LineSymbol3D")],Rg);const dT=Rg;let Rc=class extends Ts{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};l([p({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],Rc.prototype,"angle",void 0),l([p({type:["simple-marker","picture-marker"],readOnly:!0})],Rc.prototype,"type",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],Rc.prototype,"xoffset",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],Rc.prototype,"yoffset",void 0),l([p({type:Number,cast:e=>e==="auto"?e:wt(e),json:{write:!0}})],Rc.prototype,"size",void 0),Rc=l([k("esri.symbols.MarkerSymbol")],Rc);const Rq=Rc;var o2;const Cq=$e.ofType({base:null,key:"type",typeMap:{fill:Wv}});let Cg=o2=class extends Xm{constructor(e){super(e),this.symbolLayers=new Cq,this.type="mesh-3d"}clone(){return new o2({styleOrigin:B(this.styleOrigin),symbolLayers:B(this.symbolLayers),thumbnail:B(this.thumbnail)})}static fromSimpleFillSymbol(e){return new o2({symbolLayers:new $e([Wv.fromSimpleFillSymbol(e)])})}};l([p({type:Cq})],Cg.prototype,"symbolLayers",void 0),l([Ce({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],Cg.prototype,"type",void 0),Cg=o2=l([k("esri.symbols.MeshSymbol3D")],Cg);const fT=Cg;function Fme(e,t,r){return t.imageData?hG({mediaType:t.contentType||"image/png",isBase64:!0,data:t.imageData}):Oq(t.url,r)}function Oq(e,t){if(!Kn(e)){const r=Ume(t);if(r)return jo(r,"images",e)}return Ym(e,t)}function jme(e,t,r,i){if(wf(e)){const n=iv(e);if(!n)return;t.contentType=n.mediaType,t.imageData=n.data,r&&r.imageData===t.imageData&&r.url&&cf(r.url,t,"url",i)}else cf(e,t,"url",i)}const Pq={json:{read:{source:["imageData","url"],reader:Fme},write:{writer(e,t,r,i){jme(e,t,this.source,i)}}}},Lq={readOnly:!0,json:{read:{source:["imageData","url"],reader(e,t,r){const i={};return t.imageData&&(i.imageData=t.imageData),t.contentType&&(i.contentType=t.contentType),t.url&&(i.url=Oq(t.url,r)),i}}}};function Ume(e){var n,s;if(!e)return null;const{origin:t,layer:r}=e;if(t!=="service"&&t!=="portal-item")return null;const i=r==null?void 0:r.type;return i==="feature"||i==="stream"?(n=r.parsedUrl)==null?void 0:n.path:i==="map-image"||i==="tile"?(s=e.url)==null?void 0:s.path:null}var wA;let To=wA=class extends uq{constructor(...e){super(...e),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(e,t,r,i){if(e&&typeof e!="string"&&e.imageData==null)return e;const n={};return e&&(n.url=e),t&&(n.outline=t),r!=null&&(n.width=wt(r)),i!=null&&(n.height=wt(i)),n}clone(){const e=new wA({color:B(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return e._set("source",B(this.source)),e}hash(){var e;return`${super.hash()}.${(e=this.color)==null?void 0:e.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};l([Ce({esriPFS:"picture-fill"},{readOnly:!0})],To.prototype,"type",void 0),l([p(Pq)],To.prototype,"url",void 0),l([p({type:Number,json:{write:!0}})],To.prototype,"xscale",void 0),l([p({type:Number,json:{write:!0}})],To.prototype,"yscale",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],To.prototype,"width",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],To.prototype,"height",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],To.prototype,"xoffset",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],To.prototype,"yoffset",void 0),l([p(Lq)],To.prototype,"source",void 0),To=wA=l([k("esri.symbols.PictureFillSymbol")],To);const kq=To;var bA;let ia=bA=class extends Rq{constructor(...e){super(...e),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(e,t,r){if(e&&typeof e!="string"&&e.imageData==null)return e;const i={};return e&&(i.url=e),t!=null&&(i.width=wt(t)),r!=null&&(i.height=wt(r)),i}readHeight(e,t){return t.size||e}readWidth(e,t){return t.size||e}clone(){const e=new bA({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return e._set("source",B(this.source)),e}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};l([p({json:{write:!1}})],ia.prototype,"color",void 0),l([Ce({esriPMS:"picture-marker"},{readOnly:!0})],ia.prototype,"type",void 0),l([p(Pq)],ia.prototype,"url",void 0),l([p(Lq)],ia.prototype,"source",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],ia.prototype,"height",void 0),l([te("height",["height","size"])],ia.prototype,"readHeight",null),l([p({type:Number,cast:wt,json:{write:!0}})],ia.prototype,"width",void 0),l([p({json:{write:!1}})],ia.prototype,"size",void 0),ia=bA=l([k("esri.symbols.PictureMarkerSymbol")],ia);const qd=ia;var kh;const Nq=$e.ofType({base:null,key:"type",typeMap:{icon:Ed,object:T4,text:Km}});let Nh=kh=class extends Xm{constructor(e){super(e),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Nq,this.type="point-3d"}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const e of this.symbolLayers.items)switch(e.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Mq(this)}hasVisibleVerticalOffset(){return M4(this)}clone(){return new kh({verticalOffset:B(this.verticalOffset),callout:B(this.callout),styleOrigin:B(this.styleOrigin),symbolLayers:B(this.symbolLayers),thumbnail:B(this.thumbnail)})}static fromSimpleMarkerSymbol(e){return new kh({symbolLayers:new $e([Ed.fromSimpleMarkerSymbol(e)])})}static fromPictureMarkerSymbol(e){return new kh({symbolLayers:new $e([Ed.fromPictureMarkerSymbol(e)])})}static fromCIMSymbol(e){var i,n;if(((n=(i=e.data)==null?void 0:i.symbol)==null?void 0:n.type)!=="CIMPointSymbol")return null;const r=e.data.symbol;return new kh(r!=null&&r.callout?{symbolLayers:new $e([Ed.fromCIMSymbol(e)]),callout:new Iq({size:.5,color:new ve([0,0,0])}),verticalOffset:new $4({screenLength:40})}:{symbolLayers:new $e([Ed.fromCIMSymbol(e)])})}static fromTextSymbol(e){return new kh({symbolLayers:new $e([Km.fromTextSymbol(e)])})}};l([p({type:$4,json:{write:!0}})],Nh.prototype,"verticalOffset",void 0),l([p($q)],Nh.prototype,"callout",void 0),l([p({type:Nq,json:{origins:{"web-scene":{write:!0}}}})],Nh.prototype,"symbolLayers",void 0),l([Ce({PointSymbol3D:"point-3d"},{readOnly:!0})],Nh.prototype,"type",void 0),Nh=kh=l([k("esri.symbols.PointSymbol3D")],Nh);const Ad=Nh;function Vme(e,t,r){return wO(e.map((i,n)=>t.apply(r,[i,n])))}async function Gme(e,t,r){return(await wO(e.map((i,n)=>t.apply(r,[i,n])))).map(i=>i.value)}function E4(e){return{ok:!0,value:e}}function A4(e){return{ok:!1,error:e}}function Bme(e){return e!=null&&e.ok===!0?e.value:null}function zme(e){return e!=null&&e.ok===!1?e.error:null}async function yT(e){if(e==null)return{ok:!1,error:new Error("no promise provided")};try{return E4(await e)}catch(t){return A4(t)}}async function qme(e){try{return E4(await e)}catch(t){return Ti(t),A4(t)}}function mT(e,t){return new Cc(e,t)}let Cc=class extends De{get value(){return Bme(this._result)}get error(){return zme(this._result)}get finished(){return this._result!=null}constructor(t,r){super({}),this._result=null,this._abortHandle=null,this.abort=()=>{this._abortController=X1(this._abortController)},this.remove=this.abort,this._abortController=new AbortController;const{signal:i}=this._abortController;this.promise=t(i),this.promise.then(n=>{this._result=E4(n),this._cleanup()},n=>{this._result=A4(n),this._cleanup()}),this._abortHandle=bs(r,this.abort)}normalizeCtorArgs(){return{}}destroy(){this.abort()}_cleanup(){this._abortHandle=Tr(this._abortHandle),this._abortController=null}};l([p()],Cc.prototype,"value",null),l([p()],Cc.prototype,"error",null),l([p()],Cc.prototype,"finished",null),l([p()],Cc.prototype,"promise",void 0),l([p()],Cc.prototype,"_result",void 0),Cc=l([k("esri.core.asyncUtils.ReactiveTask")],Cc);function Ue(e,t,r={}){return R4(e,t,r,Dq)}function hf(e,t,r={}){return R4(e,t,r,Fq)}function R4(e,t,r={},i){let n=null;const s=r.once?(o,a)=>{i(o)&&(Tr(n),t(o,a))}:(o,a)=>{i(o)&&t(o,a)};if(n=ble(e,s,r.sync,r.equals),r.initial){const o=e();s(o,o)}return n}function rs(e,t,r,i={}){let n=null,s=null,o=null;function a(){var h;n&&s&&(s.remove(),(h=i.onListenerRemove)==null||h.call(i,n),n=null,s=null)}function u(h){i.once&&i.once&&Tr(o),r(h)}const c=Ue(e,(h,d)=>{var y;a(),Vx(h)&&(n=h,s=Dv(h,t,u),(y=i.onListenerAdd)==null||y.call(i,h))},{sync:i.sync,initial:!0});return o=Xt(()=>{c.remove(),a()}),o}function gT(e,t){return Hme(e,Fq,t)}function Hme(e,t,r){if(to(r))return Promise.reject(Pr());const i=e();if(t!=null&&t(i))return Promise.resolve(i);let n=null;function s(){n=Tr(n)}return new Promise((o,a)=>{n=Lv([bs(r,()=>{s(),a(Pr())}),R4(e,u=>{s(),o(u)},{sync:!1,once:!0},t??Dq)])})}function Dq(e){return!0}function Fq(e){return!!e}const di={sync:!0},Xi={initial:!0},Ta={sync:!0,initial:!0};var Og;const jq=$e.ofType({base:null,key:"type",typeMap:{extrude:aq,fill:Wv,icon:Ed,line:Zv,object:T4,text:Km,water:Sq}});let Pg=Og=class extends Xm{constructor(e){super(e),this.symbolLayers=new jq,this.type="polygon-3d"}initialize(){const e=t=>{t.type==="line"&&fm(oe.getLogger(this),"LineSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use FillSymbol3DLayer.outline instead.",version:"4.28"}),t.type==="text"&&fm(oe.getLogger(this),"TextSymbol3DLayer can not be used as a SymbolLayer with a PolygonSymbol3D symbol anymore.",{replacement:"Use Labels instead.",version:"4.28"})};for(const t of this.symbolLayers)e(t);this.addHandles(rs(()=>this.symbolLayers,"after-add",({item:t})=>e(t),di))}clone(){return new Og({styleOrigin:B(this.styleOrigin),symbolLayers:B(this.symbolLayers),thumbnail:B(this.thumbnail)})}static fromJSON(e){var r;const t=new Og;if(t.read(e),t.symbolLayers.length===2&&t.symbolLayers.at(0).type==="fill"&&t.symbolLayers.at(1).type==="line"){const i=t.symbolLayers.at(0),n=t.symbolLayers.at(1);!n.enabled||(r=e.symbolLayers)!=null&&r[1]&&e.symbolLayers[1].enable===!1||(i.outline={size:n.size,color:n.material!=null?n.material.color:null}),t.symbolLayers.removeAt(1)}return t}static fromSimpleFillSymbol(e){return new Og({symbolLayers:new $e([Wv.fromSimpleFillSymbol(e)])})}};l([p({type:jq,json:{write:!0}})],Pg.prototype,"symbolLayers",void 0),l([Ce({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Pg.prototype,"type",void 0),Pg=Og=l([k("esri.symbols.PolygonSymbol3D")],Pg);const Yv=Pg;var _A;const tM=new We({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Dh=_A=class extends uq{constructor(...e){super(...e),this.color=new ve([0,0,0,.25]),this.outline=new oo,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(e,t,r){if(e&&typeof e!="string")return e;const i={};return e&&(i.style=e),t&&(i.outline=t),r&&(i.color=r),i}clone(){return new _A({color:B(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};l([p()],Dh.prototype,"color",void 0),l([p()],Dh.prototype,"outline",void 0),l([Ce({esriSFS:"simple-fill"},{readOnly:!0})],Dh.prototype,"type",void 0),l([p({type:tM.apiValues,json:{read:tM.read,write:tM.write}})],Dh.prototype,"style",void 0),Dh=_A=l([k("esri.symbols.SimpleFillSymbol")],Dh);const _f=Dh;var SA;const rM=new We({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let el=SA=class extends Rq{constructor(...e){super(...e),this.color=new ve([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new oo}normalizeCtorArgs(e,t,r,i){if(e&&typeof e!="string")return e;const n={};return e&&(n.style=e),t!=null&&(n.size=wt(t)),r&&(n.outline=r),i&&(n.color=i),n}writeColor(e,t){e&&this.style!=="x"&&this.style!=="cross"&&(t.color=e.toJSON()),e===null&&(t.color=null)}set path(e){this.style="path",this._set("path",e)}clone(){return new SA({angle:this.angle,color:B(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${(e=this.outline)==null?void 0:e.hash()}`}};l([p()],el.prototype,"color",void 0),l([se("color")],el.prototype,"writeColor",null),l([Ce({esriSMS:"simple-marker"},{readOnly:!0})],el.prototype,"type",void 0),l([p()],el.prototype,"size",void 0),l([p({type:rM.apiValues,json:{read:rM.read,write:rM.write}})],el.prototype,"style",void 0),l([p({type:String,json:{write:!0}})],el.prototype,"path",null),l([p({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":oo}},json:{default:null,write:!0}})],el.prototype,"outline",void 0),el=SA=l([k("esri.symbols.SimpleMarkerSymbol")],el);const Ll=el;var xA;let fr=xA=class extends Ts{constructor(...e){super(...e),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new uT,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment="baseline",this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(e,t,r){if(e&&typeof e!="string")return e;const i={};return e&&(i.text=e),t&&(i.font=t),r&&(i.color=r),i}writeLineWidth(e,t,r,i){i&&typeof i!="string"?i.origin:t[r]=e}castLineWidth(e){return wt(e)}writeLineHeight(e,t,r,i){i&&typeof i!="string"?i.origin:t[r]=e}clone(){return new xA({angle:this.angle,backgroundColor:B(this.backgroundColor),borderLineColor:B(this.borderLineColor),borderLineSize:this.borderLineSize,color:B(this.color),font:this.font&&this.font.clone(),haloColor:B(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var e,t,r;return`${(e=this.backgroundColor)==null?void 0:e.hash()}.${this.borderLineColor}.${this.borderLineSize}.${(t=this.color)==null?void 0:t.hash()}.${this.font&&this.font.hash()}.${(r=this.haloColor)==null?void 0:r.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};l([p({type:ve,json:{write:!0}})],fr.prototype,"backgroundColor",void 0),l([p({type:ve,json:{write:!0}})],fr.prototype,"borderLineColor",void 0),l([p({type:Number,json:{write:!0},cast:wt})],fr.prototype,"borderLineSize",void 0),l([p({type:uT,json:{write:!0}})],fr.prototype,"font",void 0),l([p({...mq,json:{write:!0}})],fr.prototype,"horizontalAlignment",void 0),l([p({type:Boolean,json:{write:!0}})],fr.prototype,"kerning",void 0),l([p({type:ve,json:{write:!0}})],fr.prototype,"haloColor",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],fr.prototype,"haloSize",void 0),l([p({type:Boolean,json:{write:!0}})],fr.prototype,"rightToLeft",void 0),l([p({type:Boolean,json:{write:!0}})],fr.prototype,"rotated",void 0),l([p({type:String,json:{write:!0}})],fr.prototype,"text",void 0),l([Ce({esriTS:"text"},{readOnly:!0})],fr.prototype,"type",void 0),l([p({...gq,json:{write:!0}})],fr.prototype,"verticalAlignment",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],fr.prototype,"xoffset",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],fr.prototype,"yoffset",void 0),l([p({type:Number,json:{read:e=>e&&-1*e,write:(e,t)=>t.angle=e&&-1*e}})],fr.prototype,"angle",void 0),l([p({type:Number,json:{write:!0}})],fr.prototype,"width",void 0),l([p({type:Number})],fr.prototype,"lineWidth",void 0),l([se("lineWidth")],fr.prototype,"writeLineWidth",null),l([Tt("lineWidth")],fr.prototype,"castLineWidth",null),l([p(yq)],fr.prototype,"lineHeight",void 0),l([se("lineHeight")],fr.prototype,"writeLineHeight",null),fr=xA=l([k("esri.symbols.TextSymbol")],fr);const Qm=fr;var TA;let na=TA=class extends Ts{constructor(e){super(e),this.color=null,this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}get _fetchCacheKey(){const e=this.portal!=null?this.portal:ts.getDefault(),t=e.user?e.user.username:null;return`${this.styleName}:${this.styleUrl}:${this.name}:${t}:${e.url}`}read(e,t){this.portal=t==null?void 0:t.portal,super.read(e,t)}clone(){return new TA({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(e){return this._fetchSymbol("webRef",e)}fetchCIMSymbol(e){return this._fetchSymbol("cimRef",e)}async _fetchSymbol(e,t){const r=t!=null?t.cache:null,i=r?this._fetchCacheKey:null;if(r!=null){const a=i&&r.get(i);if(a)return a.clone()}const{resolveWebStyleSymbol:n}=await ge(()=>import("./webStyleSymbolUtils-CndX2Vh9.js"),__vite__mapDeps([12,13,1,2]));Ut(t);const s=n(this,{portal:this.portal},e,t);s.catch(a=>{oe.getLogger(this).error("#fetchSymbol()","Failed to create symbol from style",a)});const o=await s;return e==="webRef"&&o.type==="point-3d"||e==="cimRef"&&o.type==="cim"?(r!=null&&r.set(i,o.clone()),o):null}};l([p({json:{write:!1}})],na.prototype,"color",void 0),l([p({type:String,json:{write:!0}})],na.prototype,"styleName",void 0),l([p({type:ts,json:{write:!1}})],na.prototype,"portal",void 0),l([p({type:String,json:{read:b4,write:cf}})],na.prototype,"styleUrl",void 0),l([p({type:$1,json:{read:!1}})],na.prototype,"thumbnail",void 0),l([p({type:String,json:{write:!0}})],na.prototype,"name",void 0),l([Ce({styleSymbolReference:"web-style"},{readOnly:!0})],na.prototype,"type",void 0),l([p()],na.prototype,"_fetchCacheKey",null),na=TA=l([k("esri.symbols.WebStyleSymbol")],na);const Sf=na;function vT(e){if(!e)return!1;switch(e.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function df(e){if(!e)return!1;switch(e.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Hd={base:Ts,key:"type",typeMap:{"simple-fill":_f,"picture-fill":kq,"picture-marker":qd,"simple-line":oo,"simple-marker":Ll,text:Qm,"label-3d":hT,"line-3d":dT,"mesh-3d":fT,"point-3d":Ad,"polygon-3d":Yv,"web-style":Sf,cim:Hv},errorContext:"symbol"},Wme={base:Ts,key:"type",typeMap:{"picture-marker":qd,"simple-marker":Ll,text:Qm,"web-style":Sf,cim:Hv},errorContext:"symbol"},Jme=Vm({types:Hd}),Uq={base:Ts,key:"type",typeMap:{"simple-fill":_f,"picture-fill":kq,"picture-marker":qd,"simple-line":oo,"simple-marker":Ll,text:Qm,"line-3d":dT,"mesh-3d":fT,"point-3d":Ad,"polygon-3d":Yv,"web-style":Sf,cim:Hv},errorContext:"symbol"},Zme={base:Ts,key:"type",typeMap:{text:Qm,"label-3d":hT},errorContext:"symbol"},E8={base:Ts,key:"type",typeMap:{"line-3d":dT,"mesh-3d":fT,"point-3d":Ad,"polygon-3d":Yv,"web-style":Sf,cim:Hv},errorContext:"symbol"},Yme={base:Ts,key:"type",typeMap:{"label-3d":hT},errorContext:"symbol"},Vq=Tl(Hd);var IA;function Kme(e){if(!e)return null;const t={};for(const r in e){const i=Xr(e[r]);i&&(t[r]=i)}return Object.keys(t).length!==0?t:null}function Xme(e){if(e==null)return null;const t={};for(const r in e){const i=e[r];i&&(t[r]=i.toJSON())}return Object.keys(t).length!==0?t:null}let Gn=IA=class extends It(Q){constructor(...e){super(...e),this.isAggregate=!1,this.layer=null,this.origin=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:m1(),configurable:!0})}normalizeCtorArgs(e,t,r,i){return e&&!e.declaredClass?e:{geometry:e,symbol:t,attributes:r,popupTemplate:i}}set aggregateGeometries(e){const t=this._get("aggregateGeometries");JSON.stringify(t)!==JSON.stringify(e)&&this._set("aggregateGeometries",e)}set attributes(e){const t=this._get("attributes");t!==e&&(this._set("attributes",e),this._notifyLayer("attributes",t,e))}set geometry(e){const t=this._get("geometry");t!==e&&(this._set("geometry",e),this._notifyLayer("geometry",t,e))}set symbol(e){const t=this._get("symbol");t!==e&&(this._set("symbol",e),this._notifyLayer("symbol",t,e))}set visible(e){const t=this._get("visible");t!==e&&(this._set("visible",e),this._notifyLayer("visible",t,e))}cloneShallow(){return new IA({aggregateGeometries:this.aggregateGeometries,attributes:this.attributes,geometry:this.geometry,isAggregate:this.isAggregate,layer:this.layer,popupTemplate:this.popupTemplate,sourceLayer:this.sourceLayer,symbol:this.symbol,visible:this.visible,origin:this.origin})}getEffectivePopupTemplate(e=!1){if(this.popupTemplate)return this.popupTemplate;const t=this.origin&&"layer"in this.origin?this.origin.layer:null;for(const r of[t,this.sourceLayer,this.layer])if(r){if("popupTemplate"in r&&r.popupTemplate)return r.popupTemplate;if(e&&"defaultPopupTemplate"in r&&r.defaultPopupTemplate!=null)return r.defaultPopupTemplate}return null}getAttribute(e){var t;return(t=this.attributes)==null?void 0:t[e]}setAttribute(e,t){if(this.attributes){const r=this.getAttribute(e);this.attributes[e]=t,this._notifyLayer("attributes",r,t,e)}else this.attributes={[e]:t},this._notifyLayer("attributes",void 0,t,e)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){var e;return{aggregateGeometries:Xme(this.aggregateGeometries),geometry:this.geometry!=null?this.geometry.toJSON():null,symbol:this.symbol!=null?this.symbol.toJSON():null,attributes:rv(this.attributes)?this.attributes.toJSON():{...this.attributes},popupTemplate:((e=this.popupTemplate)==null?void 0:e.toJSON())??null}}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}notifyMeshTransformChanged(e={}){const{geometry:t}=this;if((t==null?void 0:t.type)==="mesh"){const r={origin:t.origin,transform:t.transform};this._notifyLayer("origin-transform",r,r,e.action)}}_notifyLayer(e,t,r,i){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:e,oldValue:t,newValue:r};e==="origin-transform"&&(n.action=i),e==="attributes"&&(n.attributeName=i),this.layer.graphicChanged(n)}};l([p({value:null,json:{read:Kme}})],Gn.prototype,"aggregateGeometries",null),l([p({value:null})],Gn.prototype,"attributes",null),l([p({value:null,types:Vi,json:{read:Xr}})],Gn.prototype,"geometry",null),l([p({type:Boolean})],Gn.prototype,"isAggregate",void 0),l([p({clonable:"reference"})],Gn.prototype,"layer",void 0),l([p({clonable:"reference"})],Gn.prototype,"origin",void 0),l([p({type:Up})],Gn.prototype,"popupTemplate",void 0),l([p({clonable:"reference"})],Gn.prototype,"sourceLayer",void 0),l([p({value:null,types:Hd})],Gn.prototype,"symbol",null),l([p({type:Boolean,value:!0})],Gn.prototype,"visible",null),Gn=IA=l([k("esri.Graphic")],Gn),function(e){e.generateUID=m1}(Gn||(Gn={}));const Da=Gn;let ay=class extends $e{constructor(t){super(t),this.getCollections=null}initialize(){this.addHandles(WV(()=>this._refresh()))}destroy(){this.getCollections=null}_refresh(){const t=this.getCollections!=null?this.getCollections():null;if(t==null)return void this.removeAll();let r=0;for(const i of t)i!=null&&(r=this._processCollection(r,i));this.splice(r,this.length)}_createNewInstance(t){return new $e(t)}_processCollection(t,r){if(!r)return t;const i=this.itemFilterFunction??(n=>!!n);for(const n of r)if(n){if(i(n)){const s=this.indexOf(n,t);s>=0?s!==t&&this.reorder(n,t):this.add(n,t),++t}if(this.getChildrenFunction){const s=this.getChildrenFunction(n);if(Array.isArray(s))for(const o of s)t=this._processCollection(t,o);else t=this._processCollection(t,s)}}return t}};l([p()],ay.prototype,"getCollections",void 0),l([p()],ay.prototype,"getChildrenFunction",void 0),l([p()],ay.prototype,"itemFilterFunction",void 0),ay=l([k("esri.core.CollectionFlattener")],ay);const ff=ay;let Qme=class Gq{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(P$),this._values=new Map,this.multipleOriginsSupported=!0}clone(t){const r=new Gq,i=this._originStores[_e.DEFAULTS];i&&i.forEach((n,s)=>{r.set(s,B(n),_e.DEFAULTS)});for(let n=_e.SERVICE;n<P$;n++){const s=this._originStores[n];s&&s.forEach((o,a)=>{t&&t.has(a)||r.set(a,B(o),n)})}return r}get(t,r){const i=r===void 0?this._values:this._originStores[r];return i?i.get(t):void 0}keys(t){const r=t==null?this._values:this._originStores[t];return r?[...r.keys()]:[]}set(t,r,i=_e.USER){let n=this._originStores[i];if(n||(n=new Map,this._originStores[i]=n),n.set(t,r),!this._values.has(t)||this._propertyOriginMap.get(t)<=i){const s=this._values.get(t);return this._values.set(t,r),this._propertyOriginMap.set(t,i),s!==r}return!1}delete(t,r=_e.USER){const i=this._originStores[r];if(!i)return;const n=i.get(t);if(i.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===r){this._values.delete(t);for(let s=r-1;s>=0;s--){const o=this._originStores[s];if(o&&o.has(t)){this._values.set(t,o.get(t)),this._propertyOriginMap.set(t,s);break}}}return n}has(t,r){const i=r===void 0?this._values:this._originStores[r];return!!i&&i.has(t)}revert(t,r){for(;r>0&&!this.has(t,r);)--r;const i=this._originStores[r],n=i==null?void 0:i.get(t),s=this._values.get(t);return this._values.set(t,n),this._propertyOriginMap.set(t,r),s!==n}originOf(t){return this._propertyOriginMap.get(t)||_e.DEFAULTS}forEach(t){this._values.forEach(t)}};const Bq=e=>{let t=class extends e{constructor(...r){super(...r);const i=Mi(this),n=i.store,s=new Qme;i.store=s,eG(i,n,s)}read(r,i){rG(this,r,i)}getAtOrigin(r,i){const n=iM(this),s=Zn(i);if(typeof r=="string")return n.get(r,s);const o={};return r.forEach(a=>{o[a]=n.get(a,s)}),o}originOf(r){return Q1(this.originIdOf(r))}originIdOf(r){return iM(this).originOf(r)}revert(r,i){const n=iM(this),s=Zn(i),o=Mi(this);let a;a=typeof r=="string"?r==="*"?n.keys(s):[r]:r,a.forEach(u=>{o.invalidate(u),n.revert(u,s),o.commit(u)})}};return t=l([k("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function iM(e){return Mi(e).store}let A8=class extends Bq(De){};A8=l([k("esri.core.ReadOnlyMultiOriginJSONSupport")],A8);const e0e=e=>{let t=class extends e{constructor(...r){super(...r)}clear(r,i="user"){return nM(this).delete(r,Zn(i))}write(r,i){return sG(this,r=r||{},i),r}setAtOrigin(r,i,n){Mi(this).setAtOrigin(r,i,Zn(n))}removeOrigin(r){const i=nM(this),n=Zn(r),s=i.keys(n);for(const o of s)i.originOf(o)===n&&i.set(o,i.get(o,n),_e.USER)}updateOrigin(r,i){const n=nM(this),s=Zn(i),o=Ra(this,r);for(let a=s+1;a<P$;++a)n.delete(r,a);n.set(r,o,s)}toJSON(r){return this.write({},r)}};return t=l([k("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function nM(e){return Mi(e).store}const kl=e=>{let t=class extends e0e(Bq(e)){constructor(...r){super(...r)}};return t=l([k("esri.core.MultiOriginJSONSupport")],t),t};let MA=class extends kl(De){};MA=l([k("esri.core.MultiOriginJSONSupport")],MA);const zq=96;function $A(e,t){const r=e.extent,i=e.width,n=Wu(r==null?void 0:r.spatialReference);return r&&i?r.width/i*n*AG*zq:0}function G8e(e,t){return e/(Wu(t)*AG*zq)}function t0e(e,t,r){return r0e(e,t)&&i0e(e,r)}function r0e(e,t){return t===0||w1(e,t)||e<t}function i0e(e,t){return t===0||w1(e,t)||e>t}async function n0e(e){const t="portalItem"in e?e:{portalItem:e},{fromItem:r}=await ge(async()=>{const{fromItem:i}=await import("./portalLayers-DknmRNeC.js").then(n=>n.p);return{fromItem:i}},__vite__mapDeps([14,15,16,1,2]));try{return await r(t)}catch(i){const n=t&&t.portalItem,s=(n==null?void 0:n.id)||"unset",o=n&&n.portal&&n.portal.url||Kt.portalUrl;throw oe.getLogger("esri.layers.support.fromPortalItem").error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+o+"', id: '"+s+"')",i),i}}let s0e=0,oi=class extends Zu.EventedMixin(qv(El)){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Ne(-180,-90,180,90,xe.WGS84),this.id=Date.now().toString(16)+"-layer-"+s0e++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.persistenceEnabled=!1,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=xe.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const r=typeof t=="string"?{url:t}:t;return(await ge(async()=>{const{fromUrl:i}=await import("./arcgisLayers-BcberGB7.js");return{fromUrl:i}},__vite__mapDeps([17,1,2,15,18,16]))).fromUrl(r)}static fromPortalItem(t){return n0e(t)}initialize(){this.when().catch(t=>{Ei(t)||oe.getLogger(this).error("#load()",`Failed to load layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}')`,{error:t})})}destroy(){const t=this.parent;if(t){const r=this;"layers"in t&&t.layers.includes(r)?t.layers.remove(r):"tables"in t&&t.tables.includes(r)?t.tables.remove(r):"baseLayers"in t&&t.baseLayers.includes(r)?t.baseLayers.remove(r):"referenceLayers"in t&&t.referenceLayers.includes(r)&&t.referenceLayers.remove(r),this._set("parent",null)}}get hasAttributionData(){return this.attributionDataUrl!=null}get parsedUrl(){return Pt(this.url)}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await be(t,{query:{f:"json"},responseType:"json"})).data;throw new z("layer:no-attribution-data","Layer does not have attribution data")}};l([p({type:String})],oi.prototype,"attributionDataUrl",void 0),l([p({type:Ne})],oi.prototype,"fullExtent",void 0),l([p({readOnly:!0})],oi.prototype,"hasAttributionData",null),l([p({type:String,clonable:!1})],oi.prototype,"id",void 0),l([p({type:Boolean,nonNullable:!0})],oi.prototype,"legendEnabled",void 0),l([p({type:["show","hide","hide-children"]})],oi.prototype,"listMode",void 0),l([p({type:Number,range:{min:0,max:1},nonNullable:!0})],oi.prototype,"opacity",void 0),l([p({clonable:!1})],oi.prototype,"parent",void 0),l([p({readOnly:!0})],oi.prototype,"parsedUrl",null),l([p({type:Boolean,readOnly:!0})],oi.prototype,"persistenceEnabled",void 0),l([p({type:Boolean})],oi.prototype,"popupEnabled",void 0),l([p({type:Boolean})],oi.prototype,"attributionVisible",void 0),l([p({type:xe})],oi.prototype,"spatialReference",void 0),l([p({type:String})],oi.prototype,"title",void 0),l([p({readOnly:!0,json:{read:!1}})],oi.prototype,"type",void 0),l([p()],oi.prototype,"url",void 0),l([p({type:Boolean,nonNullable:!0})],oi.prototype,"visible",void 0),oi=l([k("esri.layers.Layer")],oi);const Yu=oi;function wT(){const e=new Float32Array(16);return e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function o0e(e){const t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a0e(e,t,r,i,n,s,o,a,u,c,h,d,y,v,w,b){const _=new Float32Array(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=i,_[4]=n,_[5]=s,_[6]=o,_[7]=a,_[8]=u,_[9]=c,_[10]=h,_[11]=d,_[12]=y,_[13]=v,_[14]=w,_[15]=b,_}function l0e(e,t){return new Float32Array(e,t,16)}const u0e=wT();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:u0e,clone:o0e,create:wT,createView:l0e,fromValues:a0e},Symbol.toStringTag,{value:"Module"}));function c0e(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Gp(e,t,r,i,n,s,o,a,u,c,h,d,y,v,w,b,_){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=o,e[6]=a,e[7]=u,e[8]=c,e[9]=h,e[10]=d,e[11]=y,e[12]=v,e[13]=w,e[14]=b,e[15]=_,e}function bT(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bp(e,t){if(e===t){const r=t[1],i=t[2],n=t[3],s=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=s,e[11]=t[14],e[12]=n,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function p0e(e,t){return qq(e,t)||bT(e),e}function qq(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],h=t[8],d=t[9],y=t[10],v=t[11],w=t[12],b=t[13],_=t[14],x=t[15],T=r*a-i*o,I=r*u-n*o,M=r*c-s*o,$=i*u-n*a,A=i*c-s*a,R=n*c-s*u,L=h*b-d*w,C=h*_-y*w,U=h*x-v*w,F=d*_-y*b,j=d*x-v*b,q=y*x-v*_;let K=T*q-I*j+M*F+$*U-A*C+R*L;return K?(K=1/K,e[0]=(a*q-u*j+c*F)*K,e[1]=(n*j-i*q-s*F)*K,e[2]=(b*R-_*A+x*$)*K,e[3]=(y*A-d*R-v*$)*K,e[4]=(u*U-o*q-c*C)*K,e[5]=(r*q-n*U+s*C)*K,e[6]=(_*M-w*R-x*I)*K,e[7]=(h*R-y*M+v*I)*K,e[8]=(o*j-a*U+c*L)*K,e[9]=(i*U-r*j-s*L)*K,e[10]=(w*A-b*M+x*T)*K,e[11]=(d*M-h*A-v*T)*K,e[12]=(a*C-o*F-u*L)*K,e[13]=(r*F-i*C+n*L)*K,e[14]=(b*I-w*$-_*T)*K,e[15]=(h*$-d*I+y*T)*K,e):null}function h0e(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],h=t[8],d=t[9],y=t[10],v=t[11],w=t[12],b=t[13],_=t[14],x=t[15];return e[0]=a*(y*x-v*_)-d*(u*x-c*_)+b*(u*v-c*y),e[1]=-(i*(y*x-v*_)-d*(n*x-s*_)+b*(n*v-s*y)),e[2]=i*(u*x-c*_)-a*(n*x-s*_)+b*(n*c-s*u),e[3]=-(i*(u*v-c*y)-a*(n*v-s*y)+d*(n*c-s*u)),e[4]=-(o*(y*x-v*_)-h*(u*x-c*_)+w*(u*v-c*y)),e[5]=r*(y*x-v*_)-h*(n*x-s*_)+w*(n*v-s*y),e[6]=-(r*(u*x-c*_)-o*(n*x-s*_)+w*(n*c-s*u)),e[7]=r*(u*v-c*y)-o*(n*v-s*y)+h*(n*c-s*u),e[8]=o*(d*x-v*b)-h*(a*x-c*b)+w*(a*v-c*d),e[9]=-(r*(d*x-v*b)-h*(i*x-s*b)+w*(i*v-s*d)),e[10]=r*(a*x-c*b)-o*(i*x-s*b)+w*(i*c-s*a),e[11]=-(r*(a*v-c*d)-o*(i*v-s*d)+h*(i*c-s*a)),e[12]=-(o*(d*_-y*b)-h*(a*_-u*b)+w*(a*y-u*d)),e[13]=r*(d*_-y*b)-h*(i*_-n*b)+w*(i*y-n*d),e[14]=-(r*(a*_-u*b)-o*(i*_-n*b)+w*(i*u-n*a)),e[15]=r*(a*y-u*d)-o*(i*y-n*d)+h*(i*u-n*a),e}function d0e(e){const t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],h=e[9],d=e[10],y=e[11],v=e[12],w=e[13],b=e[14],_=e[15];return(t*o-r*s)*(d*_-y*b)-(t*a-i*s)*(h*_-y*w)+(t*u-n*s)*(h*b-d*w)+(r*a-i*o)*(c*_-y*v)-(r*u-n*o)*(c*b-d*v)+(i*u-n*a)*(c*w-h*v)}function Hq(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],h=t[7],d=t[8],y=t[9],v=t[10],w=t[11],b=t[12],_=t[13],x=t[14],T=t[15];let I=r[0],M=r[1],$=r[2],A=r[3];return e[0]=I*i+M*a+$*d+A*b,e[1]=I*n+M*u+$*y+A*_,e[2]=I*s+M*c+$*v+A*x,e[3]=I*o+M*h+$*w+A*T,I=r[4],M=r[5],$=r[6],A=r[7],e[4]=I*i+M*a+$*d+A*b,e[5]=I*n+M*u+$*y+A*_,e[6]=I*s+M*c+$*v+A*x,e[7]=I*o+M*h+$*w+A*T,I=r[8],M=r[9],$=r[10],A=r[11],e[8]=I*i+M*a+$*d+A*b,e[9]=I*n+M*u+$*y+A*_,e[10]=I*s+M*c+$*v+A*x,e[11]=I*o+M*h+$*w+A*T,I=r[12],M=r[13],$=r[14],A=r[15],e[12]=I*i+M*a+$*d+A*b,e[13]=I*n+M*u+$*y+A*_,e[14]=I*s+M*c+$*v+A*x,e[15]=I*o+M*h+$*w+A*T,e}function f0e(e,t,r){const i=r[0],n=r[1],s=r[2];if(t===e)e[12]=t[0]*i+t[4]*n+t[8]*s+t[12],e[13]=t[1]*i+t[5]*n+t[9]*s+t[13],e[14]=t[2]*i+t[6]*n+t[10]*s+t[14],e[15]=t[3]*i+t[7]*n+t[11]*s+t[15];else{const o=t[0],a=t[1],u=t[2],c=t[3],h=t[4],d=t[5],y=t[6],v=t[7],w=t[8],b=t[9],_=t[10],x=t[11];e[0]=o,e[1]=a,e[2]=u,e[3]=c,e[4]=h,e[5]=d,e[6]=y,e[7]=v,e[8]=w,e[9]=b,e[10]=_,e[11]=x,e[12]=o*i+h*n+w*s+t[12],e[13]=a*i+d*n+b*s+t[13],e[14]=u*i+y*n+_*s+t[14],e[15]=c*i+v*n+x*s+t[15]}return e}function y0e(e,t,r){const i=r[0],n=r[1],s=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*n,e[6]=t[6]*n,e[7]=t[7]*n,e[8]=t[8]*s,e[9]=t[9]*s,e[10]=t[10]*s,e[11]=t[11]*s,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function m0e(e,t,r,i){let n,s,o,a,u,c,h,d,y,v,w,b,_,x,T,I,M,$,A,R,L,C,U,F,j=i[0],q=i[1],K=i[2],X=Math.sqrt(j*j+q*q+K*K);return X<Bo()?null:(X=1/X,j*=X,q*=X,K*=X,n=Math.sin(r),s=Math.cos(r),o=1-s,a=t[0],u=t[1],c=t[2],h=t[3],d=t[4],y=t[5],v=t[6],w=t[7],b=t[8],_=t[9],x=t[10],T=t[11],I=j*j*o+s,M=q*j*o+K*n,$=K*j*o-q*n,A=j*q*o-K*n,R=q*q*o+s,L=K*q*o+j*n,C=j*K*o+q*n,U=q*K*o-j*n,F=K*K*o+s,e[0]=a*I+d*M+b*$,e[1]=u*I+y*M+_*$,e[2]=c*I+v*M+x*$,e[3]=h*I+w*M+T*$,e[4]=a*A+d*R+b*L,e[5]=u*A+y*R+_*L,e[6]=c*A+v*R+x*L,e[7]=h*A+w*R+T*L,e[8]=a*C+d*U+b*F,e[9]=u*C+y*U+_*F,e[10]=c*C+v*U+x*F,e[11]=h*C+w*U+T*F,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function g0e(e,t,r){const i=Math.sin(r),n=Math.cos(r),s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],h=t[9],d=t[10],y=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=s*n+c*i,e[5]=o*n+h*i,e[6]=a*n+d*i,e[7]=u*n+y*i,e[8]=c*n-s*i,e[9]=h*n-o*i,e[10]=d*n-a*i,e[11]=y*n-u*i,e}function v0e(e,t,r){const i=Math.sin(r),n=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[8],h=t[9],d=t[10],y=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n-c*i,e[1]=o*n-h*i,e[2]=a*n-d*i,e[3]=u*n-y*i,e[8]=s*i+c*n,e[9]=o*i+h*n,e[10]=a*i+d*n,e[11]=u*i+y*n,e}function w0e(e,t,r){const i=Math.sin(r),n=Math.cos(r),s=t[0],o=t[1],a=t[2],u=t[3],c=t[4],h=t[5],d=t[6],y=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=s*n+c*i,e[1]=o*n+h*i,e[2]=a*n+d*i,e[3]=u*n+y*i,e[4]=c*n-s*i,e[5]=h*n-o*i,e[6]=d*n-a*i,e[7]=y*n-u*i,e}function b0e(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function _0e(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function S0e(e,t,r){if(t===0)return bT(e);let i,n,s,o=r[0],a=r[1],u=r[2],c=Math.sqrt(o*o+a*a+u*u);return c<Bo()?null:(c=1/c,o*=c,a*=c,u*=c,i=Math.sin(t),n=Math.cos(t),s=1-n,e[0]=o*o*s+n,e[1]=a*o*s+u*i,e[2]=u*o*s-a*i,e[3]=0,e[4]=o*a*s-u*i,e[5]=a*a*s+n,e[6]=u*a*s+o*i,e[7]=0,e[8]=o*u*s+a*i,e[9]=a*u*s-o*i,e[10]=u*u*s+n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function x0e(e,t){const r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function T0e(e,t){const r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function I0e(e,t){const r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Wq(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=i+i,u=n+n,c=s+s,h=i*a,d=i*u,y=i*c,v=n*u,w=n*c,b=s*c,_=o*a,x=o*u,T=o*c;return e[0]=1-(v+b),e[1]=d+T,e[2]=y-x,e[3]=0,e[4]=d-T,e[5]=1-(h+b),e[6]=w+_,e[7]=0,e[8]=y+x,e[9]=w-_,e[10]=1-(h+v),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function M0e(e,t){const r=$0e,i=-t[0],n=-t[1],s=-t[2],o=t[3],a=t[4],u=t[5],c=t[6],h=t[7],d=i*i+n*n+s*s+o*o;return d>0?(r[0]=2*(a*o+h*i+u*s-c*n)/d,r[1]=2*(u*o+h*n+c*i-a*s)/d,r[2]=2*(c*o+h*s+a*n-u*i)/d):(r[0]=2*(a*o+h*i+u*s-c*n),r[1]=2*(u*o+h*n+c*i-a*s),r[2]=2*(c*o+h*s+a*n-u*i)),Wq(e,t,r),e}const $0e=Fp();function E0e(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function A0e(e,t){const r=t[0],i=t[1],n=t[2],s=t[4],o=t[5],a=t[6],u=t[8],c=t[9],h=t[10];return e[0]=Math.sqrt(r*r+i*i+n*n),e[1]=Math.sqrt(s*s+o*o+a*a),e[2]=Math.sqrt(u*u+c*c+h*h),e}function R0e(e,t){const r=t[0]+t[5]+t[10];let i=0;return r>0?(i=2*Math.sqrt(r+1),e[3]=.25*i,e[0]=(t[6]-t[9])/i,e[1]=(t[8]-t[2])/i,e[2]=(t[1]-t[4])/i):t[0]>t[5]&&t[0]>t[10]?(i=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/i,e[0]=.25*i,e[1]=(t[1]+t[4])/i,e[2]=(t[8]+t[2])/i):t[5]>t[10]?(i=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/i,e[0]=(t[1]+t[4])/i,e[1]=.25*i,e[2]=(t[6]+t[9])/i):(i=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/i,e[0]=(t[8]+t[2])/i,e[1]=(t[6]+t[9])/i,e[2]=.25*i),e}function C0e(e,t,r,i){const n=t[0],s=t[1],o=t[2],a=t[3],u=n+n,c=s+s,h=o+o,d=n*u,y=n*c,v=n*h,w=s*c,b=s*h,_=o*h,x=a*u,T=a*c,I=a*h,M=i[0],$=i[1],A=i[2];return e[0]=(1-(w+_))*M,e[1]=(y+I)*M,e[2]=(v-T)*M,e[3]=0,e[4]=(y-I)*$,e[5]=(1-(d+_))*$,e[6]=(b+x)*$,e[7]=0,e[8]=(v+T)*A,e[9]=(b-x)*A,e[10]=(1-(d+w))*A,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function O0e(e,t,r,i,n){const s=t[0],o=t[1],a=t[2],u=t[3],c=s+s,h=o+o,d=a+a,y=s*c,v=s*h,w=s*d,b=o*h,_=o*d,x=a*d,T=u*c,I=u*h,M=u*d,$=i[0],A=i[1],R=i[2],L=n[0],C=n[1],U=n[2],F=(1-(b+x))*$,j=(v+M)*$,q=(w-I)*$,K=(v-M)*A,X=(1-(y+x))*A,ne=(_+T)*A,re=(w+I)*R,ae=(_-T)*R,he=(1-(y+b))*R;return e[0]=F,e[1]=j,e[2]=q,e[3]=0,e[4]=K,e[5]=X,e[6]=ne,e[7]=0,e[8]=re,e[9]=ae,e[10]=he,e[11]=0,e[12]=r[0]+L-(F*L+K*C+re*U),e[13]=r[1]+C-(j*L+X*C+ae*U),e[14]=r[2]+U-(q*L+ne*C+he*U),e[15]=1,e}function P0e(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=r+r,a=i+i,u=n+n,c=r*o,h=i*o,d=i*a,y=n*o,v=n*a,w=n*u,b=s*o,_=s*a,x=s*u;return e[0]=1-d-w,e[1]=h+x,e[2]=y-_,e[3]=0,e[4]=h-x,e[5]=1-c-w,e[6]=v+b,e[7]=0,e[8]=y+_,e[9]=v-b,e[10]=1-c-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function L0e(e,t,r,i,n,s,o){const a=1/(r-t),u=1/(n-i),c=1/(s-o);return e[0]=2*s*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*s*u,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(n+i)*u,e[10]=(o+s)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*s*2*c,e[15]=0,e}function k0e(e,t,r,i,n){const s=1/Math.tan(t/2);let o;return e[0]=s/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,n!=null&&n!==1/0?(o=1/(i-n),e[10]=(n+i)*o,e[14]=2*n*i*o):(e[10]=-1,e[14]=-2*i),e}function N0e(e,t,r,i){const n=Math.tan(t.upDegrees*Math.PI/180),s=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),u=2/(o+a),c=2/(n+s);return e[0]=u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=-(o-a)*u*.5,e[9]=(n-s)*c*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function D0e(e,t,r,i,n,s,o){const a=1/(t-r),u=1/(i-n),c=1/(s-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*a,e[13]=(n+i)*u,e[14]=(o+s)*c,e[15]=1,e}function F0e(e,t,r,i){const n=t[0],s=t[1],o=t[2];let a=n-r[0],u=s-r[1],c=o-r[2];const h=Bo();if(Math.abs(a)<h&&Math.abs(u)<h&&Math.abs(c)<h)return void bT(e);let d=1/Math.sqrt(a*a+u*u+c*c);a*=d,u*=d,c*=d;const y=i[0],v=i[1],w=i[2];let b=v*c-w*u,_=w*a-y*c,x=y*u-v*a;d=Math.sqrt(b*b+_*_+x*x),d?(d=1/d,b*=d,_*=d,x*=d):(b=0,_=0,x=0);let T=u*x-c*_,I=c*b-a*x,M=a*_-u*b;d=Math.sqrt(T*T+I*I+M*M),d?(d=1/d,T*=d,I*=d,M*=d):(T=0,I=0,M=0),e[0]=b,e[1]=T,e[2]=a,e[3]=0,e[4]=_,e[5]=I,e[6]=u,e[7]=0,e[8]=x,e[9]=M,e[10]=c,e[11]=0,e[12]=-(b*n+_*s+x*o),e[13]=-(T*n+I*s+M*o),e[14]=-(a*n+u*s+c*o),e[15]=1}function j0e(e,t,r,i){const n=t[0],s=t[1],o=t[2],a=i[0],u=i[1],c=i[2];let h=n-r[0],d=s-r[1],y=o-r[2],v=h*h+d*d+y*y;v>0&&(v=1/Math.sqrt(v),h*=v,d*=v,y*=v);let w=u*y-c*d,b=c*h-a*y,_=a*d-u*h;return v=w*w+b*b+_*_,v>0&&(v=1/Math.sqrt(v),w*=v,b*=v,_*=v),e[0]=w,e[1]=b,e[2]=_,e[3]=0,e[4]=d*_-y*b,e[5]=y*w-h*_,e[6]=h*b-d*w,e[7]=0,e[8]=h,e[9]=d,e[10]=y,e[11]=0,e[12]=n,e[13]=s,e[14]=o,e[15]=1,e}function U0e(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function V0e(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2+e[9]**2+e[10]**2+e[11]**2+e[12]**2+e[13]**2+e[14]**2+e[15]**2)}function G0e(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function Jq(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function B0e(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function z0e(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function q0e(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function H0e(e,t){if(e===t)return!0;const r=e[0],i=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],h=e[8],d=e[9],y=e[10],v=e[11],w=e[12],b=e[13],_=e[14],x=e[15],T=t[0],I=t[1],M=t[2],$=t[3],A=t[4],R=t[5],L=t[6],C=t[7],U=t[8],F=t[9],j=t[10],q=t[11],K=t[12],X=t[13],ne=t[14],re=t[15],ae=Bo();return Math.abs(r-T)<=ae*Math.max(1,Math.abs(r),Math.abs(T))&&Math.abs(i-I)<=ae*Math.max(1,Math.abs(i),Math.abs(I))&&Math.abs(n-M)<=ae*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(s-$)<=ae*Math.max(1,Math.abs(s),Math.abs($))&&Math.abs(o-A)<=ae*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(a-R)<=ae*Math.max(1,Math.abs(a),Math.abs(R))&&Math.abs(u-L)<=ae*Math.max(1,Math.abs(u),Math.abs(L))&&Math.abs(c-C)<=ae*Math.max(1,Math.abs(c),Math.abs(C))&&Math.abs(h-U)<=ae*Math.max(1,Math.abs(h),Math.abs(U))&&Math.abs(d-F)<=ae*Math.max(1,Math.abs(d),Math.abs(F))&&Math.abs(y-j)<=ae*Math.max(1,Math.abs(y),Math.abs(j))&&Math.abs(v-q)<=ae*Math.max(1,Math.abs(v),Math.abs(q))&&Math.abs(w-K)<=ae*Math.max(1,Math.abs(w),Math.abs(K))&&Math.abs(b-X)<=ae*Math.max(1,Math.abs(b),Math.abs(X))&&Math.abs(_-ne)<=ae*Math.max(1,Math.abs(_),Math.abs(ne))&&Math.abs(x-re)<=ae*Math.max(1,Math.abs(x),Math.abs(re))}function W0e(e){const t=Bo(),r=e[0],i=e[1],n=e[2],s=e[4],o=e[5],a=e[6],u=e[8],c=e[9],h=e[10];return Math.abs(1-(r*r+s*s+u*u))<=t&&Math.abs(1-(i*i+o*o+c*c))<=t&&Math.abs(1-(n*n+a*a+h*h))<=t}function J0e(e){return e[0]===1&&e[1]===0&&e[2]===0&&e[4]===0&&e[5]===1&&e[6]===0&&e[8]===0&&e[9]===0&&e[10]===1}const Z0e=Hq,Y0e=Jq;Object.freeze(Object.defineProperty({__proto__:null,add:G0e,adjoint:h0e,copy:c0e,determinant:d0e,equals:H0e,exactEquals:q0e,frob:V0e,fromQuat:P0e,fromQuat2:M0e,fromRotation:S0e,fromRotationTranslation:Wq,fromRotationTranslationScale:C0e,fromRotationTranslationScaleOrigin:O0e,fromScaling:_0e,fromTranslation:b0e,fromXRotation:x0e,fromYRotation:T0e,fromZRotation:I0e,frustum:L0e,getRotation:R0e,getScaling:A0e,getTranslation:E0e,hasIdentityRotation:J0e,identity:bT,invert:qq,invertOrIdentity:p0e,isOrthoNormal:W0e,lookAt:F0e,mul:Z0e,multiply:Hq,multiplyScalar:B0e,multiplyScalarAndAdd:z0e,ortho:D0e,perspective:k0e,perspectiveFromFieldOfView:N0e,rotate:m0e,rotateX:g0e,rotateY:v0e,rotateZ:w0e,scale:y0e,set:Gp,str:U0e,sub:Y0e,subtract:Jq,targetTo:j0e,translate:f0e,transpose:Bp},Symbol.toStringTag,{value:"Module"}));const K0e=(e,t)=>{const r=Gp(e,t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1);return Bp(r,r)},X0e=(e,t)=>{const r=Gp(e,t,0,0,.5-.5*t,0,t,0,.5-.5*t,0,0,t,.5-.5*t,0,0,0,1);return Bp(r,r)},Q0e=(e,t)=>{const r=1-t,i=Gp(e,.2126+.7874*r,.7152-.7152*r,.0722-.0722*r,0,.2126-.2126*r,.7152+.2848*r,.0722-.0722*r,0,.2126-.2126*r,.7152-.7152*r,.0722+.9278*r,0,0,0,0,1);return Bp(i,i)},ege=(e,t)=>{const r=Math.sin(t*Math.PI/180),i=Math.cos(t*Math.PI/180),n=Gp(e,.213+.787*i-.213*r,.715-.715*i-.715*r,.072-.072*i+.928*r,0,.213-.213*i+.143*r,.715+.285*i+.14*r,.072-.072*i-.283*r,0,.213-.213*i-.787*r,.715-.715*i+.715*r,.072+.928*i+.072*r,0,0,0,0,1);return Bp(n,n)},tge=(e,t)=>{const r=1-2*t,i=Gp(e,r,0,0,t,0,r,0,t,0,0,r,t,0,0,0,1);return Bp(i,i)},rge=(e,t)=>{const r=Gp(e,.213+.787*t,.715-.715*t,.072-.072*t,0,.213-.213*t,.715+.285*t,.072-.072*t,0,.213-.213*t,.715-.715*t,.072+.928*t,0,0,0,0,1);return Bp(r,r)},ige=(e,t)=>{const r=1-t,i=Gp(e,.393+.607*r,.769-.769*r,.189-.189*r,0,.349-.349*r,.686+.314*r,.168-.168*r,0,.272-.272*r,.534-.534*r,.131+.869*r,0,0,0,0,1);return Bp(i,i)};let Zq=class Yq{constructor(t,r,i){this.strength=t,this.radius=r,this.threshold=i,this.type="bloom"}interpolate(t,r,i){this.strength=ms(t.strength,r.strength,i),this.radius=ms(t.radius,r.radius,i),this.threshold=ms(t.threshold,r.threshold,i)}clone(){return new Yq(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:E1(this.radius),strength:this.strength,threshold:this.threshold}}},Kq=class Xq{constructor(t){this.radius=t,this.type="blur"}interpolate(t,r,i){this.radius=Math.round(ms(t.radius,r.radius,i))}clone(){return new Xq(this.radius)}toJSON(){return{type:"blur",radius:E1(this.radius)}}},EA=class Qq{constructor(t,r){this.type=t,this.amount=r,this.type!=="invert"&&this.type!=="grayscale"&&this.type!=="sepia"||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,r,i){this.amount=ms(t.amount,r.amount,i),this._updateMatrix()}clone(){return new Qq(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||wT();switch(this.type){case"brightness":this._colorMatrix=K0e(t,this.amount);break;case"contrast":this._colorMatrix=X0e(t,this.amount);break;case"grayscale":this._colorMatrix=Q0e(t,this.amount);break;case"invert":this._colorMatrix=tge(t,this.amount);break;case"saturate":this._colorMatrix=rge(t,this.amount);break;case"sepia":this._colorMatrix=ige(t,this.amount)}}},eH=class tH{constructor(t,r,i,n){this.offsetX=t,this.offsetY=r,this.blurRadius=i,this.color=n,this.type="drop-shadow"}interpolate(t,r,i){this.offsetX=ms(t.offsetX,r.offsetX,i),this.offsetY=ms(t.offsetY,r.offsetY,i),this.blurRadius=ms(t.blurRadius,r.blurRadius,i),this.color[0]=Math.round(ms(t.color[0],r.color[0],i)),this.color[1]=Math.round(ms(t.color[1],r.color[1],i)),this.color[2]=Math.round(ms(t.color[2],r.color[2],i)),this.color[3]=ms(t.color[3],r.color[3],i)}clone(){return new tH(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:E1(this.offsetX),yoffset:E1(this.offsetY),blurRadius:E1(this.blurRadius),color:t}}},rH=class iH{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,r,i){this.angle=ms(t.angle,r.angle,i),this._updateMatrix()}clone(){return new iH(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||wT();this._colorMatrix=ege(t,this.angle)}},nH=class sH{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,r,i){this.amount=ms(t.amount,r.amount,i)}clone(){return new sH(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}};function ms(e,t,r){return e+(t-e)*r}function E1(e){return Math.round(1e3*Bu(e))/1e3}function nge(e){switch(e.type){case"grayscale":case"sepia":case"invert":return new EA(e.type,0);case"saturate":case"brightness":case"contrast":return new EA(e.type,1);case"opacity":return new nH(1);case"hue-rotate":return new rH(0);case"blur":return new Kq(0);case"drop-shadow":return new eH(0,0,0,[...p4("transparent")]);case"bloom":return new Zq(0,0,1)}}var z8e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function sge(e,t){const r=e.length>t.length?e:t;return(e.length>t.length?t:e).every((i,n)=>i.type===r[n].type)}function oge(e,t){const r=e.length>t.length?e:t,i=e.length>t.length?t:e;for(let n=i.length;n<r.length;n++)i.push(nge(r[n]))}function age(e){const t=e[0];return!!t&&"type"in t}var R8,C8,oH={exports:{}};C8=function(){function e(n,s){function o(){this.constructor=n}o.prototype=s.prototype,n.prototype=new o}function t(n,s,o,a){var u=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(u,t.prototype),u.expected=s,u.found=o,u.location=a,u.name="SyntaxError",u}function r(n,s,o){return o=o||" ",n.length>s?n:(s-=n.length,n+(o+=o.repeat(s)).slice(0,s))}function i(n,s){var o,a={},u=(s=s!==void 0?s:{}).grammarSource,c={start:Mw},h=Mw,d="none",y=")",v=",",w="(",b="%",_="px",x="cm",T="mm",I="in",M="pt",$="pc",A="deg",R="rad",L="grad",C="turn",U="#",F=".",j="e",q=/^[ \t\n\r]/,K=/^[a-z\-]/,X=/^[0-9a-fA-F]/,ne=/^[+\-]/,re=/^[0-9]/,ae=zo("none"),he=ii("none",!1),de=ii(")",!1),fe=ii(",",!1),Se=zo("whitespace"),Ee=th([" ","	",`
`,"\r"],!1,!1),Fe=zo("function"),ht=ii("(",!1),Lt=zo("identifier"),Nt=th([["a","z"],"-"],!1,!1),Ir=zo("percentage"),st=ii("%",!1),St=zo("length"),ei=ii("px",!1),rn=ii("cm",!1),Dt=ii("mm",!1),yi=ii("in",!1),On=ii("pt",!1),nn=ii("pc",!1),mi=zo("angle"),Dl=ii("deg",!1),Qu=ii("rad",!1),Gi=ii("grad",!1),Ri=ii("turn",!1),Pn=zo("number"),Re=zo("color"),ot=ii("#",!1),bt=th([["0","9"],["a","f"],["A","F"]],!1,!1),Dr=th(["+","-"],!1,!1),Vt=th([["0","9"]],!1,!1),ti=ii(".",!1),Mr=ii("e",!1),ri=function(){return[]},eh=function(V,le){return{type:"function",name:V,parameters:le||[]}},c0=function(V,le){return le.length>0?Rw(V,le,3):[V]},p0=function(V){return{type:"quantity",value:V.value,unit:V.unit}},h0=function(V){return{type:"color",colorType:V.type,value:V.value}},d0=function(V){return V},f0=function(){return $f()},y0=function(V){return{value:V,unit:"%"}},nI=function(V){return{value:V,unit:"px"}},sI=function(V){return{value:V,unit:"cm"}},oI=function(V){return{value:V,unit:"mm"}},bw=function(V){return{value:V,unit:"in"}},_w=function(V){return{value:V,unit:"pt"}},aI=function(V){return{value:V,unit:"pc"}},lI=function(V){return{value:V,unit:"deg"}},uI=function(V){return{value:V,unit:"rad"}},cI=function(V){return{value:V,unit:"grad"}},Sw=function(V){return{value:V,unit:"turn"}},pI=function(V){return{value:V,unit:null}},hI=function(){return{type:"hex",value:$f()}},dI=function(V){return{type:"function",value:V}},m0=function(){return{type:"named",value:$f()}},fI=function(){return parseFloat($f())},ee=0,sr=0,Mf=[{line:1,column:1}],ao=0,g0=[],ke=0;if("startRule"in s){if(!(s.startRule in c))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');h=c[s.startRule]}function $f(){return n.substring(sr,ee)}function ii(V,le){return{type:"literal",text:V,ignoreCase:le}}function th(V,le,ye){return{type:"class",parts:V,inverted:le,ignoreCase:ye}}function xw(){return{type:"end"}}function zo(V){return{type:"other",description:V}}function Tw(V){var le,ye=Mf[V];if(ye)return ye;for(le=V-1;!Mf[le];)le--;for(ye={line:(ye=Mf[le]).line,column:ye.column};le<V;)n.charCodeAt(le)===10?(ye.line++,ye.column=1):ye.column++,le++;return Mf[V]=ye,ye}function Iw(V,le,ye){var rt=Tw(V),$r=Tw(le),Qt={source:u,start:{offset:V,line:rt.line,column:rt.column},end:{offset:le,line:$r.line,column:$r.column}};return Qt}function tt(V){ee<ao||(ee>ao&&(ao=ee,g0=[]),g0.push(V))}function yI(V,le,ye){return new t(t.buildMessage(V,le),V,le,ye)}function Mw(){var V;return(V=Ef())===a&&(V=mI()),V}function Ef(){var V,le;return ke++,V=ee,ni(),n.substr(ee,4)===d?(le=d,ee+=4):(le=a,ke===0&&tt(he)),le!==a?(ni(),sr=V,V=ri()):(ee=V,V=a),ke--,V===a&&ke===0&&tt(ae),V}function mI(){var V,le;if(V=[],(le=ec())!==a)for(;le!==a;)V.push(le),le=ec();else V=a;return V}function ec(){var V,le,ye,rt;return V=ee,ni(),(le=$w())!==a?(ni(),(ye=gI())===a&&(ye=null),ni(),n.charCodeAt(ee)===41?(rt=y,ee++):(rt=a,ke===0&&tt(de)),rt!==a?(ni(),sr=V,V=eh(le,ye)):(ee=V,V=a)):(ee=V,V=a),V}function gI(){var V,le,ye,rt,$r,Qt,kn,rh;if(V=ee,(le=v0())!==a){for(ye=[],rt=ee,$r=ni(),n.charCodeAt(ee)===44?(Qt=v,ee++):(Qt=a,ke===0&&tt(fe)),Qt===a&&(Qt=null),kn=ni(),(rh=v0())!==a?rt=$r=[$r,Qt,kn,rh]:(ee=rt,rt=a);rt!==a;)ye.push(rt),rt=ee,$r=ni(),n.charCodeAt(ee)===44?(Qt=v,ee++):(Qt=a,ke===0&&tt(fe)),Qt===a&&(Qt=null),kn=ni(),(rh=v0())!==a?rt=$r=[$r,Qt,kn,rh]:(ee=rt,rt=a);sr=V,V=c0(le,ye)}else ee=V,V=a;return V}function v0(){var V,le;return V=ee,(le=Ew())===a&&(le=vI())===a&&(le=wI())===a&&(le=bI()),le!==a&&(sr=V,le=p0(le)),(V=le)===a&&(V=ee,(le=_I())!==a&&(sr=V,le=h0(le)),V=le),V}function ni(){var V,le;for(ke++,V=[],q.test(n.charAt(ee))?(le=n.charAt(ee),ee++):(le=a,ke===0&&tt(Ee));le!==a;)V.push(le),q.test(n.charAt(ee))?(le=n.charAt(ee),ee++):(le=a,ke===0&&tt(Ee));return ke--,le=a,ke===0&&tt(Se),V}function $w(){var V,le,ye;return ke++,V=ee,(le=w0())!==a?(n.charCodeAt(ee)===40?(ye=w,ee++):(ye=a,ke===0&&tt(ht)),ye!==a?(sr=V,V=d0(le)):(ee=V,V=a)):(ee=V,V=a),ke--,V===a&&(le=a,ke===0&&tt(Fe)),V}function w0(){var V,le,ye;if(ke++,V=ee,le=[],K.test(n.charAt(ee))?(ye=n.charAt(ee),ee++):(ye=a,ke===0&&tt(Nt)),ye!==a)for(;ye!==a;)le.push(ye),K.test(n.charAt(ee))?(ye=n.charAt(ee),ee++):(ye=a,ke===0&&tt(Nt));else le=a;return le!==a&&(sr=V,le=f0()),ke--,(V=le)===a&&(le=a,ke===0&&tt(Lt)),V}function Ew(){var V,le,ye;return ke++,V=ee,ni(),(le=Ln())!==a?(n.charCodeAt(ee)===37?(ye=b,ee++):(ye=a,ke===0&&tt(st)),ye!==a?(sr=V,V=y0(le)):(ee=V,V=a)):(ee=V,V=a),ke--,V===a&&ke===0&&tt(Ir),V}function vI(){var V,le,ye;return ke++,V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===_?(ye=_,ee+=2):(ye=a,ke===0&&tt(ei)),ye!==a?(sr=V,V=nI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===x?(ye=x,ee+=2):(ye=a,ke===0&&tt(rn)),ye!==a?(sr=V,V=sI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===T?(ye=T,ee+=2):(ye=a,ke===0&&tt(Dt)),ye!==a?(sr=V,V=oI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===I?(ye=I,ee+=2):(ye=a,ke===0&&tt(yi)),ye!==a?(sr=V,V=bw(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===M?(ye=M,ee+=2):(ye=a,ke===0&&tt(On)),ye!==a?(sr=V,V=_w(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,ni(),(le=Ln())!==a?(n.substr(ee,2)===$?(ye=$,ee+=2):(ye=a,ke===0&&tt(nn)),ye!==a?(sr=V,V=aI(le)):(ee=V,V=a)):(ee=V,V=a)))))),ke--,V===a&&ke===0&&tt(St),V}function wI(){var V,le,ye;return ke++,V=ee,(le=Ln())!==a?(n.substr(ee,3)===A?(ye=A,ee+=3):(ye=a,ke===0&&tt(Dl)),ye!==a?(sr=V,V=lI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,(le=Ln())!==a?(n.substr(ee,3)===R?(ye=R,ee+=3):(ye=a,ke===0&&tt(Qu)),ye!==a?(sr=V,V=uI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,(le=Ln())!==a?(n.substr(ee,4)===L?(ye=L,ee+=4):(ye=a,ke===0&&tt(Gi)),ye!==a?(sr=V,V=cI(le)):(ee=V,V=a)):(ee=V,V=a),V===a&&(V=ee,(le=Ln())!==a?(n.substr(ee,4)===C?(ye=C,ee+=4):(ye=a,ke===0&&tt(Ri)),ye!==a?(sr=V,V=Sw(le)):(ee=V,V=a)):(ee=V,V=a)))),ke--,V===a&&(le=a,ke===0&&tt(mi)),V}function bI(){var V,le;return ke++,V=ee,ni(),(le=Ln())!==a?(sr=V,V=pI(le)):(ee=V,V=a),ke--,V===a&&ke===0&&tt(Pn),V}function _I(){var V,le,ye,rt;if(ke++,V=ee,n.charCodeAt(ee)===35?(le=U,ee++):(le=a,ke===0&&tt(ot)),le!==a){if(ye=[],X.test(n.charAt(ee))?(rt=n.charAt(ee),ee++):(rt=a,ke===0&&tt(bt)),rt!==a)for(;rt!==a;)ye.push(rt),X.test(n.charAt(ee))?(rt=n.charAt(ee),ee++):(rt=a,ke===0&&tt(bt));else ye=a;ye!==a?(sr=V,V=hI()):(ee=V,V=a)}else ee=V,V=a;return V===a&&(V=ee,(le=ec())!==a&&(sr=V,le=dI(le)),(V=le)===a&&(V=ee,(le=w0())!==a&&(sr=V,le=m0()),V=le)),ke--,V===a&&(le=a,ke===0&&tt(Re)),V}function Ln(){var V,le,ye,rt,$r,Qt,kn;for(V=ee,ne.test(n.charAt(ee))?(n.charAt(ee),ee++):ke===0&&tt(Dr),le=ee,ye=[],re.test(n.charAt(ee))?(rt=n.charAt(ee),ee++):(rt=a,ke===0&&tt(Vt));rt!==a;)ye.push(rt),re.test(n.charAt(ee))?(rt=n.charAt(ee),ee++):(rt=a,ke===0&&tt(Vt));if(n.charCodeAt(ee)===46?(rt=F,ee++):(rt=a,ke===0&&tt(ti)),rt!==a){if($r=[],re.test(n.charAt(ee))?(Qt=n.charAt(ee),ee++):(Qt=a,ke===0&&tt(Vt)),Qt!==a)for(;Qt!==a;)$r.push(Qt),re.test(n.charAt(ee))?(Qt=n.charAt(ee),ee++):(Qt=a,ke===0&&tt(Vt));else $r=a;$r!==a?le=ye=[ye,rt,$r]:(ee=le,le=a)}else ee=le,le=a;if(le===a)if(le=[],re.test(n.charAt(ee))?(ye=n.charAt(ee),ee++):(ye=a,ke===0&&tt(Vt)),ye!==a)for(;ye!==a;)le.push(ye),re.test(n.charAt(ee))?(ye=n.charAt(ee),ee++):(ye=a,ke===0&&tt(Vt));else le=a;if(le!==a){if(ye=ee,n.charCodeAt(ee)===101?(rt=j,ee++):(rt=a,ke===0&&tt(Mr)),rt!==a){if(ne.test(n.charAt(ee))?($r=n.charAt(ee),ee++):($r=a,ke===0&&tt(Dr)),$r===a&&($r=null),Qt=[],re.test(n.charAt(ee))?(kn=n.charAt(ee),ee++):(kn=a,ke===0&&tt(Vt)),kn!==a)for(;kn!==a;)Qt.push(kn),re.test(n.charAt(ee))?(kn=n.charAt(ee),ee++):(kn=a,ke===0&&tt(Vt));else Qt=a;Qt!==a?ye=rt=[rt,$r,Qt]:(ee=ye,ye=a)}else ee=ye,ye=a;ye===a&&(ye=null),sr=V,V=fI()}else ee=V,V=a;return V}function Aw(V,le){return V.map(function(ye){return ye[le]})}function Rw(V,le,ye){return[V].concat(Aw(le,ye))}if((o=h())!==a&&ee===n.length)return o;throw o!==a&&ee<n.length&&tt(xw()),yI(g0,ao<n.length?n.charAt(ao):null,ao<n.length?Iw(ao,ao+1):Iw(ao,ao))}return e(t,Error),t.prototype.format=function(n){var s="Error: "+this.message;if(this.location){var o,a=null;for(o=0;o<n.length;o++)if(n[o].source===this.location.source){a=n[o].text.split(/\r\n|\n|\r/g);break}var u=this.location.start,c=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(u):u,h=this.location.source+":"+c.line+":"+c.column;if(a){var d=this.location.end,y=r("",c.line.toString().length," "),v=a[u.line-1],w=(u.line===d.line?d.column:v.length+1)-u.column||1;s+=`
 --> `+h+`
`+y+` |
`+c.line+" | "+v+`
`+y+" | "+r("",u.column-1," ")+r("",w,"^")}else s+=`
 at `+h}return s},t.buildMessage=function(n,s){var o={literal:function(v){return'"'+u(v.text)+'"'},class:function(v){var w=v.parts.map(function(b){return Array.isArray(b)?c(b[0])+"-"+c(b[1]):c(b)});return"["+(v.inverted?"^":"")+w.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(v){return v.description}};function a(v){return v.charCodeAt(0).toString(16).toUpperCase()}function u(v){return v.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+a(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+a(w)})}function c(v){return v.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(w){return"\\x0"+a(w)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(w){return"\\x"+a(w)})}function h(v){return o[v.type](v)}function d(v){var w,b,_=v.map(h);if(_.sort(),_.length>0){for(w=1,b=1;w<_.length;w++)_[w-1]!==_[w]&&(_[b]=_[w],b++);_.length=b}switch(_.length){case 1:return _[0];case 2:return _[0]+" or "+_[1];default:return _.slice(0,-1).join(", ")+", or "+_[_.length-1]}}function y(v){return v?'"'+u(v)+'"':"end of input"}return"Expected "+d(n)+" but "+y(s)+" found."},{SyntaxError:t,parse:i}},(R8=oH).exports&&(R8.exports=C8());var lge=oH.exports;function aH(e){if(!e||e.length===0)return null;if(typeof e=="string"){const r=O8(e);return r&&r.length!==0?r:null}const t=e.map(r=>{if(!Number.isFinite(r.scale)||r.scale<=0)throw new z("effect:invalid-scale","scale must be finite and greater than 0",{stop:r});return{scale:r.scale,effects:O8(r.value)}});t.sort((r,i)=>i.effects.length-r.effects.length);for(let r=0;r<t.length-1;r++){if(!sge(t[r].effects,t[r+1].effects))throw new z("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[r].effects,b:t[r+1].effects});oge(t[r].effects,t[r+1].effects)}return t.sort((r,i)=>i.scale-r.scale),t}function O8(e){let t;if(!e)return[];try{t=lge.parse(e)}catch(r){throw new z("effect:invalid-syntax","Invalid effect syntax",{value:e,error:r})}return t.map(r=>uge(r))}function uge(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return cge(e);case"opacity":return pge(e);case"hue-rotate":return hge(e);case"blur":return dge(e);case"drop-shadow":return fge(e);case"bloom":return yge(e)}}catch(t){throw t.details.filter=e,t}throw new z("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}function cge(e){let t=1;return e0(e.parameters,1),e.parameters.length===1&&(t=_a(e.parameters[0])),new EA(e.name,t)}function pge(e){let t=1;return e0(e.parameters,1),e.parameters.length===1&&(t=_a(e.parameters[0])),new nH(t)}function hge(e){let t=0;return e0(e.parameters,1),e.parameters.length===1&&(t=_ge(e.parameters[0])),new rH(t)}function dge(e){let t=0;return e0(e.parameters,1),e.parameters.length===1&&(t=L4(e.parameters[0]),Kv(t,e.parameters[0])),new Kq(t)}function fge(e){const t=[];let r=null;for(const i of e.parameters)if(i.type==="color"){if(t.length&&Object.freeze(t),r)throw new z("effect:type-error","Accepts only one color",{});r=Sge(i)}else{const n=L4(i);if(Object.isFrozen(t))throw new z("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(n),t.length===3&&Kv(n,i)}if(t.length<2||t.length>3)throw new z("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new eH(t[0],t[1],t[2]||0,r||lH("black"))}function yge(e){let t=1,r=0,i=0;return e0(e.parameters,3),e.parameters[0]&&(t=_a(e.parameters[0])),e.parameters[1]&&(r=L4(e.parameters[1]),Kv(r,e.parameters[1])),e.parameters[2]&&(i=_a(e.parameters[2])),new Zq(t,r,i)}function e0(e,t){if(e.length>t)throw new z("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function _T(e){if(e.type==="color")return"<color>";if(e.unit){if(e.unit in P4)return"<length>";if(e.unit in O4)return"<angle>";if(e.unit==="%")return"<percentage>"}return"<double>"}function Kv(e,t){if(e<0)throw new z("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}function mge(e){if(e.type!=="quantity"||e.unit!==null)throw new z("effect:type-error",`Expected <double>, Actual: ${_T(e)}`,{term:e})}function gge(e){if(e.type!=="quantity"||e.unit!==null&&e.unit!=="%")throw new z("effect:type-error",`Expected <double> or <percentage>, Actual: ${_T(e)}`,{term:e})}const O4={deg:1,grad:.9,rad:180/Math.PI,turn:360};function vge(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&O4[e.unit]!=null))throw new z("effect:type-error",`Expected <angle>, Actual: ${_T(e)}`,{term:e})}const P4={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function wge(e){if(e.type!=="quantity"||!(e.value===0&&e.unit===null||e.unit&&P4[e.unit]!=null))throw new z("effect:type-error",`Expected <length>, Actual: ${_T(e)}`,{term:e})}function _a(e){gge(e);const t=e.value;return Kv(t,e),e.unit==="%"?.01*t:t}function bge(e){return mge(e),Kv(e.value,e),e.value}function _ge(e){return vge(e),e.value*O4[e.unit]||0}function L4(e){return wge(e),e.value*P4[e.unit]||0}function Sge(e){switch(e.colorType){case"hex":return Mye(e.value);case"named":return lH(e.value);case"function":return Ige(e.value)}}function lH(e){if(!Yz(e))throw new z("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return Iye(e)}const xge=/^rgba?/i,Tge=/^hsla?/i;function Ige(e){if(e0(e.parameters,4),xge.test(e.name))return[_a(e.parameters[0]),_a(e.parameters[1]),_a(e.parameters[2]),e.parameters[3]?_a(e.parameters[3]):1];if(Tge.test(e.name))return Kz(bge(e.parameters[0]),_a(e.parameters[1]),_a(e.parameters[2]),e.parameters[3]?_a(e.parameters[3]):1);throw new z("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}function k4(e,t,r){var i;try{return $ge(e)}catch(n){(i=r==null?void 0:r.messages)==null||i.push(n)}return null}function N4(e,t,r,i){try{const n=Mge(e);En(r,n,t)}catch(n){i.messages&&i.messages.push(n)}}function Mge(e){const t=aH(e);return t?age(t)?t.map(r=>r.toJSON()):t.map(({scale:r,effects:i})=>({scale:r,value:i.map(n=>n.toJSON())})):null}function $ge(e){if(!e||e.length===0)return null;if(Ege(e)){const t=[];for(const r of e)t.push({scale:r.scale,value:P8(r.value)});return t}return P8(e)}function Ege(e){const t=e[0];return!!t&&"scale"in t}function P8(e){if(!(e!=null&&e.length))return"";const t=[];for(const r of e){let i=[];switch(r.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":i=[Jl(r,"amount")];break;case"blur":i=[Jl(r,"radius","pt")];break;case"hue-rotate":i=[Jl(r,"angle","deg")];break;case"drop-shadow":i=[Jl(r,"xoffset","pt"),Jl(r,"yoffset","pt"),Jl(r,"blurRadius","pt"),Age(r,"color")];break;case"bloom":i=[Jl(r,"strength"),Jl(r,"radius","pt"),Jl(r,"threshold")]}const n=`${r.type}(${i.filter(Boolean).join(" ")})`;aH(n),t.push(n)}return t.join(" ")}function Jl(e,t,r){if(e[t]==null)throw new z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return r?e[t]+r:""+e[t]}function Age(e,t){if(e[t]==null)throw new z("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const r=e[t];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}const L8={read:{reader:k4},write:{allowNull:!0,writer:N4}},zp=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return l([p({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),l([p({json:{read:!1,write:!1,origins:{"web-map":L8,"portal-item":L8}}})],t.prototype,"effect",void 0),t=l([k("esri.layers.mixins.BlendLayer")],t),t},An=(e=>e)(["operational-layers","basemap","ground"]),k8={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CatalogLayer:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,KnowledgeGraphLayer:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},N8={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},D8={ArcGISFeatureLayer:!0,SubtypeGroupTable:!0},Rge={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0,IntegratedMesh3DTilesLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":k8,"web-map/basemap":N8,"web-map/tables":D8,"link-chart/operational-layers":{...k8,LinkChartLayer:!0},"link-chart/basemap":N8,"link-chart/tables":D8,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISImageServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,IntegratedMesh3DTilesLayer:!0,MediaLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0}},F8={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8};function Wd(e,t,r,i=Ml){const n=new no(s4(i)),s=et.fromJSDate(e,{zone:n}),o=r==="decades"||r==="centuries"?"year":uH(r);return r==="decades"&&(t*=10),r==="centuries"&&(t*=100),s.plus({[o]:t}).toJSDate()}function j8(e,t,r=Ml){const i=new no(s4(r)),n=et.fromJSDate(e,{zone:i});if(t==="decades"||t==="centuries"){const o=n.startOf("year"),{year:a}=o,u=a-a%(t==="decades"?10:100);return o.set({year:u}).toJSDate()}const s=uH(t);return n.startOf(s).toJSDate()}function Cge(e,t,r){return e===0?0:e*F8[t]/F8[r]}function uH(e){switch(e){case"milliseconds":return"millisecond";case"seconds":return"second";case"minutes":return"minute";case"hours":return"hour";case"days":return"day";case"weeks":return"week";case"months":return"month";case"years":return"year"}}var sa;let Bs=sa=class extends Q{static get allTime(){return U8}static get empty(){return Oge}constructor(e){super(e),this.end=null,this.start=null}readEnd(e,t){return t.end!=null?new Date(t.end):null}writeEnd(e,t){t.end=(e==null?void 0:e.getTime())??null}get isAllTime(){return this.equals(sa.allTime)}get isEmpty(){return this.equals(sa.empty)}readStart(e,t){return t.start!=null?new Date(t.start):null}writeStart(e,t){t.start=(e==null?void 0:e.getTime())??null}clone(){return new sa({end:this.end,start:this.start})}equals(e){var s,o,a,u;if(!e)return!1;const t=((s=this.start)==null?void 0:s.getTime())??this.start,r=((o=this.end)==null?void 0:o.getTime())??this.end,i=((a=e.start)==null?void 0:a.getTime())??e.start,n=((u=e.end)==null?void 0:u.getTime())??e.end;return t===i&&r===n}expandTo(e,t=Ml){if(this.isEmpty||this.isAllTime)return this.clone();let r=this.start;r&&(r=j8(r,e,t));let i=this.end;if(i){const n=j8(i,e,t);i=i.getTime()===n.getTime()?n:Wd(n,1,e,t)}return new sa({start:r,end:i})}intersection(e){var a,u,c,h;if(!e)return this.clone();if(this.isEmpty||e.isEmpty)return sa.empty;if(this.isAllTime)return e.clone();if(e.isAllTime)return this.clone();const t=((a=this.start)==null?void 0:a.getTime())??-1/0,r=((u=this.end)==null?void 0:u.getTime())??1/0,i=((c=e.start)==null?void 0:c.getTime())??-1/0,n=((h=e.end)==null?void 0:h.getTime())??1/0;let s,o;if(i>=t&&i<=r?s=i:t>=i&&t<=n&&(s=t),r>=i&&r<=n?o=r:n>=t&&n<=r&&(o=n),s!=null&&o!=null&&!isNaN(s)&&!isNaN(o)){const d=new sa;return d.start=s===-1/0?null:new Date(s),d.end=o===1/0?null:new Date(o),d}return sa.empty}offset(e,t,r=Ml){if(this.isEmpty||this.isAllTime)return this.clone();const i=new sa,{start:n,end:s}=this;return n!=null&&(i.start=Wd(n,e,t,r)),s!=null&&(i.end=Wd(s,e,t,r)),i}union(e){if(!e||e.isEmpty)return this.clone();if(this.isEmpty)return e.clone();if(this.isAllTime||e.isAllTime)return U8.clone();const t=this.start!=null&&e.start!=null?new Date(Math.min(this.start.getTime(),e.start.getTime())):null,r=this.end!=null&&e.end!=null?new Date(Math.max(this.end.getTime(),e.end.getTime())):null;return new sa({start:t,end:r})}};l([p({type:Date,json:{write:{allowNull:!0}}})],Bs.prototype,"end",void 0),l([te("end")],Bs.prototype,"readEnd",null),l([se("end")],Bs.prototype,"writeEnd",null),l([p({readOnly:!0,json:{read:!1}})],Bs.prototype,"isAllTime",null),l([p({readOnly:!0,json:{read:!1}})],Bs.prototype,"isEmpty",null),l([p({type:Date,json:{write:{allowNull:!0}}})],Bs.prototype,"start",void 0),l([te("start")],Bs.prototype,"readStart",null),l([se("start")],Bs.prototype,"writeStart",null),Bs=sa=l([k("esri.TimeExtent")],Bs);const U8=new Bs,Oge=new Bs({start:void 0,end:void 0}),is=Bs;function V8(e){return e!=null&&typeof e=="object"&&"declaredClass"in e&&e.declaredClass==="esri.WebMap"}function Pge(e){if(!e)return e;const{start:t,end:r}=e;return new is({start:t!=null?Wd(t,-t.getTimezoneOffset(),"minutes"):t,end:r!=null?Wd(r,-r.getTimezoneOffset(),"minutes"):r})}function Lge(e){if(!e)return e;const{start:t,end:r}=e;return new is({start:t!=null?Wd(t,t.getTimezoneOffset(),"minutes"):t,end:r!=null?Wd(r,r.getTimezoneOffset(),"minutes"):r})}var AA;let Lg=AA=class extends Q{constructor(e){super(e)}async collectRequiredFields(e,t){return es(e,t,this.expression)}clone(){return new AA({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};l([p({type:String,json:{write:!0}})],Lg.prototype,"expression",void 0),l([p({type:String,json:{write:!0}})],Lg.prototype,"title",void 0),Lg=AA=l([k("esri.layers.support.FeatureExpressionInfo")],Lg);const G8=Lg,D4={unknown:1,inches:bo(1,"meters","inches"),feet:bo(1,"meters","feet"),"us-feet":bo(1,"meters","us-feet"),yards:bo(1,"meters","yards"),miles:bo(1,"meters","miles"),"nautical-miles":bo(1,"meters","nautical-miles"),millimeters:bo(1,"meters","millimeters"),centimeters:bo(1,"meters","centimeters"),decimeters:bo(1,"meters","decimeters"),meters:bo(1,"meters","meters"),kilometers:bo(1,"meters","kilometers"),"decimal-degrees":1/Yue(1,"meters",kr.radius)};function q8e(e){return 1/(D4[e]||1)}function kge(){const e=Object.keys(D4);return e.sort(),e}const Nge=kge();var RA;const kb=Qr()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),B8=new We({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let nu=RA=class extends Q{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return e??(t.featureExpression&&t.featureExpression.value===0?{expression:"0"}:void 0)}writeFeatureExpressionInfo(e,t,r,i){t[r]=e.write({},i),e.expression==="0"&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):e!=null||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new RA({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&Eae(this.featureExpressionInfo,e.featureExpressionInfo)}};l([p({type:G8,json:{write:!0}})],nu.prototype,"featureExpressionInfo",void 0),l([te("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],nu.prototype,"readFeatureExpressionInfo",null),l([se("featureExpressionInfo",{featureExpressionInfo:{type:G8},"featureExpression.value":{type:[0]}})],nu.prototype,"writeFeatureExpressionInfo",null),l([p({type:kb.apiValues,nonNullable:!0,json:{type:kb.jsonValues,read:kb.read,write:{writer:kb.write,isRequired:!0}}})],nu.prototype,"mode",null),l([p({type:Number,json:{write:!0}})],nu.prototype,"offset",void 0),l([p({type:Nge,json:{type:String,read:B8.read,write:B8.write}})],nu.prototype,"unit",null),nu=RA=l([k("esri.layers.support.ElevationInfo")],nu);const Dge=nu,Fge={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:An}}},Xv={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,r){t[r]=!e}}}},F4={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:An}}},Qv={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:cf}}},j4={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:An}}},jge={value:null,type:Dge,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:An}}};function H8e(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const cH={write:{enabled:!0,layerContainerTypes:An},read:!0},ox={type:Number,json:{origins:{"web-document":cH,"portal-item":{write:!0}}}},Uge={...ox,json:{...ox.json,origins:{"web-document":{...cH,write:{enabled:!0,layerContainerTypes:An,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,r)=>{var i;return r&&r.origin!=="service"||!t.drawingInfo||t.drawingInfo.transparency===void 0?(i=t.layerDefinition)!=null&&i.drawingInfo&&t.layerDefinition.drawingInfo.transparency!==void 0?pv(t.layerDefinition.drawingInfo.transparency):void 0:pv(t.drawingInfo.transparency)}}}},Vge={type:is,readOnly:!0,get(){var u,c,h;const e=((u=this.layer)==null?void 0:u.timeInfo)!=null?this.layer:((c=this.i3slayer)==null?void 0:c.timeInfo)!=null?this.i3slayer:null;if(e==null)return null;const{datesInUnknownTimezone:t,timeOffset:r,useViewTime:i}=e,n=(h=this.view)==null?void 0:h.timeExtent;let s=e.timeExtent;t&&(s=Lge(s));let o=i?n&&s?n.intersection(s):n||s:s;if(!o||o.isEmpty||o.isAllTime)return o;r&&(o=o.offset(-r.value,r.unit)),t&&(o=Pge(o));const a=this._get("timeExtent");return o.equals(a)?a:o}},W8e={type:Ne,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const r=Ne.fromJSON(e);return t.spatialReference!=null&&typeof t.spatialReference=="object"&&(r.spatialReference=xe.fromJSON(t.spatialReference)),r}}}},read:!1}},pH={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},Gge={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:An}}},name:"layerDefinition.minScale",write:!0}},Bge={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:An}}},name:"layerDefinition.maxScale",write:!0}},hH={json:{write:{ignoreOrigin:!0,layerContainerTypes:An},origins:{"web-map":{read:!1,write:!1}}}},qp=e=>{let t=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(r,i,n){var s;return((s=n==null?void 0:n.portalItem)==null?void 0:s.type)==="Group Layer"?void 0:r}writeListMode(r,i,n,s){(s&&s.layerContainerType==="ground"||r&&nG(this,n,{},s))&&(i[n]=r)}writeOperationalLayerType(r,i,n,s){r&&(s==null?void 0:s.layerContainerType)!=="tables"&&(i.layerType=r)}writeTitle(r,i){i.title=r??"Layer"}read(r,i){i&&(i.layer=this),Ele(this,r,n=>super.read(r,n),i)}write(r,i){var o,a;if(!this.persistenceEnabled)return null;if(i!=null&&i.origin){const u=`${i.origin}/${i.layerContainerType||"operational-layers"}`,c=Rge[u];let h=!!(c!=null&&c[this.operationalLayerType]);if(this.operationalLayerType==="ArcGISTiledElevationServiceLayer"&&u==="web-scene/operational-layers"&&(h=!1),this.operationalLayerType==="ArcGISDimensionLayer"&&u==="web-map/operational-layers"&&(h=!1),!h)return(o=i.messages)==null||o.push(new z("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${u}'`,{layer:this})),null}const n=super.write(r,{...i,layer:this}),s=!!i&&!!i.messages&&!!i.messages.filter(u=>u instanceof z&&u.name==="web-document-write:property-required").length;return Hx(n==null?void 0:n.url)?((a=i==null?void 0:i.messages)==null||a.push(new z("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&s?null:n}beforeSave(){}};return l([p({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),l([te("id",["id"])],t.prototype,"readId",null),l([p(hH)],t.prototype,"listMode",void 0),l([se("listMode")],t.prototype,"writeListMode",null),l([p({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:An}}}}})],t.prototype,"operationalLayerType",void 0),l([se("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),l([p(ox)],t.prototype,"opacity",void 0),l([p({type:Boolean,readOnly:!1})],t.prototype,"persistenceEnabled",void 0),l([p({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),l([se("title"),se(["web-scene"],"title")],t.prototype,"writeTitle",null),l([p({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:An}}},name:"visibility",write:!0}})],t.prototype,"visible",void 0),t=l([k("esri.layers.mixins.OperationalLayer")],t),t};function zge(e){return e!=null&&typeof e=="object"&&"type"in e&&e.type==="subtype-group"&&"sublayers"in e}function qf(e){return(e==null?void 0:e.type)==="subtype-sublayer"}const J8e={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer",Building:"BuildingSceneLayer"};function dH(e){const t=e==null?void 0:e.type;return t==="building-scene"||t==="integrated-mesh"||t==="point-cloud"||t==="scene"}function ST(e){var t;return(e==null?void 0:e.type)==="feature"&&!e.url&&((t=e.source)==null?void 0:t.type)==="memory"}function Z8e(e){var t;return((e==null?void 0:e.type)==="feature"||(e==null?void 0:e.type)==="subtype-group")&&((t=e.source)==null?void 0:t.type)==="feature-layer"}async function fH(e,t){const r=pt==null?void 0:pt.findServerInfo(e);if((r==null?void 0:r.currentVersion)!=null)return r.owningSystemUrl||null;const i=e.toLowerCase().indexOf("/rest/services");if(i===-1)return null;const n=`${e.substring(0,i)}/rest/info`,s=t!=null?t.signal:null,{data:o}=await be(n,{query:{f:"json"},responseType:"json",signal:s});return(o==null?void 0:o.owningSystemUrl)||null}function qge(e){if(!("capabilities"in e))return!1;switch(e.type){case"catalog":case"csv":case"feature":case"geojson":case"imagery":case"knowledge-graph-sublayer":case"ogc-feature":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":case"wfs":return!0;default:return!1}}function Hge(e){return qge(e)?"effectiveCapabilities"in e?e.effectiveCapabilities:e.capabilities:null}function Wge(e){if(!("editingEnabled"in e))return!1;switch(e.type){case"csv":case"feature":case"geojson":case"oriented-imagery":case"scene":case"subtype-group":case"subtype-sublayer":return!0;default:return!1}}function Jge(e){return!!Wge(e)&&("effectiveEditingEnabled"in e?e.effectiveEditingEnabled:e.editingEnabled)}let su=class extends De{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t!=null&&t.portalItem&&t.path?{...t,path:this._normalizePath(t.path,t.portalItem)}:t}set path(t){t!=null&&Kn(t)?oe.getLogger(this).error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this._normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get cdnUrl(){return this.portalItem&&this.path?`${this.portalItem.itemCdnUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?`./resources/${this.path}`:null}fetch(t="json",r){const i=this.cdnUrl;if(i==null)throw new z("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal.request(i,{responseType:t,query:{token:this.portalItem.apiKey},signal:r==null?void 0:r.signal})}async update(t,r){const{addOrUpdateResources:i}=await ge(()=>import("./resourceUtils-DEdV2Y-p.js"),__vite__mapDeps([19,1,2]));return await i(this.portalItem,[{resource:this,content:t,compress:r==null?void 0:r.compress,access:r==null?void 0:r.access}],"update",r),this}hasPath(){return this.path!=null}_normalizePath(t,r){return t==null?t:(t=t.replace(/^\/+/,""),r!=null&&Kn(t)&&(t=$O(t,r.itemUrl)),t==null?void 0:t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};l([p()],su.prototype,"portalItem",void 0),l([p({type:String,value:null})],su.prototype,"path",null),l([Tt("path")],su.prototype,"_castPath",null),l([p({type:String,readOnly:!0})],su.prototype,"url",null),l([p({type:String,readOnly:!0})],su.prototype,"cdnUrl",null),l([p({type:String,readOnly:!0})],su.prototype,"itemRelativeUrl",null),su=l([k("esri.portal.PortalItemResource")],su);const Zge=su;let kg=class extends De{constructor(t){super(t),this.created=null,this.rating=null}};l([p()],kg.prototype,"created",void 0),l([p()],kg.prototype,"rating",void 0),kg=l([k("esri.portal.PortalRating")],kg);const sM=kg;var Fh;const Yge=new Set(["3DTiles Service","CSV","Feature Collection","Feature Service","Feed","GeoJson","Group Layer","Image Service","KML","Map Service","Media Layer","Scene Service","Stream Service","Vector Tile Service","WFS","WMS","WMTS"]),Kge=new Set(["KML","GeoJson","CSV"]);let it=Fh=class extends Fv(El){static from(e){return rr(Fh,e)}constructor(e){super(e),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.isOrgItem=!1,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.sourceUrl=null,this.spatialReference=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}destroy(){this.portal=null}get displayName(){const e=this.type,t=this.typeKeywords||[];let r=e;return e==="Feature Service"||e==="Feature Collection"?r=t.includes("Table")?"Table":t.includes("Route Layer")?"Route Layer":t.includes("Markup")?"Markup":"Feature Layer":e==="Image Service"?r=t.includes("Elevation 3D Layer")?"Elevation Layer":t.includes("Tiled Imagery")?"Tiled Imagery Layer":"Imagery Layer":e==="Scene Service"?r="Scene Layer":e==="Video Service"?r="Video Layer":e==="Scene Package"?r="Scene Layer Package":e==="Stream Service"?r="Feature Layer":e==="Geoprocessing Service"?r=t.includes("Web Tool")?"Tool":"Geoprocessing Service":e==="Geoenrichment Service"?r="GeoEnrichment Service":e==="Geocoding Service"?r="Locator":e==="Microsoft Powerpoint"?r="Microsoft PowerPoint":e==="GeoJson"?r="GeoJSON":e==="Globe Service"?r="Globe Layer":e==="Vector Tile Service"?r="Tile Layer":e==="netCDF"?r="NetCDF":e==="Map Service"?r=t.includes("Spatiotemporal")||!t.includes("Hosted Service")&&!t.includes("Tiled")||t.includes("Relational")?"Map Image Layer":"Tile Layer":e&&e.toLowerCase().includes("add in")?r=e.replaceAll(/(add in)/gi,"Add-In"):e==="datastore catalog service"?r="Big Data File Share":e==="Compact Tile Package"?r="Tile Package (tpkx)":e==="Raster function template"?r="Raster Function Template":e==="OGCFeatureServer"?r="OGC Feature Layer":e==="web mapping application"&&t.includes("configurableApp")?r="Instant App":e==="Insights Page"?r="Insights Report":e==="Excalibur Imagery Project"?r="Excalibur Project":e==="3DTiles Service"?r="3D tiles layer":e==="3DTiles Package"&&(r="3D tiles package"),r}readExtent(e){return e&&e.length?new Ne(e[0][0],e[0][1],e[1][0],e[1][1]):null}get iconUrl(){var v;const e=((v=this.type)==null?void 0:v.toLowerCase())||"",t=this.typeKeywords||[],r="esri/images/portal/",i="16";let n,s=!1,o=!1,a=!1,u=!1,c=!1,h=!1,d=!1,y=!1;return e.indexOf("service")>0||e==="feature collection"||e==="kml"||e==="wms"||e==="wmts"||e==="wfs"?(s=t.includes("Hosted Service"),e==="feature service"||e==="feature collection"||e==="kml"||e==="wfs"?(o=t.includes("Table"),a=t.includes("Route Layer"),u=t.includes("Markup"),c=t.includes("Spatiotemporal"),h=t.includes("UtilityNetwork"),n=c&&o?"spatiotemporaltable":o?"table":a?"routelayer":u?"markup":c?"spatiotemporal":h?"utilitynetwork":s?"featureshosted":"features"):e==="map service"||e==="wms"||e==="wmts"?(c=t.includes("Spatiotemporal"),d=t.includes("Relational"),n=c||d?"mapimages":s||t.includes("Tiled")||e==="wmts"?"maptiles":"mapimages"):n=e==="scene service"?t.includes("Line")?"sceneweblayerline":t.includes("3DObject")?"sceneweblayermultipatch":t.includes("Point")?"sceneweblayerpoint":t.includes("IntegratedMesh")?"sceneweblayermesh":t.includes("PointCloud")?"sceneweblayerpointcloud":t.includes("Polygon")?"sceneweblayerpolygon":t.includes("Building")?"sceneweblayerbuilding":t.includes("Voxel")?"sceneweblayervoxel":"sceneweblayer":e==="image service"?t.includes("Elevation 3D Layer")?"elevationlayer":t.includes("Tiled Imagery")?"tiledimagerylayer":"imagery":e==="stream service"?"streamlayer":e==="vector tile service"?"vectortile":e==="datastore catalog service"?"datastorecollection":e==="geocoding service"?"geocodeservice":e==="video service"?t.includes("Live Stream")?"livestreamvideolayer":"videolayer":e==="geoprocessing service"?t.includes("Web Tool")?"tool":"layers":e==="geodata service"?"geodataservice":e==="3dtiles service"?t.includes("3DObject")?"3dobjecttileslayer":t.includes("IntegratedMesh")?"integratedmeshtileslayer":"3dtileslayer":"layers"):e==="web map"||e==="cityengine web scene"?n="maps":e==="web scene"?n=t.includes("ViewingMode-Local")?"webscenelocal":"websceneglobal":e==="web mapping application"&&t.includes("configurableApp")?n="instantapps":e==="web mapping application"||e==="mobile application"||e==="application"||e==="operation view"||e==="desktop application"?n="apps":e==="map document"||e==="map package"||e==="published map"||e==="scene document"||e==="globe document"||e==="basemap package"||e==="mobile basemap package"||e==="mobile map package"||e==="project package"||e==="project template"||e==="pro map"||e==="layout"||e==="layer"&&t.includes("ArcGIS Pro")||e==="explorer map"&&t.indexOf("Explorer Document")?n="mapsgray":e==="service definition"||e==="shapefile"||e==="cad drawing"||e==="geojson"||e==="netcdf"||e==="administrative report"?n="datafiles":e==="360 vr experience"?n="360vr":e==="explorer add in"||e==="desktop add in"||e==="windows viewer add in"||e==="windows viewer configuration"?n="appsgray":e==="arcgis pro add in"||e==="arcgis pro configuration"?n="addindesktop":e==="pdf"?n="pdf":e==="microsoft word"?n="word":e==="microsoft excel"?n="excel":e==="microsoft powerpoint"?n="ppt":e==="rule package"||e==="file geodatabase"||e==="sqlite geodatabase"||e==="csv collection"||e==="kml collection"||e==="windows mobile package"||e==="map template"||e==="desktop application template"||e==="gml"||e==="arcpad package"||e==="code sample"||e==="document link"||e==="earth configuration"||e==="operations dashboard add in"||e==="rules package"||e==="workflow manager package"||e==="explorer map"&&t.includes("Explorer Mapping Application")||t.includes("Document")?n="datafilesgray":e==="network analysis service"||e==="geoprocessing service"||e==="geodata service"||e==="geometry service"||e==="geoprocessing package"||e==="locator package"||e==="geoprocessing sample"||e==="workflow manager service"?n="toolsgray":e==="layer"||e==="layer package"||e==="explorer layer"?n="layersgray":e==="scene package"?n="scenepackage":e==="3dtiles package"?n="3dtileslayerpackage":e==="3dtiles service"?n="3dtileslayer":e==="mobile scene package"?n="mobilescenepackage":e==="tile package"||e==="compact tile package"?n="tilepackage":e==="task file"?n="taskfile":e==="report template"?n="report-template":e==="statistical data collection"?n="statisticaldatacollection":e==="insights workbook"?n="workbook":e==="insights model"?n="insightsmodel":e==="insights page"?n="insightspage":e==="insights theme"?n="insightstheme":e==="hub initiative"?n="hubinitiative":e==="hub page"?n="hubpage":e==="hub site application"?n="hubsite":e==="hub event"?n="hubevent":e==="hub project"?n="hubproject":e==="relational database connection"?n="relationaldatabaseconnection":e==="big data file share"?n="datastorecollection":e==="image collection"?n="imagecollection":e==="desktop style"?n="desktopstyle":e==="style"?n="style":e==="dashboard"?n="dashboard":e==="raster function template"?n="rasterprocessingtemplate":e==="vector tile package"?n="vectortilepackage":e==="ortho mapping project"?n="orthomappingproject":e==="ortho mapping template"?n="orthomappingtemplate":e==="solution"?n="solutions":e==="geopackage"?n="geopackage":e==="deep learning package"?n="deeplearningpackage":e==="real time analytic"?n="realtimeanalytics":e==="big data analytic"?n="bigdataanalytics":e==="feed"?n="feed":e==="excalibur imagery project"?n="excaliburimageryproject":e==="notebook"?n="notebook":e==="storymap"?n="storymap":e==="survey123 add in"?n="survey123addin":e==="mission"?n="mission":e==="mission report"?n="missionreport":e==="mission template"?n="missiontemplate":e==="quickcapture project"?n="quickcaptureproject":e==="pro report"?n="proreport":e==="pro report template"?n="proreporttemplate":e==="urban model"?n="urbanmodel":e==="web experience"?n="experiencebuilder":e==="web experience template"?n="webexperiencetemplate":e==="experience builder widget"?n="experiencebuilderwidget":e==="experience builder widget package"?n="experiencebuilderwidgetpackage":e==="workflow"?n="workflow":e==="kernel gateway connection"?n="kernelgatewayconnection":e==="insights script"?n="insightsscript":e==="hub initiative template"?n="hubinitiativetemplate":e==="storymap theme"?n="storymaptheme":e==="knowledge graph"?n="knowledgegraph":e==="knowledge studio project"?n="knowledgestudio":e==="native application"?n="nativeapp":e==="native application installer"?n="nativeappinstaller":e==="web link chart"?n="linkchart":e==="knowledge graph web investigation"?n="investigation":e==="ogcfeatureserver"?n="features":e==="pro project"?n="proproject":e==="insights workbook package"?n="insightsworkbookpackage":e==="apache parquet"?n="apacheparquet":e==="notebook code snippets"||e==="notebook code snippet library"?n="notebookcodesnippets":e==="suitability model"?n="suitabilitymodel":e==="esri classifier definition"?n="classifierdefinition":e==="esri classification schema"?n="classificationschema":e==="insights data engineering workbook"?n="dataengineeringworkbook":e==="insights data engineering model"?n="dataengineeringmodel":e==="deep learning studio project"?n="deeplearningproject":e==="discussion"?n="discussion":e==="allsource project"?n="allsourceproject":e==="api key"?n="apikey":e==="data pipeline"?n="datapipelines":e==="group layer"?(y=t.includes("Map"),n=y?"layergroup2d":"layergroup"):n=e==="media layer"?"onlinemedialayer":e==="form"?t.includes("Survey123")?"survey":"datafilesgray":e==="csv"?"csv":e==="image"?"image":"maps",n?Rt(r+n+i+".png"):null}get isLayer(){return this.type!=null&&Yge.has(this.type)}get itemCdnUrl(){return S4(this.itemUrl)}get itemPageUrl(){var t;const e=(t=this.portal)==null?void 0:t.itemPageUrl;return e&&this.id?`${e}?id=${this.id}`:null}get itemUrl(){var t;const e=(t=this.portal)==null?void 0:t.restUrl;return e&&this.id?`${e}/content/items/${this.id}`:null}get thumbnailUrl(){var r;const e=this.itemUrl,t=this.thumbnail;return e&&t?((r=this.portal)==null?void 0:r.normalizeUrl(`${e}/info/${t}?f=json`))??null:null}get userItemUrl(){var r,i,n;const e=(r=this.portal)==null?void 0:r.restUrl;if(!e)return null;const t=this.owner||((n=(i=this.portal)==null?void 0:i.user)==null?void 0:n.username);return t?`${e}/content/users/${this.ownerFolder?`${t}/${this.ownerFolder}`:t}/items/${this.id}`:null}load(e){const t=this.portal??(this.portal=ts.getDefault()),r=t.load(e).then(()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?t.request(this.itemUrl,{signal:e!=null?e.signal:null,query:{token:this.apiKey}}):{}).then(i=>{this.sourceJSON=i,this.read(i)});return this.addResolvingPromise(r),Promise.resolve(this)}async addRating(e){const t={method:"post",query:{}};return e instanceof sM&&(e=e.rating),e==null||isNaN(e)||typeof e!="number"||(t.query.rating=e),this.portal?(await this.portal.request(this.itemUrl+"/addRating",t),new sM({rating:e,created:new Date})):null}clone(){const e={access:this.access,accessInformation:this.accessInformation,applicationProxies:B(this.applicationProxies),avgRating:this.avgRating,categories:B(this.categories),created:B(this.created),culture:this.culture,description:this.description,extent:B(this.extent),groupCategories:B(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:B(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:B(this.screenshots),size:this.size,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:B(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:B(this.typeKeywords),url:this.url};this.loaded&&(e.loadStatus="loaded");const t=new Fh({sourceJSON:this.sourceJSON}).set(e);return t._set("isOrgItem",this.isOrgItem),t}createPostQuery(){var r;const e=this.toJSON();for(const i of["tags","typeKeywords","categories"])e[i]=(r=e[i])==null?void 0:r.join(", ");const{extent:t}=e;return t&&(e.extent=JSON.stringify(t)),e}async deleteRating(){await this.portal.request(this.itemUrl+"/deleteRating",{method:"post"})}fetchData(e="json",t){return this.portal.request(this.itemUrl+"/data",{responseType:e,...t,query:{token:this.apiKey}})}async fetchRating(e){const t=await this.portal.request(this.itemUrl+"/rating",{query:{token:this.apiKey},...e});return t.rating!=null?(t.created=new Date(t.created),new sM(t)):null}fetchRelatedItems(e,t){return this.portal.requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...e,token:this.apiKey},...t},Fh)}getThumbnailUrl(e){let t=this.thumbnailUrl;return t&&e&&(t+=`&w=${e}`),t}reload(){return this.portal.request(this.itemUrl??"",{cacheBust:!0,query:{token:this.apiKey}}).then(e=>(this.sourceJSON=e,this.read(e),this))}update(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const t=e==null?void 0:e.data,r={method:"post"};r.query=this.createPostQuery();for(const i in r.query)r.query[i]===null&&(r.query[i]="");return r.query.clearEmptyFields=!0,t!=null&&(typeof t=="string"?r.query.text=t:typeof t=="object"&&(r.query.text=JSON.stringify(t))),this.portal.request(`${this.userItemUrl}/update`,r).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async copy(e){if(!this.id)throw new z("portal:item-does-not-exist","The item does not exist yet");await this.load();const{portal:t,itemUrl:r}=this;await t.signIn();const{copyResources:i,folder:n,tags:s,title:o}=e||{},a={method:"post",query:{copyPrivateResources:i==="all",folder:typeof n=="string"?n:n==null?void 0:n.id,includeResources:!!i,tags:s==null?void 0:s.join(","),title:o}},{itemId:u}=await t.request(`${r}/copy`,a);return new Fh({id:u,portal:t})}updateThumbnail(e){return this.id?this.load().then(()=>this.portal.signIn()).then(()=>{const t=e.thumbnail,r=e.filename,i={method:"post"};if(typeof t=="string")wf(t)?i.query={data:t}:i.query={url:Js(t)},r!=null&&(i.query.filename=r);else{const n=new FormData;r!=null?n.append("file",t,r):n.append("file",t),i.body=n}return this.portal.request(`${this.userItemUrl}/updateThumbnail`,i).then(()=>this.reload())}):Promise.reject(new z("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(e={},t){const{fetchResources:r}=await ge(()=>import("./resourceUtils-DEdV2Y-p.js"),__vite__mapDeps([19,1,2]));return r(this,e,t)}async addResource(e,t,r){const{addOrUpdateResources:i}=await ge(()=>import("./resourceUtils-DEdV2Y-p.js"),__vite__mapDeps([19,1,2]));return e.portalItem=this,await i(this,[{resource:e,content:t,compress:r==null?void 0:r.compress,access:r==null?void 0:r.access}],"add",r),e}async removeResource(e,t){const{removeResource:r}=await ge(()=>import("./resourceUtils-DEdV2Y-p.js"),__vite__mapDeps([19,1,2]));if(e.portalItem&&e.portalItem.itemUrl!==this.itemUrl)throw new z("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return r(this,e,t)}async removeAllResources(e){const{removeAllResources:t}=await ge(()=>import("./resourceUtils-DEdV2Y-p.js"),__vite__mapDeps([19,1,2]));return t(this,e)}resourceFromPath(e){return new Zge({portalItem:this,path:e})}toJSON(){var r,i;const e=this.extent,t={accessInformation:this.accessInformation,categories:B(this.categories),created:(r=this.created)==null?void 0:r.getTime(),description:this.description,extent:e&&[[e.xmin,e.ymin],[e.xmax,e.ymax]],id:this.id,isOrgItem:this.isOrgItem,licenseInfo:this.licenseInfo,modified:(i=this.modified)==null?void 0:i.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,sourceUrl:this.sourceUrl,spatialReference:this.spatialReference,tags:B(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:B(this.typeKeywords),url:this.url};return Moe(t)}static fromJSON(e){if(!e)return null;if(e.declaredClass)throw new Error("JSON object is already hydrated");return new Fh({sourceJSON:e})}_getPostQuery(){const e=this.toJSON();for(const t in e)t==="tags"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="typeKeywords"&&e[t]!==null&&(e[t]=e[t].join(", ")),t==="extent"&&e[t]&&(e[t]=JSON.stringify(e[t]));return e}};l([p({type:["private","shared","org","public"]})],it.prototype,"access",void 0),l([p()],it.prototype,"accessInformation",void 0),l([p({type:String})],it.prototype,"apiKey",void 0),l([p({json:{read:{source:"appProxies"}}})],it.prototype,"applicationProxies",void 0),l([p()],it.prototype,"avgRating",void 0),l([p()],it.prototype,"categories",void 0),l([p({type:Date})],it.prototype,"created",void 0),l([p()],it.prototype,"culture",void 0),l([p()],it.prototype,"description",void 0),l([p({readOnly:!0})],it.prototype,"displayName",null),l([p({type:Ne})],it.prototype,"extent",void 0),l([te("extent")],it.prototype,"readExtent",null),l([p()],it.prototype,"groupCategories",void 0),l([p({readOnly:!0})],it.prototype,"iconUrl",null),l([p()],it.prototype,"id",void 0),l([p({readOnly:!0})],it.prototype,"isLayer",null),l([p({type:Boolean,readOnly:!0})],it.prototype,"isOrgItem",void 0),l([p()],it.prototype,"itemControl",void 0),l([p({readOnly:!0})],it.prototype,"itemPageUrl",null),l([p({readOnly:!0})],it.prototype,"itemUrl",null),l([p()],it.prototype,"licenseInfo",void 0),l([p({type:Date})],it.prototype,"modified",void 0),l([p()],it.prototype,"name",void 0),l([p()],it.prototype,"numComments",void 0),l([p()],it.prototype,"numRatings",void 0),l([p()],it.prototype,"numViews",void 0),l([p()],it.prototype,"owner",void 0),l([p()],it.prototype,"ownerFolder",void 0),l([p({type:ts})],it.prototype,"portal",void 0),l([p()],it.prototype,"screenshots",void 0),l([p()],it.prototype,"size",void 0),l([p()],it.prototype,"snippet",void 0),l([p()],it.prototype,"sourceJSON",void 0),l([p({type:String})],it.prototype,"sourceUrl",void 0),l([p({type:String})],it.prototype,"spatialReference",void 0),l([p()],it.prototype,"tags",void 0),l([p()],it.prototype,"thumbnail",void 0),l([p({readOnly:!0})],it.prototype,"thumbnailUrl",null),l([p()],it.prototype,"title",void 0),l([p()],it.prototype,"type",void 0),l([p()],it.prototype,"typeKeywords",void 0),l([p({type:String,json:{read(e,t){var r;if(Kge.has(t.type)){const i=(r=this.portal)==null?void 0:r.restUrl;e||(e=i&&this.id?`${i}/content/items/${this.id}/data`:null)}return e}}})],it.prototype,"url",void 0),l([p({readOnly:!0})],it.prototype,"userItemUrl",null),it=Fh=l([k("esri.portal.PortalItem")],it);const A1=it,yH=Object.freeze(Object.defineProperty({__proto__:null,default:A1},Symbol.toStringTag,{value:"Module"})),gc=kr.radius,Ko=kr.eccentricitySquared,Xge={a1:gc*Ko,a2:gc*Ko*gc*Ko,a3:gc*Ko*Ko/2,a4:gc*Ko*gc*Ko*2.5,a5:gc*Ko+gc*Ko*Ko/2,a6:1-Ko};1/294.9786982,1/298.257222101,kr.radius,kr.flattening,1/298.257222101,Tp.radius,Tp.flattening,1/192.0430107526882,wl.radius,wl.flattening,1/10.2079945799458,1/43.61604095563141,wl.radius;var W;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.SPHERICAL_ECEF=1]="SPHERICAL_ECEF",e[e.WGS84=2]="WGS84",e[e.WEB_MERCATOR=3]="WEB_MERCATOR",e[e.WGS84_ECEF=4]="WGS84_ECEF",e[e.CGCS2000=5]="CGCS2000",e[e.WGS84_COMPARABLE_LON_LAT=6]="WGS84_COMPARABLE_LON_LAT",e[e.SPHERICAL_MARS_PCPF=7]="SPHERICAL_MARS_PCPF",e[e.GCSMARS2000=8]="GCSMARS2000",e[e.SPHERICAL_MOON_PCPF=9]="SPHERICAL_MOON_PCPF",e[e.GCSMOON2000=10]="GCSMOON2000",e[e.LON_LAT=11]="LON_LAT",e[e.PLATE_CARREE=12]="PLATE_CARREE"})(W||(W={}));const mH={[W.WGS84]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:Jt,[W.SPHERICAL_ECEF]:qy,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:dv,[W.PLATE_CARREE]:Rd,[W.WGS84]:Jt,[W.WGS84_ECEF]:Pd},[W.CGCS2000]:{[W.CGCS2000]:Jt,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:Jt,[W.SPHERICAL_ECEF]:qy,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:Rd,[W.WGS84]:null,[W.WGS84_ECEF]:Pd},[W.GCSMARS2000]:{[W.CGCS2000]:null,[W.GCSMARS2000]:Jt,[W.GCSMOON2000]:null,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:null,[W.SPHERICAL_ECEF]:null,[W.SPHERICAL_MARS_PCPF]:q8,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:null,[W.WGS84]:null,[W.WGS84_ECEF]:null},[W.GCSMOON2000]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:Jt,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:null,[W.SPHERICAL_ECEF]:null,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:z8,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:null,[W.WGS84]:null,[W.WGS84_ECEF]:null},[W.WEB_MERCATOR]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:R1,[W.WGS84_COMPARABLE_LON_LAT]:R1,[W.SPHERICAL_ECEF]:e1e,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:Jt,[W.PLATE_CARREE]:i1e,[W.WGS84]:R1,[W.WGS84_ECEF]:t1e},[W.WGS84_ECEF]:{[W.CGCS2000]:Ld,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Ld,[W.WGS84_COMPARABLE_LON_LAT]:Ld,[W.SPHERICAL_ECEF]:h1e,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:d1e,[W.PLATE_CARREE]:n1e,[W.WGS84]:Ld,[W.WGS84_ECEF]:Jt},[W.SPHERICAL_ECEF]:{[W.CGCS2000]:Od,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Od,[W.WGS84_COMPARABLE_LON_LAT]:Od,[W.SPHERICAL_ECEF]:Jt,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:u1e,[W.PLATE_CARREE]:s1e,[W.WGS84]:Od,[W.WGS84_ECEF]:c1e},[W.SPHERICAL_MARS_PCPF]:{[W.CGCS2000]:null,[W.GCSMARS2000]:W8,[W.GCSMOON2000]:null,[W.LON_LAT]:W8,[W.WGS84_COMPARABLE_LON_LAT]:null,[W.SPHERICAL_ECEF]:null,[W.SPHERICAL_MARS_PCPF]:Jt,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:null,[W.WGS84]:null,[W.WGS84_ECEF]:null},[W.SPHERICAL_MOON_PCPF]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:H8,[W.LON_LAT]:H8,[W.WGS84_COMPARABLE_LON_LAT]:null,[W.SPHERICAL_ECEF]:null,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:Jt,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:null,[W.WGS84]:null,[W.WGS84_ECEF]:null},[W.UNKNOWN]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:null,[W.WGS84_COMPARABLE_LON_LAT]:null,[W.SPHERICAL_ECEF]:null,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:Jt,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:null,[W.WGS84]:null,[W.WGS84_ECEF]:null},[W.LON_LAT]:{[W.CGCS2000]:Jt,[W.GCSMARS2000]:Jt,[W.GCSMOON2000]:Jt,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:Jt,[W.SPHERICAL_ECEF]:qy,[W.SPHERICAL_MARS_PCPF]:q8,[W.SPHERICAL_MOON_PCPF]:z8,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:dv,[W.PLATE_CARREE]:Rd,[W.WGS84]:Jt,[W.WGS84_ECEF]:Pd},[W.WGS84_COMPARABLE_LON_LAT]:{[W.CGCS2000]:null,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Jt,[W.WGS84_COMPARABLE_LON_LAT]:Jt,[W.SPHERICAL_ECEF]:qy,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:null,[W.PLATE_CARREE]:Rd,[W.WGS84]:Jt,[W.WGS84_ECEF]:Pd},[W.PLATE_CARREE]:{[W.CGCS2000]:Cd,[W.GCSMARS2000]:null,[W.GCSMOON2000]:null,[W.LON_LAT]:Cd,[W.WGS84_COMPARABLE_LON_LAT]:Cd,[W.SPHERICAL_ECEF]:o1e,[W.SPHERICAL_MARS_PCPF]:null,[W.SPHERICAL_MOON_PCPF]:null,[W.UNKNOWN]:null,[W.WEB_MERCATOR]:a1e,[W.PLATE_CARREE]:Jt,[W.WGS84]:Cd,[W.WGS84_ECEF]:l1e}};function Qge(e){const t=CA(e,y1e);return mH[t][W.WGS84_COMPARABLE_LON_LAT]}function gH(e,t,r=vH()){return e==null||t==null?null:f1e(e,t,r).projector}function CA(e,t){return e?t.spatialReference===e?t.spatialReferenceId:(t.spatialReference=e,"metersPerUnit"in t&&(t.metersPerUnit=Wu(e,1)),BS(e)?t.spatialReferenceId=W.SPHERICAL_ECEF:nv(e)?t.spatialReferenceId=W.WGS84:rf(e)?t.spatialReferenceId=W.WEB_MERCATOR:kue(e)?t.spatialReferenceId=W.PLATE_CARREE:e.wkt===jue.wkt?t.spatialReferenceId=W.WGS84_ECEF:e.wkid===tf.CGCS2000?t.spatialReferenceId=W.CGCS2000:e.wkt===LO.wkt?t.spatialReferenceId=W.SPHERICAL_MARS_PCPF:e.wkt===kO.wkt?t.spatialReferenceId=W.SPHERICAL_MOON_PCPF:$G(e)?t.spatialReferenceId=W.GCSMARS2000:EG(e)?t.spatialReferenceId=W.GCSMOON2000:t.spatialReferenceId=W.UNKNOWN):W.UNKNOWN}function Jt(e,t,r,i){e!==r&&(r[i++]=e[t++],r[i++]=e[t++],r[i]=e[t])}function R1(e,t,r,i){r[i]=Mm*(e[t]/Jd),r[i+1]=Mm*(bH-2*Math.atan(Math.exp(-e[t+1]/Jd))),r[i+2]=e[t+2]}function e1e(e,t,r,i){const n=e[t]/Jd,s=bH-2*Math.atan(Math.exp(-e[t+1]/Jd)),o=Jd+e[t+2],a=Math.cos(s)*o;r[i]=Math.cos(n)*a,r[i+1]=Math.sin(n)*a,r[i+2]=Math.sin(s)*o}function t1e(e,t,r,i){R1(e,t,r,i),Pd(r,i,r,i)}function r1e(e,t,r,i,n){const s=.4999999*xT,o=ka(Im*e[t+1],-s,s),a=Math.sin(o);r[i++]=Im*e[t]*n.radius,r[i++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),r[i]=e[t+2]}function dv(e,t,r,i){r1e(e,t,r,i,kr)}function Rd(e,t,r,i){r[i]=e[t]*J8,r[i+1]=e[t+1]*J8,r[i+2]=e[t+2]}function Cd(e,t,r,i){r[i]=e[t]*Z8,r[i+1]=e[t+1]*Z8,r[i+2]=e[t+2]}function i1e(e,t,r,i){R1(e,t,r,i),Rd(r,i,r,i)}function n1e(e,t,r,i){Ld(e,t,r,i),Rd(r,i,r,i)}function s1e(e,t,r,i){Od(e,t,r,i),Rd(r,i,r,i)}function o1e(e,t,r,i){Cd(e,t,r,i),qy(r,i,r,i)}function a1e(e,t,r,i){Cd(e,t,r,i),dv(r,i,r,i)}function l1e(e,t,r,i){Cd(e,t,r,i),Pd(r,i,r,i)}function U4(e,t,r,i,n){const s=n+e[t+2],o=Im*e[t+1],a=Im*e[t],u=Math.cos(o)*s;r[i]=Math.cos(a)*u,r[i+1]=Math.sin(a)*u,r[i+2]=Math.sin(o)*s}function z8(e,t,r,i){U4(e,t,r,i,Tp.radius)}function q8(e,t,r,i){U4(e,t,r,i,wl.radius)}function qy(e,t,r,i){U4(e,t,r,i,kr.radius)}function V4(e,t,r,i,n){const s=e[t],o=e[t+1],a=e[t+2],u=Math.sqrt(s*s+o*o+a*a),c=aB(a/(u===0?1:u)),h=Math.atan2(o,s);r[i++]=Mm*h,r[i++]=Mm*c,r[i]=u-n}function H8(e,t,r,i){V4(e,t,r,i,Tp.radius)}function W8(e,t,r,i){V4(e,t,r,i,wl.radius)}function Od(e,t,r,i){V4(e,t,r,i,kr.radius)}function u1e(e,t,r,i){Od(e,t,r,i),dv(r,i,r,i)}function c1e(e,t,r,i){Od(e,t,r,i),Pd(r,i,r,i)}function p1e(e,t,r,i,n){const s=Im*e[t],o=Im*e[t+1],a=e[t+2],u=Math.sin(o),c=Math.cos(o),h=n.radius/Math.sqrt(1-n.eccentricitySquared*u*u);r[i++]=(h+a)*c*Math.cos(s),r[i++]=(h+a)*c*Math.sin(s),r[i++]=(h*(1-n.eccentricitySquared)+a)*u}function Pd(e,t,r,i){p1e(e,t,r,i,kr)}function Ld(e,t,r,i){const n=Xge,s=e[t],o=e[t+1],a=e[t+2];let u,c,h,d,y,v,w,b,_,x,T,I,M,$,A,R,L,C,U,F,j;u=Math.abs(a),c=s*s+o*o,h=Math.sqrt(c),d=c+a*a,y=Math.sqrt(d),F=Math.atan2(o,s),v=a*a/d,w=c/d,$=n.a2/y,A=n.a3-n.a4/y,w>.3?(b=u/y*(1+w*(n.a1+$+v*A)/y),U=Math.asin(b),x=b*b,_=Math.sqrt(1-x)):(_=h/y*(1-v*(n.a5-$-w*A)/y),U=Math.acos(_),x=1-_*_,b=Math.sqrt(x)),T=1-kr.eccentricitySquared*x,I=kr.radius/Math.sqrt(T),M=n.a6*I,$=h-I*_,A=u-M*b,L=_*$+b*A,R=_*A-b*$,C=R/(M/T+L),U+=C,j=L+R*C/2,a<0&&(U=-U),r[i++]=Mm*F,r[i++]=Mm*U,r[i]=j}function h1e(e,t,r,i){Ld(e,t,r,i),qy(r,i,r,i)}function d1e(e,t,r,i){Ld(e,t,r,i),dv(r,i,r,i)}function f1e(e,t,r){if(e==null||t==null||r.source.spatialReference===e&&r.dest.spatialReference===t)return r;const i=CA(e,r.source),n=CA(t,r.dest);return i===W.UNKNOWN&&n===W.UNKNOWN?fi(e,t)?r.projector=Jt:r.projector=null:r.projector=mH[i][n],r}function vH(){return{source:{spatialReference:null,spatialReferenceId:W.UNKNOWN,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:W.UNKNOWN,metersPerUnit:1},projector:Jt}}const y1e={spatialReference:null,spatialReferenceId:W.UNKNOWN},X8e={spatialReference:null,spatialReferenceId:W.UNKNOWN},wH=vH(),Im=jO(1),Mm=oB(1),xT=Math.PI,bH=.5*xT,Jd=kr.radius,J8=Jd*xT/180,Z8=180/(Jd*xT);function ew(e,t,r,i,n,s,o=1){const a=gH(t,n,wH);if(a==null)return!1;if(a===Jt){if(e===i&&r===s)return!0;const c=r+3*o;for(let h=r,d=s;h<c;h++,d++)i[d]=e[h];return!0}const u=r+3*o;for(let c=r,h=s;c<u;c+=3,h+=3)a(e,c,i,h);return!0}const Q8e=Object.freeze(Object.defineProperty({__proto__:null,projectBuffer:ew},Symbol.toStringTag,{value:"Module"}));function Y8(e,t,r,i,n,s){return Nb[0]=e,Nb[1]=t,Nb[2]=r,ew(Nb,i,0,n,s,0,1)}const Nb=Fp();let Db=0,oM=class OA{static fromGE(t){const r=new OA;return r._wkt=t.wkt,r._wkid=t.wkid,r._isInverse=t.isInverse,r}constructor(t){this.uid=Db++,t?(this._wkt=t.wkt!=null?t.wkt:null,this._wkid=t.wkid!=null?t.wkid:-1,this._isInverse=t.isInverse!=null&&t.isInverse===!0):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=Db++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=Db++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=Db++}getInverse(){const t=new OA;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}},ax=class Ng{static cacheKey(t,r){var i,n,s,o,a,u;return[((i=t.wkid)==null?void 0:i.toString())??"-1",((n=t.wkt)==null?void 0:n.toString())??"",((s=t.wkt2)==null?void 0:s.toString())??"",((o=r.wkid)==null?void 0:o.toString())??"-1",((a=r.wkt)==null?void 0:a.toString())??"",((u=r.wkt2)==null?void 0:u.toString())??""].join()}static fromGE(t){const r=new Ng;let i="";for(const n of t.steps){const s=oM.fromGE(n);r.steps.push(s),i+=s.uid.toString()+","}return r._cachedProjection={},r._gtlistentry=null,r._chain=i,r}constructor(t){if(this.steps=[],this._cachedProjection={},this._chain="",this._gtlistentry=null,t==null?void 0:t.steps)for(const r of t.steps)r instanceof oM?this.steps.push(r):this.steps.push(new oM({wkid:r.wkid,wkt:r.wkt,isInverse:r.isInverse}))}getInverse(){const t=new Ng;t.steps=[];for(let r=this.steps.length-1;r>=0;r--){const i=this.steps[r];t.steps.push(i.getInverse())}return t}getGTListEntry(){let t="";for(const r of this.steps)t+=r.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=t),this._gtlistentry}assignCachedGe(t,r,i){this._cachedProjection[Ng.cacheKey(t,r)]=i}getCachedGeTransformation(t,r){let i="";for(const s of this.steps)i+=s.uid.toString()+",";i!==this._chain&&(this._gtlistentry=null,this._cachedProjection={},this._chain=i);const n=this._cachedProjection[Ng.cacheKey(t,r)];return n===void 0?null:n}};function G4(e,t,r){if(t==null||r==null||r.vcsWkid||fi(t,r)||Mp(t)||Mp(r))return null;const i=vm(t)/vm(r);if(i===1)return null;switch(e){case"point":case"esriGeometryPoint":return n=>m1e(n,i);case"polyline":case"esriGeometryPolyline":return n=>v1e(n,i);case"polygon":case"esriGeometryPolygon":return n=>g1e(n,i);case"multipoint":case"esriGeometryMultipoint":return n=>w1e(n,i);case"extent":case"esriGeometryEnvelope":return n=>b1e(n,i);default:return null}}function m1e(e,t){(e==null?void 0:e.z)!=null&&(e.z*=t)}function g1e(e,t){if(e)for(const r of e.rings)for(const i of r)i.length>2&&(i[2]*=t)}function v1e(e,t){if(e)for(const r of e.paths)for(const i of r)i.length>2&&(i[2]*=t)}function w1e(e,t){if(e)for(const r of e.points)r.length>2&&(r[2]*=t)}function b1e(e,t){e&&e.zmin!=null&&e.zmax!=null&&(e.zmin*=t,e.zmax*=t)}let Oa=null,Ep=null,C1=null,a2={};const B4=new Vv;function Hp(){return!!Oa&&CO()}function _H(){return!!Hp()||(Ge(B4),Ap(),!1)}function SH(e,t){return!e||!t||Al(e,t)||_H()}function _1e(e,t){return!Al(e,t)&&!Hp()}function Ap(e){return C1==null&&(C1=Promise.all([SG(),ge(()=>import("./geometryEngineBase-C4ZooLoZ.js"),__vite__mapDeps([20,1,2])).then(t=>t.g),ge(()=>import("./hydrated-Djyd9-Vo.js"),__vite__mapDeps([21,1,2]))])),C1.then(([,t,{hydratedAdapter:r}])=>{Ut(e),Ep=r,Oa=t.default,Oa._enableProjection(Cue),B4.notify()})}function Wp(e,t,r=null,i=null){return Array.isArray(e)?e.length===0?[]:PA(Ep,e,e[0].spatialReference,t,r,i):PA(Ep,[e],e.spatialReference,t,r,i)[0]}function PA(e,t,r,i,n=null,s=null){if(r==null||i==null)return t;if(Al(r,i,n))return t.map(o=>l2(o,r,i));if(n==null&&BS(r))return t.map(o=>l2(o,r,xe.WGS84)).map(o=>fv(o,i));if(n==null&&BS(i))return t.map(o=>fv(o,xe.WGS84)).map(o=>l2(o,xe.WGS84,i));if(n==null){const o=ax.cacheKey(r,i);a2[o]!==void 0?n=a2[o]:((n=TH(r,i,void 0))==null&&(n=new ax),a2[o]=n)}if(Oa==null||e==null)throw new TT;return s!=null?Oa._project(e,t,r,i,n,s):Oa._project(e,t,r,i,n)}function S1e(e,t){const r=xH([e],t);return r.pending!=null?{pending:r.pending,geometry:null}:r.geometries!=null?{pending:null,geometry:r.geometries[0]}:{pending:null,geometry:null}}function xH(e,t){if(!Hp()){for(const r of e)if(r!=null&&!fi(r.spatialReference,t)&&$a(r.spatialReference)&&$a(t)&&!Al(r.spatialReference,t))return Ge(B4),{pending:Ap(),geometries:null}}return{pending:null,geometries:e.map(r=>r==null?null:fi(r.spatialReference,t)?r:$a(r.spatialReference)&&$a(t)?fv(r,t):null)}}function TH(e,t,r=null){if(e==null||t==null)return null;if(Oa==null||Ep==null)throw new TT;const i=Oa._getTransformation(Ep,e,t,r,r==null?void 0:r.spatialReference);return i!==null?ax.fromGE(i):null}function x1e(e,t,r=null){if(Oa==null||Ep==null)throw new TT;const i=Oa._getTransformationBySuitability(Ep,e,t,r,r==null?void 0:r.spatialReference);if(i!==null){const n=[];for(const s of i)n.push(ax.fromGE(s));return n}return[]}let TT=class extends z{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}};function T1e(){Oa=null,Ep=null,C1=null,a2={}}const I1e={get loadPromise(){return C1}};function fv(e,t){try{const r=Wp(e,t);if(r==null)return null;"xmin"in e&&"xmin"in r&&(r.zmin=e.zmin,r.zmax=e.zmax);const i=G4(r.type,e.spatialReference,t);return i!=null&&i(r),r}catch(r){if(!(r instanceof TT))throw r;return null}}async function M1e(e,t,r){const i=e.spatialReference;return i!=null&&t!=null&&await z4(i,t,null,r),fv(e,t)}function Al(e,t,r){return!r&&(!!fi(e,t)||$a(e)&&$a(t)&&!!gH(e,t,wH))}async function z4(e,t,r,i){if(Hp())return ES(i);if(Array.isArray(e)){for(const{source:n,dest:s,geographicTransformation:o}of e)if(n&&s&&!Al(n,s,o))return Ap(i)}else if(e&&t&&!Al(e,t,r))return Ap(i);return ES(i)}function l2(e,t,r){return e?"x"in e?IH(e,t,new Ae,r,0):"xmin"in e?AH(e,t,new Ne,r,0):"rings"in e?EH(e,t,new Ss,r,0):"paths"in e?$H(e,t,new Ea,r,0):"points"in e?MH(e,t,new jv,r,0):null:null}function $1e(e,t,r=t.spatialReference,i=0){return r!=null&&e.spatialReference!=null&&IH(e,e.spatialReference,t,r,i)!=null}function IH(e,t,r,i,n){xn[0]=e.x,xn[1]=e.y;const s=e.z;return xn[2]=s!==void 0?s:n,ew(xn,t,0,xn,i,0,1)?(r.x=xn[0],r.y=xn[1],r.spatialReference=i,s!==void 0||Mp(i)?(r.z=xn[2],r.hasZ=!0):(r.z=void 0,r.hasZ=!1),e.m===void 0?(r.m=void 0,r.hasM=!1):(r.m=e.m,r.hasM=!0),r):null}function E1e(e,t,r=t.spatialReference,i=0){return e.spatialReference!=null&&r!=null&&MH(e,e.spatialReference,t,r,i)!=null}function MH(e,t,r,i,n){const{points:s,hasZ:o,hasM:a}=e,u=[],c=s.length,h=[];for(const y of s)h.push(y[0],y[1],o?y[2]:n);if(!ew(h,t,0,h,i,0,c))return null;const d=o||Mp(i);for(let y=0;y<c;++y){const v=3*y,w=h[v],b=h[v+1];d&&a?u.push([w,b,h[v+2],s[y][3]]):d?u.push([w,b,h[v+2]]):a?u.push([w,b,s[y][2]]):u.push([w,b])}return r.points=u,r.spatialReference=i,r.hasZ=o,r.hasM=a,r}function A1e(e,t,r=t.spatialReference,i=0){return e.spatialReference!=null&&r!=null&&$H(e,e.spatialReference,t,r,i)!=null}function $H(e,t,r,i,n){const{paths:s,hasZ:o,hasM:a}=e,u=[];if(!RH(s,o??!1,a??!1,t,u,i,n))return null;const c=o||Mp(i);return r.paths=u,r.spatialReference=i,r.hasZ=c,r.hasM=a,r}function R1e(e,t,r=t.spatialReference,i=0){return e.spatialReference!=null&&r!=null&&EH(e,e.spatialReference,t,r,i)!=null}function EH(e,t,r,i,n){const{rings:s,hasZ:o,hasM:a}=e,u=[];if(!RH(s,o??!1,a??!1,t,u,i,n))return null;const c=o||Mp(i);return r.rings=u,r.spatialReference=i,r.hasZ=c,r.hasM=a,r}function C1e(e,t,r=t.spatialReference,i=0){return e.spatialReference!=null&&r!=null&&AH(e,e.spatialReference,t,r,i)!=null}function AH(e,t,r,i,n){const{xmin:s,ymin:o,xmax:a,ymax:u,hasZ:c,hasM:h}=e,d=c?e.zmin:n;if(!Y8(s,o,d,t,xn,i))return null;const y=c||Mp(i);r.xmin=xn[0],r.ymin=xn[1],y&&(r.zmin=xn[2]);const v=c?e.zmax:n;return Y8(a,u,v,t,xn,i)?(r.xmax=xn[0],r.ymax=xn[1],y&&(r.zmax=xn[2]),h&&(r.mmin=e.mmin,r.mmax=e.mmax),r.spatialReference=i,r):null}function RH(e,t,r,i,n,s,o=0){const a=new Array;for(const h of e)for(const d of h)a.push(d[0],d[1],t?d[2]:o);if(!ew(a,i,0,a,s,0,a.length/3))return!1;let u=0;n.length=0;const c=t||Mp(s);for(const h of e){const d=new Array;for(const y of h)c&&r?d.push([a[u++],a[u++],a[u++],y[3]]):c?d.push([a[u++],a[u++],a[u++]]):r?(d.push([a[u++],a[u++],y[2]]),u++):(d.push([a[u++],a[u++]]),u++);n.push(d)}return!0}function O1e(e){return e!=null&&Qge(e)!=null}const xn=Fp(),t6e=Object.freeze(Object.defineProperty({__proto__:null,canProjectToWGS84ComparableLonLat:O1e,canProjectWithoutEngine:Al,getTransformation:TH,getTransformations:x1e,initializeProjection:z4,isLoaded:Hp,isLoadedOrLoad:_H,isLoadedOrLoadFor:SH,load:Ap,project:Wp,projectExtent:C1e,projectMany:PA,projectMultipoint:E1e,projectOrLoad:S1e,projectOrLoadMany:xH,projectPoint:$1e,projectPolygon:R1e,projectPolyline:A1e,projectWithZConversion:M1e,projectWithoutEngine:l2,requiresLoad:_1e,test:I1e,tryProjectWithZConversion:fv,unload:T1e},Symbol.toStringTag,{value:"Module"}));async function P1e(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return Vy(e);const r=xe.WGS84;return await z4(t,r),Wp(e,r)}function L1e(e,t){if(!CH(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function CH(e,t){var r;return!!((r=e.typeKeywords)!=null&&r.includes(t))}function K8(e){return CH(e,N1e.HOSTED_SERVICE)}function k1e(e,t){const r=e.typeKeywords;if(r){const i=r.indexOf(t);i>-1&&r.splice(i,1)}}function r6e(e,t,r){r?L1e(e,t):k1e(e,t)}async function i6e(e){const t=e.clone().normalize();let r;if(t.length>1)for(const i of t)r?i.width>r.width&&(r=i):r=i;else r=t[0];return P1e(r)}const N1e={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function X8(e){var u;const{portal:t,isOrgItem:r,itemControl:i}=e,n=(u=t.user)==null?void 0:u.privileges;let s=!n||n.includes("features:user:edit"),o=!!r&&!!(n!=null&&n.includes("features:user:fullEdit"));const a=i==="update"||i==="admin";return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}const Jp=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=cr(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(r){r!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",r))}readPortalItem(r,i,n){if(i.itemId)return new A1({id:i.itemId,portal:n==null?void 0:n.portal})}writePortalItem(r,i){r!=null&&r.id&&(i.itemId=r.id)}async loadFromPortal(r,i){var n;if((n=this.portalItem)!=null&&n.id)try{const{load:s}=await ge(()=>import("./layersLoader-CzXktpVX.js"),__vite__mapDeps([22,18,16,1,2,14,15,23]));return Ut(i),await s({instance:this,supportedTypes:r.supportedTypes,validateItem:r.validateItem,supportsData:r.supportsData,layerModuleTypeMap:r.layerModuleTypeMap},i)}catch(s){throw Ei(s)||oe.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})
  ${s}`),s}}async finishLoadEditablePortalLayer(r){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(r).catch(i=>(Ti(i),!0)))}async setUserPrivileges(r,i){if(!Kt.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(i);if(this.url)try{const{features:{edit:n,fullEdit:s},content:{updateItem:o}}=await this._fetchUserPrivileges(r,i);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",s),this._set("userHasUpdateItemPrivileges",o)}catch(n){Ti(n)}}async _fetchUserPrivileges(r,i){let n=this.portalItem;if(!r||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(i);const s=r===n.id;if(s&&n.portal.user)return X8(n);let o,a;if(s)o=n.portal.url;else try{o=await fH(this.url,i)}catch(d){Ti(d)}if(!o||!Yle(o,n.portal.url))return this._fetchFallbackUserPrivileges(i);try{const d=i!=null?i.signal:null;a=await(pt==null?void 0:pt.getCredential(`${o}/sharing`,{prompt:!1,signal:d}))}catch(d){Ti(d)}const u=!0,c=!1,h=!1;if(!a)return{features:{edit:u,fullEdit:c},content:{updateItem:h}};try{if(s?await n.reload():(n=new A1({id:r,portal:{url:o}}),await n.load(i)),n.portal.user)return X8(n)}catch(d){Ti(d)}return{features:{edit:u,fullEdit:c},content:{updateItem:h}}}async _fetchFallbackUserPrivileges(r){let i=!0;try{i=await this._fetchUserHasEditingPrivileges(r)}catch(n){Ti(n)}return{features:{edit:i,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(r){const i=this.url?pt==null?void 0:pt.findCredential(this.url):null;if(!i)return!0;const n=Fb.credential===i?Fb.user:await this._fetchEditingUser(r);return Fb.credential=i,Fb.user=n,(n==null?void 0:n.privileges)==null||n.privileges.includes("features:user:edit")}async _fetchEditingUser(r){var h,d;const i=(d=(h=this.portalItem)==null?void 0:h.portal)==null?void 0:d.user;if(i)return i;const n=pt.findServerInfo(this.url??"");if(!(n!=null&&n.owningSystemUrl))return null;const s=`${n.owningSystemUrl}/sharing/rest`,o=ts.getDefault();if(o&&o.loaded&&_s(o.restUrl)===_s(s))return o.user;const a=`${s}/community/self`,u=r!=null?r.signal:null,c=await yT(be(a,{authMode:"no-prompt",query:{f:"json"},signal:u}));return c.ok?x4.fromJSON(c.value.data):null}read(r,i){i&&(i.layer=this),super.read(r,i)}write(r,i){var o;const n=i==null?void 0:i.portal,s=((o=this.portalItem)==null?void 0:o.id)&&(this.portalItem.portal||ts.getDefault());return n&&s&&!cG(s.restUrl,n.restUrl)?(i.messages&&i.messages.push(new z("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(r,{...i,layer:this})}};return l([p({type:A1})],t.prototype,"portalItem",null),l([te("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),l([se("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),l([p({clonable:!1})],t.prototype,"resourceReferences",void 0),l([p({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),l([p({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),l([p({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=l([k("esri.layers.mixins.PortalLayer")],t),t},Fb={credential:null,user:null},fp=new $e,O1=new WeakMap;function D1e(e){j1e(e)&&fp.push(new WeakRef(e))}function F1e(e){const t=fp.find(r=>r.deref()===e);t&&fp.remove(t)}function j1e(e){return e!=null&&typeof e=="object"&&"refreshInterval"in e&&"refresh"in e}function OH(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:OH(t,e%t):0}let aM=0,jb=0;function U1e(){const e=Date.now();let t=!1;for(const r of fp){const i=r.deref();i?i.refreshInterval&&e-(O1.get(i)??0)+5>=6e4*i.refreshInterval&&(O1.set(i,e),i.refresh(e)):t=!0}if(t)for(let r=fp.length-1;r>=0;r--)fp.at(r).deref()||fp.removeAt(r)}WV(()=>{const e=Date.now();let t=0;for(const r of fp){const i=r.deref();i&&(t=OH(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?O1.get(i)||O1.set(i,e):O1.delete(i))}if(t!==jb){if(jb=t,clearInterval(aM),jb===0)return void(aM=0);aM=setInterval(U1e,jb)}});const Q8=.1,xf=e=>{let t=class extends e{constructor(...r){super(...r),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=Bx(()=>this.hasDataChanged()),this.when().then(()=>{this.destroyed||D1e(this)},()=>{})}destroy(){F1e(this)}castRefreshInterval(r){return r>=Q8?r:r<=0?0:Q8}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(r=Date.now()){k$(this._debounceHasDataChanged()).then(i=>{i&&this._set("refreshTimestamp",r),this.emit("refresh",{dataChanged:i})},i=>{oe.getLogger(this).error(i),this.emit("refresh",{dataChanged:!1,error:i})})}async hasDataChanged(){return!0}get test(){const r=this;return{set refreshInterval(i){r._set("refreshInterval",i)}}}};return l([p({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:An}}}}})],t.prototype,"refreshInterval",void 0),l([Tt("refreshInterval")],t.prototype,"castRefreshInterval",null),l([p({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),l([p({readOnly:!0})],t.prototype,"refreshParameters",null),t=l([k("esri.layers.mixins.RefreshableLayer")],t),t},Zp=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const r={minScale:this.minScale,maxScale:this.maxScale},i=this.parent;i&&"effectiveScaleRange"in i&&V1e(r,i.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===r.minScale&&n.maxScale===r.maxScale?n:r}};return l([p({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),l([p({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),l([p({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=l([k("esri.layers.mixins.ScaleRangeLayer")],t),t};function V1e(e,t){return e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale,e}const PH=Qr()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});let Dg=class extends It(Q){constructor(t){super(t),this.unit="milliseconds",this.value=0}toMilliseconds(){return Cge(this.value,this.unit,"milliseconds")}};l([Ce(PH,{nonNullable:!0})],Dg.prototype,"unit",void 0),l([p({type:Number,json:{write:!0},nonNullable:!0})],Dg.prototype,"value",void 0),Dg=l([k("esri.TimeInterval")],Dg);const lx=Dg;function e6(e,t){return lx.fromJSON({value:e,unit:t})}let fn=class extends It(Q){constructor(t){super(t),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(t,r){if(!r.timeExtent||!Array.isArray(r.timeExtent)||r.timeExtent.length!==2)return null;const i=new Date(r.timeExtent[0]),n=new Date(r.timeExtent[1]);return new is({start:i,end:n})}writeFullTimeExtent(t,r){(t==null?void 0:t.start)!=null&&t.end!=null?r.timeExtent=[t.start.getTime(),t.end.getTime()]:r.timeExtent=null}readInterval(t,r){return r.timeInterval&&r.timeIntervalUnits?e6(r.timeInterval,r.timeIntervalUnits):r.defaultTimeInterval&&r.defaultTimeIntervalUnits?e6(r.defaultTimeInterval,r.defaultTimeIntervalUnits):null}writeInterval(t,r){r.timeInterval=(t==null?void 0:t.toJSON().value)??null,r.timeIntervalUnits=(t==null?void 0:t.toJSON().unit)??null}};l([p({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],fn.prototype,"cumulative",void 0),l([p({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],fn.prototype,"endField",void 0),l([p({type:is,json:{write:{enabled:!0,allowNull:!0}}})],fn.prototype,"fullTimeExtent",void 0),l([te("fullTimeExtent",["timeExtent"])],fn.prototype,"readFullTimeExtent",null),l([se("fullTimeExtent")],fn.prototype,"writeFullTimeExtent",null),l([p({type:Boolean,json:{write:!0}})],fn.prototype,"hasLiveData",void 0),l([p({type:lx,json:{write:{enabled:!0,allowNull:!0}}})],fn.prototype,"interval",void 0),l([te("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],fn.prototype,"readInterval",null),l([se("interval")],fn.prototype,"writeInterval",null),l([p({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],fn.prototype,"startField",void 0),l([p(xm("timeReference",!0))],fn.prototype,"timeZone",void 0),l([p({type:String,json:{write:{enabled:!0,allowNull:!0}}})],fn.prototype,"trackIdField",void 0),l([p({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],fn.prototype,"useTime",void 0),fn=l([k("esri.layers.support.TimeInfo")],fn);const LH=fn,IT=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(r,i){const n=i.timeInfo.exportOptions;if(!n)return null;const s=n.timeOffset,o=PH.fromJSON(n.timeOffsetUnits);return s&&o?new lx({value:s,unit:o}):null}set timeInfo(r){Vz(r,this.fieldsIndex),this._set("timeInfo",r)}};return l([p({type:is,json:{write:!1}})],t.prototype,"timeExtent",void 0),l([p({type:lx})],t.prototype,"timeOffset",void 0),l([te("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),l([p({value:null,type:LH,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),l([p({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=l([k("esri.layers.mixins.TemporalLayer")],t),t},G1e=[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]];function $m(e){return e!=null&&G1e.some(([t,r])=>e>=t&&e<=r)}const kH={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer"},NH=Object.values(kH),DH=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${NH.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),B1e=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${NH.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),z1e=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function q1e(e){return!!DH.test(e)}function zu(e){if(e==null)return null;const t=Pt(e),r=(t==null?void 0:t.path.match(DH))||(t==null?void 0:t.path.match(B1e));if(!r)return null;const[,i,n,s,o]=r,a=n.indexOf("/");return{title:q4(a!==-1?n.slice(a+1):n),serverType:kH[s.toLowerCase()],sublayer:o!=null&&o!==""?parseInt(o,10):null,url:{path:i}}}function H1e(e){const t=Pt(e).path.match(z1e);return t?{serviceUrl:t[1],sublayerId:Number(t[2])}:null}function q4(e){return(e=e.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function W1e(e,t){const r=[];if(e){const i=zu(e);i!=null&&i.title&&r.push(i.title)}if(t){const i=q4(t);r.push(i)}if(r.length===2){if(r[0].toLowerCase().includes(r[1].toLowerCase()))return r[0];if(r[1].toLowerCase().includes(r[0].toLowerCase()))return r[1]}return r.join(" - ")}function H4(e){if(!e)return!1;const t=".arcgis.com/",r="//services",i="//tiles",n="//features",s=(e=e.toLowerCase()).includes(t),o=e.includes(r)||e.includes(i)||e.includes(n);return s&&o}function J1e(e,t){return e&&Wx(yG(e,t))}function Z1e(e){let{url:t}=e;if(!t)return{url:t};t=yG(t,e.logger);const r=Pt(t),i=zu(r.path);let n;if(i!=null)i.sublayer!=null&&e.layer.layerId==null&&(n=i.sublayer),t=i.url.path;else if(e.nonStandardUrlAllowed){const s=H1e(r.path);s!=null&&(t=s.serviceUrl,n=s.sublayerId)}return{url:Wx(t),layerId:n}}function Y1e(e,t,r,i,n){cf(t,i,"url",n),i.url&&e.layerId!=null&&(i.url=jo(i.url,r,e.layerId.toString()))}function K1e(e){if(!e)return!1;const t=e.toLowerCase(),r=t.includes("/services/"),i=t.includes("/mapserver/wmsserver"),n=t.includes("/imageserver/wmsserver"),s=t.includes("/wmsserver");return r&&(i||n||s)}const X1e={visible:"visibleSublayers"};let Iu=class extends De{constructor(t){super(t),this.scale=0}set layer(t){this._get("layer")!==t&&(this._set("layer",t),this.removeHandles("layer"),t&&this.addHandles([t.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),t.on("wms-sublayer-update",r=>this.notifyChange(X1e[r.propertyName]))],"layer"))}get layers(){return this.visibleSublayers.filter(({name:t})=>t).map(({name:t})=>t).join()}get version(){this.commitProperty("layers");const t=this.layer;return t&&t.commitProperty("imageTransparency"),(this._get("version")||0)+1}get visibleSublayers(){const{layer:t,scale:r}=this,i=t==null?void 0:t.sublayers,n=[],s=o=>{const{minScale:a,maxScale:u,sublayers:c,visible:h}=o;h&&(r===0||(a===0||r<=a)&&(u===0||r>=u))&&(c?c.forEach(s):n.push(o))};return i==null||i.forEach(s),n}toJSON(){const{layer:t,layers:r}=this,{imageFormat:i,imageTransparency:n,version:s}=t;return{format:i,request:"GetMap",service:"WMS",styles:"",transparent:n?"TRUE":"FALSE",version:s,layers:r}}};l([p()],Iu.prototype,"layer",null),l([p({readOnly:!0})],Iu.prototype,"layers",null),l([p({type:Number})],Iu.prototype,"scale",void 0),l([p({readOnly:!0})],Iu.prototype,"version",null),l([p({readOnly:!0})],Iu.prototype,"visibleSublayers",null),Iu=l([k("esri.layers.support.ExportWMSImageParameters")],Iu);async function ux(e,t,r){let i;try{i=await createImageBitmap(e)}catch(n){throw new z("request:server",`Unable to load ${t}`,{url:t,error:n})}return Ut(r),i}async function Em(e,t,r,i,n){let s;try{s=await createImageBitmap(e)}catch(o){throw new z("request:server",`Unable to load tile ${t}/${r}/${i}`,{error:o,level:t,row:r,col:i})}return Ut(n),s}var u2;let Q1e=0,wr=u2=class extends qv(MA){constructor(e){super(e),this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.legendUrl=null,this.legendEnabled=!0,this.layer=null,this.maxScale=0,this.minScale=0,this.name=null,this.parent=null,this.popupEnabled=!1,this.queryable=!1,this.sublayers=null,this.spatialReferences=null,this.title=null,this.addHandles([rs(()=>this.sublayers,"after-add",({item:t})=>{t.parent=this,t.layer=this.layer},di),rs(()=>this.sublayers,"after-remove",({item:t})=>{t.layer=t.parent=null},di),Ue(()=>this.sublayers,(t,r)=>{if(r)for(const i of r)i.layer=i.parent=null;if(t)for(const i of t)i.parent=this,i.layer=this.layer},di),Ue(()=>this.layer,t=>{if(this.sublayers)for(const r of this.sublayers)r.layer=t},di)])}get id(){return this._get("id")??Q1e++}set id(e){this._set("id",e)}readLegendUrl(e,t){return t.legendUrl??t.legendURL??null}get effectiveScaleRange(){const{minScale:e,maxScale:t}=this;return{minScale:e,maxScale:t}}castSublayers(e){return Lr($e.ofType(u2),e)}set visible(e){this._setAndNotifyLayer("visible",e)}clone(){var t,r,i;const e=new u2;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("fullExtent")&&(e.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(e.fullExtents=((t=this.fullExtents)==null?void 0:t.map(n=>n.clone()))??null),this.hasOwnProperty("legendUrl")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(e.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("name")&&(e.name=this.name),this.hasOwnProperty("parent")&&(e.parent=this.parent),this.hasOwnProperty("queryable")&&(e.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(e.sublayers=(r=this.sublayers)==null?void 0:r.map(n=>n.clone())),this.hasOwnProperty("spatialReferences")&&(e.spatialReferences=(i=this.spatialReferences)==null?void 0:i.map(n=>n)),this.hasOwnProperty("visible")&&(e.visible=this.visible),this.hasOwnProperty("title")&&(e.title=this.title),e}_setAndNotifyLayer(e,t){const r=this.layer;this._get(e)!==t&&(this._set(e,t),r&&r.emit("wms-sublayer-update",{propertyName:e,id:this.id}))}};l([p()],wr.prototype,"description",void 0),l([p({readOnly:!0})],wr.prototype,"dimensions",void 0),l([p({type:Ne,json:{name:"extent"}})],wr.prototype,"fullExtent",void 0),l([p()],wr.prototype,"fullExtents",void 0),l([p({type:Number,json:{write:{enabled:!1,overridePolicy:()=>({ignoreOrigin:!0,enabled:!0})}}})],wr.prototype,"id",null),l([p({type:String,json:{name:"legendUrl",write:{ignoreOrigin:!0}}})],wr.prototype,"legendUrl",void 0),l([te("legendUrl",["legendUrl","legendURL"])],wr.prototype,"readLegendUrl",null),l([p({type:Boolean,json:{name:"showLegend",origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],wr.prototype,"legendEnabled",void 0),l([p()],wr.prototype,"layer",void 0),l([p()],wr.prototype,"maxScale",void 0),l([p()],wr.prototype,"minScale",void 0),l([p({readOnly:!0})],wr.prototype,"effectiveScaleRange",null),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],wr.prototype,"name",void 0),l([p()],wr.prototype,"parent",void 0),l([p({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],wr.prototype,"popupEnabled",void 0),l([p({type:Boolean,json:{write:{ignoreOrigin:!0}}})],wr.prototype,"queryable",void 0),l([p()],wr.prototype,"sublayers",void 0),l([Tt("sublayers")],wr.prototype,"castSublayers",null),l([p({type:[Number],json:{read:{source:"spatialReferences"}}})],wr.prototype,"spatialReferences",void 0),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],wr.prototype,"title",void 0),l([p({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],wr.prototype,"visible",null),wr=u2=l([k("esri.layers.support.WMSSublayer")],wr);const LA=wr,t6={84:4326,83:4269,27:4267};function eve(e){if(!e)return null;const t={idCounter:-1};typeof e=="string"&&(e=new DOMParser().parseFromString(e,"text/xml"));const r=e.documentElement;if(r.nodeName==="ServiceExceptionReport"){const he=Array.prototype.slice.call(r.childNodes).map(de=>de.textContent).join(`\r
`);throw new z("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",he)}const i=Mn("Capability",r),n=Mn("Service",r),s=i&&Mn("Request",i);if(!i||!n||!s)return null;const o=Mn("Layer",i);if(!o)return null;const a=r.nodeName==="WMS_Capabilities"||r.nodeName==="WMT_MS_Capabilities"?r.getAttribute("version"):"1.3.0",u=yl("Title",n,"")||yl("Name",n,""),c=yl("AccessConstraints",n,""),h=/^none$/i.test(c)?"":c,d=yl("Abstract",n,""),y=parseInt(yl("MaxWidth",n,"5000"),10),v=parseInt(yl("MaxHeight",n,"5000"),10),w=i6(s,"GetMap"),b=r6(s,"GetMap"),_=Fg(o,a,t);if(!_)return null;let x,T=0;const I=Array.prototype.slice.call(i.childNodes),M=_.sublayers??[],$=he=>{he!=null&&M.push(he)};I.forEach(he=>{he.nodeName==="Layer"&&(T===0?x=he:(T===1&&_.name&&(_.name="",$(Fg(x,a,t))),$(Fg(he,a,t))),T++)});let A=_.sublayers,R=_.extent;const L=_.fullExtents??[];if(A||(A=[]),A.length===0&&A.push(_),!R){const he=new Ne(A[0].extent);_.extent=he.toJSON(),R=_.extent}const C=_.spatialReferences.length>0?_.spatialReferences:FH(_),U=r6(s,"GetFeatureInfo"),F=U?i6(s,"GetFeatureInfo"):null,j=jH(A),q=_.minScale||0,K=_.maxScale||0,X=_.dimensions??[],ne=j.reduce((he,de)=>he.concat(de.dimensions??[]),[]),re=X.concat(ne).filter(VH);let ae=null;if(re.length){const he=re.map(de=>{const{extent:fe}=de;return ive(fe)?fe.map(Se=>Se.getTime()):fe==null?void 0:fe.map(Se=>[Se.min.getTime(),Se.max.getTime()])}).flat(2).filter(Qn);ae={startTimeField:null,endTimeField:null,trackIdField:void 0,timeExtent:[Math.min(...he),Math.max(...he)]}}return{copyright:h,description:d,dimensions:X,extent:R,fullExtents:L,featureInfoFormats:F,featureInfoUrl:U,mapUrl:b,maxWidth:y,maxHeight:v,maxScale:K,minScale:q,layers:j,spatialReferences:C,supportedImageFormatTypes:w,timeInfo:ae,title:u,version:a}}function tve(e){const t=e.filter(r=>r.popupEnabled&&r.name&&r.queryable);return t.length?t.map(({name:r})=>r).join():null}function FH(e){if(e.spatialReferences.length>0)return e.spatialReferences;if(e.sublayers)for(const t of e.sublayers){const r=FH(t);if(r.length>0)return r}return[]}function jH(e){var r;let t=[];for(const i of e)t.push(i),(r=i.sublayers)!=null&&r.length&&(t=t.concat(jH(i.sublayers)),delete i.sublayers);return t}function c2(e,t,r){return t.getAttribute(e)??r}function rve(e,t,r,i){const n=Mn(e,r);return n?c2(t,n,i):i}function Mn(e,t){for(let r=0;r<t.childNodes.length;r++){const i=t.childNodes[r];if(UH(i)&&i.nodeName===e)return i}return null}function p2(e,t){if(t==null)return[];const r=[];for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];UH(n)&&n.nodeName===e&&r.push(n)}return r}function yl(e,t,r){var i;return((i=Mn(e,t))==null?void 0:i.textContent)??r}function J0(e,t,r){if(!e)return null;const i=parseFloat(e.getAttribute("minx")),n=parseFloat(e.getAttribute("miny")),s=parseFloat(e.getAttribute("maxx")),o=parseFloat(e.getAttribute("maxy"));let a,u,c,h;r?(a=isNaN(n)?-Number.MAX_VALUE:n,u=isNaN(i)?-Number.MAX_VALUE:i,c=isNaN(o)?Number.MAX_VALUE:o,h=isNaN(s)?Number.MAX_VALUE:s):(a=isNaN(i)?-Number.MAX_VALUE:i,u=isNaN(n)?-Number.MAX_VALUE:n,c=isNaN(s)?Number.MAX_VALUE:s,h=isNaN(o)?Number.MAX_VALUE:o);const d=new xe({wkid:t});return new Ne({xmin:a,ymin:u,xmax:c,ymax:h,spatialReference:d})}function r6(e,t){const r=Mn(t,e);if(r){const i=Mn("DCPType",r);if(i){const n=Mn("HTTP",i);if(n){const s=Mn("Get",n);if(s){let o=rve("OnlineResource","xlink:href",s,null);if(o)return o.indexOf("&")===o.length-1&&(o=o.substring(0,o.length-1)),sve(o,["service","request"])}}}}return null}function i6(e,t){const r=p2("Operation",e);if(!r.length)return p2("Format",Mn(t,e)).map(({textContent:n})=>n).filter(Qn);const i=[];for(const n of r)if(n.getAttribute("name")===t){const s=p2("Format",n);for(const{textContent:o}of s)o!=null&&i.push(o)}return i}function n6(e,t,r){const i=Mn(t,e);if(!i)return r;const{textContent:n}=i;if(n==null||n==="")return r;const s=Number(n);return isNaN(s)?r:s}function Fg(e,t,r){if(!e)return null;const i={id:r.idCounter++,fullExtents:[],parentLayerId:null,queryable:e.getAttribute("queryable")==="1",spatialReferences:[],sublayers:null},n=Mn("LatLonBoundingBox",e),s=Mn("EX_GeographicBoundingBox",e);let o=null;n&&(o=J0(n,4326)),s&&(o=new Ne(0,0,0,0,new xe({wkid:4326})),o.xmin=parseFloat(yl("westBoundLongitude",s,"0")),o.ymin=parseFloat(yl("southBoundLatitude",s,"0")),o.xmax=parseFloat(yl("eastBoundLongitude",s,"0")),o.ymax=parseFloat(yl("northBoundLatitude",s,"0"))),n||s||(o=new Ne(-180,-90,180,90,new xe({wkid:4326}))),i.minScale=n6(e,"MaxScaleDenominator",0),i.maxScale=n6(e,"MinScaleDenominator",0);const a=["1.0.0","1.1.0","1.1.1"].includes(t)?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach(u=>{var c;if(u.nodeName==="Name")i.name=u.textContent||"";else if(u.nodeName==="Title")i.title=u.textContent||"";else if(u.nodeName==="Abstract")i.description=u.textContent||"";else if(u.nodeName==="BoundingBox"){const h=u.getAttribute(a);if(h&&h.indexOf("EPSG:")===0){const y=parseInt(h.substring(5),10);y===0||isNaN(y)||o||(o=t==="1.3.0"?J0(u,y,$m(y)):J0(u,y))}const d=h&&h.indexOf(":");if(d&&d>-1){let y=parseInt(h.substring(d+1,h.length),10);y===0||isNaN(y)||(y=t6[y]??y);const v=t==="1.3.0"?J0(u,y,$m(y)):J0(u,y);v&&i.fullExtents&&i.fullExtents.push(v)}}else if(u.nodeName===a)(((c=u.textContent)==null?void 0:c.split(" "))??[]).forEach(h=>{const d=h.includes(":")?parseInt(h.split(":")[1],10):parseInt(h,10);if(d!==0&&!isNaN(d)){const y=t6[d]??d;i.spatialReferences.includes(y)||i.spatialReferences.push(y)}});else if(u.nodeName!=="Style"||i.legendUrl){if(u.nodeName==="Layer"){const h=Fg(u,t,r);h&&(h.parentLayerId=i.id,i.sublayers||(i.sublayers=[]),i.sublayers.push(h))}}else{const h=Mn("LegendURL",u);if(h){const d=Mn("OnlineResource",h);d&&(i.legendUrl=d.getAttribute("xlink:href"))}}}),i.extent=o==null?void 0:o.toJSON(),i.dimensions=p2("Dimension",e).filter(u=>u.getAttribute("name")&&u.getAttribute("units")&&u.textContent).map(u=>{const c=u.getAttribute("name"),h=u.getAttribute("units"),d=u.textContent,y=u.getAttribute("unitSymbol")??void 0,v=u.getAttribute("default")??void 0,w=c2("default",u,"0")!=="0",b=c2("nearestValue",u,"0")!=="0",_=c2("current",u,"0")!=="0";return VH({name:c,units:h})?{name:"time",units:"ISO8601",extent:a6(d),default:a6(v),multipleValues:w,nearestValue:b,current:_}:nve({name:c,units:h})?{name:"elevation",units:h,extent:s6(d),unitSymbol:y,default:s6(v),multipleValues:w,nearestValue:b}:{name:c,units:h,extent:o6(d),unitSymbol:y,default:o6(v),multipleValues:w,nearestValue:b}}),i}function ive(e){return Array.isArray(e)&&e.length>0&&e[0]instanceof Date}function UH(e){return e.nodeType===Node.ELEMENT_NODE}function nve(e){return/^elevation$/i.test(e.name)&&/^(epsg|crs):\d+$/i.test(e.units)}function VH(e){return/^time$/i.test(e.name)&&/^iso8601$/i.test(e.units)}function sve(e,t){const r=[],i=Pt(e);for(const n in i.query)i.query.hasOwnProperty(n)&&(t.includes(n.toLowerCase())||r.push(n+"="+i.query[n]));return i.path+(r.length?"?"+r.join("&"):"")}function s6(e){if(!e)return;const t=e.includes("/"),r=e.split(",");return t?r.map(i=>{const n=i.split("/");return n.length<2?null:{min:parseFloat(n[0]),max:parseFloat(n[1]),resolution:n.length>=3&&n[2]!=="0"?parseFloat(n[2]):void 0}}).filter(Qn):r.map(i=>parseFloat(i))}function o6(e){if(!e)return;const t=e.includes("/"),r=e.split(",");return t?r.map(i=>{const n=i.split("/");return n.length<2?null:{min:n[0],max:n[1],resolution:n.length>=3&&n[2]!=="0"?n[2]:void 0}}).filter(Qn):r}function a6(e){if(!e)return;const t=e.includes("/"),r=e.split(",");return t?r.map(i=>{const n=i.split("/");return n.length<2?null:{min:new Date(n[0]),max:new Date(n[1]),resolution:n.length>=3&&n[2]!=="0"?ove(n[2]):void 0}}).filter(Qn):r.map(i=>new Date(i))}function ove(e){const t=/(?:p(\d+y|\d+(?:\.|,)\d+y)?(\d+m|\d+(?:\.|,)\d+m)?(\d+d|\d+(?:\.|,)\d+d)?)?(?:t(\d+h|\d+(?:\.|,)\d+h)?(\d+m|\d+(?:\.|,)\d+m)?(\d+s|\d+(?:\.|,)\d+s)?)?/i,r=e.match(t);return r?{years:Hf(r[1]),months:Hf(r[2]),days:Hf(r[3]),hours:Hf(r[4]),minutes:Hf(r[5]),seconds:Hf(r[6])}:null}function Hf(e){if(!e)return 0;const t=/(?:\d+(?:\.|,)\d+|\d+)/,r=e.match(t);if(!r)return 0;const i=r[0].replace(",",".");return Number(i)}function Wf(e){return e.toISOString().replace(/\.[0-9]{3}/,"")}const l6=new Set([102100,3857,102113,900913]),ave=new Set([3395,54004]);function lve(e,t){let r=e.wkid;return t==null?r:(r!=null&&t.includes(r)||!e.latestWkid||(r=e.latestWkid),r!=null&&l6.has(r)?t.find(i=>l6.has(i))||t.find(i=>ave.has(i))||102100:r)}const lM=new We({bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},{ignoreUnknown:!1});function u6(e){return e==="text/html"}function c6(e){return e==="text/plain"}let gt=class extends zp(IT(xf(Zp(qp(Jp(kl(Yu))))))){constructor(...t){super(...t),this.allSublayers=new ff({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType="WMS",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type="wms",this.version=null,this.addHandles([rs(()=>this.sublayers,"after-add",({item:r})=>{r.parent=r.layer=this},di),rs(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},di),Ue(()=>this.sublayers,(r,i)=>{if(i)for(const n of i)n.layer=n.parent=null;if(r)for(const n of r)n.parent=n.layer=this},di)])}normalizeCtorArgs(t,r){return typeof t=="string"?{url:t,...r}:t}destroy(){this.allSublayers.destroy()}load(t){const r=t!=null?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMS"]},t).catch(Ti).then(()=>this._fetchService(r))),Promise.resolve(this)}readFullExtentFromItemOrMap(t,r){const i=r.extent;return i?new Ne({xmin:i[0][0],ymin:i[0][1],xmax:i[1][0],ymax:i[1][1]}):null}writeFullExtent(t,r){r.extent=[[t.xmin,t.ymin],[t.xmax,t.ymax]]}get featureInfoFormat(){return this.featureInfoFormats==null?null:this.featureInfoFormats.find(u6)??this.featureInfoFormats.find(c6)??null}set featureInfoFormat(t){t==null?(this.revert("featureInfoFormat","service"),this._clearOverride("featureInfoFormat")):(u6(t)||c6(t))&&this._override("featureInfoFormat",t)}readImageFormat(t,r){const i=r.supportedImageFormatTypes;return i&&i.includes("image/png")?"image/png":i&&i[0]}readSpatialReferenceFromItemOrDocument(t,r){return new xe(r.spatialReferences[0])}writeSpatialReferences(t,r){var n;const i=(n=this.spatialReference)==null?void 0:n.wkid;t&&i?(r.spatialReferences=t.filter(s=>s!==i),r.spatialReferences.unshift(i)):r.spatialReferences=t}readSublayersFromItemOrMap(t,r,i){return p6(r.layers,i,r.visibleLayers)}readSublayers(t,r,i){return p6(r.layers,i)}writeSublayers(t,r,i,n){var a,u;r.layers=[];const s=new Map,o=t.flatten(({sublayers:c})=>c??[]);for(const c of o)if(typeof((a=c.parent)==null?void 0:a.id)=="number"){const h=s.get(c.parent.id);h!=null?h.push(c.id):s.set(c.parent.id,[c.id])}for(const c of o){const h={sublayer:c,...n},d=c.write({parentLayerId:typeof((u=c.parent)==null?void 0:u.id)=="number"?c.parent.id:-1},h);if(s.has(c.id)&&(d.sublayerIds=s.get(c.id)),!c.sublayers&&c.name){const y=c.write({},h);delete y.id,r.layers.push(y)}}r.visibleLayers=o.filter(({visible:c,sublayers:h})=>c&&!h).map(({name:c})=>c).toArray()}set url(t){if(!t)return void this._set("url",t);const{path:r,query:i}=Pt(t);for(const s in i)/^(request|service)$/i.test(s)&&delete i[s];const n=No(r,i??{});this._set("url",n)}createExportImageParameters(t,r,i,n){const s=(n==null?void 0:n.pixelRatio)??1,o=$A({extent:t,width:r})*s,a=new Iu({layer:this,scale:o}),{xmin:u,ymin:c,xmax:h,ymax:d,spatialReference:y}=t,v=lve(y,this.spatialReferences),w=this.version==="1.3.0"&&$m(v)?`${c},${u},${d},${h}`:`${u},${c},${h},${d}`,b=a.toJSON();return{bbox:w,[this.version==="1.3.0"?"crs":"srs"]:v==null||isNaN(v)?void 0:"EPSG:"+v,...b}}async fetchImage(t,r,i,n){var d,y;const s=this.mapUrl,o=this.createExportImageParameters(t,r,i,n);if(!o.layers){const v=document.createElement("canvas");return v.width=r,v.height=i,v}const a=(d=n==null?void 0:n.timeExtent)==null?void 0:d.start,u=(y=n==null?void 0:n.timeExtent)==null?void 0:y.end,c=a!=null&&u!=null?a.getTime()===u.getTime()?Wf(a):`${Wf(a)}/${Wf(u)}`:void 0,h={responseType:"image",query:this._mixCustomParameters({width:r,height:i,...o,time:c,...this.refreshParameters}),signal:n==null?void 0:n.signal};return be(s??"",h).then(v=>v.data)}async fetchImageBitmap(t,r,i,n){var y,v;const s=this.mapUrl??"",o=this.createExportImageParameters(t,r,i,n);if(!o.layers){const w=document.createElement("canvas");return w.width=r,w.height=i,w}const a=(y=n==null?void 0:n.timeExtent)==null?void 0:y.start,u=(v=n==null?void 0:n.timeExtent)==null?void 0:v.end,c=a!=null&&u!=null?a.getTime()===u.getTime()?Wf(a):`${Wf(a)}/${Wf(u)}`:void 0,h={responseType:"blob",query:this._mixCustomParameters({width:r,height:i,...o,time:c,...this.refreshParameters}),signal:n==null?void 0:n.signal},{data:d}=await be(s,h);return ux(d,s,n==null?void 0:n.signal)}fetchFeatureInfo(t,r,i,n,s){const o=$A({extent:t,width:r}),a=new Iu({layer:this,scale:o}),u=tve(a.visibleSublayers);if(this.featureInfoUrl==null||u==null)return Promise.resolve([]);if(this.fetchFeatureInfoFunction==null&&this.featureInfoFormat==null)return Promise.resolve([]);const c=this.version==="1.3.0"?{I:n,J:s}:{x:n,y:s},h={query_layers:u,request:"GetFeatureInfo",info_format:this.featureInfoFormat,feature_count:25,width:r,height:i,...c},d={...this.createExportImageParameters(t,r,i),...h},y=this._mixCustomParameters(d);return this.fetchFeatureInfoFunction!=null?this.fetchFeatureInfoFunction(y):this._defaultFetchFeatureInfoFunction(No(this.featureInfoUrl,y))}findSublayerById(t){return this.allSublayers.find(r=>r.id===t)}findSublayerByName(t){return this.allSublayers.find(r=>r.name===t)}serviceSupportsSpatialReference(t){return K1e(this.url)||this.spatialReferences!=null&&this.spatialReferences.some(r=>{const i=r===900913?xe.WebMercator:new xe({wkid:r});return fi(i,t)})}_defaultFetchFeatureInfoFunction(t){const r=document.createElement("iframe");r.src=Jle(t),r.style.border="none",r.style.margin="0",r.style.width="100%",r.setAttribute("sandbox","");const i=new Up({title:this.title,content:r}),n=new Da({sourceLayer:this,popupTemplate:i});return Promise.resolve([n])}async _fetchService(t){var r;if(!this.resourceInfo&&((r=this.parsedUrl)!=null&&r.path)){const{path:i,query:n}=this.parsedUrl,{data:s}=await be(i,{query:{SERVICE:"WMS",REQUEST:"GetCapabilities",...n,...this.customParameters},responseType:"xml",signal:t});this.resourceInfo=eve(s)}if(this.parsedUrl){const i=new bl(this.parsedUrl.path),{httpsDomains:n}=Kt.request;i.scheme!=="https"||i.port&&i.port!=="443"||!i.host||n.includes(i.host)||n.push(i.host)}this.read(this.resourceInfo,{origin:"service"})}_mixCustomParameters(t){if(!this.customLayerParameters&&!this.customParameters)return t;const r={...this.customParameters,...this.customLayerParameters};for(const i in r)t[i.toLowerCase()]=r[i];return t}};function uve(e,t){return e.some(r=>{for(const i in r)if(nG(r,i,null,t))return!0;return!1})}function p6(e,t,r){e=e??[];const i=new Map;e.every(s=>s.id==null)&&(e=B(e)).forEach((s,o)=>s.id=o);for(const s of e){const o=new LA;o.read(s,t),r&&!r.includes(o.name)&&(o.visible=!1),i.set(o.id,o)}const n=[];for(const s of e){const o=s.id!=null?i.get(s.id):null;if(o)if(s.parentLayerId!=null&&s.parentLayerId>=0){const a=i.get(s.parentLayerId);if(!a)continue;a.sublayers||(a.sublayers=new $e),a.sublayers.push(o)}else n.push(o)}return n}l([p({readOnly:!0})],gt.prototype,"allSublayers",void 0),l([p({json:{type:Object,write:!0}})],gt.prototype,"customParameters",void 0),l([p({json:{type:Object,write:!0}})],gt.prototype,"customLayerParameters",void 0),l([p({type:String,json:{write:!0}})],gt.prototype,"copyright",void 0),l([p()],gt.prototype,"description",void 0),l([p({readOnly:!0})],gt.prototype,"dimensions",void 0),l([p({json:{type:[[Number]],read:{source:"extent"},write:{target:"extent"},origins:{"web-document":{write:{ignoreOrigin:!0}},"portal-item":{write:{ignoreOrigin:!0}}}}})],gt.prototype,"fullExtent",void 0),l([te(["web-document","portal-item"],"fullExtent",["extent"])],gt.prototype,"readFullExtentFromItemOrMap",null),l([se(["web-document","portal-item"],"fullExtent",{extent:{type:[[Number]]}})],gt.prototype,"writeFullExtent",null),l([p()],gt.prototype,"fullExtents",void 0),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],gt.prototype,"featureInfoFormat",null),l([p({type:[String],readOnly:!0})],gt.prototype,"featureInfoFormats",void 0),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],gt.prototype,"featureInfoUrl",void 0),l([p()],gt.prototype,"fetchFeatureInfoFunction",void 0),l([p({type:String,json:{origins:{"web-document":{default:"image/png",type:lM.jsonValues,read:{reader:lM.read,source:"format"},write:{writer:lM.write,target:"format"}}}}})],gt.prototype,"imageFormat",void 0),l([te("imageFormat",["supportedImageFormatTypes"])],gt.prototype,"readImageFormat",null),l([p({type:Number,json:{read:{source:"maxHeight"},write:{target:"maxHeight"}}})],gt.prototype,"imageMaxHeight",void 0),l([p({type:Number,json:{read:{source:"maxWidth"},write:{target:"maxWidth"}}})],gt.prototype,"imageMaxWidth",void 0),l([p()],gt.prototype,"imageTransparency",void 0),l([p(j4)],gt.prototype,"legendEnabled",void 0),l([p({type:["show","hide","hide-children"]})],gt.prototype,"listMode",void 0),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],gt.prototype,"mapUrl",void 0),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],gt.prototype,"isReference",void 0),l([p({type:["WMS"]})],gt.prototype,"operationalLayerType",void 0),l([p()],gt.prototype,"resourceInfo",void 0),l([p({type:xe,json:{origins:{service:{read:{source:"extent.spatialReference"}}},write:!1}})],gt.prototype,"spatialReference",void 0),l([te(["web-document","portal-item"],"spatialReference",["spatialReferences"])],gt.prototype,"readSpatialReferenceFromItemOrDocument",null),l([p({type:[Ke],json:{read:!1,origins:{service:{read:!0},"web-document":{read:!1,write:{ignoreOrigin:!0}},"portal-item":{read:!1,write:{ignoreOrigin:!0}}}}})],gt.prototype,"spatialReferences",void 0),l([se(["web-document","portal-item"],"spatialReferences")],gt.prototype,"writeSpatialReferences",null),l([p({type:$e.ofType(LA),json:{write:{target:"layers",overridePolicy(e,t,r){if(uve(this.allSublayers,r))return{ignoreOrigin:!0}}}}})],gt.prototype,"sublayers",void 0),l([te(["web-document","portal-item"],"sublayers",["layers","visibleLayers"])],gt.prototype,"readSublayersFromItemOrMap",null),l([te("service","sublayers",["layers"])],gt.prototype,"readSublayers",null),l([se("sublayers",{layers:{type:[LA]},visibleLayers:{type:[String]}})],gt.prototype,"writeSublayers",null),l([p({json:{read:!1},readOnly:!0,value:"wms"})],gt.prototype,"type",void 0),l([p(Qv)],gt.prototype,"url",null),l([p({type:String,json:{write:{ignoreOrigin:!0}}})],gt.prototype,"version",void 0),gt=l([k("esri.layers.WMSLayer")],gt);const GH=gt,l6e=Object.freeze(Object.defineProperty({__proto__:null,default:GH},Symbol.toStringTag,{value:"Module"}));var kA;let tl=kA=class extends Q{constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new kA({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};l([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],tl.prototype,"cols",void 0),l([p({type:Ke,json:{write:!0}})],tl.prototype,"level",void 0),l([p({type:String,json:{write:!0}})],tl.prototype,"levelValue",void 0),l([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],tl.prototype,"origin",void 0),l([p({type:Number,json:{write:!0}})],tl.prototype,"resolution",void 0),l([p({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],tl.prototype,"rows",void 0),l([p({type:Number,json:{write:!0}})],tl.prototype,"scale",void 0),tl=kA=l([k("esri.layers.support.LOD")],tl);const Et=tl;let BH=class{constructor(t,r,i,n,s=void 0){this.id=t,this.level=r,this.row=i,this.col=n,this.extent=s}};var Oc;const h6=new We({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let qi=Oc=class extends Q{static create(e={}){const{resolutionFactor:t=1,scales:r,size:i=256,spatialReference:n=xe.WebMercator,numLODs:s=24}=e;if(!$a(n)){const d=[];if(r)for(let y=0;y<r.length;y++){const v=r[y];d.push(new Et({level:y,scale:v,resolution:v}))}else{let y=5e-4;for(let v=s-1;v>=0;v--)d.unshift(new Et({level:v,scale:y,resolution:y})),y*=2}return new Oc({dpi:96,lods:d,origin:new Ae(0,0,n),size:[i,i],spatialReference:n})}const o=Xn(n),a=e.origin?new Ae({x:e.origin.x,y:e.origin.y,spatialReference:n}):new Ae(o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),u=96,c=1/(Wu(n)*39.37*u),h=[];if(r)for(let d=0;d<r.length;d++){const y=r[d],v=y*c;h.push(new Et({level:d,scale:y,resolution:v}))}else{let d=OO(n)?512/i*5916575275917094e-7:256/i*591657527591555e-6;const y=Math.ceil(s/t);h.push(new Et({level:0,scale:d,resolution:d*c}));for(let v=1;v<y;v++){const w=d/2**t,b=w*c;h.push(new Et({level:v,scale:w,resolution:b})),d=w}}return new Oc({dpi:u,lods:h,origin:a,size:[i,i],spatialReference:n})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const r=Xn(e);return e.isWrappable&&!!r&&Math.abs(r.origin[0]-t.x)<=r.dx}return!1}readOrigin(e,t){return Ae.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,r=0;const i=[],n=this._levelToLOD={};e&&(t=-1/0,r=1/0,e.forEach(s=>{i.push(s.scale),t=s.scale>t?s.scale:t,r=s.scale<r?s.scale:r,n[s.level]=s})),this._set("scales",i),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const r=Math.floor(e),i=r+1;return t[r]/(t[r]/t[i])**(e-r)}scaleToZoom(e){const t=this.scales,r=t.length-1;let i=0;for(;i<r;i++){const n=t[i],s=t[i+1];if(n<=e)return i;if(s===e)return i+1;if(n>e&&s<e)return i+Math.log(n/e)/Math.log(n/s)}return i}snapScale(e,t=.95){const r=this.scaleToZoom(e);return r%Math.floor(r)>=t?this.zoomToScale(Math.ceil(r)):this.zoomToScale(Math.floor(r))}tileAt(e,t,r,i){const n=this.lodAt(e);if(!n)return null;let s,o;if(typeof t=="number")s=t,o=r;else if(fi(t.spatialReference,this.spatialReference))s=t.x,o=t.y,i=r;else{const c=Yx(t,this.spatialReference);if(c==null)return null;s=c.x,o=c.y,i=r}const a=n.resolution*this.size[0],u=n.resolution*this.size[1];return i||(i=new BH(null,0,0,0,ws())),i.level=e,i.row=Math.floor((this.origin.y-o)/u+.001),i.col=Math.floor((s-this.origin.x)/a+.001),this.updateTileInfo(i),i}updateTileInfo(e,t=Oc.ExtrapolateOptions.NONE){let r=this.lodAt(e.level);if(!r&&t===Oc.ExtrapolateOptions.POWER_OF_TWO){const o=this.lods[this.lods.length-1];o.level<e.level&&(r=o)}if(!r)return;const i=e.level-r.level,n=r.resolution*this.size[0]/2**i,s=r.resolution*this.size[1]/2**i;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=ws()),e.extent[0]=this.origin.x+e.col*n,e.extent[1]=this.origin.y-(e.row+1)*s,e.extent[2]=e.extent[0]+n,e.extent[3]=e.extent[1]+s}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||t.parentLevel===-1)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const r=this.lodAt(t.level);if(r==null)return null;const{resolution:i}=r,n=i*this.size[0],s=i*this.size[1];return e[0]=this.origin.x+t.col*n,e[1]=this.origin.y-(t.row+1)*s,e[2]=e[0]+n,e[3]=e[1]+s,e}lodAt(e){var t;return((t=this._levelToLOD)==null?void 0:t[e])??null}clone(){return Oc.fromJSON(this.write({}))}getOrCreateCompatible(e,t){if(this.size[0]===256&&this.size[1]===256)return e===256?this:null;const r=[],i=this.lods.length;for(let n=0;n<i;n++){const s=this.lods[n],o=s.resolution*t;r.push(new Et({level:s.level,scale:s.scale,resolution:o}))}return new Oc({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:r})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let r=0;r<e.length;r++){const i=e[r];this._upsampleLevels[i.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/i.resolution:0},t=i}}};l([p({type:Number,json:{write:!0}})],qi.prototype,"compressionQuality",void 0),l([p({type:Number,json:{write:!0}})],qi.prototype,"dpi",void 0),l([p({type:String,json:{read:h6.read,write:h6.write,origins:{"web-scene":{read:!1,write:!1}}}})],qi.prototype,"format",void 0),l([p({readOnly:!0})],qi.prototype,"isWrappable",null),l([p({type:Ae,json:{write:!0}})],qi.prototype,"origin",void 0),l([te("origin")],qi.prototype,"readOrigin",null),l([p({type:[Et],value:null,json:{write:!0}})],qi.prototype,"lods",null),l([p({readOnly:!0})],qi.prototype,"scales",void 0),l([p({cast:e=>Array.isArray(e)?e:typeof e=="number"?[e,e]:[256,256]})],qi.prototype,"size",void 0),l([te("size",["rows","cols"])],qi.prototype,"readSize",null),l([se("size",{cols:{type:Ke},rows:{type:Ke}})],qi.prototype,"writeSize",null),l([p({type:xe,json:{write:!0}})],qi.prototype,"spatialReference",void 0),qi=Oc=l([k("esri.layers.support.TileInfo")],qi),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(qi||(qi={}));const Uo=qi;var NA;let Mu=NA=class extends Q{constructor(e){super(e)}clone(){return new NA({customLayerParameters:B(this.customLayerParameters),customParameters:B(this.customParameters),layerIdentifier:this.layerIdentifier,tileMatrixSet:this.tileMatrixSet,url:this.url})}};l([p({json:{type:Object,write:!0}})],Mu.prototype,"customLayerParameters",void 0),l([p({json:{type:Object,write:!0}})],Mu.prototype,"customParameters",void 0),l([p({type:String,json:{write:!0}})],Mu.prototype,"layerIdentifier",void 0),l([p({type:String,json:{write:!0}})],Mu.prototype,"tileMatrixSet",void 0),l([p({type:String,json:{write:!0}})],Mu.prototype,"url",void 0),Mu=NA=l([k("esri.layer.support.WMTSLayerInfo")],Mu);var DA;let Ar=DA=class extends zp(xf(Zp(qp(Jp(kl(Yu)))))){constructor(...e){super(...e),this.copyright="",this.fullExtent=new Ne(-20037508342787e-6,-2003750834278e-5,2003750834278e-5,20037508342787e-6,xe.WebMercator),this.legendEnabled=!1,this.isReference=null,this.popupEnabled=!1,this.spatialReference=xe.WebMercator,this.subDomains=null,this.tileInfo=new Uo({size:[256,256],dpi:96,format:"png8",compressionQuality:0,origin:new Ae({x:-20037508342787e-6,y:20037508342787e-6,spatialReference:xe.WebMercator}),spatialReference:xe.WebMercator,lods:[new Et({level:0,scale:591657527591555e-6,resolution:156543.033928}),new Et({level:1,scale:295828763795777e-6,resolution:78271.5169639999}),new Et({level:2,scale:147914381897889e-6,resolution:39135.7584820001}),new Et({level:3,scale:73957190948944e-6,resolution:19567.8792409999}),new Et({level:4,scale:36978595474472e-6,resolution:9783.93962049996}),new Et({level:5,scale:18489297737236e-6,resolution:4891.96981024998}),new Et({level:6,scale:9244648868618e-6,resolution:2445.98490512499}),new Et({level:7,scale:4622324434309e-6,resolution:1222.99245256249}),new Et({level:8,scale:2311162217155e-6,resolution:611.49622628138}),new Et({level:9,scale:1155581108577e-6,resolution:305.748113140558}),new Et({level:10,scale:577790.554289,resolution:152.874056570411}),new Et({level:11,scale:288895.277144,resolution:76.4370282850732}),new Et({level:12,scale:144447.638572,resolution:38.2185141425366}),new Et({level:13,scale:72223.819286,resolution:19.1092570712683}),new Et({level:14,scale:36111.909643,resolution:9.55462853563415}),new Et({level:15,scale:18055.954822,resolution:4.77731426794937}),new Et({level:16,scale:9027.977411,resolution:2.38865713397468}),new Et({level:17,scale:4513.988705,resolution:1.19432856685505}),new Et({level:18,scale:2256.994353,resolution:.597164283559817}),new Et({level:19,scale:1128.497176,resolution:.298582141647617}),new Et({level:20,scale:564.248588,resolution:.14929107082380833}),new Et({level:21,scale:282.124294,resolution:.07464553541190416}),new Et({level:22,scale:141.062147,resolution:.03732276770595208}),new Et({level:23,scale:70.5310735,resolution:.01866138385297604})]}),this.type="web-tile",this.urlTemplate=null,this.wmtsInfo=null}normalizeCtorArgs(e,t){return typeof e=="string"?{urlTemplate:e,...t}:e}load(e){const t=this.loadFromPortal({supportedTypes:["WMTS"]},e).then(()=>{var i;let r="";if(this.urlTemplate)if(this.spatialReference.equals(this.tileInfo.spatialReference)){const n=new bl(this.urlTemplate);!(this.subDomains&&this.subDomains.length>0)&&((i=n.authority)!=null&&i.includes("{subDomain}"))&&(r="is missing 'subDomains' property")}else r="spatialReference must match tileInfo.spatialReference";else r="is missing the required 'urlTemplate' property value";if(r)throw new z("web-tile-layer:load",`WebTileLayer (title: '${this.title}', id: '${this.id}') ${r}`)});return this.addResolvingPromise(t),Promise.resolve(this)}get levelValues(){const e=[];if(!this.tileInfo)return null;for(const t of this.tileInfo.lods)e[t.level]=t.levelValue||t.level;return e}readSpatialReference(e,t){var r;return e||xe.fromJSON((r=t.fullExtent)==null?void 0:r.spatialReference)}get tileServers(){if(!this.urlTemplate)return null;const e=[],{urlTemplate:t,subDomains:r}=this,i=new bl(t),n=i.scheme?i.scheme+"://":"//",s=n+i.authority+"/",o=i.authority;if(o!=null&&o.includes("{subDomain}")){if(r&&r.length>0&&o.split(".").length>1)for(const a of r)e.push(n+o.replaceAll(/\{subDomain\}/gi,a)+"/")}else e.push(s);return e.map(fG)}get urlPath(){if(!this.urlTemplate)return null;const e=this.urlTemplate,t=new bl(e),r=(t.scheme?t.scheme+"://":"//")+t.authority+"/";return e.substring(r.length)}readUrlTemplate(e,t){return e||t.templateUrl}writeUrlTemplate(e,t){io(e)&&(e="https:"+e),e&&(e=e.replaceAll(/\{z\}/gi,"{level}").replaceAll(/\{x\}/gi,"{col}").replaceAll(/\{y\}/gi,"{row}"),e=_s(e)),t.templateUrl=e}fetchTile(e,t,r,i={}){const{signal:n}=i,s=this.getTileUrl(e,t,r),o={responseType:"image",signal:n,query:{...this.refreshParameters}};return be(s,o).then(a=>a.data)}async fetchImageBitmapTile(e,t,r,i={}){const{signal:n}=i;if(this.fetchTile!==DA.prototype.fetchTile){const u=await this.fetchTile(e,t,r,i);return Em(u,e,t,r,n)}const s=this.getTileUrl(e,t,r),o={responseType:"blob",signal:n,query:{...this.refreshParameters}},{data:a}=await be(s,o);return Em(a,e,t,r,n)}getTileUrl(e,t,r){const{levelValues:i,tileServers:n,urlPath:s}=this;if(!i||!n||!s)return"";const o=i[e];return n[t%n.length]+Nx(s,{level:o,z:o,col:r,x:r,row:t,y:t})}};l([p({type:String,value:"",json:{write:!0}})],Ar.prototype,"copyright",void 0),l([p({type:Ne,json:{write:!0},nonNullable:!0})],Ar.prototype,"fullExtent",void 0),l([p({readOnly:!0,json:{read:!1,write:!1}})],Ar.prototype,"legendEnabled",void 0),l([p({type:["show","hide"]})],Ar.prototype,"listMode",void 0),l([p({json:{read:!0,write:!0}})],Ar.prototype,"blendMode",void 0),l([p()],Ar.prototype,"levelValues",null),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Ar.prototype,"isReference",void 0),l([p({type:["WebTiledLayer"],value:"WebTiledLayer"})],Ar.prototype,"operationalLayerType",void 0),l([p({readOnly:!0,json:{read:!1,write:!1}})],Ar.prototype,"popupEnabled",void 0),l([p({type:xe})],Ar.prototype,"spatialReference",void 0),l([te("spatialReference",["spatialReference","fullExtent.spatialReference"])],Ar.prototype,"readSpatialReference",null),l([p({type:[String],json:{write:!0}})],Ar.prototype,"subDomains",void 0),l([p({type:Uo,json:{write:!0}})],Ar.prototype,"tileInfo",void 0),l([p({readOnly:!0})],Ar.prototype,"tileServers",null),l([p({json:{read:!1}})],Ar.prototype,"type",void 0),l([p()],Ar.prototype,"urlPath",null),l([p({type:String,json:{origins:{"portal-item":{read:{source:"url"}}}}})],Ar.prototype,"urlTemplate",void 0),l([te("urlTemplate",["urlTemplate","templateUrl"])],Ar.prototype,"readUrlTemplate",null),l([se("urlTemplate",{templateUrl:{type:String}})],Ar.prototype,"writeUrlTemplate",null),l([p({type:Mu,json:{write:!0}})],Ar.prototype,"wmtsInfo",void 0),Ar=DA=l([k("esri.layers.WebTileLayer")],Ar);const MT=Ar,c6e=Object.freeze(Object.defineProperty({__proto__:null,default:MT},Symbol.toStringTag,{value:"Module"}));let zH=class{constructor(t,r=0,i=t.lods[t.lods.length-1].level){this.tileInfo=t,this.minLOD=r,this.maxLOD=i,t.lodAt(r)||(this.minLOD=t.lods[0].level),t.lodAt(i)||(this.maxLOD=t.lods[t.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(t,r,i){var s;const n=(s=this.tileInfo)==null?void 0:s.lodAt(t);return!n||t<this.minLOD||t>this.maxLOD?"unavailable":n.cols&&n.rows?i>=n.cols[0]&&i<=n.cols[1]&&r>=n.rows[0]&&r<=n.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(t,r,i,n){await ES(n);const s=this.getAvailability(t,r,i);if(s==="unavailable")throw new z("tile-map:tile-unavailable","Tile is not available",{level:t,row:r,col:i});return s}async fetchAvailabilityUpsample(t,r,i,n,s){await ES(s),n.level=t,n.row=r,n.col=i;const o=this.tileInfo;return o.updateTileInfo(n),this.fetchAvailability(t,r,i,s).catch(a=>{if(Ei(a))throw a;if(o.upsampleTile(n))return this.fetchAvailabilityUpsample(n.level,n.row,n.col,n,s);throw a})}};var FA;let ly=FA=class extends Q{constructor(e){super(e),this.fullExtent=null,this.id=null,this.tileInfo=null}clone(){const e=new FA;return this.hasOwnProperty("fullExtent")&&(e.fullExtent=this.fullExtent&&this.fullExtent.clone()),this.hasOwnProperty("id")&&(e.id=this.id),this.hasOwnProperty("tileInfo")&&(e.tileInfo=this.tileInfo&&this.tileInfo.clone()),e}};l([p({type:Ne,json:{read:{source:"fullExtent"}}})],ly.prototype,"fullExtent",void 0),l([p({type:String,json:{read:{source:"id"}}})],ly.prototype,"id",void 0),l([p({type:Uo,json:{read:{source:"tileInfo"}}})],ly.prototype,"tileInfo",void 0),ly=FA=l([k("esri.layer.support.TileMatrixSet")],ly);const cve=ly;var jA;let ou=jA=class extends Q{constructor(e){super(e),this.id=null,this.title=null,this.description=null,this.legendUrl=null}clone(){const e=new jA;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("id")&&(e.id=this.id),this.hasOwnProperty("isDefault")&&(e.isDefault=this.isDefault),this.hasOwnProperty("keywords")&&(e.keywords=this.keywords&&this.keywords.slice()),this.hasOwnProperty("legendUrl")&&(e.legendUrl=this.legendUrl),this.hasOwnProperty("title")&&(e.title=this.title),e}};l([p({json:{read:{source:"id"}}})],ou.prototype,"id",void 0),l([p({json:{read:{source:"title"}}})],ou.prototype,"title",void 0),l([p({json:{read:{source:"abstract"}}})],ou.prototype,"description",void 0),l([p({json:{read:{source:"legendUrl"}}})],ou.prototype,"legendUrl",void 0),l([p({json:{read:{source:"isDefault"}}})],ou.prototype,"isDefault",void 0),l([p({json:{read:{source:"keywords"}}})],ou.prototype,"keywords",void 0),ou=jA=l([k("esri.layer.support.WMTSStyle")],ou);const pve=ou;var UA;let Si=UA=class extends Q{constructor(e){super(e),this.description=null,this.fullExtent=null,this.fullExtents=null,this.id=null,this.imageFormats=null,this.layer=null,this.parent=null,this.styles=null,this.title=null,this.tileMatrixSetId=null,this.tileMatrixSets=null}readFullExtent(e,t){return(e=t.fullExtent)?Ne.fromJSON(e):null}readFullExtents(e,t){var r,i;return(r=t.fullExtents)!=null&&r.length?t.fullExtents.map(n=>Ne.fromJSON(n)):((i=t.tileMatrixSets)==null?void 0:i.map(n=>Ne.fromJSON(n.fullExtent)).filter(n=>n))??[]}get imageFormat(){let e=this._get("imageFormat");return e||(e=this.imageFormats&&this.imageFormats.length?this.imageFormats[0]:""),e}set imageFormat(e){const t=this.imageFormats;e&&(e.includes("image/")||t&&!t.includes(e))&&(e.includes("image/")||(e="image/"+e),t&&!t.includes(e))?console.error("The layer doesn't support the format of "+e):this._set("imageFormat",e)}get styleId(){var t,r;let e=this._get("styleId");return e||(e=((r=(t=this.styles)==null?void 0:t.at(0))==null?void 0:r.id)??""),e}set styleId(e){this._set("styleId",e)}get tileMatrixSet(){return this.tileMatrixSets?this.tileMatrixSets.find(e=>e.id===this.tileMatrixSetId):null}clone(){var t,r,i;const e=new UA;return this.hasOwnProperty("description")&&(e.description=this.description),this.hasOwnProperty("imageFormats")&&(e.imageFormats=this.imageFormats&&this.imageFormats.slice()),this.hasOwnProperty("imageFormat")&&(e.imageFormat=this.imageFormat),this.hasOwnProperty("fullExtent")&&(e.fullExtent=(t=this.fullExtent)==null?void 0:t.clone()),this.hasOwnProperty("id")&&(e.id=this.id),this.hasOwnProperty("layer")&&(e.layer=this.layer),this.hasOwnProperty("styleId")&&(e.styleId=this.styleId),this.hasOwnProperty("styles")&&(e.styles=(r=this.styles)==null?void 0:r.clone()),this.hasOwnProperty("tileMatrixSetId")&&(e.tileMatrixSetId=this.tileMatrixSetId),this.hasOwnProperty("tileMatrixSets")&&(e.tileMatrixSets=(i=this.tileMatrixSets)==null?void 0:i.clone()),this.hasOwnProperty("title")&&(e.title=this.title),e}};l([p()],Si.prototype,"description",void 0),l([p()],Si.prototype,"fullExtent",void 0),l([te("fullExtent",["fullExtent"])],Si.prototype,"readFullExtent",null),l([p({readOnly:!0})],Si.prototype,"fullExtents",void 0),l([te("fullExtents",["fullExtents","tileMatrixSets"])],Si.prototype,"readFullExtents",null),l([p()],Si.prototype,"id",void 0),l([p()],Si.prototype,"imageFormat",null),l([p({json:{read:{source:"formats"}}})],Si.prototype,"imageFormats",void 0),l([p()],Si.prototype,"layer",void 0),l([p()],Si.prototype,"parent",void 0),l([p()],Si.prototype,"styleId",null),l([p({type:$e.ofType(pve),json:{read:{source:"styles"}}})],Si.prototype,"styles",void 0),l([p({json:{write:{ignoreOrigin:!0}}})],Si.prototype,"title",void 0),l([p()],Si.prototype,"tileMatrixSetId",void 0),l([p({readOnly:!0})],Si.prototype,"tileMatrixSet",null),l([p({type:$e.ofType(cve),json:{read:{source:"tileMatrixSets"}}})],Si.prototype,"tileMatrixSets",void 0),Si=UA=l([k("esri.layers.support.WMTSSublayer")],Si);const yv=Si;function cx(e,t){if(e&&t){for(const r of e.children)if(r.localName in t){const i=t[r.localName];if(typeof i=="function"){const n=i(r);n&&cx(r,n)}else cx(r,i)}}}function*hve(e,t){for(const r of e.children)if(r.localName in t){const i=t[r.localName];typeof i=="function"?yield i(r):yield*hve(r,i)}}const qH=90.71428571428571;function d6(e){const t=e.replaceAll(/ows:/gi,"");if(!zr("Contents",new DOMParser().parseFromString(t,"text/xml").documentElement))throw new z("wmtslayer:wmts-capabilities-xml-is-not-valid","the wmts get capabilities response is not compliant",{text:e})}function dve(e,t){var R;e=e.replaceAll(/ows:/gi,"");const r=new DOMParser().parseFromString(e,"text/xml").documentElement,i=new Map,n=new Map,s=zr("Contents",r);if(!s)throw new z("wmtslayer:wmts-capabilities-xml-is-not-valid");const o=zr("OperationsMetadata",r),a=o==null?void 0:o.querySelector("[name='GetTile']"),u=a==null?void 0:a.getElementsByTagName("Get"),c=u&&Array.prototype.slice.call(u),h=(R=t.url)==null?void 0:R.indexOf("https"),d=h!==void 0&&h>-1;let y,v,w=t.serviceMode,b=t==null?void 0:t.url;if(c!=null&&c.length&&c.some(L=>{const C=zr("Constraint",L);return!C||jg("AllowedValues","Value",w,C)?(b=L.attributes[0].nodeValue,!0):(!C||jg("AllowedValues","Value","RESTful",C)||jg("AllowedValues","Value","REST",C)?v=L.attributes[0].nodeValue:C&&!jg("AllowedValues","Value","KVP",C)||(y=L.attributes[0].nodeValue),!1)}),!b)if(v)b=v,w="RESTful";else if(y)b=y,w="KVP";else{const L=zr("ServiceMetadataURL",r);b=L==null?void 0:L.getAttribute("xlink:href")}const _=b.indexOf("1.0.0/");_===-1&&w==="RESTful"?b+="/":_>-1&&(b=b.substring(0,_)),w==="KVP"&&(b+=_>-1?"":"?"),d&&(b=b.replace(/^http:/i,"https:"));const x=xr("ServiceIdentification>ServiceTypeVersion",r),T=xr("ServiceIdentification>AccessConstraints",r),I=T&&/^none$/i.test(T)?null:T,M=Rp("Layer",s),$=Rp("TileMatrixSet",s),A=M.map(L=>{const C=xr("Identifier",L);return i.set(C,L),yve(C,L,$,d,x)});return{copyright:I,dimensionMap:n,layerMap:i,layers:A,serviceMode:w,tileUrl:b}}function fve(e){return e.layers.forEach(t=>{var r;(r=t.tileMatrixSets)==null||r.forEach(i=>{var s;const n=i.tileInfo;n&&n.dpi!==96&&((s=n.lods)==null||s.forEach(o=>{var a;o.scale=96*o.scale/n.dpi,o.resolution=JH((a=n.spatialReference)==null?void 0:a.wkid,o.scale*qH/96,i.id)}),n.dpi=96)})}),e}function W4(e){return e.nodeType===Node.ELEMENT_NODE}function zr(e,t){for(let r=0;r<t.childNodes.length;r++){const i=t.childNodes[r];if(W4(i)&&i.nodeName===e)return i}return null}function Rp(e,t){const r=[];for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];W4(n)&&n.nodeName===e&&r.push(n)}return r}function kd(e,t){const r=[];for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];W4(n)&&n.nodeName===e&&r.push(n)}return r.map(i=>i.textContent).filter(Qn)}function xr(e,t){return e.split(">").forEach(r=>{t&&(t=zr(r,t))}),t&&t.textContent}function jg(e,t,r,i){let n;return Array.prototype.slice.call(i.childNodes).some(s=>{if(s.nodeName.includes(e)){const o=zr(t,s),a=o==null?void 0:o.textContent;if(a===r||r.split(":")&&r.split(":")[1]===a)return n=s,!0}return!1}),n}function yve(e,t,r,i,n){const s=xr("Abstract",t),o=kd("Format",t);return{id:e,fullExtent:wve(t),fullExtents:bve(t),description:s,formats:o,styles:_ve(t,i),title:xr("Title",t),tileMatrixSets:Sve(n,t,r)}}function HH(e,t){var h;const r=[],i=(h=e.layerMap)==null?void 0:h.get(t);if(!i)return null;const n=Rp("ResourceURL",i),s=Rp("Dimension",i);let o,a,u,c;return s.length&&(o=xr("Identifier",s[0]),a=kd("Default",s[0])||kd("Value",s[0])),s.length>1&&(u=xr("Identifier",s[1]),c=kd("Default",s[1])||kd("Value",s[1])),e.dimensionMap.set(t,{dimensions:a,dimensions2:c}),n.forEach(d=>{let y=d.getAttribute("template");if(d.getAttribute("resourceType")==="tile"){if(o&&a.length)if(y.includes("{"+o+"}"))y=y.replace("{"+o+"}","{dimensionValue}");else{const v=y.toLowerCase().indexOf("{"+o.toLowerCase()+"}");v>-1&&(y=y.substring(0,v)+"{dimensionValue}"+y.substring(v+o.length+2))}if(u&&c.length)if(y.includes("{"+u+"}"))y=y.replace("{"+u+"}","{dimensionValue2}");else{const v=y.toLowerCase().indexOf("{"+u.toLowerCase()+"}");v>-1&&(y=y.substring(0,v)+"{dimensionValue2}"+y.substring(v+u.length+2))}r.push({template:y,format:d.getAttribute("format"),resourceType:"tile"})}}),r}function mve(e,t,r,i,n,s,o,a){var y,v;const u=gve(e,t,i);if(!((u==null?void 0:u.length)>0))return"";const{dimensionMap:c}=e,h=(y=c.get(t).dimensions)==null?void 0:y[0],d=(v=c.get(t).dimensions2)==null?void 0:v[0];return u[o%u.length].template.replaceAll(/\{Style\}/gi,n??"").replaceAll(/\{TileMatrixSet\}/gi,r??"").replaceAll(/\{TileMatrix\}/gi,s).replaceAll(/\{TileRow\}/gi,""+o).replaceAll(/\{TileCol\}/gi,""+a).replaceAll(/\{dimensionValue\}/gi,h).replaceAll(/\{dimensionValue2\}/gi,d)}function gve(e,t,r){const i=HH(e,t),n=i==null?void 0:i.filter(s=>s.format===r);return(n!=null&&n.length?n:i)??[]}function vve(e,t,r,i){var a,u;const{dimensionMap:n}=e,s=HH(e,t);let o="";if(s&&s.length>0){const c=(a=n.get(t).dimensions)==null?void 0:a[0],h=(u=n.get(t).dimensions2)==null?void 0:u[0];o=s[0].template,o.endsWith(".xxx")&&(o=o.slice(0,-4)),o=o.replaceAll(/\{Style\}/gi,i),o=o.replaceAll(/\{TileMatrixSet\}/gi,r),o=o.replaceAll(/\{TileMatrix\}/gi,"{level}"),o=o.replaceAll(/\{TileRow\}/gi,"{row}"),o=o.replaceAll(/\{TileCol\}/gi,"{col}"),o=o.replaceAll(/\{dimensionValue\}/gi,c),o=o.replaceAll(/\{dimensionValue2\}/gi,h)}return o}function wve(e){const t=zr("WGS84BoundingBox",e),r=t?xr("LowerCorner",t).split(" "):["-180","-90"],i=t?xr("UpperCorner",t).split(" "):["180","90"];return{xmin:parseFloat(r[0]),ymin:parseFloat(r[1]),xmax:parseFloat(i[0]),ymax:parseFloat(i[1]),spatialReference:{wkid:4326}}}function bve(e){const t=[];return cx(e,{BoundingBox:r=>{if(!r.getAttribute("crs"))return;const i=r.getAttribute("crs").toLowerCase(),n=J4(i),s=i.includes("epsg")&&$m(n.wkid);let o,a,u,c;cx(r,{LowerCorner:h=>{[o,a]=h.textContent.split(" ").map(d=>Number.parseFloat(d)),s&&([o,a]=[a,o])},UpperCorner:h=>{[u,c]=h.textContent.split(" ").map(d=>Number.parseFloat(d)),s&&([u,c]=[c,u])}}),t.push({xmin:o,ymin:a,xmax:u,ymax:c,spatialReference:n})}}),t}function _ve(e,t){return Rp("Style",e).map(r=>{const i=zr("LegendURL",r),n=zr("Keywords",r),s=n?kd("Keyword",n):[];let o=i&&i.getAttribute("xlink:href");return t&&(o=o&&o.replace(/^http:/i,"https:")),{abstract:xr("Abstract",r),id:xr("Identifier",r),isDefault:r.getAttribute("isDefault")==="true",keywords:s,legendUrl:o,title:xr("Title",r)}})}function Sve(e,t,r){return Rp("TileMatrixSetLink",t).map(i=>xve(e,i,r))}function xve(e,t,r){const i=zr("TileMatrixSet",t).textContent,n=kd("TileMatrix",t),s=r.find(x=>{const T=zr("Identifier",x),I=T==null?void 0:T.textContent;return!!(I===i||i.split(":")&&i.split(":")[1]===I)}),o=zr("TileMatrixSetLimits",t),a=o&&Rp("TileMatrixLimits",o),u=new Map;if(a!=null&&a.length)for(const x of a){const T=zr("TileMatrix",x).textContent,I=+zr("MinTileRow",x).textContent,M=+zr("MaxTileRow",x).textContent,$=+zr("MinTileCol",x).textContent,A=+zr("MaxTileCol",x).textContent;u.set(T,{minCol:$,maxCol:A,minRow:I,maxRow:M})}const c=xr("SupportedCRS",s).toLowerCase(),h=Tve(s,c),d=h.spatialReference,y=zr("TileMatrix",s),v=[parseInt(xr("TileWidth",y),10),parseInt(xr("TileHeight",y),10)],w=[];n.length?n.forEach((x,T)=>{const I=jg("TileMatrix","Identifier",x,s);w.push(f6(I,c,T,i,u))}):Rp("TileMatrix",s).forEach((x,T)=>{w.push(f6(x,c,T,i,u))});const b=Ive(e,s,h,v,w[0]).toJSON(),_=new Uo({dpi:96,spatialReference:d,size:v,origin:h,lods:w}).toJSON();return{id:i,fullExtent:b,tileInfo:_}}function J4(e){e=e.toLowerCase();let t=parseInt(e.split(":").pop(),10);t!==900913&&t!==3857||(t=102100);const r=$ve(e);return r!=null&&(t=r),{wkid:t}}function Tve(e,t){return WH(zr("TileMatrix",e),t)}function WH(e,t){const r=J4(t),[i,n]=xr("TopLeftCorner",e).split(" ").map(o=>parseFloat(o)),s=t.includes("epsg")&&$m(r.wkid);return new Ae(s?{x:n,y:i,spatialReference:r}:{x:i,y:n,spatialReference:r})}function Ive(e,t,r,i,n){const s=zr("BoundingBox",t);let o,a,u,c,h,d;if(s&&(o=xr("LowerCorner",s).split(" "),a=xr("UpperCorner",s).split(" ")),o&&o.length>1&&a&&a.length>1)u=parseFloat(o[0]),h=parseFloat(o[1]),c=parseFloat(a[0]),d=parseFloat(a[1]);else{const y=zr("TileMatrix",t),v=parseInt(xr("MatrixWidth",y),10),w=parseInt(xr("MatrixHeight",y),10);u=r.x,d=r.y,c=u+v*i[0]*n.resolution,h=d-w*i[1]*n.resolution}return Mve(e,r.spatialReference,r)?new Ne(h,u,d,c,r.spatialReference):new Ne(u,h,c,d,r.spatialReference)}function Mve(e,t,r){return e==="1.0.0"&&$m(t.wkid)&&!(r.spatialReference.isGeographic&&r.x<-90&&r.y>=-90)}var P1;function $ve(e){return e.includes("crs84")||e.includes("crs:84")?P1.CRS84:e.includes("crs83")||e.includes("crs:83")?P1.CRS83:e.includes("crs27")||e.includes("crs:27")?P1.CRS27:null}function f6(e,t,r,i,n){const s=J4(t),o=xr("Identifier",e);let a=parseFloat(xr("ScaleDenominator",e));const u=JH(s.wkid,a,i);a*=96/qH;const c=+xr("MatrixWidth",e),h=+xr("MatrixHeight",e),{maxCol:d=c-1,maxRow:y=h-1,minCol:v=0,minRow:w=0}=n.get(o)??{},{x:b,y:_}=WH(e,t);return new Et({cols:[v,d],level:r,levelValue:o,origin:[b,_],scale:a,resolution:u,rows:[w,y]})}function JH(e,t,r){let i;return i=P.hasOwnProperty(""+e)?P.values[P[e]]:r==="default028mm"?6370997*Math.PI/180:Bue(e).metersPerDegree,7*t/25e3/i}(function(e){e[e.CRS84=4326]="CRS84",e[e.CRS83=4269]="CRS83",e[e.CRS27=4267]="CRS27"})(P1||(P1={}));var VA;const y6={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png","image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""},Eve=new Set(["version","service","request","layer","style","format","tilematrixset","tilematrix","tilerow","tilecol"]);let qt=VA=class extends zp(xf(Zp(qp(Jp(kl(Yu)))))){constructor(...e){super(...e),this.activeLayer=null,this.copyright="",this.customParameters=null,this.customLayerParameters=null,this.fullExtent=null,this.operationalLayerType="WebTiledLayer",this.resourceInfo=null,this.serviceMode="RESTful",this.sublayers=null,this.type="wmts",this.version="1.0.0",this.addHandles([Ue(()=>this.activeLayer,(t,r)=>{var i;r&&!((i=this.sublayers)!=null&&i.includes(r))&&(r.layer=null,r.parent=null),t&&(t.layer=this,t.parent=this)},di),rs(()=>this.sublayers,"after-add",({item:t})=>{t.layer=this,t.parent=this},di),rs(()=>this.sublayers,"after-remove",({item:t})=>{t.layer=null,t.parent=null},di),Ue(()=>this.sublayers,(t,r)=>{if(r)for(const i of r)i.layer=null,i.parent=null;if(t)for(const i of t)i.layer=this,i.parent=this},di)])}normalizeCtorArgs(e,t){return typeof e=="string"?{url:e,...t}:e}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMTS"]},e).catch(Ti).then(()=>this._fetchService(e)).catch(t=>{throw Ti(t),new z("wmtslayer:unsupported-service-data","Invalid response from the WMTS service.",{error:t})})),Promise.resolve(this)}readActiveLayerFromService(e,t,r){this.activeLayer||(this.activeLayer=new yv);let i=t.layers.find(n=>n.id===this.activeLayer.id);return i||(i=t.layers[0]),this.activeLayer.read(i,r),this.activeLayer}readActiveLayerFromItemOrWebDoc(e,t){const{templateUrl:r,wmtsInfo:i}=t,n=r?this._getLowerCasedUrlParams(r):null,s=i==null?void 0:i.layerIdentifier;let o=null;const a=i==null?void 0:i.tileMatrixSet;a&&(Array.isArray(a)?a.length&&(o=a[0]):o=a);const u=n==null?void 0:n.format,c=n==null?void 0:n.style;return new yv({id:s,imageFormat:u,styleId:c,tileMatrixSetId:o})}writeActiveLayer(e,t,r,i){const n=this.activeLayer;t.templateUrl=this.getUrlTemplate(n.id,n.tileMatrixSetId,n.imageFormat,n.styleId);const s=Av("tileMatrixSet.tileInfo",n);t.tileInfo=s?s.toJSON(i):null,t.wmtsInfo={...t.wmtsInfo,layerIdentifier:n.id,tileMatrixSet:n.tileMatrixSetId}}readCustomParameters(e,t){const r=t.wmtsInfo;return r?this._mergeParams(r.customParameters,r.url):null}get fullExtents(){return this.activeLayer.fullExtents}readServiceMode(e,t){return t.templateUrl.includes("?")?"KVP":"RESTful"}readSublayersFromService(e,t,r){return Ave(t.layers,r)}get supportedSpatialReferences(){var e;return((e=this.activeLayer.tileMatrixSets)==null?void 0:e.map(t=>{var r;return(r=t.tileInfo)==null?void 0:r.spatialReference}).toArray().filter(Qn))??[]}get tilemapCache(){var t,r;const e=(r=(t=this.activeLayer)==null?void 0:t.tileMatrixSet)==null?void 0:r.tileInfo;return e?new zH(e):void 0}get title(){var e;return((e=this.activeLayer)==null?void 0:e.title)??"Layer"}set title(e){this._overrideIfSome("title",e)}get url(){return this._get("url")}set url(e){e&&e.substr(-1)==="/"?this._set("url",e.slice(0,-1)):this._set("url",e)}createWebTileLayer(e){const t=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId),r=this._getTileMatrixSetById(e.tileMatrixSetId),i=r==null?void 0:r.tileInfo,n=e.fullExtent,s=new Mu({layerIdentifier:e.id,tileMatrixSet:e.tileMatrixSetId,url:this.url});return this.customLayerParameters&&(s.customLayerParameters=this.customLayerParameters),this.customParameters&&(s.customParameters=this.customParameters),new MT({fullExtent:n,urlTemplate:t,tileInfo:i,wmtsInfo:s})}async fetchTile(e,t,r,i={}){const{signal:n}=i,s=this.getTileUrl(e,t,r),{data:o}=await be(s,{responseType:"image",signal:n});return o}async fetchImageBitmapTile(e,t,r,i={}){const{signal:n}=i;if(this.fetchTile!==VA.prototype.fetchTile){const a=await this.fetchTile(e,t,r,i);return Em(a,e,t,r,n)}const s=this.getTileUrl(e,t,r),{data:o}=await be(s,{responseType:"blob",signal:n});return Em(o,e,t,r,n)}findSublayerById(e){var t;return(t=this.sublayers)==null?void 0:t.find(r=>r.id===e)}getTileUrl(e,t,r){var a;const i=this._getTileMatrixSetById(this.activeLayer.tileMatrixSetId),n=(a=i==null?void 0:i.tileInfo)==null?void 0:a.lods[e],s=n?n.levelValue||`${n.level}`:`${e}`;let o=this.resourceInfo?"":mve({dimensionMap:this.dimensionMap,layerMap:this.layerMap},this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId,s,t,r);return o||(o=this.getUrlTemplate(this.activeLayer.id,this.activeLayer.tileMatrixSetId,this.activeLayer.imageFormat,this.activeLayer.styleId).replaceAll(/\{level\}/gi,s).replaceAll(/\{row\}/gi,`${t}`).replaceAll(/\{col\}/gi,`${r}`)),o=this._appendCustomLayerParameters(o),o}getUrlTemplate(e,t,r,i){if(!this.resourceInfo){const n=vve({dimensionMap:this.dimensionMap,layerMap:this.layerMap},e,t,i);if(n)return n}if(this.serviceMode==="KVP")return this.url+"?SERVICE=WMTS&VERSION="+this.version+"&REQUEST=GetTile&LAYER="+e+"&STYLE="+i+"&FORMAT="+r+"&TILEMATRIXSET="+t+"&TILEMATRIX={level}&TILEROW={row}&TILECOL={col}";if(this.serviceMode==="RESTful"){let n="";return y6[r.toLowerCase()]&&(n=y6[r.toLowerCase()]),this.url+e+"/"+i+"/"+t+"/{level}/{row}/{col}"+n}return""}async _fetchService(e){let t;if(this.resourceInfo)this.resourceInfo.serviceMode==="KVP"&&(this.url+=this.url.includes("?")?"":"?"),t={ssl:!1,data:this.resourceInfo};else try{t=await this._getCapabilities(this.serviceMode,e),d6(t.data)}catch{const r=this.serviceMode==="KVP"?"RESTful":"KVP";try{t=await this._getCapabilities(r,e),d6(t.data),this.serviceMode=r}catch(i){throw new z("wmtslayer:unsupported-service-data","Services does not support RESTful or KVP service modes.",{error:i})}}this.resourceInfo?t.data=fve(t.data):t.data=dve(t.data,{serviceMode:this.serviceMode,url:this.url}),t.data&&this.read(t.data,{origin:"service"})}async _getCapabilities(e,t){const r=this._getCapabilitiesUrl(e);return await be(r,{...t,responseType:"text"})}_getTileMatrixSetById(e){var i;const t=this.findSublayerById(this.activeLayer.id);return(i=t==null?void 0:t.tileMatrixSets)==null?void 0:i.find(n=>n.id===e)}_appendCustomParameters(e){return this._appendParameters(e,this.customParameters)}_appendCustomLayerParameters(e){return this._appendParameters(e,{...B(this.customParameters),...this.customLayerParameters})}_appendParameters(e,t){const r=Pt(e),i={...r.query,...t},n=Il(i);return n===""?r.path:`${r.path}?${n}`}_getCapabilitiesUrl(e){this.url=Pt(this.url).path;let t=this.url;switch(e){case"KVP":t+=`?request=GetCapabilities&service=WMTS&version=${this.version}`;break;case"RESTful":{const r=`/${this.version}/WMTSCapabilities.xml`,i=new RegExp(r,"i");t=t.replace(i,""),t+=r;break}}return this._appendCustomParameters(t)}_getLowerCasedUrlParams(e){if(!e)return null;const t=Pt(e).query;if(!t)return null;const r={};return Object.keys(t).forEach(i=>{r[i.toLowerCase()]=t[i]}),r}_mergeParams(e,t){const r=this._getLowerCasedUrlParams(t);if(r){const i=Object.keys(r);i.length&&(e=e?B(e):{},i.forEach(n=>{e.hasOwnProperty(n)||Eve.has(n)||(e[n]=r[n])}))}return e}};function Ave(e,t){return e.map(r=>{const i=new yv;return i.read(r,t),i})}l([p()],qt.prototype,"dimensionMap",void 0),l([p()],qt.prototype,"layerMap",void 0),l([p({type:yv,json:{origins:{"web-document":{write:{ignoreOrigin:!0}}}}})],qt.prototype,"activeLayer",void 0),l([te("service","activeLayer",["layers"])],qt.prototype,"readActiveLayerFromService",null),l([te(["web-document","portal-item"],"activeLayer",["wmtsInfo"])],qt.prototype,"readActiveLayerFromItemOrWebDoc",null),l([se(["web-document","portal-item"],"activeLayer",{templateUrl:{type:String},tileInfo:{type:Uo},"wmtsInfo.layerIdentifier":{type:String},"wmtsInfo.tileMatrixSet":{type:String}})],qt.prototype,"writeActiveLayer",null),l([p({type:String,value:"",json:{write:!0}})],qt.prototype,"copyright",void 0),l([p({type:["show","hide"]})],qt.prototype,"listMode",void 0),l([p({json:{read:!0,write:!0}})],qt.prototype,"blendMode",void 0),l([p({json:{origins:{"web-document":{read:{source:["wmtsInfo.customParameters","wmtsInfo.url"]},write:{target:"wmtsInfo.customParameters"}},"portal-item":{read:{source:["wmtsInfo.customParameters","wmtsInfo.url"]},write:{target:"wmtsInfo.customParameters"}}}}})],qt.prototype,"customParameters",void 0),l([te(["portal-item","web-document"],"customParameters")],qt.prototype,"readCustomParameters",null),l([p({json:{origins:{"web-document":{read:{source:"wmtsInfo.customLayerParameters"},write:{target:"wmtsInfo.customLayerParameters"}},"portal-item":{read:{source:"wmtsInfo.customLayerParameters"},write:{target:"wmtsInfo.customLayerParameters"}}}}})],qt.prototype,"customLayerParameters",void 0),l([p({type:Ne,json:{write:{ignoreOrigin:!0},origins:{"web-document":{read:{source:"fullExtent"}},"portal-item":{read:{source:"fullExtent"}}}}})],qt.prototype,"fullExtent",void 0),l([p({readOnly:!0})],qt.prototype,"fullExtents",null),l([p({type:["WebTiledLayer"]})],qt.prototype,"operationalLayerType",void 0),l([p()],qt.prototype,"resourceInfo",void 0),l([p()],qt.prototype,"serviceMode",void 0),l([te(["portal-item","web-document"],"serviceMode",["templateUrl"])],qt.prototype,"readServiceMode",null),l([p({type:$e.ofType(yv)})],qt.prototype,"sublayers",void 0),l([te("service","sublayers",["layers"])],qt.prototype,"readSublayersFromService",null),l([p({readOnly:!0})],qt.prototype,"supportedSpatialReferences",null),l([p({readOnly:!0})],qt.prototype,"tilemapCache",null),l([p({json:{read:{source:"title"}}})],qt.prototype,"title",null),l([p({json:{read:!1},readOnly:!0,value:"wmts"})],qt.prototype,"type",void 0),l([p({json:{origins:{service:{read:{source:"tileUrl"}},"web-document":{read:{source:"wmtsInfo.url"},write:{target:"wmtsInfo.url"}},"portal-item":{read:{source:"wmtsInfo.url"},write:{target:"wmtsInfo.url"}}}}})],qt.prototype,"url",null),l([p()],qt.prototype,"version",void 0),qt=VA=l([k("esri.layers.WMTSLayer")],qt);const ZH=qt,h6e=Object.freeze(Object.defineProperty({__proto__:null,default:ZH},Symbol.toStringTag,{value:"Module"}));function Rve(e){return"portalItem"in e}const $T=e=>{let t=class extends e{get apiKey(){var r;return this._isOverridden("apiKey")?this._get("apiKey"):Rve(this)?(r=this.portalItem)==null?void 0:r.apiKey:null}set apiKey(r){r!=null?this._override("apiKey",r):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return l([p({type:String})],t.prototype,"apiKey",null),t=l([k("esri.layers.mixins.APIKeyMixin")],t),t};var GA;(function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"})(GA||(GA={}));const BA=-3,Cve=BA-1;var $u;(function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"})($u||($u={}));let d6e=class{constructor(t,r,i){this.name=t,this._storage=r,this.id=Pve+++":",this.size=0,this.maxSize=-1,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),i&&(this._storage.registerRemoveFunc(this.id,i),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get storageSize(){return this._storage.size}getSize(t){return this._storage.getSize(this,t)}resetHitRate(){this._hit=this._miss=0}put(t,r,i,n=0){this._storage.put(this,t,r,i,n)}pop(t){const r=this._storage.pop(this,t);return r===void 0?++this._miss:++this._hit,r}get(t){const r=this._storage.get(this,t);return r===void 0?++this._miss:++this._hit,r}peek(t){return this._storage.peek(this,t)}updateSize(t,r,i){this._storage.updateSize(this,t,r,i)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}},Ove=class{get size(){return this._size}constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new ev,this._users=new ev}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,r){this._removeFuncs.push([t,r])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace(r=>r[0]!==t)}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,-1),this._checkSize()}getSize(t,r){const i=this._db.get(t.id+r);return(i==null?void 0:i.size)??0}put(t,r,i,n,s){r=t.id+r;const o=this._db.get(r);if(o&&(this._size-=o.size,t.size-=o.size,this._db.delete(r),o.entry!==i&&this._notifyRemove(r,o.entry,o.size,$u.ALL)),n>this._maxSize)return void this._notifyRemove(r,i,n,$u.ALL);if(i===void 0)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${r}`),void this._notifyRemove(r,i,0,$u.ALL);const a=1+Math.max(s,Cve)-BA;this._db.set(r,new Lve(i,n,a)),this._size+=n,t.size+=n,this._checkSize()}updateSize(t,r,i,n){r=t.id+r;const s=this._db.get(r);if(s&&s.entry===i){for(this._size-=s.size,t.size-=s.size;n>this._maxSize;){const o=this._notifyRemove(r,i,n,$u.SOME);if(!(o!=null&&o>0))return void this._db.delete(r);n=o}s.size=n,this._size+=n,t.size+=n,this._checkSize()}}pop(t,r){r=t.id+r;const i=this._db.get(r);if(i)return this._size-=i.size,t.size-=i.size,this._db.delete(r),++this._hit,i.entry;++this._miss}get(t,r){r=t.id+r;const i=this._db.get(r);if(i!==void 0)return this._db.delete(r),i.lives=i.lifetime,this._db.set(r,i),++this._hit,i.entry;++this._miss}peek(t,r){const i=this._db.get(t.id+r);return i?++this._hit:++this._miss,i==null?void 0:i.entry}get performanceInfo(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},r={},i=new Array;this._db.forEach((o,a)=>{const u=o.lifetime;i[u]=(i[u]||0)+o.size,this._users.forAll(c=>{const{id:h,name:d}=c;if(a.startsWith(h)){const y=r[d]||0;r[d]=y+o.size}})});const n={};this._users.forAll(o=>{const a=o.name;if("hitRate"in o&&typeof o.hitRate=="number"&&!isNaN(o.hitRate)&&o.hitRate>0){const u=r[a]||0;r[a]=u,n[a]=Math.round(100*o.hitRate)+"%"}else n[a]="0%"});const s=Object.keys(r);s.sort((o,a)=>r[a]-r[o]),s.forEach(o=>t[o]=Math.round(r[o]/2**20)+"MB / "+n[o]);for(let o=i.length-1;o>=0;--o){const a=i[o];a&&(t["Priority "+(o+BA-1)]=Math.round(a/this._size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll(t=>t.resetHitRate())}clear(t){const r=t.id;this._db.forEach((i,n)=>{n.startsWith(r)&&(this._size-=i.size,this._db.delete(n),this._notifyRemove(n,i.entry,i.size,$u.ALL))}),t.size=0}clearAll(){this._db.forEach((t,r)=>this._notifyRemove(r,t.entry,t.size,$u.ALL)),this._users.forAll(t=>t.size=0),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,r,i,n){let s;return this._removeFuncs.some(o=>{if(t.startsWith(o[0])){const a=o[1](r,n,i);return typeof a=="number"&&(s=a),!0}return!1}),s}_checkSize(){this._users.forAll(t=>this._checkSizeLimits(t)),this._checkSizeLimits()}_checkSizeLimits(t){const r=t??this;if(r.maxSize<0||r.size<=r.maxSize)return;const i=t==null?void 0:t.id;let n=!0;for(;n;){n=!1;for(const[s,o]of this._db)if(o.lifetime===0&&(!i||s.startsWith(i))){if(this._purgeItem(s,o,t),r.size<=.9*r.maxSize)return;n||(n=this._db.has(s))}}for(const[s,o]of this._db)if((!i||s.startsWith(i))&&(this._purgeItem(s,o,t),r.size<=.9*r.maxSize))return}_purgeItem(t,r,i=this._users.find(n=>t.startsWith(n.id))){if(this._db.delete(t),r.lives<=1){this._size-=r.size,i&&(i.size-=r.size);const n=this._notifyRemove(t,r.entry,r.size,$u.SOME);n!=null&&n>0&&(this._size+=n,i&&(i.size+=n),r.lives=r.lifetime,r.size=n,this._db.set(t,r))}else--r.lives,this._db.set(t,r)}},Pve=0,Lve=class{constructor(t,r,i){this.entry=t,this.size=r,this.lifetime=i,this.lives=i}},Z4=class{constructor(t,r){this._storage=new Ove,this.id="",this.name="",this.size=0,this._storage.maxSize=t,this._storage.register(this),r&&this._storage.registerRemoveFunc("",r)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(t,r,i=1){this._storage.put(this,t,r,i,1)}pop(t){return this._storage.pop(this,t)}get(t){return this._storage.get(this,t)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}resetHitRate(){}};function kve(e,t=!1){return e<=$oe?t?new Array(e).fill(0):new Array(e):new Uint32Array(e)}let m6=class zA{constructor(t){this._validateJSON(t);const{location:r,data:i}=t;this.location=Object.freeze(B(r));const n=this.location.width,s=this.location.height;let o=!0,a=!0;const u=Math.ceil(n*s/32),c=kve(u);let h=0;for(let d=0;d<i.length;d++){const y=d%32;i[d]?(a=!1,c[h]|=1<<y):o=!1,y===31&&++h}a?(this._availability="unavailable",this.byteSize=40):o?(this._availability="available",this.byteSize=40):(this._availability=c,this.byteSize=40+Eoe(c))}getAvailability(t,r){if(this._availability==="unavailable"||this._availability==="available")return this._availability;const i=(t-this.location.top)*this.location.width+(r-this.location.left),n=i%32,s=i>>5,o=this._availability;return s<0||s>o.length?"unknown":o[s]&1<<n?"available":"unavailable"}static fromDefinition(t,r){const i=t.service.request||be,{row:n,col:s,width:o,height:a}=t,u={query:{f:"json"}};return r=r?{...u,...r}:u,i(Nve(t),r).then(c=>c.data).catch(c=>{if(c&&c.details&&c.details.httpStatus===422)return{location:{top:n,left:s,width:o,height:a},valid:!0,data:Aoe(o*a,0)};throw c}).then(c=>{if(c.location&&(c.location.top!==n||c.location.left!==s||c.location.width!==o||c.location.height!==a))throw new z("tilemap:location-mismatch","Tilemap response for different location than requested",{response:c,definition:{top:n,left:s,width:o,height:a}});return zA.fromJSON(c)})}static fromJSON(t){return Object.freeze(new zA(t))}_validateJSON(t){if(!(t!=null&&t.location))throw new z("tilemap:missing-location","Location missing from tilemap response");if(t.valid===!1)throw new z("tilemap:invalid","Tilemap response was marked as invalid");if(!t.data)throw new z("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new z("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new z("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")}};function g6(e){return`${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}function Nve(e){var i;let t;if((i=e.service.tileServers)!=null&&i.length){const n=e.service.tileServers;t=`${n&&n.length?n[e.row%n.length]:e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`}else t=`${e.service.url}/tilemap/${e.level}/${e.row}/${e.col}/${e.width}/${e.height}`;const r=e.service.query;return r&&(t=`${t}?${r}`),t}var vd;let Ro=vd=class extends De{constructor(e){super(e),this._pendingTilemapRequests={},this.request=be,this.size=32,this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new Z4(2*GA.MEGABYTES),this.addHandles(Ue(()=>{const{layer:e}=this;return[e==null?void 0:e.parsedUrl,e==null?void 0:e.tileServers,e==null?void 0:e.apiKey,e==null?void 0:e.customParameters]},()=>this._initializeTilemapDefinition(),Xi))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}fetchTilemap(e,t,r,i){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return Promise.reject(new z("tilemap-cache:level-unavailable",`Level ${e} is unavailable in the service`));const n=this._tmpTilemapDefinition,s=this._tilemapFromCache(e,t,r,n);if(s)return Promise.resolve(s);const o=i==null?void 0:i.signal;return i={...i,signal:null},new Promise((a,u)=>{bs(o,()=>u(Pr()));const c=g6(n);let h=this._pendingTilemapRequests[c];if(!h){h=m6.fromDefinition(n,i).then(y=>(this._tilemapCache.put(c,y,y.byteSize),y));const d=()=>{delete this._pendingTilemapRequests[c]};this._pendingTilemapRequests[c]=h,h.then(d,d)}h.then(a,u)})}getAvailability(e,t,r){if(!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD)return"unavailable";const i=this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition);return i?i.getAvailability(t,r):"unknown"}fetchAvailability(e,t,r,i){return!this.layer.tileInfo.lodAt(e)||e<this.effectiveMinLOD||e>this.effectiveMaxLOD?Promise.reject(new z("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):this.fetchTilemap(e,t,r,i).catch(n=>n).then(n=>{if(n instanceof m6){const s=n.getAvailability(t,r);if(s==="unavailable")throw new z("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r});return s}if(Ei(n))throw n;return"unknown"})}fetchAvailabilityUpsample(e,t,r,i,n){i.level=e,i.row=t,i.col=r;const s=this.layer.tileInfo;s.updateTileInfo(i);const o=this.fetchAvailability(e,t,r,n).catch(a=>{if(Ei(a))throw a;if(s.upsampleTile(i))return this.fetchAvailabilityUpsample(i.level,i.row,i.col,i,n);throw a});return this._fetchAvailabilityUpsamplePrefetch(i.id,e,t,r,n,o),o}async _fetchAvailabilityUpsamplePrefetch(e,t,r,i,n,s){if(!this._prefetchingEnabled||e==null)return;const o=`prefetch-${e}`;if(this.hasHandles(o))return;const a=new AbortController;s.then(()=>a.abort(),()=>a.abort());let u=!1;const c=Xt(()=>{u||(u=!0,a.abort())});if(this.addHandles(c,o),await ele(10,a.signal).catch(()=>{}),u||(u=!0,this.removeHandles(o)),to(a))return;const h=new BH(e,t,r,i),d={...n,signal:a.signal},y=this.layer.tileInfo;for(let v=0;vd._prefetches.length<vd._maxPrefetch&&y.upsampleTile(h);++v){const w=this.fetchAvailability(h.level,h.row,h.col,d);vd._prefetches.push(w);const b=()=>{vd._prefetches.removeUnordered(w)};w.then(b,b)}}_initializeTilemapDefinition(){var i;if(!this.layer.parsedUrl)return;const{parsedUrl:e,apiKey:t,customParameters:r}=this.layer;this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:Il({...e.query,...r,token:t??((i=e.query)==null?void 0:i.token)}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}_tilemapFromCache(e,t,r,i){i.level=e,i.row=t-t%this.size,i.col=r-r%this.size;const n=g6(i);return this._tilemapCache.get(n)}get test(){const e=this;return{get prefetchingEnabled(){return e._prefetchingEnabled},set prefetchingEnabled(t){e._prefetchingEnabled=t},hasTilemap:(t,r,i)=>!!e._tilemapFromCache(t,r,i,e._tmpTilemapDefinition)}}};Ro._maxPrefetch=4,Ro._prefetches=new ev({initialSize:vd._maxPrefetch}),l([p({constructOnly:!0})],Ro.prototype,"layer",void 0),l([p({constructOnly:!0})],Ro.prototype,"minLOD",void 0),l([p({constructOnly:!0})],Ro.prototype,"maxLOD",void 0),l([p({constructOnly:!0})],Ro.prototype,"request",void 0),l([p({constructOnly:!0})],Ro.prototype,"size",void 0),Ro=vd=l([k("esri.layers.support.TilemapCache")],Ro);const YH=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.minScale=0,this.maxScale=0,this.spatialReference=null,this.tileInfo=null,this.tilemapCache=null}destroy(){var r,i;(i=(r=this.tilemapCache)==null?void 0:r.destroy)==null||i.call(r)}readMinScale(r,i){return i.minLOD!=null&&i.maxLOD!=null?r:0}readMaxScale(r,i){return i.minLOD!=null&&i.maxLOD!=null?r:0}get supportsBlankTile(){return this.version>=10.2}readTilemapCache(r,i,n){var h;const s=(h=i.capabilities)==null?void 0:h.includes("Tilemap");let{minLOD:o,maxLOD:a,minScale:u,maxScale:c}=i;if(o==null&&a==null&&u!==0&&c!==0){const d=y=>Math.round(1e4*y)/1e4;u=d(u||i.tileInfo.lods[0].scale),c=d(c||i.tileInfo.lods[i.tileInfo.lods.length-1].scale);for(const y of i.tileInfo.lods){const v=d(y.scale);o=v>=u?y.level:o,a=v>=c?y.level:a}}if(s)return new Ro({layer:this,minLOD:o,maxLOD:a});if(i.tileInfo){const d=new Uo;return d.read(i.tileInfo,n),new zH(d,o,a)}return null}};return l([p({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),l([p()],t.prototype,"minScale",void 0),l([te("service","minScale")],t.prototype,"readMinScale",null),l([p()],t.prototype,"maxScale",void 0),l([te("service","maxScale")],t.prototype,"readMaxScale",null),l([p({type:xe})],t.prototype,"spatialReference",void 0),l([p({readOnly:!0})],t.prototype,"supportsBlankTile",null),l([p({type:Uo})],t.prototype,"tileInfo",void 0),l([p()],t.prototype,"tilemapCache",void 0),l([te("service","tilemapCache",["capabilities","tileInfo"])],t.prototype,"readTilemapCache",null),l([p()],t.prototype,"version",void 0),t=l([k("esri.layers.mixins.ArcGISCachedService")],t),t},tw=e=>{let t=class extends e{get title(){if(this._get("title")&&this.originOf("title")!=="defaults")return this._get("title");if(this.url){const r=zu(this.url);if(r!=null&&r.title)return r.title}return this._get("title")||""}set title(r){this._set("title",r)}set url(r){this._set("url",J1e(r,oe.getLogger(this)))}};return l([p()],t.prototype,"title",null),l([p({type:String})],t.prototype,"url",null),t=l([k("esri.layers.mixins.ArcGISService")],t),t},rw=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return l([p({type:Object,json:{write:{overridePolicy:r=>({enabled:!!(r&&Object.keys(r).length>0)})}}})],t.prototype,"customParameters",void 0),t=l([k("esri.layers.mixins.CustomParametersMixin")],t),t};let Ub=null;function Dve(e){if(Ub)return Ub;const t={lossy:"UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",lossless:"UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA==",alpha:"UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA==",animation:"UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"};return Ub=new Promise(r=>{const i=new Image;i.onload=()=>{i.onload=i.onerror=null,r(i.width>0&&i.height>0)},i.onerror=()=>{i.onload=i.onerror=null,r(!1)},i.src="data:image/webp;base64,"+t[e]}),Ub}const v6=1.15;let w6=class{constructor(t,r){this._spriteSource=t,this._maxTextureSize=r,this.devicePixelRatio=1,this._spriteImageFormat="png",this._isRetina=!1,this._spritesData={},this.image=null,this.width=null,this.height=null,this.loadStatus="not-loaded",t.type==="url"&&t.spriteFormat&&(this._spriteImageFormat=t.spriteFormat),t.pixelRatio&&(this.devicePixelRatio=t.pixelRatio),this.baseURL=t.spriteUrl}get spriteNames(){const t=[];for(const r in this._spritesData)t.push(r);return t.sort(),t}getSpriteInfo(t){return this._spritesData?this._spritesData[t]:null}async load(t){if(this.baseURL){this.loadStatus="loading";try{await this._loadSprites(t),this.loadStatus="loaded"}catch{this.loadStatus="failed"}}else this.loadStatus="failed"}async _loadSprites(t){this._isRetina=this.devicePixelRatio>v6;const{width:r,height:i,data:n,json:s}=await this._getSpriteData(this._spriteSource,t),o=Object.keys(s);if(!o||o.length===0||!n)return this._spritesData=this.image=null,void(this.width=this.height=0);this._spritesData=s,this.width=r,this.height=i;const a=Math.max(this._maxTextureSize,4096);if(r>a||i>a){const c=`Sprite resource for style ${this.baseURL} is bigger than the maximum allowed of ${a} pixels}`;throw oe.getLogger("esri.layers.support.SpriteSource").error(c),new z("SpriteSource",c)}let u;for(let c=0;c<n.length;c+=4)u=n[c+3]/255,n[c]=n[c]*u,n[c+1]=n[c+1]*u,n[c+2]=n[c+2]*u;this.image=n}async _getSpriteData(t,r){if(t.type==="image"){let h,d;if(this.devicePixelRatio<v6){if(!t.spriteSource1x)throw new z("SpriteSource","no image data provided for low resolution sprites!");h=t.spriteSource1x.image,d=t.spriteSource1x.json}else{if(!t.spriteSource2x)throw new z("SpriteSource","no image data provided for high resolution sprites!");h=t.spriteSource2x.image,d=t.spriteSource2x.json}return"width"in h&&"height"in h&&"data"in h&&(Roe(h.data)||Coe(h.data))?{width:h.width,height:h.height,data:new Uint8Array(h.data),json:d}:{...b6(h),json:d}}const i=Pt(this.baseURL),n=i.query?"?"+Il(i.query):"",s=this._isRetina?"@2x":"",o=`${i.path}${s}.${this._spriteImageFormat}${n}`,a=`${i.path}${s}.json${n}`,[u,c]=await Promise.all([be(a,r),be(o,{responseType:"image",...r})]);return{...b6(c.data),json:u.data}}};function b6(e){const t=document.createElement("canvas"),r=t.getContext("2d");t.width=e.width,t.height=e.height,r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height);return{width:e.width,height:e.height,data:new Uint8Array(i.data)}}let Rl=class jh{static getId(t,r,i,n){return typeof t=="object"?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${r}/${i}/${n}`}constructor(t,r,i,n){this.set(t,r,i,n)}get key(){return this}get id(){return this.toString()}get normalizedId(){return`${this.level}/${this.row}/${this.col}`}set id(t){this.set(t)}get hash(){const t=4095&this.row,r=4095&this.col,i=63&this.level;return(3&this.world)<<30|r<<22|t<<8|i}acquire(t,r,i,n){this.set(t,r,i,n)}contains(t){const r=t.level-this.level;return r>=0&&this.row===t.row>>r&&this.col===t.col>>r&&this.world===t.world}containsChild(t){const r=t.level-this.level;return r>0&&this.row===t.row>>r&&this.col===t.col>>r&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new jh(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,r,i,n){if(t==null)this.level=0,this.row=0,this.col=0,this.world=0;else if(typeof t=="object")this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if(typeof t=="string"){const[s,o,a,u]=t.split("/");this.level=parseFloat(s),this.row=parseFloat(o),this.col=parseFloat(a),this.world=parseFloat(u)}else this.level=+t,this.row=+r,this.col=+i,this.world=+n||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new jh(this.level-1,this.row>>1,this.col>>1,this.world)}getNeighborId(t,r){return`${this.level}/${this.row+r}/${this.col+t}/${this.world}`}getChildKeys(){const t=this.level+1,r=this.row<<1,i=this.col<<1,n=this.world;return[new jh(t,r,i,n),new jh(t,r,i+1,n),new jh(t,r+1,i,n),new jh(t,r+1,i+1,n)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}};Rl.pool=new Np(Rl,null,null,25,50);let Fve=class{constructor(t){this.url=t}destroy(){this._tileIndexPromise=null}async fetchTileIndex(){return this._tileIndexPromise||(this._tileIndexPromise=be(this.url).then(t=>t.data.index)),this._tileIndexPromise}async dataKey(t,r){const i=await this.fetchTileIndex();return Ut(r),this._getIndexedDataKey(i,t)}_getIndexedDataKey(t,r){const i=[r];if(r.level<0||r.row<0||r.col<0||r.row>>r.level>0||r.col>>r.level>0)return null;let n=r;for(;n.level!==0;)n=new Rl(n.level-1,n.row>>1,n.col>>1,n.world),i.push(n);let s,o,a=t,u=i.pop();if(a===1)return u;for(;i.length;)if(s=i.pop(),o=(1&s.col)+((1&s.row)<<1),a){if(a[o]===0){u=null;break}if(a[o]===1){u=s;break}u=s,a=a[o]}return u}},jve=class{constructor(t,r){this._tilemap=t,this._tileIndexUrl=r}destroy(){this._tilemap=cr(this._tilemap),this._tileIndexPromise=null}async fetchTileIndex(t){return this._tileIndexPromise||(this._tileIndexPromise=be(this._tileIndexUrl,{query:{...t==null?void 0:t.query}}).then(r=>r.data.index)),this._tileIndexPromise}dataKey(t,r){const{level:i,row:n,col:s}=t,o=new Rl(t);return this._tilemap.fetchAvailabilityUpsample(i,n,s,o,r).then(()=>(o.world=t.world,o)).catch(a=>{if(Ei(a))throw a;return null})}},Uve=class{constructor(t){this._tileUrl=t,this._promise=null,this._abortController=null,this._abortOptions=[]}getData(t){var i;(this._promise==null||to((i=this._abortController)==null?void 0:i.signal))&&(this._promise=this._makeRequest(this._tileUrl));const r=this._abortOptions;return r.push(t),bs(t,()=>{r.every(n=>to(n))&&this._abortController.abort()}),this._promise.then(n=>B(n))}async _makeRequest(t){this._abortController=new AbortController;const{data:r}=await be(t,{responseType:"array-buffer",signal:this._abortController.signal});return r}};const _6=new Map;function Vve(e,t,r,i,n){const s=Pt(e),o=s.query;if(o)for(const[u,c]of Object.entries(o))switch(c){case"{x}":o[u]=i.toString();break;case"{y}":o[u]=r.toString();break;case"{z}":o[u]=t.toString()}const a=s.path;return Gve(No(a.replaceAll(/\{z\}/gi,t.toString()).replaceAll(/\{y\}/gi,r.toString()).replaceAll(/\{x\}/gi,i.toString()),{...s.query}),n)}function Gve(e,t){return Ov(_6,e,()=>new Uve(e)).getData(t).finally(()=>_6.delete(e))}let Bve=class{constructor(t,r,i){this.tilemap=null,this.tileInfo=null,this.capabilities=null,this.fullExtent=null,this.initialExtent=null,this.name=t,this.sourceUrl=r;const n=Pt(this.sourceUrl),s=B(i),o=s.tiles;if(n)for(let y=0;y<o.length;y++){const v=Pt(o[y]);v&&(Kn(v.path)||(v.path=jo(n.path,v.path)),o[y]=No(v.path,{...n.query,...v.query}))}this.tileServers=o;const a=i.capabilities&&i.capabilities.split(",").map(y=>y.toLowerCase().trim()),u=(i==null?void 0:i.exportTilesAllowed)===!0,c=(a==null?void 0:a.includes("tilemap"))===!0,h=u&&i.hasOwnProperty("maxExportTilesCount")?i.maxExportTilesCount:0;this.capabilities={operations:{supportsExportTiles:u,supportsTileMap:c},exportTiles:u?{maxExportTilesCount:+h}:null},this.tileInfo=Uo.fromJSON(s.tileInfo);const d=i.tileMap?No(jo(n.path,i.tileMap),n.query??{}):null;c?(this.type="vector-tile",this.tilemap=new jve(new Ro({layer:{parsedUrl:n,tileInfo:this.tileInfo},minLOD:s.minLOD??this.tileInfo.lods[0].level,maxLOD:s.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}),d)):d&&(this.tilemap=new Fve(d)),this.fullExtent=Ne.fromJSON(i.fullExtent),this.initialExtent=Ne.fromJSON(i.initialExtent)}destroy(){var t;(t=this.tilemap)==null||t.destroy()}async getRefKey(t,r){var i;return await((i=this.tilemap)==null?void 0:i.dataKey(t,r))??t}requestTile(t,r,i,n){const s=this.tileServers[r%this.tileServers.length];return Vve(s,t,r,i,n)}isCompatibleWith(t){const r=this.tileInfo,i=t.tileInfo;if(!r.spatialReference.equals(i.spatialReference)||!r.origin.equals(i.origin)||Math.round(r.dpi)!==Math.round(i.dpi))return!1;const n=r.lods,s=i.lods,o=Math.min(n.length,s.length);for(let a=0;a<o;a++){const u=n[a],c=s[a];if(u.level!==c.level||Math.round(u.scale)!==Math.round(c.scale))return!1}return!0}};async function zve(e,t){const r={source:null,sourceBase:null,sourceUrl:null,validatedSource:null,style:null,styleBase:null,styleUrl:null,sourceNameToSource:{},primarySourceName:"",spriteFormat:"png"},[i,n]=typeof e=="string"?[e,null]:[null,e.jsonUrl];return await Nd(r,"esri",e,n,t),{layerDefinition:r.validatedSource,url:i,serviceUrl:r.sourceUrl,style:r.style,styleUrl:r.styleUrl,spriteUrl:r.style.sprite&&Am(r.styleBase,r.style.sprite),spriteFormat:r.spriteFormat,glyphsUrl:r.style.glyphs&&Am(r.styleBase,r.style.glyphs),sourceNameToSource:r.sourceNameToSource,primarySourceName:r.primarySourceName}}function Am(...e){let t;for(const r of e)r!=null&&(io(r)?t&&(t=t.split("://")[0]+":"+r.trim()):t=Kn(r)?r:jo(t,r));return t?Wx(t):void 0}async function Nd(e,t,r,i,n){let s,o,a;if(Ut(n),typeof r=="string"){const c=_s(r);a=await be(c,{...n,responseType:"json",query:{f:"json",...n==null?void 0:n.query}}),a.ssl&&(s&&(s=s.replace(/^http:/i,"https:")),o&&(o=o.replace(/^http:/i,"https:"))),s=c,o=c}else r!=null&&(a={data:r},s=r.jsonUrl||null,o=i);const u=a==null?void 0:a.data;if(XH(u))return e.styleUrl=s||null,Hve(e,u,o,n);if(qve(u))return e.sourceUrl?S6(e,u,o,!1,t,n):(e.sourceUrl=s||null,S6(e,u,o,!0,t,n));throw new Error("You must specify the URL or the JSON for a service or for a style.")}function KH(e){return typeof e=="object"&&!!e&&"tilejson"in e&&e.tilejson!=null}function XH(e){return!!e&&"sources"in e&&!!e.sources}function qve(e){return!XH(e)}async function Hve(e,t,r,i){const n=r?dG(r):lG();e.styleBase=n,e.style=t,t["sprite-format"]&&t["sprite-format"].toLowerCase()==="webp"&&(e.spriteFormat="webp");const s=[];if(t.sources&&t.sources.esri){const o=t.sources.esri;o.url?await Nd(e,"esri",Am(n,o.url),void 0,i):s.push(Nd(e,"esri",o,n,i))}for(const o of Object.keys(t.sources))o!=="esri"&&t.sources[o].type==="vector"&&(t.sources[o].url?s.push(Nd(e,o,Am(n,t.sources[o].url),void 0,i)):t.sources[o].tiles&&s.push(Nd(e,o,t.sources[o],n,i)));await Promise.all(s)}async function S6(e,t,r,i,n,s){const o=r?Wx(r)+"/":lG(),a=Wve(t),u=new Bve(n,No(o,(s==null?void 0:s.query)??{}),a);if(!i&&e.primarySourceName in e.sourceNameToSource){const c=e.sourceNameToSource[e.primarySourceName];if(!c.isCompatibleWith(u))return;u.fullExtent!=null&&(c.fullExtent!=null?c.fullExtent.union(u.fullExtent):c.fullExtent=u.fullExtent.clone()),c.tileInfo&&u.tileInfo&&c.tileInfo.lods.length<u.tileInfo.lods.length&&(c.tileInfo=u.tileInfo)}if(i&&(e.sourceBase=o,e.source=t,e.validatedSource=a,e.primarySourceName=n),e.sourceNameToSource[n]=u,!KH(e)&&"defaultStyles"in t&&!e.style){if(t.defaultStyles==null)throw new Error;return typeof t.defaultStyles=="string"?Nd(e,"",Am(o,t.defaultStyles,"root.json"),void 0,s):Nd(e,"",t.defaultStyles,Am(o,"root.json"),s)}}function Wve(e){if(e.hasOwnProperty("tileInfo"))return e;const t={xmin:-20037507067161843e-9,ymin:-20037507067161843e-9,xmax:20037507067161843e-9,ymax:20037507067161843e-9,spatialReference:{wkid:102100,latestWkid:3857}};let r=null;if(KH(e)){const{bounds:h}=e;if(h){const d=ku({x:h[0],y:h[1],spatialReference:B(VS)}),y=ku({x:h[2],y:h[3],spatialReference:B(VS)});r={xmin:d.x,ymin:d.y,xmax:y.x,ymax:y.y,spatialReference:B(GS)}}}r===null&&(r=t);const i=512;let n=78271.51696400007,s=2958287637957775e-7;const o=[],a=e.hasOwnProperty("maxzoom")&&e.maxzoom!=null?+e.maxzoom:22,u=0,c=0;for(let h=0;h<=a;h++)o.push({level:h,scale:s,resolution:n}),n/=2,s/=2;return{capabilities:"TilesOnly",initialExtent:r,fullExtent:t,minScale:u,maxScale:c,tiles:e.tiles,tileInfo:{rows:i,cols:i,dpi:96,format:"pbf",origin:{x:-20037508342787e-6,y:20037508342787e-6},lods:o,spatialReference:B(GS)}}}function Jve(e,t){return{...QH(e,t),readResourcePaths:[]}}function x6e(e,t,r){const i=Pt(e.itemUrl);return{...QH(e,t),messages:[],writtenProperties:[],blockedRelativeUrls:[],verifyItemRelativeUrls:i?{rootPath:i.path,writtenUrls:[]}:null,resources:r?{toAdd:[],toUpdate:[],toKeep:[],pendingOperations:[]}:null}}function QH(e,t){return{origin:t,url:Pt(e.itemUrl),portal:e.portal||ts.getDefault(),portalItem:e}}const Vb=1e-6;function Zve(e,t){if(e===t)return!0;if(e==null&&t!=null||e!=null&&t==null||e==null||t==null||!e.spatialReference.equals(t.spatialReference)||e.dpi!==t.dpi)return!1;const r=e.origin,i=t.origin;if(Math.abs(r.x-i.x)>=Vb||Math.abs(r.y-i.y)>=Vb)return!1;let n,s;e.lods[0].scale>t.lods[0].scale?(n=e,s=t):(s=e,n=t);for(let o=n.lods[0].scale;o>=s.lods[s.lods.length-1].scale-Vb;o/=2)if(Math.abs(o-s.lods[0].scale)<Vb)return!0;return!1}function Yve(e,t){if(e===t)return e;if(e==null&&t!=null)return t;if(e!=null&&t==null)return e;if(e==null||t==null)return null;const r=e.size[0],i=e.format,n=e.dpi,s=new Ae({x:e.origin.x,y:e.origin.y}),o=e.spatialReference,a=e.lods[0].scale>t.lods[0].scale?e.lods[0]:t.lods[0],u=e.lods[e.lods.length-1].scale<=t.lods[t.lods.length-1].scale?e.lods[e.lods.length-1]:t.lods[t.lods.length-1],c=a.scale,h=a.resolution,d=u.scale,y=[];let v=c,w=h,b=0;for(;v>d;)y.push(new Et({level:b,resolution:w,scale:v})),b++,v/=2,w/=2;return new Uo({size:[r,r],dpi:n,format:i||"pbf",origin:s,lods:y,spatialReference:o})}var qA,HA,x6,T6,I6,M6,$6,E6,A6,R6,C6,O6,P6,L6,k6,N6,D6,F6,j6,U6,V6,G6,B6,z6,q6,H6,W6,J6,Z6,Y6,K6,X6,Q6,eF,tF,rF,iF,nF,sF,oF,aF,lF,uF,cF,pF,hF,dF,fF,yF,mF,gF,vF,wF,bF,_F,SF,xF,TF,IF,MF,$F;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(qA||(qA={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(HA||(HA={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(x6||(x6={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(T6||(T6={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(I6||(I6={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(M6||(M6={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}($6||($6={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(E6||(E6={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(A6||(A6={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(R6||(R6={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(C6||(C6={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(O6||(O6={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(P6||(P6={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(L6||(L6={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(k6||(k6={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(N6||(N6={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(D6||(D6={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(F6||(F6={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(j6||(j6={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(U6||(U6={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(V6||(V6={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(G6||(G6={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(B6||(B6={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(z6||(z6={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(q6||(q6={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(H6||(H6={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(W6||(W6={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(J6||(J6={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(Z6||(Z6={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(Y6||(Y6={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(K6||(K6={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(X6||(X6={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(Q6||(Q6={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(eF||(eF={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(tF||(tF={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(rF||(rF={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(iF||(iF={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(nF||(nF={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(sF||(sF={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(oF||(oF={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(aF||(aF={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(lF||(lF={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(uF||(uF={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(cF||(cF={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(pF||(pF={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(hF||(hF={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}(dF||(dF={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(fF||(fF={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(yF||(yF={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(mF||(mF={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(gF||(gF={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(vF||(vF={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(wF||(wF={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(bF||(bF={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(_F||(_F={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(SF||(SF={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(xF||(xF={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(TF||(TF={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(IF||(IF={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(MF||(MF={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}($F||($F={}));var Br,wd,WA,Sl,JA,px,ZA,bd,YA;(function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"})(Br||(Br={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.NONE=1]="NONE"}(wd||(wd={})),function(e){e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.LINE_CENTER=2]="LINE_CENTER"}(WA||(WA={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT",e[e.AUTO=2]="AUTO"}(Sl||(Sl={})),function(e){e[e.AUTO=0]="AUTO",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT"}(JA||(JA={})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(px||(px={})),function(e){e[e.NONE=0]="NONE",e[e.UPPERCASE=1]="UPPERCASE",e[e.LOWERCASE=2]="LOWERCASE"}(ZA||(ZA={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT"}(bd||(bd={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(YA||(YA={}));let Yr=class{};Yr.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:wd.VISIBLE}},Yr.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:wd.VISIBLE}},Yr.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:wd.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:qA.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:HA.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},Yr.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:wd.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:WA.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:px.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:Sl.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:px.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:JA.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:Sl.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:ZA.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[YA.HORIZONTAL]}},Yr.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:wd.VISIBLE}},Yr.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},Yr.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:bd.MAP}},Yr.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:bd.MAP},"line-width":{type:"number",minimum:0,default:1}},Yr.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:bd.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:bd.MAP}},Yr.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},Yr.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:bd.MAP}};var EF,qu,AF;(function(e){e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"})(EF||(EF={})),function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.OUTLINE=2]="OUTLINE",e[e.LINE=3]="LINE",e[e.ICON=4]="ICON",e[e.CIRCLE=5]="CIRCLE",e[e.TEXT=6]="TEXT",e[e.TILEINFO=7]="TILEINFO"}(qu||(qu={})),function(e){e[e.PAINTER_CHANGED=0]="PAINTER_CHANGED",e[e.LAYOUT_CHANGED=1]="LAYOUT_CHANGED",e[e.LAYER_CHANGED=2]="LAYER_CHANGED",e[e.LAYER_REMOVED=3]="LAYER_REMOVED",e[e.SPRITES_CHANGED=4]="SPRITES_CHANGED"}(AF||(AF={}));const Kve=512;var Oo,Di;(function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"})(Oo||(Oo={}));let Wi=class h2{constructor(t,r){this.x=t,this.y=r}clone(){return new h2(this.x,this.y)}equals(t,r){return t===this.x&&r===this.y}isEqual(t){return t.x===this.x&&t.y===this.y}setCoords(t,r){return this.x=t,this.y=r,this}normalize(){const t=this.x,r=this.y,i=Math.sqrt(t*t+r*r);return this.x/=i,this.y/=i,this}rightPerpendicular(){const t=this.x;return this.x=this.y,this.y=-t,this}leftPerpendicular(){const t=this.x;return this.x=-this.y,this.y=t,this}move(t,r){return this.x+=t,this.y+=r,this}assign(t){return this.x=t.x,this.y=t.y,this}assignAdd(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this}assignSub(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}rotate(t,r){const i=this.x,n=this.y;return this.x=i*t-n*r,this.y=i*r+n*t,this}scale(t){return this.x*=t,this.y*=t,this}length(){const t=this.x,r=this.y;return Math.sqrt(t*t+r*r)}sub(t){return this.x-=t.x,this.y-=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}static distance(t,r){const i=r.x-t.x,n=r.y-t.y;return Math.sqrt(i*i+n*n)}static add(t,r){return new h2(t.x+r.x,t.y+r.y)}static sub(t,r){return new h2(t.x-r.x,t.y-r.y)}},Gb=class{constructor(t,r,i){this.ratio=t,this.x=r,this.y=i}},M6e=class{constructor(t,r,i,n=8,s=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=n,this._pixelMargin=s,this._tileSize=Kve*n,this._dz=t,this._yPos=r,this._xPos=i}setPixelMargin(t){t!==this._pixelMargin&&(this._pixelMargin=t,this.setExtent(this._extent))}setExtent(t){this._extent=t,this._finalRatio=this._tileSize/t*(1<<this._dz);let r=this._pixelRatio*this._pixelMargin;r/=this._finalRatio;const i=t>>this._dz;r>i&&(r=i),this._margin=r,this._xmin=i*this._xPos-r,this._ymin=i*this._yPos-r,this._xmax=this._xmin+i+2*r,this._ymax=this._ymin+i+2*r}reset(t){this._type=t,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(t,r){this._pushLine(),this._prevIsIn=this._isIn(t,r),this._moveTo(t,r,this._prevIsIn),this._prevPt=new Wi(t,r),this._firstPt=new Wi(t,r),this._dist=0}lineTo(t,r){const i=this._isIn(t,r),n=new Wi(t,r),s=Wi.distance(this._prevPt,n);let o,a,u,c,h,d,y,v;if(i)this._prevIsIn?this._lineTo(t,r,!0):(o=this._prevPt,a=n,u=this._intersect(a,o),this._start=this._dist+s*(1-this._r),this._lineTo(u.x,u.y,!0),this._lineTo(a.x,a.y,!0));else if(this._prevIsIn)a=this._prevPt,o=n,u=this._intersect(a,o),this._lineTo(u.x,u.y,!0),this._lineTo(o.x,o.y,!1);else{const w=this._prevPt,b=n;if(w.x<=this._xmin&&b.x<=this._xmin||w.x>=this._xmax&&b.x>=this._xmax||w.y<=this._ymin&&b.y<=this._ymin||w.y>=this._ymax&&b.y>=this._ymax)this._lineTo(b.x,b.y,!1);else{const _=[];if((w.x<this._xmin&&b.x>this._xmin||w.x>this._xmin&&b.x<this._xmin)&&(c=(this._xmin-w.x)/(b.x-w.x),v=w.y+c*(b.y-w.y),v<=this._ymin?d=!1:v>=this._ymax?d=!0:_.push(new Gb(c,this._xmin,v))),(w.x<this._xmax&&b.x>this._xmax||w.x>this._xmax&&b.x<this._xmax)&&(c=(this._xmax-w.x)/(b.x-w.x),v=w.y+c*(b.y-w.y),v<=this._ymin?d=!1:v>=this._ymax?d=!0:_.push(new Gb(c,this._xmax,v))),(w.y<this._ymin&&b.y>this._ymin||w.y>this._ymin&&b.y<this._ymin)&&(c=(this._ymin-w.y)/(b.y-w.y),y=w.x+c*(b.x-w.x),y<=this._xmin?h=!1:y>=this._xmax?h=!0:_.push(new Gb(c,y,this._ymin))),(w.y<this._ymax&&b.y>this._ymax||w.y>this._ymax&&b.y<this._ymax)&&(c=(this._ymax-w.y)/(b.y-w.y),y=w.x+c*(b.x-w.x),y<=this._xmin?h=!1:y>=this._xmax?h=!0:_.push(new Gb(c,y,this._ymax))),_.length===0)h?d?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):d?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(_.length>1&&_[0].ratio>_[1].ratio)this._start=this._dist+s*_[1].ratio,this._lineTo(_[1].x,_[1].y,!0),this._lineTo(_[0].x,_[0].y,!0);else{this._start=this._dist+s*_[0].ratio;for(let x=0;x<_.length;x++)this._lineTo(_[x].x,_[x].y,!0)}this._lineTo(b.x,b.y,!1)}}this._dist+=s,this._prevIsIn=i,this._prevPt=n}close(){if(this._line.length>2){const t=this._firstPt,r=this._prevPt;t.x===r.x&&t.y===r.y||this.lineTo(t.x,t.y);const i=this._line;let n=i.length;for(;n>=4&&(i[0].x===i[1].x&&i[0].x===i[n-2].x||i[0].y===i[1].y&&i[0].y===i[n-2].y);)i.pop(),i[0].x=i[n-2].x,i[0].y=i[n-2].y,--n}}result(t=!0){return this._pushLine(),this._lines.length===0?null:(this._type===Oo.Polygon&&t&&Xve.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==Oo.LineString)throw new Error("Only valid for lines");this._pushLine();const t=this._lines,r=t.length;if(r===0)return null;const i=[];for(let n=0;n<r;n++)i.push({line:t[n],start:this._starts[n]||0});return i}_isIn(t,r){return t>=this._xmin&&t<=this._xmax&&r>=this._ymin&&r<=this._ymax}_intersect(t,r){let i,n,s;if(r.x>=this._xmin&&r.x<=this._xmax)n=r.y<=this._ymin?this._ymin:this._ymax,s=(n-t.y)/(r.y-t.y),i=t.x+s*(r.x-t.x);else if(r.y>=this._ymin&&r.y<=this._ymax)i=r.x<=this._xmin?this._xmin:this._xmax,s=(i-t.x)/(r.x-t.x),n=t.y+s*(r.y-t.y);else{n=r.y<=this._ymin?this._ymin:this._ymax,i=r.x<=this._xmin?this._xmin:this._xmax;const o=(i-t.x)/(r.x-t.x),a=(n-t.y)/(r.y-t.y);o<a?(s=o,n=t.y+o*(r.y-t.y)):(s=a,i=t.x+a*(r.x-t.x))}return this._r=s,new Wi(i,n)}_pushLine(){this._line&&(this._type===Oo.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Oo.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===Oo.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(t,r,i){this._type!==Oo.Polygon?i&&(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Wi(t,r))):(i||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.push(new Wi(t,r)),this._isH=!1,this._isV=!1)}_lineTo(t,r,i){let n,s;if(this._type!==Oo.Polygon)if(i){if(t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(n=this._line[this._line.length-1],n.equals(t,r)))return;this._line.push(new Wi(t,r))}else this._line&&this._line.length>0&&this._pushLine();else if(i||(t<this._xmin&&(t=this._xmin),t>this._xmax&&(t=this._xmax),r<this._ymin&&(r=this._ymin),r>this._ymax&&(r=this._ymax)),t=Math.round((t-(this._xmin+this._margin))*this._finalRatio),r=Math.round((r-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){n=this._line[this._line.length-1];const o=n.x===t,a=n.y===r;if(o&&a)return;this._isH&&o||this._isV&&a?(n.x=t,n.y=r,s=this._line[this._line.length-2],s.x===t&&s.y===r?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(s=this._line[this._line.length-2],this._isH=s.x===t,this._isV=s.y===r)):(this._isH=s.x===t,this._isV=s.y===r)):(this._line.push(new Wi(t,r)),this._isH=o,this._isV=a)}else this._line.push(new Wi(t,r))}},E6e=class{setExtent(t){this._ratio=t===4096?1:4096/t}get validateTessellation(){return this._ratio<1}reset(t){this._lines=[],this._line=null}moveTo(t,r){this._line&&this._lines.push(this._line),this._line=[];const i=this._ratio;this._line.push(new Wi(t*i,r*i))}lineTo(t,r){const i=this._ratio;this._line.push(new Wi(t*i,r*i))}close(){const t=this._line;t&&!t[0].isEqual(t[t.length-1])&&t.push(t[0])}result(){return this._line&&this._lines.push(this._line),this._lines.length===0?null:this._lines}};(function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"})(Di||(Di={}));let Xve=class Pc{static simplify(t,r,i){if(!i)return;const n=-r,s=t+r,o=-r,a=t+r,u=[],c=[],h=i.length;for(let y=0;y<h;++y){const v=i[y];if(!v||v.length<2)continue;let w,b=v[0];const _=v.length;for(let x=1;x<_;++x)w=v[x],b.x===w.x&&(b.x<=n&&(b.y>w.y?(u.push(y),u.push(x),u.push(Di.sideLeft),u.push(-1)):(c.push(y),c.push(x),c.push(Di.sideLeft),c.push(-1))),b.x>=s&&(b.y<w.y?(u.push(y),u.push(x),u.push(Di.sideRight),u.push(-1)):(c.push(y),c.push(x),c.push(Di.sideRight),c.push(-1)))),b.y===w.y&&(b.y<=o&&(b.x<w.x?(u.push(y),u.push(x),u.push(Di.sideTop),u.push(-1)):(c.push(y),c.push(x),c.push(Di.sideTop),c.push(-1))),b.y>=a&&(b.x>w.x?(u.push(y),u.push(x),u.push(Di.sideBottom),u.push(-1)):(c.push(y),c.push(x),c.push(Di.sideBottom),c.push(-1)))),b=w}if(u.length===0||c.length===0)return;Pc.fillParent(i,c,u),Pc.fillParent(i,u,c);const d=[];Pc.calcDeltas(d,c,u),Pc.calcDeltas(d,u,c),Pc.addDeltas(d,i)}static fillParent(t,r,i){const n=i.length,s=r.length;for(let o=0;o<s;o+=4){const a=r[o],u=r[o+1],c=r[o+2],h=t[a][u-1],d=t[a][u];let y=8092,v=-1;for(let w=0;w<n;w+=4){if(i[w+2]!==c)continue;const b=i[w],_=i[w+1],x=t[b][_-1],T=t[b][_];switch(c){case Di.sideLeft:case Di.sideRight:if(Bb(h.y,x.y,T.y)&&Bb(d.y,x.y,T.y)){const I=Math.abs(T.y-x.y);I<y&&(y=I,v=w)}break;case Di.sideTop:case Di.sideBottom:if(Bb(h.x,x.x,T.x)&&Bb(d.x,x.x,T.x)){const I=Math.abs(T.x-x.x);I<y&&(y=I,v=w)}}}r[o+3]=v}}static calcDeltas(t,r,i){const n=r.length;for(let s=0;s<n;s+=4){const o=[],a=Pc.calcDelta(s,r,i,o);t.push(r[s]),t.push(r[s+1]),t.push(r[s+2]),t.push(a)}}static calcDelta(t,r,i,n){const s=r[t+3];if(s===-1)return 0;const o=n.length;return o>1&&n[o-2]===s?0:(n.push(s),Pc.calcDelta(s,i,r,n)+1)}static addDeltas(t,r){const i=t.length;let n=0;for(let s=0;s<i;s+=4){const o=t[s+3];o>n&&(n=o)}for(let s=0;s<i;s+=4){const o=r[t[s]],a=t[s+1],u=n-t[s+3];switch(t[s+2]){case Di.sideLeft:o[a-1].x-=u,o[a].x-=u,a===1&&(o[o.length-1].x-=u),a===o.length-1&&(o[0].x-=u);break;case Di.sideRight:o[a-1].x+=u,o[a].x+=u,a===1&&(o[o.length-1].x+=u),a===o.length-1&&(o[0].x+=u);break;case Di.sideTop:o[a-1].y-=u,o[a].y-=u,a===1&&(o[o.length-1].y-=u),a===o.length-1&&(o[0].y-=u);break;case Di.sideBottom:o[a-1].y+=u,o[a].y+=u,a===1&&(o[o.length-1].y+=u),a===o.length-1&&(o[0].y+=u)}}}};const Bb=(e,t,r)=>e>=t&&e<=r||e>=r&&e<=t,R6e=Number.POSITIVE_INFINITY,Y4=Math.PI,C6e=2*Y4,Qve=128/Y4,ewe=256/360,O6e=Y4/180,twe=1/Math.LN2;function eW(e,t){return(e%=t)>=0?e:e+t}function P6e(e){return eW(e*Qve,256)}function L6e(e){return eW(e*ewe,256)}function k6e(e){return Math.log(e)*twe}function qn(e,t,r){return e*(1-r)+t*r}const rwe=8,iwe=14,nwe=16;function N6e(e){return rwe+Math.max((e-iwe)*nwe,0)}function swe(e,t,r){let i,n,s,o=0;for(const a of r){i=a.length;for(let u=1;u<i;++u)n=a[u-1],s=a[u],n.y>t!=s.y>t&&((s.x-n.x)*(t-n.y)-(s.y-n.y)*(e-n.x)>0?o++:o--)}return o!==0}function tW(e,t,r,i){let n,s,o,a;const u=i*i;for(const c of r){const h=c.length;if(!(h<2)){n=c[0].x,s=c[0].y;for(let d=1;d<h;++d){if(o=c[d].x,a=c[d].y,Rce(e,t,n,s,o,a)<u)return!0;n=o,s=a}}}return!1}function D6e(e,t,r,i,n,s,o){const a=Math.max(i,Math.min(t,s))-t,u=Math.max(n,Math.min(r,o))-r;return a*a+u*u<=e*e}function owe(e,t){if(t===0||Number.isNaN(t))return e;const r=[],i=new Wi(0,0),n=new Wi(0,0),s=new Wi(0,0);for(let o=0;o<e.length;o++){const a=e[o],u=[];for(let c=0;c<a.length;c++){const h=a[c-1],d=a[c],y=a[c+1];c===0?i.setCoords(0,0):i.assignSub(d,h).normalize().rightPerpendicular(),c===a.length-1?n.setCoords(0,0):n.assignSub(y,d).normalize().rightPerpendicular(),s.assignAdd(i,n).normalize();const v=s.x*n.x+s.y*n.y;v!==0&&s.scale(1/v),u.push(Wi.add(d,s.scale(t)))}r.push(u)}return r}function K4(e,t,r,i){const n=new Wi(e[0],e[1]);if(n.scale(i),t==="viewport"){const s=-r*(Math.PI/180),o=Math.cos(s),a=Math.sin(s);n.rotate(o,a)}return n}let awe=class{constructor(t){this._array=[],t<=0&&console.error("strideInBytes must be positive!"),this._stride=t}get array(){return this._array}get index(){return 4*this._array.length/this._stride}get itemSize(){return this._stride}get sizeInBytes(){return 4*this._array.length}reset(){this.array.length=0}toBuffer(){return new Uint32Array(this._array).buffer}static i1616to32(t,r){return 65535&t|r<<16}static i8888to32(t,r,i,n){return 255&t|(255&r)<<8|(255&i)<<16|n<<24}static i8816to32(t,r,i){return 255&t|(255&r)<<8|i<<16}};var Le,_d;(function(e){e[e.R8_SIGNED=0]="R8_SIGNED",e[e.R8_UNSIGNED=1]="R8_UNSIGNED",e[e.R16_SIGNED=2]="R16_SIGNED",e[e.R16_UNSIGNED=3]="R16_UNSIGNED",e[e.R8G8_SIGNED=4]="R8G8_SIGNED",e[e.R8G8_UNSIGNED=5]="R8G8_UNSIGNED",e[e.R16G16_SIGNED=6]="R16G16_SIGNED",e[e.R16G16_UNSIGNED=7]="R16G16_UNSIGNED",e[e.R8G8B8A8_SIGNED=8]="R8G8B8A8_SIGNED",e[e.R8G8B8A8_UNSIGNED=9]="R8G8B8A8_UNSIGNED",e[e.R8G8B8A8_COLOR=10]="R8G8B8A8_COLOR",e[e.R16G16B16A16_DASHARRAY=11]="R16G16B16A16_DASHARRAY",e[e.R16G16B16A16_PATTERN=12]="R16G16B16A16_PATTERN"})(Le||(Le={})),function(e){e[e.UNIFORM=0]="UNIFORM",e[e.DATA_DRIVEN=1]="DATA_DRIVEN",e[e.INTERPOLATED_DATA_DRIVEN=2]="INTERPOLATED_DATA_DRIVEN",e[e.UNUSED=3]="UNUSED"}(_d||(_d={}));var RF,CF,OF,PF,LF,kF,NF,ft,DF,FF,jF,UF,VF,GF,BF,zF,qF,HF,WF,JF;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT"})(RF||(RF={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(CF||(CF={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(OF||(OF={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(PF||(PF={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER"}(LF||(LF={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(kF||(kF={})),function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"}(NF||(NF={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(ft||(ft={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(DF||(DF={})),function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"}(FF||(FF={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(jF||(jF={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(UF||(UF={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(VF||(VF={})),function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"}(GF||(GF={})),function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"}(BF||(BF={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(zF||(zF={})),function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(qF||(qF={})),function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"}(HF||(HF={})),function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"}(WF||(WF={})),function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(JF||(JF={}));const j6e=33984;var ZF,YF,KF;(function(e){e[e.Texture=0]="Texture",e[e.BufferObject=1]="BufferObject",e[e.VertexArrayObject=2]="VertexArrayObject",e[e.Shader=3]="Shader",e[e.Program=4]="Program",e[e.FramebufferObject=5]="FramebufferObject",e[e.Renderbuffer=6]="Renderbuffer",e[e.TransformFeedback=7]="TransformFeedback",e[e.Sync=8]="Sync",e[e.UNCOUNTED=9]="UNCOUNTED",e[e.LinesOfCode=9]="LinesOfCode",e[e.Uniform=10]="Uniform",e[e.COUNT=11]="COUNT"})(ZF||(ZF={})),function(e){e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(YF||(YF={})),function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"}(KF||(KF={}));const U6e=33306;var XF,QF,e9,t9,r9,i9,n9;(function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"})(XF||(XF={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(QF||(QF={})),function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"}(e9||(e9={})),function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"}(t9||(t9={})),function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"}(r9||(r9={})),function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(i9||(i9={})),function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(n9||(n9={}));let Ki=class{constructor(t,r,i,n,s,o=!1,a=0){this.name=t,this.count=r,this.type=i,this.offset=n,this.stride=s,this.normalized=o,this.divisor=a}},Yp=class KA{constructor(t){this._locations=new Map,this._key=t}get key(){return this._key}get type(){return 7&this._key}defines(){return[]}getStride(){return this._layoutInfo||this._buildAttributesInfo(),this._stride}getAttributeLocations(){return this._locations.size===0&&this._buildAttributesInfo(),this._locations}getLayoutInfo(){return this._layoutInfo||this._buildAttributesInfo(),this._layoutInfo}getEncodingInfos(){return this._propertyEncodingInfo||this._buildAttributesInfo(),this._propertyEncodingInfo}getUniforms(){return this._uniforms||this._buildAttributesInfo(),this._uniforms}getShaderHeader(){return this._shaderHeader||this._buildAttributesInfo(),this._shaderHeader}getShaderMain(){return this._shaderMain||this._buildAttributesInfo(),this._shaderMain}setDataUniforms(t,r,i,n,s){const o=this.getUniforms();for(const a of o){const{name:u,type:c,getValue:h}=a,d=h(i,r,n,s);if(d!==null)switch(c){case"float":t.setUniform1f(u,d);break;case"vec2":t.setUniform2fv(u,d);break;case"vec4":t.setUniform4fv(u,d)}}}encodeAttributes(t,r,i,n){var h;const s=this.attributesInfo(),o=this.getEncodingInfos(),a=[];let u=0,c=0;for(const d of Object.keys(o)){const y=o[d],{type:v,precisionFactor:w,isLayout:b}=s[d],_=b?i.getLayoutProperty(d):i.getPaintProperty(d),x=(h=_.interpolator)==null?void 0:h.getInterpolationRange(r);let T=0;for(const I of y){const{offset:M,bufferElementsToAdd:$}=I;if($>0){for(let R=0;R<$;R++)a.push(0);u+=c,c=I.bufferElementsToAdd}const A=n??_.getValue(x?x[T]:r,t);switch(v){case Le.R8_SIGNED:case Le.R8_UNSIGNED:a[u]|=this._encodeByte(A*(w||1),8*M);break;case Le.R16_SIGNED:case Le.R16_UNSIGNED:a[u]|=this._encodeShort(A*(w||1),8*M);break;case Le.R8G8_SIGNED:case Le.R8G8_UNSIGNED:a[u]|=this._encodeByte(A*(w||1),8*M),a[u]|=this._encodeByte(A*(w||1),8*M+8);break;case Le.R16G16_SIGNED:case Le.R16G16_UNSIGNED:a[u]|=this._encodeShort(A*(w||1),8*M),a[u]|=this._encodeShort(A*(w||1),8*M+16);break;case Le.R8G8B8A8_SIGNED:case Le.R8G8B8A8_UNSIGNED:a[u]|=this._encodeByte(A*(w||1),8*M),a[u]|=this._encodeByte(A*(w||1),8*M+8),a[u]|=this._encodeByte(A*(w||1),8*M+16),a[u]|=this._encodeByte(A*(w||1),8*M+24);break;case Le.R8G8B8A8_COLOR:a[u]=this._encodeColor(A);break;case Le.R16G16B16A16_DASHARRAY:case Le.R16G16B16A16_PATTERN:this._encodePattern(u,a,A);break;default:throw new Error("Unsupported encoding type")}T++}}return a}getAtributeState(t){let r=0;const i=3+2*t;return r|=this._bit(i),r|=this._bit(i+1)<<1,r}_buildAttributesInfo(){const t=[],r={},i={};let n=-1;const s=this.attributesInfo(),o=this.attributes();let a=-1;for(const d of o){a++;const y=this.getAtributeState(a);if(y===_d.UNIFORM||y===_d.UNUSED)continue;const v=s[d],w=[];r[d]=w;const b=v.type;for(let _=0;_<y;_++){const{dataType:x,bytesPerElement:T,count:I,normalized:M}=KA._encodingInfo[b],$=T*I,A=`${x}-${M===!0}`;let R=i[A],L=0;if(!R||R.count+I>4)n++,R={dataIndex:n,count:0,offset:0},I!==4&&(i[A]=R),t.push({location:-1,name:"a_data_"+n,count:I,type:x,normalized:M}),L=Math.ceil(Math.max($/4,1));else{const C=t[R.dataIndex];C.count+=I,L=Math.ceil(Math.max(C.count*T/4,1))-Math.ceil(Math.max(R.offset/4,1))}w.push({dataIndex:R.dataIndex,offset:R.offset,bufferElementsToAdd:L}),R.offset+=$,R.count+=I}}for(const d of t)switch(d.type){case ft.BYTE:case ft.UNSIGNED_BYTE:d.count=4;break;case ft.SHORT:case ft.UNSIGNED_SHORT:d.count+=d.count%2}this._buildVertexBufferLayout(t);let u=0;const c=this._layoutInfo.geometry;for(const d of c)this._locations.set(d.name,u++);const h=this._layoutInfo.opacity;if(h)for(const d of h)this._locations.set(d.name,u++);this._buildShaderInfo(t,r),this._propertyEncodingInfo=r}_buildVertexBufferLayout(t){const r={},i=this.geometryInfo();let n=i[0].stride;if(t.length===0)r.geometry=i;else{const s=[];let o=n;for(const a of t)n+=s9(a.type)*a.count;for(const a of i)s.push(new Ki(a.name,a.count,a.type,a.offset,n,a.normalized));for(const a of t)s.push(new Ki(a.name,a.count,a.type,o,n,a.normalized)),o+=s9(a.type)*a.count;r.geometry=s}this.opacityInfo()&&(r.opacity=this.opacityInfo()),this._layoutInfo=r,this._stride=n}_buildShaderInfo(t,r){let i=`
`,n=`
`;const s=[];for(const c of t)i+=`attribute ${this._getType(c.count)} ${c.name};
`;const o=this.attributes(),a=this.attributesInfo();let u=-1;for(const c of o){u++;const{name:h,type:d,precisionFactor:y,isLayout:v}=a[c],w=y&&y!==1?" * "+1/y:"",{bytesPerElement:b,count:_}=KA._encodingInfo[d],x=T=>`a_data_${T.dataIndex}${lwe(_,T.offset,b)}`;switch(this.getAtributeState(u)){case _d.UNIFORM:{const T=this._getType(_),I=`u_${h}`;s.push({name:I,type:T,getValue:(M,$,A,R)=>{const L=v?M.getLayoutValue(c,$):M.getPaintValue(c,$);if(d===Le.R16G16B16A16_DASHARRAY){const C=M.getDashKey(L,M.getLayoutValue("line-cap",$)),U=R.getMosaicItemPosition(C,!1);if(U==null)return null;const{tl:F,br:j}=U;return[F[0],j[1],j[0],F[1]]}if(d===Le.R16G16B16A16_PATTERN){const C=R.getMosaicItemPosition(L,!c.includes("line-"));if(C==null)return null;const{tl:U,br:F}=C;return[U[0],F[1],F[0],U[1]]}if(d===Le.R8G8B8A8_COLOR){const C=L[3];return[C*L[0],C*L[1],C*L[2],C]}return L}}),i+=`uniform ${T} ${I};
`,n+=`${T} ${h} = ${I};
`}break;case _d.DATA_DRIVEN:{const T=x(r[c][0]);n+=`${this._getType(_)} ${h} = ${T}${w};
`}break;case _d.INTERPOLATED_DATA_DRIVEN:{const T=`u_t_${h}`;s.push({name:T,type:"float",getValue:($,A,R,L)=>(v?$.getLayoutProperty(c):$.getPaintProperty(c)).interpolator.interpolationUniformValue(R,A)}),i+=`uniform float ${T};
`;const I=x(r[c][0]),M=x(r[c][1]);n+=`${this._getType(_)} ${h} = mix(${I}${w}, ${M}${w}, ${T});
`}}}this._shaderHeader=i,this._shaderMain=n,this._uniforms=s}_bit(t){return(this._key&1<<t)>>t}_getType(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4"}throw new Error("Invalid count")}_encodeColor(t){const r=255*t[3];return awe.i8888to32(t[0]*r,t[1]*r,t[2]*r,r)}_encodePattern(t,r,i){if(!(i!=null&&i.rect))return;const n=2,s=i.rect,o=i.width,a=i.height;r[t]=this._encodeShort(s.x+n,0),r[t]|=this._encodeShort(s.y+n+a,16),r[t+1]=this._encodeShort(s.x+n+o,0),r[t+1]|=this._encodeShort(s.y+n,16)}_encodeByte(t,r){return(255&t)<<r}_encodeShort(t,r){return(65535&t)<<r}};Yp._encodingInfo={[Le.R8_SIGNED]:{dataType:ft.BYTE,bytesPerElement:1,count:1,normalized:!1},[Le.R8_UNSIGNED]:{dataType:ft.UNSIGNED_BYTE,bytesPerElement:1,count:1,normalized:!1},[Le.R16_SIGNED]:{dataType:ft.SHORT,bytesPerElement:2,count:1,normalized:!1},[Le.R16_UNSIGNED]:{dataType:ft.UNSIGNED_SHORT,bytesPerElement:2,count:1,normalized:!1},[Le.R8G8_SIGNED]:{dataType:ft.BYTE,bytesPerElement:1,count:2,normalized:!1},[Le.R8G8_UNSIGNED]:{dataType:ft.UNSIGNED_BYTE,bytesPerElement:1,count:2,normalized:!1},[Le.R16G16_SIGNED]:{dataType:ft.SHORT,bytesPerElement:2,count:2,normalized:!1},[Le.R16G16_UNSIGNED]:{dataType:ft.UNSIGNED_SHORT,bytesPerElement:2,count:2,normalized:!1},[Le.R8G8B8A8_SIGNED]:{dataType:ft.BYTE,bytesPerElement:1,count:4,normalized:!1},[Le.R8G8B8A8_UNSIGNED]:{dataType:ft.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!1},[Le.R8G8B8A8_COLOR]:{dataType:ft.UNSIGNED_BYTE,bytesPerElement:1,count:4,normalized:!0},[Le.R16G16B16A16_DASHARRAY]:{dataType:ft.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1},[Le.R16G16B16A16_PATTERN]:{dataType:ft.UNSIGNED_SHORT,bytesPerElement:2,count:4,normalized:!1}};const s9=e=>{switch(e){case ft.FLOAT:case ft.INT:case ft.UNSIGNED_INT:return 4;case ft.SHORT:case ft.UNSIGNED_SHORT:return 2;case ft.BYTE:case ft.UNSIGNED_BYTE:return 1}},lwe=(e,t,r)=>{const i=t/r;if(e===1)switch(i){case 0:return".x";case 1:return".y";case 2:return".z";case 3:return".w"}else if(e===2)switch(i){case 0:return".xy";case 1:return".yz";case 2:return".zw"}else if(e===3)switch(i){case 0:return".xyz";case 1:return".yzw"}return""};let tm=class d2 extends Yp{constructor(t){super(t)}geometryInfo(){return d2.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return d2.ATTRIBUTES}attributesInfo(){return d2.ATTRIBUTES_INFO}};tm.ATTRIBUTES=[],tm.GEOMETRY_LAYOUT=[new Ki("a_pos",2,ft.BYTE,0,2)],tm.ATTRIBUTES_INFO={};let rm=class f2 extends Yp{constructor(t){super(t)}geometryInfo(){return f2.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return f2.ATTRIBUTES}attributesInfo(){return f2.ATTRIBUTES_INFO}};rm.ATTRIBUTES=["circle-radius","circle-color","circle-opacity","circle-stroke-width","circle-stroke-color","circle-stroke-opacity","circle-blur"],rm.GEOMETRY_LAYOUT=[new Ki("a_pos",2,ft.SHORT,0,4)],rm.ATTRIBUTES_INFO={"circle-radius":{name:"radius",type:Le.R8_UNSIGNED},"circle-color":{name:"color",type:Le.R8G8B8A8_COLOR},"circle-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"circle-stroke-width":{name:"stroke_width",type:Le.R8_UNSIGNED,precisionFactor:4},"circle-stroke-color":{name:"stroke_color",type:Le.R8G8B8A8_COLOR},"circle-stroke-opacity":{name:"stroke_opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"circle-blur":{name:"blur",type:Le.R8_UNSIGNED,precisionFactor:32}};let im=class y2 extends Yp{constructor(t){super(t)}geometryInfo(){return y2.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return y2.ATTRIBUTES}attributesInfo(){return y2.ATTRIBUTES_INFO}};im.ATTRIBUTES=["fill-color","fill-opacity","fill-pattern"],im.GEOMETRY_LAYOUT=[new Ki("a_pos",2,ft.SHORT,0,4)],im.ATTRIBUTES_INFO={"fill-color":{name:"color",type:Le.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"fill-pattern":{name:"tlbr",type:Le.R16G16B16A16_PATTERN,isOptional:!0}};let gl=class uy extends Yp{constructor(t,r){super(t),this._usefillColor=r}geometryInfo(){return uy.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return this._usefillColor?uy.ATTRIBUTES_FILL:uy.ATTRIBUTES_OUTLINE}attributesInfo(){return this._usefillColor?uy.ATTRIBUTES_INFO_FILL:uy.ATTRIBUTES_INFO_OUTLINE}};gl.ATTRIBUTES_OUTLINE=["fill-outline-color","fill-opacity"],gl.ATTRIBUTES_FILL=["fill-color","fill-opacity"],gl.GEOMETRY_LAYOUT=[new Ki("a_pos",2,ft.SHORT,0,8),new Ki("a_offset",2,ft.BYTE,4,8),new Ki("a_xnormal",2,ft.BYTE,6,8)],gl.ATTRIBUTES_INFO_OUTLINE={"fill-outline-color":{name:"color",type:Le.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100}},gl.ATTRIBUTES_INFO_FILL={"fill-color":{name:"color",type:Le.R8G8B8A8_COLOR},"fill-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100}};let nm=class m2 extends Yp{constructor(t){super(t)}geometryInfo(){return m2.GEOMETRY_LAYOUT}opacityInfo(){return null}attributes(){return m2.ATTRIBUTES}attributesInfo(){return m2.ATTRIBUTES_INFO}};nm.ATTRIBUTES=["line-blur","line-color","line-gap-width","line-offset","line-opacity","line-width","line-pattern","line-dasharray"],nm.GEOMETRY_LAYOUT=[new Ki("a_pos",2,ft.SHORT,0,16),new Ki("a_extrude_offset",4,ft.BYTE,4,16),new Ki("a_dir_normal",4,ft.BYTE,8,16),new Ki("a_accumulatedDistance",2,ft.UNSIGNED_SHORT,12,16)],nm.ATTRIBUTES_INFO={"line-width":{name:"width",type:Le.R8_UNSIGNED,precisionFactor:2},"line-gap-width":{name:"gap_width",type:Le.R8_UNSIGNED,precisionFactor:2},"line-offset":{name:"offset",type:Le.R8_SIGNED,precisionFactor:2},"line-color":{name:"color",type:Le.R8G8B8A8_COLOR},"line-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"line-blur":{name:"blur",type:Le.R8_UNSIGNED,precisionFactor:4},"line-pattern":{name:"tlbr",type:Le.R16G16B16A16_PATTERN,isOptional:!0},"line-dasharray":{name:"tlbr",type:Le.R16G16B16A16_DASHARRAY,isOptional:!0}};const rW=[new Ki("a_pos",2,ft.SHORT,0,16),new Ki("a_vertexOffset",2,ft.SHORT,4,16),new Ki("a_texAngleRange",4,ft.UNSIGNED_BYTE,8,16),new Ki("a_levelInfo",4,ft.UNSIGNED_BYTE,12,16)],iW=[new Ki("a_opacityInfo",1,ft.UNSIGNED_BYTE,0,1)];let L1=class XA extends Yp{constructor(t){super(t)}geometryInfo(){return rW}opacityInfo(){return iW}attributes(){return XA.ATTRIBUTES}attributesInfo(){return XA.ATTRIBUTES_INFO}};L1.ATTRIBUTES=["icon-color","icon-opacity","icon-halo-blur","icon-halo-color","icon-halo-width","icon-size"],L1.ATTRIBUTES_INFO={"icon-color":{name:"color",type:Le.R8G8B8A8_COLOR},"icon-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"icon-halo-color":{name:"halo_color",type:Le.R8G8B8A8_COLOR},"icon-halo-width":{name:"halo_width",type:Le.R8_UNSIGNED,precisionFactor:4},"icon-halo-blur":{name:"halo_blur",type:Le.R8_UNSIGNED,precisionFactor:4},"icon-size":{name:"size",type:Le.R8_UNSIGNED,precisionFactor:32,isLayout:!0}};let k1=class QA extends Yp{constructor(t){super(t)}geometryInfo(){return rW}opacityInfo(){return iW}attributes(){return QA.ATTRIBUTES}attributesInfo(){return QA.ATTRIBUTES_INFO}};k1.ATTRIBUTES=["text-color","text-opacity","text-halo-blur","text-halo-color","text-halo-width","text-size"],k1.ATTRIBUTES_INFO={"text-color":{name:"color",type:Le.R8G8B8A8_COLOR},"text-opacity":{name:"opacity",type:Le.R8_UNSIGNED,precisionFactor:100},"text-halo-color":{name:"halo_color",type:Le.R8G8B8A8_COLOR},"text-halo-width":{name:"halo_width",type:Le.R8_UNSIGNED,precisionFactor:4},"text-halo-blur":{name:"halo_blur",type:Le.R8_UNSIGNED,precisionFactor:4},"text-size":{name:"size",type:Le.R8_UNSIGNED,isLayout:!0}};function uwe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function cwe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function pwe(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}function hwe(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function nW(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function sW(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function oW(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function dwe(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function fwe(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function ywe(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function mwe(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function gwe(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function vwe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function wwe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function aW(e,t){const r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return Math.sqrt(r*r+i*i+n*n+s*s)}function lW(e,t){const r=t[0]-e[0],i=t[1]-e[1],n=t[2]-e[2],s=t[3]-e[3];return r*r+i*i+n*n+s*s}function uW(e){const t=e[0],r=e[1],i=e[2],n=e[3];return Math.sqrt(t*t+r*r+i*i+n*n)}function cW(e){const t=e[0],r=e[1],i=e[2],n=e[3];return t*t+r*r+i*i+n*n}function bwe(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function _we(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function Swe(e,t){const r=t[0],i=t[1],n=t[2],s=t[3];let o=r*r+i*i+n*n+s*s;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=i*o,e[2]=n*o,e[3]=s*o),e}function xwe(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function pW(e,t,r,i){const n=t[0],s=t[1],o=t[2],a=t[3];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e[2]=o+i*(r[2]-o),e[3]=a+i*(r[3]-a),e}function Twe(e,t){const r=Xx;let i,n,s,o,a,u;t=t||1;do i=2*r()-1,n=2*r()-1,a=i*i+n*n;while(a>=1);do s=2*r()-1,o=2*r()-1,u=s*s+o*o;while(u>=1);const c=Math.sqrt((1-a)/u);return e[0]=t*i,e[1]=t*n,e[2]=t*s*c,e[3]=t*o*c,e}function Iwe(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3];return e[0]=r[0]*i+r[4]*n+r[8]*s+r[12]*o,e[1]=r[1]*i+r[5]*n+r[9]*s+r[13]*o,e[2]=r[2]*i+r[6]*n+r[10]*s+r[14]*o,e[3]=r[3]*i+r[7]*n+r[11]*s+r[15]*o,e}function Mwe(e,t,r){const i=t[0],n=t[1],s=t[2],o=r[0],a=r[1],u=r[2],c=r[3],h=c*i+a*s-u*n,d=c*n+u*i-o*s,y=c*s+o*n-a*i,v=-o*i-a*n-u*s;return e[0]=h*c+v*-o+d*-u-y*-a,e[1]=d*c+v*-a+y*-o-h*-u,e[2]=y*c+v*-u+h*-a-d*-o,e[3]=t[3],e}function $we(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function Ewe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Awe(e,t){const r=e[0],i=e[1],n=e[2],s=e[3],o=t[0],a=t[1],u=t[2],c=t[3],h=Bo();return Math.abs(r-o)<=h*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=h*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(n-u)<=h*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(s-c)<=h*Math.max(1,Math.abs(s),Math.abs(c))}const Rwe=nW,Cwe=sW,Owe=oW,Pwe=aW,Lwe=lW,kwe=uW,Nwe=cW;Object.freeze(Object.defineProperty({__proto__:null,add:hwe,ceil:dwe,copy:uwe,copyVec3:cwe,dist:Pwe,distance:aW,div:Owe,divide:oW,dot:xwe,equals:Awe,exactEquals:Ewe,floor:fwe,inverse:_we,len:kwe,length:uW,lerp:pW,max:mwe,min:ywe,mul:Cwe,multiply:sW,negate:bwe,normalize:Swe,random:Twe,round:gwe,scale:vwe,scaleAndAdd:wwe,set:pwe,sqrDist:Lwe,sqrLen:Nwe,squaredDistance:lW,squaredLength:cW,str:$we,sub:Rwe,subtract:nW,transformMat4:Iwe,transformQuat:Mwe},Symbol.toStringTag,{value:"Module"}));function ET(){return[0,0,0,0]}function Dwe(e){return[e[0],e[1],e[2],e[3]]}function t0(e,t,r,i){return[e,t,r,i]}function Fwe(e,t=ET()){const r=Math.min(4,e.length);for(let i=0;i<r;++i)t[i]=e[i];return t}function jwe(e,t){return new Float64Array(e,t,4)}function hW(){return ET()}function dW(){return t0(1,1,1,1)}function fW(){return t0(1,0,0,0)}function yW(){return t0(0,1,0,0)}function mW(){return t0(0,0,1,0)}function gW(){return t0(0,0,0,1)}const Uwe=hW(),Vwe=dW(),Gwe=fW(),Bwe=yW(),zwe=mW(),qwe=gW();Object.freeze(Object.defineProperty({__proto__:null,ONES:Vwe,UNIT_W:qwe,UNIT_X:Gwe,UNIT_Y:Bwe,UNIT_Z:zwe,ZEROS:Uwe,clone:Dwe,create:ET,createView:jwe,fromArray:Fwe,fromValues:t0,ones:dW,unitW:gW,unitX:fW,unitY:yW,unitZ:mW,zeros:hW},Symbol.toStringTag,{value:"Module"}));function vW(e){return"r"in e&&"g"in e&&"b"in e}function wW(e){return"h"in e&&"s"in e&&"v"in e}function bW(e){return"l"in e&&"a"in e&&"b"in e}function _W(e){return"l"in e&&"c"in e&&"h"in e}function Hwe(e){return"x"in e&&"y"in e&&"z"in e}const Wwe=[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],Jwe=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];function SW(e,t){const r=[];let i,n;if(e[0].length!==t.length)throw new Error("dimensions do not match");const s=e.length,o=e[0].length;let a=0;for(i=0;i<s;i++){for(a=0,n=0;n<o;n++)a+=e[i][n]*t[n];r.push(a)}return r}function xW(e){const t=[e.r/255,e.g/255,e.b/255].map(i=>i<=.04045?i/12.92:((i+.055)/1.055)**2.4),r=SW(Wwe,t);return{x:100*r[0],y:100*r[1],z:100*r[2]}}function X4(e){const t=SW(Jwe,[e.x/100,e.y/100,e.z/100]).map(r=>{const i=r<=.0031308?12.92*r:1.055*r**.4166666666666667-.055;return Math.min(1,Math.max(i,0))});return{r:Math.round(255*t[0]),g:Math.round(255*t[1]),b:Math.round(255*t[2])}}function TW(e){const t=[e.x/95.047,e.y/100,e.z/108.883].map(r=>r>.008856451679035631?r**.3333333333333333:7.787037037037035*r+.13793103448275862);return{l:116*t[1]-16,a:500*(t[0]-t[1]),b:200*(t[1]-t[2])}}function IW(e){const t=e.l,r=[(t+16)/116+e.a/500,(t+16)/116,(t+16)/116-e.b/200].map(i=>i>6/29?i**3:3*(6/29)**2*(i-4/29));return{x:95.047*r[0],y:100*r[1],z:108.883*r[2]}}function Zwe(e){const t=e.l,r=e.a,i=e.b,n=Math.sqrt(r*r+i*i);let s=Math.atan2(i,r);return s=s>0?s:s+2*Math.PI,{l:t,c:n,h:s}}function Ywe(e){const t=e.l,r=e.c,i=e.h;return{l:t,a:r*Math.cos(i),b:r*Math.sin(i)}}function Kwe(e){return TW(xW(e))}function Xwe(e){return X4(IW(e))}function Qwe(e){return Zwe(TW(xW(e)))}function ebe(e){return X4(IW(Ywe(e)))}function tbe(e){const t=e.r,r=e.g,i=e.b,n=Math.max(t,r,i),s=n-Math.min(t,r,i);let o=n,a=s===0?0:n===t?(r-i)/s%6:n===r?(i-t)/s+2:(t-r)/s+4,u=s===0?0:s/o;return a<0&&(a+=6),a*=60,u*=100,o*=100/255,{h:a,s:u,v:o}}function rbe(e){const t=(e.h+360)%360/60,r=e.s/100,i=e.v/100*255,n=i*r,s=n*(1-Math.abs(t%2-1));let o;switch(Math.floor(t)){case 0:o={r:n,g:s,b:0};break;case 1:o={r:s,g:n,b:0};break;case 2:o={r:0,g:n,b:s};break;case 3:o={r:0,g:s,b:n};break;case 4:o={r:s,g:0,b:n};break;case 5:case 6:o={r:n,g:0,b:s};break;default:o={r:0,g:0,b:0}}return o.r=Math.round(o.r+i-n),o.g=Math.round(o.g+i-n),o.b=Math.round(o.b+i-n),o}function Rm(e){return vW(e)?e:_W(e)?ebe(e):bW(e)?Xwe(e):Hwe(e)?X4(e):wW(e)?rbe(e):e}function hx(e){return wW(e)?e:tbe(Rm(e))}function dx(e){return bW(e)?e:Kwe(Rm(e))}function fx(e){return _W(e)?e:Qwe(Rm(e))}var o9;(function(e){e[e.Low=160]="Low",e[e.High=225]="High"})(o9||(o9={}));function cp(e,t,r,i){const n=3*e,s=3*(r-e)-n,o=1-n-s,a=3*t,u=3*(i-t)-a,c=1-a-u;function h(w){return((o*w+s)*w+n)*w}function d(w){return((c*w+u)*w+a)*w}function y(w){return(3*o*w+2*s)*w+n}function v(w,b){let _,x,T,I,M,$;for(T=w,$=0;$<8;$++){if(I=h(T)-w,Math.abs(I)<b)return T;if(M=y(T),Math.abs(M)<1e-6)break;T-=I/M}if(_=0,x=1,T=w,T<_)return _;if(T>x)return x;for(;_<x;){if(I=h(T),Math.abs(I-w)<b)return T;w>I?_=T:x=T,T=.5*(x-_)+_}return T}return function(w,b=1e-6){return d(v(w,b))}}const ibe=/^cubic-bezier\((.*)\)/,Co={};function nbe(e){let t=Co[e]||null;if(!t){const r=ibe.exec(e);if(r){const i=r[1].split(",").map(n=>parseFloat(n.trim()));i.length!==4||i.some(n=>isNaN(n))||(t=cp.apply(cp,i))}}return t}Co.ease=cp(.25,.1,.25,1),Co.linear=cp(0,0,1,1),Co.easeIn=Co["ease-in"]=cp(.42,0,1,1),Co.easeOut=Co["ease-out"]=cp(0,0,.58,1),Co.easeInOut=Co["ease-in-out"]=cp(.42,0,.58,1);const MW={kind:"null"},Or={kind:"number"},so={kind:"string"},Qi={kind:"boolean"},Hu={kind:"color"},AT={kind:"object"},Nu={kind:"value"};function iw(e,t){return{kind:"array",itemType:e,n:t}}const sbe=[MW,Or,so,Qi,Hu,AT,iw(Nu)];function Cm(e){if(e.kind==="array"){const t=Cm(e.itemType);return typeof e.n=="number"?`array<${t}, ${e.n}>`:e.itemType.kind==="value"?"array":`array<${t}>`}return e.kind}function RT(e){if(e===null)return MW;if(typeof e=="string")return so;if(typeof e=="boolean")return Qi;if(typeof e=="number")return Or;if(e instanceof ve)return Hu;if(Array.isArray(e)){let t;for(const r of e){const i=RT(r);if(t){if(t!==i){t=Nu;break}}else t=i}return iw(t||Nu,e.length)}return typeof e=="object"?AT:Nu}function e5(e,t){if(t.kind==="array")return e.kind==="array"&&(e.n===0&&e.itemType.kind==="value"||e5(e.itemType,t.itemType))&&(typeof t.n!="number"||t.n===e.n);if(t.kind==="value"){for(const r of sbe)if(e5(e,r))return!0}return t.kind===e.kind}function t5(e){if(e===null)return"";const t=typeof e;return t==="string"?e:t==="number"||t==="boolean"?String(e):e instanceof ve?e.toString():JSON.stringify(e)}let obe=class{constructor(t){this._parent=t,this._vars={}}add(t,r){this._vars[t]=r}get(t){return this._vars[t]?this._vars[t]:this._parent?this._parent.get(t):null}},abe=class $W{constructor(){this.type=Nu}static parse(t){if(t.length>1)throw new Error('"id" does not expect arguments');return new $W}evaluate(t,r){return t==null?void 0:t.id}},lbe=class EW{constructor(){this.type=so}static parse(t){if(t.length>1)throw new Error('"geometry-type" does not expect arguments');return new EW}evaluate(t,r){if(!t)return null;switch(t.type){case Oo.Point:return"Point";case Oo.LineString:return"LineString";case Oo.Polygon:return"Polygon";default:return null}}},ube=class AW{constructor(){this.type=AT}static parse(t){if(t.length>1)throw new Error('"properties" does not expect arguments');return new AW}evaluate(t,r){return t==null?void 0:t.values}},RW=class CW{constructor(){this.type=Or}static parse(t){if(t.length>1)throw new Error('"zoom" does not expect arguments');return new CW}evaluate(t,r){return r}},Vo=class OW{constructor(t,r,i){this._lhs=t,this._rhs=r,this._compare=i,this.type=Qi}static parse(t,r,i){if(t.length!==3&&t.length!==4)throw new Error(`"${t[0]}" expects 2 or 3 arguments`);if(t.length===4)throw new Error(`"${t[0]}" collator not supported`);return new OW(Xe(t[1],r),Xe(t[2],r),i)}evaluate(t,r){return this._compare(this._lhs.evaluate(t,r),this._rhs.evaluate(t,r))}},cbe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i===n)}},pbe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i!==n)}},hbe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i<n)}},dbe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i<=n)}},fbe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i>n)}},ybe=class extends Vo{static parse(t,r){return Vo.parse(t,r,(i,n)=>i>=n)}},mbe=class PW{constructor(t){this._arg=t,this.type=Qi}static parse(t,r){if(t.length!==2)throw new Error('"!" expects 1 argument');return new PW(Xe(t[1],r))}evaluate(t,r){return!this._arg.evaluate(t,r)}},gbe=class LW{constructor(t){this._args=t,this.type=Qi}static parse(t,r){const i=[];for(let n=1;n<t.length;n++)i.push(Xe(t[n],r));return new LW(i)}evaluate(t,r){for(const i of this._args)if(!i.evaluate(t,r))return!1;return!0}},vbe=class kW{constructor(t){this._args=t,this.type=Qi}static parse(t,r){const i=[];for(let n=1;n<t.length;n++)i.push(Xe(t[n],r));return new kW(i)}evaluate(t,r){for(const i of this._args)if(i.evaluate(t,r))return!0;return!1}},wbe=class NW{constructor(t){this._args=t,this.type=Qi}static parse(t,r){const i=[];for(let n=1;n<t.length;n++)i.push(Xe(t[n],r));return new NW(i)}evaluate(t,r){for(const i of this._args)if(i.evaluate(t,r))return!1;return!0}},bbe=class DW{constructor(t,r,i){this.type=t,this._args=r,this._fallback=i}static parse(t,r,i){if(t.length<4)throw new Error('"case" expects at least 3 arguments');if(t.length%2==1)throw new Error('"case" expects an odd number of arguments');let n;const s=[];for(let a=1;a<t.length-1;a+=2){const u=Xe(t[a],r),c=Xe(t[a+1],r,i);n||(n=c.type),s.push({condition:u,output:c})}const o=Xe(t[t.length-1],r,i);return n||(n=o.type),new DW(n,s,o)}evaluate(t,r){for(const i of this._args)if(i.condition.evaluate(t,r))return i.output.evaluate(t,r);return this._fallback.evaluate(t,r)}},_be=class FW{constructor(t,r){this.type=t,this._args=r}static parse(t,r){if(t.length<2)throw new Error('"coalesce" expects at least 1 argument');let i;const n=[];for(let s=1;s<t.length;s++){const o=Xe(t[s],r);i||(i=o.type),n.push(o)}return new FW(i,n)}evaluate(t,r){for(const i of this._args){const n=i.evaluate(t,r);if(n!==null)return n}return null}},Sbe=class jW{constructor(t,r,i,n,s){this.type=t,this._input=r,this._labels=i,this._outputs=n,this._fallback=s}static parse(t,r){if(t.length<3)throw new Error('"match" expects at least 3 arguments');if(t.length%2==0)throw new Error('"case" expects an even number of arguments');let i;const n=Xe(t[1],r),s=[],o={};let a;for(let u=2;u<t.length-1;u+=2){let c=t[u];Array.isArray(c)||(c=[c]);for(const d of c){const y=typeof d;if(y!=="string"&&y!=="number")throw new Error('"match" requires string or number literal as labels');if(a){if(y!==a)throw new Error('"match" requires labels to have the same type')}else a=y;o[d]=s.length}const h=Xe(t[u+1],r);i||(i=h.type),s.push(h)}return new jW(i,n,o,s,Xe(t[t.length-1],r))}evaluate(t,r){const i=this._input.evaluate(t,r);return(this._outputs[this._labels[i]]||this._fallback).evaluate(t,r)}},g2=class Uh{constructor(t,r,i,n,s){this._operator=t,this.type=r,this.interpolation=i,this.input=n,this._stops=s}static parse(t,r,i){const n=t[0];if(t.length<5)throw new Error(`"${n}" expects at least 4 arguments`);const s=t[1];if(!Array.isArray(s)||s.length===0)throw new Error(`"${s}" is not a valid interpolation`);switch(s[0]){case"linear":if(s.length!==1)throw new Error("Linear interpolation cannot have parameters");break;case"exponential":if(s.length!==2||typeof s[1]!="number")throw new Error("Exponential interpolation requires one numeric argument");break;case"cubic-bezier":if(s.length!==5)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1");for(let c=1;c<5;c++){const h=s[c];if(typeof h!="number"||h<0||h>1)throw new Error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1")}break;default:throw new Error(`"${t[0]}" unknown interpolation type "${s[0]}"`)}if(t.length%2!=1)throw new Error(`"${n}" expects an even number of arguments`);const o=Xe(t[2],r,Or);let a;n==="interpolate-hcl"||n==="interpolate-lab"?a=Hu:i&&i.kind!=="value"&&(a=i);const u=[];for(let c=3;c<t.length;c+=2){const h=t[c];if(typeof h!="number")throw new Error(`"${n}" requires stop inputs as literal numbers`);if(u.length&&u[u.length-1][0]>=h)throw new Error(`"${n}" requires strictly ascending stop inputs`);const d=Xe(t[c+1],r,a);a||(a=d.type),u.push([h,d])}if(a&&a!==Hu&&a!==Or&&(a.kind!=="array"||a.itemType!==Or))throw new Error(`"${n}" cannot interpolate type ${Cm(a)}`);return new Uh(n,a,s,o,u)}evaluate(t,r){const i=this._stops;if(i.length===1)return i[0][1].evaluate(t,r);const n=this.input.evaluate(t,r);if(n<=i[0][0])return i[0][1].evaluate(t,r);if(n>=i[i.length-1][0])return i[i.length-1][1].evaluate(t,r);let s=0;for(;++s<i.length&&!(n<i[s][0]););const o=i[s-1][0],a=i[s][0],u=Uh.interpolationRatio(this.interpolation,n,o,a),c=i[s-1][1].evaluate(t,r),h=i[s][1].evaluate(t,r);if(this._operator==="interpolate"){if(this.type.kind==="array"&&Array.isArray(c)&&Array.isArray(h))return c.map((d,y)=>qn(d,h[y],u));if(this.type.kind==="color"&&c instanceof ve&&h instanceof ve){const d=new ve(c),y=new ve(h);return new ve([qn(d.r,y.r,u),qn(d.g,y.g,u),qn(d.b,y.b,u),qn(d.a,y.a,u)])}if(this.type.kind==="number"&&typeof c=="number"&&typeof h=="number")return qn(c,h,u);throw new Error(`"${this._operator}" cannot interpolate type ${Cm(this.type)}`)}if(this._operator==="interpolate-hcl"){const d=fx(c),y=fx(h),v=y.h-d.h,w=Rm({h:d.h+u*(v>180||v<-180?v-360*Math.round(v/360):v),c:qn(d.c,y.c,u),l:qn(d.l,y.l,u)});return new ve({a:qn(c.a,h.a,u),...w})}if(this._operator==="interpolate-lab"){const d=dx(c),y=dx(h),v=Rm({l:qn(d.l,y.l,u),a:qn(d.a,y.a,u),b:qn(d.b,y.b,u)});return new ve({a:qn(c.a,h.a,u),...v})}throw new Error(`Unexpected operator "${this._operator}"`)}interpolationUniformValue(t,r){const i=this._stops;if(i.length===1||t>=i[i.length-1][0])return 0;let n=0;for(;++n<i.length&&!(t<i[n][0]););const s=i[n-1][0],o=i[n][0];return Uh.interpolationRatio(this.interpolation,r,s,o)}getInterpolationRange(t){const r=this._stops;if(r.length===1){const s=r[0][0];return[s,s]}const i=r[r.length-1][0];if(t>=i)return[i,i];let n=0;for(;++n<r.length&&!(t<r[n][0]););return[r[n-1][0],r[n][0]]}static interpolationRatio(t,r,i,n){let s=0;return t[0]==="linear"?s=Uh._exponentialInterpolationRatio(r,1,i,n):t[0]==="exponential"?s=Uh._exponentialInterpolationRatio(r,t[1],i,n):t[0]==="cubic-bezier"&&(s=cp(t[1],t[2],t[3],t[4])(Uh._exponentialInterpolationRatio(r,1,i,n),1e-5)),s<0?s=0:s>1&&(s=1),s}static _exponentialInterpolationRatio(t,r,i,n){const s=n-i;if(s===0)return 0;const o=t-i;return r===1?o/s:(r**o-1)/(r**s-1)}},xbe=class UW{constructor(t,r,i){this.type=t,this._input=r,this._stops=i}static parse(t,r){if(t.length<5)throw new Error('"step" expects at least 4 arguments');if(t.length%2!=1)throw new Error('"step" expects an even number of arguments');const i=Xe(t[1],r,Or);let n;const s=[];s.push([-1/0,Xe(t[2],r)]);for(let o=3;o<t.length;o+=2){const a=t[o];if(typeof a!="number")throw new Error('"step" requires stop inputs as literal numbers');if(s.length&&s[s.length-1][0]>=a)throw new Error('"step" requires strictly ascending stop inputs');const u=Xe(t[o+1],r);n||(n=u.type),s.push([a,u])}return new UW(n,i,s)}evaluate(t,r){const i=this._stops;if(i.length===1)return i[0][1].evaluate(t,r);const n=this._input.evaluate(t,r);let s=0;for(;++s<i.length&&!(n<i[s][0]););return this._stops[s-1][1].evaluate(t,r)}},Tbe=class VW{constructor(t,r){this.type=t,this._output=r}static parse(t,r,i){if(t.length<4)throw new Error('"let" expects at least 3 arguments');if(t.length%2==1)throw new Error('"let" expects an odd number of arguments');const n=new obe(r);for(let o=1;o<t.length-1;o+=2){const a=t[o];if(typeof a!="string")throw new Error(`"let" requires a string to define variable names - found ${a}`);n.add(a,Xe(t[o+1],r))}const s=Xe(t[t.length-1],n,i);return new VW(s.type,s)}evaluate(t,r){return this._output.evaluate(t,r)}},Ibe=class GW{constructor(t,r){this.type=t,this.output=r}static parse(t,r,i){if(t.length!==2||typeof t[1]!="string")throw new Error('"var" requires just one literal string argument');const n=r.get(t[1]);if(!n)throw new Error(`${t[1]} must be defined before being used in a "var" expression`);return new GW(i||Nu,n)}evaluate(t,r){return this.output.evaluate(t,r)}},Mbe=class BW{constructor(t,r,i){this.type=t,this._index=r,this._array=i}static parse(t,r){if(t.length!==3)throw new Error('"at" expects 2 arguments');const i=Xe(t[1],r,Or),n=Xe(t[2],r);return new BW(n.type.itemType,i,n)}evaluate(t,r){const i=this._index.evaluate(t,r),n=this._array.evaluate(t,r);if(i<0||i>=n.length)throw new Error('"at" index out of bounds');if(i!==Math.floor(i))throw new Error('"at" index must be an integer');return n[i]}},$be=class r5{constructor(t,r){this._key=t,this._obj=r,this.type=Nu}static parse(t,r){let i,n;switch(t.length){case 2:return i=Xe(t[1],r),new r5(i);case 3:return i=Xe(t[1],r),n=Xe(t[2],r),new r5(i,n);default:throw new Error('"get" expects 1 or 2 arguments')}}evaluate(t,r){const i=this._key.evaluate(t,r);return this._obj?this._obj.evaluate(t,r)[i]:t==null?void 0:t.values[i]}},Ebe=class i5{constructor(t,r){this._key=t,this._obj=r,this.type=Qi}static parse(t,r){let i,n;switch(t.length){case 2:return i=Xe(t[1],r),new i5(i);case 3:return i=Xe(t[1],r),n=Xe(t[2],r),new i5(i,n);default:throw new Error('"has" expects 1 or 2 arguments')}}evaluate(t,r){const i=this._key.evaluate(t,r);return this._obj?i in this._obj.evaluate(t,r):!!(t!=null&&t.values[i])}},Abe=class zW{constructor(t,r){this._key=t,this._vals=r,this.type=Qi}static parse(t,r){if(t.length!==3)throw new Error('"in" expects 2 arguments');return new zW(Xe(t[1],r),Xe(t[2],r))}evaluate(t,r){const i=this._key.evaluate(t,r);return this._vals.evaluate(t,r).includes(i)}},Rbe=class n5{constructor(t,r,i){this._item=t,this._array=r,this._from=i,this.type=Or}static parse(t,r){if(t.length<3||t.length>4)throw new Error('"index-of" expects 3 or 4 arguments');const i=Xe(t[1],r),n=Xe(t[2],r);if(t.length===4){const s=Xe(t[3],r,Or);return new n5(i,n,s)}return new n5(i,n)}evaluate(t,r){const i=this._item.evaluate(t,r),n=this._array.evaluate(t,r);if(this._from){const s=this._from.evaluate(t,r);if(s!==Math.floor(s))throw new Error('"index-of" index must be an integer');return n.indexOf(i,s)}return n.indexOf(i)}},Cbe=class qW{constructor(t){this._arg=t,this.type=Or}static parse(t,r){if(t.length!==2)throw new Error('"length" expects 2 arguments');const i=Xe(t[1],r);return new qW(i)}evaluate(t,r){const i=this._arg.evaluate(t,r);if(typeof i=="string"||Array.isArray(i))return i.length;throw new Error('"length" expects string or array')}},Obe=class s5{constructor(t,r,i,n){this.type=t,this._array=r,this._from=i,this._to=n}static parse(t,r){if(t.length<3||t.length>4)throw new Error('"slice" expects 2 or 3 arguments');const i=Xe(t[1],r),n=Xe(t[2],r,Or);if(n.type!==Or)throw new Error('"slice" index must return a number');if(t.length===4){const s=Xe(t[3],r,Or);if(s.type!==Or)throw new Error('"slice" index must return a number');return new s5(i.type,i,n,s)}return new s5(i.type,i,n)}evaluate(t,r){const i=this._array.evaluate(t,r);if(!Array.isArray(i)&&typeof i!="string")throw new Error('"slice" input must be an array or a string');const n=this._from.evaluate(t,r);if(n<0||n>=i.length)throw new Error('"slice" index out of bounds');if(n!==Math.floor(n))throw new Error('"slice" index must be an integer');if(this._to){const s=this._to.evaluate(t,r);if(s<0||s>=i.length)throw new Error('"slice" index out of bounds');if(s!==Math.floor(s))throw new Error('"slice" index must be an integer');return i.slice(n,s)}return i.slice(n)}},Pbe=class HW{constructor(){this.type=Qi}static parse(t){if(t.length!==1)throw new Error('"has-id" expects no arguments');return new HW}evaluate(t,r){return(t==null?void 0:t.id)!==void 0}},Qs=class WW{constructor(t,r){this._args=t,this._calculate=r,this.type=Or}static parse(t,r,i){const n=t.slice(1).map(s=>Xe(s,r));return new WW(n,i)}evaluate(t,r){let i;return this._args&&(i=this._args.map(n=>n.evaluate(t,r))),this._calculate(i)}},Lbe=class extends Qs{static parse(t,r){switch(t.length){case 2:return Qs.parse(t,r,i=>-i[0]);case 3:return Qs.parse(t,r,i=>i[0]-i[1]);default:throw new Error('"-" expects 1 or 2 arguments')}}},kbe=class extends Qs{static parse(t,r){return Qs.parse(t,r,i=>{let n=1;for(const s of i)n*=s;return n})}},Nbe=class extends Qs{static parse(t,r){if(t.length===3)return Qs.parse(t,r,i=>i[0]/i[1]);throw new Error('"/" expects 2 arguments')}},Dbe=class extends Qs{static parse(t,r){if(t.length===3)return Qs.parse(t,r,i=>i[0]%i[1]);throw new Error('"%" expects 2 arguments')}},Fbe=class extends Qs{static parse(t,r){if(t.length===3)return Qs.parse(t,r,i=>i[0]**i[1]);throw new Error('"^" expects 1 or 2 arguments')}},jbe=class extends Qs{static parse(t,r){return Qs.parse(t,r,i=>{let n=0;for(const s of i)n+=s;return n})}},ai=class o5{constructor(t,r){this._args=t,this._calculate=r,this.type=Or}static parse(t,r){const i=t.slice(1).map(n=>Xe(n,r));return new o5(i,o5.ops[t[0]])}evaluate(t,r){let i;return this._args&&(i=this._args.map(n=>n.evaluate(t,r))),this._calculate(i)}};ai.ops={abs:e=>Math.abs(e[0]),acos:e=>Math.acos(e[0]),asin:e=>Math.asin(e[0]),atan:e=>Math.atan(e[0]),ceil:e=>Math.ceil(e[0]),cos:e=>Math.cos(e[0]),e:()=>Math.E,floor:e=>Math.floor(e[0]),ln:e=>Math.log(e[0]),ln2:()=>Math.LN2,log10:e=>Math.log(e[0])/Math.LN10,log2:e=>Math.log(e[0])/Math.LN2,max:e=>Math.max(...e),min:e=>Math.min(...e),pi:()=>Math.PI,round:e=>Math.round(e[0]),sin:e=>Math.sin(e[0]),sqrt:e=>Math.sqrt(e[0]),tan:e=>Math.tan(e[0])};let Ube=class JW{constructor(t){this._args=t,this.type=so}static parse(t,r){return new JW(t.slice(1).map(i=>Xe(i,r)))}evaluate(t,r){return this._args.map(i=>i.evaluate(t,r)).join("")}},a5=class l5{constructor(t,r){this._arg=t,this._calculate=r,this.type=so}static parse(t,r){if(t.length!==2)throw new Error(`${t[0]} expects 1 argument`);const i=Xe(t[1],r);return new l5(i,l5.ops[t[0]])}evaluate(t,r){return this._calculate(this._arg.evaluate(t,r))}};a5.ops={downcase:e=>e.toLowerCase(),upcase:e=>e.toUpperCase()};let Vbe=class ZW{constructor(t){this._args=t,this.type=Hu}static parse(t,r){if(t.length!==4)throw new Error('"rgb" expects 3 arguments');const i=t.slice(1).map(n=>Xe(n,r));return new ZW(i)}evaluate(t,r){const i=this._validate(this._args[0].evaluate(t,r)),n=this._validate(this._args[1].evaluate(t,r)),s=this._validate(this._args[2].evaluate(t,r));return new ve({r:i,g:n,b:s})}_validate(t){if(typeof t!="number"||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}},Gbe=class YW{constructor(t){this._args=t,this.type=Hu}static parse(t,r){if(t.length!==5)throw new Error('"rgba" expects 4 arguments');const i=t.slice(1).map(n=>Xe(n,r));return new YW(i)}evaluate(t,r){const i=this._validate(this._args[0].evaluate(t,r)),n=this._validate(this._args[1].evaluate(t,r)),s=this._validate(this._args[2].evaluate(t,r)),o=this._validateAlpha(this._args[3].evaluate(t,r));return new ve({r:i,g:n,b:s,a:o})}_validate(t){if(typeof t!="number"||t<0||t>255)throw new Error(`${t}: invalid color component`);return Math.round(t)}_validateAlpha(t){if(typeof t!="number"||t<0||t>1)throw new Error(`${t}: invalid alpha color component`);return t}},Bbe=class KW{constructor(t){this._color=t,this.type=iw(Or,4)}static parse(t,r){if(t.length!==2)throw new Error('"to-rgba" expects 1 argument');const i=Xe(t[1],r);return new KW(i)}evaluate(t,r){return new ve(this._color.evaluate(t,r)).toRgba()}},Z0=class XW{constructor(t,r){this.type=t,this._args=r}static parse(t,r){const i=t[0];if(t.length<2)throw new Error(`${i} expects at least one argument`);let n,s=1;if(i==="array"){if(t.length>2){switch(t[1]){case"string":n=so;break;case"number":n=Or;break;case"boolean":n=Qi;break;default:throw new Error('"array" type argument must be string, number or boolean')}s++}else n=Nu;let a;if(t.length>3){if(a=t[2],a!==null&&(typeof a!="number"||a<0||a!==Math.floor(a)))throw new Error('"array" length argument must be a positive integer literal');s++}n=iw(n,a)}else switch(i){case"string":n=so;break;case"number":n=Or;break;case"boolean":n=Qi;break;case"object":n=AT}const o=[];for(;s<t.length;s++){const a=Xe(t[s],r);o.push(a)}return new XW(n,o)}evaluate(t,r){let i;for(const n of this._args){const s=n.evaluate(t,r);if(i=RT(s),e5(i,this.type))return s}throw new Error(`Expected ${Cm(this.type)} but got ${Cm(i)}`)}},yp=class v2{constructor(t,r){this.type=t,this._args=r}static parse(t,r){const i=t[0],n=v2.types[i];if(n===Qi||n===so){if(t.length!==2)throw new Error(`${i} expects one argument`)}else if(t.length<2)throw new Error(`${i} expects at least one argument`);const s=[];for(let o=1;o<t.length;o++){const a=Xe(t[o],r);s.push(a)}return new v2(n,s)}evaluate(t,r){if(this.type===Qi)return!!this._args[0].evaluate(t,r);if(this.type===so)return t5(this._args[0].evaluate(t,r));if(this.type===Or){for(const i of this._args){const n=Number(i.evaluate(t,r));if(!isNaN(n))return n}return null}if(this.type===Hu){for(const i of this._args)try{const n=v2.toColor(i.evaluate(t,r));if(n instanceof ve)return n}catch{}return null}}static toBoolean(t){return!!t}static toString(t){return t5(t)}static toNumber(t){const r=Number(t);if(isNaN(r))throw new Error(`"${t}" is not a number`);return r}static toColor(t){if(t instanceof ve)return t;if(typeof t=="string"){const r=ve.fromString(t);if(r)return r;throw new Error(`"${t}" is not a color`)}if(Array.isArray(t))return ve.fromArray(t);throw new Error(`"${t}" is not a color`)}};yp.types={"to-boolean":Qi,"to-color":Hu,"to-number":Or,"to-string":so};let zbe=class QW{constructor(t){this._val=t,this.type=RT(t)}static parse(t){if(t.length!==2)throw new Error('"literal" expects 1 argument');return new QW(t[1])}evaluate(t,r){return this._val}},qbe=class eJ{constructor(t){this._arg=t,this.type=so}static parse(t,r){if(t.length!==2)throw new Error('"typeof" expects 1 argument');return new eJ(Xe(t[1],r))}evaluate(t,r){return Cm(RT(this._arg.evaluate(t,r)))}};function Xe(e,t,r){const i=typeof e;if(i==="string"||i==="boolean"||i==="number"||e===null){if(r)switch(r.kind){case"string":i!=="string"&&(e=yp.toString(e));break;case"number":i!=="number"&&(e=yp.toNumber(e));break;case"color":e=yp.toColor(e)}e=["literal",e]}if(!Array.isArray(e)||e.length===0)throw new Error("Expression must be a non empty array");const n=e[0];if(typeof n!="string")throw new Error("First element of expression must be a string");const s=tJ[n];if(s===void 0)throw new Error(`Invalid expression operator "${n}"`);if(!s)throw new Error(`Unimplemented expression operator "${n}"`);return s.parse(e,t,r)}const tJ={array:Z0,boolean:Z0,collator:null,format:null,image:null,literal:zbe,number:Z0,"number-format":null,object:Z0,string:Z0,"to-boolean":yp,"to-color":yp,"to-number":yp,"to-string":yp,typeof:qbe,accumulated:null,"feature-state":null,"geometry-type":lbe,id:abe,"line-progress":null,properties:ube,at:Mbe,get:$be,has:Ebe,in:Abe,"index-of":Rbe,length:Cbe,slice:Obe,"!":mbe,"!=":pbe,"<":hbe,"<=":dbe,"==":cbe,">":fbe,">=":ybe,all:gbe,any:vbe,case:bbe,coalesce:_be,match:Sbe,within:null,interpolate:g2,"interpolate-hcl":g2,"interpolate-lab":g2,step:xbe,let:Tbe,var:Ibe,concat:Ube,downcase:a5,"is-supported-script":null,"resolved-locale":null,upcase:a5,rgb:Vbe,rgba:Gbe,"to-rgba":Bbe,"-":Lbe,"*":kbe,"/":Nbe,"%":Dbe,"^":Fbe,"+":jbe,abs:ai,acos:ai,asin:ai,atan:ai,ceil:ai,cos:ai,e:ai,floor:ai,ln:ai,ln2:ai,log10:ai,log2:ai,max:ai,min:ai,pi:ai,round:ai,sin:ai,sqrt:ai,tan:ai,zoom:RW,"heatmap-density":null,"has-id":Pbe,none:wbe};let Hbe=class Ps{constructor(t){this._expression=t}filter(t,r){if(!this._expression)return!0;try{return this._expression.evaluate(t,r)}catch(i){return console.log(i.message),!0}}static createFilter(t){if(!t)return null;this.isLegacyFilter(t)&&(t=this.convertLegacyFilter(t));try{const r=Xe(t,null,Qi);return new Ps(r)}catch(r){return console.log(r.message),null}}static isLegacyFilter(t){if(!Array.isArray(t)||t.length===0)return!0;switch(t[0]){case"==":case"!=":case">":case"<":case">=":case"<=":return t.length===3&&typeof t[1]=="string"&&!Array.isArray(t[2]);case"in":return t.length>=3&&typeof t[1]=="string"&&!Array.isArray(t[2]);case"!in":case"none":case"!has":return!0;case"any":case"all":for(let r=1;r<t.length;r++)if(this.isLegacyFilter(t[r]))return!0;return!1;case"has":return t.length===2&&(t[1]==="$id"||t[1]==="$type");default:return!1}}static convertLegacyFilter(t){if(!Array.isArray(t)||t.length===0)return!0;const r=t[0];if(t.length===1)return r!=="any";switch(r){case"==":return Ps.convertComparison("==",t[1],t[2]);case"!=":return Ps.negate(Ps.convertComparison("==",t[1],t[2]));case">":case"<":case">=":case"<=":return Ps.convertComparison(r,t[1],t[2]);case"in":return Ps.convertIn(t[1],t.slice(2));case"!in":return Ps.negate(Ps.convertIn(t[1],t.slice(2)));case"any":case"all":case"none":return Ps.convertCombining(r,t.slice(1));case"has":return Ps.convertHas(t[1]);case"!has":return Ps.negate(Ps.convertHas(t[1]));default:throw new Error("Unexpected legacy filter.")}}static convertComparison(t,r,i){switch(r){case"$type":return[t,["geometry-type"],i];case"$id":return[t,["id"],i];default:return[t,["get",r],i]}}static convertIn(t,r){switch(t){case"$type":return["in",["geometry-type"],["literal",r]];case"$id":return["in",["id"],["literal",r]];default:return["in",["get",t],["literal",r]]}}static convertHas(t){switch(t){case"$type":return!0;case"$id":return["has-id"];default:return["has",t]}}static convertCombining(t,r){return[t].concat(r.map(this.convertLegacyFilter))}static negate(t){return["!",t]}},a9=class rJ{constructor(t,r){let i;switch(this.isDataDriven=!1,this.interpolator=null,t.type){case"number":case"color":i=!0;break;case"array":i=t.value==="number";break;default:i=!1}if(r==null&&(r=t.default),Array.isArray(r)&&r.length>0&&tJ[r[0]]){const s={number:Or,color:Hu,string:so,boolean:Qi,enum:so};try{const o=t.type==="array"?iw(s[t.value]||Nu,t.length):s[t.type],a=Xe(r,null,o);this.getValue=this._buildExpression(a,t),this.isDataDriven=!0,a instanceof g2&&a.input instanceof RW&&(this.interpolator=a)}catch(o){console.log(o.message),this.getValue=this._buildSimple(t.default)}return}i&&r.type==="interval"&&(i=!1);const n=(r==null?void 0:r.stops)&&r.stops.length>0;if(n)for(const s of r.stops)s[1]=this._validate(s[1],t);if(this.isDataDriven=!!r&&!!r.property,this.isDataDriven)if(r.default!==void 0&&(r.default=this._validate(r.default,t)),n)switch(r.type){case"identity":this.getValue=this._buildIdentity(r,t);break;case"categorical":this.getValue=this._buildCategorical(r,t);break;default:this.getValue=i?this._buildInterpolate(r,t):this._buildInterval(r,t)}else this.getValue=this._buildIdentity(r,t);else n?this.getValue=i?this._buildZoomInterpolate(r):this._buildZoomInterval(r):(r=this._validate(r,t),this.getValue=this._buildSimple(r))}_validate(t,r){if(r.type==="number"){if(r.minimum!=null&&t<r.minimum)return r.minimum;if(r.maximum!=null&&t>r.maximum)return r.maximum}else r.type==="color"?t=rJ._parseColor(t):r.type==="enum"?typeof t=="string"&&(t=r.values.indexOf(t)):r.type==="array"&&r.value==="enum"?t=t.map(i=>typeof i=="string"?r.values.indexOf(i):i):r.type==="string"&&(t=t5(t));return t}_buildSimple(t){return()=>t}_buildExpression(t,r){return(i,n)=>{try{const s=t.evaluate(n,i);return s===void 0?r.default:this._validate(s,r)}catch(s){return console.log(s.message),r.default}}}_buildIdentity(t,r){return(i,n)=>{let s;return n&&(s=n.values[t.property]),s!==void 0&&(s=this._validate(s,r)),s??(t.default!==void 0?t.default:r.default)}}_buildCategorical(t,r){return(i,n)=>{let s;return n&&(s=n.values[t.property]),s=this._categorical(s,t.stops),s!==void 0?s:t.default!==void 0?t.default:r.default}}_buildInterval(t,r){return(i,n)=>{let s;return n&&(s=n.values[t.property]),typeof s=="number"?this._interval(s,t.stops):t.default!==void 0?t.default:r.default}}_buildInterpolate(t,r){return(i,n)=>{let s;return n&&(s=n.values[t.property]),typeof s=="number"?this._interpolate(s,t.stops,t.base||1):t.default!==void 0?t.default:r.default}}_buildZoomInterpolate(t){return r=>this._interpolate(r,t.stops,t.base||1)}_buildZoomInterval(t){return r=>this._interval(r,t.stops)}_categorical(t,r){const i=r.length;for(let n=0;n<i;n++)if(r[n][0]===t)return r[n][1]}_interval(t,r){const i=r.length;let n=0;for(let s=0;s<i&&r[s][0]<=t;s++)n=s;return r[n][1]}_interpolate(t,r,i){let n,s;const o=r.length;for(let a=0;a<o;a++){const u=r[a];if(!(u[0]<=t)){s=u;break}n=u}if(n&&s){const a=s[0]-n[0],u=t-n[0],c=i===1?u/a:(i**u-1)/(i**a-1);if(Array.isArray(n[1])){const h=n[1],d=s[1],y=[];for(let v=0;v<h.length;v++)y.push(qn(h[v],d[v],c));return y}return qn(n[1],s[1],c)}return n?n[1]:s?s[1]:void 0}static _isEmpty(t){for(const r in t)if(t.hasOwnProperty(r))return!1;return!0}static _parseColor(t){return Array.isArray(t)?t:(typeof t=="string"&&(t=new ve(t)),t instanceof ve&&!this._isEmpty(t)?ve.toUnitRGBA(t):void 0)}};const tFe=1e-30,rFe=512,iFe=128,nFe=511,sFe=16777216,oFe=8,aFe=29,lFe=24,uFe=4,cFe=0,pFe=0,hFe=0,dFe=1,fFe=2,yFe=3,mFe=4,gFe=5,vFe=6,wFe=12,bFe=5,_Fe=6,SFe=5,xFe=6;var l9;(function(e){e[e.FilterFlags=0]="FilterFlags",e[e.Animation=1]="Animation",e[e.GPGPU=2]="GPGPU",e[e.VV=3]="VV",e[e.DD0=4]="DD0",e[e.DD1=5]="DD1",e[e.DD2=6]="DD2"})(l9||(l9={}));const Wbe=3,Jbe=1<<Wbe,TFe=Jbe<<1,Zbe=1.05,IFe=1,MFe=5,$Fe=6,EFe=1.15,Ybe=2,AFe=128-2*Ybe,RFe=2,CFe=10,OFe=1024,PFe=128,LFe=4,kFe=1,NFe=1<<20,DFe=.75,FFe=10,jFe=.75,UFe=256,Om=8;var N1;(function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"})(N1||(N1={}));let VFe=class{constructor(t,r,i,n,s,o){this.layer=t,this.feature=r,this.bounds=i,this.normalizationRatio=n,this.normalizationOffsetX=s,this.normalizationOffsetY=o}},nw=class{constructor(t,r,i,n){switch(this.type=t,this.typeName=r.type,this.id=r.id,this.source=r.source,this.sourceLayer=r["source-layer"],this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,this.filter=r.filter,this.layout=r.layout,this.paint=r.paint,this.z=i,this.uid=n,t){case Br.BACKGROUND:this._layoutDefinition=Yr.backgroundLayoutDefinition,this._paintDefinition=Yr.backgroundPaintDefinition;break;case Br.FILL:this._layoutDefinition=Yr.fillLayoutDefinition,this._paintDefinition=Yr.fillPaintDefinition;break;case Br.LINE:this._layoutDefinition=Yr.lineLayoutDefinition,this._paintDefinition=Yr.linePaintDefinition;break;case Br.SYMBOL:this._layoutDefinition=Yr.symbolLayoutDefinition,this._paintDefinition=Yr.symbolPaintDefinition;break;case Br.CIRCLE:this._layoutDefinition=Yr.circleLayoutDefinition,this._paintDefinition=Yr.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}getFeatureFilter(){return this._featureFilter!==void 0?this._featureFilter:this._featureFilter=Hbe.createFilter(this.filter)}getLayoutProperty(t){return this._layoutProperties[t]}getPaintProperty(t){return this._paintProperties[t]}getLayoutValue(t,r,i){let n;const s=this._layoutProperties[t];return s&&(n=s.getValue(r,i)),n===void 0&&(n=this._layoutDefinition[t].default),n}getPaintValue(t,r,i){let n;const s=this._paintProperties[t];return s&&(n=s.getValue(r,i)),n===void 0&&(n=this._paintDefinition[t].default),n}isPainterDataDriven(){const t=this._paintProperties;if(t){for(const r in t)if(t[r].isDataDriven)return!0}return!1}isIntersectingFeature(t,r,i,n,s,o,a){return!1}getFeatureInflatedBounds(t,r,i,n){return null}_parseLayout(t){const r={};for(const i in t){const n=this._layoutDefinition[i];n&&(r[i]=new a9(n,t[i]))}return r}_parsePaint(t){const r={};for(const i in t){const n=this._paintDefinition[i];n&&(r[i]=new a9(n,t[i]))}return r}computeAttributesKey(t,r,i,n){let s=0,o=0;for(const a of r){let u=3;if(!a||a!==n){const c=i[a],{isLayout:h,isOptional:d}=c,y=h?this.getLayoutProperty(a):this.getPaintProperty(a);u=y!=null&&y.interpolator?2:y!=null&&y.isDataDriven?1:d&&!y?3:0}o|=u<<s,s+=2}return o<<3|t}},u9=class extends nw{constructor(t,r,i,n){super(t,r,i,n),this.backgroundMaterial=new tm(this.computeAttributesKey(qu.BACKGROUND,tm.ATTRIBUTES,tm.ATTRIBUTES_INFO))}},c9=class extends nw{constructor(t,r,i,n){super(t,r,i,n);const s=this.getPaintProperty("fill-color"),o=this.getPaintProperty("fill-opacity"),a=this.getPaintProperty("fill-pattern");this.hasDataDrivenColor=s==null?void 0:s.isDataDriven,this.hasDataDrivenOpacity=o==null?void 0:o.isDataDriven,this.hasDataDrivenFill=this.hasDataDrivenColor||this.hasDataDrivenOpacity||(a==null?void 0:a.isDataDriven);const u=this.getPaintProperty("fill-outline-color");this.outlineUsesFillColor=!u,this.hasDataDrivenOutlineColor=u==null?void 0:u.isDataDriven,this.hasDataDrivenOutline=u?u.isDataDriven:!!s&&s.isDataDriven,this.hasDataDrivenOutline=(u?this.hasDataDrivenOutlineColor:this.hasDataDrivenColor)||this.hasDataDrivenOpacity,this.fillMaterial=new im(this.computeAttributesKey(qu.FILL,im.ATTRIBUTES,im.ATTRIBUTES_INFO)),this.outlineMaterial=new gl(this.computeAttributesKey(qu.OUTLINE,this.outlineUsesFillColor?gl.ATTRIBUTES_FILL:gl.ATTRIBUTES_OUTLINE,this.outlineUsesFillColor?gl.ATTRIBUTES_INFO_FILL:gl.ATTRIBUTES_INFO_OUTLINE),this.outlineUsesFillColor)}getFeatureInflatedBounds(t,r,i,n){const s=Q4(t);if(!s)return null;const o=this.getPaintValue("fill-translate",r,t),a=n*Math.max(o[0],o[1]);return s[0]-=a,s[2]-=a,s[1]+=a,s[3]+=a,s}isIntersectingFeature(t,r,i,n,s,o,a){const u=n.getGeometry();if(!u)return!1;const c=Om/a.normalizationRatio;t=t/a.normalizationRatio+a.normalizationOffsetX,r=r/a.normalizationRatio+a.normalizationOffsetY;const h=K4(this.getPaintValue("fill-translate",s,n),this.getPaintValue("fill-translate-anchor",s,n),o,Om);return t-=c*h.x,r-=c*h.y,!!swe(t,r,u)||tW(t,r,u,c*i)}},p9=class extends nw{constructor(t,r,i,n){var o,a,u,c,h,d,y,v,w;super(t,r,i,n);const s=this.getPaintProperty("line-pattern");if(this.lineMaterial=new nm(this.computeAttributesKey(qu.LINE,nm.ATTRIBUTES,nm.ATTRIBUTES_INFO,s?"line-dasharray":"")),this.hasDataDrivenLine=((o=this.getPaintProperty("line-blur"))==null?void 0:o.isDataDriven)||((a=this.getPaintProperty("line-color"))==null?void 0:a.isDataDriven)||((u=this.getPaintProperty("line-gap-width"))==null?void 0:u.isDataDriven)||((c=this.getPaintProperty("line-offset"))==null?void 0:c.isDataDriven)||((h=this.getPaintProperty("line-opacity"))==null?void 0:h.isDataDriven)||((d=this.getPaintProperty("line-pattern"))==null?void 0:d.isDataDriven)||((y=this.getPaintProperty("line-dasharray"))==null?void 0:y.isDataDriven)||((v=this.getLayoutProperty("line-cap"))==null?void 0:v.isDataDriven)||((w=this.getPaintProperty("line-width"))==null?void 0:w.isDataDriven),this.canUseThinTessellation=!1,!this.hasDataDrivenLine){const b=this.getPaintProperty("line-width");if(!b||typeof b=="number"&&.5*b<Zbe){const _=this.getPaintProperty("line-offset");(!_||typeof _=="number"&&_===0)&&(this.canUseThinTessellation=!0)}}}getDashKey(t,r){let i;switch(r){case N1.BUTT:i="Butt";break;case N1.ROUND:i="Round";break;case N1.SQUARE:i="Square";break;default:i="Butt"}return`dasharray-[${t.toString()}]-${i}`}getFeatureInflatedBounds(t,r,i,n){const s=Q4(t);if(!s)return null;const o=this.getPaintValue("line-translate",r,t),a=n*Math.max(o[0],o[1]);s[0]-=a,s[2]-=a,s[1]+=a,s[3]+=a;const u=n*Math.abs(this.getPaintValue("line-offset",r,t)||0),c=n*(this.getPaintValue("line-width",r,t)/2);return s[0]-=u+c,s[1]-=u+c,s[2]+=u+c,s[3]+=u+c,s}isIntersectingFeature(t,r,i,n,s,o,a){let u=n.getGeometry();if(!u)return!1;const c=Om/a.normalizationRatio;t=t/a.normalizationRatio+a.normalizationOffsetX,r=r/a.normalizationRatio+a.normalizationOffsetY;const h=K4(this.getPaintValue("line-translate",s,n),this.getPaintValue("line-translate-anchor",s,n),o,Om);t-=c*h.x,r-=c*h.y;const d=c*this.getPaintValue("line-offset",s,n)||0;d!==0&&(u=owe(u,-d));const y=this.getPaintValue("line-width",s,n);return tW(t,r,u,c*(i+y/2))}},h9=class extends nw{constructor(t,r,i,n){var s,o,a,u,c,h,d,y,v,w,b,_;super(t,r,i,n),this.iconMaterial=new L1(this.computeAttributesKey(qu.ICON,L1.ATTRIBUTES,L1.ATTRIBUTES_INFO)),this.textMaterial=new k1(this.computeAttributesKey(qu.TEXT,k1.ATTRIBUTES,k1.ATTRIBUTES_INFO)),this.hasDataDrivenIcon=((s=this.getPaintProperty("icon-color"))==null?void 0:s.isDataDriven)||((o=this.getPaintProperty("icon-halo-blur"))==null?void 0:o.isDataDriven)||((a=this.getPaintProperty("icon-halo-color"))==null?void 0:a.isDataDriven)||((u=this.getPaintProperty("icon-halo-width"))==null?void 0:u.isDataDriven)||((c=this.getPaintProperty("icon-opacity"))==null?void 0:c.isDataDriven)||((h=this.getLayoutProperty("icon-size"))==null?void 0:h.isDataDriven),this.hasDataDrivenText=((d=this.getPaintProperty("text-color"))==null?void 0:d.isDataDriven)||((y=this.getPaintProperty("text-halo-blur"))==null?void 0:y.isDataDriven)||((v=this.getPaintProperty("text-halo-color"))==null?void 0:v.isDataDriven)||((w=this.getPaintProperty("text-halo-width"))==null?void 0:w.isDataDriven)||((b=this.getPaintProperty("text-opacity"))==null?void 0:b.isDataDriven)||((_=this.getLayoutProperty("text-size"))==null?void 0:_.isDataDriven)}},d9=class extends nw{constructor(t,r,i,n){super(t,r,i,n),this.circleMaterial=new rm(this.computeAttributesKey(qu.CIRCLE,rm.ATTRIBUTES,rm.ATTRIBUTES_INFO))}getFeatureInflatedBounds(t,r,i,n){const s=Q4(t);if(!s)return null;const o=this.getPaintValue("circle-translate",r,t),a=Math.max(o[0],o[1]);s[0]-=a,s[2]-=a,s[1]+=a,s[3]+=a;const u=n*(Om*(this.getPaintValue("circle-radius",r,t)+this.getPaintValue("circle-stroke-width",r,t))/2);return s[0]-=u,s[1]-=u,s[2]+=u,s[3]+=u,s}isIntersectingFeature(t,r,i,n,s,o,a){const u=n.getGeometry();if(!u)return!1;const c=Om/a.normalizationRatio;t=t/a.normalizationRatio+a.normalizationOffsetX,r=r/a.normalizationRatio+a.normalizationOffsetY,i*=c;const h=K4(this.getPaintValue("circle-translate",s,n),this.getPaintValue("circle-translate-anchor",s,n),o,c),d=c*(this.getPaintValue("circle-radius",s,n)+this.getPaintValue("circle-stroke-width",s,n));let y,v;for(const w of u)if(w){for(const b of w)if(y=b.x+h.x,v=b.y+h.y,Math.sqrt((t-y)*(t-y)+(r-v)*(r-v))-i<=d)return!0}return!1}},ZFe=class{constructor(t,r,i){let n;this.allowOverlap=t.getLayoutValue("icon-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("icon-ignore-placement",r),this.keepUpright=t.getLayoutValue("icon-keep-upright",r),this.optional=t.getLayoutValue("icon-optional",r),this.rotationAlignment=t.getLayoutValue("icon-rotation-alignment",r),this.rotationAlignment===Sl.AUTO&&(this.rotationAlignment=i?Sl.MAP:Sl.VIEWPORT),n=t.getLayoutProperty("icon-anchor"),n!=null&&n.isDataDriven?this._anchorProp=n:this.anchor=t.getLayoutValue("icon-anchor",r),n=t.getLayoutProperty("icon-offset"),n!=null&&n.isDataDriven?this._offsetProp=n:this.offset=t.getLayoutValue("icon-offset",r),n=t.getLayoutProperty("icon-padding"),n!=null&&n.isDataDriven?this._paddingProp=n:this.padding=t.getLayoutValue("icon-padding",r),n=t.getLayoutProperty("icon-rotate"),n!=null&&n.isDataDriven?this._rotateProp=n:this.rotate=t.getLayoutValue("icon-rotate",r),n=t.getLayoutProperty("icon-size"),n!=null&&n.isDataDriven?this._sizeProp=n:this.size=t.getLayoutValue("icon-size",r)}update(t,r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,r)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,r)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,r)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,r)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,r))}},KFe=class{constructor(t,r,i){let n;this.allowOverlap=t.getLayoutValue("text-allow-overlap",r),this.ignorePlacement=t.getLayoutValue("text-ignore-placement",r),this.keepUpright=t.getLayoutValue("text-keep-upright",r),this.optional=t.getLayoutValue("text-optional",r),this.rotationAlignment=t.getLayoutValue("text-rotation-alignment",r),this.rotationAlignment===Sl.AUTO&&(this.rotationAlignment=i?Sl.MAP:Sl.VIEWPORT),n=t.getLayoutProperty("text-anchor"),n!=null&&n.isDataDriven?this._anchorProp=n:this.anchor=t.getLayoutValue("text-anchor",r),n=t.getLayoutProperty("text-justify"),n!=null&&n.isDataDriven?this._justifyProp=n:this.justify=t.getLayoutValue("text-justify",r),n=t.getLayoutProperty("text-letter-spacing"),n!=null&&n.isDataDriven?this._letterSpacingProp=n:this.letterSpacing=t.getLayoutValue("text-letter-spacing",r),n=t.getLayoutProperty("text-line-height"),n!=null&&n.isDataDriven?this._lineHeightProp=n:this.lineHeight=t.getLayoutValue("text-line-height",r),n=t.getLayoutProperty("text-max-angle"),n!=null&&n.isDataDriven?this._maxAngleProp=n:this.maxAngle=t.getLayoutValue("text-max-angle",r),n=t.getLayoutProperty("text-max-width"),n!=null&&n.isDataDriven?this._maxWidthProp=n:this.maxWidth=t.getLayoutValue("text-max-width",r),n=t.getLayoutProperty("text-offset"),n!=null&&n.isDataDriven?this._offsetProp=n:this.offset=t.getLayoutValue("text-offset",r),n=t.getLayoutProperty("text-padding"),n!=null&&n.isDataDriven?this._paddingProp=n:this.padding=t.getLayoutValue("text-padding",r),n=t.getLayoutProperty("text-rotate"),n!=null&&n.isDataDriven?this._rotateProp=n:this.rotate=t.getLayoutValue("text-rotate",r),n=t.getLayoutProperty("text-size"),n!=null&&n.isDataDriven?this._sizeProp=n:this.size=t.getLayoutValue("text-size",r),n=t.getLayoutProperty("text-writing-mode"),n!=null&&n.isDataDriven?this._writingModeProp=n:this.writingMode=t.getLayoutValue("text-writing-mode",r)}update(t,r){this._anchorProp&&(this.anchor=this._anchorProp.getValue(t,r)),this._justifyProp&&(this.justify=this._justifyProp.getValue(t,r)),this._letterSpacingProp&&(this.letterSpacing=this._letterSpacingProp.getValue(t,r)),this._lineHeightProp&&(this.lineHeight=this._lineHeightProp.getValue(t,r)),this._maxAngleProp&&(this.maxAngle=this._maxAngleProp.getValue(t,r)),this._maxWidthProp&&(this.maxWidth=this._maxWidthProp.getValue(t,r)),this._offsetProp&&(this.offset=this._offsetProp.getValue(t,r)),this._paddingProp&&(this.padding=this._paddingProp.getValue(t,r)),this._rotateProp&&(this.rotate=this._rotateProp.getValue(t,r)),this._sizeProp&&(this.size=this._sizeProp.getValue(t,r)),this._writingModeProp&&(this.writingMode=this._writingModeProp.getValue(t,r))}};function Q4(e){const t=e==null?void 0:e.getGeometry();if(t==null)return null;let r=1/0,i=1/0,n=-1/0,s=-1/0;for(const o of t)if(o)for(const a of o)r=Math.min(r,a.x),i=Math.min(i,a.y),n=Math.max(n,a.x),s=Math.max(s,a.y);return cB(r,i,n,s)}let Kbe=class Ug{constructor(t){if(this._style=t,this.backgroundBucketIds=[],this._uidToLayer=new Map,this._layerByName={},this._runningId=0,t.layers||(t.layers=[]),this.version=parseFloat(t.version),this.layers=t.layers.map((r,i,n)=>this._create(r,i,n)).filter(r=>!!r),this.layers)for(let r=0;r<this.layers.length;r++){const i=this.layers[r];this._layerByName[i.id]=i,this._uidToLayer.set(i.uid,i),i.type===Br.BACKGROUND&&this.backgroundBucketIds.push(i.id)}this._identifyRefLayers()}isPainterDataDriven(t){const r=this._layerByName[t];return!!r&&r.isPainterDataDriven()}getStyleLayerId(t){return t>=this.layers.length?null:this.layers[t].id}getStyleLayerByUID(t){return this._uidToLayer.get(t)??null}getStyleLayerIndex(t){const r=this._layerByName[t];return r?this.layers.indexOf(r):-1}setStyleLayer(t,r){if(!(t!=null&&t.id))return;const i=this._style;r!=null&&r>=this.layers.length&&(r=this.layers.length-1);let n,s=!0;const o=this._layerByName[t.id];if(o){const a=this.layers.indexOf(o);r||(r=a),r===a?(s=!1,n=Ug._recreateLayer(t,o),this.layers[r]=n,i.layers[r]=t):(this.layers.splice(a,1),i.layers.splice(a,1),n=this._create(t,r,this.layers),this.layers.splice(r,0,n),i.layers.splice(r,0,t))}else n=this._create(t,r,this.layers),!r||r>=this.layers.length?(this.layers.push(n),i.layers.push(t)):(this.layers.splice(r,0,n),i.layers.splice(r,0,t));this._layerByName[t.id]=n,this._uidToLayer.set(n.uid,n),s&&this._recomputeZValues(),this._identifyRefLayers()}getStyleLayer(t){const r=this._layerByName[t];return r?{type:r.typeName,id:r.id,source:r.source,"source-layer":r.sourceLayer,minzoom:r.minzoom,maxzoom:r.maxzoom,filter:r.filter,layout:r.layout,paint:r.paint}:null}deleteStyleLayer(t){const r=this._layerByName[t];if(r){delete this._layerByName[t],this._uidToLayer.delete(r.uid);const i=this.layers.indexOf(r);this.layers.splice(i,1),this._style.layers.splice(i,1),this._recomputeZValues(),this._identifyRefLayers()}}getLayerById(t){return this._layerByName[t]}getLayoutProperties(t){const r=this._layerByName[t];return r?r.layout:null}getPaintProperties(t){const r=this._layerByName[t];return r?r.paint:null}setPaintProperties(t,r){const i=this._layerByName[t];if(!i)return;const n={type:i.typeName,id:i.id,source:i.source,"source-layer":i.sourceLayer,minzoom:i.minzoom,maxzoom:i.maxzoom,filter:i.filter,layout:i.layout,paint:r},s=Ug._recreateLayer(n,i),o=this.layers.indexOf(i);this.layers[o]=s,this._style.layers[o].paint=r,this._layerByName[i.id]=s,this._uidToLayer.set(i.uid,s)}setLayoutProperties(t,r){const i=this._layerByName[t];if(!i)return;const n={type:i.typeName,id:i.id,source:i.source,"source-layer":i.sourceLayer,minzoom:i.minzoom,maxzoom:i.maxzoom,filter:i.filter,layout:r,paint:i.paint},s=Ug._recreateLayer(n,i),o=this.layers.indexOf(i);this.layers[o]=s,this._style.layers[o].layout=r,this._layerByName[i.id]=s,this._uidToLayer.set(i.uid,s)}setStyleLayerVisibility(t,r){const i=this._layerByName[t];if(!i)return;const n=i.layout||{};n.visibility=r;const s={type:i.typeName,id:i.id,source:i.source,"source-layer":i.sourceLayer,minzoom:i.minzoom,maxzoom:i.maxzoom,filter:i.filter,layout:n,paint:i.paint},o=Ug._recreateLayer(s,i),a=this.layers.indexOf(i);this.layers[a]=o,this._style.layers[a].layout=n,this._layerByName[i.id]=o,this._uidToLayer.set(i.uid,o)}getStyleLayerVisibility(t){const r=this._layerByName[t];if(!r)return"none";const i=r.layout;return(i==null?void 0:i.visibility)??"visible"}_recomputeZValues(){const t=this.layers,r=1/(t.length+1);for(let i=0;i<t.length;i++)t[i].z=1-(1+i)*r}_identifyRefLayers(){const t=[],r=[];let i=0;for(const n of this.layers){const s=n.layout;if(n.type===Br.FILL){const o=n;let a=n.source+"|"+n.sourceLayer;a+="|"+((s==null?void 0:s.visibility)??""),a+="|"+n.minzoom,a+="|"+n.maxzoom,a+="|"+JSON.stringify(n.filter),(o.hasDataDrivenFill||o.hasDataDrivenOutline)&&(a+="|"+i),t.push({key:a,layer:n})}else if(n.type===Br.LINE){const o=n,a=n.paint,u=a!=null&&(a["line-pattern"]!=null||a["line-dasharray"]!=null);let c=n.source+"|"+n.sourceLayer;c+="|"+((s==null?void 0:s.visibility)??""),c+="|"+n.minzoom,c+="|"+n.maxzoom,c+="|"+JSON.stringify(n.filter),c+="|"+(s!==void 0?s["line-cap"]:""),c+="|"+(s!==void 0?s["line-join"]:""),(o.hasDataDrivenLine||u)&&(c+="|"+i),r.push({key:c,layer:n})}++i}this._assignRefLayers(t),this._assignRefLayers(r)}_assignRefLayers(t){let r,i;t.sort((s,o)=>s.key<o.key?-1:s.key>o.key?1:0);const n=t.length;for(let s=0;s<n;s++){const o=t[s];if(o.key===r)o.layer.refLayerId=i;else if(r=o.key,i=o.layer.id,o.layer.type===Br.FILL){if(!o.layer.getPaintProperty("fill-outline-color"))for(let a=s+1;a<n;a++){const u=t[a];if(u.key!==r)break;if(u.layer.getPaintProperty("fill-outline-color")){t[s]=u,t[a]=o,i=u.layer.id;break}}}else if(o.layer.type===Br.LINE){let a=o.layer;for(let u=s+1;u<n;u++){const c=t[u];if(c.key!==r)break;const h=c.layer;(a.canUseThinTessellation&&!h.canUseThinTessellation||!a.canUseThinTessellation&&(h.getPaintProperty("line-pattern")||h.getPaintProperty("line-dasharray")))&&(a=h,t[s]=c,t[u]=o,i=c.layer.id)}}}}_create(t,r,i){const n=1-(1+r)*(1/(i.length+1)),s=this._runningId++;switch(t.type){case"background":return new u9(Br.BACKGROUND,t,n,s);case"fill":return new c9(Br.FILL,t,n,s);case"line":return new p9(Br.LINE,t,n,s);case"symbol":return new h9(Br.SYMBOL,t,n,s);case"raster":return console.warn(`Unsupported vector tile raster layer ${t.id}`),null;case"circle":return new d9(Br.CIRCLE,t,n,s)}return null}static _recreateLayer(t,r){switch(t.type){case"background":return new u9(Br.BACKGROUND,t,r.z,r.uid);case"fill":return new c9(Br.FILL,t,r.z,r.uid);case"line":return new p9(Br.LINE,t,r.z,r.uid);case"symbol":return new h9(Br.SYMBOL,t,r.z,r.uid);case"raster":return console.warn(`Unsupported vector tile raster layer ${t.id}`),null;case"circle":return new d9(Br.CIRCLE,t,r.z,r.uid)}return null}};function f9(e,t={}){return e.getContext("webgl2",t)||null}let uM;function u5(){return uM||(uM=e_e()),uM}let Xbe=class{constructor(){this.available=!1,this.majorPerformanceCaveat=!1,this.maxTextureSize=0,this.supportsVertexShaderSamplers=!1,this.supportsHighPrecisionFragment=!1,this.supportsColorBufferFloat=!1,this.supportsColorBufferFloatBlend=!1,this.supportsColorBufferHalfFloat=!1}};function Qbe(e){if(typeof WebGL2RenderingContext>"u")return null;const t=document.createElement("canvas");if(!t)return null;let r=f9(t,{failIfMajorPerformanceCaveat:!0});if(r==null&&(r=f9(t),r!=null&&(e.majorPerformanceCaveat=!0)),r==null)return r;e.available=!0,e.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),e.supportsVertexShaderSamplers=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0;const i=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);return i&&(e.supportsHighPrecisionFragment=i.precision>0),r}function e_e(){const e=new Xbe,t=Qbe(e);return t==null||(e.supportsColorBufferFloat=t.getExtension("EXT_color_buffer_float")!==null,e.supportsColorBufferFloatBlend=t.getExtension("EXT_float_blend")!==null,e.supportsColorBufferHalfFloat=e.supportsColorBufferFloat||t.getExtension("EXT_color_buffer_half_float")!==null),e}let Ht=class extends zp(Zp(YH(tw(qp(Jp(rw($T(kl(Yu))))))))){constructor(...t){super(...t),this._spriteSourceMap=new Map,this.currentStyleInfo=null,this.isReference=null,this.operationalLayerType="VectorTileLayer",this.style=null,this.tilemapCache=null,this.type="vector-tile",this.url=null,this.path=null}normalizeCtorArgs(t,r){return typeof t=="string"?{url:t,...r}:t}destroy(){var t;if(this.sourceNameToSource)for(const r of Object.values(this.sourceNameToSource))r==null||r.destroy();(t=this.primarySource)==null||t.destroy(),this._spriteSourceMap.clear()}async prefetchResources(t){await this.loadSpriteSource(globalThis.devicePixelRatio||1,t)}load(t){const r=this.loadFromPortal({supportedTypes:["Vector Tile Service"],supportsData:!1},t).catch(Ti).then(async()=>{var n;if(!((n=this.portalItem)!=null&&n.id))return;const i=`${this.portalItem.itemCdnUrl}/resources/styles/root.json`;(await be(i,{...t,query:{f:"json",...this.customParameters,token:this.apiKey}})).data&&this.read({url:i},Jve(this.portalItem,"portal-item"))}).catch(Ti).then(()=>this._loadStyle(t));return this.addResolvingPromise(r),Promise.resolve(this)}get attributionDataUrl(){const t=this.currentStyleInfo,r=(t==null?void 0:t.serviceUrl)&&Pt(t.serviceUrl);if(!r)return null;const i=this._getDefaultAttribution(r.path);return i?No(i,{...this.customParameters,token:this.apiKey}):null}get capabilities(){const t=this.primarySource;return t?t.capabilities:{operations:{supportsExportTiles:!1,supportsTileMap:!1},exportTiles:null}}get fullExtent(){var t;return((t=this.primarySource)==null?void 0:t.fullExtent)||null}get initialExtent(){var t;return((t=this.primarySource)==null?void 0:t.initialExtent)||null}get parsedUrl(){return this.serviceUrl?Pt(this.serviceUrl):null}get serviceUrl(){var t;return((t=this.currentStyleInfo)==null?void 0:t.serviceUrl)||null}get spatialReference(){var t;return((t=this.tileInfo)==null?void 0:t.spatialReference)??null}get styleUrl(){var t;return((t=this.currentStyleInfo)==null?void 0:t.styleUrl)||null}writeStyleUrl(t,r){t&&io(t)&&(t=`https:${t}`);const i=V$(t);r.styleUrl=_4(t,i)}get tileInfo(){var i;const t=[];for(const n in this.sourceNameToSource)t.push(this.sourceNameToSource[n]);let r=((i=this.primarySource)==null?void 0:i.tileInfo)||new Uo;if(t.length>1)for(let n=0;n<t.length;n++)Zve(r,t[n].tileInfo)&&(r=Yve(r,t[n].tileInfo));return r}readTilemapCache(t,r){var n;return((n=r.capabilities)==null?void 0:n.includes("Tilemap"))?new Ro({layer:this}):null}readVersion(t,r){return r.version?parseFloat(r.version):parseFloat(r.currentVersion)}async loadSpriteSource(t=1,r){var i,n;if(!this._spriteSourceMap.has(t)){const s=u5().maxTextureSize,o=(i=this.currentStyleInfo)!=null&&i.spriteUrl?No(this.currentStyleInfo.spriteUrl,{...this.customParameters,token:this.apiKey}):null,a=new w6({type:"url",spriteUrl:o,pixelRatio:t,spriteFormat:(n=this.currentStyleInfo)==null?void 0:n.spriteFormat},s);await a.load(r),this._spriteSourceMap.set(t,a)}return this._spriteSourceMap.get(t)}async setSpriteSource(t,r){if(!t)return null;const i=u5().maxTextureSize,n=t.spriteUrl,s=n?No(n,{...this.customParameters,token:this.apiKey}):null;if(!s&&t.type==="url")return null;const o=new w6(t,i);try{await o.load(r);const a=t.pixelRatio||1;return this._spriteSourceMap.clear(),this._spriteSourceMap.set(a,o),s&&this.currentStyleInfo&&(this.currentStyleInfo.spriteUrl=s),this.emit("spriteSource-change",{spriteSource:o}),o}catch(a){Ti(a)}return null}async loadStyle(t,r){var n;const i=t||this.style||this.url;return this._loadingTask&&typeof i=="string"&&this.url===i||((n=this._loadingTask)==null||n.abort(),this._loadingTask=mT(s=>(this._spriteSourceMap.clear(),this._getSourceAndStyle(i,{signal:s})),r)),this._loadingTask.promise}getStyleLayerId(t){return this.styleRepository.getStyleLayerId(t)}getStyleLayerIndex(t){return this.styleRepository.getStyleLayerIndex(t)}getPaintProperties(t){var r;return B((r=this.styleRepository)==null?void 0:r.getPaintProperties(t))}setPaintProperties(t,r){const i=this.styleRepository.isPainterDataDriven(t);this.styleRepository.setPaintProperties(t,r);const n=this.styleRepository.isPainterDataDriven(t);this.emit("paint-change",{layer:t,paint:r,isDataDriven:i||n})}getStyleLayer(t){return B(this.styleRepository.getStyleLayer(t))}setStyleLayer(t,r){this.styleRepository.setStyleLayer(t,r),this.emit("style-layer-change",{layer:t,index:r})}deleteStyleLayer(t){this.styleRepository.deleteStyleLayer(t),this.emit("delete-style-layer",{layer:t})}getLayoutProperties(t){return B(this.styleRepository.getLayoutProperties(t))}setLayoutProperties(t,r){this.styleRepository.setLayoutProperties(t,r),this.emit("layout-change",{layer:t,layout:r})}setStyleLayerVisibility(t,r){this.styleRepository.setStyleLayerVisibility(t,r),this.emit("style-layer-visibility-change",{layer:t,visibility:r})}getStyleLayerVisibility(t){return this.styleRepository.getStyleLayerVisibility(t)}write(t,r){return r!=null&&r.origin&&!this.styleUrl?(r.messages&&r.messages.push(new z("vectortilelayer:unsupported",`VectorTileLayer (${this.title}, ${this.id}) with style defined by JSON only are not supported`,{layer:this})),null):super.write(t,r)}getTileUrl(t,r,i){return null}async _getSourceAndStyle(t,r){if(!t)throw new Error("invalid style!");const i=await zve(t,{...r,query:{...this.customParameters,token:this.apiKey}});i.spriteFormat==="webp"&&(await Dve("lossy")||(i.spriteFormat="png")),this._set("currentStyleInfo",{...i}),typeof t=="string"?(this.url=t,this.style=null):(this.url=null,this.style=t),this._set("sourceNameToSource",i.sourceNameToSource),this._set("primarySource",i.sourceNameToSource[i.primarySourceName]),this._set("styleRepository",new Kbe(i.style)),this.read(i.layerDefinition,{origin:"service"}),this.emit("load-style")}_getDefaultAttribution(t){const r=t.match(/^https?:\/\/(?:basemaps|basemapsbeta|basemapsdev)(?:-api)?\.arcgis\.com(\/[^\/]+)?\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/vectortileserver/i),i=["OpenStreetMap_v2","OpenStreetMap_Daylight_v2","OpenStreetMap_Export_v2","OpenStreetMap_FTS_v2","OpenStreetMap_GCS_v2","World_Basemap","World_Basemap_v2","World_Basemap_Export_v2","World_Basemap_GCS_v2","World_Basemap_WGS84","World_Contours_v2"];if(!r)return;const n=r[2]&&r[2].toLowerCase();if(!n)return;const s=r[1]||"";for(const o of i)if(o.toLowerCase().includes(n))return _s(`//static.arcgis.com/attribution/Vector${s}/${o}`)}async _loadStyle(t){var r;return((r=this._loadingTask)==null?void 0:r.promise)??this.loadStyle(null,t)}};l([p({readOnly:!0})],Ht.prototype,"attributionDataUrl",null),l([p({type:["show","hide"]})],Ht.prototype,"listMode",void 0),l([p({json:{read:!0,write:!0}})],Ht.prototype,"blendMode",void 0),l([p({readOnly:!0,json:{read:!1}})],Ht.prototype,"capabilities",null),l([p({readOnly:!0})],Ht.prototype,"currentStyleInfo",void 0),l([p({json:{read:!1},readOnly:!0,type:Ne})],Ht.prototype,"fullExtent",null),l([p({json:{read:!1},readOnly:!0,type:Ne})],Ht.prototype,"initialExtent",null),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Ht.prototype,"isReference",void 0),l([p({type:["VectorTileLayer"]})],Ht.prototype,"operationalLayerType",void 0),l([p({readOnly:!0})],Ht.prototype,"parsedUrl",null),l([p()],Ht.prototype,"style",void 0),l([p({readOnly:!0})],Ht.prototype,"serviceUrl",null),l([p({type:xe,readOnly:!0})],Ht.prototype,"spatialReference",null),l([p({readOnly:!0})],Ht.prototype,"styleRepository",void 0),l([p({readOnly:!0})],Ht.prototype,"sourceNameToSource",void 0),l([p({readOnly:!0})],Ht.prototype,"primarySource",void 0),l([p({type:String,readOnly:!0,json:{write:{ignoreOrigin:!0},origins:{"web-document":{write:{ignoreOrigin:!0,isRequired:!0}}}}})],Ht.prototype,"styleUrl",null),l([se(["portal-item","web-document"],"styleUrl")],Ht.prototype,"writeStyleUrl",null),l([p({json:{read:!1,origins:{service:{read:!1}}},readOnly:!0,type:Uo})],Ht.prototype,"tileInfo",null),l([p()],Ht.prototype,"tilemapCache",void 0),l([te("service","tilemapCache",["capabilities","tileInfo"])],Ht.prototype,"readTilemapCache",null),l([p({json:{read:!1},readOnly:!0,value:"vector-tile"})],Ht.prototype,"type",void 0),l([p({json:{origins:{"web-document":{read:{source:"styleUrl"}},"portal-item":{read:{source:"url"}}},write:!1,read:!1}})],Ht.prototype,"url",void 0),l([p({readOnly:!0})],Ht.prototype,"version",void 0),l([te("version",["version","currentVersion"])],Ht.prototype,"readVersion",null),l([p({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Ht.prototype,"path",void 0),Ht=l([k("esri.layers.VectorTileLayer")],Ht);const iJ=Ht,t9e=Object.freeze(Object.defineProperty({__proto__:null,default:iJ},Symbol.toStringTag,{value:"Module"}));async function CT(e,t){return await e.load(),t_e(e,t)}async function t_e(e,t){const r=[],i=(...s)=>{for(const o of s)o!=null&&(Array.isArray(o)?i(...o):$e.isCollection(o)?o.forEach(a=>i(a)):El.isLoadable(o)&&r.push(o))};t(i);let n=null;if(await Gme(r,async s=>{const o=await yT(r_e(s)?s.loadAll():s.load());o.ok!==!1||n||(n=o)}),n)throw n.error;return e}function r_e(e){return"loadAll"in e&&typeof e.loadAll=="function"}let nJ=class c5{constructor(t,r,i=""){this.major=t,this.minor=r,this._context=i}lessThan(t,r){return this.major<t||t===this.major&&this.minor<r}since(t,r){return!this.lessThan(t,r)}validate(t){if(this.major!==t.major){const r=this._context&&this._context+":",i=this._context&&this._context+" ";throw new z(r+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:t})}}clone(){return new c5(this.major,this.minor,this._context)}static parse(t,r=""){const[i,n]=t.split("."),s=/^\s*\d+\s*$/;if(!(i!=null&&i.match)||!s.test(i))throw new z((r&&r+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:t});if(!(n!=null&&n.match)||!s.test(n))throw new z((r&&r+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:t});const o=parseInt(i,10),a=parseInt(n,10);return new c5(o,a,r)}};const sJ=e=>{let t=class extends e{constructor(){super(...arguments),this.capabilities=void 0,this.copyright=null,this.fullExtent=null,this.legendEnabled=!0,this.spatialReference=null,this.version=void 0,this._allLayersAndTablesMap=null}readCapabilities(r,i){const n=i.capabilities&&i.capabilities.split(",").map(T=>T.toLowerCase().trim());if(!n)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};const s=this.type,o=s!=="tile"&&!!i.supportsDynamicLayers,a=n.includes("query"),u=n.includes("map"),c=!!i.exportTilesAllowed,h=n.includes("tilemap"),d=n.includes("data"),y=s!=="tile"&&(!i.tileInfo||o),v=s!=="tile"&&(!i.tileInfo||o),w=s!=="tile",b=i.cimVersion&&nJ.parse(i.cimVersion),_=(b==null?void 0:b.since(1,4))??!1,x=(b==null?void 0:b.since(2,0))??!1;return{operations:{supportsExportMap:u,supportsExportTiles:c,supportsIdentify:a,supportsQuery:d,supportsTileMap:h},exportMap:u?{supportsArcadeExpressionForLabeling:_,supportsSublayersChanges:w,supportsDynamicLayers:o,supportsSublayerVisibility:y,supportsSublayerDefinitionExpression:v,supportsCIMSymbols:x}:null,exportTiles:c?{maxExportTilesCount:+i.maxExportTilesCount}:null}}readVersion(r,i){let n=i.currentVersion;return n||(n=i.hasOwnProperty("capabilities")||i.hasOwnProperty("tables")?10:i.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),n}async fetchRelatedService(r){const i=this.portalItem;if(!i||!K8(i))return null;this._relatedFeatureServicePromise||(this._relatedFeatureServicePromise=i.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},r).then(s=>s.find(o=>o.type==="Feature Service")??null,()=>null));const n=await this._relatedFeatureServicePromise;return Ut(r),n?{itemId:n.id,url:n.url}:null}async fetchSublayerInfo(r,i){var a;const{source:n}=r;if(this!=null&&this.portalItem&&this.type==="tile"&&(n==null?void 0:n.type)==="map-layer"&&K8(this.portalItem)&&r.originIdOf("url")<_e.SERVICE){const u=await this.fetchRelatedService(i);u&&(r.url=jo(u.url,n.mapLayerId.toString()),r.layerItemId=u.itemId)}const{url:s}=r;let o;if(n.type==="data-layer")o=(await be(s,{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey},...i})).data;else if(s&&r.originIdOf("url")>_e.SERVICE)try{const u=await this._fetchAllLayersAndTablesFromService(s),c=((a=zu(s))==null?void 0:a.sublayer)??n.mapLayerId;o=u.get(c)}catch{}else{let u=r.id;(n==null?void 0:n.type)==="map-layer"&&(u=n.mapLayerId);try{o=(await this.fetchAllLayersAndTables(i)).get(u)}catch{}}return o}async fetchAllLayersAndTables(r){var i;return this._fetchAllLayersAndTablesFromService((i=this.parsedUrl)==null?void 0:i.path,r)}async _fetchAllLayersAndTablesFromService(r,i){await this.load(i),this._allLayersAndTablesMap||(this._allLayersAndTablesMap=new Map);const n=zu(r),s=Ov(this._allLayersAndTablesMap,n==null?void 0:n.url.path,()=>be(jo(n==null?void 0:n.url.path,"/layers"),{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(a=>{const u=new Map;for(const c of a.data.layers)u.set(c.id,c);return{result:u}},a=>({error:a}))),o=await s;if(Ut(i),"result"in o)return o.result;throw o.error}};return l([p({readOnly:!0})],t.prototype,"capabilities",void 0),l([te("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],t.prototype,"readCapabilities",null),l([p({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),l([p({type:Ne})],t.prototype,"fullExtent",void 0),l([p(pH)],t.prototype,"id",void 0),l([p({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],t.prototype,"legendEnabled",void 0),l([p(Xv)],t.prototype,"popupEnabled",void 0),l([p({type:xe})],t.prototype,"spatialReference",void 0),l([p({readOnly:!0})],t.prototype,"version",void 0),l([te("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],t.prototype,"readVersion",null),t=l([k("esri.layers.mixins.ArcGISMapService")],t),t};var p5;let Vg=p5=class extends Q{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new p5({minValue:this.minValue,maxValue:this.maxValue})}};l([p({type:Number,json:{write:!0}})],Vg.prototype,"minValue",void 0),l([p({type:Number,json:{write:!0}})],Vg.prototype,"maxValue",void 0),Vg=p5=l([k("esri.renderer.support.AuthoringInfoClassBreakInfo")],Vg);var h5;let np=h5=class extends Q{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new h5({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:B(this.classBreakInfos)})}};l([p({type:String,json:{write:!0}})],np.prototype,"field",void 0),l([p({type:String,json:{write:!0}})],np.prototype,"normalizationField",void 0),l([p({type:String,json:{write:!0}})],np.prototype,"label",void 0),l([p({type:[Vg],json:{write:!0}})],np.prototype,"classBreakInfos",void 0),np=h5=l([k("esri.renderers.support.AuthoringInfoFieldInfo")],np);var d5;const zb=new We({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),qb=new We({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),y9={key:e=>typeof e=="number"?"number":"string",typeMap:{number:Number,string:String},base:null},m9=["high-to-low","above-and-below","centered-on","extremes"],g9=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],v9=["seconds","minutes","hours","days","months","years"];let cs=d5=class extends Q{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return typeof e=="string"||typeof e=="number"?e:null}castStartTime(e){return typeof e=="string"||typeof e=="number"?e:null}get style(){return this.type==="color"?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return this.type==="color"||this.type==="size"?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new d5({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};l([p({types:y9,json:{write:!0}})],cs.prototype,"endTime",void 0),l([Tt("endTime")],cs.prototype,"castEndTime",null),l([p({type:String,json:{write:!0}})],cs.prototype,"field",void 0),l([p({type:Number,json:{write:!0}})],cs.prototype,"maxSliderValue",void 0),l([p({type:Number,json:{write:!0}})],cs.prototype,"minSliderValue",void 0),l([p({types:y9,json:{write:!0}})],cs.prototype,"startTime",void 0),l([Tt("startTime")],cs.prototype,"castStartTime",null),l([p({type:zb.apiValues,value:null,json:{type:zb.jsonValues,read:zb.read,write:zb.write}})],cs.prototype,"style",null),l([p({type:g9,value:null,json:{type:g9,origins:{"web-scene":{type:m9,write:{writer:(e,t)=>{m9.includes(e)&&(t.theme=e)}}}},write:!0}})],cs.prototype,"theme",null),l([p({type:qb.apiValues,json:{type:qb.jsonValues,read:qb.read,write:qb.write}})],cs.prototype,"type",void 0),l([p({type:v9,json:{type:v9,write:!0}})],cs.prototype,"units",void 0),cs=d5=l([k("esri.renderers.support.AuthoringInfoVisualVariable")],cs);const i_e=cs;let w2=class extends Q{constructor(t){super(t),this.type=null}};l([p({readOnly:!0,json:{read:!1,write:!0}})],w2.prototype,"type",void 0),w2=l([k("esri.rest.support.ColorRamp")],w2);const eP=w2;var f5;let Vh=f5=class extends eP{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new f5({fromColor:B(this.fromColor),toColor:B(this.toColor),algorithm:this.algorithm})}};l([Ce({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Vh.prototype,"algorithm",void 0),l([p({type:ve,json:{type:[Ke],write:!0}})],Vh.prototype,"fromColor",void 0),l([p({type:ve,json:{type:[Ke],write:!0}})],Vh.prototype,"toColor",void 0),l([p({type:["algorithmic"]})],Vh.prototype,"type",void 0),Vh=f5=l([k("esri.rest.support.AlgorithmicColorRamp")],Vh);const tP=Vh;var y5;let Gg=y5=class extends eP{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new y5({colorRamps:B(this.colorRamps)})}};l([p({type:[tP],json:{write:!0}})],Gg.prototype,"colorRamps",void 0),l([p({type:["multipart"]})],Gg.prototype,"type",void 0),Gg=y5=l([k("esri.rest.support.MultipartColorRamp")],Gg);const OT=Gg,rP={key:"type",base:eP,typeMap:{algorithmic:tP,multipart:OT}};function iP(e){return e!=null&&e.type?e.type==="algorithmic"?tP.fromJSON(e):e.type==="multipart"?OT.fromJSON(e):null:null}var m5;const fh=new We({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),Hb=new We({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),w9=new We({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),b9=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"],n_e=["high-to-low","above-and-below","above","below","90-10"],s_e=["flow-line","wave-front"],o_e=["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"];let Rr=m5=class extends Q{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&t!=="relationship"?t==="class-breaks-size"||t==="class-breaks-color"?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?iP(e):void 0}get fields(){return this.type&&this.type!=="predominance"?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&this.type!=="relationship"?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&this.type!=="relationship"?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return this.type==="flow"?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&this.type!=="relationship"?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&this.type!=="relationship"?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&e!=="relationship"&&e!=="class-breaks-size"&&e!=="class-breaks-color"||this.classificationMethod&&this.classificationMethod!=="standard-deviation"?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;e==="classed-size"?t="class-breaks-size":e==="classed-color"&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return this.type==="univariate-color-size"&&this.univariateTheme==="above-and-below"?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return this.type==="univariate-color-size"?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){var e;return new m5({classificationMethod:this.classificationMethod,colorRamp:B(this.colorRamp),fadeRatio:B(this.fadeRatio),fields:(e=this.fields)==null?void 0:e.slice(0),field1:B(this.field1),field2:B(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map(t=>t.clone()),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};l([p({type:fh.apiValues,value:null,json:{type:fh.jsonValues,read:fh.read,write:fh.write,origins:{"web-document":{default:"manual",type:fh.jsonValues,read:fh.read,write:fh.write}}}})],Rr.prototype,"classificationMethod",null),l([p({types:rP,json:{write:!0}})],Rr.prototype,"colorRamp",void 0),l([te("colorRamp")],Rr.prototype,"readColorRamp",null),l([p({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rr.prototype,"fadeRatio",void 0),l([p({type:[String],value:null,json:{write:!0}})],Rr.prototype,"fields",null),l([p({type:np,value:null,json:{write:!0}})],Rr.prototype,"field1",null),l([p({type:np,value:null,json:{write:!0}})],Rr.prototype,"field2",null),l([p({type:s_e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Rr.prototype,"flowTheme",null),l([p({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Rr.prototype,"focus",null),l([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],Rr.prototype,"isAutoGenerated",void 0),l([p({type:Number,value:null,json:{type:Ke,write:!0}})],Rr.prototype,"numClasses",null),l([p({type:b9,json:{type:b9,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Rr.prototype,"lengthUnit",void 0),l([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rr.prototype,"maxSliderValue",void 0),l([p({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rr.prototype,"minSliderValue",void 0),l([p({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Rr.prototype,"statistics",null),l([p({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Rr.prototype,"standardDeviationInterval",null),l([p({type:Hb.apiValues,value:null,json:{type:Hb.jsonValues,read:Hb.read,write:Hb.write,origins:{"web-scene":{type:w9.jsonValues,write:{writer:w9.write,overridePolicy:e=>({enabled:e!=="flow"})}}}}})],Rr.prototype,"type",null),l([p({type:[i_e],json:{write:!0}})],Rr.prototype,"visualVariables",void 0),l([p({type:o_e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Rr.prototype,"univariateSymbolStyle",null),l([p({type:n_e,value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Rr.prototype,"univariateTheme",null),Rr=m5=l([k("esri.renderers.support.AuthoringInfo")],Rr);const sw=Rr,cM=new We({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let Bg=class extends Q{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const r=new Set;return await this.collectRequiredFields(r,t),Array.from(r).sort()}getSymbol(t,r){}async getSymbolAsync(t,r){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};l([p({type:sw,json:{write:!0}})],Bg.prototype,"authoringInfo",void 0),l([p({type:cM.apiValues,readOnly:!0,json:{type:cM.jsonValues,read:!1,write:{writer:cM.write,ignoreOrigin:!0}}})],Bg.prototype,"type",void 0),Bg=l([k("esri.renderers.Renderer")],Bg);const Ku=Bg;function a_e(e){var t,r;return((r=(t=e.match(l_e))==null?void 0:t[1])==null?void 0:r.replace(/\\'/g,"'"))??null}const l_e=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var g5;let Zd=g5=class extends Q{constructor(){super(...arguments),this.title=null}clone(){return new g5({title:this.title})}};l([p({type:String,json:{write:!0}})],Zd.prototype,"title",void 0),Zd=g5=l([k("esri.renderers.support.LegendOptions")],Zd);var v5;let b2=v5=class extends Zd{constructor(){super(...arguments),this.showLegend=null}clone(){return new v5({title:this.title,showLegend:this.showLegend})}};l([p({type:Boolean,json:{write:!0}})],b2.prototype,"showLegend",void 0),b2=v5=l([k("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],b2);const oJ=b2,pM=new We({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let oa=class extends Q{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return t==null?t:typeof t=="function"?(oe.getLogger(this).error(".field: field must be a string value"),null):Pv(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};l([p()],oa.prototype,"index",void 0),l([p({type:pM.apiValues,readOnly:!0,json:{read:pM.read,write:pM.write}})],oa.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],oa.prototype,"field",void 0),l([Tt("field")],oa.prototype,"castField",null),l([p({type:String,json:{write:!0}})],oa.prototype,"valueExpression",void 0),l([p({type:String,json:{write:!0}})],oa.prototype,"valueExpressionTitle",void 0),l([p({readOnly:!0})],oa.prototype,"arcadeRequired",null),l([p({type:oJ,json:{write:!0}})],oa.prototype,"legendOptions",void 0),oa=l([k("esri.renderers.visualVariables.VisualVariable")],oa);const ow=oa;var w5;let Gh=w5=class extends Q{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,r){t[r]=e??0}clone(){return new w5({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};l([p({type:ve,json:{type:[Ke],write:!0}})],Gh.prototype,"color",void 0),l([p({type:String,json:{write:!0}})],Gh.prototype,"label",void 0),l([p({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],Gh.prototype,"value",void 0),l([se("value")],Gh.prototype,"writeValue",null),Gh=w5=l([k("esri.renderers.visualVariables.support.ColorStop")],Gh);const u_e=Gh;var b5;let Bh=b5=class extends ow{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,r)=>t.value-r.value),this._set("stops",e)}clone(){var e;return new b5({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(e=>e.value||0)}};l([p({readOnly:!0})],Bh.prototype,"cache",null),l([p({type:["color"],json:{type:["colorInfo"]}})],Bh.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],Bh.prototype,"normalizationField",void 0),l([p({type:[u_e],json:{write:!0}})],Bh.prototype,"stops",null),Bh=b5=l([k("esri.renderers.visualVariables.ColorVariable")],Bh);const aJ=Bh;var _5;let Lc=_5=class extends Q{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return pv(t.transparency)}writeOpacity(e,t,r){t[r]=lT(e)}clone(){return new _5({label:this.label,opacity:this.opacity,value:this.value})}};l([p({type:String,json:{write:!0}})],Lc.prototype,"label",void 0),l([p({type:Number,json:{type:Ke,write:{target:"transparency"}}})],Lc.prototype,"opacity",void 0),l([te("opacity",["transparency"])],Lc.prototype,"readOpacity",null),l([se("opacity")],Lc.prototype,"writeOpacity",null),l([p({type:Number,json:{write:!0}})],Lc.prototype,"value",void 0),Lc=_5=l([k("esri.renderers.visualVariables.support.OpacityStop")],Lc);const c_e=Lc;var S5;let zh=S5=class extends ow{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,r)=>t.value-r.value),this._set("stops",e)}clone(){var e;return new S5({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map(t=>t.clone()),legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map(e=>e.value||0)}};l([p({readOnly:!0})],zh.prototype,"cache",null),l([p({type:["opacity"],json:{type:["transparencyInfo"]}})],zh.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],zh.prototype,"normalizationField",void 0),l([p({type:[c_e],json:{write:!0}})],zh.prototype,"stops",null),zh=S5=l([k("esri.renderers.visualVariables.OpacityVariable")],zh);const lJ=zh;var x5;let au=x5=class extends ow{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,r,i){if(i!=null&&i.messages){const n=`visualVariables[${this.index}]`;i.messages.push(new z("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:n+".valueExpressionTitle",context:i}))}}clone(){var e;return new x5({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:(e=this.legendOptions)==null?void 0:e.clone()})}};l([p({readOnly:!0})],au.prototype,"cache",null),l([p({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],au.prototype,"axis",void 0),l([p({type:["rotation"],json:{type:["rotationInfo"]}})],au.prototype,"type",void 0),l([p({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],au.prototype,"rotationType",void 0),l([p({type:String,json:{write:!0}})],au.prototype,"valueExpressionTitle",void 0),l([se("web-scene","valueExpressionTitle")],au.prototype,"writeValueExpressionTitleWebScene",null),au=x5=l([k("esri.renderers.visualVariables.RotationVariable")],au);const PT=au;var T5;let kc=T5=class extends Q{constructor(e){super(e),this.label=null,this.size=null,this.value=null,this.useMinValue=null,this.useMaxValue=null}clone(){return new T5({label:this.label,size:this.size,value:this.value,useMaxValue:this.useMaxValue,useMinValue:this.useMinValue})}};l([p({type:String,json:{write:!0}})],kc.prototype,"label",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],kc.prototype,"size",void 0),l([p({type:Number,json:{write:!0}})],kc.prototype,"value",void 0),l([p({type:Boolean,json:{write:!1}})],kc.prototype,"useMinValue",void 0),l([p({type:Boolean,json:{write:!1}})],kc.prototype,"useMaxValue",void 0),kc=T5=l([k("esri.renderers.visualVariables.support.SizeStop")],kc);const _2=kc;var I5;let S2=I5=class extends oJ{constructor(){super(...arguments),this.customValues=null}clone(){var e;return new I5({title:this.title,showLegend:this.showLegend,customValues:(e=this.customValues)==null?void 0:e.slice(0)})}};l([p({type:[Number],json:{write:!0}})],S2.prototype,"customValues",void 0),S2=I5=l([k("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],S2);const p_e=S2;var Du,xi;function Hy(e){return e&&e.declaredClass==="esri.renderers.visualVariables.SizeVariable"}function mv(e){return e!=null&&!isNaN(e)&&isFinite(e)}function uJ(e){return e.valueExpression?Du.Expression:e.field&&typeof e.field=="string"?Du.Field:Du.Unknown}function h_e(e,t){const r=t||uJ(e),i=e.valueUnit||"unknown";return r===Du.Unknown?xi.Constant:e.stops?xi.Stops:e.minSize!=null&&e.maxSize!=null&&e.minDataValue!=null&&e.maxDataValue!=null?xi.ClampedLinear:i==="unknown"?e.minSize!=null&&e.minDataValue!=null?e.minSize&&e.minDataValue?xi.Proportional:xi.Additive:xi.Identity:xi.RealWorldSize}(function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"})(Du||(Du={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(xi||(xi={}));function s9e(e){}function d_e(e){return()=>e}const Cp=()=>oe.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),_9=new Da,x2=Math.PI,cJ=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function pJ(e,t,r){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find(w=>w.type==="color"):e;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.ColorVariable")return void Cp().warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n=typeof t=="number",s=n?null:t,o=s==null?void 0:s.attributes;let a=n?t:null;const u=i.field,{ipData:c,hasExpression:h}=i.cache;let d=i.cache.compiledFunc;if(!u&&!h){const w=i.stops;return w&&w[0]&&w[0].color}if(typeof a!="number")if(h){if((r==null?void 0:r.arcade)==null)return void Cp().error("Use of arcade expressions requires an arcade context");const w={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,_=b.getViewInfo(w),x=b.createExecContext(s,_,r.timeZone);if(!d){const T=b.createSyntaxTree(i.valueExpression);d=b.createFunction(T),i.cache.compiledFunc=d}a=b.executeFunction(d,x)}else o&&(a=o[u]);const y=i.normalizationField,v=o!=null&&y!=null?parseFloat(o[y]):void 0;if(a!=null&&(!y||n||!isNaN(v)&&v!==0)){isNaN(v)||n||(a/=v);const w=sP(a,c);if(w){const b=w[0],_=w[1],x=b===_?i.stops[b].color:ve.blendColors(i.stops[b].color,i.stops[_].color,w[2],r!=null?r.color:void 0);return new ve(x)}}}function hJ(e,t,r){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find(w=>w.type==="opacity"):e;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.OpacityVariable")return void Cp().warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n=typeof t=="number",s=n?null:t,o=s==null?void 0:s.attributes;let a=n?t:null;const u=i.field,{ipData:c,hasExpression:h}=i.cache;let d=i.cache.compiledFunc;if(!u&&!h){const w=i.stops;return w&&w[0]&&w[0].opacity}if(typeof a!="number")if(h){if((r==null?void 0:r.arcade)==null)return void Cp().error("Use of arcade expressions requires an arcade context");const w={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},b=r.arcade.arcadeUtils,_=b.getViewInfo(w),x=b.createExecContext(s,_,r.timeZone);if(!d){const T=b.createSyntaxTree(i.valueExpression);d=b.createFunction(T),i.cache.compiledFunc=d}a=b.executeFunction(d,x)}else o&&(a=o[u]);const y=i.normalizationField,v=o!=null&&y!=null?parseFloat(o[y]):void 0;if(a!=null&&(!y||n||!isNaN(v)&&v!==0)){isNaN(v)||n||(a/=v);const w=sP(a,c);if(w){const b=w[0],_=w[1];if(b===_)return i.stops[b].opacity;{const x=i.stops[b].opacity;return x+(i.stops[_].opacity-x)*w[2]}}}}function nP(e,t,r){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find(v=>v.type==="rotation"):e;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.RotationVariable")return void Cp().warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=i.axis||"heading",s=n==="heading"&&i.rotationType==="arithmetic"?90:0,o=n==="heading"&&i.rotationType==="arithmetic"?-1:1,a=typeof t=="number"?null:t,u=a==null?void 0:a.attributes,c=i.field,{hasExpression:h}=i.cache;let d=i.cache.compiledFunc,y=0;if(!c&&!h)return y;if(h){if((r==null?void 0:r.arcade)==null)return void Cp().error("Use of arcade expressions requires an arcade context");const v={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},w=r.arcade.arcadeUtils,b=w.getViewInfo(v),_=w.createExecContext(a,b,r.timeZone);if(!d){const x=w.createSyntaxTree(i.valueExpression);d=w.createFunction(x),i.cache.compiledFunc=d}y=w.executeFunction(d,_)}else u&&(y=u[c]||0);return y=typeof y!="number"||isNaN(y)?null:s+o*y,y}function f_e(e,t,r){const i=typeof t=="number",n=i?null:t,s=n==null?void 0:n.attributes;let o=i?t:null;const{isScaleDriven:a}=e.cache;let u=e.cache.compiledFunc;if(a){const h=r!=null?r.scale:void 0,d=r!=null?r.view:void 0;o=h==null||d==="3d"?y_e(e):h}else if(!i)switch(e.inputValueType){case Du.Expression:{if((r==null?void 0:r.arcade)==null)return void Cp().error("Use of arcade expressions requires an arcade context");const h={viewingMode:r.viewingMode,scale:r.scale,spatialReference:r.spatialReference},d=r.arcade.arcadeUtils,y=d.getViewInfo(h),v=d.createExecContext(n,y,r.timeZone);if(!u){const w=d.createSyntaxTree(e.valueExpression);u=d.createFunction(w),e.cache.compiledFunc=u}o=d.executeFunction(u,v);break}case Du.Field:s&&(o=s[e.field]);break;case Du.Unknown:o=null}if(!mv(o))return null;if(i||!e.normalizationField)return o;const c=s?parseFloat(s[e.normalizationField]):null;return mv(c)&&c!==0?o/c:null}function y_e(e){let t=null,r=null;const i=e.stops;return i?(t=i[0].value,r=i[i.length-1].value):(t=e.minDataValue||0,r=e.maxDataValue||0),(t+r)/2}function LT(e,t,r){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find(s=>s.type==="size"):e;if(!i)return;if(i.declaredClass!=="esri.renderers.visualVariables.SizeVariable")return void Cp().warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const n=fJ(f_e(i,t,r),i,t,r,i.cache.ipData);return n==null||isNaN(n)?0:n}function xs(e,t,r){return e==null?null:Hy(e)?LT(e,t,r):mv(e)?e:null}function dJ(e,t,r){return mv(r)&&e>r?r:mv(t)&&e<t?t:e}function m_e(e,t,r,i){return e+((xs(t.minSize,r,i)||t.minDataValue)??0)}function g_e(e,t,r){const i=e.stops;let n=(i==null?void 0:i.length)&&i[0].size;return n==null&&(n=e.minSize),xs(n,t,r)}function v_e(e,t,r,i){const n=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),s=xs(t.minSize,r,i),o=xs(t.maxSize,r,i),a=i!=null?i.shape:void 0;if(e<=t.minDataValue)return s;if(e>=t.maxDataValue)return o;if(s==null||o==null)return null;if(t.scaleBy==="area"&&a){const u=a==="circle",c=u?x2*(s/2)**2:s*s,h=c+n*((u?x2*(o/2)**2:o*o)-c);return u?2*Math.sqrt(h/x2):Math.sqrt(h)}return s+n*(o-s)}function w_e(e,t,r,i){const n=i!=null?i.shape:void 0,s=e/t.minDataValue,o=xs(t.minSize,r,i),a=xs(t.maxSize,r,i);let u=null;return u=n==="circle"?2*Math.sqrt(s*(o/2)**2):n==="square"||n==="diamond"||n==="image"?Math.sqrt(s*o**2):s*o,dJ(u,o,a)}function b_e(e,t,r,i,n){var u,c,h;const[s,o,a]=sP(e,n);if(s===o)return xs((u=t.stops)==null?void 0:u[s].size,r,i);{const d=xs((c=t.stops)==null?void 0:c[s].size,r,i);return d+(xs((h=t.stops)==null?void 0:h[o].size,r,i)-d)*a}}function __e(e,t,r,i){const n=((i==null?void 0:i.resolution)??1)*D4[t.valueUnit],s=xs(t.minSize,r,i),o=xs(t.maxSize,r,i),{valueRepresentation:a}=t;let u=null;return u=a==="area"?2*Math.sqrt(e/x2)/n:a==="radius"||a==="distance"?2*e/n:e/n,dJ(u,s,o)}function fJ(e,t,r,i,n){switch(t.transformationType){case xi.Additive:return m_e(e,t,r,i);case xi.Constant:return g_e(t,r,i);case xi.ClampedLinear:return v_e(e,t,r,i);case xi.Proportional:return w_e(e,t,r,i);case xi.Stops:return b_e(e,t,r,i,n);case xi.RealWorldSize:return __e(e,t,r,i);case xi.Identity:return e;case xi.Unknown:return null}}function S_e(e,t,r){const{isScaleDriven:i}=e.cache;if(!(i&&r==="3d"||t))return null;const n={scale:t,view:r};let s=xs(e.minSize,_9,n),o=xs(e.maxSize,_9,n);if(s!=null||o!=null){if(s>o){const a=o;o=s,s=a}return{minSize:s,maxSize:o}}}function x_e(e,t,r){if(!e.visualVariables)return;const i=[],n=[],s=[],o=[],a=[];for(const u of e.visualVariables)switch(u.type){case"color":n.push(u);break;case"opacity":s.push(u);break;case"rotation":a.push(u);break;case"size":o.push(u)}return n.forEach(u=>{const c=pJ(u,t,r);i.push({variable:u,value:c})}),s.forEach(u=>{const c=hJ(u,t,r);i.push({variable:u,value:c})}),a.forEach(u=>{const c=nP(u,t,r);i.push({variable:u,value:c})}),o.forEach(u=>{const c=LT(u,t,r);i.push({variable:u,value:c})}),i.filter(u=>u.value!=null)}function sP(e,t){if(!t)return;let r=0,i=t.length-1;return t.some((n,s)=>e<n?(i=s,!0):(r=s,!1)),[r,i,(e-t[r])/(t[i]-t[r])]}function yJ(e,t,r){const i=["proportional","proportional","proportional"];for(const n of e){const s=n.useSymbolValue?"symbol-value":LT(n,t,r);switch(n.axis){case"width":i[0]=s;break;case"depth":i[1]=s;break;case"height":i[2]=s;break;case"width-and-depth":i[0]=s,i[1]=s;break;case"all":case void 0:case null:i[0]=s,i[1]=s,i[2]=s;break;default:n.axis}}return i}const o9e=Object.freeze(Object.defineProperty({__proto__:null,getAllSizes:yJ,getColor:pJ,getOpacity:hJ,getRotationAngle:nP,getSize:LT,getSizeForValue:fJ,getSizeFromNumberOrVariable:xs,getSizeRangeAtScale:S_e,getVisualVariableValues:x_e,viewScaleRE:cJ},Symbol.toStringTag,{value:"Module"}));var M5;const Wb=new We({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),$5=new We({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function S9(e){if(e!=null)return typeof e=="string"||typeof e=="number"?wt(e):e.type==="size"?Hy(e)?e:(delete(e={...e}).type,new At(e)):void 0}function x9(e,t,r){if(typeof e!="object")return e;const i=new At;return i.read(e,r),i}let At=M5=class extends ow{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:this.valueExpression!=null&&cJ.test(this.valueExpression)}}set expression(e){oe.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),e==="view.scale"?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){Hy(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),Hy(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return uJ(this)}set maxDataValue(e){e&&this.stops&&(oe.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(oe.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return S9(e)}readMaxSize(e,t,r){return x9(e,t,r)}set minDataValue(e){e&&this.stops&&(oe.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(oe.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return S9(e)}readMinSize(e,t,r){return x9(e,t,r)}get arcadeRequired(){return!!this.valueExpression||this.minSize!=null&&typeof this.minSize=="object"&&this.minSize.arcadeRequired||this.maxSize!=null&&typeof this.maxSize=="object"&&this.maxSize.arcadeRequired}set stops(e){this.minDataValue==null&&this.maxDataValue==null&&this.minSize==null&&this.maxSize==null?e&&Array.isArray(e)&&(e=e.filter(t=>!!t)).sort((t,r)=>t.value-r.value):e&&(oe.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return h_e(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,r,i){if(e==="$view.scale"){if(i!=null&&i.messages){const n=this.index,s=typeof n=="string"?n:`visualVariables[${n}]`;i.messages.push(new z("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:s+".valueExpression",context:i}))}}else t[r]=e}readValueUnit(e){return e?$5.read(e):null}clone(){var e,t;return new M5({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:Hy(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:Hy(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:(e=this.stops)==null?void 0:e.map(r=>r.clone()),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:(t=this.legendOptions)==null?void 0:t.clone()})}flipSizes(){if(this.transformationType===xi.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===xi.Stops){const e=this.stops;if(!e)return this;const t=e.map(i=>i.size).reverse(),r=e.length;for(let i=0;i<r;i++)e[i].size=t[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){var e;return(e=this.stops)==null?void 0:e.map(t=>t.value||0)}};l([p({readOnly:!0})],At.prototype,"cache",null),l([p({type:Wb.apiValues,json:{type:Wb.jsonValues,origins:{"web-map":{read:!1}},read:Wb.read,write:Wb.write}})],At.prototype,"axis",void 0),l([p({type:String,value:null,json:{read:!1}})],At.prototype,"expression",null),l([p()],At.prototype,"index",null),l([p({type:String,readOnly:!0})],At.prototype,"inputValueType",null),l([p({type:p_e,json:{write:!0}})],At.prototype,"legendOptions",void 0),l([p({type:Number,value:null,json:{write:!0}})],At.prototype,"maxDataValue",null),l([p({type:Number,value:null,json:{write:!0}})],At.prototype,"maxSize",null),l([Tt("maxSize")],At.prototype,"castMaxSize",null),l([te("maxSize")],At.prototype,"readMaxSize",null),l([p({type:Number,value:null,json:{write:!0}})],At.prototype,"minDataValue",null),l([p({type:Number,value:null,json:{write:!0}})],At.prototype,"minSize",null),l([Tt("minSize")],At.prototype,"castMinSize",null),l([te("minSize")],At.prototype,"readMinSize",null),l([p({type:String,json:{write:!0}})],At.prototype,"normalizationField",void 0),l([p({readOnly:!0})],At.prototype,"arcadeRequired",null),l([p({type:String})],At.prototype,"scaleBy",void 0),l([p({type:[_2],value:null,json:{write:!0}})],At.prototype,"stops",null),l([p({type:["outline"],json:{write:!0}})],At.prototype,"target",void 0),l([p({type:String,readOnly:!0})],At.prototype,"transformationType",null),l([p({type:["size"],json:{type:["sizeInfo"]}})],At.prototype,"type",void 0),l([p({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],At.prototype,"useSymbolValue",void 0),l([p({type:String,json:{write:!0}})],At.prototype,"valueExpression",void 0),l([te("valueExpression",["valueExpression","expression"])],At.prototype,"readValueExpression",null),l([se("web-scene","valueExpression")],At.prototype,"writeValueExpressionWebScene",null),l([p({type:["radius","diameter","area","width","distance"],json:{write:!0}})],At.prototype,"valueRepresentation",void 0),l([p({type:$5.apiValues,json:{write:$5.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],At.prototype,"valueUnit",void 0),l([te("valueUnit")],At.prototype,"readValueUnit",null),At=M5=l([k("esri.renderers.visualVariables.SizeVariable")],At);const r0=At,T_e={color:aJ,size:r0,opacity:lJ,rotation:PT},I_e=new We({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),M_e=/^\[([^\]]+)\]$/i;let T2=class extends De{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),t=t&&t.filter(r=>!!r),t==null?void 0:t.length){for(const r of t)switch(r.type){case"color":this.colorVariables.push(r);break;case"opacity":this.opacityVariables.push(r);break;case"rotation":this.rotationVariables.push(r);break;case"size":this.sizeVariables.push(r)}this.sizeVariables.length&&this.sizeVariables.some(r=>!!r.target)&&t.sort((r,i)=>{let n=null;return n=r.target===i.target?0:r.target?1:-1,n});for(let r=0;r<t.length;r++)t[r].index=r;this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,r,i){const{rotationExpression:n,rotationType:s}=r,o=n==null?void 0:n.match(M_e),a=o==null?void 0:o[1];if(a&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:s,field:a})),t)return t.map(u=>{const c=I_e.read(u.type),h=T_e[c];h||(oe.getLogger(this).warn(`Unknown variable type: ${c}`),i!=null&&i.messages&&i.messages.push(new eo("visual-variable:unsupported",`visualVariable of type '${c}' is not supported`,{definition:u,context:i})));const d=new h;return d.read(u,i),d})}writeVariables(t,r){const i=[];for(const n of t){const s=n.toJSON(r);s&&i.push(s)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};l([p()],T2.prototype,"visualVariables",null),T2=l([k("esri.renderers.visualVariables.VisualVariableFactory")],T2);const $_e=T2,E_e={base:ow,key:"type",typeMap:{opacity:lJ,color:aJ,rotation:PT,size:r0}},Kp=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new $_e}set visualVariables(r){this._vvFactory.visualVariables=r,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(r,i,n){return this._vvFactory.readVariables(r,i,n)}writeVisualVariables(r,i,n,s){i[n]=this._vvFactory.writeVariables(r,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const r of this.visualVariables)if(r.arcadeRequired)return!0;return!1}hasVisualVariables(r,i){return r?this.getVisualVariablesForType(r,i).length>0:this.getVisualVariablesForType("size",i).length>0||this.getVisualVariablesForType("color",i).length>0||this.getVisualVariablesForType("opacity",i).length>0||this.getVisualVariablesForType("rotation",i).length>0}getVisualVariablesForType(r,i){const n=this.visualVariables;return n?n.filter(s=>s.type===r&&(typeof i=="string"?s.target===i:i!==!1||!s.target)):[]}async collectVVRequiredFields(r,i){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const s of n)s&&(s.field&&Ks(r,i,s.field),s.normalizationField&&Ks(r,i,s.normalizationField),s.valueExpression&&(A_e(s.valueExpression,r,i)||await es(r,i,s.valueExpression)))}};return l([p({types:[E_e],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),l([te("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),l([se("visualVariables")],t.prototype,"writeVisualVariables",null),t=l([k("esri.renderers.mixins.VisualVariablesMixin")],t),t};function A_e(e,t,r){const i=a_e(e);return i!=null&&(Ks(t,r,i),!0)}const Y0={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function R_e(e,t=Y0){var a,u;if(!e)return{symbol:null};const{retainId:r=Y0.retainId,ignoreDrivers:i=Y0.ignoreDrivers,hasLabelingContext:n=Y0.hasLabelingContext,retainCIM:s=Y0.retainCIM}=t;let o=null;if(df(e)||e instanceof Sf)o=e.clone();else if(e.type==="cim"){const c=(u=(a=e.data)==null?void 0:a.symbol)==null?void 0:u.type;if(c!=="CIMPointSymbol")return{error:new z("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${c||"unknown"}' is unsupported in 3D`,{symbol:e})};o=s?e.clone():Ad.fromCIMSymbol(e)}else if(e instanceof oo)o=dT.fromSimpleLineSymbol(e);else if(e instanceof Ll)o=Ad.fromSimpleMarkerSymbol(e);else if(e instanceof qd)o=Ad.fromPictureMarkerSymbol(e);else if(e instanceof _f)o=t.geometryType&&t.geometryType==="mesh"?fT.fromSimpleFillSymbol(e):Yv.fromSimpleFillSymbol(e);else{if(!(e instanceof Qm))return{error:new z("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};o=n?hT.fromTextSymbol(e):Ad.fromTextSymbol(e)}return r&&o&&o.type!=="cim"&&(o.id=e.id),i&&df(o)&&o.symbolLayers.forEach(c=>c.ignoreDrivers=!0),{symbol:o}}function yx(e,t,r,i){const n=mJ(e,{},{context:i,isLabelSymbol:!1});n!=null&&(t[r]=n)}function T9(e,t,r,i){const n=mJ(e,{},{context:i,isLabelSymbol:!0});n!=null&&(t[r]=n)}function I9(e){return e instanceof Xm||e instanceof Sf}function mJ(e,t,r){if(e==null)return null;const{context:i,isLabelSymbol:n}=r,s=i==null?void 0:i.origin,o=i==null?void 0:i.messages;if(s==="web-scene"&&!I9(e)){const a=R_e(e,{retainCIM:!0,hasLabelingContext:n});return a.symbol!=null?a.symbol.write(t,i):(o==null||o.push(new z("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:i,error:a.error})),null)}return(s==="web-map"||s==="portal-item"&&!dH(i==null?void 0:i.layer))&&I9(e)?(o==null||o.push(new z("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:i})),null):e.write(t,i)}function l9e(e,t){return Jme(e,null,t)}const kT={types:Uq,json:{write:{writer:yx},origins:{"web-scene":{types:E8,write:{writer:yx},read:{reader:Vm({types:E8})}}}}},oP=nV({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},kT),gJ={types:{base:Ts,key:"type",typeMap:{"simple-fill":Hd.typeMap["simple-fill"],"picture-fill":Hd.typeMap["picture-fill"],"polygon-3d":Hd.typeMap["polygon-3d"]}},json:{write:{writer:yx},origins:{"web-scene":{type:Yv,write:{writer:yx}}}}},I2={cast:e=>e==null||typeof e=="string"||typeof e=="number"?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e==null?void 0:e.toString()}}}};var E5;let Nc=E5=class extends Q{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new E5({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};l([p({type:String,json:{write:!0}})],Nc.prototype,"description",void 0),l([p({type:String,json:{write:!0}})],Nc.prototype,"label",void 0),l([p({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Nc.prototype,"minValue",void 0),l([p({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Nc.prototype,"maxValue",void 0),l([p(oP)],Nc.prototype,"symbol",void 0),Nc=E5=l([k("esri.renderers.support.ClassBreakInfo")],Nc);const Pm=Nc;var A5;const vJ="log",M2="percent-of-total",$2="field",Jb=new We({esriNormalizeByLog:vJ,esriNormalizeByPercentOfTotal:M2,esriNormalizeByField:$2}),C_e=Lr(Pm);let li=A5=class extends Kp(Ku){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,r){if(!Array.isArray(e))return;let i=t.minValue;return e.map(n=>{const s=new Pm;return s.read(n,r),s.minValue==null&&(s.minValue=i),s.maxValue==null&&(s.maxValue=s.minValue),i=s.maxValue,s})}writeClassBreakInfos(e,t,r,i){const n=e.map(s=>s.write({},i));this._areClassBreaksConsecutive()&&n.forEach(s=>delete s.classMinValue),t[r]=n}castField(e){return e==null?e:typeof e=="function"?(oe.getLogger(this).error(".field: field must be a string value"),null):Pv(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,r=this.normalizationTotal!=null;return t||r?(e=t&&$2||r&&M2||null,t&&r&&oe.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==$2&&e!==M2||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,r){let i=null;i=typeof e=="number"?new Pm({minValue:e,maxValue:t,symbol:Vq(r)}):C_e(B(e)),this.classBreakInfos.push(i),this.classBreakInfos.length===1&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const r=this.classBreakInfos.length;for(let i=0;i<r;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]===e&&n[1]===t){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(e,t){return this.valueExpression&&(t==null?void 0:t.arcade)==null&&oe.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let r=t;this.valueExpression&&(t==null?void 0:t.arcade)==null&&(r={...r,arcade:await uf()});const i=this.getBreakIndex(e,r);return i!==-1?this.classBreakInfos[i]:null}getSymbol(e,t){if(this.valueExpression&&(t==null?void 0:t.arcade)==null)return void oe.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this.getBreakIndex(e,t);return r>-1?this.classBreakInfos[r].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let r=t;if(this.valueExpression&&(t==null?void 0:t.arcade)==null){const n=await uf(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),r={...r,arcade:n}}const i=this.getBreakIndex(e,r);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach(t=>{t.symbol&&e.push(t.symbol)}),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),r=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce((i,n)=>i+n.getMeshHash(),"")}.${r}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){var e,t;return new A5({field:this.field,backgroundFillSymbol:(e=this.backgroundFillSymbol)==null?void 0:e.clone(),defaultLabel:this.defaultLabel,defaultSymbol:(t=this.defaultSymbol)==null?void 0:t.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:B(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:B(this.visualVariables),legendOptions:B(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const r=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(r)}async collectSymbolFields(e,t){const r=[...this.getSymbols().map(i=>i.collectRequiredFields(e,t)),es(e,t,this.valueExpression)];Ks(e,t,this.field),Ks(e,t,this.normalizationField),await Promise.all(r)}_getBreakIndexForExpression(e,t){const{viewingMode:r,scale:i,spatialReference:n,arcade:s,timeZone:o}=t??{},{valueExpression:a}=this;let u=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const c=s.arcadeUtils;if(!u){const d=c.createSyntaxTree(a);u=c.createFunction(d),this._compiledValueExpression.compiledFunction=u}this._compiledValueExpression.valueExpression=a;const h=c.executeFunction(u,c.createExecContext(e,c.getViewInfo({viewingMode:r,scale:i,spatialReference:n}),o));return this._getBreakIndexfromInfos(h)}_getBreakIndexForField(e){const t=this.field,r=e.attributes,i=this.normalizationType;let n=parseFloat(r[t]);if(i){const s=this.normalizationTotal,o=parseFloat(this.normalizationField?r[this.normalizationField]:void 0);if(i===vJ)n=Math.log(n)*Math.LOG10E;else if(i!==M2||s==null||isNaN(s)){if(i===$2&&!isNaN(o)){if(isNaN(n)||isNaN(o))return-1;n/=o}}else n=n/s*100}return this._getBreakIndexfromInfos(n)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(e!=null&&typeof e=="number"&&!isNaN(e))for(let r=0;r<this.classBreakInfos.length;r++){const i=[this.classBreakInfos[r].minValue,this.classBreakInfos[r].maxValue];if(i[0]<=e&&(t?e<=i[1]:e<i[1]))return r}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let r=1;r<t;r++)if(e[r-1].maxValue!==e[r].minValue)return!1;return!0}};l([p(gJ)],li.prototype,"backgroundFillSymbol",void 0),l([p({type:[Pm]})],li.prototype,"classBreakInfos",void 0),l([te("classBreakInfos")],li.prototype,"readClassBreakInfos",null),l([se("classBreakInfos")],li.prototype,"writeClassBreakInfos",null),l([p({type:String,json:{write:!0}})],li.prototype,"defaultLabel",void 0),l([p(kT)],li.prototype,"defaultSymbol",void 0),l([p({type:String,json:{write:!0}})],li.prototype,"field",void 0),l([Tt("field")],li.prototype,"castField",null),l([p({type:Boolean})],li.prototype,"isMaxInclusive",void 0),l([p({type:Zd,json:{write:!0}})],li.prototype,"legendOptions",void 0),l([p({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return this.classBreakInfos.length!==0&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],li.prototype,"minValue",null),l([p({type:String,json:{write:!0}})],li.prototype,"normalizationField",void 0),l([p({type:Number,cast:e=>Ws(e),json:{write:!0}})],li.prototype,"normalizationTotal",void 0),l([p({type:Jb.apiValues,value:null,json:{type:Jb.jsonValues,read:Jb.read,write:Jb.write}})],li.prototype,"normalizationType",null),l([Ce({classBreaks:"class-breaks"})],li.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],li.prototype,"valueExpression",void 0),l([p({type:String,json:{write:!0}})],li.prototype,"valueExpressionTitle",void 0),li=A5=l([k("esri.renderers.ClassBreaksRenderer")],li);const i0=li;let NT=class{};function O_e(e){return e instanceof qm?e===NT.instance:(e==null?void 0:e.toString().toLowerCase())==="unknown"}function c9e(e){return O_e(e)?NT.instance:e}NT.instance=new no("Etc/UTC");function P_e(e){return"timeZone"in e}function L_e(e){return"timeZone"in e}function k_e(e){return"dateFieldsTimeZone"in e}const N_e=new Map;let DT=class E2{static fromJSON(t){return new E2(t.fields,t.timeZoneByFieldName)}static fromLayer(t){return new E2(t.fields??[],$9(t))}static fromLayerJSON(t){return new E2(t.fields??[],$9(t))}constructor(t=[],r){var n;this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=t||[],this._timeZoneByFieldName=r?new Map(r):null;const i=[];for(const s of this.fields){const o=s==null?void 0:s.name,a=M9(o);if(o&&a){const u=Sd(o);this._fieldsMap.set(o,s),this._fieldsMap.set(u,s),this._normalizedFieldsMap.set(a,s),i.push(`${u}:${s.type}:${(n=this._timeZoneByFieldName)==null?void 0:n.get(o)}`),hye(s)?(this.dateFields.push(s),this._dateFieldsSet.add(s)):Jz(s)&&(this._numericFieldsSet.add(s),this.numericFields.push(s)),g8(s)||v8(s)||(s.editable=s.editable==null||!!s.editable,s.nullable=s.nullable==null||!!s.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)g8(t)||v8(t)||t.nullable||Qfe(t)!==void 0||this._requiredFields.push(t)}return this._requiredFields}equals(t){return this.uid===(t==null?void 0:t.uid)}has(t){return this.get(t)!=null}get(t){if(!t)return;let r=this._fieldsMap.get(t);return r||(r=this._fieldsMap.get(Sd(t))??this._normalizedFieldsMap.get(M9(t)),r&&this._fieldsMap.set(t,r),r)}getTimeZone(t){const r=this.get(t&&typeof t!="string"?t.name:t);return r?this._timeZoneByFieldName?this._timeZoneByFieldName.get(r.name):r.type==="date"||r.type==="esriFieldTypeDate"?(oe.getLogger("esri.layers.support.FieldsIndex").error(new z("getTimeZone:no-timezone-information",`no time zone information for field '${r.name}'`)),$p):wJ.has(r.type)?lf:null:null}getLuxonTimeZone(t){const r=this.getTimeZone(t);return r?r===lf?NT.instance:r===$p?Yi.utcInstance:Ov(N_e,r,()=>no.create(r)):null}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isTimeOnlyField(t){return dye(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){var r;return((r=this.get(t))==null?void 0:r.name)??void 0}toJSON(){return{fields:this.fields.map(t=>rv(t)?t.toJSON():t),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}};function Sd(e){return e.trim().toLowerCase()}function M9(e){var t;return((t=Dfe(e))==null?void 0:t.toLowerCase())??""}const wJ=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function $9(e){const t=new Map;if(!e.fields)return t;const r=e.datesInUnknownTimezone===!0,{timeInfo:i,editFieldsInfo:n}=e,s=(i?"startField"in i?i.startField:i.startTimeField:"")??"",o=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a=k_e(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?U_(e.dateFieldsTimeReference):null,u=n?P_e(n)?n.timeZone??a:n.dateFieldsTimeReference?U_(n.dateFieldsTimeReference):a??$p:null,c=i?L_e(i)?i.timeZone??a:i.timeReference?U_(i.timeReference):a:null,h=new Map([[Sd((n==null?void 0:n.creationDateField)??""),u],[Sd((n==null?void 0:n.editDateField)??""),u],[Sd(s),c],[Sd(o),c]]);for(const{name:d,type:y}of e.fields)if(wJ.has(y))t.set(d,lf);else if(y!=="date"&&y!=="esriFieldTypeDate")t.set(d,null);else if(r)t.set(d,lf);else{const v=h.get(Sd(d??""))??a;t.set(d,v)}return t}const D_e={color:[128,128,128,1],outlinecolor:[0,0,0,1],backgroundcolor:[128,128,128,1],borderLineColor:[0,0,0,1]},R5={CIMVectorMarker:{scalesymbolsproportionally:!1,respectframe:!0,anchorpointunits:"Relative",offsetX:0,offsetY:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMPictureMarker:{scalex:1,texturefilter:"Draft",anchorpointunits:"Relative",offsetx:0,offsety:0,rotateclockwise:!1,rotation:0,size:10,enable:!0,colorlocked:!1},CIMTextSymbol:{angle:0,anglex:0,angley:0,halosize:1,height:10,horizontalalignment:"Left",kerning:!0,letterspacing:0,letterwidth:100,ligatures:!0,linegap:0,offsetx:0,offsety:0,strikethrough:!1,textcase:"Normal",textstring:"",underline:!1,verticalalignment:"Bottom",enable:!0,colorlocked:!1},CIMSolidStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMPictureStroke:{texturefilter:"Draft",capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMGradientStroke:{capstyle:"Round",joinstyle:"Round",miterlimit:4,width:4,enable:!0,colorlocked:!1},CIMSolidFill:{enable:!0,colorocked:!1},CIMPictureFill:{offsetx:0,offsety:0,rotation:0,scalex:1,height:10,texturefilter:"Draft",enable:!0,colorlocked:!1},CIMHatchFill:{offsetx:0,offsety:0,rotation:0,separation:4,enable:!0,colorlocked:!1},CIMGeometricEffectAddControlPoints:{angletolerance:120},CIMGeometricEffectArrow:{arrowtype:"OpenEnded",width:5},CIMGeometricEffectBuffer:{size:1},CIMGeometricEffectCut:{begincut:1,endcut:1,middlecut:0,invert:!1},CIMGeometricEffectDashes:{customendingoffset:0,linedashending:"NoConstraint",offsetalongline:0},CIMGeometricEffectDonut:{method:"Mitered",option:"Accurate",width:2},CIMGeometricEffectJog:{angle:225,length:20,position:50},CIMGeometricEffectControlMeasureLine:{rule:"FullGeometry"},CIMGeometricEffectMove:{offsetx:1,offsety:-1},CIMGeometricEffectOffset:{method:"Square",offset:1,option:"Fast"},CIMGeometricEffectRotate:{angle:15},CIMGeometricEffectScale:{xscalefactor:1.15,yscalefactor:1.15},CIMGeometricEffectWave:{amplitude:2,period:3,seed:1,waveform:"Sinus"},CIMMarkerPlacementAlongLine:{customendingoffset:0,endings:"WithHalfGap",offsetalongline:0,placeperpart:!0,angletoline:!0,offset:0},CIMMarkerPlacementAtExtremities:{extremityplacement:"Both",offsetalongline:0,angletoline:!0,offset:0},CIMMarkerPlacementAtRatioPositions:{beginposition:0,endposition:0,flipfirst:!0,angletoline:!0,offset:0},CIMMarkerPlacementInsidePolygon:{gridangle:0,gridtype:"Fixed",offsetx:0,offsety:0,randomness:100,seed:0,shiftoddrows:!1,stepx:16,stepy:16,clipping:"ClipAtBoundary"},CIMMarkerPlacementOnLine:{relativeto:"LineMiddle",startpointoffset:0,angletoline:!0,offset:0},CIMMarkerPlacementOnVertices:{placeperpart:!0,placeoncontrolpoints:!0,placeonendpoints:!0,placeonregularvertices:!0,angletoline:!0,offset:0},CIMMarkerPlacementPolygonCenter:{method:"OnPolygon",offsetx:0,offsety:0,clipatboundary:!1},CIMAnimatedSymbolProperties:{playanimation:!1,reverseanimation:!1,randomizestarttime:!1,randomizestartseed:0,starttimeoffset:0,duration:3,endingduration:3,useendingduration:!1,repeattype:"Loop",repeatdelay:0}};function p9e(e){return[e.r,e.g,e.b,e.a]}const F_e=` /-,
`;function E9(e){let t=e.length;for(;t--;)if(!F_e.includes(e.charAt(t)))return!1;return!0}function j_e(e,t){const r=[];let i=0,n=-1;do if(n=e.indexOf("[",i),n>=i){if(n>i){const s=e.substr(i,n-i);r.push([s,null,E9(s)])}if(i=n+1,n=e.indexOf("]",i),n>=i){if(n>i){const s=t[e.substr(i,n-i)];s&&r.push([null,s,!1])}i=n+1}}while(n!==-1);if(i<e.length-1){const s=e.substr(i);r.push([s,null,E9(s)])}return r}function U_e(e,t,r,i){let n="",s=null;for(const o of t){const[a,u,c]=o;if(a)c?s=a:(s&&(n+=s,s=null),n+=a);else{let h=u;r!=null&&(h=SJ(u,r));const d=e.attributes[h];d&&(s&&(n+=s,s=null),n+=d)}}return V_e(n,i)}function V_e(e,t){switch(typeof e!="string"&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function h9e(e,t,r,i,n,s,o=!0){const a=t/n,u=r/s,c=Math.ceil(a/2),h=Math.ceil(u/2);for(let d=0;d<s;d++)for(let y=0;y<n;y++){const v=4*(y+(o?s-d-1:d)*n);let w=0,b=0,_=0,x=0,T=0,I=0,M=0;const $=(d+.5)*u;for(let A=Math.floor(d*u);A<(d+1)*u;A++){const R=Math.abs($-(A+.5))/h,L=(y+.5)*a,C=R*R;for(let U=Math.floor(y*a);U<(y+1)*a;U++){let F=Math.abs(L-(U+.5))/c;const j=Math.sqrt(C+F*F);j>=-1&&j<=1&&(w=2*j*j*j-3*j*j+1,w>0&&(F=4*(U+A*t),M+=w*e[F+3],_+=w,e[F+3]<255&&(w=w*e[F+3]/250),x+=w*e[F],T+=w*e[F+1],I+=w*e[F+2],b+=w))}}i[v]=x/b,i[v+1]=T/b,i[v+2]=I/b,i[v+3]=M/_}}function bJ(e){return e?[e[0],e[1],e[2],e[3]/255]:[0,0,0,0]}function G_e(e){var t;return((t=e.data)==null?void 0:t.symbol)??null}function B_e(e){return e.type==="CIMVectorMarker"||e.type==="CIMPictureMarker"||e.type==="CIMBarChartMarker"||e.type==="CIMCharacterMarker"||e.type==="CIMPieChartMarker"||e.type==="CIMStackedBarChartMarker"}function z_e(e){return e.type==="CIMGradientStroke"||e.type==="CIMPictureStroke"||e.type==="CIMSolidStroke"}function d9e(e){return e!=null&&(e.type==="CIMGradientFill"||e.type==="CIMHatchFill"||e.type==="CIMPictureFill"||e.type==="CIMSolidFill"||e.type==="CIMWaterFill")}function _J(e){return e!=null&&(e.type==="CIMMarkerPlacementAlongLineRandomSize"||e.type==="CIMMarkerPlacementAlongLineSameSize"||e.type==="CIMMarkerPlacementAlongLineVariableSize"||e.type==="CIMMarkerPlacementAtExtremities"||e.type==="CIMMarkerPlacementAtMeasuredUnits"||e.type==="CIMMarkerPlacementAtRatioPositions"||e.type==="CIMMarkerPlacementOnLine"||e.type==="CIMMarkerPlacementOnVertices")}const f9e=(e,t=0)=>e==null||isNaN(e)?t:e,y9e=(e,t)=>e??t,m9e=e=>e.tintColor?bJ(e.tintColor):[255,255,255,1],g9e=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function v9e(){return ge(()=>import("./geometryEngineJSON-CV8iFHkT.js").then(e=>e.g),__vite__mapDeps([24,20,1,2,25]))}function w9e(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function b9e(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function _9e(e){let t="normal",r="normal";if(e){const i=e.toLowerCase();i.includes("italic")?t="italic":i.includes("oblique")&&(t="oblique"),i.includes("bold")?r="bold":i.includes("light")&&(r="lighter")}return{style:t,weight:r}}function S9e(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function A9(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const r=A9(t);if(r!=null)return r}break;case"CIMTextSymbol":return A9(e.symbol);case"CIMSolidFill":return e.color}return null}function R9(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const r of t){const i=R9(r);if(i!=null)return i}break}case"CIMTextSymbol":return R9(e.symbol);case"CIMSolidStroke":return e.color}}function C9(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const r=C9(t);if(r!==void 0)return r}break;case"CIMTextSymbol":return C9(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function x9e(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function T9e(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function q_e(e){return(e?Object.keys(e):[]).map(t=>({name:t,alias:t,type:typeof e[t]=="string"?"esriFieldTypeString":"esriFieldTypeDouble"}))}const I9e=e=>e.includes("data:image/svg+xml");function O9(e){return e&&e.charAt(0).toLowerCase()+e.substring(1)}function M9e(e,t,r,i,n,s){const{infos:o}=s;let a=1,u=0,c=0,h=0;for(const{offsetX:v,offsetY:w,rotation:b,size:_,frameHeight:x,rotateClockWise:T}of o)c=L9(v,w,u,a,c),h=P9(v,w,u,a,h),x&&(a*=_/x),u=k9(b,T,u);const d=L9(i,n,u,a,c),y=P9(i,n,u,a,h);return{size:e*a,rotation:k9(t,r,u),offsetX:d,offsetY:y}}function H_e(e){if(e==null)return!1;if(Array.isArray(e))return e.every(t=>H_e(t));switch(typeof e){case"string":return!!e;case"number":return!isNaN(e)}}function $9e(e,t){if(t==="color"||t==="outlinecolor"||t==="backgroundcolor"||t==="borderLineColor")return[...D_e[t]];const r=R5[e];if(!r||typeof r[t]=="boolean")throw new Error(`InternalError: default value for type ${e}.`);return r[t]}function W_e(e){return e!=null&&e.dashTemplate&&typeof e.dashTemplate=="string"&&(e.dashTemplate=e.dashTemplate.split(" ").map(Number)),e}function C5(e){if(e==null)return"Normal";switch(e.type){case"CIMTextSymbol":return e.textCase??"Normal";case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const t=e.symbolLayers;if(!t)return"Normal";for(const r of t)if(r.type==="CIMVectorMarker")return C5(r)}break;case"CIMVectorMarker":{const t=e.markerGraphics;if(!t)return"Normal";for(const r of t)if(r.symbol)return C5(r.symbol)}}return"Normal"}function E9e(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers){for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const i=r.size??R5.CIMVectorMarker.size;i>t&&(t=i);break}}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers){for(const r of e.symbolLayers)if(r)switch(r.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const i=r.width;i!=null&&i>t&&(t=i);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(r.markerPlacement&&_J(r.markerPlacement)){const i=r.size??R5.CIMVectorMarker.size;i>t&&(t=i)}break;case"CIMPictureFill":{const i=r.height;i!=null&&i>t&&(t=i)}}}return t}}}function SJ(e,t){if(t!==null){const r=t.get(e);return r?r.name:e}return e}function P9(e,t,r,i,n){const s=r*Math.PI/180;if(s){const o=Math.cos(s);return(Math.sin(s)*e+o*t)*i+n}return t*i+n}function L9(e,t,r,i,n){const s=r*Math.PI/180;return s?(Math.cos(s)*e-Math.sin(s)*t)*i+n:e*i+n}function k9(e,t,r){return t?r-e:r+e}const aP=(e,t,r)=>[t,r],Lm=(e,t,r)=>[t,r,e[2]],lP=(e,t,r)=>[t,r,e[2],e[3]];function A9e(e){return e?{originPosition:e.originPosition==="upper-left"?"upperLeft":e.originPosition==="lower-left"?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:e.extent!=null?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function J_e({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function Z_e({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function xJ({scale:e,translate:t},r){return r*e[0]+t[0]}function TJ({scale:e,translate:t},r){return t[1]-r*e[1]}function IJ(e,t,r){const i=new Array(r.length);if(!r.length)return i;const[n,s]=e.scale;let o=xJ(e,r[0][0]),a=TJ(e,r[0][1]);i[0]=t(r[0],o,a);for(let u=1;u<r.length;u++){const c=r[u];o+=c[0]*n,a-=c[1]*s,i[u]=t(c,o,a)}return i}function MJ(e,t,r){const i=new Array(r.length);for(let n=0;n<r.length;n++)i[n]=IJ(e,t,r[n]);return i}function Y_e(e,t,r,i){return IJ(e,r?i?lP:Lm:i?Lm:aP,t)}function K_e(e,t,r,i){return MJ(e,r?i?lP:Lm:i?Lm:aP,t)}function X_e(e,t,r,i){return MJ(e,r?i?lP:Lm:i?Lm:aP,t)}function R9e(e,t,r,i,n){return t.x=J_e(e,r.x),t.y=Z_e(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m)),t}function Q_e(e,t,r,i,n){return r!=null&&(t.points=Y_e(e,r.points,i,n)),t}function e2e(e,t,r,i,n){return r==null||(t.x=xJ(e,r.x),t.y=TJ(e,r.y),t!==r&&(i&&(t.z=r.z),n&&(t.m=r.m))),t}function t2e(e,t,r,i,n){return r!=null&&(t.rings=X_e(e,r.rings,i,n)),t}function r2e(e,t,r,i,n){return r!=null&&(t.paths=K_e(e,r.paths,i,n)),t}function i2e(e,t,r,i,n){if(e==null)return null;const s=e.referencesGeometry()&&n?n2e(t,i,n):t,o=e.repurposeFeature(s);try{return e.evaluate({...r,$feature:o},e.services)}catch(a){return oe.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",a),null}}const hM=new Map;function n2e(e,t,r){const{transform:i,hasZ:n,hasM:s}=r;hM.has(t)||hM.set(t,s2e(t));const o=hM.get(t)(e.geometry,i,n,s);return{...e,geometry:o}}function s2e(e){const t={};switch(e){case"esriGeometryPoint":return(r,i,n,s)=>e2e(i,t,r,n,s);case"esriGeometryPolygon":return(r,i,n,s)=>t2e(i,t,r,n,s);case"esriGeometryPolyline":return(r,i,n,s)=>r2e(i,t,r,n,s);case"esriGeometryMultipoint":return(r,i,n,s)=>Q_e(i,t,r,n,s);default:return oe.getLogger("esri.views.2d.support.arcadeOnDemand").error(new z("mapview-arcade",`Unable to handle geometryType: ${e}`)),r=>r}}const o2e=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:i,a:n}=e;return[t,r,i,255*n]};let $J=class br{static findApplicableOverrides(t,r,i){if(t&&r){if(t.primitiveName){let n=!1;for(const s of i)if(s.primitiveName===t.primitiveName){n=!0;break}if(!n)for(const s of r)s.primitiveName===t.primitiveName&&i.push(s)}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const n of t.effects)br.findApplicableOverrides(n,r,i);if(t.symbolLayers)for(const n of t.symbolLayers)br.findApplicableOverrides(n,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(t.effects)for(const n of t.effects)br.findApplicableOverrides(n,r,i);if(t.markerPlacement&&br.findApplicableOverrides(t.markerPlacement,r,i),t.type==="CIMVectorMarker"){if(t.markerGraphics)for(const n of t.markerGraphics)br.findApplicableOverrides(n,r,i),br.findApplicableOverrides(n.symbol,r,i)}else t.type==="CIMCharacterMarker"?br.findApplicableOverrides(t.symbol,r,i):t.type==="CIMHatchFill"?br.findApplicableOverrides(t.lineSymbol,r,i):t.type==="CIMPictureMarker"&&br.findApplicableOverrides(t.animatedSymbolProperties,r,i)}}}static findEffectOverrides(t,r){if(!t)return null;if(t.type==="CIMGeometricEffectDashes"&&W_e(t),!r||!t.primitiveName)return{type:"cim-effect-info",effect:t,overrides:[]};const i=t.primitiveName,n=[];for(const s of r)s.primitiveName===i&&n.push({...s,propertyName:O9(s.propertyName)});return{type:"cim-effect-info",effect:t,overrides:n}}static async resolveSymbolOverrides(t,r,i,n,s,o,a){if(!(t!=null&&t.symbol))return null;let{symbol:u,primitiveOverrides:c}=t;const h=!!c;if(!h&&!n)return u;u=B(u),c=B(c);let d=!0;if(r||(r={attributes:{}},d=!1),h){if(d||(c=c.filter(y=>{var v;return!((v=y.valueExpressionInfo)!=null&&v.expression.includes("$feature"))})),a||(c=c.filter(y=>{var v;return!((v=y.valueExpressionInfo)!=null&&v.expression.includes("$view"))})),c.length>0){const y={spatialReference:i,fields:q_e(r.attributes),geometryType:s};await br.createRenderExpressions(c,y),br.evaluateOverrides(c,r,s??"esriGeometryPoint",o,a)}br.applyOverrides(u,c)}return n&&br.applyDictionaryTextOverrides(u,r,n,null),u}static async createRenderExpressions(t,r){const i=[];for(const n of t){const s=n.valueExpressionInfo;if(!s||br._expressionToRenderExpression.has(s.expression))continue;const o=Pfe(s.expression,r.spatialReference,r.fields);i.push(o),o.then(a=>br._expressionToRenderExpression.set(s.expression,a))}i.length>0&&await Promise.all(i)}static evaluateOverrides(t,r,i,n,s){const o={$view:{scale:s==null?void 0:s.scale}};for(const a of t){a.value&&typeof a.value=="object"&&vW(a.value)&&(a.propertyName==="Color"||a.propertyName==="StrokeColor")&&(a.value=o2e(a.value));const u=a.valueExpressionInfo;if(!u)continue;const c=br._expressionToRenderExpression.get(u.expression);c&&(a.value=i2e(c,r,o,i,n))}}static applyDictionaryTextOverrides(t,r,i,n,s="Normal"){if(t!=null&&t.type)switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=t.symbolLayers;if(!o)return;for(const a of o)a&&a.type==="CIMVectorMarker"&&br.applyDictionaryTextOverrides(a,r,i,n,t.type==="CIMTextSymbol"?t.textCase:s)}break;case"CIMVectorMarker":{const o=t.markerGraphics;if(!o)return;for(const a of o)a&&br.applyDictionaryTextOverrides(a,r,i,n)}break;case"CIMMarkerGraphic":{const o=t.textString;if(o&&o.includes("[")){const a=j_e(o,i);t.textString=U_e(r,a,n,s)}}}}static applyOverrides(t,r,i,n){if(t.primitiveName){for(const s of r)if(s.primitiveName===t.primitiveName){const o=O9(s.propertyName);if(n&&n.push({cim:t,nocapPropertyName:o,value:t[o]}),i){let a=!1;for(const u of i)u.primitiveName===t.primitiveName&&(a=!0);a||i.push(s)}s.value!=null&&(t[o]=s.value)}}switch(t.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(t.effects)for(const s of t.effects)br.applyOverrides(s,r,i,n);if(t.symbolLayers)for(const s of t.symbolLayers)br.applyOverrides(s,r,i,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(t.effects)for(const s of t.effects)br.applyOverrides(s,r,i,n);if(t.type==="CIMVectorMarker"&&t.markerGraphics)for(const s of t.markerGraphics)br.applyOverrides(s,r,i,n),br.applyOverrides(s.symbol,r,i,n)}}static restoreOverrides(t){for(const r of t)r.cim[r.nocapPropertyName]=r.value}static buildOverrideKey(t){let r="";for(const i of t)i.value!==void 0&&(r+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return r}static toValue(t,r){if(t==="DashTemplate")return r.split(" ").map(i=>Number(i));if(t==="Color"){const i=new ve(r).toRgba();return i[3]*=255,i}return r}};$J._expressionToRenderExpression=new Map;const N9="esri.renderers.support.DictionaryLoader",a2e={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let EJ=class{constructor(t,r,i){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new Z4(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=t,this.config=r,this.fieldMap=i}getSymbolFields(){return this._symbolFields}async getSymbolAsync(t,r){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(r));try{i=await this._dictionaryPromise}catch(d){if(Ei(d))return this._dictionaryPromise=null,null}const n=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={};if(this.fieldMap)for(const d of this._symbolFields){const y=SJ(this.fieldMap[d],this._fieldIndex);if(y){const v=t.attributes[y];s[d]=n?v:v!=null?""+t.attributes[y]:""}else s[d]=""}let o=null;try{o=i==null?void 0:i(s,r)}catch{return null}if(!o||typeof o!="string"||o==="invalid")return null;const a=o.split(";"),u=[],c=[];for(const d of a)if(d)if(d.includes("po:")){const y=d.substr(3).split("|");if(y.length===3){const v=y[0],w=y[1];let b=y[2];if(w==="DashTemplate")b=b.split(" ").map(_=>Number(_));else if(w==="Color"){const _=new ve(b).toRgba();b=[_[0],_[1],_[2],255*_[3]]}else b=Number(b);c.push({primitiveName:v,propertyName:w,value:b,defaultValue:null})}}else if(d.includes("|")){for(const y of d.split("|"))if(this._itemNames.has(y)){u.push(y);break}}else this._itemNames.has(d)&&u.push(d);const h=t.geometry==null||!t.geometry.hasZ&&t.geometry.type==="point";return this._cimPartsToCIMSymbol(t,u,c,h,r)}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void oe.getLogger(N9).error("no valid URL!");const r=be(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:t!=null?t.signal:null}),[{data:i}]=await Promise.all([r,uf()]);if(!i)throw this._dictionaryPromise=null,new z("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:s,expression:o,itemsNames:a}=i,u=o;let c=!1;s&&(this._dictionaryVersion=nJ.parse(s),c=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(a),this._symbolFields=n.symbol;const h={};if(this.config){const v=this.config;for(const w in v)h[w]=v[w]}if(n.configuration)for(const v of n.configuration)h.hasOwnProperty(v.name)||(h[v.name]=v.value);const d=[];if(t!=null&&t.fields&&this.fieldMap)for(const v in this.fieldMap){const w=this.fieldMap[v],b=t.fields.filter(_=>_.name.toLowerCase()===(w==null?void 0:w.toLowerCase()));b.length>0&&d.push({...b[0],type:c?b[0].type:"esriFieldTypeString"})}d.length>0&&(this._fieldIndex=new DT(d));const y=Lfe(u,t!=null?t.spatialReference:null,d,h).then(v=>{const w={scale:0};return(b,_)=>{if(v==null)return null;const x=v.repurposeFeature({geometry:null,attributes:b});return w.scale=_!=null?_.scale??void 0:void 0,v.evaluate({$feature:x,$view:w},v.services)}}).catch(v=>(oe.getLogger(N9).error("Creating dictinoary expression failed:",v),null));return this._dictionaryPromise=y,y}async _cimPartsToCIMSymbol(t,r,i,n,s){const o=new Array(r.length);for(let c=0;c<r.length;c++)o[c]=this._getSymbolPart(r[c],s);let a=await Promise.all(o);const u=this.fieldMap;if(u){a=B(a);for(const c of a)$J.applyDictionaryTextOverrides(c,t,u,this._fieldIndex,C5(c))}return new Hv({data:this._combineSymbolParts(a,i,n)})}async _getSymbolPart(t,r){const i=this._symbolCache.get(t);if(i)return i;if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then(o=>o.data);const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,t),s=be(n,{responseType:"json",query:{f:"json"},...r});this._ongoingRequests.set(t,s),s.finally(()=>this._ongoingRequests.delete(t));try{const o=await s;return this._symbolCache.put(t,o.data),o.data}catch(o){throw o}}_combineSymbolParts(t,r,i){if(!t||t.length===0)return null;const n={...t[0]};if(t.length>1){n.symbolLayers=[];for(const s of t){const o=s;n.symbolLayers.unshift(...o.symbolLayers)}}return i&&(n.callout=a2e),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:r}}};var O5;let aa=O5=class extends Kp(Ku){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new EJ(this.url,this.config,this.fieldMap)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,r,i){i!=null&&i.origin||super.writeVisualVariables(e,t,r,i)}clone(){return new O5({config:B(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:B(this.fieldMap),url:B(this.url),visualVariables:B(this.visualVariables)})}async getSymbolAsync(e,t){return this._loader.getSymbolAsync(e,t)}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await es(e,t,this.scaleExpression);for(const r in this.fieldMap){const i=this.fieldMap[r];t.has(i)&&e.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};l([p({type:EJ})],aa.prototype,"_loader",null),l([p({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],aa.prototype,"config",void 0),l([p({type:Object,json:{write:!0}})],aa.prototype,"fieldMap",void 0),l([p({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],aa.prototype,"scaleExpression",void 0),l([se("scaleExpression")],aa.prototype,"writeData",null),l([p({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],aa.prototype,"scaleExpressionTitle",void 0),l([p({type:String,json:{write:!0}})],aa.prototype,"url",void 0),l([se("visualVariables")],aa.prototype,"writeVisualVariables",null),aa=O5=l([k("esri.renderers.DictionaryRenderer")],aa);const l2e=aa;var P5;let lu=P5=class extends Q{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return e==null?e:typeof e=="function"?(oe.getLogger(this).error(".field: field must be a string value"),null):Pv(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){var e;return new P5({color:(e=this.color)==null?void 0:e.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};l([p({type:ve,json:{type:[Number],write:!0}})],lu.prototype,"color",void 0),l([p({type:String,json:{write:!0}})],lu.prototype,"field",void 0),l([Tt("field")],lu.prototype,"castField",null),l([p({type:String,json:{write:!0}})],lu.prototype,"label",void 0),l([p({type:String,json:{write:!0}})],lu.prototype,"valueExpression",void 0),l([p({type:String,json:{write:!0}})],lu.prototype,"valueExpressionTitle",void 0),lu=P5=l([k("esri.renderers.support.AttributeColorInfo")],lu);const AJ=lu;var L5;let A2=L5=class extends Q{constructor(){super(...arguments),this.unit=null}clone(){return new L5({unit:this.unit})}};l([p({type:String,json:{write:!0}})],A2.prototype,"unit",void 0),A2=L5=l([k("esri.renderers.support.DotDensityLegendOptions")],A2);const u2e=A2;var k5;let ps=k5=class extends Kp(Ku){constructor(e){super(e),this.attributes=null,this.backgroundColor=new ve([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new oo,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(this.referenceScale==null)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new _f({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){var e;return((e=this.attributes)==null?void 0:e.reduce((t,r)=>t+r.getAttributeHash(),""))??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new k5({attributes:B(this.attributes),backgroundColor:B(this.backgroundColor),dotBlendingEnabled:B(this.dotBlendingEnabled),dotShape:B(this.dotShape),dotSize:B(this.dotSize),dotValue:B(this.dotValue),legendOptions:B(this.legendOptions),outline:B(this.outline),referenceScale:B(this.referenceScale),seed:B(this.seed),visualVariables:B(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){var t;return`${(t=this.attributes)==null?void 0:t.map(r=>r.field||r.valueExpression||"")}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const r of this.attributes??[])r.valueExpression&&await es(e,t,r.valueExpression),r.field&&e.add(r.field)}};l([p({type:[AJ],json:{write:!0}})],ps.prototype,"attributes",void 0),l([p({type:ve,json:{write:!0}})],ps.prototype,"backgroundColor",void 0),l([p({type:Boolean,json:{write:!0}})],ps.prototype,"dotBlendingEnabled",void 0),l([p({type:String,json:{write:!1}})],ps.prototype,"dotShape",void 0),l([p({type:Number,json:{write:!0}})],ps.prototype,"dotSize",void 0),l([p({type:u2e,json:{write:!0}})],ps.prototype,"legendOptions",void 0),l([p({type:oo,json:{default:null,write:!0}})],ps.prototype,"outline",void 0),l([p({type:Number,json:{write:!0}})],ps.prototype,"dotValue",void 0),l([p({type:Number,json:{write:!0}})],ps.prototype,"referenceScale",void 0),l([p({type:Number,json:{write:!0}})],ps.prototype,"seed",void 0),l([Ce({dotDensity:"dot-density"})],ps.prototype,"type",void 0),ps=k5=l([k("esri.renderers.DotDensityRenderer")],ps);const c2e=ps;var N5;let zg=N5=class extends Q{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new N5({color:this.color&&this.color.clone(),ratio:this.ratio})}};l([p({type:ve,json:{type:[Ke],default:null,write:!0}})],zg.prototype,"color",void 0),l([p({type:Number,json:{write:!0}})],zg.prototype,"ratio",void 0),zg=N5=l([k("esri.renderers.support.HeatmapColorStop")],zg);const R2=zg;let cy=class extends It(Q){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};l([p({type:String,json:{write:!0}})],cy.prototype,"minLabel",void 0),l([p({type:String,json:{write:!0}})],cy.prototype,"maxLabel",void 0),l([p({type:String,json:{write:!0}})],cy.prototype,"title",void 0),cy=l([k("esri.renderers.support.HeatmapLegendOptions")],cy);const uP=2.4;function p2e(e){return Bu(e*uP)}function h2e(e){return Gye(e)/uP}function d2e(e,t,r,i){let{color:n,ratio:s}=t,{color:o,ratio:a}=r;a===s&&(a===1?s-=1e-6:a+=1e-6);const u=ka((i-s)/(a-s),0,1);pW(e,n.toArray(),o.toArray(),u)}function P9e(e){const r=new Uint8ClampedArray(2048);if(e=e.filter(({ratio:a})=>a>=0&&a<=1).sort((a,u)=>a.ratio-u.ratio).map(({color:a,ratio:u})=>({color:a,ratio:Math.max(u,.001)})),e.length<1)return r;let i=e[0],n=e[0],s=1;const o=ET();for(let a=0;a<512;a++){const u=(a+.5)/512;for(;u>n.ratio&&s<e.length;)i=n,n=e[s++];d2e(o,i,n,u),r.set(o,4*a)}return r}function L9e(e,t,r){const i=Math.sqrt(e**2+t**2)/r;return i>1?0:3/(Math.PI*r**2)*(1-i**2)**2}function k9e(e){return typeof e=="function"?e:e?t=>+t[e]:()=>1}var D5;function D9(e){if(e!=null){const{maxDensity:t,minDensity:r,radius:i}=e;if(t!=null||r!=null||i!=null){const{blurRadius:n,maxPixelIntensity:s,minPixelIntensity:o,...a}=e;return a}}return e}let Pi=D5=class extends Ku{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new R2({ratio:0,color:new ve("rgba(255, 140, 0, 0)")}),new R2({ratio:.75,color:new ve("rgba(255, 140, 0, 1)")}),new R2({ratio:.9,color:new ve("rgba(255, 0,   0, 1)")})],this.field=null,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(e){return D9(e)}get blurRadius(){return h2e(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,r=this.minPixelIntensity;this._set("radius",p2e(e)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",r*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(uP**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(e,t){this._warnedProps[e]||Mi(this).getDefaultOrigin()==="user"&&(this._warnedProps[e]=!0,Bm(()=>{Ma(oe.getLogger(this),e,{replacement:`${String(t)} (suggested value: ${this._get(t)})`,version:"4.24"})}))}read(e,t){e=D9(e),super.read(e,t)}getSymbol(){return new Ll}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const r=this.field,i=this.valueExpression;r&&typeof r=="string"&&Ks(e,t,r),i&&typeof i=="string"&&await es(e,t,i)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new D5({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:B(this.colorStops),field:this.field,legendOptions:B(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};l([p({type:sw,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pi.prototype,"authoringInfo",void 0),l([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Pi.prototype,"blurRadius",null),l([p({type:[R2],json:{write:!0}})],Pi.prototype,"colorStops",void 0),l([p({type:String,json:{write:!0}})],Pi.prototype,"field",void 0),l([p({type:cy,json:{write:!0}})],Pi.prototype,"legendOptions",void 0),l([p({type:Number,json:{write:!0}})],Pi.prototype,"maxDensity",void 0),l([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Pi.prototype,"maxPixelIntensity",null),l([p({type:Number,json:{write:!0}})],Pi.prototype,"minDensity",void 0),l([p({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],Pi.prototype,"minPixelIntensity",null),l([p({type:Number,cast:wt,json:{write:!0}})],Pi.prototype,"radius",void 0),l([p({type:Number,range:{min:0},json:{default:0,write:!0}})],Pi.prototype,"referenceScale",void 0),l([Ce({heatmap:"heatmap"})],Pi.prototype,"type",void 0),l([p({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],Pi.prototype,"valueExpression",void 0),l([p({type:String})],Pi.prototype,"valueExpressionTitle",void 0),l([p({readOnly:!0})],Pi.prototype,"_pixelIntensityToDensity",null),Pi=D5=l([k("esri.renderers.HeatmapRenderer")],Pi);const RJ=Pi;let xd=class extends It(Q){constructor(){super(...arguments),this.color=new ve([0,0,0,0]),this.label=null,this.threshold=0}};l([p({type:ve,json:{write:!0}})],xd.prototype,"color",void 0),l([p({type:String,json:{write:!0}})],xd.prototype,"label",void 0),l([p({type:Number,range:{min:0,max:1},json:{write:!0}})],xd.prototype,"threshold",void 0),xd=l([k("esri.renderers.support.OthersCategory")],xd);let C2=class extends It(Q){constructor(){super(...arguments),this.title=null}};l([p({type:String,json:{write:!0}})],C2.prototype,"title",void 0),C2=l([k("esri.renderers.support.PieChartLegendOptions")],C2);let Ls=class extends Kp(It(Ku)){constructor(t){super(t),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new ve([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new xd,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){var t;return new Ll({size:this.size?this.size/2+(((t=this.outline)==null?void 0:t.width)||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(Qn)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((t,r)=>t+r.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((t,r)=>t+JSON.stringify(r),"")}async collectRequiredFields(t,r){await this.collectVVRequiredFields(t,r);for(const i of this.attributes)i.valueExpression&&await es(t,r,i.valueExpression),i.field&&t.add(i.field)}};l([p({type:[AJ],json:{write:!0}})],Ls.prototype,"attributes",void 0),l([p({type:_f,json:{default:null,write:!0}})],Ls.prototype,"backgroundFillSymbol",void 0),l([p({type:ve,json:{write:!0}})],Ls.prototype,"defaultColor",void 0),l([p({type:String,json:{write:!0}})],Ls.prototype,"defaultLabel",void 0),l([p({type:Number,range:{min:0,max:1},json:{write:!0}})],Ls.prototype,"holePercentage",void 0),l([p({type:xd,json:{write:!0}})],Ls.prototype,"othersCategory",void 0),l([p({type:C2,json:{write:!0}})],Ls.prototype,"legendOptions",void 0),l([p({type:oo,json:{default:null,write:!0}})],Ls.prototype,"outline",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],Ls.prototype,"size",void 0),l([Ce({pieChart:"pie-chart"})],Ls.prototype,"type",void 0),Ls=l([k("esri.renderers.PieChartRenderer")],Ls);const f2e=Ls;var F5;let qh=F5=class extends Kp(Ku){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map(r=>r.collectRequiredFields(e,t)))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){return this.getSymbols().reduce((e,t)=>e+JSON.stringify(t),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new F5({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:B(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};l([p({type:String,json:{write:!0}})],qh.prototype,"description",void 0),l([p({type:String,json:{write:!0}})],qh.prototype,"label",void 0),l([p(oP)],qh.prototype,"symbol",void 0),l([Ce({simple:"simple"})],qh.prototype,"type",void 0),qh=F5=l([k("esri.renderers.SimpleRenderer")],qh);const n0=qh,y2e=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function j5(e){return e instanceof De}function F9(e){return e instanceof $e?Object.keys(e.items):j5(e)?Mi(e).keys():e?Object.keys(e):[]}function Zb(e,t){return e instanceof $e?e.items[t]:e[t]}function m2e(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}function D1(e){return e?e.declaredClass:null}function CJ(e,t){var d;const r=e.diff;if(r&&typeof r=="function")return r(e,t);const i=F9(e),n=F9(t);if(i.length===0&&n.length===0)return;if(!i.length||!n.length||m2e(e,t))return{type:"complete",oldValue:e,newValue:t};const s=n.filter(y=>!i.includes(y)),o=i.filter(y=>!n.includes(y)),a=i.filter(y=>n.includes(y)&&Zb(e,y)!==Zb(t,y)).concat(s,o).sort(),u=D1(e);if(u&&y2e.has(u)&&a.length)return{type:"complete",oldValue:e,newValue:t};let c;const h=j5(e)&&j5(t);for(const y of a){const v=Zb(e,y),w=Zb(t,y);let b;if((h||typeof v!="function"&&typeof w!="function")&&v!==w&&(v!=null||w!=null)){if(r&&r[y]&&typeof r[y]=="function")b=(d=r[y])==null?void 0:d.call(r,v,w);else if(v instanceof Date&&w instanceof Date){if(v.getTime()===w.getTime())continue;b={type:"complete",oldValue:v,newValue:w}}else b=typeof v=="object"&&typeof w=="object"&&D1(v)===D1(w)?CJ(v,w):{type:"complete",oldValue:v,newValue:w};b!=null&&(c!=null?c.diff[y]=b:c={type:"partial",diff:{[y]:b}})}}return c}function j9e(e,t){return g2e(e,t)}function g2e(e,t){if(e==null)return!1;const r=t.split(".");let i=e;for(const n of r){if(i.type==="complete")return!0;if(i.type!=="partial")return!1;{const s=i.diff[n];if(!s)return!1;i=s}}return!0}function U9e(e,t){if(!e)return!1;if(e.type==="partial"){const r=Object.keys(e.diff);return r.length===1&&r[0]===t}return!1}function v2e(e,t){if(typeof e!="function"&&typeof t!="function"&&(e!=null||t!=null))return e==null||t==null||typeof e=="object"&&typeof t=="object"&&D1(e)!==D1(t)?{type:"complete",oldValue:e,newValue:t}:CJ(e,t)}let py=class extends It(Q){constructor(t){super(t),this.value=null,this.value2=null,this.value3=null}};l([p(I2)],py.prototype,"value",void 0),l([p(I2)],py.prototype,"value2",void 0),l([p(I2)],py.prototype,"value3",void 0),py=l([k("esri.renderers.support.UniqueValue")],py);const sm=py;let Dc=class extends It(Q){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(t){if(t==null)return null;const r=typeof(t=Array.isArray(t)?t:[t])[0];return r==="string"||r==="number"?t.map(i=>new sm({value:i})):r==="object"?t[0]instanceof sm?t:t.map(i=>new sm(i)):null}};l([p({type:String,json:{write:!0}})],Dc.prototype,"description",void 0),l([p({type:String,json:{write:!0}})],Dc.prototype,"label",void 0),l([p(kT)],Dc.prototype,"symbol",void 0),l([p({type:[sm],json:{type:[[String]],read:{reader:e=>e?e.map(t=>new sm({value:t[0],value2:t[1],value3:t[2]})):null},write:{writer:(e,t)=>{const r=[];for(const i of e){const n=[i.value,i.value2,i.value3].filter(Qn).map(s=>s.toString());r.push(n)}t.values=r}}}})],Dc.prototype,"values",void 0),l([Tt("values")],Dc.prototype,"castValues",null),Dc=l([k("esri.renderers.support.UniqueValueClass")],Dc);const OJ=Dc;let qg=class extends It(Q){constructor(t){super(t),this.heading=null,this.classes=null}};l([p({type:String,json:{write:!0}})],qg.prototype,"heading",void 0),l([p({type:[OJ],json:{write:!0}})],qg.prototype,"classes",void 0),qg=l([k("esri.renderers.support.UniqueValueGroup")],qg);const U5=qg;var V5;let Hh=V5=class extends Q{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new V5({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){var t;const e=JSON.stringify((t=this.symbol)==null?void 0:t.toJSON());return`${this.value}.${e}`}};l([p({type:String,json:{write:!0}})],Hh.prototype,"description",void 0),l([p({type:String,json:{write:!0}})],Hh.prototype,"label",void 0),l([p(oP)],Hh.prototype,"symbol",void 0),l([p(I2)],Hh.prototype,"value",void 0),Hh=V5=l([k("esri.renderers.support.UniqueValueInfo")],Hh);const Yd=Hh,w2e=()=>!!Me("enable-feature:force-wosr"),b2e=()=>Me.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0),_2e=()=>Me.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),S2e=()=>Me.add("enable-i3s-patching",!0,!0,!0),x2e=()=>Me.add("enable-i3s-patching",!1,!0,!0),z9e=()=>!!Me("enable-feature:SceneLayer-editing"),T2e=(e="i3s-patching")=>{switch(x2e(),_2e(),Me.add("enable-feature:SceneLayer-editing",!0,!0,!0),e){case"feature-layer-view":b2e();break;case"i3s-patching":S2e()}};T2e("i3s-patching");let dM={};async function I2e(e,t){try{return{data:(await A2e(e,t)).data,baseUrl:dG(e),styleUrl:e}}catch(r){return Ti(r),null}}function M2e(e,t,r){const i=t.portal!=null?t.portal:ts.getDefault();let n;const s=`${i.url} - ${i.user&&i.user.username} - ${e}`;return dM[s]||(dM[s]=$2e(e,i,r).then(o=>(n=o,o.fetchData())).then(o=>({data:o,baseUrl:n.itemUrl??"",styleName:e}))),dM[s]}function $2e(e,t,r){return t.load(r).then(()=>{const i=new ml({disableExtraQuery:!0,query:`owner:${j9} AND type:${U9} AND typekeywords:"${e}"`});return t.queryItems(i,r)}).then(({results:i})=>{var o;let n=null;const s=e.toLowerCase();if(i&&Array.isArray(i)){for(const a of i)if(((o=a.typeKeywords)==null?void 0:o.some(c=>c.toLowerCase()===s))&&a.type===U9&&a.owner===j9){n=a;break}}if(!n)throw new z("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(r)})}function E2e(e,t,r){return(e==null?void 0:e.styleUrl)!=null?I2e(e.styleUrl,r):(e==null?void 0:e.styleName)!=null?M2e(e.styleName,t,r):Promise.reject(new z("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function q9e(e){return e===null||e.type==="CIMSymbolReference"?e:{type:"CIMSymbolReference",symbol:e}}function H9e(e,t,r=["gltf"]){if(t==="cimRef")return e.cimRef;if(e.formatInfos&&!w2e())for(const i of r){const n=e.formatInfos.find(s=>s.type===i);if(n)return n.href}return e.webRef}function A2e(e,t){const r={responseType:"json",query:{f:"json"},...t};return be(_s(e),r)}const j9="esri_en",U9="Style",W9e="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var Hg;const PJ="esri.renderers.UniqueValueRenderer",vc=()=>oe.getLogger(PJ),V9="uvInfos-watcher",G9="uvGroups-watcher",R2e=",",C2e=Lr(Yd);function O2e(e){const{field1:t,field2:r,field3:i,fieldDelimiter:n,uniqueValueInfos:s,valueExpression:o}=e,a=!(!t||!r);return[{classes:(s??[]).map(u=>{var x;const{symbol:c,label:h,value:d,description:y}=u,[v,w,b]=a?((x=d==null?void 0:d.toString())==null?void 0:x.split(n||""))||[]:[d],_=[];return(t||o)&&_.push(v),r&&_.push(w),i&&_.push(b),{symbol:c,label:h,values:[_],description:y}})}]}let yr=Hg=class extends Kp(Ku){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,r){if(!t&&!r)return;if(!t||!r)return{type:"complete",oldValue:t,newValue:r};let i=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let s=0;s<r.length;s++){const o=t.find(a=>a.value===r[s].value);o?v2e(o,r[s])?(n.changed.push({type:"complete",oldValue:o,newValue:r[s]}),i=!0):n.unchanged.push({oldValue:o,newValue:r[s]}):(n.added.push(r[s]),i=!0)}for(let s=0;s<t.length;s++)r.find(o=>o.value===t[s].value)||(n.removed.push(t[s]),i=!0);return i?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return e==null||typeof e=="function"?e:Pv(e)}writeField(e,t,r,i){typeof e=="string"?t[r]=e:i!=null&&i.messages?i.messages.push(new z("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):vc().error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,r){return r.portal||ts.getDefault()}readStyleOrigin(e,t,r){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const i=Ym(t.styleUrl,r);return Object.freeze({styleUrl:i})}}writeStyleOrigin(e,t,r,i){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=Jv(e.styleUrl,i))}set uniqueValueGroups(e){this.styleOrigin?vc().error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?vc().error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){var i;if(this.styleOrigin)return void vc().error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let r;r=typeof e=="object"?C2e(e):new Yd({value:e,symbol:Vq(t)}),(i=this.uniqueValueInfos)==null||i.push(r),this._valueInfoMap[r.value]=r,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void vc().error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let r=0;r<t.length;r++){const i=t[r];if(String(i.value)===String(e)){delete this._valueInfoMap[e],t.splice(r,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let r=t;return this.valueExpression&&(t==null?void 0:t.arcade)==null&&(r={...r,arcade:await uf()}),this._getUniqueValueInfo(e,r)}getSymbol(e,t){if(this.valueExpression&&(t==null?void 0:t.arcade)==null)return void vc().error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const r=this._getUniqueValueInfo(e,t);return(r==null?void 0:r.symbol)||this.defaultSymbol}async getSymbolAsync(e,t){let r=t;if(this.valueExpression&&(r==null?void 0:r.arcade)==null){const n=await uf(),{arcadeUtils:s}=n;s.hasGeometryOperations(this.valueExpression)&&await s.enableGeometryOperations(),r={...r,arcade:n}}const i=this._getUniqueValueInfo(e,r);return(i==null?void 0:i.symbol)||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce((e,t)=>e+t.getAttributeHash(),"")}getMeshHash(){var i;const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),r=(i=this.uniqueValueInfos)==null?void 0:i.reduce((n,s)=>n+s.getMeshHash(),"");return`${e}.${t}.${r}.${`${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}`}.${this.valueExpression}`}clone(){const e=new Hg({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:B(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:B(this.visualVariables),legendOptions:B(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:B(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=B(this.uniqueValueInfos),r=B(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze(B(this.styleOrigin))),Object.freeze(t),Object.freeze(r)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",r),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const r=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(r)}async collectSymbolFields(e,t){const r=[...this.getSymbols().map(i=>i.collectRequiredFields(e,t)),es(e,t,this.valueExpression)];Ks(e,t,this.field),Ks(e,t,this.field2),Ks(e,t,this.field3),await Promise.all(r)}populateFromStyle(){return E2e(this.styleOrigin,{portal:this.portal}).then(e=>{var r;const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach(i=>{const n=new Sf({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const s=new Yd({value:i.name,symbol:n});t.push(s),this._valueInfoMap[i.name]=s}),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&((r=this.uniqueValueInfos)!=null&&r.length)&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this})}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",R2e)}_updateUniqueValues(){this._isInfosSource!=null&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[t.value+""]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(V9);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const r of e)t.push(Ue(()=>({symbol:r.symbol,value:r.value,label:r.label,description:r.description}),(i,n)=>{i!==n&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)},{sync:!0}));this.addHandles(t,V9)}}_watchUniqueValueGroups(){this.removeHandles(G9);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const r of e){t.push(Ue(()=>({classes:r.classes}),(i,n)=>{i!==n&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}));for(const i of r.classes??[])t.push(Ue(()=>({symbol:i.symbol,values:i.values,label:i.label,description:i.description}),(n,s)=>{n!==s&&(this._updateInfosFromGroups(),this._isInfosSource=!1)},{sync:!0}))}this.addHandles(t,G9)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:r,field3:i,fieldDelimiter:n,uniqueValueGroups:s,valueExpression:o}=this;if(!t&&!o)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!t||!r);for(const u of s)for(const c of u.classes??[]){const{symbol:h,label:d,values:y,description:v}=c;for(const w of y??[]){const{value:b,value2:_,value3:x}=w,T=[b];r&&T.push(_),i&&T.push(x);const I=a?T.join(n||""):T[0];e.push(new Yd({symbol:h,label:d,value:I,description:v}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:r,valueExpression:i,fieldDelimiter:n,uniqueValueInfos:s}=this;if(!t&&!i||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!t||!r),a=s.map(c=>{var x;const{symbol:h,label:d,value:y,description:v}=c,[w,b,_]=o?((x=y==null?void 0:y.toString())==null?void 0:x.split(n||""))||[]:[y];return new OJ({symbol:h,label:d,description:v,values:[new sm({value:w,value2:b,value3:_})]})}),u=[new U5({classes:a})];e&&Object.freeze(u),this._set("uniqueValueGroups",u),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:r,scale:i,spatialReference:n,arcade:s,timeZone:o}=t??{};let a=this._cache.compiledFunc;const u=s.arcadeUtils;if(!a){const h=u.createSyntaxTree(this.valueExpression);a=u.createFunction(h),this._cache.compiledFunc=a}const c=u.executeFunction(a,u.createExecContext(e,u.getViewInfo({viewingMode:r,scale:i,spatialReference:n}),o));return this._valueInfoMap[c+""]}_getUnqiueValueInfoForFields(e){const t=this.field,r=e.attributes;let i;if(typeof t!="function"&&this.field2){const n=this.field2,s=this.field3,o=[];t&&o.push(r[t]),n&&o.push(r[n]),s&&o.push(r[s]),i=o.join(this.fieldDelimiter||"")}else typeof t=="function"?i=t(e):t&&(i=r[t]);return this._valueInfoMap[i+""]}static fromPortalStyle(e,t){const r=new Hg(t==null?void 0:t.properties);r._set("styleOrigin",Object.freeze({styleName:e})),r._set("portal",(t==null?void 0:t.portal)||ts.getDefault());const i=r.populateFromStyle();return i.catch(n=>{vc().error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",n)}),i}static fromStyleUrl(e,t){const r=new Hg(t==null?void 0:t.properties);r._set("styleOrigin",Object.freeze({styleUrl:e}));const i=r.populateFromStyle();return i.catch(n=>{vc().error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",n)}),i}};l([p({readOnly:!0})],yr.prototype,"_cache",null),l([Ce({uniqueValue:"unique-value"})],yr.prototype,"type",void 0),l([p(gJ)],yr.prototype,"backgroundFillSymbol",void 0),l([p({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],yr.prototype,"field",null),l([Tt("field")],yr.prototype,"castField",null),l([se("field")],yr.prototype,"writeField",null),l([p({type:String,value:null,json:{write:!0}})],yr.prototype,"field2",null),l([p({type:String,value:null,json:{write:!0}})],yr.prototype,"field3",null),l([p({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],yr.prototype,"orderByClassesEnabled",void 0),l([p({type:String,value:null,json:{write:!0}})],yr.prototype,"valueExpression",null),l([p({type:String,json:{write:!0}})],yr.prototype,"valueExpressionTitle",void 0),l([p({type:Zd,json:{write:!0}})],yr.prototype,"legendOptions",void 0),l([p({type:String,json:{write:!0}})],yr.prototype,"defaultLabel",void 0),l([p(nV({...kT},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],yr.prototype,"defaultSymbol",null),l([p({type:String,value:null,json:{write:!0}})],yr.prototype,"fieldDelimiter",null),l([p({type:ts,readOnly:!0})],yr.prototype,"portal",void 0),l([te("portal",["styleName"])],yr.prototype,"readPortal",null),l([p({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],yr.prototype,"styleOrigin",void 0),l([te("styleOrigin",["styleName","styleUrl"])],yr.prototype,"readStyleOrigin",null),l([se("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],yr.prototype,"writeStyleOrigin",null),l([p({type:[U5],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,r)=>(t.uniqueValueGroups||O2e(t)).map(i=>U5.fromJSON(i,r))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],yr.prototype,"uniqueValueGroups",null),l([p({type:[Yd],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],yr.prototype,"uniqueValueInfos",null),yr=Hg=l([k(PJ)],yr);const s0=yr,aw={key:"type",base:Ku,typeMap:{heatmap:RJ,simple:n0,"unique-value":s0,"class-breaks":i0,"dot-density":c2e,dictionary:l2e,"pie-chart":f2e},errorContext:"renderer"},LJ={key:"type",base:Ku,typeMap:{simple:n0,"unique-value":s0,"class-breaks":i0,heatmap:RJ},errorContext:"renderer",validate:P2e};function P2e(e){switch(e.type){case"simple":return L2e(e);case"unique-value":return k2e(e);case"class-breaks":return N2e(e);case"heatmap":return e}}function L2e(e){if(e.symbol)return e;oe.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}function k2e(e){const t=e.uniqueValueInfos,r=t==null?void 0:t.filter(({symbol:i,label:n},s)=>(i||oe.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${s}] ${n}) without a symbol from web scene.`),!!i));return(r==null?void 0:r.length)!==(t==null?void 0:t.length)&&(e.uniqueValueInfos=r),e}function N2e(e){const t=e.classBreakInfos,r=t==null?void 0:t.filter(({symbol:i,label:n},s)=>(i||oe.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${s}] ${n}) without a symbol from web scene.`),!!i));return(r==null?void 0:r.length)!==(t==null?void 0:t.length)&&(e.classBreakInfos=r),e}function J9e(e,t){return gv(e,null,t)}const D2e=Vm({types:aw});function gv(e,t,r){return e?e&&(e.styleName||e.styleUrl)&&e.type!=="uniqueValue"?(r!=null&&r.messages&&r.messages.push(new eo("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:r})),null):D2e(e,t,r):null}const F2e=[["binary","application/octet-stream","bin",""]];function Z9e(e,t){return kJ(t.name,(e==null?void 0:e.supportedFormats)??[])!=null}function Y9e(e,t){if(!e)return!1;const r=j2e(t,e.supportedFormats??[]);return r!=null&&e.editFormats.includes(r)}function G5(e,t){return pP(V2e(e,t))}function B5(e,t){return pP(kJ(e,t))}function K9e(e,t){return NJ(U2e(e,t))}function j2e(e,t){return B5(e.name,t)??G5(e.type,t)}function cP(e){return[...F2e,...e]}function U2e(e,t){return cP(t).find(r=>pP(r)===e)}function V2e(e,t){const r=e.toLowerCase();return cP(t).find(i=>NJ(i)===r)}function kJ(e,t){const r=e.toLowerCase();return cP(t).find(i=>G2e(i).some(n=>r.endsWith(n)))}function pP(e){return e==null?void 0:e[0]}function NJ(e){return e==null?void 0:e[1].toLowerCase()}function G2e(e){return(e==null?void 0:e[2].split(",").map(t=>t.toLowerCase()))??[]}function X9e(e){var t;return(t=e.tables)==null?void 0:t.find(r=>r.role==="assetMaps")}var z5;let Wg=z5=class extends Q{constructor(e){super(e),this.name=null,this.code=null}clone(){return new z5({name:this.name,code:this.code})}};l([p({type:String,json:{write:!0}})],Wg.prototype,"name",void 0),l([p({type:[String,Number],json:{write:!0}})],Wg.prototype,"code",void 0),Wg=z5=l([k("esri.layers.support.CodedValue")],Wg);const B2e=new We({inherited:"inherited",codedValue:"coded-value",range:"range"});let Jg=class extends Q{constructor(t){super(t),this.name=null,this.type=null}};l([p({type:String,json:{write:!0}})],Jg.prototype,"name",void 0),l([Ce(B2e)],Jg.prototype,"type",void 0),Jg=l([k("esri.layers.support.Domain")],Jg);const FT=Jg;var q5;let Zg=q5=class extends FT{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const r=String(e);this.codedValues.some(i=>(String(i.code)===r&&(t=i.name),!!t))}return t}clone(){return new q5({codedValues:B(this.codedValues),name:this.name})}};l([p({type:[Wg],json:{write:!0}})],Zg.prototype,"codedValues",void 0),l([Ce({codedValue:"coded-value"})],Zg.prototype,"type",void 0),Zg=q5=l([k("esri.layers.support.CodedValueDomain")],Zg);const DJ=Zg;var H5;let O2=H5=class extends FT{constructor(e){super(e),this.type="inherited"}clone(){return new H5}};l([Ce({inherited:"inherited"})],O2.prototype,"type",void 0),O2=H5=l([k("esri.layers.support.InheritedDomain")],O2);const FJ=O2;var W5;let hy=W5=class extends FT{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new W5({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};l([p({json:{type:[Number],read:{source:"range",reader:(e,t)=>{var r;return(r=t.range)==null?void 0:r[1]}},write:{enabled:!1,overridePolicy(){return{enabled:this.maxValue!=null&&this.minValue==null}},target:"range",writer(e,t,r){t[r]=[this.minValue||0,e]}}}})],hy.prototype,"maxValue",void 0),l([p({json:{type:[Number],read:{source:"range",reader:(e,t)=>{var r;return(r=t.range)==null?void 0:r[0]}},write:{target:"range",writer(e,t,r){t[r]=[e,this.maxValue||0]}}}})],hy.prototype,"minValue",void 0),l([Ce({range:"range"})],hy.prototype,"type",void 0),hy=W5=l([k("esri.layers.support.RangeDomain")],hy);const jJ=hy,UJ={key:"type",base:FT,typeMap:{range:jJ,"coded-value":DJ,inherited:FJ}};function jT(e){if(!(e!=null&&e.type))return null;switch(e.type){case"range":return jJ.fromJSON(e);case"codedValue":return DJ.fromJSON(e);case"inherited":return FJ.fromJSON(e)}return null}const z2e=new We({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});var J5;const q2e=new We({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let yn=J5=class extends Q{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let r=null;try{r=t?JSON.parse(t):null}catch{}return(r==null?void 0:r.value)??null}readValueType(e,{description:t}){let r=null;try{r=t?JSON.parse(t):null}catch{}return r?q2e.fromJSON(r.fieldValueType):null}clone(){var e;return new J5({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:((e=this.domain)==null?void 0:e.clone())??null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};l([p({type:String,json:{write:!0}})],yn.prototype,"alias",void 0),l([p({type:[String,Number],json:{write:{allowNull:!0}}})],yn.prototype,"defaultValue",void 0),l([p()],yn.prototype,"description",void 0),l([te("description")],yn.prototype,"readDescription",null),l([p({types:UJ,json:{read:{reader:jT},write:!0}})],yn.prototype,"domain",void 0),l([p({type:Boolean,json:{write:!0}})],yn.prototype,"editable",void 0),l([p({type:Ke,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],yn.prototype,"length",void 0),l([p({type:String,json:{write:!0}})],yn.prototype,"name",void 0),l([p({type:Boolean,json:{write:!0}})],yn.prototype,"nullable",void 0),l([Ce(z2e)],yn.prototype,"type",void 0),l([p()],yn.prototype,"valueType",void 0),l([te("valueType",["description"])],yn.prototype,"readValueType",null),l([p({type:Boolean,json:{read:!1}})],yn.prototype,"visible",void 0),yn=J5=l([k("esri.layers.support.Field")],yn);const Po=yn;var Z5;let Ou=Z5=class extends Q{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new Z5({mapLayerId:e,gdbVersion:t})}};l([Ce({mapLayer:"map-layer"})],Ou.prototype,"type",void 0),l([p({type:Ke,json:{write:!0}})],Ou.prototype,"mapLayerId",void 0),l([p({type:String,json:{write:!0}})],Ou.prototype,"gdbVersion",void 0),Ou=Z5=l([k("esri.layers.support.source.MapLayerSource")],Ou);var Y5;let uu=Y5=class extends Q{constructor(e){super(e),this.type="query-table"}clone(){const{workspaceId:e,query:t,oidFields:r,spatialReference:i,geometryType:n}=this,s={workspaceId:e,query:t,oidFields:r,spatialReference:(i==null?void 0:i.clone())??void 0,geometryType:n};return new Y5(s)}};l([Ce({queryTable:"query-table"})],uu.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],uu.prototype,"workspaceId",void 0),l([p({type:String,json:{write:!0}})],uu.prototype,"query",void 0),l([p({type:String,json:{write:!0}})],uu.prototype,"oidFields",void 0),l([p({type:xe,json:{write:!0}})],uu.prototype,"spatialReference",void 0),l([Ce(JS)],uu.prototype,"geometryType",void 0),uu=Y5=l([k("esri.layers.support.source.QueryTableDataSource")],uu);var K5;let dy=K5=class extends Q{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new K5({workspaceId:e,dataSourceName:t})}};l([Ce({raster:"raster"})],dy.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],dy.prototype,"dataSourceName",void 0),l([p({type:String,json:{write:!0}})],dy.prototype,"workspaceId",void 0),dy=K5=l([k("esri.layers.support.source.RasterDataSource")],dy);var X5;let Wh=X5=class extends Q{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:r}=this;return new X5({workspaceId:e,gdbVersion:t,dataSourceName:r})}};l([Ce({table:"table"})],Wh.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],Wh.prototype,"workspaceId",void 0),l([p({type:String,json:{write:!0}})],Wh.prototype,"gdbVersion",void 0),l([p({type:String,json:{write:!0}})],Wh.prototype,"dataSourceName",void 0),Wh=X5=l([k("esri.layers.support.source.TableDataSource")],Wh);var Q5,eR;const H2e=Qr()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let ks=Q5=class extends Q{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,r){return B9()(e,t,r)}castLeftTableSource(e){return Tl(tR(),e)}readRightTableSource(e,t,r){return B9()(e,t,r)}castRightTableSource(e){return Tl(tR(),e)}clone(){const{leftTableKey:e,rightTableKey:t,leftTableSource:r,rightTableSource:i,joinType:n}=this,s={leftTableKey:e,rightTableKey:t,leftTableSource:(r==null?void 0:r.clone())??void 0,rightTableSource:(i==null?void 0:i.clone())??void 0,joinType:n};return new Q5(s)}};l([Ce({joinTable:"join-table"})],ks.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],ks.prototype,"leftTableKey",void 0),l([p({type:String,json:{write:!0}})],ks.prototype,"rightTableKey",void 0),l([p({json:{write:!0}})],ks.prototype,"leftTableSource",void 0),l([te("leftTableSource")],ks.prototype,"readLeftTableSource",null),l([Tt("leftTableSource")],ks.prototype,"castLeftTableSource",null),l([p({json:{write:!0}})],ks.prototype,"rightTableSource",void 0),l([te("rightTableSource")],ks.prototype,"readRightTableSource",null),l([Tt("rightTableSource")],ks.prototype,"castRightTableSource",null),l([Ce(H2e)],ks.prototype,"joinType",void 0),ks=Q5=l([k("esri.layers.support.source.JoinTableDataSource")],ks);let fM=null;function B9(){return fM||(fM=Vm({types:tR()})),fM}let yM=null;function tR(){return yM||(yM={key:"type",base:null,typeMap:{"data-layer":Wn,"map-layer":Ou}}),yM}const W2e={key:"type",base:null,typeMap:{"join-table":ks,"query-table":uu,raster:dy,table:Wh}};let Wn=eR=class extends Q{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new eR({fields:e,dataSource:t})}};l([Ce({dataLayer:"data-layer"})],Wn.prototype,"type",void 0),l([p({type:[Po],json:{write:!0}})],Wn.prototype,"fields",void 0),l([p({types:W2e,json:{write:!0}})],Wn.prototype,"dataSource",void 0),Wn=eR=l([k("esri.layers.support.source.DataLayerSource")],Wn),Wn.from=Lr(Wn);function Cn(e,t){return t?{...t,query:{...e??{},...t.query}}:{query:e}}function pr(e){return typeof e=="string"?Pt(e):B(e)}function tn(e,t,r){const i={};for(const n in e){if(n==="declaredClass")continue;const s=e[n];if(s!=null&&typeof s!="function")if(Array.isArray(s))i[n]=s.map(o=>tn({item:o},t,r).item);else if(typeof s=="object")if(s.toJSON){const o=s.toJSON(r==null?void 0:r[n]);i[n]=JSON.stringify(o)}else i[n]=JSON.stringify(s);else i[n]=s}return i}const Yb={102100:{maxX:20037508342788905e-9,minX:-20037508342788905e-9,plus180Line:new Ea({paths:[[[20037508342788905e-9,-20037508342788905e-9],[20037508342788905e-9,20037508342788905e-9]]],spatialReference:xe.WebMercator}),minus180Line:new Ea({paths:[[[-20037508342788905e-9,-20037508342788905e-9],[-20037508342788905e-9,20037508342788905e-9]]],spatialReference:xe.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Ea({paths:[[[180,-180],[180,180]]],spatialReference:xe.WGS84}),minus180Line:new Ea({paths:[[[-180,-180],[-180,180]]],spatialReference:xe.WGS84})}};function Dd(e,t){return Math.ceil((e-t)/(2*t))}function VJ(e,t){const r=F1(e);for(const i of r)for(const n of i)n[0]+=t;return e}function F1(e){return Bd(e)?e.rings:e.paths}async function J2e(e,t,r,i){const n=pr(e),s=t[0].spatialReference,o={...i,responseType:"json",query:{...n.query,f:"json",sr:Ip(s),target:JSON.stringify({geometryType:Rn(t[0]),geometries:t}),cutter:JSON.stringify(r)}},a=await be(n.path+"/cut",o),{cutIndexes:u,geometries:c=[]}=a.data;return{cutIndexes:u,geometries:c.map(h=>{const d=Xr(h);return d.spatialReference=s,d})}}function Z2e(e){return{geometryType:Rn(e[0]),geometries:e.map(t=>t.toJSON())}}function Y2e(e,t,r){const i=Ype(t);return e.map(n=>{const s=i.fromJSON(n);return s.spatialReference=r,s})}async function K2e(e,t,r){const i=typeof e=="string"?Pt(e):e,n=t[0].spatialReference,s=Rn(t[0]),o={...r,query:{...i.query,f:"json",sr:Ip(n),geometries:JSON.stringify(Z2e(t))}},{data:a}=await be(i.path+"/simplify",o);return Y2e(a.geometries,s,n)}const GJ=()=>oe.getLogger("esri.geometry.support.normalizeUtils");function X2e(e){return e.type==="polygon"}function Q2e(e){return e[0].type==="polygon"}function eSe(e){return e[0].type==="polyline"}function z9(e){const t=[];let r=0,i=0;for(let n=0;n<e.length;n++){const s=e[n];let o=null;for(let a=0;a<s.length;a++)o=s[a],t.push(o),a===0?(r=o[0],i=r):(r=Math.min(r,o[0]),i=Math.max(i,o[0]));o&&t.push([(r+i)/2,0])}return t}function tSe(e,t){if(!(e instanceof Ea||e instanceof Ss)){const n="straightLineDensify: the input geometry is neither polyline nor polygon";throw GJ().error(n),new z(n)}const r=F1(e),i=[];for(const n of r){const s=[];i.push(s),s.push([n[0][0],n[0][1]]);for(let o=0;o<n.length-1;o++){const a=n[o][0],u=n[o][1],c=n[o+1][0],h=n[o+1][1],d=Math.sqrt((c-a)*(c-a)+(h-u)*(h-u)),y=(h-u)/d,v=(c-a)/d,w=d/t;if(w>1){for(let T=1;T<=w-1;T++){const I=T*t,M=v*I+a,$=y*I+u;s.push([M,$])}const b=(d+Math.floor(w-1)*t)/2,_=v*b+a,x=y*b+u;s.push([_,x])}s.push([c,h])}}return X2e(e)?new Ss({rings:i,spatialReference:e.spatialReference}):new Ea({paths:i,spatialReference:e.spatialReference})}function q9(e,t,r){if(t){const i=tSe(e,1e6);e=Vy(i,!0)}return r&&(e=VJ(e,r)),e}function H9(e,t,r){if(Array.isArray(e)){const i=e[0];if(i>t){const n=Dd(i,t);e[0]=i+n*(-2*t)}else if(i<r){const n=Dd(i,r);e[0]=i+n*(-2*r)}}else{const i=e.x;if(i>t){const n=Dd(i,t);e=e.clone().offset(n*(-2*t),0)}else if(i<r){const n=Dd(i,r);e=e.clone().offset(n*(-2*r),0)}}return e}function rSe(e,t){let r=-1;for(let i=0;i<t.cutIndexes.length;i++){const n=t.cutIndexes[i],s=t.geometries[i],o=F1(s);for(let a=0;a<o.length;a++){const u=o[a];u.some(c=>{if(c[0]<180)return!0;{let h=0;for(let y=0;y<u.length;y++){const v=u[y][0];h=v>h?v:h}h=Number(h.toFixed(9));const d=-360*Dd(h,180);for(let y=0;y<u.length;y++){const v=s.getPoint(a,y);s.setPoint(a,y,v.clone().offset(d,0))}return!0}})}if(n===r){if(Q2e(e))for(const a of F1(s))e[n]=e[n].addRing(a);else if(eSe(e))for(const a of F1(s))e[n]=e[n].addPath(a)}else r=n,e[n]=s}return e}async function Nl(e,t,r){if(!Array.isArray(e))return Nl([e],t);t&&typeof t!="string"&&GJ().warn("normalizeCentralMeridian()","The url object is deprecated, use the url string instead");const i=typeof t=="string"?t:(t==null?void 0:t.url)??Kt.geometryServiceUrl;let n,s,o,a,u,c,h,d,y=0;const v=[],w=[];for(const M of e)if(M!=null)if(n||(n=M.spatialReference,s=Xn(n),o=n.isWebMercator,c=o?102100:4326,a=Yb[c].maxX,u=Yb[c].minX,h=Yb[c].plus180Line,d=Yb[c].minus180Line),s)if(M.type==="mesh")w.push(M);else if(M.type==="point")w.push(H9(M.clone(),a,u));else if(M.type==="multipoint"){const $=M.clone();$.points=$.points.map(A=>H9(A,a,u)),w.push($)}else if(M.type==="extent"){const $=M.clone()._normalize(!1,!1,s);w.push($.rings?new Ss($):$)}else if(M.extent){const $=M.extent,A=Dd($.xmin,u)*(2*a);let R=A===0?M.clone():VJ(M.clone(),A);$.offset(A,0),$.intersects(h)&&$.xmax!==a?(y=$.xmax>y?$.xmax:y,R=q9(R,o),v.push(R),w.push("cut")):$.intersects(d)&&$.xmin!==u?(y=$.xmax*(2*a)>y?$.xmax*(2*a):y,R=q9(R,o,360),v.push(R),w.push("cut")):w.push(R)}else w.push(M.clone());else w.push(M);else w.push(M);let b=Dd(y,a),_=-90;const x=b,T=new Ea;for(;b>0;){const M=360*b-180;T.addPath([[M,_],[M,-1*_]]),_*=-1,b--}if(v.length>0&&x>0){const M=rSe(v,await J2e(i,v,T,r)),$=[],A=[];for(let C=0;C<w.length;C++){const U=w[C];if(U!=="cut")A.push(U);else{const F=M.shift(),j=e[C];j!=null&&j.type==="polygon"&&j.rings&&j.rings.length>1&&F.rings.length>=j.rings.length?($.push(F),A.push("simplify")):A.push(o?ku(F):F)}}if(!$.length)return A;const R=await K2e(i,$,r),L=[];for(let C=0;C<A.length;C++){const U=A[C];U!=="simplify"?L.push(U):L.push(o?ku(R.shift()):R.shift())}return L}const I=[];for(let M=0;M<w.length;M++){const $=w[M];if($!=="cut")I.push($);else{const A=v.shift();I.push(o===!0?ku(A):A)}}return I}function iSe(e){if(!e)return null;const t=e.extent;if(!t)return null;const r=e.spatialReference&&Xn(e.spatialReference);if(!r)return t;const[i,n]=r.valid,s=2*n,{width:o}=t;let a,{xmin:u,xmax:c}=t;if([u,c]=[c,u],e.type==="extent"||o===0||o<=n||o>s||u<i||c>n)return t;switch(e.type){case"polygon":if(!(e.rings.length>1))return t;a=z9(e.rings);break;case"polyline":if(!(e.paths.length>1))return t;a=z9(e.paths);break;case"multipoint":a=e.points}const h=t.clone();for(let d=0;d<a.length;d++){let y=a[d][0];y<0?(y+=n,c=Math.max(y,c)):(y-=n,u=Math.min(y,u))}return h.xmin=u,h.xmax=c,h.width<o?(h.xmin-=n,h.xmax-=n,h):t}function BJ(e,t,r){const i=Xn(r);if(i==null)return e;const[n,s]=i.valid,o=2*s;let a=0,u=0;t>s?a=Math.ceil(Math.abs(t-s)/o):t<n&&(a=-Math.ceil(Math.abs(t-n)/o)),e>s?u=Math.ceil(Math.abs(e-s)/o):e<n&&(u=-Math.ceil(Math.abs(e-n)/o));let c=e+(a-u)*o;const h=c-t;return h>s?c-=o:h<n&&(c+=o),c}function eje(e,t){const r=Xn(t);if(r){const[i,n]=r.valid,s=n-i;if(e<i)for(;e<i;)e+=s;if(e>n)for(;e>n;)e-=s}return e}function zJ(e){const t={};for(const r in e){if(r==="declaredClass")continue;const i=e[r];if(i!=null&&typeof i!="function")if(Array.isArray(i)){t[r]=[];for(let n=0;n<i.length;n++)t[r][n]=zJ(i[n])}else typeof i=="object"?i.toJSON&&(t[r]=JSON.stringify(i)):t[r]=i}return t}var sp;(function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"})(sp||(sp={}));const W9=4294967296,nSe=new TextDecoder("utf-8"),sSe=Me("safari")||Me("ios")?6:Me("ff")?12:32;let rR=class P2{constructor(t,r,i=0,n=t?t.byteLength:0){this._tag=0,this._dataType=sp.unknown,this._init(t,r,i,n)}_init(t,r,i,n){this._data=t,this._dataView=r,this._pos=i,this._end=n}asUnsafe(){return this}clone(){return new P2(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t}nextTag(t){for(;;){if(this._pos===this._end)return!1;const r=this._decodeVarint();if(this._tag=r>>3,this._dataType=7&r,!t||t===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;if(t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128||(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128)||(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128)||(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128)||(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128))return t;throw new Error("Varint overflow")}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();return t>>>1^-(1&t)|0}getSInt64(){return this._decodeSVarint()}getBool(){const t=this._data[this._pos]!==0;return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,r=this._pos,i=t.getUint32(r,!0)+t.getUint32(r+4,!0)*W9;return this._skip(8),i}getSFixed64(){const t=this._dataView,r=this._pos,i=t.getUint32(r,!0)+t.getInt32(r+4,!0)*W9;return this._skip(8),i}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),r=this._pos,i=this._toString(this._data,r,r+t);return this._skip(t),i}getBytes(){const t=this._getLength(),r=this._pos,i=this._toBytes(this._data,r,r+t);return this._skip(t),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,r,i,n){const s=this.getMessage(),o=t(s,r,i,n);return s.release(),o}processMessage(t){const r=this.getMessage(),i=t(r);return r.release(),i}getMessage(){const t=this._getLength(),r=P2.pool.acquire();return r._init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),r}release(){P2.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case sp.varint:this._decodeVarint();break;case sp.fixed64:this._skip(8);break;case sp.delimited:this._skip(this._getLength());break;case sp.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(t){this._skip(t)}_skip(t){if(this._pos+t>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=t}_decodeVarint(){const t=this._data;let r=this._pos,i=0,n=0;if(this._end-r>=10)do{if(n=t[r++],i|=127&n,(128&n)==0||(n=t[r++],i|=(127&n)<<7,(128&n)==0)||(n=t[r++],i|=(127&n)<<14,(128&n)==0)||(n=t[r++],i|=(127&n)<<21,(128&n)==0)||(n=t[r++],i+=268435456*(127&n),(128&n)==0)||(n=t[r++],i+=34359738368*(127&n),(128&n)==0)||(n=t[r++],i+=4398046511104*(127&n),(128&n)==0)||(n=t[r++],i+=562949953421312*(127&n),(128&n)==0)||(n=t[r++],i+=72057594037927940*(127&n),(128&n)==0)||(n=t[r++],i+=9223372036854776e3*(127&n),(128&n)==0))break;throw new Error("Varint too long!")}while(!1);else{let s=1;for(;r!==this._end&&(n=t[r],(128&n)!=0);)++r,i+=(127&n)*s,s*=128;if(r===this._end)throw new Error("Varint overrun!");++r,i+=n*s}return this._pos=r,i}_decodeSVarint(){const t=this._data;let r,i=0,n=0;const s=1&t[this._pos];if(n=t[this._pos++],i|=127&n,(128&n)==0||(n=t[this._pos++],i|=(127&n)<<7,(128&n)==0)||(n=t[this._pos++],i|=(127&n)<<14,(128&n)==0)||(n=t[this._pos++],i|=(127&n)<<21,(128&n)==0)||(n=t[this._pos++],i+=268435456*(127&n),(128&n)==0)||(n=t[this._pos++],i+=34359738368*(127&n),(128&n)==0)||(n=t[this._pos++],i+=4398046511104*(127&n),(128&n)==0))return s?-(i+1)/2:i/2;if(r=BigInt(i),n=t[this._pos++],r+=0x2000000000000n*BigInt(127&n),(128&n)==0||(n=t[this._pos++],r+=0x100000000000000n*BigInt(127&n),(128&n)==0)||(n=t[this._pos++],r+=0x8000000000000000n*BigInt(127&n),(128&n)==0))return Number(s?-(r+1n)/2n:r/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==sp.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,r,i){if((i=Math.min(this._end,i))-r>sSe){const o=t.subarray(r,i);return nSe.decode(o)}let n="",s="";for(let o=r;o<i;++o){const a=t[o];128&a?s+="%"+a.toString(16):(n+=decodeURIComponent(s)+String.fromCharCode(a),s="")}return s.length&&(n+=decodeURIComponent(s)),n}_toBytes(t,r,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,r,i-r)}};rR.pool=new Np(rR,void 0,e=>{e._data=null,e._dataView=null});const mM=2;let Go=class Yg{constructor(t=[],r=[],i=!1){this.lengths=t??[],this.coords=r??[],this.hasIndeterminateRingOrder=i}static fromRect(t){const[r,i,n,s]=t,o=n-r,a=s-i;return new Yg([5],[r,i,o,0,0,a,-o,0,0,-a])}get isPoint(){return this.lengths.length===0}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce((t,r)=>t+r)}forEachVertex(t){let r=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const n=this.lengths[i];for(let s=0;s<n;s++)t(this.coords[mM*(s+r)],this.coords[mM*(s+r)+1]);r+=n}}deltaDecode(){const t=this.clone(),{coords:r,lengths:i}=t;let n=0;for(const s of i){for(let o=1;o<s;o++)r[2*(n+o)]+=r[2*(n+o)-2],r[2*(n+o)+1]+=r[2*(n+o)-1];n+=s}return t}clone(t){if(this.lengths.length===0)return new Yg([],[this.coords[0],this.coords[1]]);const r=(this.lengths.length===0?1:this.lengths.reduce((n,s)=>n+s))*mM,i=this.coords.slice(0,r);return t?(t.set(i),new Yg(this.lengths,t,this.hasIndeterminateRingOrder)):new Yg(Array.from(this.lengths),Array.from(i),this.hasIndeterminateRingOrder)}},yf=class iR{constructor(t=null,r={},i,n){this.geometry=t,this.attributes=r,this.centroid=i,this.objectId=n,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const t=new iR(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}clone(){var i,n;const t=(i=this.geometry)==null?void 0:i.clone(),r=new iR(t,{...this.attributes},(n=this.centroid)==null?void 0:n.clone(),this.objectId);return r.displayId=this.displayId,r.geohashX=this.geohashX,r.geohashY=this.geohashY,r}};function oSe(e){var t,r;return!!((r=(t=e.geometry)==null?void 0:t.coords)!=null&&r.length)}let qJ=class HJ{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new HJ;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}};const WJ=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];let tje=class{constructor(t){this._options=t,this.geometryTypes=WJ,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new qJ}prepareFeatures(t){this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&this._vertexDimension++}finishFeatureResult(t){if(!(t!=null&&t.features)||!t.hasZ||!this._options.sourceSpatialReference||!t.spatialReference||fi(t.spatialReference,this._options.sourceSpatialReference)||t.spatialReference.vcsWkid)return;const r=vm(this._options.sourceSpatialReference)/vm(t.spatialReference);if(r!==1)for(const i of t.features){if(!oSe(i))continue;const n=i.geometry.coords;for(let s=2;s<n.length;s+=3)n[s]*=r}}addFeature(t,r){t.features.push(r)}createFeature(){return new yf}createSpatialReference(){return{wkid:0}}createGeometry(){return new Go}addField(t,r){t.fields.push(r)}allocateCoordinates(t){t.coords.length=t.lengths.reduce((r,i)=>r+i,0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(t,r){t.coords[this._coordinatePtr++]=r}addCoordinatePoint(t,r){t.coords.push(r)}addLength(t,r){t.lengths.push(r)}addQueryGeometry(t,r){t.queryGeometry=r.queryGeometry,t.queryGeometryType=r.queryGeometryType}createPointGeometry(){return new Go}};const J9=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML","esriFieldTypeBigInteger","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"],Z9=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],Y9=["upperLeft","lowerLeft"];function K9(e){return e>=J9.length?null:J9[e]}function aSe(e){return e>=Z9.length?null:Z9[e]}function X9(e){return e>=Y9.length?null:Y9[e]}function Q9(e,t){return t>=e.geometryTypes.length?null:e.geometryTypes[t]}function lSe(e,t,r){const n=e.asUnsafe(),s=t.createPointGeometry(r);for(;n.next();)switch(n.tag()){case 3:{const o=n.getUInt32(),a=n.pos()+o;let u=0;for(;n.pos()<a;)t.addCoordinatePoint(s,n.getSInt64(),u++);break}default:n.skip()}return s}function uSe(e,t,r){const s=e.asUnsafe(),o=t.createGeometry(r),a=2+(r.hasZ?1:0)+(r.hasM?1:0);for(;s.next();)switch(s.tag()){case 2:{const u=s.getUInt32(),c=s.pos()+u;let h=0;for(;s.pos()<c;)t.addLength(o,s.getUInt32(),h++);break}case 3:{const u=s.getUInt32(),c=s.pos()+u;let h=0;for(t.allocateCoordinates(o);s.pos()<c;)t.addCoordinate(o,s.getSInt64(),h),h++,h===a&&(h=0);break}default:s.skip()}return o}function cSe(e){const n=e.asUnsafe(),s=new Go;let o="esriGeometryPoint";for(;n.next();)switch(n.tag()){case 2:{const a=n.getUInt32(),u=n.pos()+a;for(;n.pos()<u;)s.lengths.push(n.getUInt32());break}case 3:{const a=n.getUInt32(),u=n.pos()+a;for(;n.pos()<u;)s.coords.push(n.getSInt64());break}case 1:o=WJ[n.getEnum()];break;default:n.skip()}return{queryGeometry:s,queryGeometryType:o}}function pSe(e){const h=e.asUnsafe();for(;h.next();)switch(h.tag()){case 1:return h.getString();case 2:return h.getFloat();case 3:return h.getDouble();case 4:return h.getSInt32();case 5:return h.getUInt32();case 6:return h.getInt64();case 7:return h.getUInt64();case 8:return h.getSInt64();case 9:return h.getBool();default:return h.skip(),null}return null}function hSe(e){const a=e.asUnsafe(),u={type:K9(0)};for(;a.next();)switch(a.tag()){case 1:u.name=a.getString();break;case 2:u.type=K9(a.getEnum());break;case 3:u.alias=a.getString();break;case 4:u.sqlType=aSe(a.getEnum());break;case 5:a.skip();break;case 6:u.defaultValue=a.getString();break;default:a.skip()}return u}function dSe(e){const i={},n=e.asUnsafe();for(;n.next();)switch(n.tag()){case 1:i.name=n.getString();break;case 2:i.isSystemMaintained=n.getBool();break;default:n.skip()}return i}function fSe(e,t,r,i){const a=t.createFeature(r);let u=0;for(;e.next();)switch(e.tag()){case 1:{const c=i[u++].name;a.attributes[c]=e.processMessage(pSe);break}case 2:a.geometry=e.processMessageWithArgs(uSe,t,r);break;case 4:a.centroid=e.processMessageWithArgs(lSe,t,r);break;default:e.skip()}return a}function ySe(e){const s=[1,1,1,1],o=e.asUnsafe();for(;o.next();)switch(o.tag()){case 1:s[0]=o.getDouble();break;case 2:s[1]=o.getDouble();break;case 4:s[2]=o.getDouble();break;case 3:s[3]=o.getDouble();break;default:o.skip()}return s}function mSe(e){const s=[0,0,0,0],o=e.asUnsafe();for(;o.next();)switch(o.tag()){case 1:s[0]=o.getDouble();break;case 2:s[1]=o.getDouble();break;case 4:s[2]=o.getDouble();break;case 3:s[3]=o.getDouble();break;default:o.skip()}return s}function gSe(e){const n={originPosition:X9(0)},s=e.asUnsafe();for(;s.next();)switch(s.tag()){case 1:n.originPosition=X9(s.getEnum());break;case 2:n.scale=s.processMessage(ySe);break;case 3:n.translate=s.processMessage(mSe);break;default:s.skip()}return n}function vSe(e){const n={},s=e.asUnsafe();for(;s.next();)switch(s.tag()){case 1:n.shapeAreaFieldName=s.getString();break;case 2:n.shapeLengthFieldName=s.getString();break;case 3:n.units=s.getString();break;default:s.skip()}return n}function wSe(e,t){const a=t.createSpatialReference();for(;e.next();)switch(e.tag()){case 1:a.wkid=e.getUInt32();break;case 5:a.wkt=e.getString();break;case 2:a.latestWkid=e.getUInt32();break;case 3:a.vcsWkid=e.getUInt32();break;case 4:a.latestVcsWkid=e.getUInt32();break;default:e.skip()}return a}function bSe(e,t){const b=t.createFeatureResult(),_=e.asUnsafe();b.geometryType=Q9(t,0);let x=!1;for(;_.next();)switch(_.tag()){case 1:b.objectIdFieldName=_.getString();break;case 3:b.globalIdFieldName=_.getString();break;case 4:b.geohashFieldName=_.getString();break;case 5:b.geometryProperties=_.processMessage(vSe);break;case 7:b.geometryType=Q9(t,_.getEnum());break;case 8:b.spatialReference=_.processMessageWithArgs(wSe,t);break;case 10:b.hasZ=_.getBool();break;case 11:b.hasM=_.getBool();break;case 12:b.transform=_.processMessage(gSe);break;case 9:b.exceededTransferLimit=_.getBool();break;case 13:t.addField(b,_.processMessage(hSe));break;case 15:x||(t.prepareFeatures(b),x=!0),t.addFeature(b,_.processMessageWithArgs(fSe,t,b,b.fields));break;case 2:b.uniqueIdField=_.processMessage(dSe);break;default:_.skip()}return t.finishFeatureResult(b),b}function _Se(e,t){const n={};let s=null;for(;e.next();)switch(e.tag()){case 4:s=e.processMessageWithArgs(cSe);break;case 1:n.featureResult=e.processMessageWithArgs(bSe,t);break;default:e.skip()}return s!=null&&n.featureResult&&t.addQueryGeometry(n,s),n}function SSe(e,t){try{const i=new rR(new Uint8Array(e),new DataView(e)),n={};for(;i.next();)i.tag()===2?n.queryResult=i.processMessageWithArgs(_Se,t):i.skip();return n}catch(r){throw new z("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:r})}}function xSe(e,t){const r=SSe(e,t),i=r.queryResult.featureResult,n=r.queryResult.queryGeometry,s=r.queryResult.queryGeometryType;if(i&&i.features&&i.features.length&&i.objectIdFieldName){const o=i.objectIdFieldName;for(const a of i.features)a.attributes&&(a.objectId=a.attributes[o])}return i&&(i.queryGeometry=n,i.queryGeometryType=s),i}function nR(e,t,r){if(!(r!=null&&r.features)||!r.hasZ)return;const i=G4(r.geometryType,t,e.outSpatialReference);if(i!=null)for(const n of r.features)i(n.geometry)}const ej="Layer does not support extent calculation.";function TSe(e,t){if(t&&e.type==="extent")return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&e.type==="point")return`${e.x},${e.y}`;const r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}function ISe(e,t){var u;const r=e.geometry,i=e.toJSON();delete i.compactGeometryEnabled,delete i.defaultSpatialReferenceEnabled;const n=i;let s,o,a;if(r!=null&&(o=r.spatialReference,a=Ip(o),n.geometryType=Rn(r),n.geometry=TSe(r,e.compactGeometryEnabled),n.inSR=a),i.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=i.groupByFieldsForStatistics.join(",")),i.objectIds&&(n.objectIds=i.objectIds.join(",")),i.orderByFields&&(n.orderByFields=i.orderByFields.join(",")),!i.outFields||!i.returnDistinctValues&&(t!=null&&t.returnCountOnly||t!=null&&t.returnExtentOnly||t!=null&&t.returnIdsOnly)?delete n.outFields:i.outFields.includes("*")?n.outFields="*":n.outFields=i.outFields.join(","),i.outSR?(n.outSR=Ip(i.outSR),s=e.outSpatialReference):r&&(i.returnGeometry||i.returnCentroid)&&(n.outSR=n.inSR,s=o),i.returnGeometry&&delete i.returnGeometry,i.outStatistics&&(n.outStatistics=JSON.stringify(i.outStatistics)),i.fullText&&(n.fullText=JSON.stringify(i.fullText)),i.pixelSize&&(n.pixelSize=JSON.stringify(i.pixelSize)),i.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&o!=null&&((u=e.quantizationParameters)==null?void 0:u.extent)!=null&&o.equals(e.quantizationParameters.extent.spatialReference)&&delete i.quantizationParameters.extent.spatialReference,n.quantizationParameters=JSON.stringify(i.quantizationParameters)),i.parameterValues&&(n.parameterValues=JSON.stringify(i.parameterValues)),i.rangeValues&&(n.rangeValues=JSON.stringify(i.rangeValues)),i.dynamicDataSource&&(n.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i.timeExtent){const c=i.timeExtent,{start:h,end:d}=c;h==null&&d==null||(n.time=h===d?h:`${h??"null"},${d??"null"}`),delete i.timeExtent}return e.defaultSpatialReferenceEnabled&&o!=null&&s!=null&&o.equals(s)&&(n.defaultSR=n.inSR,delete n.inSR,delete n.outSR),n}async function MSe(e,t,r,i){const n=t.timeExtent!=null&&t.timeExtent.isEmpty?{data:{features:[]}}:await lw(e,t,"json",i);return nR(t,r,n.data),n}async function $Se(e,t,r,i){if(t.timeExtent!=null&&t.timeExtent.isEmpty)return{data:r.createFeatureResult()};const n=await ESe(e,t,i),s=n;return s.data=xSe(n.data,r),s}function ESe(e,t,r){return lw(e,t,"pbf",r)}function ASe(e,t,r){return t.timeExtent!=null&&t.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):lw(e,t,"json",r,{returnIdsOnly:!0})}function RSe(e,t,r){return t.timeExtent!=null&&t.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):lw(e,t,"json",r,{returnIdsOnly:!0,returnCountOnly:!0})}async function CSe(e,t,r){if(t.timeExtent!=null&&t.timeExtent.isEmpty)return{data:{count:0,extent:null}};const i=await lw(e,t,"json",r,{returnExtentOnly:!0,returnCountOnly:!0}),n=i.data;if(n.hasOwnProperty("extent"))return i;if(n.features)throw new Error(ej);if(n.hasOwnProperty("count"))throw new Error(ej);return i}async function lw(e,t,r,i={},n={}){const s=typeof e=="string"?Pt(e):e,o=t.geometry?[t.geometry]:[],a=await Nl(o,null,{signal:i.signal}),u=a==null?void 0:a[0];u!=null&&((t=t.clone()).geometry=u);const c=zJ({...s.query,f:r,...n,...ISe(t,n)});return be(jo(s.path,OSe(t,n)?"query3d":"query"),{...i,responseType:r==="pbf"?"array-buffer":"json",query:{...c,...i.query}})}function OSe(e,t){return e.formatOf3DObjects!=null&&!(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)}let Jh=class extends It(Q){constructor(t){super(t),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};l([p({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.onFields!=null&&this.onFields.length>0}}}}})],Jh.prototype,"onFields",void 0),l([p({type:String,json:{write:!0}})],Jh.prototype,"operator",void 0),l([p({type:String,json:{write:!0}})],Jh.prototype,"searchTerm",void 0),l([p({type:String,json:{write:!0}})],Jh.prototype,"searchType",void 0),Jh=l([k("esri.rest.support.FullTextSearch")],Jh);const PSe=Jh;var sR;const tj=new We({upperLeft:"upper-left",lowerLeft:"lower-left"});let Zh=sR=class extends Q{constructor(e){super(e),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new sR(B({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};l([p({type:Ne,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Zh.prototype,"extent",void 0),l([p({type:["view","edit"],json:{write:!0}})],Zh.prototype,"mode",void 0),l([p({type:String,json:{read:tj.read,write:tj.write}})],Zh.prototype,"originPosition",void 0),l([p({type:Number,json:{write:{overridePolicy(){return{enabled:this.mode==="view"}}}}})],Zh.prototype,"tolerance",void 0),Zh=sR=l([k("esri.rest.support.QuantizationParameters")],Zh);const JJ=Zh,ZJ=new We({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"});var oR;const rj=new We({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let la=oR=class extends Q{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){this.statisticType!=="percentile-continuous"&&this.statisticType!=="percentile-discrete"||(t.statisticParameters=B(e))}clone(){return new oR({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:B(this.statisticParameters)})}};l([p({type:Number,json:{write:!0}})],la.prototype,"maxPointCount",void 0),l([p({type:Number,json:{write:!0}})],la.prototype,"maxRecordCount",void 0),l([p({type:Number,json:{write:!0}})],la.prototype,"maxVertexCount",void 0),l([p({type:String,json:{write:!0}})],la.prototype,"onStatisticField",void 0),l([p({type:String,json:{write:!0}})],la.prototype,"outStatisticFieldName",void 0),l([p({type:String,json:{read:{source:"statisticType",reader:rj.read},write:{target:"statisticType",writer:rj.write}}})],la.prototype,"statisticType",void 0),l([p({type:Object})],la.prototype,"statisticParameters",void 0),l([se("statisticParameters")],la.prototype,"writeStatisticParameters",null),la=oR=l([k("esri.rest.support.StatisticDefinition")],la);const LSe=la;var L2;const kSe=new We({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let Be=L2=class extends Q{static from(e){return rr(L2,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return typeof e=="number"||typeof e=="object"?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const r={};for(const i in e){const n=e[i];Array.isArray(n)?r[i]=n.map(s=>s instanceof Date?s.getTime():s):n instanceof Date?r[i]=n.getTime():r[i]=n}t.parameterValues=r}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new L2(B({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:this.historicMoment!=null?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};Be.MAX_MAX_RECORD_COUNT_FACTOR=5,l([p({json:{write:!0}})],Be.prototype,"aggregateIds",void 0),l([p({type:Boolean,json:{write:!0}})],Be.prototype,"cacheHint",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"compactGeometryEnabled",void 0),l([p({json:{write:!0}})],Be.prototype,"datumTransformation",void 0),l([Tt("datumTransformation")],Be.prototype,"castDatumTransformation",null),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"defaultSpatialReferenceEnabled",void 0),l([p({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],Be.prototype,"distance",void 0),l([p({type:Wn,json:{write:!0}})],Be.prototype,"dynamicDataSource",void 0),l([p({type:String,json:{write:!0}})],Be.prototype,"formatOf3DObjects",void 0),l([p({type:[PSe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.fullText!=null&&this.fullText.length>0}}}}})],Be.prototype,"fullText",void 0),l([p({type:String,json:{write:!0}})],Be.prototype,"gdbVersion",void 0),l([p({types:Vi,json:{read:Xr,write:!0}})],Be.prototype,"geometry",void 0),l([p({type:Number,json:{write:!0}})],Be.prototype,"geometryPrecision",void 0),l([p({type:[String],json:{write:!0}})],Be.prototype,"groupByFieldsForStatistics",void 0),l([p({type:String,json:{write:!0}})],Be.prototype,"having",void 0),l([p({type:Date})],Be.prototype,"historicMoment",void 0),l([se("historicMoment")],Be.prototype,"writeHistoricMoment",null),l([p({type:Number,json:{write:!0}})],Be.prototype,"maxAllowableOffset",void 0),l([p({type:Number,cast:e=>e<1?1:e>Be.MAX_MAX_RECORD_COUNT_FACTOR?Be.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],Be.prototype,"maxRecordCountFactor",void 0),l([p({type:["xyFootprint"],json:{write:!0}})],Be.prototype,"multipatchOption",void 0),l([p({type:Number,json:{read:{source:"resultRecordCount"}}})],Be.prototype,"num",void 0),l([p({json:{write:!0}})],Be.prototype,"objectIds",void 0),l([p({type:[String],json:{write:!0}})],Be.prototype,"orderByFields",void 0),l([p({type:[String],json:{write:!0}})],Be.prototype,"outFields",void 0),l([p({type:xe,json:{name:"outSR",write:!0}})],Be.prototype,"outSpatialReference",void 0),l([p({type:[LSe],json:{write:{enabled:!0,overridePolicy(){return{enabled:this.outStatistics!=null&&this.outStatistics.length>0}}}}})],Be.prototype,"outStatistics",void 0),l([p({json:{write:!0}})],Be.prototype,"parameterValues",void 0),l([se("parameterValues")],Be.prototype,"writeParameterValues",null),l([p({type:Ae,json:{write:!0}})],Be.prototype,"pixelSize",void 0),l([p({type:JJ,json:{write:!0}})],Be.prototype,"quantizationParameters",void 0),l([p({type:[Object],json:{write:!0}})],Be.prototype,"rangeValues",void 0),l([p({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:this.spatialRelationship==="relation"}}}}})],Be.prototype,"relationParameter",void 0),l([p({type:String,json:{write:!0}})],Be.prototype,"resultType",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"returnCentroid",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"returnDistinctValues",void 0),l([p({type:Boolean,json:{default:!0,write:!0}})],Be.prototype,"returnExceededLimitFeatures",void 0),l([p({type:Boolean,json:{write:!0}})],Be.prototype,"returnGeometry",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"returnQueryGeometry",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"returnM",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Be.prototype,"returnZ",void 0),l([p({type:xe,json:{write:!0}})],Be.prototype,"sourceSpatialReference",void 0),l([Ce(ZJ,{ignoreUnknown:!1,name:"spatialRel"})],Be.prototype,"spatialRelationship",void 0),l([p({type:Number,json:{read:{source:"resultOffset"}}})],Be.prototype,"start",void 0),l([se("start"),se("num")],Be.prototype,"writeStart",null),l([p({type:String,json:{write:!0}})],Be.prototype,"sqlFormat",void 0),l([p({type:String,json:{write:!0}})],Be.prototype,"text",void 0),l([p({type:is,json:{write:!0}})],Be.prototype,"timeExtent",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],Be.prototype,"timeReferenceUnknownClient",void 0),l([Ce(kSe,{ignoreUnknown:!1}),p({json:{write:{overridePolicy(e){return{enabled:!!e&&this.distance!=null&&this.distance>0}}}}})],Be.prototype,"units",void 0),l([p({type:String,json:{write:{overridePolicy(e){return{enabled:e!=null||this.start!=null&&this.start>0}}}}})],Be.prototype,"where",void 0),l([se("where")],Be.prototype,"writeWhere",null),Be=L2=l([k("esri.rest.support.Query")],Be);const $i=Be;async function YJ(e,t,r){const i=pr(e);return RSe(i,$i.from(t),{...r}).then(n=>n.data.count)}async function NSe(e,t,r){const i=pr(e),n=await CSe(i,$i.from(t),{...r}),s=n.data.extent;return!s||isNaN(s.xmin)||isNaN(s.ymin)||isNaN(s.xmax)||isNaN(s.ymax)?{count:n.data.count,extent:null}:{count:n.data.count,extent:Ne.fromJSON(s)}}async function KJ(e,t,r){const i=pr(e);return ASe(i,$i.from(t),{...r}).then(n=>n.data.objectIds)}var aR;const lR=new We({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let Li=aR=class extends Q{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){var n;const r=xe.fromJSON(t.spatialReference),i=[];for(let s=0;s<e.length;s++){const o=e[s],a=Da.fromJSON(o),u=(n=o.geometry)==null?void 0:n.spatialReference;a.geometry==null||u||(a.geometry.spatialReference=r);const c=o.aggregateGeometries,h=a.aggregateGeometries;if(c&&h!=null)for(const d in h){const y=h[d],v=c[d],w=v==null?void 0:v.spatialReference;y==null||w||(y.spatialReference=r)}i.push(a)}return i}writeGeometryType(e,t,r,i){if(e)return void lR.write(e,t,r,i);const{features:n}=this;if(n){for(const s of n)if((s==null?void 0:s.geometry)!=null)return void lR.write(s.geometry.type,t,r,i)}}readQueryGeometry(e,t){if(!e)return null;const r=!!e.spatialReference,i=Xr(e);return i&&!r&&t.spatialReference&&(i.spatialReference=xe.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:r}=this;if(r){for(const i of r)if(i&&i.geometry!=null&&i.geometry.spatialReference)return void(t.spatialReference=i.geometry.spatialReference.toJSON())}}clone(){return new aR(this.cloneProperties())}cloneProperties(){return B({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let r=0;r<t.features.length;r++){const i=t.features[r];if(i.geometry){const n=e==null?void 0:e[r];i.geometry=(n==null?void 0:n.toJSON())||i.geometry}}return t}quantize(e){const{scale:[t,r],translate:[i,n]}=e,s=c=>Math.round((c-i)/t),o=c=>Math.round((n-c)/r),a=this.features,u=this._getQuantizationFunction(this.geometryType,s,o);for(let c=0,h=a.length;c<h;c++)u!=null&&u(a[c].geometry)||(a.splice(c,1),c--,h--);return this.transform=e,this}unquantize(){var y,v;const{geometryType:e,features:t,transform:r}=this;if(!r)return this;const{translate:[i,n],scale:[s,o]}=r,a=w=>w*s+i,u=w=>n-w*o;let c=null,h=null;if(this.hasZ&&((y=r==null?void 0:r.scale)==null?void 0:y[2])!=null){const{translate:[,,w],scale:[,,b]}=r;c=_=>_*b+w}if(this.hasM&&((v=r==null?void 0:r.scale)==null?void 0:v[3])!=null){const{translate:[,,,w],scale:[,,,b]}=r;h=_=>_==null?_:_*b+w}const d=this._getHydrationFunction(e,a,u,c,h);for(const{geometry:w}of t)w!=null&&d&&d(w);return this.transform=null,this}_quantizePoints(e,t,r){let i,n;const s=[];for(let o=0,a=e.length;o<a;o++){const u=e[o];if(o>0){const c=t(u[0]),h=r(u[1]);c===i&&h===n||(s.push([c-i,h-n]),i=c,n=h)}else i=t(u[0]),n=r(u[1]),s.push([i,n])}return s.length>0?s:null}_getQuantizationFunction(e,t,r){return e==="point"?i=>(i.x=t(i.x),i.y=r(i.y),i):e==="polyline"||e==="polygon"?i=>{const n=Bd(i)?i.rings:i.paths,s=[];for(let o=0,a=n.length;o<a;o++){const u=n[o],c=this._quantizePoints(u,t,r);c&&s.push(c)}return s.length>0?(Bd(i)?i.rings=s:i.paths=s,i):null}:e==="multipoint"?i=>{const n=this._quantizePoints(i.points,t,r);return n&&n.length>0?(i.points=n,i):null}:e==="extent"?i=>i:null}_getHydrationFunction(e,t,r,i,n){return e==="point"?s=>{s.x=t(s.x),s.y=r(s.y),i&&(s.z=i(s.z))}:e==="polyline"||e==="polygon"?s=>{const o=Bd(s)?s.rings:s.paths;let a,u;for(let c=0,h=o.length;c<h;c++){const d=o[c];for(let y=0,v=d.length;y<v;y++){const w=d[y];y>0?(a+=w[0],u+=w[1]):(a=w[0],u=w[1]),w[0]=t(a),w[1]=r(u)}}if(i&&n)for(let c=0,h=o.length;c<h;c++){const d=o[c];for(let y=0,v=d.length;y<v;y++){const w=d[y];w[2]=i(w[2]),w[3]=n(w[3])}}else if(i)for(let c=0,h=o.length;c<h;c++){const d=o[c];for(let y=0,v=d.length;y<v;y++){const w=d[y];w[2]=i(w[2])}}else if(n)for(let c=0,h=o.length;c<h;c++){const d=o[c];for(let y=0,v=d.length;y<v;y++){const w=d[y];w[2]=n(w[2])}}}:e==="extent"?s=>{s.xmin=t(s.xmin),s.ymin=r(s.ymin),s.xmax=t(s.xmax),s.ymax=r(s.ymax),i&&s.zmax!=null&&s.zmin!=null&&(s.zmax=i(s.zmax),s.zmin=i(s.zmin)),n&&s.mmax!=null&&s.mmin!=null&&(s.mmax=n(s.mmax),s.mmin=n(s.mmin))}:e==="multipoint"?s=>{const o=s.points;let a,u;for(let c=0,h=o.length;c<h;c++){const d=o[c];c>0?(a+=d[0],u+=d[1]):(a=d[0],u=d[1]),d[0]=t(a),d[1]=r(u)}if(i&&n)for(let c=0,h=o.length;c<h;c++){const d=o[c];d[2]=i(d[2]),d[3]=n(d[3])}else if(i)for(let c=0,h=o.length;c<h;c++){const d=o[c];d[2]=i(d[2])}else if(n)for(let c=0,h=o.length;c<h;c++){const d=o[c];d[2]=n(d[2])}}:null}};l([p({type:String,json:{write:!0}})],Li.prototype,"displayFieldName",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Li.prototype,"exceededTransferLimit",void 0),l([p({type:[Da],json:{write:!0}})],Li.prototype,"features",void 0),l([te("features")],Li.prototype,"readFeatures",null),l([p({type:[Po],json:{write:!0}})],Li.prototype,"fields",void 0),l([p({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:lR.read}}})],Li.prototype,"geometryType",void 0),l([se("geometryType")],Li.prototype,"writeGeometryType",null),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Li.prototype,"hasM",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],Li.prototype,"hasZ",void 0),l([p({types:Vi,json:{write:!0}})],Li.prototype,"queryGeometry",void 0),l([te("queryGeometry")],Li.prototype,"readQueryGeometry",null),l([p({type:xe,json:{write:!0}})],Li.prototype,"spatialReference",void 0),l([se("spatialReference")],Li.prototype,"writeSpatialReference",null),l([p({json:{write:!0}})],Li.prototype,"transform",void 0),Li=aR=l([k("esri.rest.support.FeatureSet")],Li),Li.prototype.toJSON.isDefaultToJSON=!0;const Tf=Li;async function DSe(e,t,r){const i=await XJ(e,t,r);return Tf.fromJSON(i)}async function XJ(e,t,r){const i=pr(e),n={...r},s=$i.from(t),{data:o}=await MSe(i,s,s.sourceSpatialReference,n);return o}function en(e,t){return e?t?4:3:t?3:2}const uw=()=>oe.getLogger("esri.layers.graphics.featureConversionUtils"),QJ={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},FSe=(e,t,r,i,n,s)=>{e[r]=n,e[r+1]=s},ij=(e,t,r,i,n,s)=>{e[r]=n,e[r+1]=s,e[r+2]=t[i+2]},jSe=(e,t,r,i,n,s)=>{e[r]=n,e[r+1]=s,e[r+2]=t[i+3]},USe=(e,t,r,i,n,s)=>{e[r]=n,e[r+1]=s,e[r+2]=t[i+2],e[r+3]=t[i+3]};function hP(e,t,r,i){if(e){if(r)return t&&i?USe:ij;if(t&&i)return jSe}else if(t&&i)return ij;return FSe}function gM({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function vM({scale:e,translate:t},r){return Math.round((t[1]-r)/e[1])}function wM({scale:e,translate:t},r,i){return r*e[i]+t[i]}function nje(e,t,r){return e?t?r?yP(e):dP(e):r?fP(e):UT(e):null}function UT(e){const t=e.coords;return{x:t[0],y:t[1]}}function eZ(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function dP(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function VSe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function fP(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function GSe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function yP(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function BSe(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function zSe(e,t,r,i){let n=UT;r&&i?n=yP:r?n=dP:i&&(n=fP);for(const s of t){const{geometry:o,attributes:a}=s,u=o!=null?n(o):null;e.push({attributes:a,geometry:u})}return e}function mP(e,t){return e&&t?BSe:e?VSe:t?GSe:eZ}function qSe(e,t,r,i,n){const s=mP(r,i);for(const{geometry:o,attributes:a}of t){const u=o!=null?s(new Go,o):null;e.push(new yf(u,a,null,n?a[n]:void 0))}return e}function HSe(e,t,r=mP(t.z!=null,t.m!=null)){return r(e,t)}function WSe(e,t,r,i){for(const{geometry:n,attributes:s}of t)e.push({attributes:s,geometry:n!=null?tZ(n,r,i):null});return e}function tZ(e,t,r){if(e==null)return null;const i=en(t,r),n=[];for(let s=0;s<e.coords.length;s+=i){const o=[];for(let a=0;a<i;a++)o.push(e.coords[s+a]);n.push(o)}return t?r?{points:n,hasZ:t,hasM:r}:{points:n,hasZ:t}:r?{points:n,hasM:r}:{points:n}}function JSe(e,t,r,i,n){const s=en(r,i);for(const{geometry:o,attributes:a}of t){const u=o!=null?rZ(new Go,o,s):null;e.push(new yf(u,a,null,n?a[n]:void 0))}return e}function rZ(e,t,r=en(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const i=e.coords;let n=0;for(const s of t.points)for(let o=0;o<r;o++)i[n++]=s[o];return e}function ZSe(e,t,r,i){for(const{geometry:n,attributes:s}of t)e.push({attributes:s,geometry:n!=null?iZ(n,r,i):null});return e}function iZ(e,t,r){if(!e)return null;const i=en(t,r),{coords:n,lengths:s}=e,o=[];let a=0;for(const u of s){const c=[];for(let h=0;h<u;h++){const d=[];for(let y=0;y<i;y++)d.push(n[a++]);c.push(d)}o.push(c)}return t?r?{paths:o,hasZ:t,hasM:r}:{paths:o,hasZ:t}:r?{paths:o,hasM:r}:{paths:o}}function YSe(e,t,r,i,n){const s=en(r,i);for(const{geometry:o,attributes:a,centroid:u}of t){const c=o!=null?nZ(new Go,o,s):null,h=u!=null?HSe(new Go,u):null;e.push(new yf(c,a,h,n?a[n]:void 0))}return e}function nZ(e,t,r=en(t.hasZ,t.hasM)){const{lengths:i,coords:n}=e;let s=0;for(const o of t.paths){for(const a of o)for(let u=0;u<r;u++)n[s++]=a[u];i.push(o.length)}return e}function KSe(e,t,r,i){for(const{geometry:n,attributes:s,centroid:o}of t){const a=n!=null?sZ(n,r,i):null;if(o!=null){const u=UT(o);e.push({attributes:s,centroid:u,geometry:a})}else e.push({attributes:s,geometry:a})}return e}function sZ(e,t,r){if(!e)return null;const i=en(t,r),{coords:n,lengths:s}=e,o=[];let a=0;for(const u of s){const c=[];for(let h=0;h<u;h++){const d=[];for(let y=0;y<i;y++)d.push(n[a++]);c.push(d)}o.push(c)}return t?r?{rings:o,hasZ:t,hasM:r}:{rings:o,hasZ:t}:r?{rings:o,hasM:r}:{rings:o}}function XSe(e,t,r,i,n){for(const{geometry:s,centroid:o,attributes:a}of t){const u=s!=null?oZ(new Go,s,r,i):null,c=n?a[n]:void 0;o!=null?e.push(new yf(u,a,eZ(new Go,o),c)):e.push(new yf(u,a,null,c))}return e}function oZ(e,t,r=t.hasZ,i=t.hasM){return QSe(e,t.rings,r,i)}function QSe(e,t,r,i){const n=en(r,i),{lengths:s,coords:o}=e;let a=0;Fu(e);for(const u of t){for(const c of u)for(let h=0;h<n;h++)o[a++]=c[h];s.push(u.length)}return e}const om=[],j1=[];function sje(e,t,r,i,n){om[0]=e;const[s]=aZ(j1,om,t,r,i,n);return Fa(om),Fa(j1),s}function aZ(e,t,r,i,n,s){if(Fa(e),!r){for(const o of t){const a=s?o.attributes[s]:void 0;e.push(new yf(null,o.attributes,null,a))}return e}switch(r){case"esriGeometryPoint":return qSe(e,t,i,n,s);case"esriGeometryMultipoint":return JSe(e,t,i,n,s);case"esriGeometryPolyline":return YSe(e,t,i,n,s);case"esriGeometryPolygon":return XSe(e,t,i,n,s);default:uw().error("convertToFeatureSet:unknown-geometry",new z(`Unable to parse unknown geometry type '${r}'`)),Fa(e)}return e}function oje(e,t,r,i){j1[0]=e,uZ(om,j1,t,r,i);const n=om[0];return Fa(om),Fa(j1),n}function aje(e,t,r){if(e==null)return null;const i=new Go;return"hasZ"in e&&t==null&&(t=e.hasZ),"hasM"in e&&r==null&&(r=e.hasM),zO(e)?mP(t??e.z!=null,r??e.m!=null)(i,e):Bd(e)?oZ(i,e,t,r):qO(e)?nZ(i,e,en(t,r)):BO(e)?rZ(i,e,en(t,r)):void uw().error("convertFromGeometry:unknown-geometry",new z(`Unable to parse unknown geometry type '${e}'`))}function lZ(e,t,r,i){const n=e&&("coords"in e?e:e.geometry);if(n==null)return null;switch(t){case"esriGeometryPoint":{let s=UT;return r&&i?s=yP:r?s=dP:i&&(s=fP),s(n)}case"esriGeometryMultipoint":return tZ(n,r,i);case"esriGeometryPolyline":return iZ(n,r,i);case"esriGeometryPolygon":return sZ(n,r,i);default:return uw().error("convertToGeometry:unknown-geometry",new z(`Unable to parse unknown geometry type '${t}'`)),null}}function exe(e,t){for(const r of t)e.push({attributes:r.attributes});return e}function uZ(e,t,r,i,n){if(Fa(e),r==null)return exe(e,t);switch(r){case"esriGeometryPoint":return zSe(e,t,i,n);case"esriGeometryMultipoint":return WSe(e,t,i,n);case"esriGeometryPolyline":return ZSe(e,t,i,n);case"esriGeometryPolygon":return KSe(e,t,i,n);default:uw().error("convertToFeatureSet:unknown-geometry",new z(`Unable to parse unknown geometry type '${r}'`))}return e}function lje(e){const{objectIdFieldName:t,spatialReference:r,transform:i,fields:n,hasM:s,hasZ:o,features:a,geometryType:u,exceededTransferLimit:c,uniqueIdField:h,queryGeometry:d,queryGeometryType:y}=e,v={features:uZ([],a,u,o,s),fields:n,geometryType:u,objectIdFieldName:t,spatialReference:r,uniqueIdField:h,queryGeometry:lZ(d,y,!1,!1)};return i&&(v.transform=i),c&&(v.exceededTransferLimit=c),s&&(v.hasM=s),o&&(v.hasZ=o),v}function uje(e,t){const r=new qJ,{hasM:i,hasZ:n,features:s,objectIdFieldName:o,spatialReference:a,geometryType:u,exceededTransferLimit:c,transform:h,fields:d}=e;return d&&(r.fields=d),r.geometryType=u??null,r.objectIdFieldName=o??t??null,r.spatialReference=a??null,r.objectIdFieldName?(s&&aZ(r.features,s,u,n,i,r.objectIdFieldName),c&&(r.exceededTransferLimit=c),i&&(r.hasM=i),n&&(r.hasZ=n),h&&(r.transform=h),r):(uw().error(new z("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function cje(e){const{transform:t,features:r,hasM:i,hasZ:n}=e;if(!t)return e;for(const s of r)s.geometry!=null&&cR(s.geometry,s.geometry,i,n,t),s.centroid!=null&&cR(s.centroid,s.centroid,i,n,t);return e.transform=null,e}function pje(e,t){const{geometryType:r,features:i,hasM:n,hasZ:s}=t;if(!e)return t;for(let o=0;o<i.length;o++){const a=i[o],u=a.weakClone();u.geometry=new Go,nj(u.geometry,a.geometry,n,s,r,e),a.centroid&&(u.centroid=new Go,nj(u.centroid,a.centroid,n,s,"esriGeometryPoint",e)),i[o]=u}return t.transform=e,t}function nj(e,t,r,i,n,s,o=r,a=i){if(Fu(e),!(t!=null&&t.coords.length))return null;const u=QJ[n],{coords:c,lengths:h}=t,d=en(r,i),y=en(r&&o,i&&a),v=hP(r,i,o,a);if(!h.length)return v(e.coords,c,0,0,gM(s,c[0]),vM(s,c[1])),Fu(e,d,0),e;let w,b,_,x,T=0,I=0,M=I;for(const $ of h){if($<u)continue;let A=0;I=M,_=w=gM(s,c[T]),x=b=vM(s,c[T+1]),v(e.coords,c,I,T,_,x),A++,T+=d,I+=y;for(let R=1;R<$;R++,T+=d)_=gM(s,c[T]),x=vM(s,c[T+1]),_===w&&x===b||(v(e.coords,c,I,T,_-w,x-b),I+=y,A++,w=_,b=x);A>=u&&(e.lengths.push(A),M=I)}return Fa(e.coords,M),e.coords.length?e:null}function hje(e,t,r,i,n,s,o=r,a=i){if(Fu(e),!(t!=null&&t.coords.length))return null;const u=QJ[n],{coords:c,lengths:h}=t,d=en(r,i),y=en(r&&o,i&&a),v=hP(r,i,o,a);if(!h.length)return v(e.coords,c,0,0,c[0],c[1]),Fu(e,d,0),e;let w=0;const b=s*s;for(const _ of h){if(_<u){w+=_*d;continue}const x=e.coords.length/y,T=w,I=w+(_-1)*d;v(e.coords,c,e.coords.length,T,c[T],c[T+1]),uR(e.coords,c,d,b,v,T,I),v(e.coords,c,e.coords.length,I,c[I],c[I+1]);const M=e.coords.length/y-x;M>=u?e.lengths.push(M):Fa(e.coords,x*y),w+=_*d}return e.coords.length?e:null}function txe(e,t,r,i){const n=e[t],s=e[t+1],o=e[r],a=e[r+1],u=e[i],c=e[i+1];let h=o,d=a,y=u-h,v=c-d;if(y!==0||v!==0){const w=((n-h)*y+(s-d)*v)/(y*y+v*v);w>1?(h=u,d=c):w>0&&(h+=y*w,d+=v*w)}return y=n-h,v=s-d,y*y+v*v}function uR(e,t,r,i,n,s,o){let a,u=i,c=0;for(let h=s+r;h<o;h+=r)a=txe(t,h,s,o),a>u&&(c=h,u=a);u>i&&(c-s>r&&uR(e,t,r,i,n,s,c),n(e,t,e.length,c,t[c],t[c+1]),o-c>r&&uR(e,t,r,i,n,c,o))}function dje(e,t,r,i){var c;if(!((c=t==null?void 0:t.coords)!=null&&c.length))return null;const n=en(r,i);let s=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,u=Number.NEGATIVE_INFINITY;if(t&&t.coords){const h=t.coords;for(let d=0;d<h.length;d+=n){const y=h[d],v=h[d+1];s=Math.min(s,y),a=Math.max(a,y),o=Math.min(o,v),u=Math.max(u,v)}}return JE(e)?ome(e,s,o,a,u):cB(s,o,a,u,e),e}function cR(e,t,r,i,n){const{coords:s,lengths:o}=t,a=en(r,i);if(!s.length)return e!==t&&Fu(e),e;wp(n);const{originPosition:u,scale:c,translate:h}=n,d=ixe;d.originPosition=u;const y=d.scale;y[0]=c[0]??1,y[1]=-(c[1]??1),y[2]=c[2]??1,y[3]=c[3]??1;const v=d.translate;if(v[0]=h[0]??0,v[1]=h[1]??0,v[2]=h[2]??0,v[3]=h[3]??0,!o.length){for(let b=0;b<a;++b)e.coords[b]=wM(d,s[b],b);return e!==t&&Fu(e,a,0),e}let w=0;for(let b=0;b<o.length;b++){const _=o[b];e.lengths[b]=_;for(let I=0;I<a;++I)e.coords[w+I]=wM(d,s[w+I],I);let x=e.coords[w],T=e.coords[w+1];w+=a;for(let I=1;I<_;I++,w+=a){x+=s[w]*y[0],T+=s[w+1]*y[1],e.coords[w]=x,e.coords[w+1]=T;for(let M=2;M<a;++M)e.coords[w+M]=wM(d,s[w+M],M)}}return e!==t&&Fu(e,s.length,o.length),e}function fje(e,t,r,i,n,s){if(Fu(e),e.lengths.push(...t.lengths),r===n&&i===s)for(let o=0;o<t.coords.length;o++)e.coords.push(t.coords[o]);else{const o=en(r,i),a=hP(r,i,n,s),u=t.coords;for(let c=0;c<u.length;c+=o)a(e.coords,u,e.coords.length,c,u[c],u[c+1])}return e}function rxe(e,t,r,i){let n=0,s=e[i*t],o=e[i*(t+1)];for(let a=1;a<r;a++){const u=s+e[i*(t+a)],c=o+e[i*(t+a)+1],h=(u-s)*(c+o);s=u,o=c,n+=h}return .5*n}function yje(e,t){const{coords:r,lengths:i}=e;let n=0,s=0;for(let o=0;o<i.length;o++){const a=i[o];s+=rxe(r,n,a,t),n+=a}return Math.abs(s)}function Fu(e,t=0,r=0){Fa(e.lengths,r),Fa(e.coords,t)}function Fa(e,t=0){e.length!==t&&(e.length=t)}const ixe={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};function nxe(e,t){return t}function gP(e,t,r,i){switch(r){case 0:return vv(e,t+i,0);case 1:return e.originPosition==="lowerLeft"?vv(e,t+i,1):axe(e,t+i,1)}}function cZ(e,t,r,i){return r===2?vv(e,t,2):gP(e,t,r,i)}function sxe(e,t,r,i){return r===2?t===0?0:vv(e,t,3):gP(e,t,r,i)}function oxe(e,t,r,i){return r===3?t===0?0:vv(e,t,3):cZ(e,t,r,i)}function vv({translate:e,scale:t},r,i){return e[i]+r*t[i]}function axe({translate:e,scale:t},r,i){return e[i]-r*t[i]}let lxe=class{constructor(t){this._options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this._previousCoordinate=[0,0],this._transform=null,this._applyTransform=nxe,this._lengths=[],this._currentLengthIndex=0,this._toAddInCurrentPath=0,this._vertexDimension=0,this._mValueOffset=null,this._coordinateBuffer=null,this._coordinateBufferPtr=0,this._attributesConstructor=class{}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this._options.applyTransform&&(t.transform=null),this._attributesConstructor=class{},this._coordinateBuffer=null,this._lengths.length=0,!t.hasZ)return;const r=G4(t.geometryType,this._options.sourceSpatialReference,t.spatialReference);if(r!=null)for(const i of t.features)r(i.geometry)}createSpatialReference(){return{}}addField(t,r){const i=t.fields;wp(i),i.push(r);const n=i.map(s=>s.name);this._attributesConstructor=function(){for(const s of n)this[s]=null}}addFeature(t,r){t.features.push(r)}prepareFeatures(t){switch(this._transform=t.transform,this._options.applyTransform&&t.transform&&(this._applyTransform=this._deriveApplyTransform(t)),this._mValueOffset=null,this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&(this._mValueOffset=this._vertexDimension,this._vertexDimension++),t.geometryType){case"esriGeometryPoint":this.addCoordinate=(r,i,n)=>this.addCoordinatePoint(r,i,n),this.createGeometry=r=>this.createPointGeometry(r);break;case"esriGeometryPolygon":this.addCoordinate=(r,i,n)=>this._addCoordinatePolygon(r,i,n),this.createGeometry=r=>this._createPolygonGeometry(r);break;case"esriGeometryPolyline":this.addCoordinate=(r,i,n)=>this._addCoordinatePolyline(r,i,n),this.createGeometry=r=>this._createPolylineGeometry(r);break;case"esriGeometryMultipoint":this.addCoordinate=(r,i,n)=>this._addCoordinateMultipoint(r,i,n),this.createGeometry=r=>this._createMultipointGeometry(r)}}createFeature(){return this._lengths.length=0,this._currentLengthIndex=0,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0,this._coordinateBuffer=null,this._coordinateBufferPtr=0,{attributes:new this._attributesConstructor}}allocateCoordinates(){}addLength(t,r,i){this._lengths.length===0&&(this._toAddInCurrentPath=r),this._lengths.push(r)}addQueryGeometry(t,r){const{queryGeometry:i,queryGeometryType:n}=r,s=cR(i.clone(),i,!1,!1,this._transform),o=lZ(s,n,!1,!1);t.queryGeometryType=n,t.queryGeometry={...o}}createPointGeometry(t){const r={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(r.z=0),t.hasM&&(r.m=0),r}addCoordinatePoint(t,r,i){const n=this._transform;switch(r=this._applyTransform(n,r,i,0),i){case 0:t.x=r;break;case 1:t.y=r;break;case 2:"z"in t?t.z=r:t.m=r;break;case 3:t.m=r}}_transformPathLikeValue(t,r){let i=0;r<=1&&(i=this._previousCoordinate[r],this._previousCoordinate[r]+=t);const n=this._transform;return this._mValueOffset===null||t!==0||r%this._mValueOffset?this._applyTransform(n,t,r,i):0}_addCoordinatePolyline(t,r,i){this._dehydratedAddPointsCoordinate(t.paths,r,i)}_addCoordinatePolygon(t,r,i){this._dehydratedAddPointsCoordinate(t.rings,r,i)}_addCoordinateMultipoint(t,r,i){i===0&&t.points.push([]);const n=this._transformPathLikeValue(r,i);t.points[t.points.length-1].push(n)}_createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}_dehydratedAddPointsCoordinate(t,r,i){i===0&&this._toAddInCurrentPath--==0&&(t.push([]),this._toAddInCurrentPath=this._lengths[++this._currentLengthIndex]-1,this._previousCoordinate[0]=0,this._previousCoordinate[1]=0);const n=this._transformPathLikeValue(r,i),s=t[t.length-1];i===0&&(this._coordinateBufferPtr=0,this._coordinateBuffer=new Array(this._vertexDimension),s.push(this._coordinateBuffer)),this._coordinateBuffer[this._coordinateBufferPtr++]=n}_deriveApplyTransform(t){const{hasZ:r,hasM:i}=t;return r&&i?oxe:r?cZ:i?sxe:gP}};async function uxe(e,t,r){const i=pr(e),n={...r},s=$i.from(t),o=!s.quantizationParameters,{data:a}=await $Se(i,s,new lxe({sourceSpatialReference:s.sourceSpatialReference,applyTransform:o}),n);return a}let Io=class extends De{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.gdbVersion=null,this.infoFor3D=null,this.pbfSupported=!1,this.queryAttachmentsSupported=!1,this.sourceSpatialReference=null,this.url=null}get parsedUrl(){return Pt(this.url)}async execute(t,r){const i=await this.executeJSON(t,r);return this.featureSetFromJSON(t,i,r)}async executeJSON(t,r){var u;const i=this._normalizeQuery(t),n=((u=t.outStatistics)==null?void 0:u[0])!=null,s=Me("featurelayer-pbf-statistics"),o=!n||s;let a;if(this.pbfSupported&&o)try{a=await uxe(this.url,i,r)}catch(c){if(c.name!=="query:parsing-pbf")throw c;this.pbfSupported=!1}return this.pbfSupported&&o||(a=await XJ(this.url,i,r)),this._normalizeFields(a.fields),a}async featureSetFromJSON(t,r,i){if(!this._queryIs3DObjectFormat(t)||this.infoFor3D==null||!r.features)return Tf.fromJSON(r);const{meshFeatureSetFromJSON:n}=await hl(ge(()=>import("./meshFeatureSet-DIdKElin.js"),__vite__mapDeps([26,27,1,2,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50])),i);return n(t,this.infoFor3D,r)}executeForCount(t,r){return YJ(this.url,this._normalizeQuery(t),r)}executeForExtent(t,r){return NSe(this.url,this._normalizeQuery(t),r)}executeForIds(t,r){return KJ(this.url,this._normalizeQuery(t),r)}async executeRelationshipQuery(t,r){const[{default:i},{executeRelationshipQuery:n}]=await hl(Promise.all([ge(()=>Promise.resolve().then(()=>i7),void 0),ge(()=>import("./executeRelationshipQuery-rvs1Cc5o.js"),__vite__mapDeps([51,1,2]))]),r);return t=i.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),n(this.url,t,r)}async executeRelationshipQueryForCount(t,r){const[{default:i},{executeRelationshipQueryForCount:n}]=await hl(Promise.all([ge(()=>Promise.resolve().then(()=>i7),void 0),ge(()=>import("./executeRelationshipQuery-rvs1Cc5o.js"),__vite__mapDeps([51,1,2]))]),r);return t=i.from(t),(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),n(this.url,t,r)}async executeAttachmentQuery(t,r){const{executeAttachmentQuery:i,fetchAttachments:n,processAttachmentQueryResult:s}=await hl(ge(()=>import("./queryAttachments-BEzdvnih.js"),__vite__mapDeps([52,1,2])),r),o=pr(this.url);return s(o,await(this.queryAttachmentsSupported?i(o,t,r):n(o,t,r)))}async executeTopFeaturesQuery(t,r){const{executeTopFeaturesQuery:i}=await hl(ge(()=>import("./executeTopFeaturesQuery-BlIyaEvu.js"),__vite__mapDeps([53,54,1,2])),r);return i(this.parsedUrl,t,this.sourceSpatialReference,r)}async executeForTopIds(t,r){const{executeForTopIds:i}=await hl(ge(()=>import("./executeForTopIds-CtTSUbVA.js"),__vite__mapDeps([55,54,1,2])),r);return i(this.parsedUrl,t,r)}async executeForTopExtents(t,r){const{executeForTopExtents:i}=await hl(ge(()=>import("./executeForTopExtents-D8r4cz5J.js"),__vite__mapDeps([56,54,1,2])),r);return i(this.parsedUrl,t,r)}async executeForTopCount(t,r){const{executeForTopCount:i}=await hl(ge(()=>import("./executeForTopCount-DpkFVqtA.js"),__vite__mapDeps([57,54,1,2])),r);return i(this.parsedUrl,t,r)}_normalizeQuery(t){let r=$i.from(t);r.sourceSpatialReference=r.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(r=r===t?r.clone():r,r.gdbVersion=t.gdbVersion||this.gdbVersion,r.dynamicDataSource=t.dynamicDataSource?Wn.from(t.dynamicDataSource):this.dynamicDataSource);const{infoFor3D:i}=this;if(i!=null&&this._queryIs3DObjectFormat(t)){r=r===t?r.clone():r,r.formatOf3DObjects=null;const{supportedFormats:n,queryFormats:s}=i,o=G5("model/gltf-binary",n)??B5("glb",n),a=G5("model/gltf+json",n)??B5("gltf",n);for(const u of s){if(u===o){r.formatOf3DObjects=u;break}u!==a||r.formatOf3DObjects||(r.formatOf3DObjects=u)}if(!r.formatOf3DObjects)throw new z("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(r.outFields==null||!r.outFields.includes("*")){r=r===t?r.clone():r,r.outFields==null&&(r.outFields=[]);const{originX:u,originY:c,originZ:h,translationX:d,translationY:y,translationZ:v,scaleX:w,scaleY:b,scaleZ:_,rotationX:x,rotationY:T,rotationZ:I,rotationDeg:M}=i.transformFieldRoles;r.outFields.push(u,c,h,d,y,v,w,b,_,x,T,I,M)}}return r}_normalizeFields(t){if(this.fieldsIndex!=null&&t!=null)for(const r of t){const i=this.fieldsIndex.get(r.name);i&&Object.assign(r,i.toJSON())}}_queryIs3DObjectFormat(t){return this.infoFor3D!=null&&t.returnGeometry===!0&&t.multipatchOption!=="xyFootprint"&&!t.outStatistics}};l([p({type:Wn})],Io.prototype,"dynamicDataSource",void 0),l([p()],Io.prototype,"fieldsIndex",void 0),l([p()],Io.prototype,"gdbVersion",void 0),l([p()],Io.prototype,"infoFor3D",void 0),l([p({readOnly:!0})],Io.prototype,"parsedUrl",null),l([p()],Io.prototype,"pbfSupported",void 0),l([p()],Io.prototype,"queryAttachmentsSupported",void 0),l([p()],Io.prototype,"sourceSpatialReference",void 0),l([p({type:String})],Io.prototype,"url",void 0),Io=l([k("esri.tasks.QueryTask")],Io);const cxe=Io,sj=new We({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let Fc=class extends It(Q){constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};l([p({json:{write:!0}})],Fc.prototype,"name",void 0),l([p({json:{write:!0}})],Fc.prototype,"description",void 0),l([p({json:{read:sj.read,write:sj.write}})],Fc.prototype,"drawingTool",void 0),l([p({json:{write:!0}})],Fc.prototype,"prototype",void 0),l([p({json:{write:!0}})],Fc.prototype,"thumbnail",void 0),Fc=l([k("esri.layers.support.FeatureTemplate")],Fc);const vP=Fc;let cu=class extends It(Q){constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const r={};for(const i of Object.keys(t))r[i]=jT(t[i]);return r}writeDomains(t,r){var n;const i={};for(const s of Object.keys(t))t[s]&&(i[s]=(n=t[s])==null?void 0:n.toJSON());r.domains=i}};l([p({json:{write:!0}})],cu.prototype,"id",void 0),l([p({json:{write:!0}})],cu.prototype,"name",void 0),l([p({json:{write:!0}})],cu.prototype,"domains",void 0),l([te("domains")],cu.prototype,"readDomains",null),l([se("domains")],cu.prototype,"writeDomains",null),l([p({type:[vP],json:{write:!0}})],cu.prototype,"templates",void 0),cu=l([k("esri.layers.support.FeatureType")],cu);const wP=cu,bP="__begin__",_P="__end__",pxe=new RegExp(bP,"ig"),hxe=new RegExp(_P,"ig"),oj=new RegExp("^"+bP,"i"),aj=new RegExp(_P+"$","i"),mx='"',dxe=mx+" + ",fxe=" + "+mx;function yxe(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}function mxe(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function SP(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):e.labelExpression!=null&&(t.expression=yxe(e.labelExpression),t.type="conventional"),t}function gxe(e){const t=SP(e);if(!t)return null;switch(t.type){case"conventional":return pR(t.expression);case"arcade":return t.expression}return null}function vxe(e){const t=SP(e);if(!t)return null;switch(t.type){case"conventional":return bxe(t.expression);case"arcade":return pZ(t.expression)}return null}function pR(e){let t;return e?(t=Nx(e,r=>bP+'$feature["'+r+'"]'+_P),t=oj.test(t)?t.replace(oj,""):mx+t,t=aj.test(t)?t.replace(aj,""):t+mx,t=t.replaceAll(pxe,dxe).replaceAll(hxe,fxe)):t='""',t}const wxe=/^\s*\{([^}]+)\}\s*$/i;function bxe(e){const t=e==null?void 0:e.match(wxe);return(t==null?void 0:t[1].trim())||null}const _xe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,Sxe=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,xxe=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function pZ(e){if(!e)return null;let t=_xe.exec(e)||Sxe.exec(e);return t?t[1]||t[3]:(t=xxe.exec(e),t?t[2]:null)}var hR;let jc=hR=class extends Q{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?pR(t.value):e}writeExpression(e,t,r){this.value!=null&&(e=pR(this.value)),e!=null&&(t[r]=e)}clone(){return new hR({expression:this.expression,title:this.title,value:this.value})}};l([p({type:String,json:{write:{writerEnsuresNonNull:!0}}})],jc.prototype,"expression",void 0),l([te("expression",["expression","value"])],jc.prototype,"readExpression",null),l([se("expression")],jc.prototype,"writeExpression",null),l([p({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],jc.prototype,"title",void 0),l([p({json:{read:!1,write:!1}})],jc.prototype,"value",void 0),jc=hR=l([k("esri.layers.support.LabelExpressionInfo")],jc);const hZ=jc,dZ=[252,146,31,255],Txe={type:"esriSMS",style:"esriSMSCircle",size:6,color:dZ,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},Ixe={type:"esriSLS",style:"esriSLSSolid",width:.75,color:dZ},Mxe={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},$xe={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},Exe={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},Axe={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},Rxe={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null},bje=Ll.fromJSON(Txe),_je=oo.fromJSON(Ixe),Sje=_f.fromJSON(Mxe),Cxe=Qm.fromJSON($xe),xje=Ll.fromJSON(Exe),Tje=oo.fromJSON(Axe),Ije=_f.fromJSON(Rxe);var dR;const Kb=new We({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function Xb(e,t,r){return{enabled:!dH(r==null?void 0:r.layer)}}function fZ(e){var t;return!e||e.origin!=="service"&&((t=e.layer)==null?void 0:t.type)!=="map-image"}function Oxe(e){return(e==null?void 0:e.type)==="map-image"}function yZ(e){var t,r;return!!Oxe(e)&&!!((r=(t=e.capabilities)==null?void 0:t.exportMap)!=null&&r.supportsArcadeExpressionForLabeling)}function Pxe(e){return fZ(e)||yZ(e==null?void 0:e.layer)}let jr=dR=class extends Q{static evaluateWhere(e,t){const r=(i,n,s)=>{switch(n){case"=":return i==s;case"<>":return i!=s;case">":return i>s;case">=":return i>=s;case"<":return i<s;case"<=":return i<=s}return!1};try{if(e==null)return!0;const i=e.split(" ");if(i.length===3)return r(t[i[0]],i[1],i[2]);if(i.length===7){const n=r(t[i[0]],i[1],i[2]),s=i[3],o=r(t[i[4]],i[5],i[6]);switch(s){case"AND":return n&&o;case"OR":return n||o}}return!1}catch{console.log("Error.: can't parse = "+e)}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=Cxe,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,t){const r=t.labelExpressionInfo;if(!r||!r.value&&!r.expression)return e}writeLabelExpression(e,t,r){if(this.labelExpressionInfo){if(this.labelExpressionInfo.value!=null)e=mxe(this.labelExpressionInfo.value);else if(this.labelExpressionInfo.expression!=null){const i=pZ(this.labelExpressionInfo.expression);i&&(e="["+i+"]")}}e!=null&&(t[r]=e)}writeLabelExpressionInfo(e,t,r,i){if(e==null&&this.labelExpression!=null&&fZ(i))e=new hZ({expression:this.getLabelExpressionArcade()});else if(!e)return;const n=e.toJSON(i);n.expression&&(t[r]=n)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return SP(this)}getLabelExpressionArcade(){return gxe(this)}getLabelExpressionSingleField(){return vxe(this)}hash(){return JSON.stringify(this)}clone(){return new dR({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:B(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:B(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};l([p({type:String,json:{write:!0}})],jr.prototype,"name",void 0),l([p({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:Xb}}}}})],jr.prototype,"allowOverrun",void 0),l([p({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:Xb}}}}})],jr.prototype,"deconflictionStrategy",void 0),l([p({type:String,json:{write:{overridePolicy(e,t,r){return this.labelExpressionInfo&&(r==null?void 0:r.origin)==="service"&&yZ(r.layer)?{enabled:!1}:{allowNull:!0}}}}})],jr.prototype,"labelExpression",void 0),l([te("labelExpression")],jr.prototype,"readLabelExpression",null),l([se("labelExpression")],jr.prototype,"writeLabelExpression",null),l([p({type:hZ,json:{write:{overridePolicy:(e,t,r)=>Pxe(r)?{allowNull:!0}:{enabled:!1}}}})],jr.prototype,"labelExpressionInfo",void 0),l([se("labelExpressionInfo")],jr.prototype,"writeLabelExpressionInfo",null),l([p({type:Kb.apiValues,json:{type:Kb.jsonValues,read:Kb.read,write:Kb.write}})],jr.prototype,"labelPlacement",void 0),l([p({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],jr.prototype,"labelPosition",void 0),l([p({type:Number})],jr.prototype,"maxScale",void 0),l([se("maxScale")],jr.prototype,"writeMaxScale",null),l([p({type:Number})],jr.prototype,"minScale",void 0),l([se("minScale")],jr.prototype,"writeMinScale",null),l([p({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Xb}}}}})],jr.prototype,"repeatLabel",void 0),l([p({type:Number,cast:wt,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:Xb}}}}})],jr.prototype,"repeatLabelDistance",void 0),l([p({types:Zme,json:{origins:{"web-scene":{types:Yme,write:T9,default:null}},write:T9,default:null}})],jr.prototype,"symbol",void 0),l([p({type:Boolean,json:{write:!0}})],jr.prototype,"useCodedValues",void 0),l([p({type:String,json:{write:!0}})],jr.prototype,"where",void 0),jr=dR=l([k("esri.layers.support.LabelClass")],jr);const cw=jr,bM=()=>oe.getLogger("esri.layers.support.labelingInfo"),Lxe=/\[([^\[\]]+)\]/gi;function _M(e,t,r){return e?e.map(i=>{var s;const n=new cw;if(n.read(i,r),n.labelExpression){const o=t.fields||((s=t.layerDefinition)==null?void 0:s.fields)||this.fields;n.labelExpression=n.labelExpression.replaceAll(Lxe,(a,u)=>`[${kxe(u,o)}]`)}return n}):null}function kxe(e,t){if(!t)return e;const r=e.toLowerCase();for(let i=0;i<t.length;i++){const n=t[i].name;if(n.toLowerCase()===r)return n}return e}const Nxe={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null,esriGeometryEnvelope:null};function Dxe(e,t){const r=B(e);return r.some(i=>Fxe(i,t))?[]:r}function Fxe(e,t){const r=e.labelPlacement,i=Nxe[t];if(!e.symbol)return bM().warn("No ILabelClass symbol specified."),!0;if(!i)return bM().error(new z("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),!0;if(!i.includes(r)){const n=i[0];r&&bM().warn(`Found invalid label placement type ${r} for ${t}. Defaulting to ${n}`),e.labelPlacement=n}return!1}var fR;let fy=fR=class extends Q{constructor(e){super(e),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new $e}clone(){return new fR({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};l([p({type:String,json:{write:!0}})],fy.prototype,"floorField",void 0),l([p({json:{read:!1,write:!1}})],fy.prototype,"viewAllMode",void 0),l([p({json:{read:!1,write:!1}})],fy.prototype,"viewAllLevelIds",void 0),fy=fR=l([k("esri.layers.support.LayerFloorInfo")],fy);const mZ=fy;function qe(e,t,r){return!!gZ(e,t,r)}function Kg(e,t,r){return gZ(e,t,r)}function gZ(e,t,r){return e&&e.hasOwnProperty(t)?e[t]:r}const jxe={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"};function Uxe(e){var r;const t=(r=e==null?void 0:e.supportedSpatialAggregationStatistics)==null?void 0:r.map(i=>i.toLowerCase());return{envelope:!!(t!=null&&t.includes("envelopeaggregate")),centroid:!!(t!=null&&t.includes("centroidaggregate")),convexHull:!!(t!=null&&t.includes("convexhullaggregate"))}}function pw(e,t){var i;const r=(i=e==null?void 0:e.supportedOperationsWithCacheHint)==null?void 0:i.map(n=>n.toLowerCase());return!!(r!=null&&r.includes(t.toLowerCase()))}function xP(e,t){return{analytics:Vxe(e),attachment:Gxe(e),data:Bxe(e),metadata:zxe(e),operations:qxe(e.capabilities,e,t),query:Hxe(e,t),queryRelated:Wxe(e),queryTopFeatures:Jxe(e),editing:Zxe(e)}}function Vxe(e){return{supportsCacheHint:pw(e.advancedQueryCapabilities,"queryAnalytics")}}function Gxe(e){const t=e.attachmentProperties,r={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1,supportsCacheHint:pw(e.advancedQueryCapabilities,"queryAttachments"),supportsResize:qe(e,"supportsAttachmentsResizing",!1)};return t&&Array.isArray(t)&&t.forEach(i=>{const n=jxe[i.name];n&&(r[n]=!!i.isEnabled)}),r}function Bxe(e){return{isVersioned:qe(e,"isDataVersioned",!1),supportsAttachment:qe(e,"hasAttachments",!1),supportsM:qe(e,"hasM",!1),supportsZ:qe(e,"hasZ",!1)}}function zxe(e){return{supportsAdvancedFieldProperties:qe(e,"supportsFieldDescriptionProperty",!1)}}function qxe(e,t,r){const i=e?e.toLowerCase().split(",").map(y=>y.trim()):[],n=r?zu(r):null,s=i.includes(n!=null&&n.serverType==="MapServer"?"data":"query"),o=i.includes("editing")&&!t.datesInUnknownTimezone;let a=o&&i.includes("create"),u=o&&i.includes("delete"),c=o&&i.includes("update");const h=i.includes("changetracking"),d=t.advancedQueryCapabilities;return o&&!(a||u||c)&&(a=u=c=!0),{supportsCalculate:qe(t,"supportsCalculate",!1),supportsTruncate:qe(t,"supportsTruncate",!1),supportsValidateSql:qe(t,"supportsValidateSql",!1),supportsAdd:a,supportsDelete:u,supportsEditing:o,supportsChangeTracking:h,supportsQuery:s,supportsQueryAnalytics:qe(d,"supportsQueryAnalytic",!1),supportsQueryAttachments:qe(d,"supportsQueryAttachments",!1),supportsQueryTopFeatures:qe(d,"supportsTopFeaturesQuery",!1),supportsResizeAttachments:qe(t,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:c,supportsExceedsLimitStatistics:qe(t,"supportsExceedsLimitStatistics",!1),supportsAsyncConvert3D:qe(t,"supportsAsyncConvert3D",!1)}}function Hxe(e,t){const r=e.advancedQueryCapabilities,i=e.ownershipBasedAccessControlForFeatures,n=e.archivingInfo,s=e.currentVersion,o=t==null?void 0:t.includes("MapServer"),a=!o||s>=Me("mapserver-pbf-version-support"),u=H4(t),c=new Set((e.supportedQueryFormats??"").split(",").map(h=>h.toLowerCase().trim()));return{supportsStatistics:qe(r,"supportsStatistics",e.supportsStatistics),supportsPercentileStatistics:qe(r,"supportsPercentileStatistics",!1),supportsSpatialAggregationStatistics:qe(r,"supportsSpatialAggregationStatistics",!1),supportedSpatialAggregationStatistics:Uxe(r),supportsCentroid:qe(r,"supportsReturningGeometryCentroid",!1),supportsDistance:qe(r,"supportsQueryWithDistance",!1),supportsDistinct:qe(r,"supportsDistinct",e.supportsAdvancedQueries),supportsExtent:qe(r,"supportsReturningQueryExtent",!1),supportsGeometryProperties:qe(r,"supportsReturningGeometryProperties",!1),supportsHavingClause:qe(r,"supportsHavingClause",!1),supportsOrderBy:qe(r,"supportsOrderBy",e.supportsAdvancedQueries),supportsPagination:qe(r,"supportsPagination",!1),supportsQuantization:qe(e,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:qe(e,"supportsQuantizationEditMode",!1),supportsQueryGeometry:qe(e,"supportsReturningQueryGeometry",!1),supportsResultType:qe(r,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:qe(r,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:qe(r,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:qe(e,"useStandardizedQueries",!1),supportsTopFeaturesQuery:qe(r,"supportsTopFeaturesQuery",!1),supportsQueryByAnonymous:qe(i,"allowAnonymousToQuery",!0),supportsQueryByOthers:qe(i,"allowOthersToQuery",!0),supportsHistoricMoment:qe(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:a&&c.has("pbf"),supportsDisjointSpatialRelationship:qe(r,"supportsDisjointSpatialRel",!1),supportsCacheHint:qe(r,"supportsQueryWithCacheHint",!1)||pw(r,"query"),supportsDefaultSpatialReference:qe(r,"supportsDefaultSR",!1),supportsCompactGeometry:u,supportsFullTextSearch:qe(r,"supportsFullTextSearch",!1),maxRecordCountFactor:Kg(e,"maxRecordCountFactor",void 0),maxRecordCount:Kg(e,"maxRecordCount",void 0),standardMaxRecordCount:Kg(e,"standardMaxRecordCount",void 0),tileMaxRecordCount:Kg(e,"tileMaxRecordCount",void 0)}}function Wxe(e){const t=e.advancedQueryCapabilities,r=qe(t,"supportsAdvancedQueryRelated",!1);return{supportsPagination:qe(t,"supportsQueryRelatedPagination",!1),supportsCount:r,supportsOrderBy:r,supportsCacheHint:pw(t,"queryRelated")}}function Jxe(e){return{supportsCacheHint:pw(e.advancedQueryCapabilities,"queryTopFilter")}}function Zxe(e){const t=e.ownershipBasedAccessControlForFeatures,r=e?e.advancedEditingCapabilities:void 0;return{supportsGeometryUpdate:qe(e,"allowGeometryUpdates",!0),supportsGlobalId:qe(e,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:qe(e,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:qe(e,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:qe(e,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:qe(e,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:qe(t,"allowAnonymousToDelete",!0),supportsDeleteByOthers:qe(t,"allowOthersToDelete",!0),supportsUpdateByAnonymous:qe(t,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:qe(t,"allowOthersToUpdate",!0),supportsAsyncApplyEdits:qe(r,"supportsAsyncApplyEdits",!1),zDefault:Kg(e,"zDefault",void 0)}}var yR;let ki=yR=class extends Q{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new yR(B({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};l([p({type:[String],json:{write:!0}})],ki.prototype,"attachmentTypes",void 0),l([p({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],ki.prototype,"attachmentsWhere",void 0),l([p({type:Boolean,json:{write:!0}})],ki.prototype,"cacheHint",void 0),l([p({type:[String],json:{write:!0}})],ki.prototype,"keywords",void 0),l([p({type:[Number],json:{write:!0}})],ki.prototype,"globalIds",void 0),l([p({json:{write:!0}})],ki.prototype,"name",void 0),l([p({type:Number,json:{read:{source:"resultRecordCount"}}})],ki.prototype,"num",void 0),l([p({type:[Number],json:{write:!0}})],ki.prototype,"objectIds",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],ki.prototype,"returnMetadata",void 0),l([p({type:[Number],json:{write:!0}})],ki.prototype,"size",void 0),l([p({type:Number,json:{read:{source:"resultOffset"}}})],ki.prototype,"start",void 0),l([se("start"),se("num")],ki.prototype,"writeStart",null),l([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],ki.prototype,"where",void 0),ki=yR=l([k("esri.rest.support.AttachmentQuery")],ki),ki.from=Lr(ki);const vZ=ki;function TP({displayField:e,editFieldsInfo:t,fields:r,objectIdField:i,title:n},s){if(!r)return null;const o=Qxe({editFieldsInfo:t,fields:r,objectIdField:i},s);if(!o.length)return null;const a=rTe({titleBase:n,fields:r,displayField:e}),u=tTe();return new Up({title:a,content:u,fieldInfos:o})}const Yxe=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):Kfe(e,t);function Kxe(e,t){const r=e;return t&&(e=e.filter(i=>!t.includes(i.type))),e===r&&(e=e.slice()),e.sort(Xxe),e}function Xxe(e,t){return e.type==="oid"?-1:t.type==="oid"?1:lj(e)?-1:lj(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function Qxe(e,t){const r=t==null?void 0:t.visibleFieldNames;return Kxe(e.fields??[],(t==null?void 0:t.ignoreFieldTypes)||iTe).map(i=>new u4({fieldName:i.name,isEditable:Yfe(i,e),label:i.alias,format:eTe(i),visible:Yxe(i,{...e,visibleFieldNames:r})}))}function eTe(e){switch(e.type){case"small-integer":case"integer":case"single":return new B_({digitSeparator:!0,places:0});case"double":return new B_({digitSeparator:!0,places:2});case"string":return Sye(e.name)?new B_({digitSeparator:!0,places:0}):null;default:return null}}function tTe(){return[new cv,new uv]}function rTe(e){const t=Ufe(e),{titleBase:r}=e;return t?`${r}: {${t.trim()}}`:r??""}function lj(e){return(e.name&&e.name.toLowerCase())==="name"?!0:(e.alias&&e.alias.toLowerCase())==="name"}const iTe=["geometry","blob","raster","guid","xml"];var k2;function SM(e){return e!=null&&e.type==="esriSMS"}function xM(e,t,r){var n;const i=this.originIdOf(t)>=Zn(r.origin);return{ignoreOrigin:!0,allowNull:i,enabled:!!r&&((n=r.layer)==null?void 0:n.type)==="map-image"&&(r.writeSublayerStructure||i)}}function TM(e,t,r){var i;return{enabled:!!r&&((i=r.layer)==null?void 0:i.type)==="tile"&&(r.origin&&this.originIdOf(t)>=Zn(r.origin)||this._isOverridden(t))}}function wo(e,t,r){return{ignoreOrigin:!0,enabled:r&&r.writeSublayerStructure||!1}}function Qb(e,t,r){return{ignoreOrigin:!0,enabled:!!r&&(r.writeSublayerStructure||this.originIdOf(t)>=Zn(r.origin))}}let nTe=0;const Yh=new Set;Yh.add("layer"),Yh.add("parent"),Yh.add("loaded"),Yh.add("loadStatus"),Yh.add("loadError"),Yh.add("loadWarnings");let ze=k2=class extends kl(qv(El)){constructor(e){super(e),this.capabilities=void 0,this.maxScaleRange={minScale:0,maxScale:0},this.fields=null,this.fullExtent=null,this.geometryType=null,this.globalIdField=null,this.legendEnabled=!0,this.objectIdField=null,this.parent=null,this.popupEnabled=!0,this.popupTemplate=null,this.sourceJSON=null,this.title=null,this.typeIdField=null,this.type="sublayer",this.types=null,this._lastParsedUrl=null}async load(e){return this.addResolvingPromise((async()=>{const{layer:t,url:r}=this;if(!t&&!r)throw new z("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:this});const i=t?await t.fetchSublayerInfo(this,e):(await be(r,{responseType:"json",query:{f:"json"},...e})).data;i&&(this.sourceJSON=i,this.read({layerDefinition:i},{origin:"service",layer:t,url:pr(r)}))})()),this}readCapabilities(e,t){t=t.layerDefinition||t;const{operations:{supportsQuery:r,supportsQueryAttachments:i},query:{supportsFormatPBF:n},data:{supportsAttachment:s},queryRelated:o}=xP(t,this.url);return{exportMap:{supportsModification:!!t.canModifyLayer},operations:{supportsQuery:r,supportsQueryAttachments:i},data:{supportsAttachment:s},query:{supportsFormatPBF:n},queryRelated:o}}get defaultPopupTemplate(){return this.createPopupTemplate()}set definitionExpression(e){this._setAndNotifyLayer("definitionExpression",e)}get effectiveScaleRange(){const{minScale:e,maxScale:t}=this;return{minScale:e,maxScale:t}}readMaxScaleRange(e,t){return{minScale:(t=t.layerDefinition||t).minScale??0,maxScale:t.maxScale??0}}get fieldsIndex(){return new DT(this.fields||[])}set floorInfo(e){this._setAndNotifyLayer("floorInfo",e)}readGlobalIdFieldFromService(e,t){if((t=t.layerDefinition||t).globalIdField)return t.globalIdField;if(t.fields){for(const r of t.fields)if(r.type==="esriFieldTypeGlobalID")return r.name}}get id(){return this._get("id")??nTe++}set id(e){var t,r,i;this._get("id")!==e&&(((i=(r=(t=this.layer)==null?void 0:t.capabilities)==null?void 0:r.exportMap)==null?void 0:i.supportsDynamicLayers)!==!1?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))}set labelingInfo(e){this._setAndNotifyLayer("labelingInfo",e)}writeLabelingInfo(e,t,r,i){e&&e.length&&(t.layerDefinition={drawingInfo:{labelingInfo:e.map(n=>n.write({},i))}})}set labelsVisible(e){this._setAndNotifyLayer("labelsVisible",e)}set layer(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach(t=>t.layer=e)}set listMode(e){this._set("listMode",e)}set minScale(e){this._setAndNotifyLayer("minScale",e)}readMinScale(e,t){var r;return t.minScale||((r=t.layerDefinition)==null?void 0:r.minScale)||0}set maxScale(e){this._setAndNotifyLayer("maxScale",e)}readMaxScale(e,t){var r;return t.maxScale||((r=t.layerDefinition)==null?void 0:r.maxScale)||0}readObjectIdFieldFromService(e,t){if((t=t.layerDefinition||t).objectIdField)return t.objectIdField;if(t.fields){for(const r of t.fields)if(r.type==="esriFieldTypeOID")return r.name}}set opacity(e){this._setAndNotifyLayer("opacity",e)}readOpacity(e,t){var i;const r=t.layerDefinition;return 1-.01*(((r==null?void 0:r.transparency)!=null?r.transparency:(i=r==null?void 0:r.drawingInfo)==null?void 0:i.transparency)??0)}writeOpacity(e,t,r,i){t.layerDefinition={drawingInfo:{transparency:100-100*e}}}writeParent(e,t){this.parent&&this.parent!==this.layer?t.parentLayerId=Fx(this.parent.id):t.parentLayerId=-1}get queryTask(){var o;if(!this.layer)return null;const{spatialReference:e}=this.layer,t="gdbVersion"in this.layer?this.layer.gdbVersion:void 0,{capabilities:r,fieldsIndex:i}=this,n=Me("featurelayer-pbf")&&(r==null?void 0:r.query.supportsFormatPBF),s=((o=r==null?void 0:r.operations)==null?void 0:o.supportsQueryAttachments)??!1;return new cxe({url:this.url,pbfSupported:n,fieldsIndex:i,gdbVersion:t,sourceSpatialReference:e,queryAttachmentsSupported:s})}set renderer(e){if(e){for(const t of e.getSymbols())if(df(t)){oe.getLogger(this).warn("Sublayer renderer should use 2D symbols");break}}this._setAndNotifyLayer("renderer",e)}get source(){return this._get("source")||new Ou({mapLayerId:this.id})}set source(e){this._setAndNotifyLayer("source",e)}set sublayers(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)}castSublayers(e){return Lr($e.ofType(k2),e)}writeSublayers(e,t,r){var i;(i=this.sublayers)!=null&&i.length&&(t[r]=this.sublayers.map(n=>n.id).toArray().reverse())}readTitle(e,t){var r;return((r=t.layerDefinition)==null?void 0:r.name)??t.name}readTypeIdField(e,t){let r=(t=t.layerDefinition||t).typeIdField;if(r&&t.fields){r=r.toLowerCase();const i=t.fields.find(n=>n.name.toLowerCase()===r);i&&(r=i.name)}return r}get url(){var i;const e=((i=this.layer)==null?void 0:i.parsedUrl)??this._lastParsedUrl,t=this.source;if(!e)return null;if(this._lastParsedUrl=e,(t==null?void 0:t.type)==="map-layer")return`${e.path}/${t.mapLayerId}`;const r={layer:JSON.stringify({source:this.source})};return`${e.path}/dynamicLayer?${Il(r)}`}set url(e){this._overrideIfSome("url",e)}set visible(e){this._setAndNotifyLayer("visible",e)}writeVisible(e,t,r,i){t[r]=this.getAtOrigin("defaultVisibility","service")||e}clone(){const{store:e}=Mi(this),t=new k2;return Mi(t).store=e.clone(Yh),this.commitProperty("url"),t._lastParsedUrl=this._lastParsedUrl,t}createPopupTemplate(e){return TP(this,e)}createQuery(){return new $i({returnGeometry:!0,where:this.definitionExpression||"1=1"})}async createFeatureLayer(){var n;if(this.hasOwnProperty("sublayers"))return null;const e=(await ge(async()=>{const{default:s}=await Promise.resolve().then(()=>oAe);return{default:s}},void 0)).default,{layer:t,url:r}=this;let i;if(r&&this.originIdOf("url")>_e.SERVICE)i=new e({url:r});else{if(!(t!=null&&t.parsedUrl))throw new z("createFeatureLayer:missing-information","Cannot create a FeatureLayer without a url or a parent layer");{const s=t.parsedUrl;i=new e({url:s.path}),s&&this.source&&(this.source.type==="map-layer"?i.layerId=this.source.mapLayerId:i.dynamicDataSource=this.source)}}return(t==null?void 0:t.refreshInterval)!=null&&(i.refreshInterval=t.refreshInterval),this.definitionExpression&&(i.definitionExpression=this.definitionExpression),this.floorInfo&&(i.floorInfo=B(this.floorInfo)),this.originIdOf("labelingInfo")>_e.SERVICE&&(i.labelingInfo=B(this.labelingInfo)),this.originIdOf("labelsVisible")>_e.DEFAULTS&&(i.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>_e.DEFAULTS&&(i.legendEnabled=this.legendEnabled),this.originIdOf("visible")>_e.DEFAULTS&&(i.visible=this.visible),this.originIdOf("minScale")>_e.DEFAULTS&&(i.minScale=this.minScale),this.originIdOf("maxScale")>_e.DEFAULTS&&(i.maxScale=this.maxScale),this.originIdOf("opacity")>_e.DEFAULTS&&(i.opacity=this.opacity),this.originIdOf("popupTemplate")>_e.DEFAULTS&&(i.popupTemplate=B(this.popupTemplate)),this.originIdOf("renderer")>_e.SERVICE&&(i.renderer=B(this.renderer)),((n=this.source)==null?void 0:n.type)==="data-layer"&&(i.dynamicDataSource=this.source.clone()),this.originIdOf("title")>_e.DEFAULTS&&(i.title=this.title),(t==null?void 0:t.type)==="map-image"&&t.originIdOf("customParameters")>_e.DEFAULTS&&(i.customParameters=t.customParameters),(t==null?void 0:t.type)==="tile"&&t.originIdOf("customParameters")>_e.DEFAULTS&&(i.customParameters=t.customParameters),i}getField(e){return this.fieldsIndex.get(e)}getFeatureType(e){const{typeIdField:t,types:r}=this;if(!t||!e)return null;const i=e.attributes?e.attributes[t]:void 0;if(i==null)return null;let n=null;return r==null||r.some(s=>{const{id:o}=s;return o!=null&&(o.toString()===i.toString()&&(n=s),!!n)}),n}getFieldDomain(e,t){const r=t==null?void 0:t.feature,i=this.getFeatureType(r);if(i){const n=i.domains&&i.domains[e];if(n&&n.type!=="inherited")return n}return this._getLayerDomain(e)}async queryAttachments(e,t){var h,d;await this.load(),e=vZ.from(e);const r=this.capabilities;if(!((h=r==null?void 0:r.data)!=null&&h.supportsAttachment))throw new z("queryAttachments:not-supported","this layer doesn't support attachments");const{attachmentTypes:i,objectIds:n,globalIds:s,num:o,size:a,start:u,where:c}=e;if(!((d=r==null?void 0:r.operations)!=null&&d.supportsQueryAttachments)&&((i==null?void 0:i.length)>0||(s==null?void 0:s.length)>0||(a==null?void 0:a.length)>0||o||u||c))throw new z("queryAttachments:option-not-supported","when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",e);if(!(n!=null&&n.length||s!=null&&s.length||c))throw new z("queryAttachments:invalid-query","'objectIds', 'globalIds', or 'where' are required to perform attachment query",e);return this.queryTask.executeAttachmentQuery(e,t)}async queryFeatures(e=this.createQuery(),t){var i,n;if(await this.load(),!this.capabilities.operations.supportsQuery)throw new z("queryFeatures:not-supported","this layer doesn't support queries.");if(!this.url)throw new z("queryFeatures:not-supported","this layer has no url.");const r=await this.queryTask.execute(e,{...t,query:{...(i=this.layer)==null?void 0:i.customParameters,token:(n=this.layer)==null?void 0:n.apiKey}});if(r!=null&&r.features)for(const s of r.features)s.sourceLayer=this;return r}toExportImageJSON(e){var s,o;const t={id:this.id,source:((s=this.source)==null?void 0:s.toJSON())||{mapLayerId:this.id,type:"mapLayer"}},r=WO(e,this.definitionExpression);r!=null&&(t.definitionExpression=r);const i=["renderer","labelingInfo","opacity","labelsVisible"].reduce((a,u)=>(a[u]=this.originIdOf(u),a),{});if(Object.keys(i).some(a=>i[a]>_e.SERVICE)){const a=t.drawingInfo={};if(i.renderer>_e.SERVICE&&(a.renderer=this.renderer?this.renderer.toJSON():null),i.labelsVisible>_e.SERVICE&&(a.showLabels=this.labelsVisible),this.labelsVisible&&i.labelingInfo>_e.SERVICE)if(this.labelingInfo){!this.loaded&&((o=this.labelingInfo)!=null&&o.some(c=>!c.labelPlacement))&&oe.getLogger(this).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.`,{sublayer:this});let u=this.labelingInfo;this.geometryType!=null&&(u=Dxe(this.labelingInfo,JS.toJSON(this.geometryType))),a.showLabels=!0,a.labelingInfo=u.filter(c=>c.labelPlacement).map(c=>c.toJSON({origin:"service",layer:this.layer}))}else a.showLabels=!1;i.opacity>_e.SERVICE&&(a.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(a.renderer)}return t}_assignDefaultSymbolColors(e){this._forEachSimpleMarkerSymbols(e,t=>{var r;t.color||t.style!=="esriSMSX"&&t.style!=="esriSMSCross"||((r=t.outline)!=null&&r.color?t.color=t.outline.color:t.color=[0,0,0,0])})}_forEachSimpleMarkerSymbols(e,t){if(e){const r=("uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:null)??[];for(const i of r)SM(i.symbol)&&t(i.symbol);"symbol"in e&&SM(e.symbol)&&t(e.symbol),"defaultSymbol"in e&&SM(e.defaultSymbol)&&t(e.defaultSymbol)}}_setAndNotifyLayer(e,t){var a,u,c,h;const r=this.layer,i=this._get(e);let n,s;switch(e){case"definitionExpression":case"floorInfo":n="supportsSublayerDefinitionExpression";break;case"minScale":case"maxScale":case"visible":n="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":n="supportsDynamicLayers",s="supportsModification"}const o=Mi(this).getDefaultOrigin();if(o!=="service"){if(n&&((c=(u=(a=this.layer)==null?void 0:a.capabilities)==null?void 0:u.exportMap)==null?void 0:c[n])===!1)return void this._logLockedError(e,`capability not available 'layer.capabilities.exportMap.${n}'`);if(s&&((h=this.capabilities)==null?void 0:h.exportMap[s])===!1)return void this._logLockedError(e,`capability not available 'capabilities.exportMap.${s}'`)}e!=="source"||this.loadStatus==="not-loaded"?(this._set(e,t),o!=="service"&&i!==t&&r&&r.emit&&r.emit("sublayer-update",{propertyName:e,target:this})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()")}_handleSublayersChange(e,t){t&&(t.forEach(r=>{r.parent=null,r.layer=null}),this.removeAllHandles()),e&&(e.forEach(r=>{r.parent=this,r.layer=this.layer}),this.addHandles([e.on("after-add",({item:r})=>{r.parent=this,r.layer=this.layer}),e.on("after-remove",({item:r})=>{r.parent=null,r.layer=null}),e.on("before-changes",r=>{var n,s,o;const i=(o=(s=(n=this.layer)==null?void 0:n.capabilities)==null?void 0:s.exportMap)==null?void 0:o.supportsSublayersChanges;i==null||i||(oe.getLogger(this).error(new z("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),r.preventDefault())})]))}_logLockedError(e,t){const{layer:r,declaredClass:i}=this;oe.getLogger(i).error(new z("sublayer:locked",`Property '${String(e)}' can't be changed on Sublayer from the layer '${r==null?void 0:r.id}'`,{reason:t,sublayer:this,layer:r}))}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}};ze.test={isMapImageLayerOverridePolicy:e=>e===wo||e===xM,isTileImageLayerOverridePolicy:e=>e===TM},l([p({readOnly:!0})],ze.prototype,"capabilities",void 0),l([te("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],ze.prototype,"readCapabilities",null),l([p()],ze.prototype,"defaultPopupTemplate",null),l([p({type:String,value:null,json:{name:"layerDefinition.definitionExpression",write:{allowNull:!0,overridePolicy:xM}}})],ze.prototype,"definitionExpression",null),l([p({readOnly:!0})],ze.prototype,"effectiveScaleRange",null),l([te("service","maxScaleRange",["minScale","maxScale"])],ze.prototype,"readMaxScaleRange",null),l([p({type:[Po],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],ze.prototype,"fields",void 0),l([p({readOnly:!0})],ze.prototype,"fieldsIndex",null),l([p({type:mZ,value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:xM},origins:{"web-scene":{read:!1,write:!1}}}})],ze.prototype,"floorInfo",null),l([p({type:Ne,json:{read:{source:"layerDefinition.extent"}}})],ze.prototype,"fullExtent",void 0),l([p({type:JS.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:JS.read}}}}})],ze.prototype,"geometryType",void 0),l([p({type:String})],ze.prototype,"globalIdField",void 0),l([te("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],ze.prototype,"readGlobalIdFieldFromService",null),l([p({type:Ke,json:{write:{ignoreOrigin:!0}}})],ze.prototype,"id",null),l([p({value:null,type:[cw],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:wo}}})],ze.prototype,"labelingInfo",null),l([se("labelingInfo")],ze.prototype,"writeLabelingInfo",null),l([p({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:wo}}})],ze.prototype,"labelsVisible",null),l([p({value:null})],ze.prototype,"layer",null),l([p({type:String,json:{write:{overridePolicy:TM}}})],ze.prototype,"layerItemId",void 0),l([p({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:Qb}}})],ze.prototype,"legendEnabled",void 0),l([p({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],ze.prototype,"listMode",null),l([p({type:Number,value:0,json:{write:{overridePolicy:wo}}})],ze.prototype,"minScale",null),l([te("minScale",["minScale","layerDefinition.minScale"])],ze.prototype,"readMinScale",null),l([p({type:Number,value:0,json:{write:{overridePolicy:wo}}})],ze.prototype,"maxScale",null),l([te("maxScale",["maxScale","layerDefinition.maxScale"])],ze.prototype,"readMaxScale",null),l([p({type:String})],ze.prototype,"objectIdField",void 0),l([te("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],ze.prototype,"readObjectIdFieldFromService",null),l([p({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:wo}}})],ze.prototype,"opacity",null),l([te("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],ze.prototype,"readOpacity",null),l([se("opacity")],ze.prototype,"writeOpacity",null),l([p({json:{type:Ke,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:wo}}})],ze.prototype,"parent",void 0),l([se("parent")],ze.prototype,"writeParent",null),l([p({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:(e,t)=>!t.disablePopup},write:{target:"disablePopup",overridePolicy:Qb,writer(e,t,r){t[r]=!e}}}})],ze.prototype,"popupEnabled",void 0),l([p({type:Up,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:Qb}}})],ze.prototype,"popupTemplate",void 0),l([p({readOnly:!0})],ze.prototype,"queryTask",null),l([p({types:aw,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:wo},origins:{"web-scene":{types:LJ,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:wo}}}}})],ze.prototype,"renderer",null),l([p({types:{key:"type",base:null,typeMap:{"data-layer":Wn,"map-layer":Ou}},cast(e){if(e){if("mapLayerId"in e)return rr(Ou,e);if("dataSource"in e)return rr(Wn,e)}return e},json:{name:"layerDefinition.source",write:{overridePolicy:wo}}})],ze.prototype,"source",null),l([p()],ze.prototype,"sourceJSON",void 0),l([p({value:null,json:{type:[Ke],write:{target:"subLayerIds",allowNull:!0,overridePolicy:wo}}})],ze.prototype,"sublayers",null),l([Tt("sublayers")],ze.prototype,"castSublayers",null),l([se("sublayers")],ze.prototype,"writeSublayers",null),l([p({type:String,json:{name:"name",write:{overridePolicy:Qb}}})],ze.prototype,"title",void 0),l([te("service","title",["name","layerDefinition.name"])],ze.prototype,"readTitle",null),l([p({type:String})],ze.prototype,"typeIdField",void 0),l([p({json:{read:!1},readOnly:!0,value:"sublayer"})],ze.prototype,"type",void 0),l([te("typeIdField",["layerDefinition.typeIdField"])],ze.prototype,"readTypeIdField",null),l([p({type:[wP],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],ze.prototype,"types",void 0),l([p({type:String,json:{name:"layerUrl",write:{overridePolicy:TM}}})],ze.prototype,"url",null),l([p({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:wo}}})],ze.prototype,"visible",null),l([se("visible")],ze.prototype,"writeVisible",null),ze=k2=l([k("esri.layers.support.Sublayer")],ze);const hw=ze;function uj(e,t,r){return t.flatten(({sublayers:n})=>n).length!==e.length?!0:!!e.some(n=>n.originIdOf("minScale")>r||n.originIdOf("maxScale")>r||n.originIdOf("renderer")>r||n.originIdOf("labelingInfo")>r||n.originIdOf("opacity")>r||n.originIdOf("labelsVisible")>r||n.originIdOf("source")>r)||!wZ(e,t)}function sTe(e,t,r){return!!e.some(i=>{const n=i.source;return!(!n||n.type==="map-layer"&&n.mapLayerId===i.id&&(n.gdbVersion==null||n.gdbVersion===r))||i.originIdOf("renderer")>_e.SERVICE||i.originIdOf("labelingInfo")>_e.SERVICE||i.originIdOf("opacity")>_e.SERVICE||i.originIdOf("labelsVisible")>_e.SERVICE})||!wZ(e,t)}function wZ(e,t){if(!(e!=null&&e.length)||t==null)return!0;const r=t.slice().reverse().flatten(({sublayers:s})=>s&&s.toArray().reverse()).map(s=>s.id).toArray();if(e.length>r.length)return!1;let i=0;const n=r.length;for(const{id:s}of e){for(;i<n&&r[i]!==s;)i++;if(i>=n)return!1}return!0}function oTe(e){return!!e&&e.some(t=>{var r;return t.minScale!=null||((r=t.layerDefinition)==null?void 0:r.minScale)!=null})}function aTe(e,t){const r=[],i={};return e&&e.forEach(n=>{const s=new hw;if(s.read(n,t),i[s.id]=s,n.parentLayerId!=null&&n.parentLayerId!==-1){const o=i[n.parentLayerId];o.sublayers||(o.sublayers=[]),o.sublayers.unshift(s)}else r.unshift(s)}),r}const IM=$e.ofType(hw);function bZ(e,t){e&&e.forEach(r=>{t(r),r.sublayers&&r.sublayers.length&&bZ(r.sublayers,t)})}const _Z=e=>{let t=class extends e{constructor(...r){super(...r),this.allSublayers=new ff({getCollections:()=>[this.sublayers],getChildrenFunction:i=>i.sublayers}),this.sublayersSourceJSON={[_e.SERVICE]:{},[_e.PORTAL_ITEM]:{},[_e.WEB_SCENE]:{},[_e.WEB_MAP]:{}},this.addHandles(Ue(()=>this.sublayers,(i,n)=>this._handleSublayersChange(i,n),di))}destroy(){this.allSublayers.destroy()}readSublayers(r,i){if(!i||!r)return;const{sublayersSourceJSON:n}=this,s=Zn(i.origin);if(s<_e.SERVICE||(n[s]={context:i,visibleLayers:r.visibleLayers||n[s].visibleLayers,layers:r.layers||n[s].layers},s>_e.SERVICE))return;this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);const{sublayers:o,origin:a}=this.createSublayersForOrigin("web-document"),u=Mi(this);u.setDefaultOrigin(a),this._set("sublayers",new IM(o)),u.setDefaultOrigin("user")}findSublayerById(r){return this.allSublayers.find(i=>i.id===r)}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(r){const i=Zn(r==="web-document"?"web-map":r);let n=_e.SERVICE,s=this.sublayersSourceJSON[_e.SERVICE].layers,o=this.sublayersSourceJSON[_e.SERVICE].context,a=null;const u=[_e.PORTAL_ITEM,_e.WEB_SCENE,_e.WEB_MAP].filter(w=>w<=i);for(const w of u){const b=this.sublayersSourceJSON[w];oTe(b.layers)&&(n=w,s=b.layers,o=b.context,b.visibleLayers&&(a={visibleLayers:b.visibleLayers,context:b.context}))}const c=[_e.PORTAL_ITEM,_e.WEB_SCENE,_e.WEB_MAP].filter(w=>w>n&&w<=i);let h=null;for(const w of c){const{layers:b,visibleLayers:_,context:x}=this.sublayersSourceJSON[w];b&&(h={layers:b,context:x}),_&&(a={visibleLayers:_,context:x})}const d=aTe(s,o),y=new Map,v=new Set;if(h)for(const w of h.layers)y.set(w.id,w);if(a!=null&&a.visibleLayers)for(const w of a.visibleLayers)v.add(w);return bZ(d,w=>{h&&w.read(y.get(w.id),h.context),a&&w.read({defaultVisibility:v.has(w.id)},a.context)}),{origin:Q1(n),sublayers:new IM({items:d})}}read(r,i){super.read(r,i),this.readSublayers(r,i)}_handleSublayersChange(r,i){i&&(i.forEach(n=>{n.parent=null,n.layer=null}),this.removeHandles("sublayers-owner")),r&&(r.forEach(n=>{n.parent=this,n.layer=this}),this.addHandles([r.on("after-add",({item:n})=>{n.parent=this,n.layer=this}),r.on("after-remove",({item:n})=>{n.parent=null,n.layer=null})],"sublayers-owner"),this.type==="tile"&&this.addHandles(r.on("before-changes",n=>{oe.getLogger("esri.layers.TileLayer").error(new z("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",{layer:this})),n.preventDefault()}),"sublayers-owner"))}};return l([p({readOnly:!0})],t.prototype,"allSublayers",void 0),l([p({readOnly:!0,type:$e.ofType(hw)})],t.prototype,"serviceSublayers",void 0),l([p({value:null,type:IM,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],t.prototype,"sublayers",void 0),l([p({readOnly:!0})],t.prototype,"sublayersSourceJSON",void 0),t=l([k("esri.layers.mixins.SublayersOwner")],t),t};function Mje(e){var r;const t=e.layer;return"floorInfo"in t&&((r=t.floorInfo)!=null&&r.floorField)&&"floors"in e.view?SZ(e.view.floors,t.floorInfo.floorField):null}function cj(e,t){var r;return"floorInfo"in t&&((r=t.floorInfo)!=null&&r.floorField)?SZ(e,t.floorInfo.floorField):null}function SZ(e,t){if(!(e!=null&&e.length))return null;const r=e.filter(i=>i!=="").map(i=>`'${i}'`);return r.push("''"),`${t} IN (${r.join(",")}) OR ${t} IS NULL`}const lTe={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};let Ns=class extends De{constructor(t){super(t),this.floors=null,this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const t=this.visibleSublayers.map(r=>{const i=cj(this.floors,r);return r.toExportImageJSON(i)});return t.length?JSON.stringify(t):null}get hasDynamicLayers(){return this.layer&&sTe(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(t){this._get("layer")!==t&&(this._set("layer",t),this.removeHandles("layer"),t&&this.addHandles([t.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),t.on("sublayer-update",r=>this.notifyChange(lTe[r.propertyName]))],"layer"))}get layers(){const t=this.visibleSublayers;return t?t.length?"show:"+t.map(r=>r.id).join(","):"show:-1":null}get layerDefs(){var i;const t=!!((i=this.floors)!=null&&i.length),r=this.visibleSublayers.filter(n=>n.definitionExpression!=null||t&&n.floorInfo!=null);return r.length?JSON.stringify(r.reduce((n,s)=>{const o=cj(this.floors,s),a=WO(o,s.definitionExpression);return a!=null&&(n[s.id]=a),n},{})):null}get version(){this.commitProperty("layers"),this.commitProperty("layerDefs"),this.commitProperty("dynamicLayers"),this.commitProperty("timeExtent");const t=this.layer;return t&&(t.commitProperty("dpi"),t.commitProperty("imageFormat"),t.commitProperty("imageTransparency"),t.commitProperty("gdbVersion")),(this._get("version")||0)+1}get visibleSublayers(){const t=[];if(!this.layer)return t;const r=this.layer.sublayers,i=this.scale,n=o=>{o.visible&&(i===0||t0e(i,o.minScale,o.maxScale))&&(o.sublayers?o.sublayers.forEach(n):t.unshift(o))};r&&r.forEach(n);const s=this._get("visibleSublayers");return!s||s.length!==t.length||s.some((o,a)=>t[a]!==o)?t:s}toJSON(){const t=this.layer;let r={dpi:t.dpi,format:t.imageFormat,transparent:t.imageTransparency,gdbVersion:t.gdbVersion||null};return this.hasDynamicLayers&&this.dynamicLayers?r.dynamicLayers=this.dynamicLayers:r={...r,layers:this.layers,layerDefs:this.layerDefs},r}};l([p({readOnly:!0})],Ns.prototype,"dynamicLayers",null),l([p()],Ns.prototype,"floors",void 0),l([p({readOnly:!0})],Ns.prototype,"hasDynamicLayers",null),l([p()],Ns.prototype,"layer",null),l([p({readOnly:!0})],Ns.prototype,"layers",null),l([p({readOnly:!0})],Ns.prototype,"layerDefs",null),l([p({type:Number})],Ns.prototype,"scale",void 0),l([p(Vge)],Ns.prototype,"timeExtent",void 0),l([p({readOnly:!0})],Ns.prototype,"version",null),l([p({readOnly:!0})],Ns.prototype,"visibleSublayers",null),Ns=l([k("esri.layers.mixins.ExportImageParameters")],Ns);const pu=[];function IP(e,t){if(H4(e.url??""))return!0;const{wkid:r}=t;for(const i of pu){if((e.version??0)>=i[0])return!0;if(typeof i[1]=="function"&&(i[1]=i[1]()),i[1].has(r))return!1}return!0}pu.push([10.91,()=>{const e=new Set([9709,9716,9741,9761,9766]);for(let t=9712;t<=9713;t++)e.add(t);for(let t=9748;t<=9749;t++)e.add(t);for(let t=20904;t<=20932;t++)e.add(t);for(let t=21004;t<=21032;t++)e.add(t);for(let t=21207;t<=21264;t++)e.add(t);for(let t=21307;t<=21364;t++)e.add(t);for(let t=23301;t<=23333;t++)e.add(t);for(let t=102759;t<=102760;t++)e.add(t);for(let t=102934;t<=102955;t++)e.add(t);return e}]),pu.push([10.9,()=>{const e=new Set([9300,9354,9364,9367,9373,9377,9387,9456,9473,9498,9678,9680,29874,103599,103872,104028]);for(let t=9356;t<=9360;t++)e.add(t);for(let t=9404;t<=9407;t++)e.add(t);for(let t=9476;t<=9482;t++)e.add(t);for(let t=9487;t<=9494;t++)e.add(t);for(let t=9697;t<=9699;t++)e.add(t);return e}]),pu.push([10.81,()=>{const e=new Set([9265,9333,103598,103699]);for(let t=9248;t<=9254;t++)e.add(t);for(let t=9271;t<=9273;t++)e.add(t);for(let t=9284;t<=9285;t++)e.add(t);for(let t=21453;t<=21463;t++)e.add(t);return e}]),pu.push([10.8,()=>{const e=new Set([8088,8395,8428,8433,8531,8687,8692,8694,8699,8900,9003,9006,9009,9012,9017,9191]);for(let t=8035;t<=8036;t++)e.add(t);for(let t=8455;t<=8456;t++)e.add(t);for(let t=8518;t<=8529;t++)e.add(t);for(let t=8533;t<=8536;t++)e.add(t);for(let t=8538;t<=8540;t++)e.add(t);for(let t=8677;t<=8679;t++)e.add(t);for(let t=8902;t<=8903;t++)e.add(t);for(let t=8907;t<=8910;t++)e.add(t);for(let t=8949;t<=8951;t++)e.add(t);for(let t=8972;t<=8987;t++)e.add(t);for(let t=9039;t<=9040;t++)e.add(t);for(let t=9068;t<=9069;t++)e.add(t);for(let t=9140;t<=9141;t++)e.add(t);for(let t=9148;t<=9150;t++)e.add(t);for(let t=9153;t<=9159;t++)e.add(t);for(let t=9205;t<=9218;t++)e.add(t);for(let t=9221;t<=9222;t++)e.add(t);for(let t=54098;t<=54101;t++)e.add(t);return e}]),pu.push([10.71,()=>{const e=new Set([6316]);for(let t=8351;t<=8353;t++)e.add(t);for(let t=9294;t<=9297;t++)e.add(t);for(let t=22619;t<=22621;t++)e.add(t);for(let t=103586;t<=103594;t++)e.add(t);return e}]),pu.push([10.7,()=>{const e=new Set([8387,8391,8427,8545,8682,8685,8818,31370,104022,104024,104975]);for(let t=8065;t<=8068;t++)e.add(t);for(let t=8082;t<=8083;t++)e.add(t);for(let t=8379;t<=8385;t++)e.add(t);for(let t=8836;t<=8840;t++)e.add(t);for(let t=8857;t<=8860;t++)e.add(t);for(let t=53035;t<=53037;t++)e.add(t);for(let t=54090;t<=54091;t++)e.add(t);for(let t=102498;t<=102499;t++)e.add(t);return e}]),pu.push([10.61,()=>new Set([102497])]),pu.push([10.6,()=>{const e=new Set([7803,7805,7887,8086,8232,8237,8240,8246,8249,8252,8255,9019,9391]);for(let t=7755;t<=7787;t++)e.add(t);for(let t=7791;t<=7795;t++)e.add(t);for(let t=7799;t<=7801;t++)e.add(t);for(let t=7825;t<=7831;t++)e.add(t);for(let t=7877;t<=7878;t++)e.add(t);for(let t=7882;t<=7883;t++)e.add(t);for(let t=7991;t<=7992;t++)e.add(t);for(let t=8042;t<=8043;t++)e.add(t);for(let t=8058;t<=8059;t++)e.add(t);for(let t=8311;t<=8348;t++)e.add(t);for(let t=9060;t<=9067;t++)e.add(t);for(let t=102562;t<=102568;t++)e.add(t);for(let t=102799;t<=102900;t++)e.add(t);return e}]);let Cr=class extends zp(IT(Zp(_Z(sJ(tw(qp(Jp(kl(xf($T(rw(Yu)))))))))))){constructor(...t){super(...t),this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.dpi=96,this.gdbVersion=null,this.imageFormat="png24",this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.isReference=null,this.labelsVisible=!1,this.operationalLayerType="ArcGISMapServiceLayer",this.preferredTimeZone=null,this.sourceJSON=null,this.sublayers=null,this.type="map-image",this.url=null}normalizeCtorArgs(t,r){return typeof t=="string"?{url:t,...r}:t}load(t){const r=t!=null?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},t).catch(Ti).then(()=>this._fetchService(r))),Promise.resolve(this)}readImageFormat(t,r){const i=r.supportedImageFormatTypes;return i&&i.includes("PNG32")?"png32":"png24"}writeSublayers(t,r,i,n){var h,d,y;if(!this.loaded||!t)return;const s=t.slice().reverse().flatten(({sublayers:v})=>v&&v.toArray().reverse()).toArray();let o=!1;if((h=this.capabilities)!=null&&h.operations.supportsExportMap&&((y=(d=this.capabilities)==null?void 0:d.exportMap)!=null&&y.supportsDynamicLayers)){const v=Zn(n.origin);if(v===_e.PORTAL_ITEM){const w=this.createSublayersForOrigin("service").sublayers;o=uj(s,w,_e.SERVICE)}else if(v>_e.PORTAL_ITEM){const w=this.createSublayersForOrigin("portal-item");o=uj(s,w.sublayers,Zn(w.origin))}}const a=[],u={writeSublayerStructure:o,...n};let c=o;s.forEach(v=>{const w=v.write({},u);a.push(w),c=c||v.originOf("visible")==="user"}),a.some(v=>Object.keys(v).length>1)&&(r.layers=a),c&&(r.visibleLayers=s.filter(v=>v.visible).map(v=>v.id))}createExportImageParameters(t,r,i,n){const s=(n==null?void 0:n.pixelRatio)||1;t&&this.version>=10&&(t=t.clone().shiftCentralMeridian());const o=new Ns({layer:this,floors:n==null?void 0:n.floors,scale:$A({extent:t,width:r})*s}),a=o.toJSON();o.destroy();const u=!(n!=null&&n.rotation)||this.version<10.3?{}:{rotation:-n.rotation},c=t==null?void 0:t.spatialReference,h=Ip(c);a.dpi*=s;const d={};if(n!=null&&n.timeExtent){const{start:y,end:v}=n.timeExtent.toJSON();d.time=y&&v&&y===v?""+y:`${y??"null"},${v??"null"}`}else this.timeInfo&&!this.timeInfo.hasLiveData&&(d.time="null,null");return{bbox:t&&t.xmin+","+t.ymin+","+t.xmax+","+t.ymax,bboxSR:h,imageSR:h,size:r+","+i,...a,...u,...d}}async fetchImage(t,r,i,n){const{data:s}=await this._fetchImage("image",t,r,i,n);return s}async fetchImageBitmap(t,r,i,n){const{data:s,url:o}=await this._fetchImage("blob",t,r,i,n);return ux(s,o,n==null?void 0:n.signal)}async fetchRecomputedExtents(t={}){const r={...t,query:{returnUpdates:!0,f:"json",...this.customParameters,token:this.apiKey}},{data:i}=await be(this.url,r),{extent:n,fullExtent:s,timeExtent:o}=i,a=n||s;return{fullExtent:a&&Ne.fromJSON(a),timeExtent:o&&is.fromJSON({start:o[0],end:o[1]})}}loadAll(){return CT(this,t=>{t(this.allSublayers)})}serviceSupportsSpatialReference(t){return IP(this,t)}async _fetchImage(t,r,i,n,s){var u,c,h;const o={responseType:t,signal:(s==null?void 0:s.signal)??null,query:{...this.parsedUrl.query,...this.createExportImageParameters(r,i,n,s),f:"image",...this.refreshParameters,...this.customParameters,token:this.apiKey}},a=this.parsedUrl.path+"/export";if(((u=o.query)==null?void 0:u.dynamicLayers)!=null&&!((h=(c=this.capabilities)==null?void 0:c.exportMap)!=null&&h.supportsDynamicLayers))throw new z("mapimagelayer:dynamiclayer-not-supported",`service ${this.url} doesn't support dynamic layers, which is required to be able to change the sublayer's order, rendering, labeling or source.`,{query:o.query});try{const{data:d}=await be(a,o);return{data:d,url:a}}catch(d){throw Ei(d)?d:new z("mapimagelayer:image-fetch-error",`Unable to load image: ${a}`,{error:d})}}async _fetchService(t){if(this.sourceJSON)return void this.read(this.sourceJSON,{origin:"service",url:this.parsedUrl});const{data:r,ssl:i}=await be(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},signal:t});i&&(this.url=this.url.replace(/^http:/i,"https:")),this.sourceJSON=r,this.read(r,{origin:"service",url:this.parsedUrl})}};l([p(xm("dateFieldsTimeReference"))],Cr.prototype,"dateFieldsTimeZone",void 0),l([p({type:Boolean})],Cr.prototype,"datesInUnknownTimezone",void 0),l([p()],Cr.prototype,"dpi",void 0),l([p()],Cr.prototype,"gdbVersion",void 0),l([p()],Cr.prototype,"imageFormat",void 0),l([te("imageFormat",["supportedImageFormatTypes"])],Cr.prototype,"readImageFormat",null),l([p({json:{origins:{service:{read:{source:"maxImageHeight"}}}}})],Cr.prototype,"imageMaxHeight",void 0),l([p({json:{origins:{service:{read:{source:"maxImageWidth"}}}}})],Cr.prototype,"imageMaxWidth",void 0),l([p()],Cr.prototype,"imageTransparency",void 0),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Cr.prototype,"isReference",void 0),l([p({json:{read:!1,write:!1}})],Cr.prototype,"labelsVisible",void 0),l([p({type:["ArcGISMapServiceLayer"]})],Cr.prototype,"operationalLayerType",void 0),l([p({json:{read:!1,write:!1}})],Cr.prototype,"popupEnabled",void 0),l([p(xm("preferredTimeReference"))],Cr.prototype,"preferredTimeZone",void 0),l([p()],Cr.prototype,"sourceJSON",void 0),l([p({json:{write:{ignoreOrigin:!0}}})],Cr.prototype,"sublayers",void 0),l([se("sublayers",{layers:{type:[hw]},visibleLayers:{type:[Ke]}})],Cr.prototype,"writeSublayers",null),l([p({type:["show","hide","hide-children"]})],Cr.prototype,"listMode",void 0),l([p({json:{read:!1},readOnly:!0,value:"map-image"})],Cr.prototype,"type",void 0),l([p(Qv)],Cr.prototype,"url",void 0),Cr=l([k("esri.layers.MapImageLayer")],Cr);const xZ=Cr,Aje=Object.freeze(Object.defineProperty({__proto__:null,default:xZ},Symbol.toStringTag,{value:"Module"}));var mR;const pj=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Elevation/World_Hillshade_Dark","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];let Zr=mR=class extends zp(Zp(_Z(YH(sJ(qp(Jp(tw(kl(xf($T(rw(Yu)))))))))))){constructor(...e){super(...e),this.listMode="show",this.isReference=null,this.operationalLayerType="ArcGISTiledMapServiceLayer",this.resampling=!0,this.sourceJSON=null,this.spatialReference=null,this.path=null,this.sublayers=null,this.type="tile",this.url=null}normalizeCtorArgs(e,t){return typeof e=="string"?{url:e,...t}:e}load(e){const t=e!=null?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},e).catch(Ti).then(()=>this._fetchService(t))),Promise.resolve(this)}get attributionDataUrl(){var t;const e=(t=this.parsedUrl)==null?void 0:t.path.toLowerCase();return e?this._getDefaultAttribution(this._getMapName(e)):null}readSpatialReference(e,t){var r;return(e=e||((r=t.tileInfo)==null?void 0:r.spatialReference))&&xe.fromJSON(e)}writeSublayers(e,t,r,i){if(!this.loaded||!e)return;const n=e.slice().reverse().flatten(({sublayers:a})=>a&&a.toArray().reverse()).toArray(),s=[],o={writeSublayerStructure:!1,...i};n.forEach(a=>{const u=a.write({},o);s.push(u)}),s.some(a=>Object.keys(a).length>1)&&(t.layers=s)}get tileServers(){var e;return this._getDefaultTileServers((e=this.parsedUrl)==null?void 0:e.path)}castTileServers(e){return Array.isArray(e)?e.map(t=>Pt(t).path):null}fetchTile(e,t,r,i={}){const{signal:n}=i,s=this.getTileUrl(e,t,r),o={responseType:"image",signal:n,query:{...this.refreshParameters}};return be(s,o).then(a=>a.data)}async fetchImageBitmapTile(e,t,r,i={}){const{signal:n}=i;if(this.fetchTile!==mR.prototype.fetchTile){const u=await this.fetchTile(e,t,r,i);return Em(u,e,t,r,n)}const s=this.getTileUrl(e,t,r),o={responseType:"blob",signal:n,query:{...this.refreshParameters}},{data:a}=await be(s,o);return Em(a,e,t,r,n)}getTileUrl(e,t,r){var o,a;const i=!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile,n=Il({...(o=this.parsedUrl)==null?void 0:o.query,blankTile:!i&&null,...this.customParameters,token:this.apiKey}),s=this.tileServers;return`${s&&s.length?s[t%s.length]:(a=this.parsedUrl)==null?void 0:a.path}/tile/${e}/${t}/${r}${n?"?"+n:""}`}loadAll(){return CT(this,e=>{e(this.allSublayers)})}_fetchService(e){return new Promise((t,r)=>{if(this.sourceJSON){if(this.sourceJSON.bandCount!=null&&this.sourceJSON.pixelSizeX!=null)throw new z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");return void t({data:this.sourceJSON})}if(!this.parsedUrl)throw new z("tile-layer:undefined-url","layer's url is not defined");const i=zu(this.parsedUrl.path);if(i!=null&&i.serverType==="ImageServer")throw new z("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");be(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(t,r)}).then(t=>{let r=this.url;if(t.ssl&&(r=this.url=r.replace(/^http:/i,"https:")),this.sourceJSON=t.data,this.read(t.data,{origin:"service",url:this.parsedUrl}),this.version===10.1&&!H4(r))return this._fetchServerVersion(r,e).then(i=>{this.read({currentVersion:i})}).catch(()=>{})})}_fetchServerVersion(e,t){if(!q1e(e))return Promise.reject();const r=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return be(r,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then(i=>{if(i.data&&i.data.currentVersion)return i.data.currentVersion;throw new z("tile-layer:version-not-available")})}_getMapName(e){const t=e.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return t?t[2]:void 0}_getDefaultAttribution(e){if(e==null)return null;let t;e=e.toLowerCase();for(let r=0,i=pj.length;r<i;r++)if(t=pj[r],t.toLowerCase().includes(e))return Js("//static.arcgis.com/attribution/"+t);return null}_getDefaultTileServers(e){if(e==null)return[];const t=e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i)!==-1,r=e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i)!==-1;return t||r?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile[TZ]}};l([p({readOnly:!0})],Zr.prototype,"attributionDataUrl",null),l([p({type:["show","hide","hide-children"]})],Zr.prototype,"listMode",void 0),l([p({json:{read:!0,write:!0}})],Zr.prototype,"blendMode",void 0),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],Zr.prototype,"isReference",void 0),l([p({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],Zr.prototype,"operationalLayerType",void 0),l([p({type:Boolean})],Zr.prototype,"resampling",void 0),l([p()],Zr.prototype,"sourceJSON",void 0),l([p({type:xe})],Zr.prototype,"spatialReference",void 0),l([te("spatialReference",["spatialReference","tileInfo"])],Zr.prototype,"readSpatialReference",null),l([p({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Zr.prototype,"path",void 0),l([p({readOnly:!0})],Zr.prototype,"sublayers",void 0),l([se("sublayers",{layers:{type:[hw]}})],Zr.prototype,"writeSublayers",null),l([p({json:{read:!1,write:!1}})],Zr.prototype,"popupEnabled",void 0),l([p()],Zr.prototype,"tileServers",null),l([Tt("tileServers")],Zr.prototype,"castTileServers",null),l([p({readOnly:!0,json:{read:!1}})],Zr.prototype,"type",void 0),l([p(Qv)],Zr.prototype,"url",void 0),Zr=mR=l([k("esri.layers.TileLayer")],Zr);const TZ=Symbol("default-fetch-tile");Zr.prototype.fetchTile[TZ]=!0;const IZ=Zr,Rje=Object.freeze(Object.defineProperty({__proto__:null,default:IZ},Symbol.toStringTag,{value:"Module"}));var gR;const e_=new We({flow_from:"flow-from",flow_to:"flow-to"});let mn=gR=class extends Kp(Q){constructor(e){super(e),this.density=.8,this.color=new ve([255,255,255,1]),this.maxPathLength=200,this.trailWidth=1.5,this.flowSpeed=10,this.trailLength=100,this.smoothing=0,this.flowRepresentation="flow-from",this.type="flow",this.authoringInfo=null,this.legendOptions=null,this.trailCap="butt",this.background="none"}clone(){var v,w;const{density:e,maxPathLength:t,trailWidth:r,flowSpeed:i,trailLength:n,smoothing:s,flowRepresentation:o,trailCap:a,background:u}=this,c=this.color.clone(),h=(this.visualVariables||[]).map(b=>b.clone()),d=(v=this.authoringInfo)==null?void 0:v.clone(),y=(w=this.legendOptions)==null?void 0:w.clone();return new gR({density:e,color:c,maxPathLength:t,trailWidth:r,flowSpeed:i,trailLength:n,trailCap:a,background:u,smoothing:s,flowRepresentation:o,visualVariables:h,authoringInfo:d,legendOptions:y})}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}};l([p({type:Number,json:{write:!0}})],mn.prototype,"density",void 0),l([p({type:ve,json:{write:{allowNull:!0}}})],mn.prototype,"color",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],mn.prototype,"maxPathLength",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],mn.prototype,"trailWidth",void 0),l([p({type:Number,json:{write:!0}})],mn.prototype,"flowSpeed",void 0),l([p({type:Number,json:{write:!0}})],mn.prototype,"trailLength",void 0),l([p({type:Number,cast:wt,json:{write:!1}})],mn.prototype,"smoothing",void 0),l([p({type:e_.apiValues,json:{type:e_.jsonValues,read:{reader:e_.read},write:{writer:e_.write}}})],mn.prototype,"flowRepresentation",void 0),l([Ce({flowRenderer:"flow"})],mn.prototype,"type",void 0),l([p({type:sw,json:{write:!0}})],mn.prototype,"authoringInfo",void 0),l([p({type:Zd,json:{write:!0}})],mn.prototype,"legendOptions",void 0),l([p({type:String,json:{write:!0}})],mn.prototype,"trailCap",void 0),l([p({type:String,json:{write:!0}})],mn.prototype,"background",void 0),mn=gR=l([k("esri.renderers.FlowRenderer")],mn);const MZ=mn;let yy=class extends Q{constructor(){super(...arguments),this.value=null,this.label=null,this.color=null}};l([p({type:Number,json:{write:!0}})],yy.prototype,"value",void 0),l([p({type:String,json:{write:!0}})],yy.prototype,"label",void 0),l([p({type:ve,json:{type:[Ke],write:!0}})],yy.prototype,"color",void 0),yy=l([k("esri.renderers.support.ColormapInfo")],yy);const $Z=yy,Oje=["random","ndvi","ndvi2","ndvi3","elevation","gray","hillshade"],MP=[{id:"aspect",type:"multipart",colorRamps:[{fromColor:[190,190,190],toColor:[255,45,8]},{fromColor:[255,45,8],toColor:[255,181,61]},{fromColor:[255,181,61],toColor:[255,254,52]},{fromColor:[255,254,52],toColor:[0,251,50]},{fromColor:[0,251,50],toColor:[255,254,52]},{fromColor:[0,253,255],toColor:[0,181,255]},{fromColor:[0,181,255],toColor:[26,35,253]},{fromColor:[26,35,253],toColor:[255,57,251]},{fromColor:[255,57,251],toColor:[255,45,8]}]},{id:"black-to-white",fromColor:[0,0,0],toColor:[255,255,255]},{id:"blue-bright",fromColor:[204,204,255],toColor:[0,0,224]},{id:"blue-light-to-dark",fromColor:[211,229,232],toColor:[46,100,140]},{id:"blue-green-bright",fromColor:[203,245,234],toColor:[48,207,146]},{id:"blue-green-light-to-dark",fromColor:[216,242,237],toColor:[21,79,74]},{id:"brown-light-to-dark",fromColor:[240,236,170],toColor:[102,72,48]},{id:"brown-to-blue-green-diverging-right",type:"multipart",colorRamps:[{fromColor:[156,85,31],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[33,130,145]}]},{id:"brown-to-blue-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[110,70,45],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[48,100,102]}]},{id:"coefficient-bias",fromColor:[214,214,255],toColor:[0,57,148]},{id:"cold-to-hot-diverging",type:"multipart",colorRamps:[{fromColor:[69,117,181],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[214,47,39]}]},{id:"condition-number",type:"multipart",colorRamps:[{fromColor:[0,97,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,34,0]}]},{id:"cyan-to-purple",type:"multipart",colorRamps:[{fromColor:[0,245,245],toColor:[0,0,245]},{fromColor:[0,0,245],toColor:[245,0,245]}]},{id:"cyan-light-to-blue-dark",type:"multipart",colorRamps:[{fromColor:[182,237,240],toColor:[31,131,224]},{fromColor:[31,131,224],toColor:[9,9,145]}]},{id:"distance",fromColor:[255,200,0],toColor:[0,0,255]},{id:"elevation1",type:"multipart",colorRamps:[{fromColor:[175,240,233],toColor:[255,255,179]},{fromColor:[255,255,179],toColor:[0,128,64]},{fromColor:[0,128,64],toColor:[252,186,3]},{fromColor:[252,186,3],toColor:[128,0,0]},{fromColor:[120,0,0],toColor:[105,48,13]},{fromColor:[105,48,13],toColor:[171,171,171]},{fromColor:[171,171,171],toColor:[255,252,255]}]},{id:"elevation2",type:"multipart",colorRamps:[{fromColor:[118,219,211],toColor:[255,255,199]},{fromColor:[255,255,199],toColor:[255,255,128]},{fromColor:[255,255,128],toColor:[217,194,121]},{fromColor:[217,194,121],toColor:[135,96,38]},{fromColor:[135,96,38],toColor:[150,150,181]},{fromColor:[150,150,181],toColor:[181,150,181]},{fromColor:[181,150,181],toColor:[255,252,255]}]},{id:"errors",fromColor:[255,235,214],toColor:[196,10,10]},{id:"gray-light-to-dark",fromColor:[219,219,219],toColor:[69,69,69]},{id:"green-bright",fromColor:[204,255,204],toColor:[14,204,14]},{id:"green-light-to-dark",fromColor:[220,245,233],toColor:[34,102,51]},{id:"green-to-blue",type:"multipart",colorRamps:[{fromColor:[32,204,16],toColor:[0,242,242]},{fromColor:[0,242,242],toColor:[2,33,227]}]},{id:"orange-bright",fromColor:[255,235,204],toColor:[240,118,5]},{id:"orange-light-to-dark",fromColor:[250,233,212],toColor:[171,65,36]},{id:"partial-spectrum",type:"multipart",colorRamps:[{fromColor:[242,241,162],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]},{fromColor:[252,3,69],toColor:[176,7,237]},{fromColor:[176,7,237],toColor:[2,29,173]}]},{id:"partial-spectrum-1-diverging",type:"multipart",colorRamps:[{fromColor:[135,38,38],toColor:[240,149,12]},{fromColor:[240,149,12],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[74,80,181]},{fromColor:[74,80,181],toColor:[39,32,122]}]},{id:"partial-spectrum-2-diverging",type:"multipart",colorRamps:[{fromColor:[115,77,42],toColor:[201,137,52]},{fromColor:[201,137,52],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[91,63,176]},{fromColor:[91,63,176],toColor:[81,13,97]}]},{id:"pink-to-yellow-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[158,30,113],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[99,110,45]}]},{id:"pink-to-yellow-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,47,73],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[22,59,15]}]},{id:"precipitation",type:"multipart",colorRamps:[{fromColor:[194,82,60],toColor:[237,161,19]},{fromColor:[237,161,19],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,219,0]},{fromColor:[0,219,0],toColor:[32,153,143]},{fromColor:[32,153,143],toColor:[11,44,122]}]},{id:"prediction",type:"multipart",colorRamps:[{fromColor:[40,146,199],toColor:[250,250,100]},{fromColor:[250,250,100],toColor:[232,16,20]}]},{id:"purple-bright",fromColor:[255,204,255],toColor:[199,0,199]},{id:"purple-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[77,32,150],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[20,122,11]}]},{id:"purple-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[67,14,89],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[24,79,15]}]},{id:"purple-blue-bright",fromColor:[223,184,230],toColor:[112,12,242]},{id:"purple-blue-light-to-dark",fromColor:[229,213,242],toColor:[93,44,112]},{id:"purple-red-bright",fromColor:[255,204,225],toColor:[199,0,99]},{id:"purple-red-light-to-dark",fromColor:[250,215,246],toColor:[143,17,57]},{id:"red-bright",fromColor:[255,204,204],toColor:[219,0,0]},{id:"red-light-to-dark",fromColor:[255,224,224],toColor:[143,10,10]},{id:"red-to-blue-diverging-bright",type:"multipart",colorRamps:[{fromColor:[196,69,57],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[48,95,207]}]},{id:"red-to-blue-diverging-dark",type:"multipart",colorRamps:[{fromColor:[107,13,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[13,53,97]}]},{id:"red-to-green",type:"multipart",colorRamps:[{fromColor:[245,0,0],toColor:[245,245,0]},{fromColor:[245,245,0],toColor:[0,245,0]}]},{id:"red-to-green-diverging-bright",type:"multipart",colorRamps:[{fromColor:[186,20,20],toColor:[255,255,191]},{fromColor:[255,255,191],toColor:[54,145,33]}]},{id:"red-to-green-diverging-dark",type:"multipart",colorRamps:[{fromColor:[97,21,13],toColor:[204,204,102]},{fromColor:[204,204,102],toColor:[16,69,16]}]},{id:"slope",type:"multipart",colorRamps:[{fromColor:[56,168,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]},{id:"spectrum-full-bright",type:"multipart",colorRamps:[{fromColor:[255,0,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,0,255]}]},{id:"spectrum-full-dark",type:"multipart",colorRamps:[{fromColor:[153,0,0],toColor:[153,153,0]},{fromColor:[153,153,0],toColor:[0,153,153]},{fromColor:[0,153,153],toColor:[0,0,153]}]},{id:"spectrum-full-light",type:"multipart",colorRamps:[{fromColor:[255,153,153],toColor:[255,255,153]},{fromColor:[255,255,153],toColor:[153,255,255]},{fromColor:[153,255,255],toColor:[153,153,255]}]},{id:"surface",type:"multipart",colorRamps:[{fromColor:[112,153,89],toColor:[242,238,162]},{fromColor:[242,238,162],toColor:[242,206,133]},{fromColor:[242,206,133],toColor:[194,140,124]},{fromColor:[194,140,124],toColor:[255,242,255]}]},{id:"temperature",type:"multipart",colorRamps:[{fromColor:[255,252,255],toColor:[255,0,255]},{fromColor:[255,0,255],toColor:[0,0,255]},{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[0,255,0]},{fromColor:[0,255,0],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,128,0]},{fromColor:[255,128,0],toColor:[128,0,0]}]},{id:"white-to-black",fromColor:[255,255,255],toColor:[0,0,0]},{id:"yellow-to-dark-red",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[242,167,46]},{fromColor:[242,167,46],toColor:[107,0,0]}]},{id:"yellow-to-green-to-dark-blue",type:"multipart",colorRamps:[{fromColor:[255,255,128],toColor:[56,224,9]},{fromColor:[56,224,9],toColor:[26,147,171]},{fromColor:[26,147,171],toColor:[12,16,120]}]},{id:"yellow-to-red",fromColor:[245,245,0],toColor:[255,0,0]},{id:"yellow-green-bright",fromColor:[236,252,204],toColor:[157,204,16]},{id:"yellow-green-light-to-dark",fromColor:[215,240,175],toColor:[96,107,45]}],uTe=new We({Aspect:"aspect","Black to White":"black-to-white","Blue Bright":"blue-bright","Blue Light to Dark":"blue-light-to-dark","Blue-Green Bright":"blue-green-bright","Blue-Green Light to Dark":"blue-green-light-to-dark","Brown Light to Dark":"brown-light-to-dark","Brown to Blue Green Diverging, Bright":"brown-to-blue-green-diverging-right","Brown to Blue Green Diverging, Dark":"brown-to-blue-green-diverging-dark","Coefficient Bias":"coefficient-bias","Cold to Hot Diverging":"cold-to-hot-diverging","Condition Number":"condition-number","Cyan to Purple":"cyan-to-purple","Cyan-Light to Blue-Dark":"cyan-light-to-blue-dark",Distance:"distance","Elevation #1":"elevation1","Elevation #2":"elevation2",Errors:"errors","Gray Light to Dark":"gray-light-to-dark","Green Bright":"green-bright","Green Light to Dark":"green-light-to-dark","Green to Blue":"green-to-blue","Orange Bright":"orange-bright","Orange Light to Dark":"orange-light-to-dark","Partial Spectrum":"partial-spectrum","Partial Spectrum 1 Diverging":"partial-spectrum-1-diverging","Partial Spectrum 2 Diverging":"partial-spectrum-2-diverging","Pink to YellowGreen Diverging, Bright":"pink-to-yellow-green-diverging-bright","Pink to YellowGreen Diverging, Dark":"pink-to-yellow-green-diverging-dark",Precipitation:"precipitation",Prediction:"prediction","Purple Bright":"purple-bright","Purple to Green Diverging, Bright":"purple-to-green-diverging-bright","Purple to Green Diverging, Dark":"purple-to-green-diverging-dark","Purple-Blue Bright":"purple-blue-bright","Purple-Blue Light to Dark":"purple-blue-light-to-dark","Purple-Red Bright":"purple-red-bright","Purple-Red Light to Dark":"purple-red-light-to-dark","Red Bright":"red-bright","Red Light to Dark":"red-light-to-dark","Red to Blue Diverging, Bright":"red-to-blue-diverging-bright","Red to Blue Diverging, Dark":"red-to-blue-diverging-dark","Red to Green":"red-to-green","Red to Green Diverging, Bright":"red-to-green-diverging-bright","Red to Green Diverging, Dark":"red-to-green-diverging-dark",Slope:"slope","Spectrum-Full Bright":"spectrum-full-bright","Spectrum-Full Dark":"spectrum-full-dark","Spectrum-Full Light":"spectrum-full-light",Surface:"surface",Temperature:"temperature","White to Black":"white-to-black","Yellow to Dark Red":"yellow-to-dark-red","Yellow to Green to Dark Blue":"yellow-to-green-to-dark-blue","Yellow to Red":"yellow-to-red","Yellow-Green Bright":"yellow-green-bright","Yellow-Green Light to Dark":"yellow-green-light-to-dark"});function t_(e,t){if(!e||!t||e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]>t[r]+2||e[r]<t[r]-2)return!1;return!0}function hj(e){const t=e.clone();return t.fromColor=e.toColor,t.toColor=e.fromColor,t.algorithm=e.algorithm,t}function cTe(e){var t;if(e.type==="multipart"){const r=e.clone();return(t=r.colorRamps)!=null&&t.length&&(r.colorRamps=r.colorRamps.reverse().map(i=>hj(i))),r}return hj(e)}function dj(e,t){if(!e)return;const r=MP;let i=null;return e.type==="algorithmic"?r.some(n=>{if(t_(e.fromColor.toRgb(),n.fromColor)&&t_(e.toColor.toRgb(),n.toColor))return i=n.id,!0}):e.type==="multipart"&&r.some(n=>{const s=e.colorRamps,o=n.colorRamps;if(s&&o&&s.length===o.length&&!o.some((a,u)=>{if(!t_(s[u].fromColor.toRgb(),new ve(a.fromColor).toRgb())||!t_(s[u].toColor.toRgb(),new ve(a.toColor).toRgb()))return!0})){if(i)return!0;i=n.id}}),i}function pTe(e,t,r=!1){if(!e)return;let i=!1,n=dj(e);return n!=null||r||(i=!0,n=dj(e=cTe(e))),n?{id:n,inverted:i}:void 0}function EZ(e,t=!1){var i;const r=typeof e=="string"?e:(i=pTe(e,void 0,t))==null?void 0:i.id;return r?uTe.toJSON(r):null}function Pje(e,t="esriCIELabAlgorithm"){const r=MP.find(({id:i})=>i===e);return r?r.colorRamps?{type:"multipart",colorRamps:r.colorRamps.map(i=>({type:"algorithmic",algorithm:t,fromColor:[...i.fromColor],toColor:[...i.toColor]}))}:{type:"algorithmic",algorithm:t,fromColor:[...r.fromColor],toColor:[...r.toColor]}:null}function AZ(e){const t=(e=e||{}).numColors||256,r=e.distanceOffset||0,i=e.isCustomInterval!=null?e.isCustomInterval:e.distanceInterval!==null&&e.distanceInterval!==1/(t-1),n=e.distanceInterval||1/(t-1);return{...e,numColors:t,distanceOffset:r,interpolateAlpha:!!e.interpolateAlpha,distanceInterval:n,isCustomInterval:i,weights:e.weights}}function hTe(e,t,r){const{numColors:i,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=r,a=e.s===0,u=t.s===0;let c=e.h,h=t.h;a&&!u?c=h:u&&!a&&(t={...t,h:c},h=c);let d,y=Math.abs(h-c);const v=360;y<v/2?d=(h-c)*s:(y=v-y,d=c>h?y*s:-y*s);const w=(t.s-e.s)*s,b=(t.v-e.v)*s;let{s:_,v:x}=e,T=c;if(n){const M=n/s;T=(T+M*d+v)%v,_+=M*w,x+=M*b}const I=[];for(let M=0;M<i-1;M++)I.push({h:T,s:_,v:x}),T=(T+d+v)%v,_+=w,x+=b;return I.push(o?{h:T,s:_,v:x}:t),I}function dTe(e,t,r){const{numColors:i,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=r;let{l:a,a:u,b:c}=e;const h=(t.l-a)*s,d=(t.a-u)*s,y=(t.b-c)*s,v=[];if(n){const w=n/s;a+=w*h,u+=w*d,c+=w*y}for(let w=0;w<i-1;w++)v.push({l:a,a:u,b:c}),a+=h,u+=d,c+=y;return v.push(o?{l:a,a:u,b:c}:t),v}function fTe(e,t,r){const{numColors:i,distanceOffset:n,distanceInterval:s,isCustomInterval:o}=r,a=e.h,u=t.h,c=2*Math.PI;let h;if(a<=u){const T=u-a,I=u-a-c;h=Math.abs(I)<Math.abs(T)?I:T}else{const T=u+c-a,I=u-a;h=Math.abs(I)<Math.abs(T)?I:T}const d=h*s,y=(t.l-e.l)*s,v=(t.c-e.c)*s;let{l:w,c:b,h:_}=e;if(n){const T=n/s;w+=T*y,b+=T*v,_=(_+T*d+c)%c}const x=[];for(let T=0;T<i-1;T++)x.push({l:w,c:b,h:_}),w+=y,b+=v,_=(_+d+c)%c;return x.push(o?{l:w,c:b,h:_}:t),x}function RZ(e,t){let{fromColor:r,toColor:i}=e;r=[...r],i=[...i],r.length===3&&(r=r.concat([255])),i.length===3&&(i=i.concat([255]));const n=e.algorithm||"esriCIELabAlgorithm",s=AZ(t),{numColors:o,distanceOffset:a,isCustomInterval:u,interpolateAlpha:c}=s;if(o===1&&a===0)return[r];if(o===2&&a===0&&!u)return[r,i];const h={r:r[0],g:r[1],b:r[2]},d={r:i[0],g:i[1],b:i[2]},y=n==="esriCIELabAlgorithm"?dTe(dx(h),dx(d),s):n==="esriHSVAlgorithm"?hTe(hx(h),hx(d),s):fTe(fx(h),fx(d),s),v=[],w=r[3]??255,b=((i[3]??255)-w)/(o-1);for(let _=0;_<o;_++){const{r:x,g:T,b:I}=Rm(y[_]),M=c?Math.round(w+b*_):255;v.push([x,T,I,M])}return v}function yTe(e,t){const{numColors:r,interpolateAlpha:i}=AZ(t);let n=t==null?void 0:t.weights;const{colorRamps:s}=e;if(n){const d=n.reduce((y,v)=>y+v);n=n.map(y=>y/d)}else{n=[];for(let d=0;d<s.length;d++)n[d]=1/s.length}const o=[],a=1/(r-1);let u=0,c=!1;for(let d=0;d<s.length;d++){const y=o.length,v=c?0:y*a-u;u+=n[d];let w=d===s.length-1?r-1-y:(n[d]-v)/a;if(c=Math.ceil(w)===w,w=Math.ceil(w),w===0)continue;const b=RZ(s[d],{numColors:w,interpolateAlpha:i,distanceOffset:v/n[d],distanceInterval:a/n[d]});o.push(...b)}const h=[...s[s.length-1].toColor];return h.length===3&&h.push(255),o.push(h),o}function mTe(e,t){const r=rv(e)?e.toJSON():e;return r.type==="multipart"?yTe(r,t):RZ(r,t)}function km(e,t){const r=mTe(e,t),i=t==null?void 0:t.interpolateAlpha;return r.forEach((n,s)=>{n.unshift(s),i||n.pop()}),r}function fj(e){const t=hx(e);return{type:"HsvColor",Hue:t.h,Saturation:t.s,Value:t.v,AlphaValue:255}}function yj(e){const t=e.toJSON();return{Algorithm:(t==null?void 0:t.Algorithm)||"esriHSVAlgorithm",type:"AlgorithmicColorRamp",FromColor:fj(e.fromColor),ToColor:fj(e.toColor)}}function CZ(e){const t=EZ(e);if(!t)return null;if(e.type==="algorithmic")return{...yj(e),Name:t};if(e.colorRamps){const r=e.colorRamps.map(yj);return{type:"MultiPartColorRamp",NumColorRamps:r.length,ArrayOfColorRamp:r,Name:t}}return null}function gTe(e){const t=e.reverse().map(r=>{const i=r.toString(16);return i.length<2?"0"+i:i});return 4294967295&Number.parseInt(t.join(""),16)}var Xg;let Qg=Xg=class extends Q{constructor(e){super(e),this.colormapInfos=null,this.type="raster-colormap"}static createFromColormap(e,t){if(!e)return null;const r=e[0].length===5,i=[...e].sort((n,s)=>n[0]-s[0]).map(n=>$Z.fromJSON({value:n[0],color:r?n.slice(1,5):n.slice(1,4).concat([255]),label:t?t[n[0]]??"":n[0]}));return new Xg({colormapInfos:i})}static createFromColorramp(e){const t=km(e);return Xg.createFromColormap(t)}clone(){return new Xg({colormapInfos:this.colormapInfos.map(e=>e.toJSON())})}extractColormap(){return this.colormapInfos.map(({value:e,color:t})=>[e,t.r,t.g,t.b,t.a>1?t.a:255*t.a&255]).sort((e,t)=>e[0]-t[0])}};l([p({type:[$Z],json:{write:!0}})],Qg.prototype,"colormapInfos",void 0),l([Ce({rasterColormap:"raster-colormap"})],Qg.prototype,"type",void 0),Qg=Xg=l([k("esri.renderers.RasterColormapRenderer")],Qg);const $P=Qg;var vR;let Ds=vR=class extends Q{constructor(e){super(e),this.altitude=45,this.azimuth=315,this.colorRamp=null,this.hillshadeType="traditional",this.pixelSizePower=.664,this.pixelSizeFactor=.024,this.scalingType="none",this.type="raster-shaded-relief",this.zFactor=1}readColorRamp(e){return iP(e)}clone(){return new vR({hillshadeType:this.hillshadeType,altitude:this.altitude,azimuth:this.azimuth,zFactor:this.zFactor,scalingType:this.scalingType,pixelSizeFactor:this.pixelSizeFactor,pixelSizePower:this.pixelSizePower,colorRamp:B(this.colorRamp)})}};l([p({type:Number,json:{write:!0}})],Ds.prototype,"altitude",void 0),l([p({type:Number,json:{write:!0}})],Ds.prototype,"azimuth",void 0),l([p({types:rP,json:{write:!0}})],Ds.prototype,"colorRamp",void 0),l([te("colorRamp")],Ds.prototype,"readColorRamp",null),l([p({type:["traditional","multi-directional"],json:{write:!0}})],Ds.prototype,"hillshadeType",void 0),l([p({type:Number,json:{write:!0}})],Ds.prototype,"pixelSizePower",void 0),l([p({type:Number,json:{write:!0}})],Ds.prototype,"pixelSizeFactor",void 0),l([p({type:["none","adjusted"],json:{write:!0}})],Ds.prototype,"scalingType",void 0),l([Ce({rasterShadedRelief:"raster-shaded-relief"})],Ds.prototype,"type",void 0),l([p({type:Number,json:{write:!0}})],Ds.prototype,"zFactor",void 0),Ds=vR=l([k("esri.renderers.RasterShadedReliefRenderer")],Ds);const OZ=Ds,U1=new We({none:"none",standardDeviation:"standard-deviation",histogramEqualization:"histogram-equalization",minMax:"min-max",percentClip:"percent-clip",sigmoid:"sigmoid"}),PZ={0:"none",3:"standardDeviation",4:"histogramEqualization",5:"minMax",6:"percentClip",9:"sigmoid"};var wR;let Jr=wR=class extends Q{constructor(e){super(e),this.colorRamp=null,this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.maxPercent=null,this.minPercent=null,this.numberOfStandardDeviations=null,this.outputMax=null,this.outputMin=null,this.sigmoidStrengthLevel=null,this.statistics=[],this.histograms=null,this.useGamma=!1,this.stretchType="none",this.type="raster-stretch"}readColorRamp(e){if(e)return iP(e)}writeStatistics(e,t,r){e!=null&&e.length&&(Array.isArray(e[0])||(e=e.map(i=>[i.min,i.max,i.avg,i.stddev])),t[r]=e)}readStretchType(e,t){let r=t.stretchType;return typeof r=="number"&&(r=PZ[r]),U1.read(r)}clone(){return new wR({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:B(this.statistics),gamma:B(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,colorRamp:B(this.colorRamp),histograms:B(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment})}};l([p({types:rP,json:{write:!0}})],Jr.prototype,"colorRamp",void 0),l([te("colorRamp")],Jr.prototype,"readColorRamp",null),l([p({type:Boolean,json:{write:!0}})],Jr.prototype,"computeGamma",void 0),l([p({type:Boolean,json:{write:{target:"dra"},read:{source:"dra"}}})],Jr.prototype,"dynamicRangeAdjustment",void 0),l([p({type:[Number],json:{write:!0}})],Jr.prototype,"gamma",void 0),l([p({type:Number,json:{write:!0}})],Jr.prototype,"maxPercent",void 0),l([p({type:Number,json:{write:!0}})],Jr.prototype,"minPercent",void 0),l([p({type:Number,json:{write:!0}})],Jr.prototype,"numberOfStandardDeviations",void 0),l([p({type:Number,json:{read:{source:"max"},write:{target:"max"}}})],Jr.prototype,"outputMax",void 0),l([p({type:Number,json:{read:{source:"min"},write:{target:"min"}}})],Jr.prototype,"outputMin",void 0),l([p({type:Number,json:{write:!0}})],Jr.prototype,"sigmoidStrengthLevel",void 0),l([p({json:{type:[[Number]],write:!0}})],Jr.prototype,"statistics",void 0),l([p()],Jr.prototype,"histograms",void 0),l([se("statistics")],Jr.prototype,"writeStatistics",null),l([p({type:Boolean,json:{write:!0}})],Jr.prototype,"useGamma",void 0),l([p({type:U1.apiValues,json:{type:U1.jsonValues,write:U1.write}})],Jr.prototype,"stretchType",void 0),l([te("stretchType",["stretchType"])],Jr.prototype,"readStretchType",null),l([Ce({rasterStretch:"raster-stretch"})],Jr.prototype,"type",void 0),Jr=wR=l([k("esri.renderers.RasterStretchRenderer")],Jr);const EP=Jr;let mj=class{constructor(t=null,r=null,i=null){this.minValue=t,this.maxValue=r,this.noDataValue=i}};const vTe=9999999e31,wTe=2e-7,bTe={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function o0(e){return bTe[e]??[-34028234663852886e22,34028234663852886e22]}function kje(e,t){return e==null||t==null?"s32":e<0?e>=-128&&t<128?"s8":e>=-32768&&t<32768?"s16":"s32":t<256?"u8":t<65536?"u16":"u32"}function Nje(e){return((e==null?void 0:e.startsWith("s"))||(e==null?void 0:e.startsWith("u")))??!1}function AP(e,t,r){var y,v;if(e.depthCount&&e.depthCount>1)return;const{pixels:i,statistics:n,pixelType:s}=e,o=i[0].length,a=e.bandMasks??[],u=e.mask??new Uint8Array(o).fill(255),c=s==="f32"||s==="f64",h=o0(s);let d=!1;for(let w=0;w<i.length;w++){const b=typeof t=="number"?t:t[w];if(b==null)continue;const _=((y=n==null?void 0:n[w])==null?void 0:y.minValue)??h[0],x=((v=n==null?void 0:n[w])==null?void 0:v.maxValue)??h[1];if(_>b+Number.EPSILON||x<b-Number.EPSILON)continue;const T=a[w]||u.slice(),I=i[w],M=r==null?void 0:r.customFloatTolerance;if(c&&M!==0){let $=M;$||($=Math.abs(b)>=vTe?wTe*Math.abs(b):s==="f32"?2**-23:Number.EPSILON);for(let A=0;A<I.length;A++)T[A]&&Math.abs(I[A]-b)<$&&(I[A]=0,T[A]=0,u[A]=0,d=!0)}else for(let $=0;$<I.length;$++)T[$]&&I[$]===b&&(I[$]=0,T[$]=0,u[$]=0,d=!0);a[w]=T}d&&(e.bandMasks=e.bandMasks||e.pixels.length>1?a:null,e.mask=u),d&&"updateStatistics"in e&&e.updateStatistics()}var Uc;let gn=Uc=class extends Q{static createEmptyBand(e,t){return new(Uc.getPixelArrayConstructor(e))(t)}static combineBandMasks(e){if(e.length<2)return e[0];const t=e[0].length,r=new Uint8Array(t).fill(255);for(let i=0;i<e.length;i++){const n=e[i];for(let s=0;s<t;s++)n[s]||(r[s]=0)}return r}static getPixelArrayConstructor(e){let t;switch(e){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":t=Float32Array;break;case"f64":t=Float64Array}return t}constructor(e){super(e),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(e){if(!e)return"f32";let t=e.toLowerCase();return["u1","u2","u4"].includes(t)?t="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(t)||(t="f32"),t}getPlaneCount(){var e;return(e=this.pixels)==null?void 0:e.length}addData(e){if(!e.pixels||e.pixels.length!==this.width*this.height)throw new z("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(e.pixels),this.statistics.push(e.statistics??new mj)}getAsRGBA(){const e=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(e);break;default:this._fillFrom8Bit(e)}return new Uint8ClampedArray(e)}getAsRGBAFloat(){const e=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(e),e}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map(r=>this._calculateBandStatistics(r,this.mask));const e=this.mask;let t=0;if(e!=null)for(let r=0;r<e.length;r++)e[r]&&t++;else t=this.width*this.height;this.validPixelCount=t}clamp(e){if(!e||e==="f64"||e==="f32"||!this.pixels)return;const[t,r]=o0(e),i=this.pixels,n=this.width*this.height,s=i.length;let o,a,u;const c=[];for(let h=0;h<s;h++){u=Uc.createEmptyBand(e,n),o=i[h];for(let d=0;d<n;d++)a=o[d],u[d]=a>r?r:a<t?t:a;c.push(u)}this.pixels=c,this.pixelType=e}extractBands(e){var d;const{pixels:t,statistics:r}=this;if(e==null||e.length===0||!t||t.length===0)return this;const i=t.length,n=e.some(y=>y>=t.length),s=i===e.length&&!e.some((y,v)=>y!==v);if(n||s)return this;const o=((d=this.bandMasks)==null?void 0:d.length)===i?e.map(y=>this.bandMasks[y]):void 0;let{mask:a,validPixelCount:u}=this;const{width:c,height:h}=this;return o!=null&&o.length&&(a=Uc.combineBandMasks(o),u=a.filter(y=>!!y).length),new Uc({pixelType:this.pixelType,width:c,height:h,mask:a,bandMasks:o,validPixelCount:u,maskIsAlpha:this.maskIsAlpha,pixels:e.map(y=>t[y]),statistics:r&&e.map(y=>r[y])})}clone(){const e=new Uc({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});let t;this.mask!=null&&(this.mask instanceof Uint8Array?e.mask=new Uint8Array(this.mask):e.mask=this.mask.slice(0)),this.bandMasks&&(e.bandMasks=this.bandMasks.map(i=>new Uint8Array(i)));const r=Uc.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){e.pixels=[];const i=!!this.pixels[0].slice;for(t=0;t<this.pixels.length;t++)e.pixels[t]=i?this.pixels[t].slice(0,this.pixels[t].length):new r(this.pixels[t])}if(this.statistics)for(e.statistics=[],t=0;t<this.statistics.length;t++)e.statistics[t]=B(this.statistics[t]);return e.premultiplyAlpha=this.premultiplyAlpha,e}_fillFrom8Bit(e){const{mask:t,maskIsAlpha:r,premultiplyAlpha:i,pixels:n}=this;if(!e||!(n!=null&&n.length))return void oe.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let s,o,a,u;s=o=a=n[0],n.length>=3?(o=n[1],a=n[2]):n.length===2&&(o=n[1]);const c=new Uint32Array(e),h=this.width*this.height;if(s.length===h)if(t!=null&&t.length===h)if(r)for(u=0;u<h;u++){const d=t[u];if(d){const y=d/255;c[u]=i?d<<24|a[u]*y<<16|o[u]*y<<8|s[u]*y:d<<24|a[u]<<16|o[u]<<8|s[u]}}else for(u=0;u<h;u++)t[u]&&(c[u]=255<<24|a[u]<<16|o[u]<<8|s[u]);else for(u=0;u<h;u++)c[u]=255<<24|a[u]<<16|o[u]<<8|s[u];else oe.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(e){const{pixels:t,mask:r,statistics:i}=this;if(!e||!(t!=null&&t.length))return void oe.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const n=this.pixelType;let s=1,o=0,a=1;if(i&&i.length>0){for(const b of i)if(b.minValue!=null&&(o=Math.min(o,b.minValue)),b.maxValue!=null&&b.minValue!=null){const _=b.maxValue-b.minValue;a=Math.max(a,_)}s=255/a}else{let b=255;n==="s8"?(o=-128,b=127):n==="u16"?b=65535:n==="s16"?(o=-32768,b=32767):n==="u32"?b=4294967295:n==="s32"?(o=-2147483648,b=2147483647):n==="f32"?(o=-34e38,b=34e38):n==="f64"&&(o=-Number.MAX_VALUE,b=Number.MAX_VALUE),s=255/(b-o)}const u=new Uint32Array(e),c=this.width*this.height;let h,d,y,v,w;if(h=d=y=t[0],h.length!==c)return oe.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(t.length>=2)if(d=t[1],t.length>=3&&(y=t[2]),r!=null&&r.length===c)for(v=0;v<c;v++)r[v]&&(u[v]=255<<24|(y[v]-o)*s<<16|(d[v]-o)*s<<8|(h[v]-o)*s);else for(v=0;v<c;v++)u[v]=255<<24|(y[v]-o)*s<<16|(d[v]-o)*s<<8|(h[v]-o)*s;else if(r!=null&&r.length===c)for(v=0;v<c;v++)w=(h[v]-o)*s,r[v]&&(u[v]=255<<24|w<<16|w<<8|w);else for(v=0;v<c;v++)w=(h[v]-o)*s,u[v]=255<<24|w<<16|w<<8|w}_fillFrom32Bit(e){const{pixels:t,mask:r}=this;if(!e||!(t!=null&&t.length))return oe.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let i,n,s,o;i=n=s=t[0],t.length>=3?(n=t[1],s=t[2]):t.length===2&&(n=t[1]);const a=this.width*this.height;if(i.length!==a)return oe.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let u=0;if(r!=null&&r.length===a)for(o=0;o<a;o++)e[u++]=i[o],e[u++]=n[o],e[u++]=s[o],e[u++]=1&r[o];else for(o=0;o<a;o++)e[u++]=i[o],e[u++]=n[o],e[u++]=s[o],e[u++]=1}_calculateBandStatistics(e,t){let r=1/0,i=-1/0;const n=e.length;let s,o=0;if(t!=null)for(s=0;s<n;s++)t[s]&&(o=e[s],r=o<r?o:r,i=o>i?o:i);else for(s=0;s<n;s++)o=e[s],r=o<r?o:r,i=o>i?o:i;return new mj(r,i)}};l([p({json:{write:!0}})],gn.prototype,"width",void 0),l([p({json:{write:!0}})],gn.prototype,"height",void 0),l([p({json:{write:!0}})],gn.prototype,"pixelType",void 0),l([Tt("pixelType")],gn.prototype,"castPixelType",null),l([p({json:{write:!0}})],gn.prototype,"validPixelCount",void 0),l([p({json:{write:!0}})],gn.prototype,"mask",void 0),l([p({json:{write:!0}})],gn.prototype,"maskIsAlpha",void 0),l([p({json:{write:!0}})],gn.prototype,"pixels",void 0),l([p()],gn.prototype,"premultiplyAlpha",void 0),l([p({json:{write:!0}})],gn.prototype,"statistics",void 0),l([p({json:{write:!0}})],gn.prototype,"depthCount",void 0),l([p({json:{write:!0}})],gn.prototype,"noDataValues",void 0),l([p({json:{write:!0}})],gn.prototype,"bandMasks",void 0),gn=Uc=l([k("esri.layers.support.PixelBlock")],gn);const Ye=gn;var gj,vj;(function(e){e[e.matchAny=0]="matchAny",e[e.matchAll=1]="matchAll"})(gj||(gj={})),function(e){e[e.bestMatch=0]="bestMatch",e[e.fail=1]="fail"}(vj||(vj={}));const Dje=6;function nr(e){return e!=null&&e.declaredClass==="esri.layers.support.PixelBlock"&&e.pixels&&e.pixels.length>0}function Fje(e){var h;if(!(e!=null&&e.length)||e.some(d=>!nr(d)))return null;if(e.length===1)return((h=e[0])==null?void 0:h.clone())??null;const t=e,{width:r,height:i,pixelType:n}=t[0];if(t.some(d=>d.width!==r||d.height!==i))return null;const s=t.map(({mask:d})=>d).filter(d=>d!=null);let o=null;s.length&&(o=new Uint8Array(r*i),o.set(s[0]),s.length>1&&kZ(s.slice(1),o));const a=[];t.forEach(({pixels:d})=>a.push(...d));const u=t.map(({statistics:d})=>d).filter(d=>d==null?void 0:d.length),c=[];return u.forEach(d=>c.push(...d)),new Ye({pixelType:n,width:r,height:i,mask:o,pixels:a,statistics:c.length?c:null})}function K0(e){if(!e)return;const t=e.colormap;if(!t||t.length===0)return;const r=t.sort((d,y)=>d[0]-y[0]);let i=0;r[0][0]<0&&(i=r[0][0]);const n=Math.max(256,r[r.length-1][0]-i+1),s=new Uint8Array(4*n),o=[];let a,u=0,c=0;const h=r[0].length===5;if(n>65536)return r.forEach(d=>{o[d[0]-i]=h?d.slice(1):d.slice(1).concat([255])}),{indexed2DColormap:o,offset:i,alphaSpecified:h};if(e.fillUnspecified)for(a=r[c],u=a[0]-i;u<n;u++)s[4*u]=a[1],s[4*u+1]=a[2],s[4*u+2]=a[3],s[4*u+3]=h?a[4]:255,u===a[0]-i&&(a=c===r.length-1?a:r[++c]);else for(u=0;u<r.length;u++)a=r[u],c=4*(a[0]-i),s[c]=a[1],s[c+1]=a[2],s[c+2]=a[3],s[c+3]=h?a[4]:255;return{indexedColormap:s,offset:i,alphaSpecified:h}}function MM(e,t){if(!nr(e)||!t||!t.indexedColormap&&!t.indexed2DColormap)return e;const r=e.clone(),i=r.pixels;let n=r.mask;const s=r.width*r.height;if(i.length!==1)return e;const{indexedColormap:o,indexed2DColormap:a,offset:u,alphaSpecified:c}=t;let h=0;const d=i[0],y=new Uint8Array(d.length),v=new Uint8Array(d.length),w=new Uint8Array(d.length);let b,_=0;if(o){const x=o.length-1;if(n!=null)for(h=0;h<s;h++)n[h]&&(_=4*(d[h]-u),_<u||_>x?n[h]=0:(y[h]=o[_],v[h]=o[_+1],w[h]=o[_+2],n[h]=o[_+3]));else{for(n=new Uint8Array(s),h=0;h<s;h++)_=4*(d[h]-u),_<u||_>x?n[h]=0:(y[h]=o[_],v[h]=o[_+1],w[h]=o[_+2],n[h]=o[_+3]);r.mask=n}}else if(a)if(n!=null)for(h=0;h<s;h++)n[h]&&(b=a[d[h]],y[h]=b[0],v[h]=b[1],w[h]=b[2],n[h]=b[3]);else{for(n=new Uint8Array(s),h=0;h<s;h++)b=a[d[h]],y[h]=b[0],v[h]=b[1],w[h]=b[2],n[h]=b[3];r.mask=n}return r.pixels=[y,v,w],r.statistics=null,r.pixelType="u8",r.maskIsAlpha=c,r}function wj(e,t){if(!nr(e))return null;const{pixels:r,mask:i}=e,n=r.length;let s=t.lut;const{offset:o}=t;s&&s[0].length===1&&(s=r.map(()=>s));const a=[],u=t.outputPixelType||"u8";for(let h=0;h<n;h++){const d=LZ(r[h],i,s[h],o||0,u);a.push(d)}const c=new Ye({width:e.width,height:e.height,pixels:a,mask:i,pixelType:u});return c.updateStatistics(),c}function LZ(e,t,r,i,n){const s=e.length,o=Ye.createEmptyBand(n,s);if(t)for(let a=0;a<s;a++)t[a]&&(o[a]=r[e[a]-i]);else for(let a=0;a<s;a++)o[a]=r[e[a]-i];return o}function _Te(e,t){if(!nr(e))return null;const r=e.clone(),{pixels:i}=r,n=r.width*r.height,s=t.length,o=Math.floor(s/2),a=t[Math.floor(o)],u=i[0];let c,h,d,y,v,w,b=!1;const _=new Uint8Array(n),x=new Uint8Array(n),T=new Uint8Array(n);let I=r.mask;const M=t[0].mappedColor.length===4;for(I||(I=new Uint8Array(n),I.fill(M?255:1),r.mask=I),v=0;v<n;v++)if(I[v]){for(c=u[v],b=!1,w=o,h=a,d=0,y=s-1;y-d>1;){if(c===h.value){b=!0;break}c>h.value?d=w:y=w,w=Math.floor((d+y)/2),h=t[Math.floor(w)]}b||(c===t[d].value?(h=t[d],b=!0):c===t[y].value?(h=t[y],b=!0):c<t[d].value?(b=!1,h=null):c>t[d].value&&(c<t[y].value?(h=t[d],b=!0):y===s-1?(b=!1,h=null):(h=t[y],b=!0))),b?(_[v]=h.mappedColor[0],x[v]=h.mappedColor[1],T[v]=h.mappedColor[2],I[v]=h.mappedColor[3]):_[v]=x[v]=T[v]=I[v]=0}return r.pixels=[_,x,T],r.mask=I,r.pixelType="u8",r.maskIsAlpha=M,r}function jje(e,t){if(!nr(e))return null;const{width:r,height:i}=e,{inputRanges:n,outputValues:s,outputPixelType:o,noDataRanges:a,allowUnmatched:u,isLastInputRangeInclusive:c}=t,h=e.pixels[0],d=Ye.createEmptyBand(o,h.length),y=e.mask,v=new Uint8Array(r*i);y?v.set(y):v.fill(255);const w=e.pixelType.startsWith("f")?1e-6:0,b=n.map(M=>M-w);b[0]=n[0],b[b.length-1]=n[n.length-1]+(c?1e-6:0);const _=n.length/2,[x,T]=o0(o);for(let M=0;M<i;M++)for(let $=0;$<r;$++){const A=M*r+$;if(v[A]){const R=h[A];let L=!1;for(let C=_-1;C>=0;C--)if(R===b[2*C]||R>b[2*C]&&R<b[2*C+1]){d[A]=s[C],L=!0;break}L||(u?d[A]=R>T?T:R<x?x:R:v[A]=0)}}const I=a==null?void 0:a.length;if(I)for(let M=0;M<i;M++)for(let $=0;$<r;$++){const A=M*r+$;if(!y||y[A]){const R=h[A];for(let L=0;L<I;L+=2)if(R>=a[L]&&R<=a[L+1]){d[A]=0,v[A]=0;break}}}return new Ye({width:r,height:i,pixelType:o,pixels:[d],mask:v})}function bj(e,t,r,i){const n=r!=null&&r.length>=2?new Set(r):null,s=(r==null?void 0:r.length)===1?r[0]:null,o=!!(t!=null&&t.length);for(let a=0;a<e.length;a++)if(i[a]){const u=e[a];if(o){let c=!1;for(let h=0;h<t.length;h+=2)if(u>=t[h]&&u<=t[h+1]){c=!0;break}c||(i[a]=0)}i[a]&&(u===s||n!=null&&n.has(u))&&(i[a]=0)}}function _j(e,t){const r=e[0].length;for(let i=0;i<r;i++)if(t[i]){let n=!1;for(let s=0;s<e.length;s++)if(e[s][i]){n=!0;break}n||(t[i]=0)}}function kZ(e,t){const r=e[0].length;for(let i=0;i<r;i++)if(t[i]){let n=!1;for(let s=0;s<e.length;s++)if(e[s][i]===0){n=!0;break}n&&(t[i]=0)}}function Uje(e,t){if(!nr(e))return null;const{width:r,height:i,pixels:n}=e,s=r*i,o=new Uint8Array(s);e.mask?o.set(e.mask):o.fill(255);const a=n.length,{includedRanges:u,noDataValues:c,outputPixelType:h,matchAll:d,lookups:y}=t;if(y){const v=[];for(let w=0;w<a;w++){const b=y[w],_=LZ(n[w],o,b.lut,b.offset||0,"u8");v.push(_)}v.length===1?o.set(v[0]):d?_j(v,o):kZ(v,o)}else if(d){const v=[];for(let w=0;w<a;w++){const b=new Uint8Array(s);b.set(o),bj(n[w],u==null?void 0:u.slice(2*w,2*w+2),c==null?void 0:c[w],b),v.push(b)}v.length===1?o.set(v[0]):_j(v,o)}else for(let v=0;v<a;v++)bj(n[v],u==null?void 0:u.slice(2*v,2*v+2),c==null?void 0:c[v],o);return new Ye({width:r,height:i,pixelType:h,pixels:n,mask:o})}function Vje(e){const{srcPixelType:t,inputRanges:r,outputValues:i,allowUnmatched:n,noDataRanges:s,isLastInputRangeInclusive:o,outputPixelType:a}=e;if(t!=="u8"&&t!=="s8"&&t!=="u16"&&t!=="s16")return null;const u=t.includes("16")?65536:256,c=t.includes("s")?-u/2:0,h=Ye.createEmptyBand(a,u),d=new Uint8Array(u);n&&d.fill(255);const[y,v]=o0(a);if(r!=null&&r.length&&(i!=null&&i.length)){const b=r.map(_=>_-1e-6);b[0]=r[0],o&&(b[b.length-1]=r[r.length-1]);for(let _=0;_<b.length;_++){const x=i[_]>v?v:i[_]<y?y:i[_],T=Math.ceil(b[2*_]-c),I=Math.floor(b[2*_+1]-c);for(let M=T;M<=I;M++)h[M]=x,d[M]=255}}if(s!=null&&s.length)for(let w=0;w<s.length;w++){const b=Math.ceil(s[2*w]-c),_=Math.floor(s[2*w+1]-c);for(let x=b;x<=_;x++)d[x]=0}return{lut:h,offset:c,mask:d}}function Gje(e,t,r){if(e!=="u8"&&e!=="s8"&&e!=="u16"&&e!=="s16")return null;const i=e.includes("16")?65536:256,n=e.includes("s")?-i/2:0,s=new Uint8Array(i);if(t)for(let o=0;o<t.length;o++){const a=Math.ceil(t[2*o]-n),u=Math.floor(t[2*o+1]-n);for(let c=a;c<=u;c++)s[c]=255}else s.fill(255);if(r)for(let o=0;o<r.length;o++)s[r[o]-n]=0;return{lut:s,offset:n}}function STe(e,t,r,i,n,s,o,a){return{xmin:n<=r*e?0:n<r*e+e?n-r*e:e,ymin:s<=i*t?0:s<i*t+t?s-i*t:t,xmax:n+o<=r*e?0:n+o<r*e+e?n+o-r*e:e,ymax:s+a<=i*t?0:s+a<i*t+t?s+a-i*t:t}}function Bje(e,t){if(!e||e.length===0)return null;const r=e.find(w=>w.pixelBlock);if((r==null?void 0:r.pixelBlock)==null)return null;const i=(r.extent.xmax-r.extent.xmin)/r.pixelBlock.width,n=(r.extent.ymax-r.extent.ymin)/r.pixelBlock.height,s=.01*Math.min(i,n),o=e.sort((w,b)=>Math.abs(w.extent.ymax-b.extent.ymax)>s?b.extent.ymax-w.extent.ymax:Math.abs(w.extent.xmin-b.extent.xmin)>s?w.extent.xmin-b.extent.xmin:0),a=Math.min.apply(null,o.map(w=>w.extent.xmin)),u=Math.min.apply(null,o.map(w=>w.extent.ymin)),c=Math.max.apply(null,o.map(w=>w.extent.xmax)),h=Math.max.apply(null,o.map(w=>w.extent.ymax)),d={x:Math.round((t.xmin-a)/i),y:Math.round((h-t.ymax)/n)},y={width:Math.round((c-a)/i),height:Math.round((h-u)/n)},v={width:Math.round((t.xmax-t.xmin)/i),height:Math.round((t.ymax-t.ymin)/n)};return Math.round(y.width/r.pixelBlock.width)*Math.round(y.height/r.pixelBlock.height)!==o.length||d.x<0||d.y<0||y.width<v.width||y.height<v.height?null:{extent:t,pixelBlock:xTe(o.map(w=>w.pixelBlock),y,{clipOffset:d,clipSize:v})}}function $M(e,t,r,i,n,s){const{width:o,height:a}=r.block,{x:u,y:c}=r.offset,{width:h,height:d}=r.mosaic,y=STe(o,a,i,n,u,c,h,d);let v=0,w=0;if(s){const b=s.hasGCSSShiftTransform?360:s.halfWorldWidth??0,_=o*s.resolutionX,x=s.startX+i*_;x<b&&x+_>b?w=s.rightPadding:x>=b&&(v=s.leftMargin-s.rightPadding,w=0)}if(y.xmax-=w,typeof t!="number")for(let b=y.ymin;b<y.ymax;b++){const _=(n*a+b-c)*h+(i*o-u)+v,x=b*o;for(let T=y.xmin;T<y.xmax;T++)e[_+T]=t[x+T]}else for(let b=y.ymin;b<y.ymax;b++){const _=(n*a+b-c)*h+(i*o-u)+v;for(let x=y.xmin;x<y.xmax;x++)e[_+x]=t}}function xTe(e,t,r={}){var U;const{clipOffset:i,clipSize:n,alignmentInfo:s,blockWidths:o}=r;if(o)return TTe(e,t,{blockWidths:o});const a=e.find(F=>nr(F));if(a==null)return null;const u=n?n.width:t.width,c=n?n.height:t.height,h=a.width,d=a.height,y=t.width/h,v=t.height/d,w={offset:i||{x:0,y:0},mosaic:n||t,block:{width:h,height:d}},b=a.pixelType,_=Ye.getPixelArrayConstructor(b),x=a.pixels.length,T=[];let I,M;for(let F=0;F<x;F++){M=new _(u*c);for(let j=0;j<v;j++)for(let q=0;q<y;q++){const K=e[j*y+q];nr(K)&&(I=K.pixels[F],$M(M,I,w,q,j,s))}T.push(M)}const $=e.some(F=>F==null||F.mask!=null&&F.mask.length>0),A=e.some(F=>(F==null?void 0:F.bandMasks)&&F.bandMasks.length>1),R=$?new Uint8Array(u*c):void 0,L=A?[]:void 0;if(R){for(let F=0;F<v;F++)for(let j=0;j<y;j++){const q=e[F*y+j],K=q!=null?q.mask:null;$M(R,K??(q?255:0),w,j,F,s)}if(L)for(let F=0;F<x;F++){const j=new Uint8Array(u*c);for(let q=0;q<v;q++)for(let K=0;K<y;K++){const X=e[q*y+K],ne=((U=X==null?void 0:X.bandMasks)==null?void 0:U[F])??(X==null?void 0:X.mask);$M(j,ne??(X?255:0),w,K,q,s)}L.push(j)}}const C=new Ye({width:u,height:c,pixels:T,pixelType:b,bandMasks:L,mask:R});return C.updateStatistics(),C}function TTe(e,t,r){var _;const i=e.find(x=>x!=null);if(i==null)return null;const n=e.some(x=>x==null||!!x.mask),{width:s,height:o}=t,a=n?new Uint8Array(s*o):null,{blockWidths:u}=r,c=[],h=i.getPlaneCount(),d=Ye.getPixelArrayConstructor(i.pixelType);if(n)for(let x=0,T=0;x<e.length;T+=u[x],x++){const I=e[x];if(!nr(I))continue;const M=I.mask;for(let $=0;$<o;$++)for(let A=0;A<u[x];A++)a[$*s+A+T]=M==null?255:M[$*I.width+A]}const y=e.some(x=>(x==null?void 0:x.bandMasks)&&x.bandMasks.length>1),v=y?[]:void 0,w=s*o;for(let x=0;x<h;x++){const T=new d(w),I=y?new Uint8Array(w):void 0;for(let M=0,$=0;M<e.length;$+=u[M],M++){const A=e[M];if(!nr(A))continue;const R=A.pixels[x];if(R!=null){for(let L=0;L<o;L++)for(let C=0;C<u[M];C++)T[L*s+C+$]=R[L*A.width+C];if(I){const L=((_=A.bandMasks)==null?void 0:_[x])??A.mask;for(let C=0;C<o;C++)for(let U=0;U<u[M];U++)I[C*s+U+$]=L?L[C*A.width+U]:255}}}c.push(T),v&&I&&v.push(I)}const b=new Ye({width:s,height:o,mask:a,bandMasks:v,pixels:c,pixelType:i.pixelType});return b.updateStatistics(),b}function zje(e,t,r){if(!nr(e))return null;const{width:i,height:n}=e,s=t.x,o=t.y,a=r.width+s,u=r.height+o;if(s<0||o<0||a>i||u>n||s===0&&o===0&&a===i&&u===n)return e;e.mask||(e.mask=new Uint8Array(i*n));const c=e.mask;for(let h=0;h<n;h++){const d=h*i;for(let y=0;y<i;y++)c[d+y]=h<o||h>=u||y<s||y>=a?0:1}return e.updateStatistics(),e}function ITe(e){if(!nr(e))return null;const t=e.clone(),{width:r,height:i,pixels:n}=e,s=n[0],o=t.pixels[0],a=e.mask;for(let u=2;u<i-1;u++){const c=new Map;for(let d=u-2;d<u+2;d++)for(let y=0;y<4;y++){const v=d*r+y;X0(c,s[v],a?a[v]:1)}o[u*r]=Sj(c),o[u*r+1]=o[u*r+2]=o[u*r];let h=3;for(;h<r-1;h++){let d=(u-2)*r+h+1;X0(c,s[d],a?a[d]:1),d=(u-1)*r+h+1,X0(c,s[d],a?a[d]:1),d=u*r+h+1,X0(c,s[d],a?a[d]:1),d=(u+1)*r+h+1,X0(c,s[d],a?a[d]:1),d=(u-2)*r+h-3,r_(c,s[d],a?a[d]:1),d=(u-1)*r+h-3,r_(c,s[d],a?a[d]:1),d=u*r+h-3,r_(c,s[d],a?a[d]:1),d=(u+1)*r+h-3,r_(c,s[d],a?a[d]:1),o[u*r+h]=Sj(c)}o[u*r+h+1]=o[u*r+h]}for(let u=0;u<r;u++)o[u]=o[r+u]=o[2*r+u],o[(i-1)*r+u]=o[(i-2)*r+u];return t.updateStatistics(),t}function Sj(e){if(e.size===0)return 0;let t=0,r=-1,i=0;const n=e.keys();let s=n.next();for(;!s.done;)i=e.get(s.value),i>t&&(r=s.value,t=i),s=n.next();return r}function r_(e,t,r){if(r===0)return;const i=e.get(t);i===1?e.delete(t):e.set(t,i-1)}function X0(e,t,r){r!==0&&e.set(t,e.has(t)?e.get(t)+1:1)}function NZ(e,t,r){let{x:i,y:n}=t;const{width:s,height:o}=r;if(i===0&&n===0&&o===e.height&&s===e.width)return e;const{width:a,height:u}=e,c=Math.max(0,n),h=Math.max(0,i),d=Math.min(i+s,a),y=Math.min(n+o,u);if(d<0||y<0||!nr(e))return null;i=Math.max(0,-i),n=Math.max(0,-n);const{pixels:v}=e,w=s*o,b=v.length,_=[];for(let M=0;M<b;M++){const $=v[M],A=Ye.createEmptyBand(e.pixelType,w);for(let R=c;R<y;R++){const L=R*a;let C=(R+n-c)*s+i;for(let U=h;U<d;U++)A[C++]=$[L+U]}_.push(A)}const x=new Uint8Array(w),T=e.mask;for(let M=c;M<y;M++){const $=M*a;let A=(M+n-c)*s+i;for(let R=h;R<d;R++)x[A++]=T?T[$+R]:1}const I=new Ye({width:r.width,height:r.height,pixelType:e.pixelType,pixels:_,mask:x});return I.updateStatistics(),I}function DZ(e,t=!0){if(!nr(e))return null;const{pixels:r,width:i,height:n,mask:s,pixelType:o}=e,a=[],u=Math.round(i/2),c=Math.round(n/2),h=n-1,d=i-1;for(let v=0;v<r.length;v++){const w=r[v],b=Ye.createEmptyBand(o,u*c);let _=0;for(let x=0;x<n;x+=2)for(let T=0;T<i;T+=2){const I=w[x*i+T];if(t){const M=T===d?I:w[x*i+T+1],$=x===h?I:w[x*i+T+i],A=T===d?$:x===h?M:w[x*i+T+i+1];b[_++]=(I+M+$+A)/4}else b[_++]=I}a.push(b)}let y=null;if(s!=null){y=new Uint8Array(u*c);let v=0;for(let w=0;w<n;w+=2)for(let b=0;b<i;b+=2){const _=s[w*i+b];if(t){const x=b===d?_:s[w*i+b+1],T=w===h?_:s[w*i+b+i],I=b===d?T:w===h?x:s[w*i+b+i+1];y[v++]=_*x*T*I?1:0}else y[v++]=_}}return new Ye({width:u,height:c,pixelType:o,pixels:a,mask:y})}function qje(e,t,r=0,i=!0){if(!nr(e))return null;const{width:n,height:s}=t;let{width:o,height:a}=e;const u=new Map,c={x:0,y:0},h=1+r;let d=e;for(let y=0;y<h;y++){const v=Math.ceil(o/n),w=Math.ceil(a/s);for(let b=0;b<w;b++){c.y=b*s;for(let _=0;_<v;_++){c.x=_*n;const x=NZ(d,c,t);u.set(`${y}/${b}/${_}`,x)}}y<h-1&&(d=DZ(d,i)),o=Math.round(o/2),a=Math.round(a/2)}return u}function Hje(e){const{pixelBlock:t,tileSize:r,level:i,row:n,col:s,useBilinear:o}=e;if(!nr(t))return null;const{width:a,height:u}=r,c=2**i,h=c*a,d=c*u;let y=NZ(t,{y:n*d,x:s*h},{width:h,height:d});if(!y)return null;for(let v=i;v>0;v--)y=DZ(y,o);return y}function FZ(e,t,r,i,n=0){const{width:s,height:o}=e,{width:a,height:u}=t,c=i.cols,h=i.rows,d=Math.ceil(a/c-.1/c),y=Math.ceil(u/h-.1/h);let v,w,b,_,x,T,I;const M=d*c,$=M*y*h,A=new Float32Array($),R=new Float32Array($),L=new Uint32Array($),C=new Uint32Array($);let U,F,j=0;for(let q=0;q<y;q++)for(let K=0;K<d;K++){v=12*(q*d+K),w=r[v],b=r[v+1],_=r[v+2],x=r[v+3],T=r[v+4],I=r[v+5];for(let X=0;X<h;X++){j=(q*h+X)*M+K*c,F=(X+.5)/h;for(let ne=0;ne<X;ne++)U=(ne+.5)/c,A[j+ne]=(w*U+b*F+_)*s+n,R[j+ne]=(x*U+T*F+I)*o+n,L[j+ne]=Math.floor(A[j+ne]),C[j+ne]=Math.floor(R[j+ne])}v+=6,w=r[v],b=r[v+1],_=r[v+2],x=r[v+3],T=r[v+4],I=r[v+5];for(let X=0;X<h;X++){j=(q*h+X)*M+K*c,F=(X+.5)/h;for(let ne=X;ne<c;ne++)U=(ne+.5)/c,A[j+ne]=(w*U+b*F+_)*s+n,R[j+ne]=(x*U+T*F+I)*o+n,L[j+ne]=Math.floor(A[j+ne]),C[j+ne]=Math.floor(R[j+ne])}}return{offsets_x:A,offsets_y:R,offsets_xi:L,offsets_yi:C,gridWidth:M}}function Wje(e,t){const{coefficients:r,spacing:i}=t,{offsets_x:n,offsets_y:s,gridWidth:o}=FZ(e,e,r,{rows:i[0],cols:i[1]}),{width:a,height:u}=e,c=new Float32Array(a*u),h=180/Math.PI;for(let d=0;d<u;d++)for(let y=0;y<a;y++){const v=d*o+y,w=d===0?v:v-o,b=d===u-1?v:v+o,_=n[w]-n[b],x=s[b]-s[w];if(isNaN(_)||isNaN(x))c[d*a+y]=90;else{let T=Math.atan2(x,_)*h;T=(360+T)%360,c[d*a+y]=T}}return c}function Jje(e,t,r,i,n="nearest"){if(!nr(e))return null;n==="majority"&&(e=ITe(e));const{pixels:s,mask:o,bandMasks:a,pixelType:u}=e,c=e.width,h=e.height,d=Ye.getPixelArrayConstructor(u),y=s.length,{width:v,height:w}=t;let b=!1;for(let j=0;j<r.length;j+=3)r[j]===-1&&r[j+1]===-1&&r[j+2]===-1&&(b=!0);const{offsets_x:_,offsets_y:x,offsets_xi:T,offsets_yi:I,gridWidth:M}=FZ({width:c,height:h},t,r,i,n==="majority"?.5:0);let $;const A=(j,q,K,X)=>{const ne=j instanceof Float32Array||j instanceof Float64Array?0:.5;for(let re=0;re<w;re++){$=re*M;for(let ae=0;ae<v;ae++){if(_[$]<0||x[$]<0)j[re*v+ae]=0;else if(X)j[re*v+ae]=q[T[$]+I[$]*c];else{const he=Math.floor(_[$]),de=Math.floor(x[$]),fe=Math.ceil(_[$]),Se=Math.ceil(x[$]),Ee=_[$]-he,Fe=x[$]-de;if(!K||K[he+de*c]&&K[fe+de*c]&&K[he+Se*c]&&K[fe+Se*c]){const ht=(1-Ee)*q[he+de*c]+Ee*q[fe+de*c],Lt=(1-Ee)*q[he+Se*c]+Ee*q[fe+Se*c];j[re*v+ae]=(1-Fe)*ht+Fe*Lt+ne}else j[re*v+ae]=q[T[$]+I[$]*c]}$++}}},R=[];let L;const C=(a==null?void 0:a.length)===y,U=[];for(let j=0;j<y;j++){if(C){const q=new Uint8Array(v*w);A(q,a[j],a[j],!0),U.push(q)}L=new d(v*w),A(L,s[j],C?a[j]:o,n==="nearest"||n==="majority"),R.push(L)}const F=new Ye({width:v,height:w,pixelType:u,pixels:R,bandMasks:C?U:void 0});if(o!=null)F.mask=new Uint8Array(v*w),A(F.mask,o,o,!0);else if(b){F.mask=new Uint8Array(v*w);for(let j=0;j<v*w;j++)F.mask[j]=_[j]<0||x[j]<0?0:1}return F.updateStatistics(),F}const Td=new Map;Td.set("meter-per-second",1),Td.set("kilometer-per-hour",.277778),Td.set("knots",.514444),Td.set("feet-per-second",.3048),Td.set("mile-per-hour",.44704);const bR=180/Math.PI,RP=5,qs=new We({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function VT(e,t){return Td.get(e)/Td.get(t)||1}function jZ(e){return(450-e)%360}function CP(e,t="geographic"){const[r,i]=e,n=Math.sqrt(r*r+i*i);let s=Math.atan2(i,r)*bR;return s=(360+s)%360,t==="geographic"&&(s=jZ(s)),[n,s]}function MTe(e,t="geographic"){let r=e[1];t==="geographic"&&(r=jZ(r)),r%=360;const i=e[0];return[i*Math.cos(r/bR),i*Math.sin(r/bR)]}function Zje(e,t,r,i="geographic"){if(!nr(e)||r==null)return e;const n=t==="vector-magdir"?e.clone():_R(e,t),s=n.pixels[1];for(let o=0;o<s.length;o++)s[o]=i==="geographic"?(s[o]+r[o]+270)%360:(s[o]+360-r[o])%360;return t==="vector-magdir"?n:_R(n,"vector-magdir")}function _R(e,t,r="geographic",i=1){if(!nr(e))return e;const{pixels:n,width:s,height:o}=e,a=s*o,u=n[0],c=n[1],h=e.pixelType.startsWith("f")?e.pixelType:"f32",d=Ye.createEmptyBand(h,a),y=Ye.createEmptyBand(h,a);let v=0;for(let b=0;b<o;b++)for(let _=0;_<s;_++)t==="vector-uv"?([d[v],y[v]]=CP([u[v],c[v]],r),d[v]*=i):([d[v],y[v]]=MTe([u[v],c[v]],r),d[v]*=i,y[v]*=i),v++;const w=new Ye({pixelType:h,width:e.width,height:e.height,mask:e.mask,validPixelCount:e.validPixelCount,maskIsAlpha:e.maskIsAlpha,pixels:[d,y]});return w.updateStatistics(),w}function $Te(e,t,r=1){if(r===1||!nr(e))return e;const i=e.clone(),{pixels:n,width:s,height:o}=i,a=n[0];n[1];let u=0;for(let c=0;c<o;c++)for(let h=0;h<s;h++)a[u]*=r,u++;return i.updateStatistics(),i}function Yje(e,t,r,i,n){if(n==null||!n.spatialReference.equals(e.spatialReference))return{extent:e,width:Math.round(t/i),height:Math.round(r/i),resolution:e.width/t};const s=n.xmin,o=n.ymax,a=(e.xmax-e.xmin)/t*i,u=(e.ymax-e.ymin)/r*i,c=(a+u)/2;return e.xmin=s+Math.floor((e.xmin-s)/a)*a,e.xmax=s+Math.ceil((e.xmax-s)/a)*a,e.ymin=o+Math.floor((e.ymin-o)/u)*u,e.ymax=o+Math.ceil((e.ymax-o)/u)*u,{extent:e,width:Math.round(e.width/a),height:Math.round(e.height/u),resolution:c}}const ETe=UZ(0,0,0);function UZ(e=0,t=0,r=Math.PI,i=!0){i&&(r=(2*Math.PI-r)%(2*Math.PI));const n=i?-1:1,s=13*n,o=-7*n,a=-2*n,u=-16*n,c=21.75,[h,d]=Ji(0,t+s,r,c),[y,v]=Ji(e-5.5,t+o,r,c),[w,b]=Ji(e+5.5,t+o,r,c),[_,x]=Ji(e-1.5,t+a,r,c),[T,I]=Ji(e+1.5,t+a,r,c),[M,$]=Ji(e-1.5,t+u,r,c),[A,R]=Ji(e+1.5,t+u,r,c);return[h,d,y,v,_,x,T,I,w,b,M,$,A,R]}function ATe(e=0,t=Math.PI,r=!0){r&&(t=(2*Math.PI-t)%(2*Math.PI));const i=10,n=r?-1:1,s=5*n,o=20*n,a=25*n,u=45,c=0,h=0,d=2,y=0,v=d*n,w=r?1:-1,b=i/2*w;let[_,x]=[c+b,h-o],[T,I]=[_+d*w,x],[M,$]=[T-y*w,I+v],[A,R]=[c-b,h-a],[L,C]=[A+y*w,R-v],U=Math.ceil(e/RP),F=Math.floor(U/10);U-=8*F;const j=[],q=[];for(let Ee=0;Ee<U/2;Ee++,F--){F<=0&&U%2==1&&Ee===(U-1)/2&&(A=c,L=A+y*w,R=(R+x)/2,C=R-v);const[Fe,ht]=Ji(A,R,t,u);if(F>0){const[Lt,Nt]=Ji(T,R,t,u),[Ir,st]=Ji(_,x,t,u);j.push(Lt),j.push(Nt),j.push(Fe),j.push(ht),j.push(Ir),j.push(st)}else{const[Lt,Nt]=Ji(T,I,t,u),[Ir,st]=Ji(M,$,t,u),[St,ei]=Ji(L,C,t,u);q.push(Fe),q.push(ht),q.push(St),q.push(ei),q.push(Ir),q.push(st),q.push(Lt),q.push(Nt)}R+=s,x+=s,I+=s,$+=s,C+=s}const[K,X]=Ji(c+b,h+o,t,u),ne=(i/2+d)*w,[re,ae]=Ji(c+ne,h+o,t,u),[he,de]=Ji(c+b,h-a,t,u),[fe,Se]=Ji(c+ne,h-a,t,u);return{pennants:j,barbs:q,shaft:[K,X,re,ae,he,de,fe,Se]}}function Ji(e,t,r,i=1){const n=Math.sqrt(e*e+t*t)/i,s=(2*Math.PI+Math.atan2(t,e))%(2*Math.PI);return[n,(2*Math.PI+s-r)%(2*Math.PI)]}const i_=[0,1,3,6,10,16,21,27,33,40,47,55,63],RTe=[0,.5,1,1.5,2],CTe=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function yh(e,t,r,i){const n=VT(i||"knots",r);let s;for(s=1;s<t.length;s++)if(s===t.length-1){if(e<t[s]*n)break}else if(e<=t[s]*n)break;return Math.min(s-1,t.length-2)}function OTe(e,t,r,i,n){let s=0;switch(t){case"beaufort_kn":s=yh(e,i_,"knots",r);break;case"beaufort_km":s=yh(e,i_,"kilometer-per-hour",r);break;case"beaufort_ft":s=yh(e,i_,"feet-per-second",r);break;case"beaufort_m":s=yh(e,i_,"meter-per-second",r);break;case"classified_arrow":s=yh(e,n??[],i,r);break;case"ocean_current_m":s=yh(e,RTe,"meter-per-second",r);break;case"ocean_current_kn":s=yh(e,CTe,"knots",r)}return s}function PTe(e,t){const{style:r,inputUnit:i,outputUnit:n,breakValues:s}=t,o=qs.fromJSON(i),a=qs.fromJSON(n),u=7*6,c=15;let h=0,d=0;const{width:y,height:v,mask:w}=e,b=e.pixels[0],_=e.pixels[1],x=w!=null?w.filter($=>$>0).length:y*v,T=new Float32Array(x*u),I=new Uint32Array(c*x),M=t.invertDirection?UZ(0,0,0,!1):ETe;for(let $=0;$<v;$++)for(let A=0;A<y;A++){const R=$*y+A;if(!w||w[$*y+A]){const L=(_[R]+360)%360/180*Math.PI,C=OTe(b[R],r,o,a,s);for(let F=0;F<M.length;F+=2)T[h++]=(A+.5)/y,T[h++]=($+.5)/v,T[h++]=M[F],T[h++]=M[F+1]+L,T[h++]=C,T[h++]=b[R];const U=7*(h/u-1);I[d++]=U,I[d++]=U+1,I[d++]=U+2,I[d++]=U+0,I[d++]=U+4,I[d++]=U+3,I[d++]=U+0,I[d++]=U+2,I[d++]=U+3,I[d++]=U+2,I[d++]=U+5,I[d++]=U+3,I[d++]=U+5,I[d++]=U+6,I[d++]=U+3}}return{vertexData:T,indexData:I}}const EM=[];function LTe(e,t){if(EM.length===0)for(let v=0;v<30;v++)EM.push(ATe(5*v,0,!t.invertDirection));const r=VT(qs.fromJSON(t.inputUnit),"knots"),{width:i,height:n,mask:s}=e,o=e.pixels[0],a=e.pixels[1],u=6,c=[],h=[];let d=0,y=0;for(let v=0;v<n;v++)for(let w=0;w<i;w++){const b=v*i+w,_=o[b]*r;if((!s||s[v*i+w])&&_>=RP){const x=(a[b]+360)%360/180*Math.PI,{pennants:T,barbs:I,shaft:M}=EM[Math.min(Math.floor(_/5),29)];if(T.length+I.length===0)continue;let $=c.length/u;const A=(w+.5)/i,R=(v+.5)/n;for(let L=0;L<T.length;L+=2)c[d++]=A,c[d++]=R,c[d++]=T[L],c[d++]=T[L+1]+x,c[d++]=0,c[d++]=_;for(let L=0;L<I.length;L+=2)c[d++]=A,c[d++]=R,c[d++]=I[L],c[d++]=I[L+1]+x,c[d++]=0,c[d++]=_;for(let L=0;L<M.length;L+=2)c[d++]=A,c[d++]=R,c[d++]=M[L],c[d++]=M[L+1]+x,c[d++]=0,c[d++]=_;for(let L=0;L<T.length/6;L++)h[y++]=$,h[y++]=$+1,h[y++]=$+2,$+=3;for(let L=0;L<I.length/8;L++)h[y++]=$,h[y++]=$+1,h[y++]=$+2,h[y++]=$+1,h[y++]=$+2,h[y++]=$+3,$+=4;h[y++]=$+0,h[y++]=$+1,h[y++]=$+2,h[y++]=$+1,h[y++]=$+3,h[y++]=$+2,$+=4}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(h)}}function kTe(e,t){let i=0,n=0;const{width:s,height:o,mask:a}=e,u=e.pixels[0],c=[],h=[],d=VT(qs.fromJSON(t.inputUnit),"knots"),y=t.style==="wind_speed"?RP:Number.MAX_VALUE;for(let v=0;v<o;v++)for(let w=0;w<s;w++){const b=u[v*s+w]*d;if((!a||a[v*s+w])&&b<y){for(let x=0;x<4;x++)c[i++]=(w+.5)/s,c[i++]=(v+.5)/o,c[i++]=x<2?-.5:.5,c[i++]=x%2==0?-.5:.5,c[i++]=0,c[i++]=b;const _=4*(i/24-1);h[n++]=_,h[n++]=_+1,h[n++]=_+2,h[n++]=_+1,h[n++]=_+2,h[n++]=_+3}}return{vertexData:new Float32Array(c),indexData:new Uint32Array(h)}}function Kje(e,t){return t.style==="simple_scalar"?kTe(e,t):t.style==="wind_speed"?LTe(e,t):PTe(e,t)}function Xje(e,t,r,i=[0,0],n=.5){const{width:s,height:o,mask:a}=e,[u,c]=e.pixels,[h,d]=i,y=Math.round((s-h)/r),v=Math.round((o-d)/r),w=y*v,b=new Float32Array(w),_=new Float32Array(w),x=new Uint8Array(w);for(let I=0;I<v;I++)for(let M=0;M<y;M++){let $=0;const A=I*y+M,R=Math.max(0,I*r+d),L=Math.max(0,M*r+h),C=Math.min(o,R+r),U=Math.min(s,L+r);for(let F=R;F<C;F++)for(let j=L;j<U;j++){const q=F*s+j;if(!a||a[q]){$++;const K=[u[q],c[q]],[X,ne]=K;b[A]+=X,_[A]+=ne}}if($>=(C-R)*(U-L)*(1-n)){x[A]=1;const[F,j]=CP([b[A]/$,_[A]/$]);b[A]=F,_[A]=j}else x[A]=0,b[A]=0,_[A]=0}const T=new Ye({width:y,height:v,pixels:[b,_],mask:x});return T.updateStatistics(),T}function NTe(e){const t=[];return SR(G_e(e),t),t.length?new ve(bJ(t[0])):null}function SR(e,t){var n;if(!e)return;let r;r=e.type==="CIMTextSymbol"?e.symbol:e;const i=e.type==="CIMPolygonSymbol";if(r!=null&&r.symbolLayers){for(const s of r.symbolLayers)if(!(s.colorLocked||i&&(z_e(s)||B_e(s)&&s.markerPlacement&&_J(s.markerPlacement))))switch(s.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":s.tintColor&&xj(t,s.tintColor);break;case"CIMVectorMarker":(n=s.markerGraphics)==null||n.forEach(o=>{SR(o.symbol,t)});break;case"CIMSolidStroke":case"CIMSolidFill":xj(t,s.color);break;case"CIMHatchFill":SR(s.lineSymbol,t)}}}function xj(e,t){for(const r of e)if(r.join(".")===t.join("."))return;e.push(t)}new Z4(1e3);new ve([128,128,128]);const DTe=new ve("white");function Qje(e,t){if(!e)return null;let r=null;return df(e)?r=FTe(e):vT(e)&&(r=e.type==="cim"?NTe(e):e.color?new ve(e.color):null),r?wv(r,t):null}function FTe(e){const t=e.symbolLayers;if(!t)return null;let r=null;return t.forEach(i=>{var n;i.type==="object"&&((n=i.resource)!=null&&n.href)||(r=i.type==="water"?i.color:i.material?i.material.color:null)}),r?new ve(r):null}function wv(e,t){if(t==null||e==null)return e;const r=e.toRgba();return r[3]=r[3]*t,new ve(r)}function jTe(e,t,r){const i=e.symbolLayers;if(!i)return;const n=s=>wv(t=t??s??(r!=null?DTe:null),r);i.forEach(s=>{var o,a;if(s.type!=="object"||!((o=s.resource)!=null&&o.href)||t)if(s.type==="water")s.color=n(s.color);else{const u=s.material!=null?s.material.color:null,c=n(u);s.material==null?s.material=new Xs({color:c}):s.material.color=c,r!=null&&"outline"in s&&((a=s.outline)==null?void 0:a.color)!=null&&(s.outline.color=wv(s.outline.color,r))}})}function UTe(e,t,r){var i;(t=t??e.color)&&(e.color=wv(t,r)),r!=null&&"outline"in e&&((i=e.outline)!=null&&i.color)&&(e.outline.color=wv(e.outline.color,r))}function e7e(e,t,r){e&&(t||r!=null)&&(t&&(t=new ve(t)),df(e)?jTe(e,t,r):vT(e)&&UTe(e,t,r))}async function VTe(e,t){const r=e.symbolLayers;r&&await Vme(r,async i=>GTe(i,t))}async function GTe(e,t){switch(e.type){case"extrude":zTe(e,t);break;case"icon":case"line":case"text":BTe(e,t);break;case"path":HTe(e,t);break;case"object":await qTe(e,t)}}function BTe(e,t){const r=VZ(t);r!=null&&(e.size=r)}function VZ(e){for(const t of e)if(typeof t=="number")return t;return null}function zTe(e,t){e.size=typeof t[2]=="number"?t[2]:0}async function qTe(e,t){const{resourceSize:r,symbolSize:i}=await WTe(e),n=GZ(t,r,i);e.width=V1(t[0],i[0],r[0],n),e.depth=V1(t[1],i[1],r[1],n),e.height=V1(t[2],i[2],r[2],n)}function HTe(e,t){const r=GZ(t,YG,[e.width,void 0,e.height]);e.width=V1(t[0],e.width,1,r),e.height=V1(t[2],e.height,1,r)}function GZ(e,t,r){for(let i=0;i<3;i++){const n=e[i];switch(n){case"symbol-value":{const s=r[i];return s!=null?s/t[i]:1}case"proportional":break;default:if(n&&t[i])return n/t[i]}}return 1}async function WTe(e){const{computeObjectLayerResourceSize:t}=await ge(()=>import("./symbolLayerUtils-TGiNYFCd.js"),__vite__mapDeps([58,1,2])),r=await t(e,10),{width:i,height:n,depth:s}=e,o=[i,s,n];let a=1;for(let u=0;u<3;u++){const c=o[u];if(c!=null){a=c/r[u];break}}for(let u=0;u<3;u++)o[u]==null&&(o[u]=r[u]*a);return{resourceSize:r,symbolSize:o}}function V1(e,t,r,i){switch(e){case"proportional":return r*i;case"symbol-value":return t??r;default:return e}}function JTe(e,t){const r=VZ(t);if(r!=null)switch(e.type){case"simple-marker":e.size=r;break;case"picture-marker":{const i=e.width/e.height;i>1?(e.width=r,e.height=r*i):(e.width=r*i,e.height=r);break}case"simple-line":e.width=r;break;case"text":e.font.size=r}}async function ZTe(e,t){if(e&&t)return df(e)?VTe(e,t):void(vT(e)&&JTe(e,t))}function YTe(e,t,r){if(e&&t!=null)if(df(e)){const i=e.symbolLayers;i&&i.forEach(n=>{if(n&&n.type==="object")switch(r){case"tilt":n.tilt=(n.tilt??0)+t;break;case"roll":n.roll=(n.roll??0)+t;break;default:n.heading=(n.heading??0)+t}})}else vT(e)&&(e.type!=="simple-marker"&&e.type!=="picture-marker"&&e.type!=="text"||(e.angle+=t))}async function t7e(e,t){return await e.fetchSymbol(t)||e.fetchCIMSymbol(t)}var xR;const Tj=new Set(["esriMetersPerSecond","esriKilometersPerHour","esriKnots","esriFeetPerSecond","esriMilesPerHour"]),n_=new We({beaufort_ft:"beaufort-ft",beaufort_km:"beaufort-km",beaufort_kn:"beaufort-kn",beaufort_m:"beaufort-m",beaufort_mi:"beaufort-mi",classified_arrow:"classified-arrow",ocean_current_kn:"ocean-current-kn",ocean_current_m:"ocean-current-m",simple_scalar:"simple-scalar",single_arrow:"single-arrow",wind_speed:"wind-barb"}),s_=new We({flow_from:"flow-from",flow_to:"flow-to"});let vn=xR=class extends Kp(Q){constructor(e){super(e),this.attributeField="Magnitude",this.flowRepresentation="flow-from",this.rotationType="arithmetic",this.style="single-arrow",this.symbolTileSize=50,this.type="vector-field"}readInputUnit(e,t){return Tj.has(e)?qs.fromJSON(e):null}readOutputUnit(e,t){return Tj.has(e)?qs.fromJSON(e):null}get styleRenderer(){const e=this.style,t=this.attributeField,r=this._createStyleRenderer(e);return r.field=t,r}get sizeVariables(){const e=[];if(this.visualVariables)for(const t of this.visualVariables)t.type==="size"&&e.push(t);if(e.length===0){const t=new r0({field:"Magnitude",minSize:.2*this.symbolTileSize,maxSize:.8*this.symbolTileSize});this.visualVariables?this.visualVariables.push(t):this._set("visualVariables",[t]),e.push(t)}return e}get rotationVariables(){const e=[];if(this.visualVariables)for(const t of this.visualVariables)t.type==="rotation"&&e.push(t);if(e.length===0){const t=new PT({field:"Direction",rotationType:this.rotationType});this.visualVariables?this.visualVariables.push(t):this._set("visualVariables",[t]),e.push(t)}return e}clone(){return new xR({attributeField:this.attributeField,flowRepresentation:this.flowRepresentation,rotationType:this.rotationType,symbolTileSize:this.symbolTileSize,style:this.style,visualVariables:B(this.visualVariables),inputUnit:this.inputUnit,outputUnit:this.outputUnit})}async getGraphicsFromPixelData(e,t=!1,r=[]){var y;const i=new Array,n=VT(this.inputUnit,this.outputUnit),s=((y=this.rotationVariables[0])==null?void 0:y.rotationType)||this.rotationType,o=t?_R(e.pixelBlock,"vector-uv",s,n):$Te(e.pixelBlock,"vector-magdir",n);if(o==null)return i;const a=e.extent,u=o.mask!=null&&o.mask.length>0;let c=0;const h=(a.xmax-a.xmin)/o.width,d=(a.ymax-a.ymin)/o.height;for(let v=0;v<o.height;v++)for(let w=0;w<o.width;w++,c++){let b=new Ae({x:a.xmin+w*h+h/2,y:a.ymax-v*d-d/2,spatialReference:a.spatialReference});b=(await Nl(b))[0];const _=r.some(x=>x.intersects(b));if((!u||o.mask[c])&&!_){const x={Magnitude:o.pixels[0][c],Direction:o.pixels[1][c]},T=new Da({geometry:{type:"point",x:b.x,y:b.y,spatialReference:a.spatialReference},attributes:x});T.symbol=this._getVisualVariablesAppliedSymbol(T),i.push(T)}}return i}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getClassBreakInfos(){var e;return(e=this.styleRenderer)==null?void 0:e.classBreakInfos}getDefaultSymbol(){var e;return(e=this.styleRenderer)==null?void 0:e.defaultSymbol}_getDefaultSymbol(e){return new Ll({path:"M14,32 14,18 9,23 16,3 22,23 17,18 17,32 z",outline:new oo({width:0}),size:20,color:e||new ve([0,92,230])})}_getVisualVariablesAppliedSymbol(e){var n,s;if(!e)return;const t=(s=(n=this.styleRenderer)==null?void 0:n.getSymbol(e))==null?void 0:s.clone(),r=this.sizeVariables,i=this.rotationVariables;if(r&&r.length&&this.sizeVariables.forEach(o=>ZTe(t,yJ([o],e))),i&&i.length){const o=this.flowRepresentation==="flow-to"==(this.style==="ocean-current-kn"||this.style==="ocean-current-m")?0:180;e.attributes.Direction=e.attributes.Direction+o,this.rotationVariables.forEach(a=>YTe(t,nP(a,e),a.axis))}return t}_createStyleRenderer(e){let t={defaultSymbol:this._getDefaultSymbol(),classBreakInfos:[]};switch(e){case"single-arrow":t=this._createSingleArrowRenderer();break;case"beaufort-kn":t=this._createBeaufortKnotsRenderer();break;case"beaufort-m":t=this._createBeaufortMeterRenderer();break;case"beaufort-ft":t=this._createBeaufortFeetRenderer();break;case"beaufort-mi":t=this._createBeaufortMilesRenderer();break;case"beaufort-km":t=this._createBeaufortKilometersRenderer();break;case"ocean-current-m":t=this._createCurrentMeterRenderer();break;case"ocean-current-kn":t=this._createCurrentKnotsRenderer();break;case"simple-scalar":t=this._createSimpleScalarRenderer();break;case"wind-barb":t=this._createWindBarbsRenderer();break;case"classified-arrow":t=this._createClassifiedArrowRenderer()}return new i0(t)}_createSingleArrowRenderer(){return{defaultSymbol:this._getDefaultSymbol()}}_createBeaufortKnotsRenderer(){const e=[0,1,3,6,10,16,21,27,33,40,47,55,63],t=[[40,146,199],[89,162,186],[129,179,171],[160,194,155],[191,212,138],[218,230,119],[250,250,100],[252,213,83],[252,179,102],[250,141,52],[247,110,42],[240,71,29]];return{defaultSymbol:this._getDefaultSymbol(new ve([214,47,39])),classBreakInfos:this._getClassBreaks(e,t)}}_createBeaufortMeterRenderer(){const e=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7],t=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]];return{defaultSymbol:this._getDefaultSymbol(new ve([214,47,39])),classBreakInfos:this._getClassBreaks(e,t)}}_createBeaufortFeetRenderer(){const e=this._getDefaultSymbol(new ve([214,47,39]));let t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const r=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],i=3.28084;return t=t.map(n=>n*i),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,r)}}_createBeaufortMilesRenderer(){const e=this._getDefaultSymbol(new ve([214,47,39]));let t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const r=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],i=2.23694;return t=t.map(n=>n*i),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,r)}}_createBeaufortKilometersRenderer(){const e=this._getDefaultSymbol(new ve([214,47,39]));let t=[0,.2,1.8,3.3,5.4,8.5,11,14.1,17.2,20.8,24.4,28.6,32.7];const r=[[69,117,181],[101,137,184],[132,158,186],[162,180,189],[192,204,190],[222,227,191],[255,255,191],[255,220,161],[250,185,132],[245,152,105],[237,117,81],[232,21,21]],i=3.6;return t=t.map(n=>n*i),{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,r)}}_createCurrentMeterRenderer(){const e=[0,.5,1,1.5,2],t=[[78,26,153],[179,27,26],[202,128,26],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ve([177,177,177])),classBreakInfos:this._getClassBreaks(e,t)}}_createCurrentKnotsRenderer(){const e=[0,.25,.5,1,1.5,2,2.5,3,3.5,4],t=[[0,0,0],[0,37,100],[78,26,153],[151,0,100],[179,27,26],[177,78,26],[202,128,26],[177,179,52],[177,177,177]];return{defaultSymbol:this._getDefaultSymbol(new ve([177,177,177])),classBreakInfos:this._getClassBreaks(e,t)}}_createClassifiedArrowRenderer(){var i;const e=this._getDefaultSymbol(new ve([56,168,0]));let t=[0,1e-6,3.5,7,10.5,14];if((i=this.sizeVariables)!=null&&i.length){const n=this.sizeVariables[0].minDataValue,s=this.sizeVariables[0].maxDataValue;if(n&&s){const o=(s-n)/5;t=Array.from(Array(6).keys()).map(a=>n+o*a)}}const r=[[56,168,0],[139,309,0],[255,255,0],[255,128,0],[255,0,0]];return{defaultSymbol:e,classBreakInfos:this._getClassBreaks(t,r)}}_createSimpleScalarRenderer(){return{defaultSymbol:qd.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACsAAAArCAQAAABLVLlLAAAABGdBTUEAAYagMeiWXwAAAAJiS0dEAACqjSMyAAAACXBIWXMAAABIAAAASABGyWs+AAAC3ElEQVRIx9XXvW4cVRQH8N982btpsIREJECyiCXsxX4DKh6AliqGKCBBE2SlwlHgAbBD/AKmyEYUeQ1KahPZSZQvBCkQLTHZ7KGY8Xodz4w3a1NwbzVzz/znfJ//zbStVC5q3icKak9GAs2QIdDx3PtW/S011NW3p+M5Eomh11ipTIKe6+4LQzHaQ+G+63pIZNJJQXMpljwTwj1brpgx5w1zZlyx5Z4QnllEIm2xeeSUHBf0hV0bejo1Uh09G3aFvgXk7cCJFBc9EdaRVuHJJaOdKyTV2TVhYLMduNR0Q9gxL5GaaTDw8GzejrDRBpxWoGsySRW0dttKuattwNkIlFw2YXgzOdYq4Ox49PlM+JrKd5OusjTWhBuVxUfMX/KXXZ3WEmkuqa67wspR4BTbwtKr/5u4fFgStse/T7EifFPnnYl9zPq4vmUOPrRndgoHjDti1gOPqlyXoifcRNGQzUd31lDyfHmob1Gp35vSr+P6vilcQ5Egtyd8YF/ySg9NhPM+9M/IOaHwp5+PSZayXTvCogEUwlatC3J8LLwYtcWB8EuDXQVuCkV5/B4eNHb7wGBs87LBDS+xjdVSn09wq1G8dFM+9tSUhIGneLvUdniKxKpTYljCpu3j7rVWlHj/P23v4NPGUEyeCQnexe9lJjzEQqMjJs+EzNAX6B98dBZVRmroJx95x/A/6gln18EyfCUsl+qdXb/tjvfbw+mwforpUOBz4XLVoBwAn3aWnfeH246NyBXhrq7TTN5lNSP9RkU+puUJm3W2Tsdq0nZWM07srk7MwQrZSRysjjGWBLRJNsNbfj2JMR4AbxpU1XLAb9Mxfpsq5EjMuuiR8L0JiHOOBX3hiUvOmavN0nMueSzcceFk0BK4pMqLo7vDD1Z0qrtDx7Itt4Xwm9UqbMmk8S0Dtuzb2pvOU99Z1nLTOfleNmvfZfP2pYZmPfajwosKdDBNpacNpVGGsWX9CyDI8Xq/Sj6QAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE0LTExLTEwVDAzOjE3OjU4LTA1OjAwF+tHyQAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxNC0xMS0xMFQwMzoxNzo1OC0wNTowMGa2/3UAAAAASUVORK5CYII=",height:20,width:20,type:"esriPMS",angle:0})}}_createWindBarbsRenderer(){const e=Array.from(Array(31).keys()).map(n=>5*n),t=[{range:"0-5",path:"M20 20 M5 20 A15 15 0 1 0 35 20 A15 15 0 1 0 5 20 M20 20 M10 20 A10 10 0 1 0 30 20 A10 10 0 1 0 10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTIwIDIwIE01IDIwIEExNSAxNSAwIDEgMCAzNSAyMCBBMTUgMTUgMCAxIDAgNSAyMCBNMjAgMjAgTTEwIDIwIEExMCAxMCAwIDEgMCAzMCAyMCBBMTAgMTAgMCAxIDAgMTAgMjAiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"5-10",path:"M25 0 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"10-15",path:"M25 0 L25 40 L10 45 L25 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNyA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"15-20",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L17.5 37.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjEyIDAgMTUgNDUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxNy41IDM3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"20-25",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"25-30",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9IjkgMCAyNiA0NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KICA8cGF0aCBkPSJNMjUgMCBMMjUgNDAgTDEwIDQ1IEwyNSA0MCBNMjUgMzUgTDEwIDQwIEwyNSAzNSBNMjUgMzAgTDE3LjUgMzIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"30-35",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"35-40",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"40-45",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"45-50",path:"M25 0 L25 40 L10 45 L25 40 M25 35 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0NiI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0NSBMMjUgNDAgTTI1IDM1IEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"50-55",path:"M25 0 L25 40 L10 40 L25 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"55-60",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L17.5 32.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMHB4IiBoZWlnaHQ9IjIwcHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxNy41IDMyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"60-65",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"65-70",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxNy41IDI3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"70-75",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"75-80",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxNy41IDIyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"80-85",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"85-90",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxNy41IDE3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"90-95",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"95-100",path:"M25 0 L25 40 L10 40 L25 35 M25 30 L10 35 L25 30 M25 25 L10 30 L25 25 M25 20 L10 25 L25 20 M25 15 L10 20 L25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTTI1IDMwIEwxMCAzNSBMMjUgMzAgTTI1IDI1IEwxMCAzMCBMMjUgMjUgTTI1IDIwIEwxMCAyNSBMMjUgMjAgTTI1IDE1IEwxMCAyMCBMMjUgMTUgTTI1IDEwIEwxNy41IDEyLjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="},{range:"100-105",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMnB4IiBoZWlnaHQ9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"105-110",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L17.5 27.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDE3LjUgMjcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"110-115",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"115-120",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L17.5 22.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDE3LjUgMjIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"120-125",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"125-130",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L17.5 17.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDE3LjUgMTcuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"130-135",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"135-140",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDE3LjUgMTIuNSIgc3R5bGU9InN0cm9rZTpyZ2IoMCwwLDApO3N0cm9rZS13aWR0aDoxLjUiLz4KIDwvc3ZnPg=="},{range:"140-145",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IiBzdHlsZT0ic3Ryb2tlOnJnYigwLDAsMCk7c3Ryb2tlLXdpZHRoOjEuNSIvPgogPC9zdmc+"},{range:"145-150",path:"M25 0 L25 40 L10 40 L25 35 L10 35 L25 30 M25 25 L10 30 M25 25 M25 20 L10 25 M25 20 M25 15 L10 20 M25 15 M25 10 L17.5 12.5",imageData:"PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzJweCIgd2lkdGg9IjMycHgiIHZpZXdCb3g9IjkgMCAyNiA0MSI+CiAgPHBhdGggZD0iTTI1IDAgTDI1IDQwIEwxMCA0MCBMMjUgMzUgTDEwIDM1IEwyNSAzMCBNMjUgMjUgTDEwIDMwIE0yNSAyNSBNMjUgMjAgTDEwIDI1IE0yNSAyMCBNMjUgMTUgTDEwIDIwIE0yNSAxNSBNMjUgMTAgTDEwIDE1IE0yNSAxMCBNMjUgNSBMMTcuNSA3LjUiIHN0eWxlPSJzdHJva2U6cmdiKDAsMCwwKTtzdHJva2Utd2lkdGg6MS41Ii8+CiA8L3N2Zz4="}],r=qd.fromJSON({imageData:"iVBORw0KGgoAAAANSUhEUgAAACgAAAApCAQAAADtq6NDAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAgY0hSTQAAeiYAAICEAAD6AAAAgOgAAHUwAADqYAAAOpgAABdwnLpRPAAAAAJiS0dEAP+Hj8y/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAEY0lEQVRIx5XXWWxWRRQH8N+d+31tUdGAVjGglYJABFEBY91jfDAg7piYaFTccA++uMQEFRcSXlATtxiXqMQt4G4iisYl0ai4sIQYtVFZ1KIFKdTS0l4f7vRCS5fPebozc+bM/2z/Mzcx0AgSiUxXnKfIdMn875FIhX53U2n/B/s+kKM4UINTjTBZImixxnrv+9a2iL6zEoUBXcoudrWj/OtHm3wt02lfU9Qao9OnHvIhgmww84MEl1qnxfNmGrqHxAizLdPpC6chGcAxKGGcL+30gOERf1BSpUqVslQSV8d5ReZFe8VQ9avufJn31cWwlJV7iafKStGOE/1qvfH9qUxxu8ydUdmuSKbGO8YUdT2inKLG69pM70tliktl5qIkCAJGmusDG7Vqsc0WjZa4UBlBiA5YZIcjYzB7qDtH5kaUJFLs7RGZTZ42W4PRRmtwvbdt1+wGiaS4drEtDttdZYIDNVuAclR3vA3+dI3qHqmVSy7U6Tv1MScCPvPR7nIpFlsdCy3FdTLPGhK92e2CUITjMJ9ocwKxnsZqc3O3JwMma3d6UVLnyVxB4aXemZqvPqLdpJhW3KVVbY4yYImPo6M5Urv50fj+0z/FG9YaEiENs8UtMfXUaTeTePNHlhXfA1UU+2lyD1Il3Gtt9+adfpNG7dNlpg2U/T3KYLZ2dUWFdTgp3/rQ4sK973qnInV5TIf40x3dhvrJPBiqyWUo4wAtLqhQYS71qK+QKOFRywmGK/kpikzV6WMKhh58vGWs4TIJNjiEYLIuP8Tt4/zmLyqk+AyrJSbF+Qq1DgqRUPMxyl+9q3IQhX/rMCJ6tEunriDs1oSyQZKlr9AkhT2ZIARbJfaJS1vtVbHB+Rgi0RK/y1q1BWsEEyLoz40xtGKcARPVWB1BTPO7f4LNtpkUl1aoMbViLyZo0GRjPD3BxnxjqXeLYlvhqYrzMMG3HoyJXa3JjfnGlbYYFlP7Jh3qKsKY4hQ7TY0nG+xwRL61n63mxHtqNHosigyMLmClNwvuecFnOZB88nNBDzNkzhxEZaKMBVoKapggMzvHHXBEpNSSFAvtcFRsVn0bW8LlMmcXs+c0Kne3gRR32+zg4uXwjC6zit6Wt4a8LXVfcp/MtQXHn2ynGbuCmb8GvvFeJLEE82ReU9/n6+dkq2x3buG9Wn94smcgAw631RPR7BTH+kbmHReZoEpOdEe7zWqZl40s0JWs9Hmv7hjBHqPDwsjGKVJnWWqjbdZp1KhJi0aPmxYZsIRhlttgeF+Jlke41QcOQKoqilSb6HJzSvNG3G/UoWnxwsmt+sVaYwd63dRbqdnMyCPVeyRPvpYgdavM22oGKoMUVRbJfOWMwidJ8Zzb1UvmWK/VVUXzHaTjjrVYh1897HT7xxYEVUaa5SWb/WO+YUWa9SrwvigzM8YlzlYv2GSdVCYxxlBtVnnFq5olwp5/BEk/OLsf5LUmG2+inRJdVvjZ97ZH9/zP34ug1O91pf4p+D+JYBpvrKxfbwAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxNC0xMS0xMFQwMzoxMjowOS0wNTowMB9ViV0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTQtMTEtMTBUMDM6MTI6MDktMDU6MDBuCDHhAAAAAElFTkSuQmCC",height:20,width:20,type:"esriPMS",angle:0}),i=e.map((n,s)=>{let o;if(s!==e.length-1)if(s===0)o={minValue:n,maxValue:e[s+1],symbol:r};else{const a=qd.fromJSON({type:"esriPMS",imageData:t[s].imageData,contentType:"image/svg+xml",height:32,width:32,angle:0});o={minValue:n,maxValue:e[s+1],symbol:a}}return new Pm(o)});return{defaultSymbol:r,classBreakInfos:i}}_getClassBreaks(e,t){return t.map((r,i)=>new Pm({minValue:e[i],maxValue:e[i+1],symbol:this._getDefaultSymbol(new ve(r))}))}};l([p({type:String,json:{write:!0}})],vn.prototype,"attributeField",void 0),l([p({type:s_.apiValues,json:{type:s_.jsonValues,read:{reader:s_.read},write:{writer:s_.write}}})],vn.prototype,"flowRepresentation",void 0),l([p({type:["geographic","arithmetic"],json:{write:!0}})],vn.prototype,"rotationType",void 0),l([p({type:n_.apiValues,json:{type:n_.jsonValues,read:{reader:n_.read},write:{writer:n_.write}}})],vn.prototype,"style",void 0),l([p({json:{write:!0}})],vn.prototype,"symbolTileSize",void 0),l([p({type:qs.apiValues,json:{type:qs.jsonValues,write:{writer:qs.write}}})],vn.prototype,"inputUnit",void 0),l([te("inputUnit")],vn.prototype,"readInputUnit",null),l([p({type:qs.apiValues,json:{type:qs.jsonValues,read:{reader:qs.read},write:{writer:qs.write}}})],vn.prototype,"outputUnit",void 0),l([te("outputUnit")],vn.prototype,"readOutputUnit",null),l([Ce({vectorField:"vector-field"})],vn.prototype,"type",void 0),l([p({type:i0})],vn.prototype,"styleRenderer",null),l([p({type:r0})],vn.prototype,"sizeVariables",null),l([p({type:PT})],vn.prototype,"rotationVariables",null),vn=xR=l([k("esri.renderers.VectorFieldRenderer")],vn);const OP=vn,TR={key:"type",base:null,typeMap:{"unique-value":s0,"class-breaks":i0,"raster-colormap":$P,"raster-stretch":EP,"vector-field":OP,"raster-shaded-relief":OZ,flow:MZ}},IR={...TR,typeMap:{...TR.typeMap}};delete IR.typeMap["vector-field"],delete IR.typeMap.flow;const KTe={uniqueValue:s0,classBreaks:i0,rasterStretch:EP,rasterColormap:$P,vectorField:OP,rasterShadedRelief:OZ,flowRenderer:MZ};function XTe(e){return e&&KTe[e.type]||null}function QTe(e,t){if(!e)return null;if(e.type==="classBreaks"&&e.classificationMethod){const i=e.authoringInfo||{classificationMethod:""};i.classificationMethod=e.classificationMethod,e.authoringInfo=i}e.type==="vectorField"&&e.visualVariables&&!Array.isArray(e.visualVariables)&&(e.visualVariables=[e.visualVariables]);const r=XTe(e);if(r){const i=new r;return i.read(e,t),i}return t!=null&&t.messages&&e&&t.messages.push(new eo("renderer:unsupported","Renderers of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:t})),null}var MR;let Kh=MR=class extends Q{constructor(e){super(e),this.variableName=null,this.dimensionName=null,this.values=[],this.isSlice=!1}clone(){return new MR({variableName:this.variableName,dimensionName:this.dimensionName,values:B(this.values),isSlice:this.isSlice})}};l([p({type:String,json:{write:!0}})],Kh.prototype,"variableName",void 0),l([p({type:String,json:{write:!0}})],Kh.prototype,"dimensionName",void 0),l([p({type:N0.array(N0.oneOf([N0.native(Number),N0.array(N0.native(Number))])),json:{write:!0}})],Kh.prototype,"values",void 0),l([p({type:Boolean,json:{write:!0}})],Kh.prototype,"isSlice",void 0),Kh=MR=l([k("esri.layers.support.DimensionalDefinition")],Kh);const Nm=Kh,bp=Qr()({RSP_NearestNeighbor:"nearest",RSP_BilinearInterpolation:"bilinear",RSP_CubicConvolution:"cubic",RSP_Majority:"majority"}),G1=Qr()({esriNoDataMatchAny:"any",esriNoDataMatchAll:"all"}),am=Qr()({U1:"u1",U2:"u2",U4:"u4",U8:"u8",S8:"s8",U16:"u16",S16:"s16",U32:"u32",S32:"s32",F32:"f32",F64:"f64",C64:"c64",C128:"c128",UNKNOWN:"unknown"});let Vc=class extends Q{constructor(){super(...arguments),this.pixelType="unknown"}};l([p({type:String,json:{write:!0}})],Vc.prototype,"name",void 0),l([p({type:String,json:{write:!0}})],Vc.prototype,"description",void 0),l([p({type:Ke,json:{type:Ke,write:!0,name:"_object_id"}})],Vc.prototype,"id",void 0),l([p({type:String,json:{type:am.jsonValues,read:am.read,write:am.write}})],Vc.prototype,"pixelType",void 0),l([p({type:String,json:{write:!0}})],Vc.prototype,"type",void 0),Vc=l([k("esri.layers.support.RasterFunctionInfo")],Vc);const eIe=Vc;let hu=class extends Q{constructor(){super(...arguments),this.isDataset=!1,this.isPublic=!1,this.type="RasterFunctionVariable"}};l([p({type:String,json:{write:!0}})],hu.prototype,"name",void 0),l([p({type:Number,json:{type:Ke,write:!0,name:"_object_id"}})],hu.prototype,"id",void 0),l([p({type:Boolean,json:{write:!0}})],hu.prototype,"isDataset",void 0),l([p({type:Boolean,json:{write:!0}})],hu.prototype,"isPublic",void 0),l([p({json:{write:!0}})],hu.prototype,"value",void 0),l([p({type:String,json:{write:!0}})],hu.prototype,"type",void 0),hu=l([k("esri.layers.support.RasterFunctionVariable")],hu);const tIe=hu,o_={key:"type",base:null,typeMap:{RasterFunctionVariable:tIe}};let Xh=class extends Q{};l([p({types:o_,json:{types:o_,name:"MatchVariable"}})],Xh.prototype,"matchVariable",void 0),l([p({types:o_,json:{types:o_,name:"UnionDimension"}})],Xh.prototype,"unionDimension",void 0),l([p({type:Number,json:{type:Ke,write:!0,name:"_object_id"}})],Xh.prototype,"id",void 0),l([p({type:String,json:{write:!0}})],Xh.prototype,"type",void 0),Xh=l([k("esri.layers.support.RasterFunctionProperties")],Xh);const rIe=Xh,AM=new We({0:"mosaic",1:"item",2:"item-group"},{useNumericKeys:!0});let Ni=class extends Q{constructor(){super(...arguments),this.functionType="mosaic",this.type="RasterFunctionTemplate"}};l([p({type:[String],json:{write:!0}})],Ni.prototype,"aliases",void 0),l([p({type:Object,json:{write:!0}})],Ni.prototype,"arguments",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"description",void 0),l([p({type:eIe,json:{write:!0,name:"function"}})],Ni.prototype,"functionInfo",void 0),l([p({type:AM.apiValues,json:{type:[0,1,2],read:AM.read,write:AM.write}})],Ni.prototype,"functionType",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"group",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"help",void 0),l([p({type:Number,json:{type:Ke,write:!0,name:"_object_id"}})],Ni.prototype,"id",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"name",void 0),l([p({type:String,json:{write:!0,name:"definition"}})],Ni.prototype,"queryDefinition",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"tag",void 0),l([p({type:rIe,json:{write:!0}})],Ni.prototype,"properties",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"thumbnail",void 0),l([p({type:String,json:{write:!0}})],Ni.prototype,"thumbnailEx",void 0),l([p({json:{type:["RasterFunctionTemplate"],write:!0}})],Ni.prototype,"type",void 0),Ni=l([k("esri.layers.support.RasterFunctionTemplate")],Ni);const BZ=Ni;var $R;const N2=new Set(["raster","raster2","dem","fillraster"]),D2=new Set(["rasters"]),Ij=e=>e!=null&&e.rasterFunction?Sn.fromJSON(e):e,RM=e=>e&&e instanceof Sn?e.toJSON():e,ER=e=>(e==null?void 0:e.functionName)&&!e.declaredClass,Mj=e=>ER(e)?new Sn(e):e,iIe=e=>{if(e==null)return null;e=B(e);const t={};for(const r of Object.keys(e))N2.has(r.toLowerCase())?t[r]=Ij(e[r]):D2.has(r.toLowerCase())&&Array.isArray(e[r])?t[r]=e[r].map(Ij):t[r]=e[r];return t},nIe={types:{key:"type",base:null,typeMap:{RasterFunctionTemplate:BZ}},json:{write:!0,name:"rasterFunctionDefinition"}};let Sn=$R=class extends Q{constructor(e){super(e),this.functionName=null,this.outputPixelType="unknown",this.variableName=null,this.functionDefinition=null}set functionArguments(e){if(e){const t=Object.keys(e);if(t.some(r=>N2.has(r.toLowerCase())&&ER(e[r]))||t.some(r=>D2.has(r.toLowerCase())&&Array.isArray(e[r])&&e[r].some(i=>ER(i)))){e=B(e);for(const r of t)N2.has(r.toLowerCase())?e[r]=Mj(e[r]):D2.has(r.toLowerCase())&&Array.isArray(e[r])&&(e[r]=e[r].map(i=>Mj(i)))}}this._set("functionArguments",e)}readFunctionArguments(e){return iIe(e)}writeFunctionArguments(e,t,r){const i={};for(const n of Object.keys(e))N2.has(n.toLowerCase())?i[n]=RM(e[n]):D2.has(n.toLowerCase())&&Array.isArray(e[n])?i[n]=e[n].map(RM):i[n]=RM(e[n]);t[r]=i}readFunctionName(e,t){const r=t.rasterFunctionInfos;return t.name||(r!=null&&r.length&&r[0].name!=="None"?r[0].name:t.rasterFunctionDefinition?t.rasterFunctionDefinition.name:t.rasterFunction)}get rasterFunctionDefinition(){var e;return(e=this.functionDefinition)==null?void 0:e.toJSON()}set rasterFunctionDefinition(e){this.functionDefinition=e?BZ.fromJSON(e):null}get hasClipFunction(){return this.rasterFunctionDefinition?JSON.stringify(this.rasterFunctionDefinition).includes('"type":"ClipFunction"'):JSON.stringify(this).includes('"rasterFunction":"Clip"')}clone(){return new $R({functionName:this.functionName,functionArguments:B(this.functionArguments),outputPixelType:this.outputPixelType,variableName:this.variableName,rasterFunctionDefinition:B(this.rasterFunctionDefinition)})}};l([p({json:{type:Object,name:"rasterFunctionArguments"}})],Sn.prototype,"functionArguments",null),l([te("functionArguments")],Sn.prototype,"readFunctionArguments",null),l([se("functionArguments")],Sn.prototype,"writeFunctionArguments",null),l([p({json:{type:String,write:{target:"rasterFunction"}}})],Sn.prototype,"functionName",void 0),l([te("functionName",["rasterFunction","rasterFunctionInfos","rasterFunctionDefinition"])],Sn.prototype,"readFunctionName",null),l([Ce({C128:"c128",C64:"c64",F32:"f32",F64:"f64",S16:"s16",S32:"s32",S8:"s8",U1:"u1",U16:"u16",U2:"u2",U32:"u32",U4:"u4",U8:"u8",UNKNOWN:"unknown"},{ignoreUnknown:!1}),p({json:{default:"unknown"}})],Sn.prototype,"outputPixelType",void 0),l([p({type:String,json:{read:!0,write:!0}})],Sn.prototype,"variableName",void 0),l([p()],Sn.prototype,"rasterFunctionDefinition",null),l([p(nIe)],Sn.prototype,"functionDefinition",void 0),l([p()],Sn.prototype,"hasClipFunction",null),Sn=$R=l([k("esri.layers.support.RasterFunction")],Sn);const vt=Sn,sIe={StretchFunction:{arguments:{ComputeGamma:{isDataset:!1,isPublic:!1,name:"ComputeGamma",type:"RasterFunctionVariable",value:!1},DRA:{isDataset:!1,isPublic:!1,name:"DRA",type:"RasterFunctionVariable",value:!1},EstimateStatsHistogram:{isDataset:!1,isPublic:!1,name:"EstimateStatsHistogram",type:"RasterFunctionVariable",value:!1},Gamma:{displayName:"Gamma",isDataset:!1,isPublic:!1,name:"Gamma",type:"RasterFunctionVariable"},Histograms:{isDataset:!1,isPublic:!1,name:"Histograms",type:"RasterFunctionVariable"},Max:{isDataset:!1,isPublic:!1,name:"Max",type:"RasterFunctionVariable",value:255},MaxPercent:{isDataset:!1,isPublic:!1,name:"MaxPercent",type:"RasterFunctionVariable",value:.5},Min:{isDataset:!1,isPublic:!1,name:"Min",type:"RasterFunctionVariable",value:0},MinPercent:{isDataset:!1,isPublic:!1,name:"MinPercent",type:"RasterFunctionVariable",value:.25},NumberOfStandardDeviations:{isDataset:!1,isPublic:!1,name:"NumberOfStandardDeviation",type:"RasterFunctionVariable",value:2},Raster:{isDataset:!0,isPublic:!1,name:"Raster",type:"RasterFunctionVariable"},SigmoidStrengthLevel:{isDataset:!1,isPublic:!1,name:"SigmoidStrengthLevel",type:"RasterFunctionVariable",value:2},Statistics:{isDataset:!1,isPublic:!1,name:"Statistics",type:"RasterFunctionVariable"},StretchType:{isDataset:!1,isPublic:!1,name:"StretchType",type:"RasterFunctionVariable",value:0},type:"StretchFunctionArguments",UseGamma:{isDataset:!1,isPublic:!1,name:"UseGamma",type:"RasterFunctionVariable",value:!1}},description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",function:{description:"Enhances an image by adjusting the range of values displayed. This does not alter the underlying pixel values. If a pixel has a value outside of the specified range, it will appear as either the minimum or maximum value.",name:"Stretch",pixelType:"UNKNOWN",type:"StretchFunction"},functionType:0,name:"Stretch",thumbnail:""},RemapFunction:{name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table.",function:{type:"RemapFunction",pixelType:"UNKNOWN",name:"Remap",description:"Changes pixel values by assigning new values to ranges of pixel values or using an external table."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},UseTable:{name:"UseTable",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},InputRanges:{name:"InputRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Input Ranges"},OutputValues:{name:"OutputValues",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"Output Values"},NoDataRanges:{name:"NoDataRanges",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable",displayName:"NoData Ranges"},Table:{name:"Table",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputField:{name:"InputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},OutputField:{name:"OutputField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},InputMaxField:{name:"InputMaxField",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},RemapTableType:{name:"RemapTableType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},AllowUnmatched:{name:"AllowUnmatched",isPublic:!1,isDataset:!1,value:!0,type:"RasterFunctionVariable"},type:"RemapFunctionArguments"},functionType:0,thumbnail:""},ColormapFunction:{name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp.",function:{type:"ColormapFunction",pixelType:"UNKNOWN",name:"Colormap",description:"Changes pixel values to display the raster data as either a grayscale or a red, green, blue (RGB) image, based on a colormap or a color ramp."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},ColormapName:{name:"ColormapName",isPublic:!1,isDataset:!1,value:"Gray",type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},type:"ColormapFunctionArguments"},functionType:0,thumbnail:""},ShadedReliefFunction:{name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image.",function:{type:"ShadedReliefFunction",pixelType:"UNKNOWN",name:"Shaded Relief",description:"Creates a multiband, color coded, 3D representation of the surface, with the sun's relative position taken into account for shading the image."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ColorSchemeType:{name:"ColorSchemeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ColorRamp:{name:"ColorRamp",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Colormap:{name:"Colormap",isPublic:!1,isDataset:!1,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"ShadedReliefFunctionArguments"},functionType:0,thumbnail:""},HillshadeFunction:{name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image",function:{type:"HillshadeFunction",pixelType:"UNKNOWN",name:"Hillshade",description:"Creates a 3D representation of the surface, with the sun's relative position taken into account for shading the image"},arguments:{DEM:{name:"DEM",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},HillshadeType:{name:"HillshadeType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},Azimuth:{name:"Azimuth",isPublic:!1,isDataset:!1,value:315,type:"RasterFunctionVariable"},Altitude:{name:"Altitude",isPublic:!1,isDataset:!1,value:45,type:"RasterFunctionVariable"},SlopeType:{name:"SlopeType",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},ZFactor:{name:"ZFactor",isPublic:!1,isDataset:!1,value:1,type:"RasterFunctionVariable"},PSPower:{name:"PSPower",isPublic:!1,isDataset:!1,value:.664,type:"RasterFunctionVariable"},PSZFactor:{name:"PSZFactor",isPublic:!1,isDataset:!1,value:.024,type:"RasterFunctionVariable"},RemoveEdgeEffect:{name:"RemoveEdgeEffect",isPublic:!1,isDataset:!1,value:!1,type:"RasterFunctionVariable"},type:"HillshadeFunctionArguments"},functionType:0,thumbnail:""},ResampleFunction:{name:"Resample",description:"Changes the cell size of a raster.",function:{type:"ResampleFunction",pixelType:"UNKNOWN",name:"Resample",description:"Changes the cell size of a raster."},arguments:{Raster:{name:"Raster",isPublic:!1,isDataset:!0,type:"RasterFunctionVariable"},ResamplingType:{name:"ResamplingType",isPublic:!1,isDataset:!1,value:0,type:"RasterFunctionVariable"},InputCellSize:{name:"InputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},OutputCellSize:{name:"OutputCellsize",isPublic:!1,isDataset:!1,value:{x:0,y:0},type:"RasterFunctionVariable"},type:"ResampleFunctionArguments"},functionType:0,thumbnail:""}},oIe=new Set(["u1","u2","u4","u8","s8","u16","s16"]),aIe={simple_scalar:"Simple Scalar",wind_barb:"Wind Barb",single_arrow:"Single Arrow",beaufort_kn:"Beaufort Wind (Knots)",beaufort_m:"Beaufort Wind (MetersPerSecond)",ocean_current_m:"Ocean Current (MetersPerSecond)",ocean_current_kn:"Ocean Current (Knots)"},lIe=new Set(["raster-stretch","unique-value","class-breaks","raster-shaded-relief","vector-field","raster-colormap"]);function zZ(e){return lIe.has(e.type)}function CM(e,t){var i;if(!e||!t)return B(e||t);const r=B(e);if(r.functionDefinition&&t.rasterFunctionDefinition){const n=t.rasterFunctionDefinition;(n.thumbnail||n.thumbnailEx)&&(n.thumbnail=n.thumbnailEx=void 0),qZ(r.functionDefinition.arguments,t),r.rasterFunctionDefinition=r.functionDefinition.toJSON()}else((i=t.functionName)==null?void 0:i.toLowerCase())!=="none"&&(HZ(r.functionArguments).Raster=t);return r}function qZ(e,t){for(const r in e)r.toLowerCase()==="raster"&&(e[r].type==="RasterFunctionVariable"?(e[r]=t.rasterFunctionDefinition,e[r].type="RasterFunctionTemplate"):e[r].type==="RasterFunctionTemplate"&&qZ(e[r].arguments,t))}function Cl(e){const t=B(sIe[e.functionName+"Function"]),r=e.functionArguments;for(const i in r)i.toLowerCase()==="raster"?(t.arguments[i]=Cl(r[i]),t.arguments[i].type="RasterFunctionTemplate"):i.toLowerCase()==="colormap"?(t.arguments[i].value=gIe(r[i]),t.arguments.ColorSchemeType.value=0):t.arguments[i].value=r[i];return t}function uIe(e,t){switch(t=t||{},e.type){case"raster-stretch":return hIe(e,t);case"class-breaks":return dIe(e,t);case"unique-value":return fIe(e,t);case"raster-colormap":return yIe(e,t);case"vector-field":return cIe(e,t);case"raster-shaded-relief":return pIe(e,t);case"flow":throw new Error("Unsupported rendering rule.")}}function HZ(e){const t=(e==null?void 0:e.Raster)??(e==null?void 0:e.raster);return t&&t.declaredClass==="esri.layers.support.RasterFunction"?HZ(t.functionArguments):e}const Q0={none:0,standardDeviation:3,histogramEqualization:4,minMax:5,percentClip:6,sigmoid:9};function cIe(e,t){const r=new vt;r.functionName="VectorFieldRenderer";const{dataType:i,bandNames:n}=t,s=i==="vector-uv";let o,a;if(n&&n.length===2){const v=n.map(w=>w.toLowerCase());o=v.indexOf("magnitude"),a=v.indexOf("direction")}o!==-1&&o!==null||(o=0,a=1);const u=e.rotationType==="arithmetic"?1:2,c=e.flowRepresentation==="flow-from"?0:1,h=e.visualVariables?e.visualVariables.find(v=>v.field==="Magnitude"):new r0,d={magnitudeBandID:o,directionBandID:a,isUVComponents:s,referenceSystem:u,massFlowAngleRepresentation:c,symbolTileSize:50,symbolTileSizeUnits:100,calculationMethod:"Vector Average",symbologyName:aIe[e.style.toLowerCase().replace("-","_")],minimumMagnitude:h.minDataValue,maximumMagnitude:h.maxDataValue,minimumSymbolSize:h.minSize,maximumSymbolSize:h.maxSize};r.functionArguments=d;const y=Cl(r);return t.convertToRFT?vt.fromJSON({rasterFunctionDefinition:y}):r}function pIe(e,t){const r=t.convertToRFT;if(t.dataType!=="elevation"&&(t.dataType!=="generic"||t.bandCount!==1||t.pixelType!=="s16"&&t.pixelType!=="s32"&&t.pixelType!=="f32"&&t.pixelType!=="f64"))return new vt;const i=new vt;i.functionName="Hillshade";const n=e.hillshadeType==="traditional"?0:1,s=e.scalingType==="none"?1:3,o={HillshadeType:n,SlopeType:s,ZFactor:e.zFactor};return n===0&&(o.Azimuth=e.azimuth,o.Altitude=e.altitude),s===3&&(o.PSPower=e.pixelSizePower,o.PSZFactor=e.pixelSizeFactor),i.functionArguments=o,i.variableName="Raster",e.colorRamp&&(i.functionName="ShadedRelief",r?o.ColorRamp=CZ(e.colorRamp):o.Colormap=km(e.colorRamp)),r?new vt({rasterFunctionDefinition:Cl(i)}):i}function hIe(e,t){var a;const r=t.convertToRFT,i=new vt;i.functionName="Stretch";const n=Q0[U1.toJSON(e.stretchType)],s="u8",o={StretchType:n,Statistics:mIe(e.statistics??[]),DRA:e.dynamicRangeAdjustment,UseGamma:e.useGamma,Gamma:e.gamma,ComputeGamma:e.computeGamma};if(e.outputMin!=null&&(o.Min=e.outputMin),e.outputMax!=null&&(o.Max=e.outputMax),n===Q0.standardDeviation?(o.NumberOfStandardDeviations=e.numberOfStandardDeviations,i.outputPixelType=s):n===Q0.percentClip?(o.MinPercent=e.minPercent,o.MaxPercent=e.maxPercent,i.outputPixelType=s):n===Q0.minMax?i.outputPixelType=s:n===Q0.sigmoid&&(o.SigmoidStrengthLevel=e.sigmoidStrengthLevel),i.functionArguments=o,i.variableName="Raster",e.colorRamp){const u=e.colorRamp,c=new vt;if(r)c.functionArguments={ColorRamp:CZ(u)};else{const h=EZ(u,!0);if(h)c.functionArguments={colorRampName:h};else if(!t.convertColorRampToColormap||u.type!=="algorithmic"&&u.type!=="multipart"){const d=e.colorRamp.toJSON();d.type==="algorithmic"?d.algorithm=d.algorithm||"esriCIELabAlgorithm":d.type==="multipart"&&((a=d.colorRamps)!=null&&a.length)&&d.colorRamps.forEach(y=>y.algorithm=y.algorithm||"esriCIELabAlgorithm"),c.functionArguments={colorRamp:d}}else c.functionArguments={Colormap:km(u)}}return c.variableName="Raster",c.functionName="Colormap",c.functionArguments.Raster=i,r?new vt({rasterFunctionDefinition:Cl(c)}):c}return r?new vt({rasterFunctionDefinition:Cl(i)}):i}function dIe(e,t){const r=[],i=[],n=[],s=[],{pixelType:a,rasterAttributeTable:u}=t,c=u==null?null:u.features,h=WZ(u);if(h&&c&&Array.isArray(c)&&e.classBreakInfos){e.classBreakInfos.forEach((_,x)=>{var M;const T=(M=_.symbol)==null?void 0:M.color;let I;T!=null&&T.a&&_.minValue!=null&&_.maxValue!=null&&c.forEach($=>{_.minValue!=null&&_.maxValue!=null&&(I=$.attributes[e.field],(I>=_.minValue&&I<_.maxValue||x===e.classBreakInfos.length-1&&I>=_.minValue)&&s.push([$.attributes[h],T.r,T.g,T.b]))})});const w=a?gx(s,a):s,b=new vt;return b.functionName="Colormap",b.functionArguments={},b.functionArguments.Colormap=w,b.variableName="Raster",t.convertToRFT?new vt({rasterFunctionDefinition:Cl(b)}):b}e.classBreakInfos.forEach((w,b)=>{if(w.minValue==null||w.maxValue==null)return;const _=w.symbol&&w.symbol.color;_!=null&&_.a?(b===0?r.push(w.minValue,w.maxValue+1e-4):r.push(w.minValue+1e-4,w.maxValue+1e-4),i.push(b),s.push([b,_.r,_.g,_.b])):n.push(w.minValue,w.maxValue)});const d=a?gx(s,a):s,y=new vt;y.functionName="Remap",y.functionArguments={InputRanges:r,OutputValues:i,NoDataRanges:n},y.variableName="Raster";const v=new vt;return v.functionName="Colormap",v.functionArguments={Colormap:d,Raster:y},t.convertToRFT?new vt({rasterFunctionDefinition:Cl(v)}):v}function gx(e,t){const r=oIe.has(t)?o0(t):null;return r&&e.push([Math.floor(r[0]-1),0,0,0],[Math.ceil(r[1]+1),0,0,0]),e}function WZ(e){if(e==null)return;const{fields:t}=e,r=t==null?void 0:t.find(i=>(i==null?void 0:i.name)&&i.name.toLowerCase()==="value");return r==null?void 0:r.name}function fIe(e,t){var d,y,v;const r=[],{pixelType:i,rasterAttributeTable:n}=t,s=n==null?null:n.features,o=WZ(n),a=(y=(d=e.defaultSymbol)==null?void 0:d.color)==null?void 0:y.toRgb(),u=e.uniqueValueInfos;if(u)if(s){if(o){const w=new Map;u.forEach(_=>{var I;const x=_.value,T=(I=_.symbol)==null?void 0:I.color;x!=null&&(T!=null&&T.a)&&w.set(String(x),T.toRgb())});const b=e.field;s.forEach(({attributes:_})=>{const x=String(_[b]),T=_[o],I=w.get(x);I?r.push([T,...I]):a&&r.push([T,...a])})}}else for(let w=0;w<u.length;w++){const b=u[w],_=(v=b.symbol)==null?void 0:v.color,x=+b.value;if(_!=null&&_.a){if(isNaN(x))return null;r.push([x,_.r,_.g,_.b])}}const c=i?gx(r,i):r,h=new vt;return h.functionName="Colormap",h.functionArguments={},h.functionArguments.Colormap=c,h.variableName="Raster",t.convertToRFT?new vt({rasterFunctionDefinition:Cl(h)}):h}function yIe(e,t){const r=e.extractColormap();if(!r||r.length===0)return null;const{pixelType:i}=t,n=i?gx(r,i):r,s=new vt;return s.functionName="Colormap",s.functionArguments={},s.functionArguments.Colormap=n,t.convertToRFT?new vt({rasterFunctionDefinition:Cl(s)}):s}function mIe(e){const t=[];return e==null||e.forEach(r=>{const i=r;if(Array.isArray(i))t.push(i);else{if(i.min==null||i.max==null)return;const n=[i.min,i.max,i.avg||0,i.stddev||0];t.push(n)}}),t}function gIe(e){const t=[],r=[];return e.forEach(i=>{t.push(i[0]),r.push(gTe([...i.slice(1),255]))}),{type:"RasterColormap",values:t,colors:r}}var AR;const B1=Qr()({MT_FIRST:"first",MT_LAST:"last",MT_MIN:"min",MT_MAX:"max",MT_MEAN:"mean",MT_BLEND:"blend",MT_SUM:"sum"}),RR=Qr()({esriMosaicNone:"none",esriMosaicCenter:"center",esriMosaicNadir:"nadir",esriMosaicViewpoint:"viewpoint",esriMosaicAttribute:"attribute",esriMosaicLockRaster:"lock-raster",esriMosaicNorthwest:"northwest",esriMosaicSeamline:"seamline"});function vIe(e){let t;switch(e?e.toLowerCase().replace("esrimosaic",""):""){case"byattribute":case"attribute":t="esriMosaicAttribute";break;case"lockraster":t="esriMosaicLockRaster";break;case"center":t="esriMosaicCenter";break;case"northwest":t="esriMosaicNorthwest";break;case"nadir":t="esriMosaicNadir";break;case"viewpoint":t="esriMosaicViewpoint";break;case"seamline":t="esriMosaicSeamline";break;default:t="esriMosaicNone"}return RR.fromJSON(t)}let ui=AR=class extends Q{constructor(e){super(e),this.ascending=!0,this.itemRasterFunction=null,this.lockRasterIds=null,this.method=null,this.multidimensionalDefinition=null,this.objectIds=null,this.operation=null,this.sortField=null,this.sortValue=null,this.viewpoint=null,this.where=null}readAscending(e,t){return t.ascending!=null?t.ascending:t.sortAscending==null||t.sortAscending}get itemRenderingRule(){return Ma(oe.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._get("itemRasterFunction")}set itemRenderingRule(e){Ma(oe.getLogger(this),"itemRenderingRule",{replacement:"itemRasterFunction",version:"4.27",warnOnce:!0}),this._set("itemRasterFunction",e)}readMethod(e,t){return vIe(t.mosaicMethod||t.defaultMosaicMethod)}writeMultidimensionalDefinition(e,t,r){e!=null&&(e=e.filter(({variableName:i,dimensionName:n})=>i&&i!=="*"||n)).length&&(t[r]=e.map(i=>i.toJSON()))}readOperation(e,t){var s;const r=t.mosaicOperation,i=(s=t.mosaicOperator)==null?void 0:s.toLowerCase(),n=r||(i?B1.toJSON(i):null);return B1.fromJSON(n)||"first"}castSortValue(e){return e==null||typeof e=="string"||typeof e=="number"?e:`${e}`}clone(){return new AR({ascending:this.ascending,itemRasterFunction:B(this.itemRasterFunction),lockRasterIds:B(this.lockRasterIds),method:this.method,multidimensionalDefinition:B(this.multidimensionalDefinition),objectIds:B(this.objectIds),operation:this.operation,sortField:this.sortField,sortValue:this.sortValue,viewpoint:B(this.viewpoint),where:this.where})}};l([p({type:Boolean,json:{write:!0}})],ui.prototype,"ascending",void 0),l([te("ascending",["ascending","sortAscending"])],ui.prototype,"readAscending",null),l([p({type:vt,json:{name:"itemRenderingRule",write:!0}})],ui.prototype,"itemRasterFunction",void 0),l([p({type:vt})],ui.prototype,"itemRenderingRule",null),l([p({type:[Ke],json:{write:{overridePolicy(){return{enabled:this.method==="lock-raster"}}}}})],ui.prototype,"lockRasterIds",void 0),l([p({type:String,json:{type:RR.jsonValues,write:{target:"mosaicMethod",writer:RR.write}}})],ui.prototype,"method",void 0),l([te("method",["mosaicMethod","defaultMosaicMethod"])],ui.prototype,"readMethod",null),l([p({type:[Nm],json:{write:!0}})],ui.prototype,"multidimensionalDefinition",void 0),l([se("multidimensionalDefinition")],ui.prototype,"writeMultidimensionalDefinition",null),l([p({type:[Ke],json:{name:"fids",write:!0}})],ui.prototype,"objectIds",void 0),l([p({json:{type:B1.jsonValues,read:{reader:B1.read},write:{target:"mosaicOperation",writer:B1.write}}})],ui.prototype,"operation",void 0),l([te("operation",["mosaicOperation","mosaicOperator"])],ui.prototype,"readOperation",null),l([p({type:String,json:{write:{overridePolicy(){return{enabled:this.method==="attribute"}}}}})],ui.prototype,"sortField",void 0),l([p({type:[String,Number],json:{write:{allowNull:!0,overridePolicy(){return{enabled:this.method==="attribute",allowNull:!0}}}}})],ui.prototype,"sortValue",void 0),l([Tt("sortValue")],ui.prototype,"castSortValue",null),l([p({type:Ae,json:{write:!0}})],ui.prototype,"viewpoint",void 0),l([p({type:String,json:{write:!0}})],ui.prototype,"where",void 0),ui=AR=l([k("esri.layers.support.MosaicRule")],ui);const Hs=ui;let Ur=class extends Q{constructor(){super(...arguments),this.layer=null,this.compression=void 0,this.pixelType=void 0,this.lercVersion=2}get adjustAspectRatio(){return this.layer.adjustAspectRatio}writeAdjustAspectRatio(t,r,i){this.layer.version<10.3||(r[i]=t)}get bandIds(){return this.layer.bandIds}get compressionQuality(){return this.layer.compressionQuality}writeCompressionQuality(t,r,i){this.format&&this.format.toLowerCase().includes("jpg")&&t!=null&&(r[i]=t)}get compressionTolerance(){return this.layer.compressionTolerance}writeCompressionTolerance(t,r,i){this.format==="lerc"&&t!=null&&(r[i]=t)}get format(){var t;return((t=this.layer.renderer)==null?void 0:t.type)==="vector-field"?"lerc":this.layer.format}get interpolation(){return this.layer.interpolation}get noData(){return this.layer.noData}get noDataInterpretation(){return this.layer.noDataInterpretation}writeLercVersion(t,r,i){this.format==="lerc"&&this.layer.version>=10.5&&(r[i]=t)}get version(){const t=this.layer;return t.commitProperty("bandIds"),t.commitProperty("format"),t.commitProperty("compressionQuality"),t.commitProperty("compressionTolerance"),t.commitProperty("interpolation"),t.commitProperty("noData"),t.commitProperty("noDataInterpretation"),t.commitProperty("mosaicRule"),t.commitProperty("rasterFunction"),t.commitProperty("adjustAspectRatio"),t.commitProperty("pixelFilter"),t.commitProperty("definitionExpression"),t.commitProperty("multidimensionalSubset"),(this._get("version")||0)+1}set version(t){this._set("version",t)}get mosaicRule(){const t=this.layer;let r=t.mosaicRule;const i=t.definitionExpression;return r?i&&i!==r.where&&(r=r.clone(),r.where=i):i&&(r=new Hs({where:i})),r}get rasterFunction(){var o,a;const t=this.layer;let{rasterFunction:r}=t;const i=t.pixelFilter,n=!t.format||t.format.includes("jpg")||t.format.includes("png");r=this._addResampleRasterFunction(r);const s=(o=t.multidimensionalSubset)==null?void 0:o.areaOfInterest;return s&&(r=this._addClipFunction(r,s)),n&&!i&&((a=t.renderer)==null?void 0:a.type)!=="vector-field"&&(r=this.combineRendererWithRenderingRule(r)),r}combineRendererWithRenderingRule(t){const r=this.layer,{rasterInfo:i,renderer:n}=r;return t=t||r.rasterFunction,!n||!zZ(n)?t:CM(uIe(n,{rasterAttributeTable:i.attributeTable,pixelType:i.pixelType,dataType:i.dataType,bandNames:i.bandInfos.map(({name:s})=>s),convertColorRampToColormap:r.version<10.6,convertToRFT:!!(t!=null&&t.rasterFunctionDefinition),bandCount:i.bandCount}),t)}_addResampleRasterFunction(t){var s;if(((s=this.layer.renderer)==null?void 0:s.type)!=="vector-field"||(t==null?void 0:t.functionName)==="Resample")return t;const r=this.layer.serviceDataType==="esriImageServiceDataTypeVector-UV"?7:10,i=this.layer.serviceRasterInfo.pixelSize;let n=new vt({functionName:"Resample",functionArguments:{ResamplingType:r,InputCellSize:i}});return n=t!=null&&t.rasterFunctionDefinition?new vt({rasterFunctionDefinition:Cl(n)}):n,CM(n,t)}_addClipFunction(t,r){const i=new vt({functionName:"Clip",functionArguments:{ClippingGeometry:r.toJSON(),ClippingType:1}});return CM(i,t)}};l([p()],Ur.prototype,"layer",void 0),l([p({json:{write:!0}})],Ur.prototype,"adjustAspectRatio",null),l([se("adjustAspectRatio")],Ur.prototype,"writeAdjustAspectRatio",null),l([p({json:{write:!0}})],Ur.prototype,"bandIds",null),l([p({json:{write:!0}})],Ur.prototype,"compression",void 0),l([p({json:{write:!0}})],Ur.prototype,"compressionQuality",null),l([se("compressionQuality")],Ur.prototype,"writeCompressionQuality",null),l([p({json:{write:!0}})],Ur.prototype,"compressionTolerance",null),l([se("compressionTolerance")],Ur.prototype,"writeCompressionTolerance",null),l([p({json:{write:!0}})],Ur.prototype,"format",null),l([p({type:String,json:{read:{reader:bp.read},write:{writer:bp.write}}})],Ur.prototype,"interpolation",null),l([p({json:{write:!0}})],Ur.prototype,"noData",null),l([p({type:String,json:{read:{reader:G1.read},write:{writer:G1.write}}})],Ur.prototype,"noDataInterpretation",null),l([p({json:{write:!0}})],Ur.prototype,"pixelType",void 0),l([p({json:{write:!0}})],Ur.prototype,"lercVersion",void 0),l([se("lercVersion")],Ur.prototype,"writeLercVersion",null),l([p({type:Number})],Ur.prototype,"version",null),l([p({json:{write:!0}})],Ur.prototype,"mosaicRule",null),l([p({json:{write:!0,name:"renderingRule"}})],Ur.prototype,"rasterFunction",null),Ur=l([k("esri.layers.mixins.ExportImageServiceParameters")],Ur);var CR;const wIe={base:Ju,key:"type",typeMap:{extent:Ne,polygon:Ss}};let Qh=CR=class extends Q{constructor(e){super(e),this.areaOfInterest=null,this.subsetDefinitions=null}get dimensions(){const{subsetDefinitions:e}=this;if(e==null||e.length===0)return[];const t=new Map;e.forEach(i=>{if(!i.dimensionName)return;let n,s;if(Array.isArray(i.values[0])){const o=i.values;n=o[0][0],s=o[i.values.length-1][1]}else{const o=i.values;n=o[0],s=o[i.values.length-1]}if(t.has(i.dimensionName)){const o=t.get(i.dimensionName);o[0]=Math.min(n,o[0]),o[1]=Math.max(s,o[1])}else t.set(i.dimensionName,[n,s])});const r=[];for(const i of t)r.push({name:i[0],extent:i[1]});return r}get variables(){const{subsetDefinitions:e}=this;if(e==null||e.length===0)return[];const t=new Set;return e.forEach(r=>{r.variableName&&t.add(r.variableName)}),[...t]}clone(){var r;const e=(r=this.subsetDefinitions)==null?void 0:r.map(i=>i.clone()),t=this.areaOfInterest?this.areaOfInterest.clone():this.areaOfInterest;return new CR({areaOfInterest:t,subsetDefinitions:e})}};l([p({types:wIe,json:{read:Xr,write:!0}})],Qh.prototype,"areaOfInterest",void 0),l([p({readOnly:!0})],Qh.prototype,"dimensions",null),l([p({readOnly:!0})],Qh.prototype,"variables",null),l([p({type:[Nm],json:{write:!0}})],Qh.prototype,"subsetDefinitions",void 0),Qh=CR=l([k("esri.layers.support.MultidimensionalSubset")],Qh);const bIe=Qh;var OR;function mh(e){return e=Number(e),isNaN(e)?void 0:e}let ua=OR=class extends Q{constructor(){super(...arguments),this.name=null,this.minWavelength=void 0,this.maxWavelength=void 0,this.radianceBias=void 0,this.radianceGain=void 0,this.reflectanceBias=void 0,this.reflectanceGain=void 0,this.solarIrradiance=void 0}clone(){return new OR({name:this.name,minWavelength:this.minWavelength,maxWavelength:this.maxWavelength,radianceBias:this.radianceBias,radianceGain:this.radianceGain,reflectanceBias:this.reflectanceBias,reflectanceGain:this.reflectanceGain,solarIrradiance:this.solarIrradiance})}};l([p({json:{name:"BandName",write:!0}})],ua.prototype,"name",void 0),l([p({json:{name:"WavelengthMin",read:{reader:mh},write:!0}})],ua.prototype,"minWavelength",void 0),l([p({json:{name:"WavelengthMax",read:{reader:mh},write:!0}})],ua.prototype,"maxWavelength",void 0),l([p({json:{name:"RadianceBias",read:{reader:mh},write:!0}})],ua.prototype,"radianceBias",void 0),l([p({json:{name:"RadianceGain",read:{reader:mh},write:!0}})],ua.prototype,"radianceGain",void 0),l([p({json:{name:"ReflectanceBias",read:{reader:mh},write:!0}})],ua.prototype,"reflectanceBias",void 0),l([p({json:{name:"ReflectanceGain",read:{reader:mh},write:!0}})],ua.prototype,"reflectanceGain",void 0),l([p({json:{name:"SolarIrradiance",read:{reader:mh},write:!0}})],ua.prototype,"solarIrradiance",void 0),ua=OR=l([k("esri.layers.support.RasterBandInfo")],ua);const $j=ua;var PR;function eg(e){return e=Number(e),isNaN(e)?void 0:e}let Fs=PR=class extends Q{constructor(){super(...arguments),this.acquisitionDate=void 0,this.cloudCover=void 0,this.productName=void 0,this.sensorName=null,this.sensorAzimuth=void 0,this.sensorElevation=void 0,this.sunAzimuth=void 0,this.sunElevation=void 0}readAcquisitionDate(e){return new Date(e)}writeAcquisitionDate(e,t){t.AcquisitionDate=e.getTime()}clone(){return new PR({acquisitionDate:this.acquisitionDate,cloudCover:this.cloudCover,productName:this.productName,sensorName:this.sensorName,sensorAzimuth:this.sensorAzimuth,sensorElevation:this.sensorElevation,sunAzimuth:this.sunAzimuth,sunElevation:this.sunElevation})}};l([p({json:{name:"AcquisitionDate",write:!0}})],Fs.prototype,"acquisitionDate",void 0),l([te("acquisitionDate")],Fs.prototype,"readAcquisitionDate",null),l([se("acquisitionDate")],Fs.prototype,"writeAcquisitionDate",null),l([p({json:{name:"CloudCover",read:{reader:eg},write:!0}})],Fs.prototype,"cloudCover",void 0),l([p({json:{name:"ProductName",write:!0}})],Fs.prototype,"productName",void 0),l([p({json:{name:"SensorName",write:!0}})],Fs.prototype,"sensorName",void 0),l([p({json:{name:"SensorAzimuth",read:{reader:eg},write:!0}})],Fs.prototype,"sensorAzimuth",void 0),l([p({json:{name:"SensorElevation",read:{reader:eg},write:!0}})],Fs.prototype,"sensorElevation",void 0),l([p({json:{name:"SunAzimuth",read:{reader:eg},write:!0}})],Fs.prototype,"sunAzimuth",void 0),l([p({json:{name:"SunElevation",read:{reader:eg},write:!0}})],Fs.prototype,"sunElevation",void 0),Fs=PR=l([k("esri.layers.support.RasterSensorInfo")],Fs);const _Ie=Fs;var LR;let Hi=LR=class extends Q{constructor(){super(...arguments),this.blockWidth=void 0,this.blockHeight=void 0,this.compression=null,this.origin=null,this.firstPyramidLevel=null,this.maximumPyramidLevel=null,this.pyramidScalingFactor=2,this.pyramidBlockWidth=null,this.pyramidBlockHeight=null,this.isVirtualTileInfo=!1,this.tileInfo=null,this.transposeInfo=null,this.blockBoundary=null}clone(){return new LR({blockWidth:this.blockWidth,blockHeight:this.blockHeight,compression:this.compression,origin:B(this.origin),firstPyramidLevel:this.firstPyramidLevel,maximumPyramidLevel:this.maximumPyramidLevel,pyramidResolutions:B(this.pyramidResolutions),pyramidScalingFactor:this.pyramidScalingFactor,pyramidBlockWidth:this.pyramidBlockWidth,pyramidBlockHeight:this.pyramidBlockHeight,isVirtualTileInfo:this.isVirtualTileInfo,tileInfo:B(this.tileInfo),transposeInfo:B(this.transposeInfo),blockBoundary:B(this.blockBoundary)})}};l([p({type:Number,json:{write:!0}})],Hi.prototype,"blockWidth",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"blockHeight",void 0),l([p({type:String,json:{write:!0}})],Hi.prototype,"compression",void 0),l([p({type:Ae,json:{write:!0}})],Hi.prototype,"origin",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"firstPyramidLevel",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"maximumPyramidLevel",void 0),l([p({json:{write:!0}})],Hi.prototype,"pyramidResolutions",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"pyramidScalingFactor",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"pyramidBlockWidth",void 0),l([p({type:Number,json:{write:!0}})],Hi.prototype,"pyramidBlockHeight",void 0),l([p({type:Boolean,json:{write:!0}})],Hi.prototype,"isVirtualTileInfo",void 0),l([p({json:{write:!0}})],Hi.prototype,"tileInfo",void 0),l([p()],Hi.prototype,"transposeInfo",void 0),l([p()],Hi.prototype,"blockBoundary",void 0),Hi=LR=l([k("esri.layers.support.RasterStorageInfo")],Hi);const JZ=Hi;var kR;let tr=kR=class extends Q{constructor(e){super(e),this.attributeTable=null,this.bandCount=null,this.colormap=null,this.extent=null,this.format=void 0,this.height=null,this.width=null,this.histograms=null,this.keyProperties={},this.multidimensionalInfo=null,this.noDataValue=null,this.pixelSize=null,this.pixelType=null,this.isPseudoSpatialReference=!1,this.spatialReference=null,this.statistics=null,this.storageInfo=null,this.transform=null}get bandInfos(){const e=this.keyProperties.BandProperties,{bandCount:t}=this;if(!(e!=null&&e.length)||e.length<t){const i=[];for(let n=1;n<=t;n++)i.push(new $j({name:"band_"+n}));return i}const r=e.map(i=>$j.fromJSON(i));for(let i=0;i<r.length;i++)r[i].name=r[i].name||"band_"+(i+1);return r}get dataType(){var t,r;const e=((r=(t=this.keyProperties)==null?void 0:t.DataType)==null?void 0:r.toLowerCase())??"generic";return e==="stdtime"?"standard-time":e}get nativeExtent(){return this._get("nativeExtent")||this.extent}set nativeExtent(e){e&&this._set("nativeExtent",e)}get nativePixelSize(){if(this.transform==null||!this.transform.affectsPixelSize)return this.pixelSize;const e=this.nativeExtent;return{x:e.width/this.width,y:e.height/this.height}}get hasMultidimensionalTranspose(){var e;return!!((e=this.storageInfo)!=null&&e.transposeInfo)}get sensorInfo(){var e;if((e=this.keyProperties)!=null&&e.SensorName)return _Ie.fromJSON(this.keyProperties)}clone(){return new kR({attributeTable:B(this.attributeTable),bandCount:this.bandCount,colormap:B(this.colormap),extent:B(this.extent),nativePixelSize:B(this.nativePixelSize),format:this.format,height:this.height,width:this.width,histograms:B(this.histograms),keyProperties:B(this.keyProperties),multidimensionalInfo:B(this.multidimensionalInfo),noDataValue:this.noDataValue,pixelSize:B(this.pixelSize),pixelType:this.pixelType,isPseudoSpatialReference:this.isPseudoSpatialReference,spatialReference:B(this.spatialReference),statistics:B(this.statistics),storageInfo:B(this.storageInfo),transform:B(this.transform)})}};l([p({json:{write:!0}})],tr.prototype,"attributeTable",void 0),l([p({json:{write:!0}})],tr.prototype,"bandCount",void 0),l([p({readOnly:!0})],tr.prototype,"bandInfos",null),l([p({json:{write:!0}})],tr.prototype,"colormap",void 0),l([p({type:String,readOnly:!0})],tr.prototype,"dataType",null),l([p({type:Ne,json:{write:!0}})],tr.prototype,"extent",void 0),l([p({type:Ne,json:{write:!0}})],tr.prototype,"nativeExtent",null),l([p({json:{write:!0}})],tr.prototype,"nativePixelSize",null),l([p({json:{write:!0}})],tr.prototype,"format",void 0),l([p({json:{write:!0}})],tr.prototype,"height",void 0),l([p({json:{write:!0}})],tr.prototype,"width",void 0),l([p({json:{write:!0}})],tr.prototype,"hasMultidimensionalTranspose",null),l([p({json:{write:!0}})],tr.prototype,"histograms",void 0),l([p({json:{write:!0}})],tr.prototype,"keyProperties",void 0),l([p({json:{write:!0}})],tr.prototype,"multidimensionalInfo",void 0),l([p({json:{write:!0}})],tr.prototype,"noDataValue",void 0),l([p({json:{write:!0}})],tr.prototype,"pixelSize",void 0),l([p({json:{write:!0}})],tr.prototype,"pixelType",void 0),l([p()],tr.prototype,"isPseudoSpatialReference",void 0),l([p({readOnly:!0})],tr.prototype,"sensorInfo",null),l([p({type:xe,json:{write:!0}})],tr.prototype,"spatialReference",void 0),l([p({json:{write:!0}})],tr.prototype,"statistics",void 0),l([p({type:JZ,json:{write:!0}})],tr.prototype,"storageInfo",void 0),l([p({json:{write:!0}})],tr.prototype,"transform",void 0),tr=kR=l([k("esri.layers.support.RasterInfo")],tr);const GT=tr;let vx=class{constructor(t=r=>r.values().next().value){this._peeker=t,this._observable=new Vv,this._items=new Set}get length(){return Ge(this._observable),this._items.size}clear(){this.length!==0&&(this._items.clear(),this._observable.notify())}last(){if(this.length===0)return;let t;for(t of this._items);return t}peek(){if(this.length!==0)return this._peeker(this._items)}push(t){this.contains(t)||(this._items.add(t),this._observable.notify())}contains(t){return Ge(this._observable),this._items.has(t)}pop(){if(this.length===0)return;const t=this.peek();return this._items.delete(t),this._observable.notify(),t}popLast(){if(this.length===0)return;const t=this.last();return this._items.delete(t),this._observable.notify(),t}remove(t){this.contains(t)&&(this._items.delete(t),this._observable.notify())}filter(t){const r=this.length;return this._items.forEach(i=>{t(i)||this._items.delete(i)}),r!==this._items.size&&this._observable.notify(),this}*[Symbol.iterator](){Ge(this._observable),yield*this._items}};const ZZ=new FinalizationRegistry(e=>{e.close()});function SIe(e,t){ZZ.register(e,t,t)}function xIe(e){ZZ.unregister(e)}const YZ="worker:port-closed";var ji;(function(e){e[e.HANDSHAKE=0]="HANDSHAKE",e[e.OPEN=1]="OPEN",e[e.OPENED=2]="OPENED",e[e.RESPONSE=3]="RESPONSE",e[e.INVOKE=4]="INVOKE",e[e.ABORT=5]="ABORT",e[e.CLOSE=6]="CLOSE",e[e.OPEN_PORT=7]="OPEN_PORT",e[e.ON=8]="ON"})(ji||(ji={}));let TIe=0;function KZ(){return TIe++}function IIe(e){return e&&typeof e=="object"&&("result"in e||"transferList"in e)}function bv(e){return e?typeof e=="string"?JSON.stringify({name:"message",message:e}):e.toJSON?JSON.stringify(e):JSON.stringify({name:e.name,message:e.message,details:e.details||{stack:e.stack}}):null}function PP(e,t,r,i){if(t.type===ji.OPEN_PORT)return void e.postMessage(t,[t.port]);if(t.type!==ji.INVOKE&&t.type!==ji.RESPONSE)return void e.postMessage(t);let n;if(IIe(r)?(n=Ej(r.transferList),t.data=r.result):(n=Ej(i),t.data=r),n){if(Me("ff")){for(const s of n)if("byteLength"in s&&s.byteLength>267386880){const o="Worker call with large ArrayBuffer would crash Firefox";switch(t.type){case ji.INVOKE:throw o;case ji.RESPONSE:return void PP(e,{type:ji.RESPONSE,jobId:t.jobId,error:bv(o)})}}}e.postMessage(t,n)}else e.postMessage(t)}function _v(e){if(!e)return null;const t=e.data;return t?typeof t=="string"?JSON.parse(t):t:null}function Ej(e){if(!(e!=null&&e.length))return null;if(Me("esri-workers-arraybuffer-transfer"))return e;const t=e.filter(r=>!MIe(r));return t.length?t:null}function MIe(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)==null?void 0:t.name)==="ArrayBuffer"}async function $Ie(e){try{return await e}catch(t){const r=(t==null?void 0:t.name)===YZ;if(!(Ei(t)||r))throw t;return}}function XZ(e,t,r){return new Proxy({},{get:(i,n,s)=>(...o)=>{let a,u;const c=o[o.length-1];EIe(c)&&(a=c.signal,u=c.transferList,o.pop());const h=e.apply(t?`${t}.${n.toString()}`:n.toString(),o,{transferList:u,signal:a});return r!=null&&r.ignoreConnectionErrors?$Ie(h):h}})}function EIe(e){return typeof e=="object"&&!Array.isArray(e)&&e!=null&&("signal"in e||"transferList"in e||Object.keys(e).length===0)}const AIe={statsWorker:()=>ge(()=>import("./statsWorker-t12DKlSD.js"),__vite__mapDeps([59,60,61,1,2,62])),geometryEngineWorker:()=>ge(()=>import("./geometryEngineWorker-CeqyRjm2.js"),__vite__mapDeps([63,24,20,1,2,25])),CSVSourceWorker:()=>ge(()=>import("./CSVSourceWorker-BDcemc1A.js"),__vite__mapDeps([64,65,25,66,1,2,67,68,69,70,6,7,71,60,61,62,72,10,73])),EdgeProcessingWorker:()=>ge(()=>import("./EdgeProcessingWorker-CRpTw9C3.js"),__vite__mapDeps([74,75,38,76,45,77,42,41,1,2,49])),ElevationSamplerWorker:()=>ge(()=>import("./ElevationSamplerWorker-BJHgkcWr.js"),__vite__mapDeps([78,1,2,68,35,36,37,28,29,30,31,32,33,34,38])),FeatureServiceSnappingSourceWorker:()=>ge(()=>import("./FeatureServiceSnappingSourceWorker-DKuB2Q-Y.js"),__vite__mapDeps([79,1,2,66,67,68,69,25,70,6,7,71,60,61,62,72])),GeoJSONSourceWorker:()=>ge(()=>import("./GeoJSONSourceWorker-BMZf54CP.js"),__vite__mapDeps([80,66,1,2,67,68,69,25,70,6,7,71,60,61,62,72,81,65,73,82])),LercWorker:()=>ge(()=>import("./LercWorker-jtITdcrm.js"),__vite__mapDeps([83,1,2])),MemorySourceWorker:()=>ge(()=>import("./MemorySourceWorker-Dy4fcUCF.js"),__vite__mapDeps([84,85,66,1,2,67,68,69,25,70,6,7,71,60,61,62,72,73,82,65])),PBFDecoderWorker:()=>ge(()=>import("./PBFDecoderWorker-C8M1O-OO.js"),__vite__mapDeps([86,1,2])),FeaturePipelineWorker:()=>ge(()=>import("./FeaturePipelineWorker-BCLzSqX1.js"),__vite__mapDeps([87,1,2,88,89,90,91,92,93,40,94,95,45,96,97,7,69,25,98,99,70,6,71,60,61,62,72,100,81,65,73,82,101,102])),PointCloudWorker:()=>ge(()=>import("./PointCloudWorker-tZhDBN1E.js"),__vite__mapDeps([103,1,2,33,29,34,104,105,106,49,107,30,31,43])),RasterWorker:()=>ge(()=>import("./RasterWorker-B3Zh4kd5.js"),__vite__mapDeps([108,109,1,2,110])),SceneLayerSnappingSourceWorker:()=>ge(()=>import("./SceneLayerSnappingSourceWorker-hk4e4a5p.js"),__vite__mapDeps([111,1,2,47,46,43,29,30,34,112,45,77,42,41,75,38,76,49])),SceneLayerWorker:()=>ge(()=>import("./SceneLayerWorker-DOsJnpET.js"),__vite__mapDeps([113,1,2,32,36,37,112,46,43,29,30,34,114,31,106,49,115,107,33])),WFSSourceWorker:()=>ge(()=>import("./WFSSourceWorker-C4ivB2kg.js"),__vite__mapDeps([116,66,1,2,67,68,69,25,70,6,7,71,60,61,62,72,81,65,82,117])),WorkerTileHandler:()=>ge(()=>import("./WorkerTileHandler-B1-h0y2S.js"),__vite__mapDeps([118,94,119,93,1,2,120,40])),Lyr3DWorker:()=>ge(()=>import("./Lyr3DWorker-hft2iKT0.js"),__vite__mapDeps([121,1,2]))},{CLOSE:Aj,ABORT:Rj,INVOKE:Cj,RESPONSE:tg,OPEN_PORT:Oj,ON:RIe}=ji,CIe=2;let OIe=class{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===ji.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),this._timer===null&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}},Op=class my{static connect(t){const r=new MessageChannel;let i;i=typeof t=="function"?new t:"default"in t&&typeof t.default=="function"?new t.default:t;const n=new my(r.port1,{channel:r,client:i});return typeof i=="object"&&"remoteClient"in i&&(i.remoteClient=n),my.clients.set(n,i),r.port2}static loadWorker(t){const r=AIe[t];return r?r():Promise.resolve(null)}constructor(t,r,i){this._port=t,this._jobQueue=i,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new OIe(n=>this._onInvokeMessage(n)),this._client=r.client,this._onMessage=this._onMessage.bind(this),this._channel=r.channel,this._schedule=r.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}close(){this._post({type:Aj}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,r,i){return this.apply(t,[r],i)}apply(t,r,i){const n=i==null?void 0:i.signal,s=i==null?void 0:i.transferList;if(!this._port)return Promise.reject(new z(YZ,`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:r}));const o=KZ();return new Promise((a,u)=>{if(to(n))return this._processWork(),void u(Pr());const c=bs(n,()=>{const d=this._outJobs.get(o);d&&(this._outJobs.delete(o),this._processWork(),Tr(d.abortHandle),this._post({type:Rj,jobId:o}),u(Pr()))}),h={resolve:a,reject:u,abortHandle:c,debugInfo:t};this._outJobs.set(o,h),this._post({type:Cj,jobId:o,methodName:t,abortable:n!=null},r,s)})}createInvokeProxy(t,r){return XZ(this,t,r)}on(t,r){const i=new MessageChannel;function n(s){r(s.data)}return this._port.postMessage({type:ji.ON,eventType:t,port:i.port2},[i.port2]),i.port1.addEventListener("message",n),i.port1.start(),Xt(()=>{i.port1.postMessage({type:ji.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",n)})}jobAdded(){this._processWork()}openPort(){const t=new MessageChannel;return this._post({type:Oj,port:t.port2}),t.port1}_processWork(){var o;if(this._outJobs.size>=CIe)return;const t=(o=this._jobQueue)==null?void 0:o.pop();if(!t)return;const{methodName:r,data:i,invokeOptions:n,resolver:s}=t;this.apply(r,i,n).then(a=>s.resolve(a)).catch(a=>s.reject(a))}_close(){this._channel&&(this._channel=void 0),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach(t=>{Tr(t.abortHandle),t.reject(Pr(`Worker closing, aborting job calling '${t.debugInfo}'`))}),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=null,this._client=null,this._schedule=null}_onMessage(t){this._schedule!=null?this._schedule(()=>this._processMessage(t)):this._processMessage(t)}_processMessage(t){const r=_v(t);if(r)switch(r.type){case tg:this._onResponseMessage(r);break;case Cj:this._invokeQueue.push(r);break;case Rj:this._onAbortMessage(r);break;case Aj:this._onCloseMessage();break;case Oj:this._onOpenPortMessage(r);break;case RIe:this._onOnMessage(r)}}_onAbortMessage(t){const r=this._inJobs,i=t.jobId,n=r.get(i);this._invokeQueue.push(t),n&&(n.controller&&n.controller.abort(),r.delete(i))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&my.clients.get(this)===t&&t.destroy(),my.clients.delete(this),t!=null&&t.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:r,jobId:i,data:n=[],abortable:s}=t,o=s?new AbortController:null,a=this._inJobs;let u,c=this._client,h=c[r];try{if(!h&&r&&r.includes(".")){const d=r.split(".");for(let y=0;y<d.length-1;y++)c=c[d[y]],h=c[d[y+1]]}if(typeof h!="function")throw new TypeError(`${r} is not a function`);n.push({client:this,signal:o?o.signal:null}),u=h.apply(c,n)}catch(d){return void this._post({type:tg,jobId:i,error:bv(d)})}Dp(u)?(a.set(i,{controller:o,promise:u}),u.then(d=>{a.has(i)&&(a.delete(i),this._post({type:tg,jobId:i},d))},d=>{a.has(i)&&(a.delete(i),Ei(d)||this._post({type:tg,jobId:i,error:bv(d||{message:`Error encountered at method ${r}`})}))})):this._post({type:tg,jobId:i},u)}_onOpenPortMessage(t){new my(t.port,{client:this._client})}_onOnMessage(t){const{port:r}=t,i=this._client.on(t.eventType,s=>{r.postMessage(s)}),n=Dv(t.port,"message",s=>{const o=_v(s);(o==null?void 0:o.type)===ji.CLOSE&&(n.remove(),i.remove(),r.close())})}_onResponseMessage(t){const{jobId:r,error:i,data:n}=t,s=this._outJobs;if(!s.has(r))return;const o=s.get(r);s.delete(r),this._processWork(),Tr(o.abortHandle),i?o.reject(z.fromJSON(JSON.parse(i))):o.resolve(n)}_post(t,r,i){return PP(this._port,t,r,i)}};Op.kernelInfo={buildDate:gG,fullVersion:RO,revision:vG},Op.clients=new Map;let PIe=class{constructor(){this._inUseClients=new Array,this._clients=new Array,this._clientPromises=new Array,this._ongoingJobsQueue=new vx}destroy(){this.close()}get closed(){var t;return!((t=this._clients)!=null&&t.length)}open(t,r){return new Promise((i,n)=>{let s=!0;const o=a=>{Ut(r.signal),s&&(s=!1,a())};this._clients.length=t.length,this._clientPromises.length=t.length,this._inUseClients.length=t.length;for(let a=0;a<t.length;++a){const u=t[a];Dp(u)?this._clientPromises[a]=u.then(c=>(this._clients[a]=new Op(c,r,this._ongoingJobsQueue),o(i),this._clients[a]),()=>(o(n),null)):(this._clients[a]=new Op(u,r,this._ongoingJobsQueue),this._clientPromises[a]=Promise.resolve(this._clients[a]),o(i))}})}broadcast(t,r,i){const n=new Array(this._clientPromises.length);for(let s=0;s<this._clientPromises.length;++s){const o=this._clientPromises[s];n[s]=o.then(a=>a==null?void 0:a.invoke(t,r,i))}return n}close(){let t;for(;t=this._ongoingJobsQueue.pop();)t.resolver.reject(Pr(`Worker closing, aborting job calling '${t.methodName}'`));for(const r of this._clientPromises)r.then(i=>i==null?void 0:i.close());this._clients.length=0,this._clientPromises.length=0,this._inUseClients.length=0,xIe(this)}invoke(t,r,i){return this.apply(t,[r],i)}apply(t,r,i){const n=ro();this._ongoingJobsQueue.push({methodName:t,data:r,invokeOptions:i,resolver:n});for(let s=0;s<this._clientPromises.length;s++){const o=this._clients[s];o?o.jobAdded():this._clientPromises[s].then(a=>a==null?void 0:a.jobAdded())}return n.promise}createInvokeProxy(t){return XZ(this,t)}on(t,r){return Promise.all(this._clientPromises).then(()=>Lv(this._clients.map(i=>i.on(t,r))))}openPorts(){return new Promise(t=>{const r=new Array(this._clientPromises.length);let i=r.length;for(let n=0;n<this._clientPromises.length;++n)this._clientPromises[n].then(s=>{s&&(r[n]=s.openPort()),--i==0&&t(r)})})}get test(){return{numClients:this._clients.length}}};const LIe={async request(e,t){var o,a;const r=e.options,i=r.responseType;r.signal=t==null?void 0:t.signal,r.responseType=i==="native"||i==="native-request-init"?"native-request-init":i&&["blob","json","text"].includes(i)&&((o=pG(e.url))!=null&&o.after)?i:"array-buffer";const n=await be(e.url,r),s={data:n.data,httpStatus:n.httpStatus,ssl:n.ssl};switch((a=n.requestOptions)==null?void 0:a.responseType){case"native-request-init":return delete s.data.signal,s;case"blob":s.data=await s.data.arrayBuffer();break;case"json":s.data=new TextEncoder().encode(JSON.stringify(s.data)).buffer;break;case"text":s.data=new TextEncoder().encode(s.data).buffer}return{result:s,transferList:[s.data]}}},kIe={};function NIe(e){var r;const t={async:e.async,isDebug:e.isDebug,locale:e.locale,baseUrl:e.baseUrl,has:{...e.has},map:{...e.map},packages:((r=e.packages)==null?void 0:r.concat())||[],paths:{...e.paths}};return e.hasOwnProperty("async")||(t.async=!0),e.hasOwnProperty("isDebug")||(t.isDebug=!1),e.baseUrl||(t.baseUrl=kIe.baseUrl),t}let DIe=class{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach(r=>{this[r]=(...i)=>t[r](...i)})}},F2=class{constructor(){this._dispatcher=new DIe,this._workerPostMessage({type:ji.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){$S(()=>{this._workerMessageHandler(new MessageEvent("message",{data:t}))})}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,r,i){this._dispatcher.addEventListener(t,r,i)}removeEventListener(t,r,i){this._dispatcher.removeEventListener(t,r,i)}_workerPostMessage(t){$S(()=>{this.dispatchEvent(new MessageEvent("message",{data:t}))})}async _workerMessageHandler(t){const r=_v(t);if(r&&r.type===ji.OPEN){const{modulePath:i,jobId:n}=r;let s=await Op.loadWorker(i);s||(s=await import(i));const o=Op.connect(s);this._workerPostMessage({type:ji.OPENED,jobId:n,data:o})}}};const NR=()=>oe.getLogger("esri.core.workers.workerFactory"),{HANDSHAKE:FIe}=ji,jIe='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,s)=>{if(t){if(t.aborted)return s(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:ABORT,jobId:n}),s(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:s}),self.postMessage({type:INVOKE,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,fullVersion:r}=configuration.kernelInfo,{revision:t,fullVersion:n,version:s}=e.kernelInfo;esriConfig.assetsPath!==esriConfig.defaultAssetsPath&&o!==t&&console.warn(`Version mismatch detected between ArcGIS Maps SDK for JavaScript modules and assets. For more information visit https://bit.ly/3QnsuSo.\\nModules version: ${r}\\nAssets version: ${n??s}\\nAssets path: ${esriConfig.assetsPath}`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case OPEN:let n;function t(e){const o=n.connect(e);self.postMessage({type:OPENED,jobId:r,data:o},[o])}"function"==typeof define&&define.amd?require([workerPath],(e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((e=>(n=e.default,checkWorkerRevision(n),n.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):esriConfig.workers.useDynamicImport?import(workerPath).then((e=>{n=e.default||e,checkWorkerRevision(n),n.loadWorker(o.modulePath).then((e=>e||import(o.modulePath))).then(t)})):(self.RemoteClient||importScripts(workerPath),n=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(n),n.loadWorker(o.modulePath).then(t));break;case RESPONSE:if(outgoing.has(r)){const s=outgoing.get(r);outgoing.delete(r),o.error?s.reject(JSON.parse(o.error)):s.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});';let a_,l_;const Pj="Failed to create Worker. Fallback to execute module in main thread";async function UIe(){if(!Me("esri-workers"))return Lj(new F2);if(!a_&&!l_)try{const t=jIe.split('"{CONFIGURATION}"').join(`'${VIe()}'`);a_=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){l_=t||{}}let e;if(a_)try{e=new Worker(a_,{name:"esri-worker-"+GIe++})}catch{NR().warn(Pj,l_),e=new F2}else NR().warn(Pj,l_),e=new F2;return Lj(e)}async function Lj(e){return new Promise(t=>{function r(n){const s=_v(n);s&&s.type===FIe&&(e.removeEventListener("message",r),e.removeEventListener("error",i),t(e))}function i(n){n.preventDefault(),e.removeEventListener("message",r),e.removeEventListener("error",i),NR().warn("Failed to create Worker. Fallback to execute module in main thread",n),(e=new F2).addEventListener("message",r),e.addEventListener("error",i)}e.addEventListener("message",r),e.addEventListener("error",i)})}function VIe(){let e;if(Kt.default!=null){const n={...Kt};delete n.default,e=JSON.parse(JSON.stringify(n))}else e=JSON.parse(JSON.stringify(Kt));e.assetsPath=Js(e.assetsPath),e.defaultAssetsPath=e.defaultAssetsPath?Js(e.defaultAssetsPath):void 0,e.request.interceptors=[],e.log.interceptors=[],e.locale=Zs(),e.has={"esri-csp-restrictions":Me("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":Me("esri-2d-update-debug"),"esri-2d-log-updating":Me("esri-2d-log-updating"),"featurelayer-pbf":Me("featurelayer-pbf"),"featurelayer-fast-triangulation-enabled":Me("featurelayer-fast-triangulation-enabled"),"featurelayer-simplify-thresholds":Me("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":Me("featurelayer-simplify-payload-size-factors"),"featurelayer-simplify-mobile-factor":Me("featurelayer-simplify-mobile-factor"),"featurelayer-query-max-depth":Me("featurelayer-query-max-depth"),"featurelayer-query-pausing-enabled":Me("featurelayer-query-pausing-enabled"),"featurelayer-snapshot-enabled":Me("featurelayer-snapshot-enabled"),"esri-atomics":Me("esri-atomics"),"esri-shared-array-buffer":Me("esri-shared-array-buffer"),"esri-tiles-debug":Me("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":Me("esri-workers-arraybuffer-transfer"),"feature-polyline-generalization-factor":Me("feature-polyline-generalization-factor"),"host-webworker":1},e.workers.loaderUrl&&(e.workers.loaderUrl=Js(e.workers.loaderUrl)),e.workers.workerPath?e.workers.workerPath=Js(e.workers.workerPath):e.workers.workerPath=Js(Rt("esri/core/workers/RemoteClient.js")),e.workers.useDynamicImport=!1;const t=Kt.workers.loaderConfig,r=NIe({baseUrl:t==null?void 0:t.baseUrl,locale:Zs(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...t==null?void 0:t.has},map:{...t==null?void 0:t.map},paths:{...t==null?void 0:t.paths},packages:(t==null?void 0:t.packages)||[]});return JSON.stringify({esriConfig:e,loaderConfig:r,kernelInfo:{buildDate:gG,fullVersion:RO,revision:vG}})}let GIe=0;const{ABORT:kj,INVOKE:BIe,OPEN:zIe,OPENED:qIe,RESPONSE:rg}=ji;let HIe=class QZ{static async create(t){const r=await UIe();return new QZ(r,t)}constructor(t,r){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=r,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",i=>{i.preventDefault(),oe.getLogger("esri.core.workers.WorkerOwner").error(i)})}terminate(){this.worker.terminate()}async open(t,r={}){const{signal:i}=r,n=KZ();return new Promise((s,o)=>{const a={resolve:s,reject:o,abortHandle:vO(i,()=>{this._outJobs.delete(n),this._post({type:kj,jobId:n})})};this._outJobs.set(n,a),this._post({type:zIe,jobId:n,modulePath:t})})}_onMessage(t){const r=_v(t);if(r)switch(r.type){case qIe:this._onOpenedMessage(r);break;case rg:this._onResponseMessage(r);break;case kj:this._onAbortMessage(r);break;case BIe:this._onInvokeMessage(r)}}_onAbortMessage(t){const r=this._inJobs,i=t.jobId,n=r.get(i);n&&(n.controller&&n.controller.abort(),r.delete(i))}_onInvokeMessage(t){const{methodName:r,jobId:i,data:n,abortable:s}=t,o=s?new AbortController:null,a=this._inJobs,u=LIe[r];let c;try{if(typeof u!="function")throw new TypeError(`${r} is not a function`);c=u.call(null,n,{signal:o?o.signal:null})}catch(h){return void this._post({type:rg,jobId:i,error:bv(h)})}Dp(c)?(a.set(i,{controller:o,promise:c}),c.then(h=>{a.has(i)&&(a.delete(i),this._post({type:rg,jobId:i},h))},h=>{a.has(i)&&(a.delete(i),h||(h={message:"Error encountered at method"+r}),Ei(h)||this._post({type:rg,jobId:i,error:bv(h||{message:`Error encountered at method ${r}`})}))})):this._post({type:rg,jobId:i},c)}_onOpenedMessage(t){const{jobId:r,data:i}=t,n=this._outJobs.get(r);n&&(this._outJobs.delete(r),Tr(n.abortHandle),n.resolve(i))}_onResponseMessage(t){const{jobId:r,error:i,data:n}=t,s=this._outJobs.get(r);s&&(this._outJobs.delete(r),Tr(s.abortHandle),i?s.reject(z.fromJSON(JSON.parse(i))):s.resolve(n))}_post(t,r,i){return PP(this.worker,t,r,i)}};const Nj=Me("host-browser")?Math.min(navigator.hardwareConcurrency-1,Me("workers-pool-size")):0;let Fd=Me("esri-mobile")?Math.min(Nj,3):Nj;Fd||(Fd=Me("safari")&&Me("mac")?7:2);let Dj=0;const j2=[];function WIe(){tY()}async function u_(e,t){const r=new PIe,{registryTarget:i,...n}=t;return await r.open(e,n),i&&SIe(i,r),r}async function eY(e,t={}){if(typeof e!="string")throw new z("workers:undefined-module","modulePath is missing");let r=t.strategy||"distributed";if(Me("host-webworker")&&!Me("esri-workers")&&(r="local"),r==="local"){let i=await Op.loadWorker(e);i||(i=await import(e)),Ut(t.signal);const n=t.client||i;return u_([Op.connect(i)],{...t,client:n})}if(await tY(),Ut(t.signal),r==="dedicated"){const i=Dj++%Fd;return u_([await j2[i].open(e,t)],t)}if(t.maxNumWorkers&&t.maxNumWorkers>0){const i=Math.min(t.maxNumWorkers,Fd);if(i<Fd){const n=new Array(i);for(let s=0;s<i;++s){const o=Dj++%Fd;n[s]=j2[o].open(e,t)}return u_(n,t)}}return u_(j2.map(i=>i.open(e,t)),t)}let c_=null;async function tY(){if(c_)return c_;new AbortController;const e=[];for(let t=0;t<Fd;t++){const r=HIe.create(t).then(i=>(j2[t]=i,i));e.push(r)}return c_=Promise.all(e),c_}let JIe=class{constructor(){this._workerThread=null,this._destroyed=!1}async initialize(){const t=await eY("RasterWorker");this._destroyed?t.close():this._workerThread=t}destroy(){this._destroyed=!0,this._workerThread&&(this._workerThread.close(),this._workerThread=null)}async convertVectorFieldData(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i=await this._workerThread.invoke("convertVectorFieldData",{pixelBlock:t.pixelBlock.toJSON(),type:t.dataType},r);return i?new Ye(i):null}computeStatisticsHistograms(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");return this._workerThread.invoke("computeStatisticsHistograms",{pixelBlock:t.pixelBlock.toJSON()},r)}async decode(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i=await this._workerThread.invoke("decode",t,r);return i?new Ye(i):null}async symbolize(t,r){var s,o;if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i={extent:(s=t.extent)==null?void 0:s.toJSON(),pixelBlock:(o=t.pixelBlock)==null?void 0:o.toJSON(),simpleStretchParams:t.simpleStretchParams,bandIds:t.bandIds},n=await this._workerThread.invoke("symbolize",i,r);return n?new Ye(n):null}async updateSymbolizer(t,r){var n;if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i=(n=t==null?void 0:t.rendererJSON)==null?void 0:n.histograms;await Promise.all(this._workerThread.broadcast("updateSymbolizer",{symbolizerJSON:t.toJSON(),histograms:i},r))}async updateRasterFunction(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");await Promise.all(this._workerThread.broadcast("updateRasterFunction",{rasterFunctionJSON:t.toJSON()},r))}async process(t,r){var n,s;if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i=await this._workerThread.invoke("process",{extent:(n=t.extent)==null?void 0:n.toJSON(),primaryPixelSizes:(s=t.primaryPixelSizes)==null?void 0:s.map(o=>o!=null?o.toJSON():null),primaryPixelBlocks:t.primaryPixelBlocks.map(o=>o!=null?o.toJSON():null),primaryRasterIds:t.primaryRasterIds},r);return i?new Ye(i):null}async stretch(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");if(!(t!=null&&t.pixelBlock))return null;const i={srcPixelBlock:t.pixelBlock.toJSON(),stretchParams:t.stretchParams},n=await this._workerThread.invoke("stretch",i,r);return n?new Ye(n):null}async split(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");if(!(t!=null&&t.pixelBlock))return null;const i={srcPixelBlock:t.pixelBlock.toJSON(),tileSize:t.tileSize,maximumPyramidLevel:t.maximumPyramidLevel,useBilinear:t.useBilinear},n=await this._workerThread.invoke("split",i,r);return n&&n.forEach((s,o)=>{n.set(o,s?Ye.fromJSON(s):null)}),n}async clipTile(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");if(!(t!=null&&t.pixelBlock))return null;const i={...t,pixelBlock:t.pixelBlock.toJSON()},n=await this._workerThread.invoke("clipTile",i,r);return n?Ye.fromJSON(n):null}async estimateStatisticsHistograms(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");if(!(t!=null&&t.pixelBlock))return null;const i={srcPixelBlock:t.pixelBlock.toJSON()};return await this._workerThread.invoke("estimateStatisticsHistograms",i,r)}async mosaicAndTransform(t,r){var s;if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");if(!((s=t==null?void 0:t.srcPixelBlocks)!=null&&s.length))return{pixelBlock:null};const i={...t,srcPixelBlocks:t.srcPixelBlocks.map(o=>o!=null?o.toJSON():null)},n=await this._workerThread.invoke("mosaicAndTransform",i,r);return{pixelBlock:n.pixelBlock?new Ye(n.pixelBlock):null,localNorthDirections:n.localNorthDirections}}async createFlowMesh(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i={buffer:t.flowData.data.buffer,maskBuffer:t.flowData.mask.buffer,width:t.flowData.width,height:t.flowData.height},{meshType:n,simulationSettings:s}=t,o=await this._workerThread.invoke("createFlowMesh",{meshType:n,flowData:i,simulationSettings:s},{...r,transferList:[i.buffer,i.maskBuffer]});return{vertexData:new Float32Array(o.vertexBuffer),indexData:new Uint32Array(o.indexBuffer)}}getProjectionOffsetGrid(t,r){if(!this._workerThread)throw new z("raster-jobhandler:no-connection","no available worker connection");const i=t.datumTransformation!=null?t.datumTransformation.steps.map(o=>({wkid:o.wkid,wkt:o.wkt,isInverse:o.isInverse})):null,n=t.rasterTransform!=null?t.rasterTransform.toJSON():null,s={projectedExtent:t.projectedExtent.toJSON(),srcBufferExtent:t.srcBufferExtent.toJSON(),pixelSize:t.pixelSize,hasWrapAround:t.hasWrapAround,spacing:t.spacing,datumTransformationSteps:i,rasterTransform:n,isAdaptive:t.isAdaptive,includeGCSGrid:t.includeGCSGrid};return this._workerThread.invoke("getProjectionOffsetGrid",s,r)}};function rY(e,t,r){var s;const i=t.shift();if(r.length===0){const o=[];r.push({sliceId:-1,multidimensionalDefinition:o})}const n=r.length;for(let o=0;o<n;o++){const a=r.shift().multidimensionalDefinition;(s=i.values)==null||s.forEach(u=>{r.push({sliceId:-1,multidimensionalDefinition:[...a,{variableName:e,dimensionName:i.name,values:[u]}]})})}t.length&&rY(e,t,r)}function d7e(e,t){const r=[];let i=0;return(t?e.variables.filter(n=>n.name.toLowerCase()===t.toLowerCase()):[...e.variables].sort((n,s)=>n.name>s.name?1:-1)).forEach(n=>{const s=[],o=[...n.dimensions].sort((a,u)=>a.name>u.name?-1:1);rY(n.name,o,s),s.forEach(a=>{r.push({...a,sliceId:i++})})}),r}function f7e(e,t,r){let i=e;if(t&&(t=[...t].sort((n,s)=>n.dimensionName<s.dimensionName?-1:1)).forEach(({dimensionName:n,values:s,isSlice:o})=>{s.length&&(i=i.filter(a=>{const u=a.multidimensionalDefinition.find(h=>h.dimensionName===n);if(u==null)return!1;const c=u.values[0];return typeof c=="number"?typeof s[0]=="number"?s.includes(c):s.some(h=>h[0]<=c&&h[1]>=c):typeof s[0]=="number"?s.some(h=>c[0]<=h&&c[1]>=h):o?s.some(h=>h[0]===c[0]&&h[0]===c[1]):s.some(h=>h[0]>=c[0]&&h[0]<=c[1]||h[1]>=c[0]&&h[1]<=c[1]||h[0]<c[0]&&h[1]>c[1])}))}),i.length&&(r==null?void 0:r.start)!=null&&r.end!=null){const n=r.start.getTime(),s=r.end.getTime(),o=i[0].multidimensionalDefinition.findIndex(a=>a.dimensionName==="StdTime");o>-1&&(i=i.filter(a=>{const u=a.multidimensionalDefinition[o].values[0];return n<=u&&s>=u}))}return i.map(n=>n.sliceId)}function iY(e,t){return Array.isArray(e)?t[0]===t[1]?e[0]===t[0]||e[1]===t[0]:e[0]>=t[0]&&e[0]<=t[1]&&e[1]>=t[0]&&e[1]<=t[1]:e>=t[0]&&e<=t[1]}function ZIe(e,t){return e[0]<=t[0]&&e[1]>=t[0]||e[0]<=t[1]&&e[1]>=t[1]||e[0]>=t[0]&&e[1]<=t[1]}function nY(e){return e.length===1?[e[0],e[0]]:[e[0],e[e.length-1]]}function sY(e,t,r){var o,a;if(!((o=t==null?void 0:t.subsetDefinitions)!=null&&o.length))return e;let i;if(r){const{variables:u}=t;if(u.length&&!u.includes(r))return null;const c=t.subsetDefinitions.find(h=>h.dimensionName===e.name&&h.variableName===r);if(!((a=c==null?void 0:c.values)!=null&&a.length))return e;i=nY(c.values)}else{const u=t.dimensions.find(({name:c})=>c===e.name);i=u==null?void 0:u.extent}const n=i;if(!(n!=null&&n.length))return e;const s=e.values.filter(u=>iY(u,n));return{...e,extent:[...n],values:s}}function oY(e,t,r){var n;if(!((n=t==null?void 0:t.subsetDefinitions)!=null&&n.length))return!1;const{variables:i}=t;if(i.length&&e.some(({variableName:s})=>s&&!i.includes(s)))return!0;for(let s=0;s<e.length;s++){const o=e[s],a=t.subsetDefinitions.find(u=>(o.variableName===""||u.variableName===o.variableName)&&u.dimensionName===o.dimensionName);if(a!=null&&a.values.length){const u=nY(a.values);if(!o.isSlice&&o.values.length===2&&!Array.isArray(o.values[0])&&o.values[0]!==o.values[1]&&r){if(!ZIe(o.values,u))return!0}else if(o.values.some(c=>!iY(c,u)))return!0}}return!1}function OM(e,t){if(e==null)return{isOutside:!1};const{geometry:r,timeExtent:i,multidimensionalDefinition:n}=t;let s=null;if(i!=null&&(s=YIe(e,i),s==null))return{isOutside:!0};const{areaOfInterest:o}=e;if(o&&r){const a=r.type==="point"?r:r.type==="extent"?r.center:r.type==="polygon"?r.centroid:null;if(a&&!o.contains(a))return{isOutside:!0}}return n!=null&&n.length&&oY(n,e,!0)?{isOutside:!0}:{isOutside:!1,intersection:{geometry:r,timeExtent:s,multidimensionalDefinition:n}}}function YIe(e,t){const r=e.dimensions.find(({name:o})=>o==="StdTime");if(r==null||t.start==null&&t.end==null)return t;t=t.clone();const{start:i,end:n}=t.toJSON(),s=i===n?[i]:i!=null&&n!=null?[i,n]:[i??n];return s.length===2&&(r!=null&&r.extent.length)&&(s[0]=Math.max(s[0],r.extent[0]),s[1]=Math.min(s[1],r.extent[1]??r.extent[0]),s[1]<s[0])||oY([new Nm({variableName:"",dimensionName:"StdTime",isSlice:s.length===1,values:s})],e,!0)?null:(t.start=new Date(s[0]),t.end=new Date(s[1]??s[0]),t)}function KIe(e,t={}){var h,d;const{multidimensionalInfo:r,keyProperties:i}=e;if(r==null)return null;const{variableName:n,multidimensionalSubset:s,multidimensionalDefinition:o}=t,a=o!=null?(h=o[0])==null?void 0:h.variableName:null,u=n||a||(i==null?void 0:i.DefaultVariable);let{variables:c}=r;return(d=s==null?void 0:s.variables)!=null&&d.length&&(c=c.filter(({name:y})=>s.variables.includes(y))),u?c.find(({name:y})=>y===u)??c[0]:c[0]}function XIe(e,t={}){const r=KIe(e,t);if(!r)return null;const i=[],{dimensions:n,name:s}=r;if(n.length===0)return[new Nm({variableName:s,dimensionName:"",values:[],isSlice:!0})];for(let o=0;o<n.length;o++){const a=sY(n[o],t.multidimensionalSubset,s);if(!a)return null;const{values:u,extent:c}=a;let h=(u==null?void 0:u[0])??c[0];a.name.toLowerCase()==="stdz"&&!a.hasRanges&&Math.abs(c[1])<=Math.abs(c[0])&&(h=u!=null&&u.length?u[u.length-1]:c[1]),i.push(new Nm({variableName:s,dimensionName:a.name,values:[h],isSlice:!t.useRangeForRangedDimensionInfo||!!a.hasRanges}))}return i}function y7e(e){return!!(e!=null&&e.length)&&e.some(t=>{if(t.values==null)return!0;const r=t.values.length;return r===0||r>1||!t.isSlice&&Array.isArray(t.values[0])})}function QIe(e,t){var i;if(t==null||e==null)return null;let r=t.variables.map(n=>({...n}));return(i=e==null?void 0:e.variables)!=null&&i.length&&(r=r.filter(({name:n})=>e.variables.includes(n)),r.forEach(n=>{n.dimensions=n.dimensions.map(s=>sY(s,e,n.name)).filter(Qn)})),r}function e3e(e,t){var a;const{values:r}=t;if(r!=null&&r.length){const u=Array.isArray(r[0]),c=Array.isArray(e);return u!==c?-1:u&&c?r.findIndex(h=>h[0]===e[0]&&h[1]===e[1]):r.indexOf(e)}const{extent:i}=t;if(Array.isArray(e)||e<i[0]||e>i[1])return-1;const n=t.interval||1;if(t.unit!=="ISO8601")return Math.round((e-i[0])/n);const s=i[0];let o=-1;switch(((a=t.intervalUnit)==null?void 0:a.toLowerCase())||"seconds"){case"seconds":o=Math.round((e-s)/1e3/n);break;case"minutes":o=Math.round((e-s)/6e4/n);break;case"hours":o=Math.round((e-s)/36e5/n);break;case"days":o=Math.round((e-s)/864e5/n);break;case"months":{const u=new Date(e).getUTCFullYear()-new Date(s).getUTCFullYear(),c=new Date(s).getUTCMonth(),h=new Date(e).getUTCMonth();o=u===0?h-c:h+11-c+12*(u-1)}break;case"years":o=Math.round((new Date(e).getUTCFullYear()-new Date(s).getUTCFullYear())/n);break;case"decades":o=Math.round((new Date(e).getUTCFullYear()-new Date(s).getUTCFullYear())/10/n)}return o}function Fj(e){var o,a;let t=(o=e.values)==null?void 0:o.length;if(t)return t;const{extent:r,unit:i}=e,n=e.interval||1,s=r?r[1]-r[0]:0;if(i!=="ISO8601")return Math.round(s/n);switch(((a=e.intervalUnit)==null?void 0:a.toLowerCase())??"seconds"){case"seconds":t=Math.round(s/1e3/n);break;case"minutes":t=Math.round(s/6e4/n);break;case"hours":t=Math.round(s/36e5/n);break;case"days":t=Math.round(s/864e5/n);break;case"months":{const u=new Date(r[1]).getUTCFullYear()-new Date(r[0]).getUTCFullYear(),c=new Date(r[0]).getUTCMonth(),h=new Date(r[1]).getUTCMonth();t=u===0?h-c+1:h+11-c+12*(u-1)+1}break;case"years":t=Math.round((new Date(r[1]).getUTCFullYear()-new Date(r[0]).getUTCFullYear())/n);break;case"decades":t=Math.round((new Date(r[1]).getUTCFullYear()-new Date(r[0]).getUTCFullYear())/10/n);break;default:t=0}return t}function m7e(e,t){let r=0;const i=e[0].variableName,n=[...t.variables].sort((s,o)=>s.name>o.name?1:-1);for(let s=0;s<n.length;s++){const o=n[s],a=[...o.dimensions].sort((h,d)=>h.name>d.name?-1:1);if(o.name!==i){r+=a.map(h=>Fj(h)).reduce((h,d)=>h*d);continue}const u=a.map(h=>Fj(h)),c=a.length;for(let h=0;h<c;h++){const d=e.find(v=>v.dimensionName===a[h].name);if(d==null)return null;const y=e3e(d.values[0],a[h]);if(y===-1)return null;u.shift(),r+=h===c-1?y:y*u.reduce((v,w)=>v*w)}break}return r}var PM,jj,Uj,aY={exports:{}};jj=aY,PM=function(){function e(){this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=null}return e.prototype={ensureBuffer:function(t){var r=this.buffer,i=r?r.byteLength:0;if(t<i)return r;for(var n=512;n<t;)n<<=1;for(var s=new Uint8Array(n),o=0;o<i;++o)s[o]=r[o];return this.buffer=s},getByte:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return this.buffer[this.pos++]},getBytes:function(t){var r=this.pos;if(t){this.ensureBuffer(r+t);for(var i=r+t;!this.eof&&this.bufferLength<i;)this.readBlock();var n=this.bufferLength;i>n&&(i=n)}else{for(;!this.eof;)this.readBlock();i=this.bufferLength}return this.pos=i,this.buffer.subarray(r,i)},lookChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos])},getChar:function(){for(var t=this.pos;this.bufferLength<=t;){if(this.eof)return null;this.readBlock()}return String.fromCharCode(this.buffer[this.pos++])},makeSubStream:function(t,r,i){for(var n=t+r;this.bufferLength<=n&&!this.eof;)this.readBlock();return new Stream(this.buffer,t,r,i)},skip:function(t){t||(t=1),this.pos+=t},reset:function(){this.pos=0}},e}(),(Uj=function(){if(!self||!self.Uint32Array)return null;var e=new Uint32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),t=new Uint32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Uint32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Uint32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],n=[new Uint32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function s(a){throw new Error(a)}function o(a){var u=0,c=a[u++],h=a[u++];c!=-1&&h!=-1||s("Invalid header in flate stream"),(15&c)!=8&&s("Unknown compression method in flate stream"),((c<<8)+h)%31!=0&&s("Bad FCHECK in flate stream"),32&h&&s("FDICT bit set in flate stream"),this.bytes=a,this.bytesPos=u,this.codeSize=0,this.codeBuf=0,PM.call(this)}return o.prototype=Object.create(PM.prototype),o.prototype.getBits=function(a){for(var u,c=this.codeSize,h=this.codeBuf,d=this.bytes,y=this.bytesPos;c<a;)(u=d[y++])===void 0&&s("Bad encoding in flate stream"),h|=u<<c,c+=8;return u=h&(1<<a)-1,this.codeBuf=h>>a,this.codeSize=c-=a,this.bytesPos=y,u},o.prototype.getCode=function(a){for(var u=a[0],c=a[1],h=this.codeSize,d=this.codeBuf,y=this.bytes,v=this.bytesPos;h<c;){var w;(w=y[v++])===void 0&&s("Bad encoding in flate stream"),d|=w<<h,h+=8}var b=u[d&(1<<c)-1],_=b>>16,x=65535&b;return(h==0||h<_||_==0)&&s("Bad encoding in flate stream"),this.codeBuf=d>>_,this.codeSize=h-_,this.bytesPos=v,x},o.prototype.generateHuffmanTable=function(a){for(var u=a.length,c=0,h=0;h<u;++h)a[h]>c&&(c=a[h]);for(var d=1<<c,y=new Uint32Array(d),v=1,w=0,b=2;v<=c;++v,w<<=1,b<<=1)for(var _=0;_<u;++_)if(a[_]==v){var x=0,T=w;for(h=0;h<v;++h)x=x<<1|1&T,T>>=1;for(h=x;h<d;h+=b)y[h]=v<<16|_;++w}return[y,c]},o.prototype.readBlock=function(){function a(de,fe,Se,Ee,Fe){for(var ht=de.getBits(Se)+Ee;ht-- >0;)fe[b++]=Fe}var u=this.getBits(3);if(1&u&&(this.eof=!0),(u>>=1)!=0){var c,h;if(u==1)c=i,h=n;else if(u==2){for(var d=this.getBits(5)+257,y=this.getBits(5)+1,v=this.getBits(4)+4,w=Array(e.length),b=0;b<v;)w[e[b++]]=this.getBits(3);for(var _=this.generateHuffmanTable(w),x=0,T=(b=0,d+y),I=new Array(T);b<T;){var M=this.getCode(_);M==16?a(this,I,2,3,x):M==17?a(this,I,3,3,x=0):M==18?a(this,I,7,11,x=0):I[b++]=x=M}c=this.generateHuffmanTable(I.slice(0,d)),h=this.generateHuffmanTable(I.slice(d,T))}else s("Unknown block type in flate stream");for(var $=(re=this.buffer)?re.length:0,A=this.bufferLength;;){var R=this.getCode(c);if(R<256)A+1>=$&&($=(re=this.ensureBuffer(A+1)).length),re[A++]=R;else{if(R==256)return void(this.bufferLength=A);var L=(R=t[R-=257])>>16;L>0&&(L=this.getBits(L)),x=(65535&R)+L,R=this.getCode(h),(L=(R=r[R])>>16)>0&&(L=this.getBits(L));var C=(65535&R)+L;A+x>=$&&($=(re=this.ensureBuffer(A+x)).length);for(var U=0;U<x;++U,++A)re[A]=re[A-C]}}}else{var F,j=this.bytes,q=this.bytesPos;(F=j[q++])===void 0&&s("Bad block header in flate stream");var K=F;(F=j[q++])===void 0&&s("Bad block header in flate stream"),K|=F<<8,(F=j[q++])===void 0&&s("Bad block header in flate stream");var X=F;(F=j[q++])===void 0&&s("Bad block header in flate stream"),(X|=F<<8)!=(65535&~K)&&s("Bad uncompressed block length in flate stream"),this.codeBuf=0,this.codeSize=0;var ne=this.bufferLength,re=this.ensureBuffer(ne+K),ae=ne+K;this.bufferLength=ae;for(var he=ne;he<ae;++he){if((F=j[q++])===void 0){this.eof=!0;break}re[he]=F}this.bytesPos=q}},o}())!==void 0&&(jj.exports=Uj);const dw=C4(aY.exports);let t3e=class lY{constructor(t){this._canvas=null,this._ctx=null,t&&(this._canvas=t.canvas,this._ctx=t.ctx||t.canvas&&t.canvas.getContext("2d"))}decode(t,r,i){if(!t||t.byteLength<10)throw new z("imagecanvasdecoder: decode","required a valid encoded data as input.");let{width:n=0,height:s=0,format:o}=r;const{applyJpegMask:a}=r;if(a&&(!n||!s))throw new z("imagecanvasdecoder: decode","image width and height are needed to apply jpeg mask directly to canvas");return new Promise((u,c)=>{let h=null;o==="jpg"&&a&&(h=lY._getMask(t,{width:n,height:s}));const d=new Blob([new Uint8Array(t)],{type:"image/"+o=="jpg"?"jpeg":o}),y=URL.createObjectURL(d),v=new Image;let w;v.src=y,v.onload=()=>{if(URL.revokeObjectURL(y),to(i))return void c(Pr());n=v.width,s=v.height,this._canvas&&this._ctx?(this._canvas.width===n&&this._canvas.height===s||(this._canvas.width=n,this._canvas.height=s),this._ctx.clearRect(0,0,n,s)):(this._canvas=document.createElement("canvas"),this._canvas.width=n,this._canvas.height=s,this._ctx=this._canvas.getContext("2d")),this._ctx.drawImage(v,0,0);const b=this._ctx.getImageData(0,0,n,s);let _;if(w=b.data,r.renderOnCanvas){if(h)for(_=0;_<h.length;_++)h[_]?w[4*_+3]=255:w[4*_+3]=0;return this._ctx.putImageData(b,0,0),void u(null)}const x=n*s,T=new Uint8Array(x),I=new Uint8Array(x),M=new Uint8Array(x);if(h)for(_=0;_<x;_++)T[_]=w[4*_],I[_]=w[4*_+1],M[_]=w[4*_+2];else for(h=new Uint8Array(x),_=0;_<x;_++)T[_]=w[4*_],I[_]=w[4*_+1],M[_]=w[4*_+2],h[_]=w[4*_+3];u({width:n,height:s,pixels:[T,I,M],mask:h,pixelType:"u8"})},v.onerror=()=>{URL.revokeObjectURL(y),c("cannot load image")}})}static _getMask(t,r){let i=null;try{const n=new Uint8Array(t),s=Math.ceil(n.length/2);let o=0;const a=n.length-2;for(o=s;o<a&&(n[o]!==255||n[o+1]!==217);o++);if(o+=2,o<n.length-1){const u=new dw(n.subarray(o)).getBytes();i=new Uint8Array(r.width*r.height);let c=0;for(let h=0;h<u.length;h++)for(let d=7;d>=0;d--)i[c++]=u[h]>>d&1}}catch{}return i}};var Vj,Gj,Bj,uY={exports:{}};Vj=uY,Gj=function(){var e=function(){function t(r){this.message="JPEG error: "+r}return t.prototype=new Error,t.prototype.name="JpegError",t.constructor=t,t}();return function(){if(!self||!self.Uint8ClampedArray)return null;var t=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),r=4017,i=799,n=3406,s=2276,o=1567,a=3784,u=5793,c=2896;function h(){this.decodeTransform=null,this.colorTransform=-1}function d(x,T){for(var I,M,$=0,A=[],R=16;R>0&&!x[R-1];)R--;A.push({children:[],index:0});var L,C=A[0];for(I=0;I<R;I++){for(M=0;M<x[I];M++){for((C=A.pop()).children[C.index]=T[$];C.index>0;)C=A.pop();for(C.index++,A.push(C);A.length<=I;)A.push(L={children:[],index:0}),C.children[C.index]=L.children,C=L;$++}I+1<R&&(A.push(L={children:[],index:0}),C.children[C.index]=L.children,C=L)}return A[0].children}function y(x,T,I){return 64*((x.blocksPerLine+1)*T+I)}function v(x,T,I,M,$,A,R,L,C){var U=I.mcusPerLine,F=I.progressive,j=T,q=0,K=0;function X(){if(K>0)return K--,q>>K&1;if((q=x[T++])===255){var Re=x[T++];if(Re)throw new e("unexpected marker "+(q<<8|Re).toString(16))}return K=7,q>>>7}function ne(Re){for(var ot=Re;;){if(typeof(ot=ot[X()])=="number")return ot;if(typeof ot!="object")throw new e("invalid huffman sequence")}}function re(Re){for(var ot=0;Re>0;)ot=ot<<1|X(),Re--;return ot}function ae(Re){if(Re===1)return X()===1?1:-1;var ot=re(Re);return ot>=1<<Re-1?ot:ot+(-1<<Re)+1}function he(Re,ot){var bt=ne(Re.huffmanTableDC),Dr=bt===0?0:ae(bt);Re.blockData[ot]=Re.pred+=Dr;for(var Vt=1;Vt<64;){var ti=ne(Re.huffmanTableAC),Mr=15&ti,ri=ti>>4;if(Mr!==0){var eh=t[Vt+=ri];Re.blockData[ot+eh]=ae(Mr),Vt++}else{if(ri<15)break;Vt+=16}}}function de(Re,ot){var bt=ne(Re.huffmanTableDC),Dr=bt===0?0:ae(bt)<<C;Re.blockData[ot]=Re.pred+=Dr}function fe(Re,ot){Re.blockData[ot]|=X()<<C}var Se=0;function Ee(Re,ot){if(Se>0)Se--;else for(var bt=A,Dr=R;bt<=Dr;){var Vt=ne(Re.huffmanTableAC),ti=15&Vt,Mr=Vt>>4;if(ti!==0){var ri=t[bt+=Mr];Re.blockData[ot+ri]=ae(ti)*(1<<C),bt++}else{if(Mr<15){Se=re(Mr)+(1<<Mr)-1;break}bt+=16}}}var Fe,ht=0;function Lt(Re,ot){for(var bt,Dr,Vt=A,ti=R,Mr=0;Vt<=ti;){var ri=t[Vt];switch(ht){case 0:if(Mr=(Dr=ne(Re.huffmanTableAC))>>4,(bt=15&Dr)==0)Mr<15?(Se=re(Mr)+(1<<Mr),ht=4):(Mr=16,ht=1);else{if(bt!==1)throw new e("invalid ACn encoding");Fe=ae(bt),ht=Mr?2:3}continue;case 1:case 2:Re.blockData[ot+ri]?Re.blockData[ot+ri]+=X()<<C:--Mr==0&&(ht=ht===2?3:0);break;case 3:Re.blockData[ot+ri]?Re.blockData[ot+ri]+=X()<<C:(Re.blockData[ot+ri]=Fe<<C,ht=0);break;case 4:Re.blockData[ot+ri]&&(Re.blockData[ot+ri]+=X()<<C)}Vt++}ht===4&&--Se==0&&(ht=0)}function Nt(Re,ot,bt,Dr,Vt){var ti=bt%U;ot(Re,y(Re,(bt/U|0)*Re.v+Dr,ti*Re.h+Vt))}function Ir(Re,ot,bt){ot(Re,y(Re,bt/Re.blocksPerLine|0,bt%Re.blocksPerLine))}var st,St,ei,rn,Dt,yi,On=M.length;yi=F?A===0?L===0?de:fe:L===0?Ee:Lt:he;var nn,mi,Dl,Qu,Gi=0;for(mi=On===1?M[0].blocksPerLine*M[0].blocksPerColumn:U*I.mcusPerColumn;Gi<mi;){var Ri=$?Math.min(mi-Gi,$):mi;for(St=0;St<On;St++)M[St].pred=0;if(Se=0,On===1)for(st=M[0],Dt=0;Dt<Ri;Dt++)Ir(st,yi,Gi),Gi++;else for(Dt=0;Dt<Ri;Dt++){for(St=0;St<On;St++)for(Dl=(st=M[St]).h,Qu=st.v,ei=0;ei<Qu;ei++)for(rn=0;rn<Dl;rn++)Nt(st,yi,Gi,ei,rn);Gi++}K=0,(nn=_(x,T))&&nn.invalid&&(console.log("decodeScan - unexpected MCU data, next marker is: "+nn.invalid),T=nn.offset);var Pn=nn&&nn.marker;if(!Pn||Pn<=65280)throw new e("marker was not found");if(!(Pn>=65488&&Pn<=65495))break;T+=2}return(nn=_(x,T))&&nn.invalid&&(console.log("decodeScan - unexpected Scan data, next marker is: "+nn.invalid),T=nn.offset),T-j}function w(x,T,I){var M,$,A,R,L,C,U,F,j,q,K,X,ne,re,ae,he,de,fe=x.quantizationTable,Se=x.blockData;if(!fe)throw new e("missing required Quantization Table.");for(var Ee=0;Ee<64;Ee+=8)j=Se[T+Ee],q=Se[T+Ee+1],K=Se[T+Ee+2],X=Se[T+Ee+3],ne=Se[T+Ee+4],re=Se[T+Ee+5],ae=Se[T+Ee+6],he=Se[T+Ee+7],j*=fe[Ee],q|K|X|ne|re|ae|he?(q*=fe[Ee+1],K*=fe[Ee+2],X*=fe[Ee+3],ne*=fe[Ee+4],re*=fe[Ee+5],ae*=fe[Ee+6],he*=fe[Ee+7],$=(M=(M=u*j+128>>8)+($=u*ne+128>>8)+1>>1)-$,de=(A=K)*a+(R=ae)*o+128>>8,A=A*o-R*a+128>>8,U=(L=(L=c*(q-he)+128>>8)+(U=re<<4)+1>>1)-U,C=(F=(F=c*(q+he)+128>>8)+(C=X<<4)+1>>1)-C,R=(M=M+(R=de)+1>>1)-R,A=($=$+A+1>>1)-A,de=L*s+F*n+2048>>12,L=L*n-F*s+2048>>12,F=de,de=C*i+U*r+2048>>12,C=C*r-U*i+2048>>12,U=de,I[Ee]=M+F,I[Ee+7]=M-F,I[Ee+1]=$+U,I[Ee+6]=$-U,I[Ee+2]=A+C,I[Ee+5]=A-C,I[Ee+3]=R+L,I[Ee+4]=R-L):(de=u*j+512>>10,I[Ee]=de,I[Ee+1]=de,I[Ee+2]=de,I[Ee+3]=de,I[Ee+4]=de,I[Ee+5]=de,I[Ee+6]=de,I[Ee+7]=de);for(var Fe=0;Fe<8;++Fe)j=I[Fe],(q=I[Fe+8])|(K=I[Fe+16])|(X=I[Fe+24])|(ne=I[Fe+32])|(re=I[Fe+40])|(ae=I[Fe+48])|(he=I[Fe+56])?($=(M=4112+((M=u*j+2048>>12)+($=u*ne+2048>>12)+1>>1))-$,de=(A=K)*a+(R=ae)*o+2048>>12,A=A*o-R*a+2048>>12,R=de,U=(L=(L=c*(q-he)+2048>>12)+(U=re)+1>>1)-U,C=(F=(F=c*(q+he)+2048>>12)+(C=X)+1>>1)-C,de=L*s+F*n+2048>>12,L=L*n-F*s+2048>>12,F=de,de=C*i+U*r+2048>>12,C=C*r-U*i+2048>>12,j=(j=(M=M+R+1>>1)+F)<16?0:j>=4080?255:j>>4,q=(q=($=$+A+1>>1)+(U=de))<16?0:q>=4080?255:q>>4,K=(K=(A=$-A)+C)<16?0:K>=4080?255:K>>4,X=(X=(R=M-R)+L)<16?0:X>=4080?255:X>>4,ne=(ne=R-L)<16?0:ne>=4080?255:ne>>4,re=(re=A-C)<16?0:re>=4080?255:re>>4,ae=(ae=$-U)<16?0:ae>=4080?255:ae>>4,he=(he=M-F)<16?0:he>=4080?255:he>>4,Se[T+Fe]=j,Se[T+Fe+8]=q,Se[T+Fe+16]=K,Se[T+Fe+24]=X,Se[T+Fe+32]=ne,Se[T+Fe+40]=re,Se[T+Fe+48]=ae,Se[T+Fe+56]=he):(de=(de=u*j+8192>>14)<-2040?0:de>=2024?255:de+2056>>4,Se[T+Fe]=de,Se[T+Fe+8]=de,Se[T+Fe+16]=de,Se[T+Fe+24]=de,Se[T+Fe+32]=de,Se[T+Fe+40]=de,Se[T+Fe+48]=de,Se[T+Fe+56]=de)}function b(x,T){for(var I=T.blocksPerLine,M=T.blocksPerColumn,$=new Int16Array(64),A=0;A<M;A++)for(var R=0;R<I;R++)w(T,y(T,A,R),$);return T.blockData}function _(x,T,I){function M(C){return x[C]<<8|x[C+1]}var $=x.length-1,A=I<T?I:T;if(T>=$)return null;var R=M(T);if(R>=65472&&R<=65534)return{invalid:null,marker:R,offset:T};for(var L=M(A);!(L>=65472&&L<=65534);){if(++A>=$)return null;L=M(A)}return{invalid:R.toString(16),marker:L,offset:A}}return h.prototype={parse:function(x){function T(){var Re=x[R]<<8|x[R+1];return R+=2,Re}function I(){var Re=T(),ot=R+Re-2,bt=_(x,ot,R);bt&&bt.invalid&&(console.log("readDataBlock - incorrect length, next marker is: "+bt.invalid),ot=bt.offset);var Dr=x.subarray(R,ot);return R+=Dr.length,Dr}function M(Re){for(var ot=Math.ceil(Re.samplesPerLine/8/Re.maxH),bt=Math.ceil(Re.scanLines/8/Re.maxV),Dr=0;Dr<Re.components.length;Dr++){Dt=Re.components[Dr];var Vt=Math.ceil(Math.ceil(Re.samplesPerLine/8)*Dt.h/Re.maxH),ti=Math.ceil(Math.ceil(Re.scanLines/8)*Dt.v/Re.maxV),Mr=ot*Dt.h,ri=bt*Dt.v*64*(Mr+1);Dt.blockData=new Int16Array(ri),Dt.blocksPerLine=Vt,Dt.blocksPerColumn=ti}Re.mcusPerLine=ot,Re.mcusPerColumn=bt}var $,A,R=0,L=null,C=null,U=[],F=[],j=[],q=T();if(q!==65496)throw new e("SOI not found");for(q=T();q!==65497;){var K,X,ne;switch(q){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var re=I();q===65504&&re[0]===74&&re[1]===70&&re[2]===73&&re[3]===70&&re[4]===0&&(L={version:{major:re[5],minor:re[6]},densityUnits:re[7],xDensity:re[8]<<8|re[9],yDensity:re[10]<<8|re[11],thumbWidth:re[12],thumbHeight:re[13],thumbData:re.subarray(14,14+3*re[12]*re[13])}),q===65518&&re[0]===65&&re[1]===100&&re[2]===111&&re[3]===98&&re[4]===101&&(C={version:re[5]<<8|re[6],flags0:re[7]<<8|re[8],flags1:re[9]<<8|re[10],transformCode:re[11]});break;case 65499:for(var ae=T()+R-2;R<ae;){var he=x[R++],de=new Uint16Array(64);if(he>>4){if(he>>4!=1)throw new e("DQT - invalid table spec");for(X=0;X<64;X++)de[t[X]]=T()}else for(X=0;X<64;X++)de[t[X]]=x[R++];U[15&he]=de}break;case 65472:case 65473:case 65474:if($)throw new e("Only single frame JPEGs supported");T(),($={}).extended=q===65473,$.progressive=q===65474,$.precision=x[R++],$.scanLines=T(),$.samplesPerLine=T(),$.components=[],$.componentIds={};var fe,Se=x[R++],Ee=0,Fe=0;for(K=0;K<Se;K++){fe=x[R];var ht=x[R+1]>>4,Lt=15&x[R+1];Ee<ht&&(Ee=ht),Fe<Lt&&(Fe=Lt);var Nt=x[R+2];ne=$.components.push({h:ht,v:Lt,quantizationId:Nt,quantizationTable:null}),$.componentIds[fe]=ne-1,R+=3}$.maxH=Ee,$.maxV=Fe,M($);break;case 65476:var Ir=T();for(K=2;K<Ir;){var st=x[R++],St=new Uint8Array(16),ei=0;for(X=0;X<16;X++,R++)ei+=St[X]=x[R];var rn=new Uint8Array(ei);for(X=0;X<ei;X++,R++)rn[X]=x[R];K+=17+ei,(st>>4?F:j)[15&st]=d(St,rn)}break;case 65501:T(),A=T();break;case 65498:T();var Dt,yi=x[R++],On=[];for(K=0;K<yi;K++){var nn=$.componentIds[x[R++]];Dt=$.components[nn];var mi=x[R++];Dt.huffmanTableDC=j[mi>>4],Dt.huffmanTableAC=F[15&mi],On.push(Dt)}var Dl=x[R++],Qu=x[R++],Gi=x[R++],Ri=v(x,R,$,On,A,Dl,Qu,Gi>>4,15&Gi);R+=Ri;break;case 65535:x[R]!==255&&R--;break;default:if(x[R-3]===255&&x[R-2]>=192&&x[R-2]<=254){R-=3;break}throw new e("unknown marker "+q.toString(16))}q=T()}for(this.width=$.samplesPerLine,this.height=$.scanLines,this.jfif=L,this.eof=R,this.adobe=C,this.components=[],K=0;K<$.components.length;K++){var Pn=U[(Dt=$.components[K]).quantizationId];Pn&&(Dt.quantizationTable=Pn),this.components.push({output:b($,Dt),scaleX:Dt.h/$.maxH,scaleY:Dt.v/$.maxV,blocksPerLine:Dt.blocksPerLine,blocksPerColumn:Dt.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData:function(x,T){var I,M,$,A,R,L,C,U,F,j,q,K=this.width/x,X=this.height/T,ne=0,re=this.components.length,ae=x*T*re,he=new Uint8ClampedArray(ae),de=new Uint32Array(x),fe=4294967288;for(C=0;C<re;C++){for(M=(I=this.components[C]).scaleX*K,$=I.scaleY*X,ne=C,q=I.output,A=I.blocksPerLine+1<<3,R=0;R<x;R++)U=0|R*M,de[R]=(U&fe)<<3|7&U;for(L=0;L<T;L++)for(j=A*((U=0|L*$)&fe)|(7&U)<<3,R=0;R<x;R++)he[ne]=q[j+de[R]],ne+=re}var Se=this.decodeTransform;if(Se)for(C=0;C<ae;)for(U=0,F=0;U<re;U++,C++,F+=2)he[C]=(he[C]*Se[F]>>8)+Se[F+1];return he},_isColorConversionNeeded:function(){return this.adobe?!!this.adobe.transformCode:this.numComponents===3?this.colorTransform!==0:this.colorTransform===1},_convertYccToRgb:function(x){for(var T,I,M,$=0,A=x.length;$<A;$+=3)T=x[$],I=x[$+1],M=x[$+2],x[$]=T-179.456+1.402*M,x[$+1]=T+135.459-.344*I-.714*M,x[$+2]=T-226.816+1.772*I;return x},_convertYcckToRgb:function(x){for(var T,I,M,$,A=0,R=0,L=x.length;R<L;R+=4)T=x[R],I=x[R+1],M=x[R+2],$=x[R+3],x[A++]=I*(-660635669420364e-19*I+.000437130475926232*M-54080610064599e-18*T+.00048449797120281*$-.154362151871126)-122.67195406894+M*(-.000957964378445773*M+.000817076911346625*T-.00477271405408747*$+1.53380253221734)+T*(.000961250184130688*T-.00266257332283933*$+.48357088451265)+$*(-.000336197177618394*$+.484791561490776),x[A++]=107.268039397724+I*(219927104525741e-19*I-.000640992018297945*M+.000659397001245577*T+.000426105652938837*$-.176491792462875)+M*(-.000778269941513683*M+.00130872261408275*T+.000770482631801132*$-.151051492775562)+T*(.00126935368114843*T-.00265090189010898*$+.25802910206845)+$*(-.000318913117588328*$-.213742400323665),x[A++]=I*(-.000570115196973677*I-263409051004589e-19*M+.0020741088115012*T-.00288260236853442*$+.814272968359295)-20.810012546947+M*(-153496057440975e-19*M-.000132689043961446*T+.000560833691242812*$-.195152027534049)+T*(.00174418132927582*T-.00255243321439347*$+.116935020465145)+$*(-.000343531996510555*$+.24165260232407);return x},_convertYcckToCmyk:function(x){for(var T,I,M,$=0,A=x.length;$<A;$+=4)T=x[$],I=x[$+1],M=x[$+2],x[$]=434.456-T-1.402*M,x[$+1]=119.541-T+.344*I+.714*M,x[$+2]=481.816-T-1.772*I;return x},_convertCmykToRgb:function(x){for(var T,I,M,$,A=0,R=1/255,L=0,C=x.length;L<C;L+=4)T=x[L]*R,I=x[L+1]*R,M=x[L+2]*R,$=x[L+3]*R,x[A++]=255+T*(-4.387332384609988*T+54.48615194189176*I+18.82290502165302*M+212.25662451639585*$-285.2331026137004)+I*(1.7149763477362134*I-5.6096736904047315*M-17.873870861415444*$-5.497006427196366)+M*(-2.5217340131683033*M-21.248923337353073*$+17.5119270841813)-$*(21.86122147463605*$+189.48180835922747),x[A++]=255+T*(8.841041422036149*T+60.118027045597366*I+6.871425592049007*M+31.159100130055922*$-79.2970844816548)+I*(-15.310361306967817*I+17.575251261109482*M+131.35250912493976*$-190.9453302588951)+M*(4.444339102852739*M+9.8632861493405*$-24.86741582555878)-$*(20.737325471181034*$+187.80453709719578),x[A++]=255+T*(.8842522430003296*T+8.078677503112928*I+30.89978309703729*M-.23883238689178934*$-14.183576799673286)+I*(10.49593273432072*I+63.02378494754052*M+50.606957656360734*$-112.23884253719248)+M*(.03296041114873217*M+115.60384449646641*$-193.58209356861505)-$*(22.33816807309886*$+180.12613974708367);return x},getData:function(x,T,I){if(this.numComponents>4)throw new e("Unsupported color mode");var M=this._getLinearizedBlockData(x,T);if(this.numComponents===1&&I){for(var $=M.length,A=new Uint8ClampedArray(3*$),R=0,L=0;L<$;L++){var C=M[L];A[R++]=C,A[R++]=C,A[R++]=C}return A}if(this.numComponents===3&&this._isColorConversionNeeded())return this._convertYccToRgb(M);if(this.numComponents===4){if(this._isColorConversionNeeded())return I?this._convertYcckToRgb(M):this._convertYcckToCmyk(M);if(I)return this._convertCmykToRgb(M)}return M}},h}()},(Bj=Gj())!==void 0&&(Vj.exports=Bj);const cY=C4(uY.exports);let r3e=class{static decode(t,r=!1){const i=new Uint8Array(t),n=new cY;n.parse(i);const{width:s,height:o,numComponents:a,eof:u}=n,c=n.getData(s,o,!0),h=s*o;let d,y=null,v=0,w=0,b=0;if(!r&&u<i.length-1)try{const _=new dw(i.subarray(u)).getBytes();y=new Uint8Array(h);let x=0;for(v=0;v<_.length;v++)for(b=7;b>=0;b--)y[x++]=_[v]>>b&1}catch{}if(a===1&&c.length===s*o){const _=new Uint8Array(c.buffer);d=[_,_,_]}else{for(d=[],v=0;v<3;v++)d.push(new Uint8Array(h));for(b=0,w=0;w<h;w++)for(v=0;v<3;v++)d[v][w]=c[b++]}return{width:s,height:o,pixels:d,mask:y}}};const pY=[{pixelType:"S8",size:1,ctor:Int8Array,range:[-128,127]},{pixelType:"U8",size:1,ctor:Uint8Array,range:[0,255]},{pixelType:"S16",size:2,ctor:Int16Array,range:[-32768,32767]},{pixelType:"U16",size:2,ctor:Uint16Array,range:[0,65536]},{pixelType:"S32",size:4,ctor:Int32Array,range:[-2147483648,2147483647]},{pixelType:"U32",size:4,ctor:Uint32Array,range:[0,4294967296]},{pixelType:"F32",size:4,ctor:Float32Array,range:[-34027999387901484e22,34027999387901484e22]},{pixelType:"F64",size:8,ctor:Float64Array,range:[-17976931348623157e292,17976931348623157e292]}];let LM=null;function hY(){return LM||(LM=ge(()=>import("./lerc-wasm-0qWN9Wav.js"),__vite__mapDeps([122,1,2])).then(e=>e.l).then(({default:e})=>e({locateFile:t=>Rt(`esri/layers/support/rasterFormats/${t}`)})).then(e=>{n3e(e)}),LM)}const wx={getBlobInfo:null,decode:null};function i3e(e){return 16+(e>>3<<3)}function wc(e,t,r){r.set(e.slice(t,t+r.length))}function n3e(e){const{_malloc:t,_free:r,_lerc_getBlobInfo:i,_lerc_getDataRanges:n,_lerc_decode_4D:s,asm:o}=e;let a;const u=Object.values(o).find(h=>h&&"buffer"in h&&h.buffer===e.HEAPU8.buffer),c=h=>{const d=h.map(b=>i3e(b)),y=d.reduce((b,_)=>b+_),v=t(y);a=new Uint8Array(u.buffer);let w=d[0];d[0]=v;for(let b=1;b<d.length;b++){const _=d[b];d[b]=d[b-1]+w,w=_}return d};wx.getBlobInfo=h=>{const v=new Uint8Array(48),w=new Uint8Array(8*3),[b,_,x]=c([h.length,v.length,w.length]);a.set(h,b),a.set(v,_),a.set(w,x);let T=i(b,h.length,_,x,12,3);if(T)throw r(b),new Error(`lerc-getBlobInfo: error code is ${T}`);a=new Uint8Array(u.buffer),wc(a,_,v),wc(a,x,w);const I=new Uint32Array(v.buffer),M=new Float64Array(w.buffer),[$,A,,R,L,C,U,F,j,q,K]=I,X={version:$,depthCount:q,width:R,height:L,validPixelCount:U,bandCount:C,blobSize:F,maskCount:j,dataType:A,minValue:M[0],maxValue:M[1],maxZerror:M[2],statistics:[],bandCountWithNoData:K};if(K&&q>1)return r(b),X;if(q===1&&C===1)return r(b),X.statistics.push({minValue:M[0],maxValue:M[1]}),X;const ne=q*C*8,re=new Uint8Array(ne),ae=new Uint8Array(ne);let he=b,de=0,fe=0,Se=!1;if(a.byteLength<b+2*ne?(r(b),Se=!0,[he,de,fe]=c([h.length,ne,ne]),a.set(h,he)):[de,fe]=c([ne,ne]),a.set(re,de),a.set(ae,fe),T=n(he,h.length,q,C,de,fe),T)throw r(he),Se||r(de),new Error(`lerc-getDataRanges: error code is ${T}`);a=new Uint8Array(u.buffer),wc(a,de,re),wc(a,fe,ae);const Ee=new Float64Array(re.buffer),Fe=new Float64Array(ae.buffer),ht=X.statistics;for(let Lt=0;Lt<C;Lt++)if(q>1){const Nt=Ee.slice(Lt*q,(Lt+1)*q),Ir=Fe.slice(Lt*q,(Lt+1)*q),st=Math.min.apply(null,Nt),St=Math.max.apply(null,Ir);ht.push({minValue:st,maxValue:St,depthStats:{minValues:Nt,maxValues:Ir}})}else ht.push({minValue:Ee[Lt],maxValue:Fe[Lt]});return r(he),Se||r(de),X},wx.decode=(h,d)=>{const{maskCount:y,depthCount:v,bandCount:w,width:b,height:_,dataType:x,bandCountWithNoData:T}=d,I=pY[x],M=b*_,$=new Uint8Array(M*w),A=M*v*w*I.size,R=new Uint8Array(A),L=new Uint8Array(w),C=new Uint8Array(8*w),[U,F,j,q,K]=c([h.length,$.length,R.length,L.length,C.length]);a.set(h,U),a.set($,F),a.set(R,j),a.set(L,q),a.set(C,K);const X=s(U,h.length,y,F,v,b,_,w,x,j,q,K);if(X)throw r(U),new Error(`lerc-decode: error code is ${X}`);a=new Uint8Array(u.buffer),wc(a,j,R),wc(a,F,$);let ne=null;if(T){wc(a,q,L),wc(a,K,C),ne=[];const re=new Float64Array(C.buffer);for(let ae=0;ae<L.length;ae++)ne.push(L[ae]?re[ae]:null)}return r(U),{data:R,maskData:$,noDataValues:ne}}}function s3e(e,t,r,i,n){if(r<2)return e;const s=new i(t*r);for(let o=0,a=0;o<t;o++)for(let u=0,c=o;u<r;u++,c+=t)s[c]=e[a++];return s}function dY(e,t={}){const r=t.inputOffset??0,i=e instanceof Uint8Array?e.subarray(r):new Uint8Array(e,r),n=wx.getBlobInfo(i),{data:s,maskData:o,noDataValues:a}=wx.decode(i,n),{width:u,height:c,bandCount:h,depthCount:d,dataType:y,maskCount:v,statistics:w}=n,b=pY[y],_=new b.ctor(s.buffer),x=[],T=[],I=u*c,M=I*d;for(let U=0;U<h;U++){const F=_.subarray(U*M,(U+1)*M);if(t.returnInterleaved)x.push(F);else{const j=s3e(F,I,d,b.ctor);x.push(j)}T.push(o.subarray(U*M,(U+1)*M))}const $=v===0?null:v===1?T[0]:new Uint8Array(I);if(v>1){$.set(T[0]);for(let U=1;U<T.length;U++){const F=T[U];for(let j=0;j<I;j++)$[j]=$[j]&F[j]}}const{noDataValue:A}=t,R=A!=null&&b.range[0]<=A&&b.range[1]>=A;if(v>0&&R)for(let U=0;U<h;U++){const F=x[U],j=T[U]||$;for(let q=0;q<I;q++)j[q]===0&&(F[q]=A)}const L=v===h&&h>1?T:null,{pixelType:C}=b;return{width:u,height:c,bandCount:h,pixelType:C,depthCount:d,statistics:w,pixels:x,mask:$,bandMasks:L,noDataValues:a}}function o3e(e,t,r,i=!0){if(t%4!=0||r%4!=0){const n=new ArrayBuffer(4*Math.ceil(r/4)),s=new Uint8Array(n),o=new Uint8Array(e,t,r);if(i)for(let a=0;a<s.length;a+=4)s[a]=o[a+3],s[a+1]=o[a+2],s[a+2]=o[a+1],s[a+3]=o[a];else s.set(o);return new Uint32Array(s.buffer)}if(i){const n=new Uint8Array(e,t,r),s=new Uint8Array(n.length);for(let o=0;o<s.length;o+=4)s[o]=n[o+3],s[o+1]=n[o+2],s[o+2]=n[o+1],s[o+3]=n[o];return new Uint32Array(s.buffer)}return new Uint32Array(e,t,r/4)}function zj(){const e=[];for(let t=0;t<=257;t++)e[t]=[t];return e}function qj(e,t){for(let r=0;r<t.length;r++)e.push(t[r])}const gy=new Set;function LP(e,t,r,i=!0){const n=o3e(e,t,r,i);let s=9,o=zj(),a=32,u=o.length,c=[],h=1,d=n[0],y=0;const v=n.length,w=8*(4*v-r),b=[];for(;d!=null;){if(a>=s)a-=s,y=d>>>32-s,d<<=s;else{y=d>>>32-a,d=n[h++];const x=s-a;a=32-x,y=(y<<x)+(d>>>a),d<<=x}if(y===257)break;if(y===256){s=9,o=zj(),u=o.length,c=[];continue}const _=o[y];if(_==null){if(y>o.length)throw new Error("data integrity issue: code does not exist on code page");c.push(c[0]),o[u++]=c.slice(),qj(b,c)}else qj(b,_),c.push(_[0]),c.length>1&&(o[u++]=c.slice()),c=_.slice();if(gy.has(u)&&s++,a===0&&(d=n[h++],a=32),h>v||h===v&&a<=w)break}return new Uint8Array(b)}gy.add(511),gy.add(1023),gy.add(2047),gy.add(4095),gy.add(8191);const Hj=(e,t)=>{const r=t.width*t.height,i=t.pixelType;return Math.floor(e.byteLength/(r*fY(i)))},fY=e=>{let t=1;switch(e){case Uint8Array:case Int8Array:t=1;break;case Uint16Array:case Int16Array:t=2;break;case Uint32Array:case Int32Array:case Float32Array:t=4;break;case Float64Array:t=8}return t},a3e=(e,t)=>{if(8*e.byteLength<t)return null;const r=new Uint8Array(e,0,Math.ceil(t/8)),i=new Uint8Array(t);let n=0,s=0,o=0,a=0;for(o=0;o<r.length-1;o++)for(s=r[o],a=7;a>=0;a--)i[n++]=s>>a&1;for(a=7;n<t-1;)s=r[r.length-1],i[n++]=s>>a&1,a--;return i};let l3e=class{static decode(t,r){const i=r.pixelType,n=[],s=r.width*r.height,o=Hj(t,r),{bandIds:a,format:u}=r,c=(a==null?void 0:a.length)||Hj(t,r),h=t.byteLength-t.byteLength%(s*fY(i)),d=new i(t,0,s*o);let y,v,w,b,_=null;if(u==="bip")for(y=0;y<c;y++){for(w=new i(s),b=a?a[y]:y,v=0;v<s;v++)w[v]=d[v*o+b];n.push(w)}else if(u==="bsq")for(y=0;y<c;y++)b=a?a[y]:y,n.push(d.subarray(b*s,(b+1)*s));return h<t.byteLength-1&&(_=a3e(t.slice(h),s)),{pixels:n,mask:_}}};function u3e(e,t){let r=0,i="",n=0,s=0;const o=e.length;for(;r<o;)s=e[r++],n=s>>4,n<8?n=1:n===15?(n=4,s=(7&s)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++]):n===14?(n=3,s=(15&s)<<12|(63&e[r++])<<6|63&e[r++]):(n=2,s=(31&s)<<6|63&e[r++]),(s!==0||t)&&(i+=String.fromCharCode(s));return i}const kP=(()=>{const e=[];return e[254]="NEWSUBFILETYPE",e[255]="SUBFILETYPE",e[256]="IMAGEWIDTH",e[257]="IMAGELENGTH",e[258]="BITSPERSAMPLE",e[259]="COMPRESSION",e[262]="PHOTOMETRICINTERPRETATION",e[263]="THRESHHOLDING",e[264]="CELLWIDTH",e[265]="CELLLENGTH",e[266]="FILLORDER",e[269]="DOCUMENTNAME",e[270]="IMAGEDESCRIPTION",e[271]="MAKE",e[272]="MODEL",e[273]="STRIPOFFSETS",e[274]="ORIENTATION",e[277]="SAMPLESPERPIXEL",e[278]="ROWSPERSTRIP",e[279]="STRIPBYTECOUNTS",e[280]="MINSAMPLEVALUE",e[281]="MAXSAMPLEVALUE",e[282]="XRESOLUTION",e[283]="YRESOLUTION",e[284]="PLANARCONFIGURATION",e[285]="PAGENAME",e[286]="XPOSITION",e[287]="YPOSITION",e[288]="FREEOFFSETS",e[289]="FREEBYTECOUNTS",e[290]="GRAYRESPONSEUNIT",e[291]="GRAYRESPONSECURVE",e[292]="T4OPTIONS",e[293]="T6OPTIONS",e[296]="RESOLUTIONUNIT",e[297]="PAGENUMBER",e[300]="COLORRESPONSEUNIT",e[301]="TRANSFERFUNCTION",e[305]="SOFTWARE",e[306]="DATETIME",e[315]="ARTIST",e[316]="HOSTCOMPUTER",e[317]="PREDICTOR",e[318]="WHITEPOINT",e[319]="PRIMARYCHROMATICITIES",e[320]="COLORMAP",e[321]="HALFTONEHINTS",e[322]="TILEWIDTH",e[323]="TILELENGTH",e[324]="TILEOFFSETS",e[325]="TILEBYTECOUNTS",e[326]="BADFAXLINES",e[327]="CLEANFAXDATA",e[328]="CONSECUTIVEBADFAXLINES",e[330]="SUBIFD",e[332]="INKSET",e[333]="INKNAMES",e[334]="NUMBEROFINKS",e[336]="DOTRANGE",e[337]="TARGETPRINTER",e[338]="EXTRASAMPLES",e[339]="SAMPLEFORMAT",e[340]="SMINSAMPLEVALUE",e[341]="SMAXSAMPLEVALUE",e[342]="TRANSFERRANGE",e[347]="JPEGTABLES",e[512]="JPEGPROC",e[513]="JPEGIFOFFSET",e[514]="JPEGIFBYTECOUNT",e[515]="JPEGRESTARTINTERVAL",e[517]="JPEGLOSSLESSPREDICTORS",e[518]="JPEGPOINTTRANSFORM",e[519]="JPEGQTABLES",e[520]="JPEGDCTABLES",e[521]="JPEGACTABLES",e[529]="YCBCRCOEFFICIENTS",e[530]="YCBCRSUBSAMPLING",e[531]="YCBCRPOSITIONING",e[532]="REFERENCEBLACKWHITE",e[700]="XMP",e[33550]="GEOPIXELSCALE",e[33922]="GEOTIEPOINTS",e[33432]="COPYRIGHT",e[42112]="GDAL_METADATA",e[42113]="GDAL_NODATA",e[50844]="RPCCOEFFICIENT",e[34264]="GEOTRANSMATRIX",e[34735]="GEOKEYDIRECTORY",e[34736]="GEODOUBLEPARAMS",e[34737]="GEOASCIIPARAMS",e[34665]="EXIFIFD",e[34853]="GPSIFD",e[40965]="INTEROPERABILITYIFD",e})(),c3e=(()=>{const e=kP.slice();return e[36864]="ExifVersion",e[40960]="FlashpixVersion",e[40961]="ColorSpace",e[42240]="Gamma",e[37121]="ComponentsConfiguration",e[37122]="CompressedBitsPerPixel",e[40962]="PixelXDimension",e[40963]="PixelYDimension",e[37500]="MakerNote",e[37510]="UserComment",e[40964]="RelatedSoundFile",e[36867]="DateTimeOriginal",e[36868]="DateTimeDigitized",e[36880]="OffsetTime",e[36881]="OffsetTimeOriginal",e[36882]="OffsetTimeDigitized",e[37520]="SubSecTime",e[37521]="SubSecTimeOriginal",e[37522]="SubSecTimeDigitized",e[37888]="Temperature",e[37889]="Humidity",e[37890]="Pressure",e[37891]="WaterDepth",e[37892]="Acceleration",e[37893]="CameraElevationAngle",e[42016]="ImageUniqueID",e[42032]="CameraOwnerName",e[42033]="BodySerialNumber",e[42034]="LensSpecification",e[42035]="LensMake",e[42036]="LensModel",e[42037]="LensSerialNumber",e[33434]="ExposureTime",e[33437]="FNumber",e[34850]="ExposureProgram",e[34852]="SpectralSensitivity",e[34855]="PhotographicSensitivity",e[34856]="OECF",e[34864]="SensitivityType",e[34865]="StandardOutputSensitivity",e[34866]="RecommendedExposureIndex",e[34867]="ISOSpeed",e[34868]="ISOSpeedLatitudeyyy",e[34869]="ISOSpeedLatitudezzz",e[37377]="ShutterSpeedValue",e[37378]="ApertureValue",e[37379]="BrightnessValue",e[37380]="ExposureBiasValue",e[37381]="MaxApertureValue",e[37382]="SubjectDistance",e[37383]="MeteringMode",e[37384]="LightSource",e[37385]="Flash",e[37386]="FocalLength",e[37396]="SubjectArea",e[41483]="FlashEnergy",e[41484]="SpatialFrequencyResponse",e[41486]="FocalPlaneXResolution",e[41487]="FocalPlaneYResolution",e[41488]="FocalPlaneResolutionUnit",e[41492]="SubjectLocation",e[41493]="ExposureIndex",e[41495]="SensingMethod",e[41728]="FileSource",e[41729]="SceneType",e[41730]="CFAPattern",e[41985]="CustomRendered",e[41986]="ExposureMode",e[41987]="WhiteBalance",e[41988]="DigitalZoomRatio",e[41989]="FocalLengthIn35mmFilm",e[41990]="SceneCaptureType",e[41991]="GainControl",e[41992]="Contrast",e[41993]="Saturation",e[41994]="Sharpness",e[41995]="DeviceSettingDescription",e[41996]="SubjectDistanceRange",e})(),p3e=["GPSVersionID","GPSLatitudeRef","GPSLatitude","GPSLongitudeRef","GPSLongitude","GPSAltitudeRef","GPSAltitude","GPSTimeStamp","GPSSatellites","GPSStatus","GPSMeasureMode","GPSDOP","GPSSpeedRef","GPSSpeed","GPSTrackRef","GPSTrack","GPSImgDirectionRef","GPSImgDirection","GPSMapDatum","GPSDestLatitudeRef","GPSDestLatitude","GPSDestLongitudeRef","GPSDestLongitude","GPSDestBearingRef","GPSDestBearing","GPSDestDistanceRef","GPSDestDistance","GPSProcessingMethod","GPSAreaInformation","GPSDateStamp","GPSDifferential","GPSHPositioningError"],h3e=(()=>{const e=[];return e[1024]="GTModelTypeGeoKey",e[1025]="GTRasterTypeGeoKey",e[1026]="GTCitationGeoKey",e[2048]="GeographicTypeGeoKey",e[2049]="GeogCitationGeoKey",e[2050]="GeogGeodeticDatumGeoKey",e[2051]="GeogPrimeMeridianGeoKey",e[2052]="GeogLinearUnitsGeoKey",e[2053]="GeogLinearUnitSizeGeoKey",e[2054]="GeogAngularUnitsGeoKey",e[2055]="GeogAngularUnitSizeGeoKey",e[2056]="GeogEllipsoidGeoKey",e[2057]="GeogSemiMajorAxisGeoKey",e[2058]="GeogSemiMinorAxisGeoKey",e[2059]="GeogInvFlatteningGeoKey",e[2061]="GeogPrimeMeridianLongGeoKey",e[2060]="GeogAzimuthUnitsGeoKey",e[3072]="ProjectedCSTypeGeoKey",e[3073]="PCSCitationGeoKey",e[3074]="ProjectionGeoKey",e[3075]="ProjCoordTransGeoKey",e[3076]="ProjLinearUnitsGeoKey",e[3077]="ProjLinearUnitSizeGeoKey",e[3078]="ProjStdParallel1GeoKey",e[3079]="ProjStdParallel2GeoKey",e[3080]="ProjNatOriginLongGeoKey",e[3081]="ProjNatOriginLatGeoKey",e[3082]="ProjFalseEastingGeoKey",e[3083]="ProjFalseNorthingGeoKey",e[3084]="ProjFalseOriginLongGeoKey",e[3085]="ProjFalseOriginLatGeoKey",e[3086]="ProjFalseOriginEastingGeoKey",e[3087]="ProjFalseOriginNorthingGeoKey",e[3088]="ProjCenterLongGeoKey",e[3090]="ProjCenterEastingGeoKey",e[3091]="ProjCenterNorthingGeoKey",e[3092]="ProjScaleAtNatOriginGeoKey",e[3093]="ProjScaleAtCenterGeoKey",e[3094]="ProjAzimuthAngleGeoKey",e[3095]="ProjStraightVertPoleLongGeoKey",e[4096]="VerticalCSTypeGeoKey",e[4097]="VerticalCitationGeoKey",e[4098]="VerticalDatumGeoKey",e[4099]="VerticalUnitsGeoKey",e})(),d3e=(e,t)=>{let r=(t||kP)[e];return r===void 0&&(r="unknown"+String(e)),r},DR=new Map;DR.set("EXIFIFD",c3e),DR.set("GPSIFD",p3e);const lm={tiffTags:kP,ifdTags:DR,geoKeys:h3e,getTagName:d3e},NP=(()=>{const e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,t[0]===1})(),Wj=[0,1,1,2,4,8,1,1,2,4,8,4,8,-1,-1,-1,8,8,8],Dm=4294967296,f3e=new Set([1,5,6,7,8,34712,34887]);function DP(e,t){let r="unknown";return e===3?r=t===64?"f64":"f32":e===1?t===1?r="u1":t===2?r="u2":t===4?r="u4":t<=8?r="u8":t<=16?r="u16":t<=32&&(r="u32"):e===2&&(t<=8?r="s8":t<=16?r="s16":t<=32&&(r="s32")),r}function BT(e){let t=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":t=Uint8Array;break;case"u16":t=Uint16Array;break;case"u32":t=Uint32Array;break;case"s8":t=Int8Array;break;case"s16":t=Int16Array;break;case"s32":t=Int32Array;break;case"f64":t=Float64Array;break;default:t=Float32Array}return t}function y3e(e,t){return{x:t[0]*e.x+t[1]*e.y+t[2],y:t[3]*e.x+t[4]*e.y+t[5]}}function yY(e,t){var r;return(r=e.get(t))==null?void 0:r.values}function Kd(e,t){var r;return(r=e.get(t))==null?void 0:r.values}function Jj(e,t){var r,i;return(i=(r=e.get(t))==null?void 0:r.values)==null?void 0:i[0]}function nt(e,t){var r,i;return(i=(r=e.get(t))==null?void 0:r.values)==null?void 0:i[0]}function kM(e,t,r,i=0,n=lm.tiffTags,s=4){const o=s===8,a=o?jP(new DataView(e,r,8),0,t):new DataView(e,r,2).getUint16(0,t),u=4+2*s,c=o?8:2,h=c+a*u;if(r+h>e.byteLength)return{success:!1,ifd:null,nextIFD:null,requiredBufferSize:h};const d=r+h+4<=e.byteLength?U2(new DataView(e,r+h,s===8?8:4),0,t,s===8):null,y=r+c,v=new Map;let w,b,_,x,T,I=0,M=0;for(let $=0;$<a;$++){b=new DataView(e,y+u*$,u),_=b.getUint16(0,t),T=b.getUint16(2,t),x=lm.getTagName(_,n);const A=[];s===2?(I=b.getUint16(4,t),M=b.getUint16(6,t)):s===4?(I=b.getUint32(4,t),M=b.getUint32(8,t)):s===8&&(I=U2(b,4,t,!0),M=U2(b,12,t,!0),A.push(b.getUint32(12,t)),A.push(b.getUint32(16,t))),w={id:_,type:T,valueCount:I,valueOffset:M,valueOffsets:A,values:null},_3e(e,t,w,i,!1,s),v.set(x,w)}return{success:!0,ifd:v,nextIFD:d,requiredBufferSize:h}}const m3e=(e,t)=>dY(e,{inputOffset:t}).pixels[0];function FR(e,t){if(t!==1&&t!==2&&t!==4)return e;const r=new Uint8Array(e),i=8/t,n=new Uint8Array(e.byteLength*i);let s=0;const o=2**t-1;for(let a=0;a<r.length;a++){const u=r[a];for(let c=0;c<i;c++)n[s++]=u<<t*c>>>8-t&o}return n.buffer}function jR(e,t,r){const i=new cY;i.parse(e),i.colorTransform=r===6?-1:0;const n=i.getData(i.width,i.height,t!==1&&t!==4);return new Uint8Array(n.buffer)}function UR(e){const t=new dw(e).getBytes(),r=new ArrayBuffer(t.length),i=new Uint8Array(r);return i.set(t),i}async function VR(e,t,r,i,n){const s=NP===t,o=nt(r,"BITSPERSAMPLE"),a=nt(r,"SAMPLESPERPIXEL")??1,u=nt(r,"PHOTOMETRICINTERPRETATION"),c=nt(r,"SAMPLEFORMAT")??1,h=DP(c,o),d=nt(r,"COMPRESSION")??1,y=BT(h);let v,w,b;if(d===34887)return await hY(),m3e(e,i);if(d===1)v=e.slice(i,i+n),w=new Uint8Array(v);else if(d===8||d===32946)w=new Uint8Array(e,i,n),w=UR(w),v=w.buffer;else if(d===6)w=new Uint8Array(e,i,n),w=jR(w,a,u),v=w.buffer;else if(d===7){const I=r.get("JPEGTABLES").values,M=I.length-2;w=new Uint8Array(M+n-2);for(let A=0;A<M;A++)w[A]=I[A];const $=new Uint8Array(e,i+2,n-2);for(let A=0;A<$.length;A++)w[M+A]=$[A];w=jR(w,a,u),v=w.buffer}else{if(d!==5)throw new Error("tiff-decode: unsupport compression "+d);w=LP(e,i,n,t),v=w.buffer}if(v=FR(v,o),h==="u8"||h==="s8"||s)b=new y(v);else{v=new ArrayBuffer(w.length);const I=new Uint8Array(v);switch(h){case"u16":case"s16":for(let M=0;M<w.length;M+=2)I[M]=w[M+1],I[M+1]=w[M];break;case"u32":case"s32":case"f32":for(let M=0;M<w.length;M+=4)I[M]=w[M+3],I[M+1]=w[M+2],I[M+2]=w[M+1],I[M+3]=w[M]}b=new y(v)}const _=nt(r,"PREDICTOR")??1,x=nt(r,"TILEWIDTH"),T=nt(r,"TILELENGTH");if(_>1&&(d===5||d===8||d===32946)&&x&&T){const I=zT(r),M=new y(b.length);M.set(b),b=M3e(M,T,x,c===3&&_===3,I?1:a)}return b}async function g3e(e,t,r){const i=Kd(r,"TILEOFFSETS");if(i===void 0)return null;const n=Kd(r,"TILEBYTECOUNTS"),{width:s,height:o,pixelType:a,tileWidth:u,tileHeight:c}=FP([r]),h=zT(r,t),d=nt(r,"SAMPLESPERPIXEL")||t.planes,y=s*o,v=nt(r,"BITSPERSAMPLE"),w=(nt(r,"COMPRESSION")??1)===34887,b=BT(a),_=[];for(let re=0;re<d;re++)_.push(new b(y));let x,T,I,M,$,A,R,L,C,U,F,j,q;const K=Math.ceil(s/u),X=new Uint8Array(y).fill(255);let ne=!1;if(v%8==0)if(w&&h&&d>1){const re=Math.round(i.length/d);for(x=0;x<re;x++){A=Math.floor(x/K)*c,R=x%K*u,L=A*s+R;for(let ae=0;ae<d;ae++){const he=x*d+ae;for(n[he]===0?(I=null,ne=!0):I=await VR(e,t.littleEndian,r,i[he],n[he]),U=0,C=L,j=Math.min(u,s-R),F=Math.min(c,o-A),q=_[ae],M=0;M<F;M++)for(C=L+M*s,U=M*u,$=0;$<j;$++,C++,U++)I?q[C]=I[U]:X[C]=0}}}else for(x=0;x<i.length;x++)for(A=Math.floor(x/K)*c,R=x%K*u,L=A*s+R,n[x]===0?(I=null,ne=!0):I=await VR(e,t.littleEndian,r,i[x],n[x]),U=0,C=L,j=Math.min(u,s-R),F=Math.min(c,o-A),T=0;T<d;T++)if(q=_[T],h||w)for(M=0;M<F;M++)for(C=L+M*s,U=u*c*T+M*u,$=0;$<j;$++,C++,U++)I?q[C]=I[U]:X[C]=0;else for(M=0;M<F;M++)for(C=L+M*s,U=M*u*d+T,$=0;$<j;$++,C++,U+=d)I?q[C]=I[U]:X[C]=0;return{width:s,height:o,pixelType:a,pixels:_,mask:ne?X:void 0}}const v3e=(e,t,r)=>{const i=NP===t.littleEndian,n=Kd(r,"STRIPOFFSETS");if(n===void 0)return null;const{width:s,height:o,pixelType:a}=FP([r]),u=nt(r,"SAMPLESPERPIXEL")||t.planes,c=nt(r,"PHOTOMETRICINTERPRETATION"),h=s*o,d=nt(r,"BITSPERSAMPLE"),y=BT(a),v=new y(h*u),w=Kd(r,"STRIPBYTECOUNTS"),b=nt(r,"ROWSPERSTRIP"),_=nt(r,"COMPRESSION")??1;let x,T,I,M,$,A,R,L,C,U=b;if(d%8==0)for(x=0;x<n.length;x++){if($=x*(b*s)*u,U=(x+1)*b>o?o-x*b:b,a==="u8"||a==="s8"||i)_===8||_===32946?(R=new Uint8Array(e,n[x],w[x]),R=UR(R),A=R.buffer):_===6?(R=new Uint8Array(e,n[x],w[x]),R=jR(R,u,c),A=R.buffer):_===5?(R=LP(e,n[x],w[x],t.littleEndian),A=R.buffer):(w[x]!==U*s*u*d/8&&console.log("strip byte counts is different than expected"),A=e.slice(n[x],n[x]+w[x])),A=FR(A,d),M=new y(A);else{switch(_===6||_===8||_===32946?(R=new Uint8Array(e,n[x],w[x]),L=UR(R),A=L.buffer):(w[x]!==U*s*u*d/8&&console.log("strip byte counts is different than expected"),A=new ArrayBuffer(w[x]),R=new Uint8Array(e,n[x],w[x]),L=new Uint8Array(A)),a){case"u16":case"s16":for(I=0;I<R.length;I+=2)L[I]=R[I+1],L[I+1]=R[I];break;case"u32":case"s32":case"f32":for(I=0;I<R.length;I+=4)L[I]=R[I+3],L[I+1]=R[I+2],L[I+2]=R[I+1],L[I+3]=R[I]}A=FR(A,d),M=new y(A)}v.set(M,$)}const F=[];if(u===1)F.push(v);else for(x=0;x<u;x++){for(C=new y(h),T=0;T<h;T++)C[T]=v[T*u+x];F.push(C)}return{width:s,height:o,pixelType:a,pixels:F}},w3e=(e,t,r)=>{if(!(e&&e.length>0&&t&&r))return null;let i,n,s;const o=e[0].length,a=e.length,u=new Uint8Array(o);for(let c=0;c<a;c++)if(i=e[c],n=t[c],s=r[c],c===0)for(let h=0;h<o;h++)u[h]=i[h]<n||i[h]>s?0:1;else for(let h=0;h<o;h++)u[h]&&(u[h]=i[h]<n||i[h]>s?0:1);return u},b3e=e=>{if(!e)return null;const t=e.match(/<Item(.*?)Item>/gi);if(!t||t.length===0)return null;const r=new Map;let i,n,s,o,a;for(let x=0;x<t.length;x++)i=t[x],n=i.slice(6,i.indexOf(">")),o=i.indexOf("sample="),o>-1&&(a=i.slice(o+8,i.indexOf('"',o+8))),o=i.indexOf("name="),o>-1&&(n=i.slice(o+6,i.indexOf('"',o+6))),n&&(s=i.slice(i.indexOf(">")+1,i.indexOf("</Item>")).trim(),a!=null?r.has(n)?r.get(n)[a]=s:r.set(n,[s]):r.set(n,s)),a=null;const u=r.get("STATISTICS_MINIMUM"),c=r.get("STATISTICS_MAXIMUM"),h=r.get("STATISTICS_MEAN"),d=r.get("STATISTICS_STDDEV");let y=null;if(u&&c){y=[];for(let x=0;x<u.length;x++)y.push({min:parseFloat(u[x]),max:parseFloat(c[x]),avg:h&&parseFloat(h[x]),stddev:d&&parseFloat(d[x])})}const v=r.get("BandName"),w=r.get("WavelengthMin"),b=r.get("WavelengthMax");let _=null;if(v){_=[];for(let x=0;x<v.length;x++)_.push({BandName:v[x],WavelengthMin:w&&parseFloat(w[x]),WavelengthMax:b&&parseFloat(b[x])})}return{statistics:y,bandProperties:_,dataType:r.get("DataType"),rawMetadata:r}};function _3e(e,t,r,i=0,n=!1,s=4){if(r.values)return!0;const o=r.type,a=r.valueCount;let u=r.valueOffset,c=[];const h=Wj[o],d=8*h,y=a*h,v=a*Wj[o]*8;let w,b;const _=s===8?64:32,x=r.valueOffsets;if(v>_&&y>(n?e.byteLength:e?e.byteLength-u+i:0))return r.offlineOffsetSize=[u,y],r.values=null,!1;if(v<=_){if(!t)if(_<=32)u>>>=32-v;else{const T=x!=null&&x.length?x[0]:u>>>0,I=x!=null&&x.length?x[1]:Math.round((u-T)/Dm);v<=32?(u=T>>>32-v,x[0]=u):(u=T*2**(32-v)+(I>>>32-v),x[0]=T,x[1]=I>>>32-v)}if(a===1&&d===_)c=[u];else if(_===64){const T=x!=null&&x.length?x[0]:u>>>0,I=x!=null&&x.length?x[1]:Math.round((u-T)/Dm);let M=T,$=32;for(b=1;b<=a;b++){const A=32-d*b%32;if($<d){const R=M<<A>>>32-$,L=I<<32-$>>>32-$;M=I,c.push(R+L*2**(d-$)),$-=32-(d-$)}else c.push(M<<A>>>32-d),$-=d;$===0&&($=32,M=I)}}else for(b=1;b<=a;b++){const T=32-d*b;c.push(u<<T>>>32-d)}}else{u-=i,n&&(u=0);for(let T=u;T<u+y;T+=h){switch(o){case 1:case 2:case 7:w=new DataView(e,T,1).getUint8(0);break;case 3:w=new DataView(e,T,2).getUint16(0,t);break;case 4:case 13:w=new DataView(e,T,4).getUint32(0,t);break;case 5:w=new DataView(e,T,4).getUint32(0,t)/new DataView(e,T+4,4).getUint32(0,t);break;case 6:w=new DataView(e,T,1).getInt8(0);break;case 8:w=new DataView(e,T,2).getInt16(0,t);break;case 9:w=new DataView(e,T,4).getInt32(0,t);break;case 10:w=new DataView(e,T,4).getInt32(0,t)/new DataView(e,T+4,4).getInt32(0,t);break;case 11:w=new DataView(e,T,4).getFloat32(0,t);break;case 12:w=new DataView(e,T,8).getFloat64(0,t);break;case 16:case 18:w=jP(new DataView(e,T,8),0,t);break;case 17:w=x3e(new DataView(e,T,8),0,t);break;default:w=null}c.push(w)}}if(o===2){let T="";const I=c;for(c=[],b=0;b<I.length;b++)I[b]===0&&T!==""?(c.push(T),T=""):T+=String.fromCharCode(I[b]);T===""&&c.length!==0||c.push(T)}return r.values=c,!0}function FP(e){const t=e[0],r=nt(t,"TILEWIDTH"),i=nt(t,"TILELENGTH"),n=nt(t,"IMAGEWIDTH"),s=nt(t,"IMAGELENGTH"),o=nt(t,"BITSPERSAMPLE"),a=nt(t,"SAMPLESPERPIXEL"),u=nt(t,"SAMPLEFORMAT")??1,c=DP(u,o),h=zT(t),d=yY(t,"GDAL_NODATA");let y=null;d!=null&&d.length&&(y=d.map(he=>parseFloat(he)),y.some(he=>isNaN(he))&&(y=null));const v=nt(t,"COMPRESSION")??1;let w;switch(v){case 1:w="NONE";break;case 2:case 3:case 4:case 32771:w="CCITT";break;case 5:w="LZW";break;case 6:case 7:w="JPEG";break;case 32773:w="PACKBITS";break;case 8:case 32946:w="DEFLATE";break;case 34712:w="JPEG2000";break;case 34887:w="LERC";break;default:w=String(v)}let b=!0,_="";f3e.has(v)||(b=!1,_+="unsupported tag compression "+v),u>3&&(b=!1,_+="unsupported tag sampleFormat "+u),o!==1&&o!==2&&o!==4&&o%8!=0&&(b=!1,_+="unsupported tag bitsPerSample "+o);const x=Jj(t,"GEOASCIIPARAMS");let T;if(x){const he=x.split("|").find(fe=>fe.includes("ESRI PE String = ")),de=he?he.replace("ESRI PE String = ",""):"";T=de.startsWith("COMPD_CS")||de.startsWith("PROJCS")||de.startsWith("GEOGCS")?{wkid:null,wkt:de}:null}const I=Kd(t,"GEOTIEPOINTS"),M=Kd(t,"GEOPIXELSCALE"),$=Kd(t,"GEOTRANSMATRIX"),A=t.has("GEOKEYDIRECTORY")?t.get("GEOKEYDIRECTORY").data:null;let R,L,C=!1,U=!1;if(A){C=nt(A,"GTRasterTypeGeoKey")===2;const he=nt(A,"GTModelTypeGeoKey");if(he===2){const de=nt(A,"GeographicTypeGeoKey");de>=1024&&de<=32766&&(T={wkid:de}),T||de!==32767||(U=!0,T={wkid:4326})}else if(he===1){const de=nt(A,"ProjectedCSTypeGeoKey");de>=1024&&de<=32766&&(T={wkid:de})}}if(M&&I&&I.length>=6?(R=[M[0],0,I[3]-I[0]*M[0],0,-Math.abs(M[1]),I[4]-I[1]*M[1]],C&&(R[2]-=.5*R[0]+.5*R[1],R[5]-=.5*R[3]+.5*R[4])):$&&$.length===16&&(R=C?[$[0],$[1],$[3]-.5*$[0],$[4],$[5],$[7]-.5*$[5]]:[$[0],$[1],$[3],$[4],$[5],$[7]]),R){const he=[{x:0,y:s},{x:0,y:0},{x:n,y:s},{x:n,y:0}];let de,fe=Number.POSITIVE_INFINITY,Se=Number.POSITIVE_INFINITY,Ee=Number.NEGATIVE_INFINITY,Fe=Number.NEGATIVE_INFINITY;for(let ht=0;ht<he.length;ht++)de=y3e(he[ht],R),fe=de.x>fe?fe:de.x,Ee=de.x<Ee?Ee:de.x,Se=de.y>Se?Se:de.y,Fe=de.y<Fe?Fe:de.y;L={xmin:fe,xmax:Ee,ymin:Se,ymax:Fe,spatialReference:T}}else L={xmin:-.5,ymin:.5-s,xmax:n-.5,ymax:.5,spatialReference:T};U&&(L.xmax-L.xmin>400||Math.max(Math.abs(L.xmin),Math.abs(L.xmax))>361)&&(T=null,L.spatialReference=null);const F=mY(e);let j,q,K,X,ne;if(F.length>0){K=Math.round(Math.log(n/nt(F[0],"IMAGEWIDTH"))/Math.LN2);const he=F[F.length-1];X=Math.round(Math.log(n/nt(he,"IMAGEWIDTH"))/Math.LN2),j=nt(he,"TILEWIDTH"),q=nt(he,"TILELENGTH")}j=X!=null&&X>0?j||r:null,q=X!=null&&X>0?q||i:null,r&&(ne=[{maxCol:Math.ceil(n/r)-1,maxRow:Math.ceil(s/i)-1,minRow:0,minCol:0}],F.forEach(he=>{ne.push({maxCol:Math.ceil(nt(he,"IMAGEWIDTH")/nt(he,"TILEWIDTH"))-1,maxRow:Math.ceil(nt(he,"IMAGELENGTH")/nt(he,"TILELENGTH"))-1,minRow:0,minCol:0})}));const re=Jj(e[0],"GDAL_METADATA"),ae=b3e(re);return _+=" "+vY({width:n,height:s,tileWidth:r,tileHeight:i,planes:a,ifds:e}),{width:n,height:s,tileWidth:r,tileHeight:i,planes:a,isBSQ:h,pixelType:c,compression:w,noData:y,hasMaskBand:gY(e).length===F.length+1,isSupported:b,message:_,extent:L,isPseudoGeographic:U,affine:M?null:R,firstPyramidLevel:K,maximumPyramidLevel:X,pyramidBlockWidth:j,pyramidBlockHeight:q,tileBoundary:ne,metadata:ae}}function zT(e,t){const r=yY(e,"PLANARCONFIGURATION");return r?r[0]===2:!!t&&t.isBSQ}function mY(e){return e.filter(t=>nt(t,"NEWSUBFILETYPE")===1)}function gY(e){return e.filter(t=>{const r=(4&(nt(t,"NEWSUBFILETYPE")??0))==4,i=nt(t,"PHOTOMETRICINTERPRETATION")===4;return r&&i})}function S3e(e){const{littleEndian:t,isBigTiff:r,firstIFDPos:i}=T3e(e);let n=i;const s=[];do{const o=I3e(e,t,n,0,lm.tiffTags,r?8:4);if(!o.success)break;s.push(o.ifd),n=o.nextIFD}while(n>0);return{...FP(s),littleEndian:t,isBigTiff:r,ifds:s,pyramidIFDs:mY(s),maskIFDs:gY(s)}}function jP(e,t,r){const i=e.getUint32(t,r),n=e.getUint32(t+4,r);return r?n*Dm+i:i*Dm+n}function x3e(e,t,r){let i=r?e.getInt32(t,r):e.getUint32(t,r),n=r?e.getUint32(t+4,r):e.getInt32(t+4,r);const s=(r?i:n)>=0?1:-1;return r?i*=s:n*=s,s*(r?n*Dm+i:i*Dm+n)}function U2(e,t,r,i){return i?jP(e,t,r):e.getUint32(t,r)}function T3e(e){const t=new DataView(e,0,16),r=t.getUint16(0,!1);let i=null;if(r===18761)i=!0;else{if(r!==19789)throw new Error("unexpected endianess byte");i=!1}const n=t.getUint16(2,i);if(n!==42&&n!==43)throw new Error("unexpected tiff identifier");let s=4;const o=n===43;if(o){const a=t.getUint16(s,i);if(s+=2,a!==8)throw new Error("unsupported bigtiff version");if(t.getUint16(s,i)!==0)throw new Error("unsupported bigtiff version");s+=2}return{littleEndian:i,isBigTiff:o,firstIFDPos:U2(t,s,i,o)}}function I3e(e,t,r,i=0,n=lm.tiffTags,s=4){const o=kM(e,t,r,i,n,s);let a;const u=o.ifd;if(u){if(lm.ifdTags.forEach((c,h)=>{u.has(h)&&(a=u.get(h),a.data=kM(e,t,a.valueOffset-i,i,c).ifd)}),u.has("GEOKEYDIRECTORY")){a=u.get("GEOKEYDIRECTORY");const c=a.values;if(c&&c.length>4){const h=c[0]+"."+c[1]+"."+c[2];a.data=kM(e,t,a.valueOffset+6-i,i,lm.geoKeys,2).ifd,a.data&&a.data.set("GEOTIFFVersion",{id:0,type:2,valueCount:1,valueOffset:null,values:[h]})}}if(u.has("XMP")){a=u.get("XMP");const c=a.values;typeof c[0]=="number"&&a.type===7&&(a.values=[u3e(new Uint8Array(c))])}}return o}function vY(e){const{width:t,height:r,tileHeight:i,tileWidth:n}=e,s=e.planes,o=n?n*i:t*r,a=nt(e.ifds[0],"BITSPERSAMPLE");let u="";return o*s>2**30/(a>8?a/8:1)&&(u=n?"tiled tiff exceeding 1 gigabits per tile is not supported":"scanline tiff exceeding 1 gigabits is not supported"),u}function M3e(e,t,r,i,n){const s=i?4:1,o=r*s*n;i&&(e=new Uint8Array(e.buffer));for(let c=0;c<t;c++){const h=c*o;for(let d=n;d<o;d++)e[h+d]+=e[h+d-n]}if(!i)return e;const a=new Uint8Array(e.length),u=r*n;for(let c=0;c<t;c++){const h=c*o;for(let d=0;d<u;d++)for(let y=0;y<s;y++)a[h+d*s+y]=e[h+d+(s-y-1)*u]}return new Float32Array(a.buffer)}async function $3e(e,t){const{headerInfo:r,ifd:i,offsets:n,sizes:s}=t,o=[];for(let C=0;C<n.length;C++){s[C];const U=await VR(e,r.littleEndian,i,n[C],s[C]||e.byteLength);o.push(U)}const a=zT(i,r),u=nt(i,"BITSPERSAMPLE"),c=DP(nt(i,"SAMPLEFORMAT")??1,u),h=nt(i,"SAMPLESPERPIXEL")||r.planes,d=BT(c),y=nt(i,"TILEWIDTH"),v=nt(i,"TILELENGTH"),w=nt(i,"COMPRESSION")??1,b=y*v;let _;const x=[];let T=o[0];const I=w===34887;for(let C=0;C<h;C++){if(_=new d(b),o.length===h)T=o[C],T.length===b&&(_=T);else if(T.length)if(a||I)_=T.length===b?T:T.slice(b*C,b*(C+1));else for(let U=0;U<b;U++)_[U]=T[U*h+C];x.push(_)}const M=r.noData?r.noData[0]:t.noDataValue,$=r.metadata?r.metadata.statistics:null,A=$?$.map(C=>C.min):null,R=$?$.map(C=>C.max):null,L={pixelType:c,width:y,height:v,pixels:x,noDataValue:M};return M!=null?AP(L,M):A&&R&&t.applyMinMaxConstraint&&(L.mask=w3e(x,A,R)),L}async function E3e(e,t={}){const r=t.pyramidLevel||0,i=t.headerInfo||S3e(e),{ifds:n,noData:s}=i;if(n.length===0)throw new Error("no valid image file directory");const o=vY(i);if(o)throw o;let a=null;const u=r===-1?n[n.length-1]:n[r],c=s??t.noDataValue;return a=i.tileWidth?await g3e(e,i,u):v3e(e,i,u),a&&(c!=null&&AP(a,c),a)}var A3e=function(e){var t,r,i,n,s,o;function a(u){var c,h,d,y,v,w,b,_,x,T,I,M,$;for(this.data=u,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},v=null;;){switch(c=this.readUInt32(),_=(function(){var A,R;for(R=[],A=0;A<4;++A)R.push(String.fromCharCode(this.data[this.pos++]));return R}).call(this).join(""),_){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(c);break;case"fcTL":v&&this.animation.frames.push(v),this.pos+=4,v={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},y=this.readUInt16(),d=this.readUInt16()||100,v.delay=1e3*y/d,v.disposeOp=this.data[this.pos++],v.blendOp=this.data[this.pos++],v.data=[];break;case"IDAT":case"fdAT":for(_==="fdAT"&&(this.pos+=4,c-=4),u=(v!=null?v.data:void 0)||this.imgData,I=0;0<=c?I<c:I>c;0<=c?++I:--I)u.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(this.transparency.indexed=this.read(c),(x=255-this.transparency.indexed.length)>0)for(M=0;0<=x?M<x:M>x;0<=x?++M:--M)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(c)[0];break;case 2:this.transparency.rgb=this.read(c)}break;case"tEXt":w=(T=this.read(c)).indexOf(0),b=String.fromCharCode.apply(String,T.slice(0,w)),this.text[b]=String.fromCharCode.apply(String,T.slice(w+1));break;case"IEND":return v&&this.animation.frames.push(v),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=($=this.colorType)===4||$===6,h=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*h,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=c}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}return a.load=function(u,c,h){var d;return typeof c=="function"&&(h=c),(d=new XMLHttpRequest).open("GET",u,!0),d.responseType="arraybuffer",d.onload=function(){var y;return y=new a(new Uint8Array(d.response||d.mozResponseArrayBuffer)),typeof(c!=null?c.getContext:void 0)=="function"&&y.render(c),typeof h=="function"?h(y):void 0},d.send(null)},r=1,i=2,t=0,a.prototype.read=function(u){var c,h;for(h=[],c=0;0<=u?c<u:c>u;0<=u?++c:--c)h.push(this.data[this.pos++]);return h},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(u){var c,h,d,y,v,w,b,_,x,T,I,M,$,A,R,L,C,U,F,j,q,K,X;if(u==null&&(u=this.imgData),u.length===0)return new Uint8Array(0);for(u=(u=new dw(u)).getBytes(),L=(M=this.pixelBitlength/8)*this.width,$=new Uint8Array(L*this.height),w=u.length,R=0,A=0,h=0;A<w;){switch(u[A++]){case 0:for(y=F=0;F<L;y=F+=1)$[h++]=u[A++];break;case 1:for(y=j=0;j<L;y=j+=1)c=u[A++],v=y<M?0:$[h-M],$[h++]=(c+v)%256;break;case 2:for(y=q=0;q<L;y=q+=1)c=u[A++],d=(y-y%M)/M,C=R&&$[(R-1)*L+d*M+y%M],$[h++]=(C+c)%256;break;case 3:for(y=K=0;K<L;y=K+=1)c=u[A++],d=(y-y%M)/M,v=y<M?0:$[h-M],C=R&&$[(R-1)*L+d*M+y%M],$[h++]=(c+Math.floor((v+C)/2))%256;break;case 4:for(y=X=0;X<L;y=X+=1)c=u[A++],d=(y-y%M)/M,v=y<M?0:$[h-M],R===0?C=U=0:(C=$[(R-1)*L+d*M+y%M],U=d&&$[(R-1)*L+(d-1)*M+y%M]),b=v+C-U,_=Math.abs(b-v),T=Math.abs(b-C),I=Math.abs(b-U),x=_<=T&&_<=I?v:T<=I?C:U,$[h++]=(c+x)%256;break;default:throw new Error("Invalid filter algorithm: "+u[A-1])}R++}return $},a.prototype.decodePalette=function(){var u,c,h,d,y,v,w,b,_;for(h=this.palette,v=this.transparency.indexed||[],y=new Uint8Array((v.length||0)+h.length),d=0,h.length,u=0,c=w=0,b=h.length;w<b;c=w+=3)y[d++]=h[c],y[d++]=h[c+1],y[d++]=h[c+2],y[d++]=(_=v[u++])!=null?_:255;return y},a.prototype.copyToImageData=function(u,c){var h,d,y,v,w,b,_,x,T,I,M;if(d=this.colors,T=null,h=this.hasAlphaChannel,this.palette.length&&(T=(M=this._decodedPalette)!=null?M:this._decodedPalette=this.decodePalette(),d=4,h=!0),x=(y=u.data||u).length,w=T||c,v=b=0,d===1)for(;v<x;)_=T?4*c[v/4]:b,I=w[_++],y[v++]=I,y[v++]=I,y[v++]=I,y[v++]=h?w[_++]:this.transparency.grayscale&&this.transparency.grayscale===I?0:255,b=_;else for(;v<x;)_=T?4*c[v/4]:b,y[v++]=w[_++],y[v++]=w[_++],y[v++]=w[_++],y[v++]=h?w[_++]:this.transparency.rgb&&this.transparency.rgb[1]===w[_-3]&&this.transparency.rgb[3]===w[_-2]&&this.transparency.rgb[5]===w[_-1]?0:255,b=_},a.prototype.decode=function(){var u;return u=new Uint8Array(this.width*this.height*4),this.copyToImageData(u,this.decodePixels()),u},s=e.document&&e.document.createElement("canvas"),o=s&&s.getContext("2d"),n=function(u){var c;return o.width=u.width,o.height=u.height,o.clearRect(0,0,u.width,u.height),o.putImageData(u,0,0),(c=new Image).src=s.toDataURL(),c},a.prototype.decodeFrames=function(u){var c,h,d,y,v,w,b,_;if(this.animation){for(_=[],h=v=0,w=(b=this.animation.frames).length;v<w;h=++v)c=b[h],d=u.createImageData(c.width,c.height),y=this.decodePixels(new Uint8Array(c.data)),this.copyToImageData(d,y),c.imageData=d,_.push(c.image=n(d));return _}},a.prototype.renderFrame=function(u,c){var h,d,y;return h=(d=this.animation.frames)[c],y=d[c-1],c===0&&u.clearRect(0,0,this.width,this.height),(y!=null?y.disposeOp:void 0)===r?u.clearRect(y.xOffset,y.yOffset,y.width,y.height):(y!=null?y.disposeOp:void 0)===i&&u.putImageData(y.imageData,y.xOffset,y.yOffset),h.blendOp===t&&u.clearRect(h.xOffset,h.yOffset,h.width,h.height),u.drawImage(h.image,h.xOffset,h.yOffset)},a.prototype.animate=function(u){var c,h,d,y,v,w,b=this;return h=0,w=this.animation,y=w.numFrames,d=w.frames,v=w.numPlays,(c=function(){var _,x;if(_=h++%y,x=d[_],b.renderFrame(u,_),y>1&&h/y<v)return b.animation._timeout=setTimeout(c,x.delay)})()},a.prototype.stopAnimation=function(){var u;return clearTimeout((u=this.animation)!=null?u._timeout:void 0)},a.prototype.render=function(u){var c,h;return u._png&&u._png.stopAnimation(),u._png=this,u.width=this.width,u.height=this.height,c=u.getContext("2d"),this.animation?(this.decodeFrames(c),this.animate(c)):(h=c.createImageData(this.width,this.height),this.copyToImageData(h,this.decodePixels()),c.putImageData(h,0,0))},a}(self);const R3e=new Set(["jpg","png","bmp","gif"]);async function C3e(e,t){if(!NP)throw new z("rasterCoded:decode","lerc decoder is not supported on big endian platform");await hY();const{offset:r}=t,{width:i,height:n,pixelType:s,statistics:o,depthCount:a,noDataValues:u,bandMasks:c,pixels:h,mask:d}=dY(e,{inputOffset:r,returnInterleaved:t.returnInterleaved}),y=new Ye({width:i,height:n,pixelType:s.toLowerCase(),pixels:h,mask:d,statistics:o,bandMasks:c,depthCount:a,noDataValues:u});return o!=null&&o.length||y.updateStatistics(),y}async function O3e(e,t){const r=await E3e(e,{...t,noDataValue:null});wp(r);const i=new Ye({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,bandMasks:r.bandMasks,statistics:null});return i.updateStatistics(),i}async function P3e(e,t){const r=await $3e(e,t.customOptions),i=new Ye({width:r.width,height:r.height,pixels:r.pixels,pixelType:r.pixelType.toLowerCase(),mask:r.mask,statistics:null});return i.updateStatistics(),i}function wY(e,t){const r=t.pixelType||"u8",i=Ye.getPixelArrayConstructor(r),n=r==="u8"?e:new i(e.buffer),s=[],o=t.planes||1;if(o===1)s.push(n);else for(let u=0;u<o;u++){const c=(t.width||1)*(t.height||e.length),h=new i(c);for(let d=0;d<c;d++)h[d]=n[d*o+u];s.push(h)}const a=new Ye({width:t.width||1,height:t.height||e.length,pixels:s,pixelType:r,statistics:null});return a.updateStatistics(),a}function L3e(e,t){return wY(new dw(new Uint8Array(e)).getBytes(),t)}function k3e(e,t){return wY(LP(e,t.offset,t.eof,!t.isInputBigEndian),t)}function N3e(e,t,r){const{pixelTypeCtor:i}=V3e(t.pixelType),n=(0,l3e.decode)(e,{width:t.width,height:t.height,pixelType:i,format:r}),s=new Ye({width:t.width,height:t.height,pixels:n.pixels,pixelType:t.pixelType,mask:n.mask,statistics:null});return s.updateStatistics(),s}function D3e(e,t){const r=r3e.decode(e,t.hasNoZlibMask??void 0),i=new Ye({width:r.width,height:r.height,pixels:r.pixels,pixelType:"U8",mask:r.mask,statistics:null});return i.updateStatistics(),i}function F3e(e,t){const r=new Uint8Array(e),i=new A3e(r),{width:n,height:s}=t,o=n*s,a=i.decode();let u,c=0,h=0;const d=new Uint8Array(o);for(c=0;c<o;c++)d[c]=a[4*c+3];const y=new Ye({width:n,height:s,pixels:[],pixelType:"U8",mask:d,statistics:[]});for(c=0;c<3;c++){for(u=new Uint8Array(o),h=0;h<o;h++)u[h]=a[4*h+c];y.addData({pixels:u})}return y.updateStatistics(),y}async function j3e(e,t,r,i){const n=new t3e,s={applyJpegMask:!1,format:t,...r},o=await n.decode(e,s,i),a=new Ye(o);return a.updateStatistics(),a}function bY(e){if(e==null)throw new z("rasterCodec:decode","parameter encodeddata is required.");const t=new Uint8Array(e,0,10);let r="";return t[0]===255&&t[1]===216?r="jpg":t[0]===137&&t[1]===80&&t[2]===78&&t[3]===71?r="png":t[0]===67&&t[1]===110&&t[2]===116&&t[3]===90&&t[4]===73&&t[5]===109&&t[6]===97&&t[7]===103&&t[8]===101&&t[9]===32?r="lerc":t[0]===76&&t[1]===101&&t[2]===114&&t[3]===99&&t[4]===50&&t[5]===32?r="lerc2":t[0]===73&&t[1]===73&&t[2]===42&&t[3]===0||t[0]===77&&t[1]===77&&t[2]===0&&t[3]===42||t[0]===73&&t[1]===73&&t[2]===43&&t[3]===0||t[0]===77&&t[1]===77&&t[2]===0&&t[3]===43?r="tiff":t[0]===71&&t[1]===73&&t[2]===70?r="gif":t[0]===66&&t[1]===77?r="bmp":String.fromCharCode.apply(null,t).toLowerCase().includes("error")&&(r="error"),r}function U3e(e){let t=null;switch(e){case"lerc":case"lerc2":t=C3e;break;case"jpg":t=D3e;break;case"png":t=F3e;break;case"bsq":case"bip":t=(r,i)=>N3e(r,i,e);break;case"tiff":t=O3e;break;case"deflate":t=L3e;break;case"lzw":t=k3e;break;case"error":t=()=>{throw new z("rasterCodec:decode","input data contains error")};break;default:t=()=>{throw new z("rasterCodec:decode","unsupported raster format")}}return t}function V3e(e){let t=null,r=null;switch(e?e.toLowerCase():"f32"){case"u1":case"u2":case"u4":case"u8":r=255,t=Uint8Array;break;case"u16":r=r||65535,t=Uint16Array;break;case"u32":r=r||2**32-1,t=Uint32Array;break;case"s8":r=r||-128,t=Int8Array;break;case"s16":r=r||-32768,t=Int16Array;break;case"s32":r=r||0-2**31,t=Int32Array;break;default:t=Float32Array}return{pixelTypeCtor:t,noDataValue:r}}function G3e(e,t=1){if(!e)return;const{pixels:r,width:i,height:n,mask:s}=e;if(!r||r.length===0)return;const o=r.length,a=i-1,u=n-1,c=[];let h,d,y,v,w,b,_=null;const x=Ye.getPixelArrayConstructor(e.pixelType);if(t===0){for(h=0;h<o;h++){for(w=r[h],b=new x(a*u),d=0;d<u;d++)for(v=d*i,y=0;y<a;y++)b[d*a+y]=w[v+y];c.push(b)}if(s!=null)for(_=new Uint8Array(a*u),d=0;d<u;d++)for(v=d*i,y=0;y<a;y++)_[d*a+y]=s[v+y]}else{for(h=0;h<o;h++){for(w=r[h],b=new x(a*u),d=0;d<u;d++)for(v=d*i,y=0;y<a;y++)b[d*a+y]=(w[v+y]+w[v+y+1]+w[v+i+y]+w[v+i+y+1])/4;c.push(b)}if(s)for(_=new Uint8Array(a*u),d=0;d<u;d++)for(v=d*i,y=0;y<a;y++)_[d*a+y]=Math.min.apply(null,[s[v+y],s[v+y+1],s[v+i+y],s[v+i+y+1]])}e.width=a,e.height=u,e.mask=_,e.pixels=c}function B3e(e){let t=bY(e);return t==="lerc2"?t="lerc":t==="error"&&(t=""),t}async function Zj(e,t={},r){var a;if(e==null)throw new z("rasterCodec:decode","missing encodeddata parameter.");let i=(a=t.format)==null?void 0:a.toLowerCase();if(!(i!=="bsq"&&i!=="bip"||t.width!=null&&t.height!=null))throw new z("rasterCodec:decode","requires width and height in options parameter.");if(i==="tiff"&&t.customOptions)return P3e(e,t);if((!i||i!=="bsq"&&i!=="bip"&&i!=="deflate"&&i!=="lzw")&&(i=bY(e)),t.useCanvas&&R3e.has(i))return j3e(e,i,t,r);const n=U3e(i);let s;t.isPoint&&((t={...t}).width!=null&&t.width++,t.height!=null&&t.height++);const{offsets:o}=t;if(o&&o.length>1){const u=o.map((d,y)=>n(e.slice(d,o[y+1]),t)),c=await Promise.all(u);s=c[0],s.pixels=c.map(d=>d.pixels[0]);const h=c.map(d=>d.mask);c.some(d=>d!=null)&&(h.forEach((d,y)=>{d==null&&(h[y]=new Uint8Array(s.width*s.height).fill(255))}),s.bandMasks=h,s.mask=Ye.combineBandMasks(h)),s.updateStatistics()}else s=await n(e,{...t,offset:(o==null?void 0:o[0])??t.offset});return i!=="jpg"&&t.noDataValue!=null&&s.depthCount===1&&AP(s,t.noDataValue,{customFloatTolerance:t.tolerance}),t.isPoint&&G3e(s),s}function z3e(e){var t,r,i;return["u8","s8"].includes(e.pixelType)&&((r=(t=e.statistics)==null?void 0:t[0])==null?void 0:r.min)!=null&&((i=e.statistics[0])==null?void 0:i.max)!=null&&e.bandCount===1}function UP(e,t){const{attributeTable:r,bandCount:i}=e;return r==null&&z3e(e)?!0:!(r==null||i>1||t&&r.fields.find(n=>n.name.toLowerCase()===t.toLowerCase())==null)}function _Y(e){const{bandCount:t,dataType:r,pixelType:i}=e;return r==="elevation"||r==="generic"&&t===1&&(i==="s16"||i==="s32"||i==="f32"||i==="f64")}function VP(e,t=!1){const{bandCount:r,colormap:i,pixelType:n}=e;return r===1&&(!!(i!=null&&i.length)||!t&&n==="u8")}function q3e(e,t=!1){const{attributeTable:r,bandCount:i}=e;return i===1&&(!t||r!=null||e.histograms!=null)}function GP(e){const{dataType:t}=e;return t==="vector-uv"||t==="vector-magdir"}function H3e(e){const{dataType:t}=e;return t==="vector-uv"||t==="vector-magdir"}const Yj=new We({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),Kj=new We({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let ca=class extends Q{constructor(t){super(t),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(t){this.classificationMethod==="standard-deviation"&&this._set("standardDeviationInterval",t)}set definedInterval(t){this.classificationMethod==="defined-interval"&&this._set("definedInterval",t)}};l([Ce({classBreaksDef:"class-breaks-definition"})],ca.prototype,"type",void 0),l([p({json:{write:!0}})],ca.prototype,"breakCount",void 0),l([p({json:{write:!0}})],ca.prototype,"classificationField",void 0),l([p({type:String,json:{read:Yj.read,write:Yj.write}})],ca.prototype,"classificationMethod",void 0),l([p({json:{write:!0}})],ca.prototype,"normalizationField",void 0),l([p({json:{read:Kj.read,write:Kj.write}})],ca.prototype,"normalizationType",void 0),l([p({value:null,json:{write:!0}})],ca.prototype,"standardDeviationInterval",null),l([p({value:null,json:{write:!0}})],ca.prototype,"definedInterval",null),ca=l([k("esri.rest.support.ClassBreaksDefinition")],ca);const b7e=ca,W3e=.25,J3e=OT.fromJSON({type:"multipart",colorRamps:[{fromColor:[0,0,255],toColor:[0,255,255]},{fromColor:[0,255,255],toColor:[255,255,0]},{fromColor:[255,255,0],toColor:[255,0,0]}]}),Xj=OT.fromJSON(MP[0]),SY=new Set(["scientific","standard-time","vector-uv","vector-magdir","vector-u","vector-v","vector-magnitude","vector-direction"]);function Z3e(e,t){const{attributeTable:r,colormap:i}=e;if(GP(e)){const n=sMe(e);if(n!=null)return n}if(i!=null){const n=iMe(e);if(n!=null)return n}if(r!=null){const n=tMe(e);if(n!=null)return n}return K3e(e,t)}function Y3e(e,t=!1){const r=["raster-stretch"];return VP(e,t)&&r.push("raster-colormap"),UP(e)&&r.push("unique-value"),q3e(e,t)&&r.push("class-breaks"),_Y(e)&&r.push("raster-shaded-relief"),GP(e)&&r.push("vector-field"),H3e(e)&&r.push("flow"),r}function _7e(e,t,r){const i=["nearest","bilinear","cubic","majority"].find(n=>n===(r==null?void 0:r.toLowerCase()));return t==="Map"?i??"bilinear":e.dataType==="standard-time"?i??"nearest":e.dataType==="thematic"||e.attributeTable||e.colormap?i==="nearest"||i==="majority"?i:"nearest":i??"bilinear"}function K3e(e,t){e=X3e(e,t==null?void 0:t.variableName);const{bandCount:r}=e;let{bandIds:i,stretchType:n}=t||{};i!=null&&i.some(d=>d>=r)&&(i=null);let s=e.statistics,o=e.histograms;r>1?(i=i!=null&&i.length?i:xY(e),s=s==null?null:i==null?void 0:i.map(d=>s[d]),o=o==null?null:i==null?void 0:i.map(d=>o[d])):i=[0],n==null&&(n=eMe(e));let a=!1;switch(n){case"none":a=!1;break;case"percent-clip":a=!(o!=null&&o.length);break;default:a=!(s!=null&&s.length)}const{dataType:u}=e,c=(i==null?void 0:i.length)===1&&SY.has(u)?J3e:null,h=new EP({stretchType:n,dynamicRangeAdjustment:a,colorRamp:c,outputMin:0,outputMax:255,gamma:(i==null?void 0:i.length)===1?[1]:[1,1,1],useGamma:!1});return n==="percent-clip"?h.maxPercent=h.minPercent=W3e:n==="standard-deviation"&&(h.numberOfStandardDeviations=2),a||e.multidimensionalInfo==null&&!(t!=null&&t.includeStatisticsInStretch)||(n==="percent-clip"?h.histograms=o:n!=="min-max"&&n!=="standard-deviation"||(h.statistics=s)),h}function X3e(e,t){const{multidimensionalInfo:r}=e;if(!t||!r)return e;const i=r.variables.find(n=>n.name===t);if(!i)return e;if(e=e.clone(),i){const{statistics:n,histograms:s}=i;n!=null&&n.length&&(e.statistics=n.map(o=>({min:o.min,max:o.max,avg:o.avg,stddev:o.stddev}))),s!=null&&s.length&&(e.histograms=s)}return e}function xY(e){const t=e.bandCount;if(t===1)return null;if(t===2)return[0];const{bandInfos:r}=e;let i;if(r.length===t){const{red:n,green:s,blue:o,nir:a}=Q3e(r);n!=null&&s!=null&&o!=null?i=[n,s,o]:a!=null&&n!=null&&s!=null&&(i=[a,n,s])}return!i&&t>=3&&(i=[0,1,2]),i}function Q3e(e){const t={};for(let r=0;r<e.length;r++){const i=e[r],n=i.name.toLowerCase();if(n==="red")t.red=r;else if(n==="green")t.green=r;else if(n==="blue")t.blue=r;else if(n==="nearinfrared"||n==="nearinfrared_1"||n==="nir")t.nir=r;else if(i.maxWavelength&&i.minWavelength){const s=i.minWavelength,o=i.maxWavelength;t.blue==null&&s>=410&&s<=480&&o>=480&&o<=540?t.blue=r:t.green==null&&s>=490&&s<=560&&o>=560&&o<=610?t.green=r:t.red==null&&s>=595&&s<=670&&o>=660&&o<=730?t.red=r:t.nir==null&&s>=700&&s<=860&&o>=800&&o<=950&&(t.nir=r)}}return t}function eMe(e){let t="percent-clip";const{pixelType:r,dataType:i,histograms:n,statistics:s,multidimensionalInfo:o}=e,a=SY.has(i)||i==="generic"&&o!=null;return r!=="u8"||i!=="processed"&&n!=null&&s!=null?r==="u8"||i==="elevation"||a?t="min-max":n!=null?t="percent-clip":s!=null&&(t="min-max"):t="none",t}function tMe(e,t,r,i){if(!UP(e,t))return null;const{attributeTable:n,statistics:s}=e,o=TY(n,t),a=z1(n,"red"),u=z1(n,"green"),c=z1(n,"blue"),h=new sw,d=[],y=new Set,v=!!(a&&u&&c);if(n!=null)n.features.forEach(w=>{const b=w.attributes[o.name];if(!y.has(w.attributes[o.name])&&b!=null){y.add(b);const _=v&&(a.type==="single"||a.type==="double")&&(u.type==="single"||u.type==="double")&&(c.type==="single"||c.type==="double")&&!n.features.some(T=>T.attributes[a.name]>1||T.attributes[u.name]>1||T.attributes[c.name]>1),x=_?255:1;d.push(new Yd({value:w.attributes[o.name],label:w.attributes[o.name]+"",symbol:{type:"simple-fill",style:"solid",outline:null,color:new ve(v?[w.attributes[a.name]*x,w.attributes[u.name]*x,w.attributes[c.name]*x,1]:[0,0,0,0])}}))}});else if(s!=null&&s[0])for(let w=s[0].min;w<=s[0].max;w++)d.push(new Yd({value:w,label:w.toString(),symbol:{type:"simple-fill",style:"solid",outline:null,color:new ve([0,0,0,0])}}));if(d.sort((w,b)=>w.value&&typeof w.value.valueOf()=="string"?0:w.value>b.value?1:-1),!v){const w=km(Xj,{numColors:d.length});d.forEach((b,_)=>b.symbol.color=new ve(w[_].slice(1,4))),h.colorRamp=Xj}return new s0({field:o.name,uniqueValueInfos:d,authoringInfo:h})}function TY(e,t,r){let i;return e!=null?(i=t?e.fields.find(n=>t.toLowerCase()===n.name.toLowerCase()):rMe(e.fields),i||(r||(i=e.fields.find(n=>n.type==="string")),i||(i=z1(e,"value")))):i=new Po({name:"value"}),i}function rMe(e){let t;for(let r=0;r<e.length;r++){const i=e[r].name.toLowerCase();if(e[r].type==="string"){if(i.startsWith("class")){t=e[r];break}t==null&&(i.endsWith("name")||i.endsWith("type"))&&(t=e[r])}}return t}function z1(e,t){return e==null?null:e.fields.find(r=>r.name.toLowerCase()===t)}function iMe(e){if(!VP(e))return null;let t;const{attributeTable:r,colormap:i}=e;if(r!=null){const n=z1(r,"value"),s=TY(r,null,!0);s.type==="string"&&(t={},r.features.forEach(o=>{const a=o.attributes;t[a[n.name]]=s?a[s.name]:a[n.name]}))}return $P.createFromColormap(i,t)}const nMe=new Map([["m/s","meter-per-second"],["km/h","kilometer-per-hour"],["knots","knots"],["ft/s","feet-per-second"],["mph","mile-per-hour"]]);function sMe(e){if(!GP(e))return null;let t;if(e.statistics!=null&&e.statistics.length&&(e.dataType==="vector-magdir"||e.dataType==="vector-uv")){const{minMagnitude:n,maxMagnitude:s}=aMe(e.dataType,e.statistics);t=[{type:"size",field:"Magnitude",minSize:10,maxSize:40,minDataValue:n,maxDataValue:s}]}const r=e.multidimensionalInfo!=null?nMe.get(e.multidimensionalInfo.variables[0].unit):null,i=new OP({visualVariables:t,inputUnit:r,rotationType:"geographic"});return i.visualVariables=[...i.sizeVariables,...i.rotationVariables],i}function Qj(e){var t;return{color:(t=e.symbolLayers[0].material)==null?void 0:t.color,type:"esriSFS",style:"esriSFSSolid"}}function oMe(e){var t,r;if(e.type==="uniqueValue"){const i=e.uniqueValueInfos,n=i==null?void 0:i[0].symbol;return(t=n==null?void 0:n.symbolLayers)!=null&&t.length&&(e.uniqueValueInfos=i==null?void 0:i.map(s=>({value:s.value,label:s.label,symbol:s.symbol?Qj(s.symbol):null}))),e}if(e.type==="classBreaks"){const i=e.classBreakInfos,n=i[0].symbol;return(r=n==null?void 0:n.symbolLayers)!=null&&r.length&&(e.classBreakInfos=i.map(s=>({classMinValue:s.classMinValue,classMaxValue:s.classMaxValue,label:s.label,symbol:s.symbol?Qj(s.symbol):null}))),e}return e}function aMe(e,t){let r,i;if(e==="vector-magdir")r=t[0].min,i=t[0].max;else{const n=t[0].min,s=t[0].max,o=t[1].min,a=t[1].max;r=0,i=Math.max(Math.abs(n),Math.abs(o),Math.abs(s),Math.abs(a))}return{minMagnitude:r,maxMagnitude:i}}const NM=1;function IY(e,t=256){t=Math.min(t,256);const{size:r,counts:i}=e,n=new Uint8Array(r),s=i.reduce((h,d)=>h+d/t,0);let o=0,a=0,u=0,c=s;for(let h=0;h<r;h++)if(u+=i[h],!(h<r-1&&u+i[h+1]<c)){for(;o<t-1&&c<u;)o++,c+=s;for(let d=a;d<=h;d++)n[d]=o;a=h+1}for(let h=a;h<r;h++)n[h]=t-1;return n}function e7(e){const{minCutOff:t,maxCutOff:r,gamma:i,pixelType:n,rounding:s}=e,o=e.outMin||0,a=e.outMax||255;if(!["u8","u16","s8","s16"].includes(n))return null;const u=t.length;let c,h,d=0;n==="s8"?d=-127:n==="s16"&&(d=-32767);let y=256;["u16","s16"].includes(n)&&(y=65536);const v=[],w=[],b=a-o;for(c=0;c<u;c++)w[c]=r[c]-t[c],v[c]=w[c]===0?0:b/w[c];let _;const x=[];let T,I,M;if(i&&i.length>=u){const $=MY(u,i);for(c=0;c<u;c++){for(M=[],h=0;h<y;h++)if(w[c]!==0)if(T=h+d,_=(T-t[c])/w[c],I=1,i[c]>1&&(I-=(1/b)**(_*$[c])),T<r[c]&&T>t[c]){const A=I*b*_**(1/i[c])+o;M[h]=s==="floor"?Math.floor(A):s==="round"?Math.round(A):A}else T>=r[c]?M[h]=a:M[h]=o;else M[h]=o;x[c]=M}}else for(c=0;c<u;c++){for(M=[],h=0;h<y;h++)if(T=h+d,T<=t[c])M[h]=o;else if(T>=r[c])M[h]=a;else{const $=(T-t[c])*v[c]+o;M[h]=s==="floor"?Math.floor($):s==="round"?Math.round($):$}x[c]=M}if(e.contrastOffset!=null){const $=lMe(e.contrastOffset,e.brightnessOffset);for(c=0;c<u;c++)for(M=x[c],h=0;h<y;h++)M[h]=$[M[h]]}return{lut:x,offset:d}}function lMe(e,t){const r=Math.min(Math.max(e,-100),100),i=Math.min(Math.max(t??0,-100),100),n=255,s=128;let o=0,a=0;const u=new Uint8Array(256);for(o=0;o<256;o++)r>0&&r<100?a=(200*o-100*n+2*n*i)/(2*(100-r))+s:r<=0&&r>-100?a=(200*o-100*n+2*n*i)*(100+r)/2e4+s:r===100?(a=200*o-100*n+(n+1)*(100-r)+2*n*i,a=a>0?n:0):r===-100&&(a=s),u[o]=a>n?n:a<0?0:a;return u}function uMe(e,t,r){const i=[];for(let n=0;n<t.length;n++){let s=0,o=0,a=0;"min"in t[n]?{min:s,max:o,avg:a}=t[n]:[s,o,a]=t[n];let u=a??0;e!=="u8"&&(u=255*(u-s)/(o-s)),i.push(cMe(u))}return i}function cMe(e){if(e<=0||e>=255)return NM;let t=0;e!==150&&(t=e<=150?45*Math.cos(.01047*e):17*Math.sin(.021*e));const r=255,i=e+t,n=Math.log(e/r),s=Math.log(i/r);if(s===0)return NM;const o=n/s;return isNaN(o)?NM:Math.min(9.9,Math.max(.01,o))}function pMe(e,t,r,i){let n=1/0,s=-1/0,o=0,a=0,u=0,c=0;const h=e.length,d=new Map,y=[];for(let R=0;R<h;R++){const L=e[R];if(!t||t[R]){y.push(L);const C=(d.get(L)??0)+1;d.set(L,C),C>c&&(c=C,u=L),n=L<n?L:n,s=L>s?L:s,o+=L,a++}}if(a===0)return{statistics:{min:0,max:0,avg:0,stddev:0,mode:0,median:0},histogram:null};const v=o/a;let w=0;for(let R=0;R<h;R++)t&&!t[R]||(w+=(e[R]-v)**2);const b=t?t.filter(R=>R).length:h,_=b<=1?0:Math.sqrt(w/(b-1));y.sort((R,L)=>R-L);const x=a>>>1,T={min:n,max:s,avg:v,stddev:_,mode:u,median:a%2?y[Math.floor(x)]:(y[x-1]+y[x])/2};if(["u8","s8","u4","u2","u1"].includes(r)){const R=s-n+1,L=new Uint32Array(R);for(let C=0;C<h;C++)t&&!t[C]||L[e[C]-n]++;return{statistics:T,histogram:{min:n-.5,max:s+.5,size:R,counts:L}}}const I=256,M=new Uint32Array(I),$=(s-n)/I;if($===0)return{statistics:T,histogram:{min:n,max:s,size:1,counts:new Uint32Array(1).fill(a)}};const A=new Uint32Array(I+1);for(let R=0;R<h;R++)t&&!t[R]||A[Math.floor((e[R]-n)/$)]++;for(let R=0;R<I-1;R++)M[R]=A[R];return M[I-1]=A[I-1]+A[I],{statistics:T,histogram:{min:n,max:s,size:I,counts:M}}}function S7e(e){const{pixels:t,mask:r,pixelType:i,bandMasks:n}=e,s=t.map((o,a)=>pMe(o,(n==null?void 0:n[a])??r,i));return{statistics:s.map(({statistics:o})=>o),histograms:s.map(({histogram:o})=>o)}}function hMe(e){var w;if(!((w=e==null?void 0:e.pixels)!=null&&w.length))return null;const{pixels:t,mask:r,bandMasks:i,pixelType:n}=e,s=e.width*e.height,o=t.length,a=[],u=[],c=256;let h,d,y,v;for(let b=0;b<o;b++){y=new Uint32Array(c);const _=t[b],x=(i==null?void 0:i[b])??r;if(n==="u8"){if(h=255,d=0,x){for(let j=0;j<s;j++)if(x[j]){const q=_[j];h=q<h?q:h,d=q>d?q:d,y[q]++}}else for(let j=0;j<s;j++){const q=_[j];h=q<h?q:h,d=q>d?q:d,y[q]++}y=y.slice(h,d+1)}else{let j=!1;e.statistics||(e.updateStatistics(),j=!0);const q=e.statistics;h=q[b].minValue,d=q[b].maxValue;const K=(d-h)/c;if(K===0){!q||e.validPixelCount||j||e.updateStatistics();const X=(e.validPixelCount||e.width*e.height)/c;for(let ne=0;ne<c;ne++)y[ne]=Math.round(X*(ne+1))-Math.round(X*ne)}else{v=new Uint32Array(c+1);for(let X=0;X<s;X++)x&&!x[X]||v[Math.floor((_[X]-h)/K)]++;for(let X=0;X<c-1;X++)y[X]=v[X];y[c-1]=v[c-1]+v[c]}}const T=n==="u8"?h-.5:h,I=n==="u8"?d+.5:d;a.push({min:T,max:I,size:y.length,counts:y});let M=0,$=0,A=0;for(let j=0;j<y.length;j++)M+=y[j],$+=j*y[j];const R=$/M;for(let j=0;j<y.length;j++)A+=y[j]*(j-R)**2;const L=Math.sqrt(A/(M-1)),C=(I-T)/y.length,U=(R+(n==="u8"?0:.5))*C+h,F=L*C;u.push({min:h,max:d,avg:U,stddev:F})}return{statistics:u,histograms:a}}function x7e(e){const t=[];for(let r=0;r<e.length;r++){const{min:i,max:n,size:s,counts:o}=e[r];let a=0,u=0;for(let w=0;w<s;w++)a+=o[w],u+=w*o[w];const c=u/a;let h=0;for(let w=0;w<s;w++)h+=o[w]*(w-c)**2;const d=(n-i)/s,y=(c+.5)*d+i,v=Math.sqrt(h/(a-1))*d;t.push({min:i,max:n,avg:y,stddev:v})}return t}function ig(e,t){var U;const{pixelBlock:r,bandIds:i,returnHistogramLut:n,rasterInfo:s}=t;let o=null,a=null,u=e.stretchType;if(typeof u=="number"&&(u=PZ[u]),e.dra)if(u==="minMax"&&(r!=null&&r.statistics))o=r.statistics.map(F=>[F.minValue,F.maxValue,0,0]);else{const F=hMe(r);o=F!=null?F.statistics:null,a=F!=null?F.histograms:null}else o=(U=e.statistics)!=null&&U.length?e.statistics:s.statistics,a="histograms"in e?e.histograms:void 0,a||(a=s.histograms);u!=="percentClip"&&u!=="histogramEqualization"||a!=null&&a.length||(u="minMax");const c=(o==null?void 0:o.length)||(a==null?void 0:a.length)||s.bandCount,h=[],d=[];let y,v,w,b,_,x,T,I,M;o&&!Array.isArray(o[0])&&(o=o.map(F=>[F.min,F.max,F.avg,F.stddev]));const[$,A]=o0(s.pixelType);if(!(o!=null&&o.length)){for(o=[],I=0;I<c;I++)o.push([$,A,1,1]);u==="standardDeviation"&&(u="minMax")}switch(u){case"none":for(I=0;I<c;I++)h[I]=$,d[I]=A;break;case"minMax":for(I=0;I<c;I++){const F=o[I];h[I]=F[0],d[I]=F[1]}break;case"standardDeviation":{const{numberOfStandardDeviations:F=2}=e;for(I=0;I<c;I++){const j=o[I];h[I]=j[2]-F*j[3],d[I]=j[2]+F*j[3],h[I]<j[0]&&(h[I]=j[0]),d[I]>j[1]&&(d[I]=j[1])}}break;case"histogramEqualization":for(wp(a),I=0;I<c;I++)h[I]=a[I].min,d[I]=a[I].max;break;case"percentClip":for(wp(a),I=0;I<a.length;I++){for(y=a[I],_=new Uint32Array(y.size),b=[...y.counts],b.length>=20&&(b[0]=b[1]=b[2]=b[b.length-1]=b[b.length-2]=0),w=0,v=(y.max-y.min)/y.size,T=y.min===-.5&&v===1?.5:0,M=0;M<y.size;M++)w+=b[M],_[M]=w;for(x=(e.minPercent||0)*w/100,h[I]=y.min+T,M=0;M<y.size;M++)if(_[M]>x){h[I]=y.min+v*(M+T);break}for(x=(1-(e.maxPercent||0)/100)*w,d[I]=y.max+T,M=y.size-2;M>=0;M--)if(_[M]<x){d[I]=y.min+v*(M+2-T);break}if(d[I]<h[I]){const F=h[I];h[I]=d[I],d[I]=F}}break;default:for(I=0;I<c;I++){const F=o[I];h[I]=F[0],d[I]=F[1]}}let R,L,C;return u==="histogramEqualization"?(wp(a),L=a[0].size||256,R=0,n&&(C=a.map(F=>IY(F)))):(L=e.max||255,R=e.min||0),dMe({minCutOff:h,maxCutOff:d,outMax:L,outMin:R,histogramLut:C},i)}function dMe(e,t){if(t==null||t.length===0)return e;const r=Math.max.apply(null,t),{minCutOff:i,maxCutOff:n,outMin:s,outMax:o,histogramLut:a}=e;return i.length===t.length||i.length<=r?e:{minCutOff:t.map(u=>i[u]),maxCutOff:t.map(u=>n[u]),histogramLut:a?t.map(u=>a[u]):null,outMin:s,outMax:o}}function MY(e,t){const r=new Float32Array(e);for(let i=0;i<e;i++)t[i]>1?t[i]>2?r[i]=6.5+(t[i]-2)**2.5:r[i]=6.5+100*(2-t[i])**4:r[i]=1;return r}function DM(e,t){var R;if(!((R=e==null?void 0:e.pixels)!=null&&R.length))return e;const{mask:r,bandMasks:i,width:n,height:s,pixels:o}=e,{minCutOff:a,maxCutOff:u,gamma:c}=t,h=t.outMin||0,d=t.outMax||255,y=n*s,v=t.outputPixelType||"u8",w=e.pixels.map(()=>Ye.createEmptyBand(v,y)),b=w.length,_=d-h,x=[],T=[];for(let L=0;L<b;L++)T[L]=u[L]-a[L],x[L]=T[L]===0?0:_/T[L];const I=v.startsWith("u")||v.startsWith("s"),M=c&&c.length>=b,$=!!t.isRenderer;if(M){const L=MY(b,c);for(let C=0;C<b;C++){const U=(i==null?void 0:i[C])??r;for(let F=0;F<y;F++)if(U==null||U[F]){if(T[C]===0){w[C][F]=h;continue}const j=o[C][F],q=(j-a[C])/T[C];let K=1;if(c[C]>1&&(K-=(1/_)**(q*L[C])),j<u[C]&&j>a[C]){const X=K*_*q**(1/c[C])+h;w[C][F]=$?Math.floor(X):I?Math.round(X):X}else j>=u[C]?w[C][F]=d:w[C][F]=h}}}else for(let L=0;L<b;L++){const C=(i==null?void 0:i[L])??r;for(let U=0;U<y;U++)if(C==null||C[U]){const F=o[L][U];if(F<u[L]&&F>a[L]){const j=(F-a[L])*x[L]+h;w[L][U]=$?Math.floor(j):I?Math.round(j):j}else F>=u[L]?w[L][U]=d:w[L][U]=h}}const A=new Ye({width:n,height:s,mask:r,bandMasks:i,pixels:w,pixelType:v});return A.updateStatistics(),A}const $n=1,Wy=1/111e3;function $Y(e){let{altitude:t,azimuth:r}=e;const{hillshadeType:i,pixelSizePower:n=1,pixelSizeFactor:s=1,scalingType:o,isGCS:a,resolution:u}=e,c=i==="multi-directional"?2*e.zFactor:e.zFactor,{x:h,y:d}=u;let y=c/(8*h),v=c/(8*d);if(a&&c>.001&&(y/=Wy,v/=Wy),o==="adjusted")if(a){const j=h*Wy,q=d*Wy;y=(c+j**n*s)/(8*j),v=(c+q**n*s)/(8*q)}else y=(c+h**n*s)/(8*h),v=(c+d**n*s)/(8*d);let w=(90-t)*Math.PI/180,b=Math.cos(w),_=(360-r+90)*Math.PI/180,x=Math.sin(w)*Math.cos(_),T=Math.sin(w)*Math.sin(_);const I=[315,270,225,360,180,0],M=[60,60,60,60,60,90],$=new Float32Array([3,5,3,2,1,4]),A=$.reduce((j,q)=>j+q),R=$.map(j=>j/A),L=i==="multi-directional"?I.length:1,C=new Float32Array(6),U=new Float32Array(6),F=new Float32Array(6);if(i==="multi-directional")for(let j=0;j<L;j++)t=M[j],r=I[j],w=(90-t)*Math.PI/180,b=Math.cos(w),_=(360-r+90)*Math.PI/180,x=Math.sin(w)*Math.cos(_),T=Math.sin(w)*Math.sin(_),C[j]=b,U[j]=x,F[j]=T;else C.fill(b),U.fill(x),F.fill(T);return{resolution:u,factor:[y,v],sinZcosA:x,sinZsinA:T,cosZ:b,sinZcosAs:U,sinZsinAs:F,cosZs:C,weights:R,hillshadeType:["traditional","multi-directional"].indexOf(i)}}function qT(e,t){const{width:r,height:i}=e,n=r*i,s=new Uint8Array(n),o=e.mask!=null;let a;if(o){a=new Uint8Array(e.mask);for(let A=0;A<a.length;A++)a[A]&&(s[A]=1,a[A]=1)}const u=e.pixels[0],c=new Float32Array(n),h=new Float32Array(n);let d,y=0;if(t){const{resolution:A}=t,R=A?(A.x+A.y)/2:1;y=200*t.zFactor/(R*R),d=new Float32Array(n)}const v=t==null?void 0:t.curvatureType;let w,b,_,x,T,I,M,$;for(let A=$n;A<i-$n;A++){const R=A*r;for(let L=$n;L<r-$n;L++){const C=R+L;if(!a||a[C]!==0){if(a){if(a[C-r-1]+a[C-r]+a[C-r+1]+a[C-1]+a[C+1]+a[C+r-1]+a[C+r]+a[C+r+1]<7){s[C]=0;continue}w=a[C-r-1]?u[C-r-1]:u[C],b=a[C-r]?u[C-r]:u[C],_=a[C-r+1]?u[C-r+1]:u[C],x=a[C-1]?u[C-1]:u[C],T=a[C+1]?u[C+1]:u[C],I=a[C+r-1]?u[C+r-1]:u[C],M=a[C+r]?u[C+r]:u[C],$=a[C+r+1]?u[C+r+1]:u[C]}else w=u[C-r-1],b=u[C-r],_=u[C-r+1],x=u[C-1],T=u[C+1],I=u[C+r-1],M=u[C+r],$=u[C+r+1];if(c[C]=_+T+T+$-(w+x+x+I),h[C]=I+M+M+$-(w+b+b+_),d!=null){const U=u[C],F=.5*(x+T)-U,j=.5*(b+M)-U;if(v==="standard")d[C]=-y*(F+j);else{const q=(-w+_+I-$)/4,K=(-x+T)/2,X=(b-M)/2,ne=K*K,re=X*X,ae=ne+re;ae&&(d[C]=v==="profile"?y*(F*ne+j*re+q*K*X)/ae:-y*(F*re+j*ne-q*K*X)/ae)}}}}}return{outMask:o?s:null,dzxs:c,dzys:h,curvatures:d}}function HT(e,t,r){for(let i=0;i<r;i++)e[i*t]=e[i*t+1],e[(i+1)*t-1]=e[(i+1)*t-2];for(let i=1;i<t-1;i++)e[i]=e[i+t],e[i+(r-1)*t]=e[i+(r-2)*t]}function fMe(e,t){if(!nr(e))return e;const{factor:r,sinZcosA:i,sinZsinA:n,cosZ:s,sinZcosAs:o,sinZsinAs:a,cosZs:u,weights:c}=$Y(t),[h,d]=r,y=t.hillshadeType==="traditional",{width:v,height:w}=e,b=new Uint8Array(v*w),{dzxs:_,dzys:x,outMask:T}=qT(e);for(let I=$n;I<w-$n;I++){const M=I*v;for(let $=$n;$<v-$n;$++){const A=M+$;if(!T||T[A]){const R=_[A]*h,L=x[A]*d,C=Math.sqrt(1+R*R+L*L);let U=0;if(y){let F=255*(s+n*L-i*R)/C;F<0&&(F=0),U=F}else{const F=a.length;for(let j=0;j<F;j++){let q=255*(u[j]+a[j]*L-o[j]*R)/C;q<0&&(q=0),U+=q*c[j]}}b[A]=255&U}}}return HT(b,v,w),new Ye({width:v,height:w,pixels:[b],mask:T,pixelType:"u8",validPixelCount:e.validPixelCount,statistics:[{minValue:0,maxValue:255}]})}function yMe(e,t,r,i){if(!nr(e)||!nr(t))return;const{min:n,max:s}=i,o=e.pixels[0],{pixels:a,mask:u}=t,c=a[0],h=255.00001/(s-n),d=new Uint8ClampedArray(c.length),y=new Uint8ClampedArray(c.length),v=new Uint8ClampedArray(c.length),w=r.length-1;for(let b=0;b<c.length;b++){if(u&&u[b]===0)continue;const _=Math.floor((c[b]-n)*h),[x,T]=r[_<0?0:_>w?w:_],I=o[b],M=I*T,$=M*(1-Math.abs(x%2-1)),A=I-M;switch(Math.floor(x)){case 0:d[b]=M+A,y[b]=$+A,v[b]=A;break;case 1:d[b]=$+A,y[b]=M+A,v[b]=A;break;case 2:d[b]=A,y[b]=M+A,v[b]=$+A;break;case 3:d[b]=A,y[b]=$+A,v[b]=M+A;break;case 4:d[b]=$+A,y[b]=A,v[b]=M+A;break;case 5:case 6:d[b]=M+A,y[b]=A,v[b]=$+A}}e.pixels=[d,y,v],e.updateStatistics()}function T7e(e,t){if(!nr(e))return e;const r=t.zFactor,i=t.pixelSizePower??1,n=t.pixelSizeFactor??1,s=t.slopeType,o=t.isGCS,{x:a,y:u}=t.resolution;let c=r/(8*a),h=r/(8*u);o&&Math.abs(r-1)<1e-4&&(c/=Wy,h/=Wy),s==="adjusted"&&(c=(r+a**i*n)/(8*a),h=(r+u**i*n)/(8*u));const{dzxs:d,dzys:y,outMask:v}=qT(e),{width:w,height:b}=e,_=new Float32Array(w*b);for(let T=$n;T<b-$n;T++){const I=T*w;for(let M=$n;M<w-$n;M++){const $=I+M;if(!v||v[$]){const A=d[$]*c,R=y[$]*h,L=Math.sqrt(A*A+R*R);_[I+M]=s==="percent-rise"?100*L:57.2957795*Math.atan(L)}}}HT(_,w,b);const x=new Ye({width:w,height:b,pixels:[_],mask:v,pixelType:"f32",validPixelCount:e.validPixelCount});return x.updateStatistics(),x}function I7e(e,t={}){if(!nr(e))return e;const{resolution:r}=t,i=r?1/r.x:1,n=r?1/r.y:1,{dzxs:s,dzys:o,outMask:a}=qT(e),{width:u,height:c}=e,h=new Float32Array(u*c);for(let d=$n;d<c-$n;d++){const y=d*u;for(let v=$n;v<u-$n;v++){const w=y+v;if(!a||a[w]){const b=s[w]*i,_=o[w]*n;let x=-1;b===0&&_===0||(x=90-57.29578*Math.atan2(_,-b),x<0&&(x+=360),x===360?x=0:x>360&&(x%=360)),h[y+v]=x}}}return HT(h,u,c),new Ye({width:u,height:c,pixels:[h],mask:a,pixelType:"f32",validPixelCount:e.validPixelCount,statistics:[{minValue:-1,maxValue:360}]})}function M7e(e,t){if(!nr(e))return e;const{curvatures:r,outMask:i}=qT(e,t),{width:n,height:s}=e;HT(r,n,s);const o=new Ye({width:n,height:s,pixels:[r],mask:i,pixelType:"f32",validPixelCount:e.validPixelCount});return o.updateStatistics(),o}let ed=class extends Q{constructor(t){super(t)}bind(){const{rendererJSON:t}=this;if(!t)return{success:!1};let r;switch(this.lookup={rendererJSON:{}},t.type){case"uniqueValue":r=this._updateUVRenderer(t);break;case"rasterColormap":r=this._updateColormapRenderer(t);break;case"rasterStretch":r=this._updateStretchRenderer(t);break;case"classBreaks":r=this._updateClassBreaksRenderer(t);break;case"rasterShadedRelief":r=this._updateShadedReliefRenderer(t);break;case"vectorField":r=this._updateVectorFieldRenderer();break;case"flowRenderer":r=this._updateFlowRenderer()}return r}symbolize(t){let r=t==null?void 0:t.pixelBlock;if(!t7(r))return r;if(t.simpleStretchParams&&this.rendererJSON.type==="rasterStretch")return this.simpleStretch(r,t.simpleStretchParams);try{let i;switch(r.pixels.length>3&&(r=r.extractBands(t.bandIds??[0,1,2])),this.rendererJSON.type){case"uniqueValue":case"rasterColormap":i=this._symbolizeColormap(r);break;case"classBreaks":i=this._symbolizeClassBreaks(r);break;case"rasterStretch":i=this._symbolizeStretch(r,t.bandIds);break;case"rasterShadedRelief":{const n=t.extent,s=n.spatialReference.isGeographic,o={x:(n.xmax-n.xmin)/r.width,y:(n.ymax-n.ymin)/r.height};i=this._symbolizeShadedRelief(r,{isGCS:s,resolution:o});break}}return i}catch(i){return oe.getLogger(this).error("symbolize",i.message),r}}simpleStretch(t,r){if(!t7(t))return t;try{return t.pixels.length>3&&(t=t.extractBands([0,1,2])),DM(t,{...r,isRenderer:!0})}catch(i){return oe.getLogger(this).error("symbolize",i.message),t}}generateWebGLParameters(t){if(["uniqueValue","rasterColormap","classBreaks"].includes(this.rendererJSON.type)){const{indexedColormap:a,offset:u}=this.lookup.colormapLut||{};return{colormap:a,colormapOffset:u,type:"lut"}}const{pixelBlock:r,isGCS:i,resolution:n,bandIds:s}=t,{rendererJSON:o}=this;return o.type==="rasterStretch"?this._generateStretchWebGLParams(r,o,s):o.type==="rasterShadedRelief"?this._generateShadedReliefWebGLParams(o,i,n??void 0):o.type==="vectorField"?this._generateVectorFieldWebGLParams(o):null}_isLUTChanged(t){if(!this.lookup||!this.lookup.rendererJSON)return!0;if("colorRamp"in this.rendererJSON){const r=this.rendererJSON.colorRamp;return t?JSON.stringify(r)!==JSON.stringify(this.lookup.rendererJSON.colorRamp):(this.rendererJSON,this.lookup.rendererJSON,JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON))}return JSON.stringify(this.rendererJSON)!==JSON.stringify(this.lookup.rendererJSON)}_symbolizeColormap(t){return this._isLUTChanged()&&!this.bind().success?t:MM(t,this.lookup.colormapLut)}_symbolizeClassBreaks(t){const{canUseIndexedLUT:r}=this._analyzeClassBreaks(this.rendererJSON);return this._isLUTChanged()&&!this.bind().success?t:r?MM(t,this.lookup.colormapLut):_Te(t,this.lookup.remapLut??[])}_symbolizeStretch(t,r){var y,v;const{rasterInfo:i}=this,{pixelType:n,bandCount:s}=i,o=this.rendererJSON,a=["u8","u16","s8","s16"].includes(n);let u,c;const{dra:h}=o,{gamma:d}=this.lookup;if(o.stretchType==="histogramEqualization"){const w=h?null:(y=this.lookup)==null?void 0:y.histogramLut,b=ig(o,{rasterInfo:i,pixelBlock:t,bandIds:r,returnHistogramLut:!w}),_=DM(t,{...b,gamma:d,isRenderer:!0});c=wj(_,{lut:h?b.histogramLut:w,offset:0})}else if(a){if(h){const w=ig(o,{rasterInfo:i,pixelBlock:t,bandIds:r});u=e7({pixelType:n,...w,gamma:d,rounding:"floor"})}else if(this._isLUTChanged()){if(!this.bind().success)return t;u=this.lookup?this.lookup.stretchLut:null}else u=this.lookup?this.lookup.stretchLut:null;if(!u)return t;s>1&&r!=null&&r.length===(t==null?void 0:t.pixels.length)&&(u==null?void 0:u.lut.length)===s&&(u={lut:r.map(w=>u.lut[w]),offset:u.offset}),c=wj(t,u)}else{const w=ig(o,{rasterInfo:i,pixelBlock:t,bandIds:r});c=DM(t,{...w,gamma:d,isRenderer:!0})}if(o.colorRamp){if(this._isLUTChanged(!0)&&!this.bind().success)return t;c=MM(c,(v=this.lookup)==null?void 0:v.colormapLut)}return c}_symbolizeShadedRelief(t,r){var u;const i=this.rendererJSON,n={...i,...r},s=fMe(t,n);if(!i.colorRamp)return s;let o;if(this._isLUTChanged(!0)){if(!this.bind().success)return s;o=this.lookup?this.lookup.hsvMap:null}else o=this.lookup?this.lookup.hsvMap:null;if(!o)return s;const a=((u=this.rasterInfo.statistics)==null?void 0:u[0])??{min:0,max:8e3};return yMe(s,t,o,a),s}_isVectorFieldData(){const{bandCount:t,dataType:r}=this.rasterInfo;return t===2&&(r==="vector-magdir"||r==="vector-uv")}_updateVectorFieldRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; VectorFieldRenderer only supports "vector-magdir" and "vector-uv".`}}_updateFlowRenderer(){return this._isVectorFieldData()?{success:!0}:{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; FlowRenderer only supports "vector-magdir" and "vector-uv".`}}_updateUVRenderer(t){var h;const{bandCount:r,attributeTable:i,pixelType:n}=this.rasterInfo,s=t.field1;if(!s)return{success:!1,error:"Unsupported renderer; missing UniqueValueRenderer.field."};const o=t.defaultSymbol,a=r===1&&["u8","s8"].includes(n);if(!UP(this.rasterInfo,s)&&!a)return{success:!1,error:"Unsupported data; UniqueValueRenderer is only supported on single band data with a valid raster attribute table."};const u=[];if(i!=null){const d=i.fields.find(y=>y.name.toLowerCase()==="value");if(!d)return{success:!1,error:"Unsupported data; the data's raster attribute table does not have a value field."};i.features.forEach(y=>{var b,_;const v=(b=t.uniqueValueInfos)==null?void 0:b.find(x=>String(x.value)===String(y.attributes[s])),w=(_=v==null?void 0:v.symbol)==null?void 0:_.color;w?u.push([y.attributes[d.name]].concat(w)):o&&u.push([y.attributes[d.name]].concat(o.color))})}else{if(s.toLowerCase()!=="value")return{success:!1,error:'Unsupported renderer; UniqueValueRenderer.field must be "Value" when raster attribute table is not availalbe.'};(h=t.uniqueValueInfos)==null||h.forEach(d=>{var v;const y=(v=d==null?void 0:d.symbol)==null?void 0:v.color;y?u.push([parseInt(""+d.value,10)].concat(y)):o&&u.push([parseInt(""+d.value,10)].concat(o==null?void 0:o.color))})}if(u.length===0)return{success:!1,error:"Invalid UniqueValueRenderer. Cannot find matching records in the raster attribute table."};const c=K0({colormap:u});return this.lookup={rendererJSON:t,colormapLut:c},this.canRenderInWebGL=this._isColormapSupportedByWebGL(c==null?void 0:c.indexedColormap),{success:!0}}_updateColormapRenderer(t){if(!VP(this.rasterInfo))return{success:!1,error:"Unsupported data; the data source does not have a colormap."};const r=t.colormapInfos.map(n=>[n.value].concat(n.color)).sort((n,s)=>n[0]-s[0]);if(!r||r.length===0)return{success:!1,error:"Unsupported renderer; ColormapRenderer must have meaningful colormapInfos."};const i=K0({colormap:r});return this.lookup={rendererJSON:t,colormapLut:i},this.canRenderInWebGL=this._isColormapSupportedByWebGL(i==null?void 0:i.indexedColormap),{success:!0}}_updateShadedReliefRenderer(t){if(!_Y(this.rasterInfo))return{success:!1,error:`Unsupported data type "${this.rasterInfo.dataType}"; ShadedReliefRenderer only supports "elevation", or single band float/s16 data.`};if(t.colorRamp){const r=km(t.colorRamp,{interpolateAlpha:!0}),i=K0({colormap:r}),n=[],s=i.indexedColormap;for(let o=0;o<s.length;o+=4){const a=hx({r:s[o],g:s[o+1],b:s[o+2]});n.push([a.h/60,a.s/100,255*a.v/100])}this.lookup={rendererJSON:t,colormapLut:i,hsvMap:n}}else this.lookup=null;return this.canRenderInWebGL=!0,{success:!0}}_analyzeClassBreaks(t){const{attributeTable:r,pixelType:i}=this.rasterInfo,n=r!=null?r.fields.find(a=>a.name.toLowerCase()==="value"):null,s=r!=null?r.fields.find(a=>a.name.toLowerCase()===t.field.toLowerCase()):null,o=n!=null&&s!==null;return{canUseIndexedLUT:["u8","u16","s8","s16"].includes(i)||o,tableValueField:n,tableBreakField:s}}_updateClassBreaksRenderer(t){const{attributeTable:r}=this.rasterInfo,{canUseIndexedLUT:i,tableValueField:n,tableBreakField:s}=this._analyzeClassBreaks(t),o=t.classBreakInfos;if(!(o!=null&&o.length))return{success:!1,error:"Unsupported renderer; missing or invalid ClassBreaksRenderer.classBreakInfos."};const a=o.sort((y,v)=>y.classMaxValue-v.classMaxValue),u=a[a.length-1];let c=t.minValue;if(!i){const y=[];for(let v=0;v<a.length;v++)y.push({value:a[v].classMinValue??c,mappedColor:a[v].symbol.color}),c=a[v].classMaxValue;return y.push({value:u.classMaxValue,mappedColor:u.symbol.color}),this.lookup={rendererJSON:t,remapLut:y},this.canRenderInWebGL=!1,{success:!0}}const h=[];if(r!=null&&n!=null&&s!==null&&n!==s){const y=n.name,v=s.name,w=a[a.length-1],{classMaxValue:b}=w;c=t.minValue;for(const _ of r.features){const x=_.attributes[y],T=_.attributes[v],I=T===b?w:T<c?null:a.find(({classMaxValue:M})=>M>T);I&&h.push([x].concat(I.symbol.color))}}else{c=Math.floor(t.minValue);for(let y=0;y<a.length;y++){const v=a[y];for(let w=c;w<v.classMaxValue;w++)h.push([w].concat(v.symbol.color));c=Math.ceil(v.classMaxValue)}u.classMaxValue===c&&h.push([u.classMaxValue].concat(u.symbol.color))}const d=K0({colormap:h,fillUnspecified:!1});return this.lookup={rendererJSON:t,colormapLut:d},this.canRenderInWebGL=this._isColormapSupportedByWebGL(d==null?void 0:d.indexedColormap),{success:!0}}_isColormapSupportedByWebGL(t){return!!(t!=null&&t.length)&&t.length<=16384}_isHistogramRequired(t){return t==="percentClip"||t==="histogramEqualization"}_isValidRasterStatistics(t){return t!=null&&t.length>0&&t[0].min!=null&&t[0].max!=null}_updateStretchRenderer(t){var d,y;let{stretchType:r,dra:i}=t;if(!(r==="none"||(d=t.statistics)!=null&&d.length||this._isValidRasterStatistics(this.rasterInfo.statistics)||i))return{success:!1,error:"Unsupported renderer; StretchRenderer.statistics is required when dynamic range adjustment is not used."};const n=t.histograms||this.rasterInfo.histograms;!this._isHistogramRequired(t.stretchType)||n!=null&&n.length||i||(r="minMax");const{computeGamma:s,useGamma:o,colorRamp:a}=t;let{gamma:u}=t;if(o&&s&&!(u!=null&&u.length)){const v=(y=t.statistics)!=null&&y.length?t.statistics:this.rasterInfo.statistics;u=uMe(this.rasterInfo.pixelType,v)}const c=this.rasterInfo.pixelType,h=!i&&["u8","u16","s8","s16"].includes(c);if(r==="histogramEqualization"){const v=n.map(w=>IY(w));this.lookup={rendererJSON:t,histogramLut:v}}else if(h){const v=ig(t,{rasterInfo:this.rasterInfo}),w=e7({pixelType:c,...v,gamma:o?u:null,rounding:"floor"});this.lookup={rendererJSON:t,stretchLut:w}}if(a&&!this._isStretchColorRampNoop(a)){const v=km(a,{interpolateAlpha:!0});this.lookup||(this.lookup={rendererJSON:t}),this.lookup.colormapLut=K0({colormap:v}),this.lookup.rendererJSON=t}return this.lookup.gamma=o&&(u!=null&&u.length)?u:null,this.canRenderInWebGL=!0,{success:!0}}_isStretchColorRampNoop(t){return t.type==="algorithmic"&&["0,0,0,255","0,0,0"].includes(t.fromColor.join(","))&&["255,255,255,255","255,255,255"].includes(t.toColor.join(","))}_generateStretchWebGLParams(t,r,i){var M;let n=null,s=null;const o=(M=this.lookup)==null?void 0:M.colormapLut;r.colorRamp&&o&&(n=o.indexedColormap,s=o.offset),r.stretchType==="histogramEqualization"&&(r={...r,stretchType:"minMax"});const{gamma:a}=this.lookup,u=!!(r.useGamma&&a&&a.some($=>$!==1)),{minCutOff:c,maxCutOff:h,outMin:d,outMax:y}=ig(r,{rasterInfo:this.rasterInfo,pixelBlock:t,bandIds:i});let v=0;t!=null&&(v=t.getPlaneCount(),v===2&&((t=t.clone()).statistics=[t.statistics[0]],t.pixels=[t.pixels[0]]));const{bandCount:w}=this.rasterInfo,b=Math.min(3,(i==null?void 0:i.length)||v||w,w),_=new Float32Array(b),x=n||u?1:255;let T;for(T=0;T<c.length;T++)_[T]=h[T]===c[T]?0:(y-d)/(h[T]-c[T])/x;const I=new Float32Array(b);if(u&&a)for(T=0;T<b;T++)a[T]>1?a[T]>2?I[T]=6.5+(a[T]-2)**2.5:I[T]=6.5+100*(2-a[T])**4:I[T]=1;return{bandCount:b,outMin:d/x,outMax:y/x,minCutOff:c,maxCutOff:h,factor:_,useGamma:u,gamma:u?a:[1,1,1],gammaCorrection:u?I:[1,1,1],colormap:n,colormapOffset:s,stretchType:r.stretchType,type:"stretch"}}_generateShadedReliefWebGLParams(t,r=!1,i={x:0,y:0}){var h,d;let n=null,s=null;const o=(h=this.lookup)==null?void 0:h.colormapLut;t.colorRamp&&o&&(n=o.indexedColormap,s=o.offset);const a={...t,isGCS:r,resolution:i},u=$Y(a),c=(d=this.rasterInfo.statistics)==null?void 0:d[0];return{...u,minValue:(c==null?void 0:c.min)??0,maxValue:(c==null?void 0:c.max)??8e3,hillshadeType:t.hillshadeType==="traditional"?0:1,type:"hillshade",colormap:n,colormapOffset:s}}_generateVectorFieldWebGLParams(t){var T,I,M;const{style:r,inputUnit:i,outputUnit:n,visualVariables:s,symbolTileSize:o,flowRepresentation:a}=t;let u;const c=((T=this.rasterInfo.statistics)==null?void 0:T[0].min)??0,h=((I=this.rasterInfo.statistics)==null?void 0:I[0].max)??50,d=(s==null?void 0:s.find($=>$.type==="sizeInfo"))??{type:"sizeInfo",field:"Magnitude",maxDataValue:h,maxSize:.8*o,minDataValue:c,minSize:.2*o},y=d.minDataValue??c,v=d.maxDataValue??h,w=d.maxSize!=null&&d.minSize!=null?[d.minSize/o,d.maxSize/o]:[.2,.8];if(r==="wind_speed"){const $=(w[0]+w[1])/2;w[0]=w[1]=$}const b=y!=null&&v!=null?[y,v]:null;if(r==="classified_arrow")if(y!=null&&v!=null&&d!=null){u=[];const $=(d.maxDataValue-d.minDataValue)/5;for(let A=0;A<6;A++)u.push(d.minDataValue+$*A)}else u=[0,1e-6,3.5,7,10.5,14];const _=a==="flow_to"==(r==="ocean_current_kn"||r==="ocean_current_m")?0:Math.PI,x=s==null?void 0:s.find($=>$.type==="rotationInfo");return{breakValues:u,dataRange:b,inputUnit:i,outputUnit:n,symbolTileSize:o,symbolPercentRange:w,style:r||"single_arrow",rotation:_,rotationType:(M=this.rasterInfo.storageInfo)!=null&&M.tileInfo&&this.rasterInfo.dataType==="vector-uv"?"geographic":(x==null?void 0:x.rotationType)||t.rotationType,type:"vectorField"}}};function t7(e){return nr(e)&&e.validPixelCount!==0}l([p({json:{write:!0}})],ed.prototype,"rendererJSON",void 0),l([p({type:GT,json:{write:!0}})],ed.prototype,"rasterInfo",void 0),l([p({json:{write:!0}})],ed.prototype,"lookup",void 0),l([p()],ed.prototype,"canRenderInWebGL",void 0),ed=l([k("esri.renderers.support.RasterSymbolizer")],ed);const mMe=ed,EY=e=>{let t=class extends e{constructor(){super(...arguments),this.make=null,this.model=null,this.focalLength=null,this.pixelSize=null,this.rows=null,this.cols=null}};return l([p({json:{write:!0}})],t.prototype,"make",void 0),l([p({json:{write:!0}})],t.prototype,"model",void 0),l([p({json:{write:!0}})],t.prototype,"focalLength",void 0),l([p({json:{write:!0}})],t.prototype,"pixelSize",void 0),l([p({json:{write:!0}})],t.prototype,"rows",void 0),l([p({json:{write:!0}})],t.prototype,"cols",void 0),t=l([k("esri.rest.support.CameraInfoMixin")],t),t};let pa=class extends EY(Q){constructor(){super(...arguments),this.id=null,this.referenceUri=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.perspectiveCenter=null,this.orientation=null}writeAcquisitionDate(t,r){r.acquisitionDate=t==null?void 0:t.getTime()}};l([p({json:{write:!0}})],pa.prototype,"id",void 0),l([p({json:{name:"uri",write:!0}})],pa.prototype,"referenceUri",void 0),l([p({type:Date,json:{write:!0}})],pa.prototype,"acquisitionDate",void 0),l([se("acquisitionDate")],pa.prototype,"writeAcquisitionDate",null),l([p({json:{write:!0}})],pa.prototype,"cameraID",void 0),l([p({type:Ae,json:{write:!0}})],pa.prototype,"center",void 0),l([p({type:Ae,json:{write:!0}})],pa.prototype,"perspectiveCenter",void 0),l([p({json:{write:!0}})],pa.prototype,"orientation",void 0),pa=l([k("esri.rest.support.ImageInspectionInfo")],pa);const gMe=pa;let V2=class extends Q{constructor(){super(...arguments),this.images=null}};l([p({type:[gMe],json:{write:!0}})],V2.prototype,"images",void 0),V2=l([k("esri.rest.support.FindImagesResult")],V2);const vMe=V2;let vy=class extends Q{constructor(t){super(t),this.north=null,this.up=null,this.spatialReference=null}};l([p({type:Number,json:{write:!0}})],vy.prototype,"north",void 0),l([p({type:Number,json:{write:!0}})],vy.prototype,"up",void 0),l([p({type:xe,json:{write:!0}})],vy.prototype,"spatialReference",void 0),vy=l([k("esri.rest.support.ImageAngleResult")],vy);const wMe=vy;let pp=class extends Q{constructor(){super(...arguments),this.value=null,this.displayValue=null,this.uncertainty=null}};l([p({type:Number,json:{read:!0,write:!0}})],pp.prototype,"value",void 0),l([p({type:String,json:{read:!0,write:!0}})],pp.prototype,"displayValue",void 0),l([p({type:Number,json:{read:!0,write:!0}})],pp.prototype,"uncertainty",void 0),pp=l([k("esri.rest.support.ImageMeasureResultValue")],pp);let um=class extends pp{constructor(){super(...arguments),this.unit=null}};l([p({type:String,json:{read:Gu.read,write:Gu.write}})],um.prototype,"unit",void 0),um=l([k("esri.rest.support.ImageMeasureResultLengthValue")],um);let G2=class extends pp{constructor(){super(...arguments),this.unit=null}};l([p({type:String,json:{read:ov.read,write:ov.write}})],G2.prototype,"unit",void 0),G2=l([k("esri.rest.support.ImageMeasureResultAreaValue")],G2);let q1=class extends pp{constructor(){super(...arguments),this.unit=null}};l([p({type:String,json:{read:zS.read,write:zS.write}})],q1.prototype,"unit",void 0),q1=l([k("esri.rest.support.ImageMeasureResultAngleValue")],q1);let mp=class extends Q{constructor(){super(...arguments),this.name=null,this.sensorName=null}};l([p({type:String,json:{read:!0,write:!0}})],mp.prototype,"name",void 0),l([p({type:String,json:{read:!0,write:!0}})],mp.prototype,"sensorName",void 0),mp=l([k("esri.rest.support.BaseImageMeasureResult")],mp);let e1=class extends mp{constructor(){super(...arguments),this.area=null,this.perimeter=null}};l([p({type:G2,json:{read:!0,write:!0}})],e1.prototype,"area",void 0),l([p({type:um,json:{read:!0,write:!0}})],e1.prototype,"perimeter",void 0),e1=l([k("esri.rest.support.ImageAreaResult")],e1);const bMe=e1;let wy=class extends Q{constructor(){super(...arguments),this.area=null,this.geometry=null}readGeometry(t,r){return t==null?null:t.rings?Ss.fromJSON(t):Ne.fromJSON(t)}};l([p({type:Number,json:{write:!0}})],wy.prototype,"area",void 0),l([p({json:{name:"shape",write:!0}})],wy.prototype,"geometry",void 0),l([te("geometry")],wy.prototype,"readGeometry",null),wy=l([k("esri.rest.support.ImageBoundaryResult")],wy);const _Me=wy;let by=class extends mp{constructor(){super(...arguments),this.distance=null,this.azimuthAngle=null,this.elevationAngle=null}};l([p({type:um,json:{read:!0,write:!0}})],by.prototype,"distance",void 0),l([p({type:q1,json:{read:!0,write:!0}})],by.prototype,"azimuthAngle",void 0),l([p({type:q1,json:{read:!0,write:!0}})],by.prototype,"elevationAngle",void 0),by=l([k("esri.rest.support.ImageDistanceResult")],by);const SMe=by;let B2=class extends EY(Q){constructor(){super(...arguments),this.id=null}};l([p({json:{write:!0}})],B2.prototype,"id",void 0),B2=l([k("esri.rest.support.CameraInfo")],B2);const xMe=B2;let ha=class extends Q{constructor(){super(...arguments),this.id=null,this.name=null,this.acquisitionDate=null,this.cameraID=null,this.center=null,this.gps=null,this.orientation=null}writeAcquisitionDate(t,r){r.acquisitionDate=t==null?void 0:t.getTime()}};l([p({json:{write:!0}})],ha.prototype,"id",void 0),l([p({json:{write:!0}})],ha.prototype,"name",void 0),l([p({type:Date,json:{write:!0}})],ha.prototype,"acquisitionDate",void 0),l([se("acquisitionDate")],ha.prototype,"writeAcquisitionDate",null),l([p({json:{write:!0}})],ha.prototype,"cameraID",void 0),l([p({type:Ae,json:{write:!0}})],ha.prototype,"center",void 0),l([p({json:{write:!0}})],ha.prototype,"gps",void 0),l([p({json:{write:!0}})],ha.prototype,"orientation",void 0),ha=l([k("esri.rest.support.ImageGPSInfo")],ha);const TMe=ha;let t1=class extends Q{constructor(){super(...arguments),this.images=null,this.cameras=null}};l([p({type:[TMe],json:{write:!0}})],t1.prototype,"images",void 0),l([p({type:[xMe],json:{write:!0}})],t1.prototype,"cameras",void 0),t1=l([k("esri.rest.support.ImageGPSInfoResult")],t1);const IMe=t1;let z2=class extends mp{constructor(){super(...arguments),this.height=null}};l([p({type:um,json:{read:!0,write:!0}})],z2.prototype,"height",void 0),z2=l([k("esri.rest.support.ImageHeightResult")],z2);const MMe=z2;let da=class extends Q{constructor(){super(...arguments),this.catalogItemVisibilities=null,this.catalogItems=null,this.location=null,this.name=null,this.objectId=null,this.processedValues=null,this.properties=null,this.value=null}};l([p({json:{write:!0}})],da.prototype,"catalogItemVisibilities",void 0),l([p({type:Tf,json:{write:!0}})],da.prototype,"catalogItems",void 0),l([p({type:Ae,json:{write:!0}})],da.prototype,"location",void 0),l([p({json:{write:!0}})],da.prototype,"name",void 0),l([p({json:{write:!0}})],da.prototype,"objectId",void 0),l([p({json:{write:!0}})],da.prototype,"processedValues",void 0),l([p({json:{write:!0}})],da.prototype,"properties",void 0),l([p({json:{write:!0}})],da.prototype,"value",void 0),da=l([k("esri.rest.support.ImageIdentifyResult")],da);const $Me=da;let q2=class extends Q{constructor(){super(...arguments),this.geometries=null}};l([p({json:{write:!0}})],q2.prototype,"geometries",void 0),q2=l([k("esri.rest.support.ImagePixelLocationResult")],q2);const EMe=q2;let H2=class extends mp{constructor(){super(...arguments),this.point=null}};l([p({type:Ae,json:{name:"point.value",read:!0,write:!0}})],H2.prototype,"point",void 0),H2=l([k("esri.rest.support.ImagePointResult")],H2);const AMe=H2;let du=class extends Q{constructor(){super(...arguments),this.attributes=null,this.location=null,this.locationId=null,this.rasterId=null,this.resolution=null,this.pixelValue=null}};l([p({json:{write:!0}})],du.prototype,"attributes",void 0),l([p({type:Ae,json:{write:!0}})],du.prototype,"location",void 0),l([p({json:{write:!0}})],du.prototype,"locationId",void 0),l([p({json:{write:!0}})],du.prototype,"rasterId",void 0),l([p({json:{write:!0}})],du.prototype,"resolution",void 0),l([p({json:{write:!0}})],du.prototype,"pixelValue",void 0),du=l([k("esri.rest.support.ImageSample")],du);const RMe=du;let W2=class extends Q{constructor(){super(...arguments),this.samples=null}};l([p({type:[RMe],json:{write:!0}})],W2.prototype,"samples",void 0),W2=l([k("esri.rest.support.ImageSampleResult")],W2);const CMe=W2;let J2=class extends Q{constructor(){super(...arguments),this.url=null}};l([p({json:{name:"imageURL",write:!0}})],J2.prototype,"url",void 0),J2=l([k("esri.rest.support.ImageUrlResult")],J2);const OMe=J2;let Gc=class extends Q{constructor(){super(...arguments),this.geometry=null,this.length=null,this.area=null,this.center=null}readCenter(t,r){return t.spatialReference||(t={...t,spatialReference:r.Shape.spatialReference}),Ae.fromJSON(t)}};l([p({types:Vi,json:{name:"Shape",read:Xr,write:!0}})],Gc.prototype,"geometry",void 0),l([p({json:{name:"Length",write:!0}})],Gc.prototype,"length",void 0),l([p({json:{name:"Area",write:!0}})],Gc.prototype,"area",void 0),l([p({json:{name:"Center",write:!0}})],Gc.prototype,"center",void 0),l([te("center")],Gc.prototype,"readCenter",null),Gc=l([k("esri.rest.support.MeasureAreaFromImageResult")],Gc);const PMe=Gc;let r1=class extends Q{constructor(){super(...arguments),this.geometry=null,this.length=null}};l([p({types:Vi,json:{name:"Shape",read:Xr,write:!0}})],r1.prototype,"geometry",void 0),l([p({json:{name:"Length",write:!0}})],r1.prototype,"length",void 0),r1=l([k("esri.rest.support.MeasureLengthFromImageResult")],r1);const LMe=r1;function BP(e){const t=e==null?void 0:e.time;if(t&&(t.start!=null||t.end!=null)){const r=[];t.start!=null&&r.push(t.start),t.end==null||r.includes(t.end)||r.push(t.end),e.time=r.join(",")}}async function AY(e,t,r){const i=pr(e),n=t.geometry?[t.geometry]:[],s=await Nl(n),o=t.toJSON();BP(o);const a=s==null?void 0:s[0];a!=null&&(o.geometry=Ol(a));const u=tn({...i.query,f:"json",...o});return Cn(u,r)}async function kMe(e,t,r){var u,c,h;const i=t.toJSON();i.angleName!=null&&(i.angleName=i.angleName.join(",")),(c=(u=t==null?void 0:t.point)==null?void 0:u.spatialReference)!=null&&c.imageCoordinateSystem&&(i.point.spatialReference=JT(t.point.spatialReference)),(h=t==null?void 0:t.spatialReference)!=null&&h.imageCoordinateSystem&&(i.spatialReference=a0(t.spatialReference));const n=pr(e),s=tn({...n.query,f:"json",...i}),o=Cn(s,r),{data:a}=await be(`${n.path}/computeAngles`,o);return a.spatialReference=a.spatialReference?a.spatialReference.geodataXform!=null?new xe({wkid:0,imageCoordinateSystem:a.spatialReference}):xe.fromJSON(a.spatialReference):null,a.north==="NaN"&&(a.north=null),a.up==="NaN"&&(a.up=null),new wMe(a)}async function NMe(e,t,r){var c;const i=t.toJSON(),{geometries:n}=t;if(n)for(let h=0;h<n.length;h++)(c=n[h].spatialReference)!=null&&c.imageCoordinateSystem&&(i.geometries.geometries[h].spatialReference=JT(n[h].spatialReference));const s=pr(e),o=tn({...s.query,f:"json",...i}),a=Cn(o,r),{data:u}=await be(`${s.path}/computePixelLocation`,a);return EMe.fromJSON(u)}async function DMe(e,t,r){const i=await AY(e,t,r),n=pr(e),{data:s}=await be(`${n.path}/computeStatisticsHistograms`,i),{statistics:o}=s;return o!=null&&o.length&&o.forEach(a=>{a.avg=a.mean,a.stddev=a.standardDeviation}),{statistics:o,histograms:s.histograms}}async function FMe(e,t,r){const i=await AY(e,t,r),n=pr(e),{data:s}=await be(`${n.path}/computeHistograms`,i);return{histograms:s.histograms}}async function jMe(e,t,r){var d,y;const i=t.toJSON();BP(i),(d=i.outFields)!=null&&d.length&&(i.outFields=i.outFields.join(","));const n=await Nl(t.geometry),s=n==null?void 0:n[0];s!=null&&(i.geometry=Ol(s));const o=pr(e),a=tn({...o.query,f:"json",...i}),u=Cn(a,r),{data:c}=await be(`${o.path}/getSamples`,u),h=(y=c==null?void 0:c.samples)==null?void 0:y.map(v=>{const w=v.value==="NaN"||v.value===""?null:v.value.split(" ").map(b=>Number(b));return{...v,pixelValue:w}});return CMe.fromJSON({samples:h})}async function r7(e,t,r){const i=pr(e),n=t.geometry?[t.geometry]:[];return Nl(n).then(s=>{const o=t.toJSON(),a=s==null?void 0:s[0];a!=null&&(o.geometry=JSON.stringify(Ol(a)));const u=tn({...i.query,f:"json",...o}),c=Cn(u,r);return be(i.path+"/identify",c)}).then(s=>$Me.fromJSON(s.data))}async function UMe(e,t,r){const i=await WT(e,t,[t.fromGeometry,t.toGeometry],r);return MMe.fromJSON(i)}async function VMe(e,t,r){const i=await WT(e,t,[t.geometry],r);return bMe.fromJSON(i)}async function GMe(e,t,r){const i=await WT(e,t,[t.geometry],r);return AMe.fromJSON(i)}async function BMe(e,t,r){const i=await WT(e,t,[t.fromGeometry,t.toGeometry],r);return SMe.fromJSON(i)}async function WT(e,t,r,i){const n=pr(e),s=await Nl(r),o=t.toJSON();s[0]!=null&&(o.fromGeometry=JSON.stringify(Ol(s[0]))),s[1]!=null&&(o.toGeometry=JSON.stringify(Ol(s[1])));const a=tn({...n.query,f:"json",...o}),u=Cn(a,i),{data:c}=await be(n.path+"/measure",u);return c}async function zMe(e,t,r){const i=await RY(e,t,r);return LMe.fromJSON(i)}async function qMe(e,t,r){const i=await RY(e,t,r);return PMe.fromJSON(i)}async function RY(e,t,r){const i=pr(e),n=t.toJSON(),s=tn({...i.query,f:"json",...n}),o=Cn(s,r),{data:a}=await be(i.path+"/measureFromImage",o);return a}function Ol(e){var r;const t=e.toJSON();return(r=e.spatialReference)!=null&&r.imageCoordinateSystem&&(t.spatialReference=JT(e.spatialReference)),t}function JT(e){const{imageCoordinateSystem:t}=e;if(t){const{id:r,referenceServiceName:i}=t;return r!=null?i?{icsid:r,icsns:i}:{icsid:r}:{ics:t}}return e.toJSON()}function a0(e,t){if(!e.imageCoordinateSystem)return Ip(e);const r=JT(e),{icsid:i,icsns:n}=r;return i==null||n!=null&&!(t!=null&&t.toLowerCase().includes("/"+n.toLowerCase()+"/"))?JSON.stringify(r):`0:${i}`}async function HMe(e,t,r){const i=pr(e),n=t.toJSON();t.outSpatialReference&&(n.outSR=a0(t.outSpatialReference));const s=tn({...i.query,f:"json",...n}),o=Cn(s,r),{data:a}=await be(i.path+"/queryBoundary",o);return _Me.fromJSON(a)}async function WMe(e,t,r){var d,y;const i=t.toJSON();BP(i),(d=i.objectIds)!=null&&d.length&&(i.objectIds=i.objectIds.join(",")),i.geometry||i.objectIds||i.time||i.where||(i.where="1=1");const n=await Nl(t.geometry),s=n==null?void 0:n[0];s!=null&&(i.geometry=Ol(s));const o=(s==null?void 0:s.spatialReference)??((y=t.geometry)==null?void 0:y.spatialReference);o&&(i.inSR=a0(o));const a=pr(e),u=tn({...a.query,f:"json",...i}),c=Cn(u,r),{data:h}=await be(`${a.path}/queryGPSInfo`,c);return IMe.fromJSON(h)}async function JMe(e,t,r){const i=t.toJSON();t.geometry.spatialReference.imageCoordinateSystem&&(i.geometry=Ol(t.geometry)),t.depthOffset&&t.adjust||delete i.options;const n=pr(e),s=tn({...n.query,f:"json",...i}),o=Cn(s,r),{data:a}=await be(`${n.path}/imageToMap`,o);return Xr(a)}async function ZMe(e,t,r){var u;const i=t.toJSON();(u=t.rasterIds)!=null&&u.length&&(i.rasterIds=t.rasterIds.join(","));const n=pr(e),s=tn({...n.query,f:"json",...i}),o=Cn(s,r),{data:a}=await be(`${n.path}/imageToMapMultiray`,o);return Xr(a)}async function YMe(e,t,r){var d;const i=t.toJSON(),n=await Nl(t.geometry),s=n==null?void 0:n[0];s!=null&&(i.geometry=Ol(s)),t.visibleOnly||delete i.options;const o=(s==null?void 0:s.spatialReference)??((d=t.geometry)==null?void 0:d.spatialReference);o&&(i.inSR=a0(o));const a=pr(e),u=tn({...a.query,f:"json",...i}),c=Cn(u,r),{data:h}=await be(`${a.path}/mapToImage`,c);return Xr(h)}async function KMe(e,t,r){const i=t.toJSON(),n=pr(e),s=tn({...n.query,f:"json",...i}),o=Cn(s,r),{data:a}=await be(`${n.path}/getImageUrl`,o);return OMe.fromJSON(a)}async function XMe(e,t,r){var c;const i=t.toJSON(),n=await Nl([t.fromGeometry,t.toGeometry]);n[0]!=null&&(i.fromGeometry=Ol(n[0]),n[0].spatialReference&&(i.inSR=a0(n[0].spatialReference))),n[1]!=null&&(i.toGeometry=Ol(n[1])),(c=t.objectIds)!=null&&c.length&&(i.objectIds=i.objectIds.join(","));const s=pr(e),o=tn({...s.query,f:"json",...i}),a=Cn(o,r),{data:u}=await be(`${s.path}/find`,a);return vMe.fromJSON(u)}function QMe(e){const{exifInfo:t,exifName:r,tagName:i}=e;if(!t||!r||!i)return null;const n=t.find(s=>s.name===r);return n?e$e({tagName:i,tags:n.tags}):null}function e$e(e){const{tagName:t,tags:r}=e;if(!r||!t)return null;const i=r.find(n=>n.name===t);return(i==null?void 0:i.value)||null}var GR;const t$e={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let hs=GR=class extends Q{constructor(e){super(e),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:e}=this,t=QMe({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:e});return t$e[t]||null}clone(){return new GR({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};l([p({type:String})],hs.prototype,"contentType",void 0),l([p()],hs.prototype,"exifInfo",void 0),l([p({readOnly:!0})],hs.prototype,"orientationInfo",null),l([p({type:Ke})],hs.prototype,"id",void 0),l([p({type:String})],hs.prototype,"globalId",void 0),l([p({type:String})],hs.prototype,"keywords",void 0),l([p({type:String})],hs.prototype,"name",void 0),l([p({json:{read:!1}})],hs.prototype,"parentGlobalId",void 0),l([p({json:{read:!1}})],hs.prototype,"parentObjectId",void 0),l([p({type:Ke})],hs.prototype,"size",void 0),l([p({json:{read:!1}})],hs.prototype,"url",void 0),hs=GR=l([k("esri.layers.support.AttachmentInfo")],hs);const K7e=hs;var BR;let _r=BR=class extends Q{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&this.where==null&&(t.definitionExpression="1=1")}clone(){return new BR(B({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};l([p({type:Boolean,json:{write:!0}})],_r.prototype,"cacheHint",void 0),l([p({type:Wn,json:{write:!0}})],_r.prototype,"dynamicDataSource",void 0),l([p({type:String,json:{write:!0}})],_r.prototype,"gdbVersion",void 0),l([p({type:Number,json:{write:!0}})],_r.prototype,"geometryPrecision",void 0),l([p({type:Date})],_r.prototype,"historicMoment",void 0),l([se("historicMoment")],_r.prototype,"_writeHistoricMoment",null),l([p({type:Number,json:{write:!0}})],_r.prototype,"maxAllowableOffset",void 0),l([p({type:[Number],json:{write:!0}})],_r.prototype,"objectIds",void 0),l([p({type:[String],json:{write:!0}})],_r.prototype,"orderByFields",void 0),l([p({type:[String],json:{write:!0}})],_r.prototype,"outFields",void 0),l([p({type:xe,json:{read:{source:"outSR"},write:{target:"outSR"}}})],_r.prototype,"outSpatialReference",void 0),l([p({json:{write:!0}})],_r.prototype,"relationshipId",void 0),l([p({type:Number,json:{read:{source:"resultOffset"}}})],_r.prototype,"start",void 0),l([se("start"),se("num")],_r.prototype,"writeStart",null),l([p({type:Number,json:{read:{source:"resultRecordCount"}}})],_r.prototype,"num",void 0),l([p({json:{write:!0}})],_r.prototype,"returnGeometry",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_r.prototype,"returnM",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],_r.prototype,"returnZ",void 0),l([p({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],_r.prototype,"where",void 0),_r=BR=l([k("esri.rest.support.RelationshipQuery")],_r),_r.from=Lr(_r);const zP=_r,i7=Object.freeze(Object.defineProperty({__proto__:null,default:zP},Symbol.toStringTag,{value:"Module"}));var zR;let _y=zR=class extends Q{constructor(e){super(e),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new zR({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};l([p({type:[String],json:{write:!0}})],_y.prototype,"groupByFields",void 0),l([p({type:Number,json:{write:!0}})],_y.prototype,"topCount",void 0),l([p({type:[String],json:{write:!0}})],_y.prototype,"orderByFields",void 0),_y=zR=l([k("esri.rest.support.TopFilter")],_y);const r$e=_y;var qR;const n7=new We({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),s7=new We({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let lr=qR=class extends Q{constructor(e){super(e),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new qR(B({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};l([p({type:Boolean,json:{write:!0}})],lr.prototype,"cacheHint",void 0),l([p({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],lr.prototype,"distance",void 0),l([p({types:Vi,json:{read:Xr,write:!0}})],lr.prototype,"geometry",void 0),l([p({type:Number,json:{write:!0}})],lr.prototype,"geometryPrecision",void 0),l([p({type:Number,json:{write:!0}})],lr.prototype,"maxAllowableOffset",void 0),l([p({type:Number,json:{read:{source:"resultRecordCount"}}})],lr.prototype,"num",void 0),l([p({json:{write:!0}})],lr.prototype,"objectIds",void 0),l([p({type:[String],json:{write:!0}})],lr.prototype,"orderByFields",void 0),l([p({type:[String],json:{write:!0}})],lr.prototype,"outFields",void 0),l([p({type:xe,json:{read:{source:"outSR"},write:{target:"outSR"}}})],lr.prototype,"outSpatialReference",void 0),l([p({type:String,json:{write:!0}})],lr.prototype,"resultType",void 0),l([p({json:{write:!0}})],lr.prototype,"returnGeometry",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],lr.prototype,"returnM",void 0),l([p({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],lr.prototype,"returnZ",void 0),l([p({type:Number,json:{read:{source:"resultOffset"}}})],lr.prototype,"start",void 0),l([se("start"),se("num")],lr.prototype,"writeStart",null),l([p({type:String,json:{read:{source:"spatialRel",reader:n7.read},write:{target:"spatialRel",writer:n7.write}}})],lr.prototype,"spatialRelationship",void 0),l([p({type:is,json:{write:!0}})],lr.prototype,"timeExtent",void 0),l([p({type:r$e,json:{write:!0}})],lr.prototype,"topFilter",void 0),l([p({type:String,json:{read:s7.read,write:{writer:s7.write,overridePolicy(e){return{enabled:e!=null&&this.distance!=null&&this.distance>0}}}}})],lr.prototype,"units",void 0),l([p({type:String,json:{write:!0}})],lr.prototype,"where",void 0),lr=qR=l([k("esri.rest.support.TopFeaturesQuery")],lr),lr.from=Lr(lr);const p_=lr;async function CY(e,t,r){var re,ae,he,de,fe,Se,Ee,Fe,ht,Lt;const i=pr(e),{rasterFunction:n,sourceJSON:s}=t||{},o=n?JSON.stringify(n.rasterFunctionDefinition||n):null,a=tn({...i.query,renderingRule:o,f:"json"}),u=Cn(a,r);e=i.path;const c=s||await be(e,u).then(Nt=>Nt.data),h=c.hasRasterAttributeTable?be(`${e}/rasterAttributeTable`,u):null,d=c.hasColormap?be(`${e}/colormap`,u):null,y=c.hasHistograms?be(`${e}/histograms`,u):null,v=c.currentVersion>=10.3?be(`${e}/keyProperties`,u):null,w=c.hasMultidimensions?be(`${e}/multidimensionalInfo`,u):null,b=await Promise.allSettled([h,d,y,v,w]);let _=null;if(c.minValues&&c.minValues.length===c.bandCount){_=[];for(let Nt=0;Nt<c.minValues.length;Nt++)_.push({min:c.minValues[Nt],max:c.maxValues[Nt],avg:c.meanValues[Nt],stddev:c.stdvValues[Nt]})}const x=Ne.fromJSON(c.extent),T=Math.ceil(x.width/c.pixelSizeX-.1),I=Math.ceil(x.height/c.pixelSizeY-.1),M=xe.fromJSON(c.spatialReference||c.extent.spatialReference),$=b[0].status==="fulfilled"?(re=b[0].value)==null?void 0:re.data:null,A=(ae=$==null?void 0:$.features)!=null&&ae.length?Tf.fromJSON($):null,R=b[1].status==="fulfilled"?(he=b[1].value)==null?void 0:he.data.colormap:null,L=R!=null&&R.length?R:null,C=b[2].status==="fulfilled"?(de=b[2].value)==null?void 0:de.data.histograms:null,U=(Se=(fe=C==null?void 0:C[0])==null?void 0:fe.counts)!=null&&Se.length?C:null,F=b[3].status==="fulfilled"?((Ee=b[3].value)==null?void 0:Ee.data)??{}:{},j=b[4].status==="fulfilled"?(Fe=b[4].value)==null?void 0:Fe.data.multidimensionalInfo:null,q=(ht=j==null?void 0:j.variables)!=null&&ht.length?j:null;q&&q.variables.forEach(Nt=>{var Ir;(Ir=Nt.statistics)!=null&&Ir.length&&Nt.statistics.forEach(st=>{st.avg=st.mean,st.stddev=st.standardDeviation})});const{defaultVariable:K,serviceDataType:X}=c;K&&K!==F.DefaultVariable&&(F.DefaultVariable=K),X!=null&&X.includes("esriImageServiceDataTypeVector")&&!X.includes(F.DataType)&&(F.DataType=X.replace("esriImageServiceDataType",""));let ne=c.noDataValue;return(Lt=c.noDataValues)!=null&&Lt.length&&c.noDataValues.some(Nt=>Nt!==ne)&&(ne=c.noDataValues),new GT({width:T,height:I,bandCount:c.bandCount,extent:Ne.fromJSON(c.extent),spatialReference:M,pixelSize:new Ae({x:c.pixelSizeX,y:c.pixelSizeY,spatialReference:M}),pixelType:c.pixelType.toLowerCase(),statistics:_,attributeTable:A,colormap:L,histograms:U,keyProperties:F,noDataValue:ne,multidimensionalInfo:q})}function i$e(e,t,r){return CY(e,{sourceJSON:t},r)}function n$e(e,t,r){return CY(e,{rasterFunction:t},r)}function s$e(e,t){e.attributeTable||(t.hasRasterAttributeTable=!1),e.histograms||(t.hasHistograms=!1),e.colormap||(t.hasColormap=!1),e.multidimensionalInfo||(t.hasMultidimensions=!1)}async function o$e(e,t,r){var M,$;const i=pr(e),n=tn({...i==null?void 0:i.query,f:"json"}),s=Cn(n,r),o=`${i==null?void 0:i.path}/${t}/info`,a=be(`${o}`,s),u=be(`${o}/keyProperties`,s),c=await Promise.allSettled([a,u]),h=c[0].status==="fulfilled"?c[0].value.data:null,d=c[1].status==="fulfilled"?c[1].value.data:null;let y=null;(M=h.statistics)!=null&&M.length&&(y=h.statistics.map(A=>({min:A[0],max:A[1],avg:A[2],stddev:A[3]})));const v=Ne.fromJSON(h.extent),w=Math.ceil(v.width/h.pixelSizeX-.1),b=Math.ceil(v.height/h.pixelSizeY-.1),_=v.spatialReference,x=new Ae({x:h.pixelSizeX,y:h.pixelSizeY,spatialReference:_}),T=($=h.histograms)!=null&&$.length?h.histograms:null,I=new JZ({origin:h.origin,blockWidth:h.blockWidth,blockHeight:h.blockHeight,firstPyramidLevel:h.firstPyramidLevel,maximumPyramidLevel:h.maxPyramidLevel});return new GT({width:w,height:b,bandCount:h.bandCount,extent:v,spatialReference:_,pixelSize:x,pixelType:h.pixelType.toLowerCase(),statistics:y,histograms:T,keyProperties:d,storageInfo:I})}let Bc=class extends It(Q){constructor(){super(...arguments),this.fromGeometry=null,this.toGeometry=null,this.objectIds=null,this.where=null,this.maxCount=null}};l([p({type:Ae,json:{read:!0}})],Bc.prototype,"fromGeometry",void 0),l([p({type:Ae,json:{read:!0,write:!0}})],Bc.prototype,"toGeometry",void 0),l([p({json:{write:!0}})],Bc.prototype,"objectIds",void 0),l([p({type:String,json:{write:!0}})],Bc.prototype,"where",void 0),l([p({type:Number,json:{write:!0}})],Bc.prototype,"maxCount",void 0),Bc=l([k("esri.rest.support.FindImagesParameters")],Bc);const a$e=Bc;var HR;let td=HR=class extends Q{constructor(e){super(e),this.angleNames=null,this.point=null,this.spatialReference=null,this.rasterId=null}clone(){return new HR(B({angleNames:this.angleNames,point:this.point,spatialReference:this.spatialReference,rasterId:this.rasterId}))}};l([p({type:[String],json:{name:"angleName",write:!0}})],td.prototype,"angleNames",void 0),l([p({type:Ae,json:{write:!0}})],td.prototype,"point",void 0),l([p({type:xe,json:{write:!0}})],td.prototype,"spatialReference",void 0),l([p({type:Ke,json:{write:!0}})],td.prototype,"rasterId",void 0),td=HR=l([k("esri.rest.support.ImageAngleParameters")],td);const l$e=td,Do=new We({esriMensurationPoint:"point",esriMensurationCentroid:"centroid",esriMensurationDistanceAndAngle:"distance-and-angle",esriMensurationAreaAndPerimeter:"area-and-perimeter",esriMensurationHeightFromBaseAndTop:"base-and-top",esriMensurationHeightFromBaseAndTopShadow:"base-and-top-shadow",esriMensurationHeightFromTopAndTopShadow:"top-and-top-shadow",esriMensurationPoint3D:"point-3D",esriMensurationCentroid3D:"centroid-3D",esriMensurationDistanceAndAngle3D:"distance-and-angle-3D",esriMensurationAreaAndPerimeter3D:"area-and-perimeter-3D"});let Sa=class extends Q{constructor(){super(...arguments),this.type=null,this.measureOperation=null,this.mosaicRule=null,this.pixelSize=null,this.raster=void 0}};l([p()],Sa.prototype,"type",void 0),l([p({type:Do.apiValues,json:{read:Do.read,write:Do.write}})],Sa.prototype,"measureOperation",void 0),l([p({type:Hs,json:{write:!0}})],Sa.prototype,"mosaicRule",void 0),l([p({type:Ae,json:{write:!0}})],Sa.prototype,"pixelSize",void 0),l([p({json:{write:!0}})],Sa.prototype,"raster",void 0),Sa=l([k("esri.rest.support.BaseImageMeasureParameters")],Sa);var WR;let fu=WR=class extends Sa{constructor(){super(...arguments),this.type="area-perimeter",this.geometry=null,this.is3D=!1,this.linearUnit="meters",this.areaUnit="square-meters"}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}get measureOperation(){return this.is3D?"area-and-perimeter-3D":"area-and-perimeter"}clone(){return new WR(B({geometry:this.geometry,is3D:this.is3D,linearUnit:this.linearUnit,areaUnit:this.areaUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};l([p({types:Vi,json:{name:"fromGeometry",read:!0,write:!0}})],fu.prototype,"geometry",void 0),l([se("geometry")],fu.prototype,"writeGeometry",null),l([p({type:Do.apiValues,json:{write:Do.write}})],fu.prototype,"measureOperation",null),l([p({json:{read:!0}})],fu.prototype,"is3D",void 0),l([p({type:String,json:{read:Gu.read,write:Gu.write}})],fu.prototype,"linearUnit",void 0),l([p({type:String,json:{read:ov.read,write:ov.write}})],fu.prototype,"areaUnit",void 0),fu=WR=l([k("esri.rest.support.ImageAreaParameters")],fu);const u$e=fu;let Z2=class extends It(Q){constructor(){super(...arguments),this.outSpatialReference=null}};l([p({type:xe,json:{name:"outSR",write:!0}})],Z2.prototype,"outSpatialReference",void 0),Z2=l([k("esri.rest.support.ImageBoundaryParameters")],Z2);const c$e=Z2;var JR;let rl=JR=class extends Sa{constructor(){super(...arguments),this.type="distance-angle",this.fromGeometry=null,this.toGeometry=null,this.is3D=!1,this.linearUnit="meters",this.angularUnit="degrees"}writeFromGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}get measureOperation(){return this.is3D?"distance-and-angle-3D":"distance-and-angle"}clone(){return new JR(B({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,is3D:this.is3D,linearUnit:this.linearUnit,angularUnit:this.angularUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};l([p({type:Ae,json:{read:!0,write:!0}})],rl.prototype,"fromGeometry",void 0),l([se("fromGeometry")],rl.prototype,"writeFromGeometry",null),l([p({type:Ae,json:{read:!0,write:!0}})],rl.prototype,"toGeometry",void 0),l([p({type:Do.apiValues,json:{write:Do.write}})],rl.prototype,"measureOperation",null),l([p({json:{read:!0}})],rl.prototype,"is3D",void 0),l([p({type:String,json:{read:Gu.read,write:Gu.write}})],rl.prototype,"linearUnit",void 0),l([p({type:String,json:{read:zS.read,write:zS.write}})],rl.prototype,"angularUnit",void 0),rl=JR=l([k("esri.rest.support.ImageDistanceParameters")],rl);const p$e=rl;let yu=class extends It(Q){constructor(){super(...arguments),this.geometry=null,this.objectIds=null,this.spatialRelationship="intersects",this.timeExtent=null,this.where=null}writeGeometry(t,r,i){t!=null&&(r.geometryType=Rn(t),r[i]=JSON.stringify(t.toJSON()))}};l([p({types:Vi,json:{read:Xr,write:!0}})],yu.prototype,"geometry",void 0),l([se("geometry")],yu.prototype,"writeGeometry",null),l([p({json:{write:!0}})],yu.prototype,"objectIds",void 0),l([Ce(ZJ,{ignoreUnknown:!1,name:"spatialRel"})],yu.prototype,"spatialRelationship",void 0),l([p({type:is,json:{name:"time",write:!0}})],yu.prototype,"timeExtent",void 0),l([p({type:String,json:{write:!0}})],yu.prototype,"where",void 0),yu=l([k("esri.rest.support.ImageGPSInfoParameters")],yu);const h$e=yu;var ZR;let mu=ZR=class extends Sa{constructor(){super(...arguments),this.type="height",this.fromGeometry=null,this.toGeometry=null,this.operationType="base-and-top",this.linearUnit="meters"}writeFromGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}get measureOperation(){return this.operationType}clone(){return new ZR(B({fromGeometry:this.fromGeometry,toGeometry:this.toGeometry,operationType:this.operationType,linearUnit:this.linearUnit,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};l([p({type:Ae,json:{read:!0}})],mu.prototype,"fromGeometry",void 0),l([se("fromGeometry")],mu.prototype,"writeFromGeometry",null),l([p({type:Ae,json:{read:!0,write:!0}})],mu.prototype,"toGeometry",void 0),l([p({type:Do.apiValues,json:{write:Do.write}})],mu.prototype,"measureOperation",null),l([p({json:{read:!0}})],mu.prototype,"operationType",void 0),l([p({type:String,json:{read:Gu.read,write:Gu.write}})],mu.prototype,"linearUnit",void 0),mu=ZR=l([k("esri.rest.support.ImageHeightParameters")],mu);const d$e=mu;var YR;let fa=YR=class extends Q{constructor(){super(...arguments),this.geometry=null,this.mosaicRule=null,this.rasterFunction=null,this.pixelSize=null,this.raster=void 0,this.timeExtent=null}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}get renderingRule(){return Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")}set renderingRule(e){Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",e)}clone(){return new YR(B({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,pixelSize:this.pixelSize,raster:this.raster,timeExtent:this.timeExtent}))}};l([p({types:Vi,json:{read:Xr}})],fa.prototype,"geometry",void 0),l([se("geometry")],fa.prototype,"writeGeometry",null),l([p({type:Hs,json:{write:!0}})],fa.prototype,"mosaicRule",void 0),l([p({type:vt})],fa.prototype,"renderingRule",null),l([p({type:vt,json:{write:!0,name:"renderingRule"}})],fa.prototype,"rasterFunction",void 0),l([p({type:Ae,json:{write:!0}})],fa.prototype,"pixelSize",void 0),l([p({json:{write:!0}})],fa.prototype,"raster",void 0),l([p({type:is,json:{read:{source:"time"},write:{target:"time"}}})],fa.prototype,"timeExtent",void 0),fa=YR=l([k("esri.rest.support.ImageHistogramParameters")],fa);const FM=fa;var KR;let Sr=KR=class extends Q{constructor(){super(...arguments),this.geometry=null,this.rasterFunctions=null,this.pixelSize=null,this.returnGeometry=!0,this.returnCatalogItems=!0,this.returnPixelValues=!0,this.maxItemCount=null,this.timeExtent=null,this.raster=void 0,this.viewId=void 0,this.processAsMultidimensional=!1}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=JSON.stringify(e.toJSON()))}set mosaicRule(e){let t=e;t!=null&&t.mosaicMethod&&(t=Hs.fromJSON({...t.toJSON(),mosaicMethod:t.mosaicMethod,mosaicOperation:t.mosaicOperation})),this._set("mosaicRule",t)}writeMosaicRule(e,t,r){e!=null&&(t[r]=JSON.stringify(e.toJSON()))}get renderingRule(){return Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._get("rasterFunction")}set renderingRule(e){Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",e)}get renderingRules(){return Ma(oe.getLogger(this),"renderingRules",{replacement:"rasterFunctions",version:"4.27",warnOnce:!0}),this._get("rasterFunctions")}set renderingRules(e){Ma(oe.getLogger(this),"renderingRules",{replacement:"rasterFunctions",version:"4.27",warnOnce:!0}),this._set("rasterFunctions",e)}set rasterFunction(e){let t=e;t!=null&&t.rasterFunction&&(t=vt.fromJSON({...t.toJSON(),rasterFunction:t.rasterFunction,rasterFunctionArguments:t.rasterFunctionArguments})),this._set("rasterFunction",t)}writeRasterFunction(e,t,r){e!=null&&(t[r]=JSON.stringify(e.toJSON())),e.rasterFunctionDefinition&&(t[r]=JSON.stringify(e.rasterFunctionDefinition))}writeRasterFunctions(e,t,r){e!=null&&(t[r]=JSON.stringify(e.map(i=>i.rasterFunctionDefinition||i.toJSON())))}writePixelSize(e,t,r){e!=null&&(t[r]=JSON.stringify(e))}writeTimeExtent(e,t,r){if(e!=null){const i=e.start!=null?e.start.getTime():null,n=e.end!=null?e.end.getTime():null;t[r]=i!=null?n!=null?`${i},${n}`:`${i}`:null}}clone(){return new KR(B({geometry:this.geometry,mosaicRule:this.mosaicRule,rasterFunction:this.rasterFunction,rasterFunctions:this.rasterFunctions,pixelSize:this.pixelSize,returnGeometry:this.returnGeometry,returnCatalogItems:this.returnCatalogItems,returnPixelValues:this.returnPixelValues,maxItemCount:this.maxItemCount,processAsMultidimensional:this.processAsMultidimensional,raster:this.raster,viewId:this.viewId,timeExtent:this.timeExtent}))}};l([p({json:{write:!0}})],Sr.prototype,"geometry",void 0),l([se("geometry")],Sr.prototype,"writeGeometry",null),l([p({type:Hs,json:{write:!0}})],Sr.prototype,"mosaicRule",null),l([se("mosaicRule")],Sr.prototype,"writeMosaicRule",null),l([p({type:vt})],Sr.prototype,"renderingRule",null),l([p({type:[vt]})],Sr.prototype,"renderingRules",null),l([p({type:vt,json:{write:!0,name:"renderingRule"}})],Sr.prototype,"rasterFunction",null),l([se("rasterFunction")],Sr.prototype,"writeRasterFunction",null),l([p({type:[vt],json:{write:!0,name:"renderingRules"}})],Sr.prototype,"rasterFunctions",void 0),l([se("rasterFunctions")],Sr.prototype,"writeRasterFunctions",null),l([p({type:Ae,json:{write:!0}})],Sr.prototype,"pixelSize",void 0),l([se("pixelSize")],Sr.prototype,"writePixelSize",null),l([p({type:Boolean,json:{write:!0}})],Sr.prototype,"returnGeometry",void 0),l([p({type:Boolean,json:{write:!0}})],Sr.prototype,"returnCatalogItems",void 0),l([p({type:Boolean,json:{write:!0}})],Sr.prototype,"returnPixelValues",void 0),l([p({type:Number,json:{write:!0}})],Sr.prototype,"maxItemCount",void 0),l([p({type:is,json:{write:{target:"time"}}})],Sr.prototype,"timeExtent",void 0),l([se("timeExtent")],Sr.prototype,"writeTimeExtent",null),l([p({json:{write:!0}})],Sr.prototype,"raster",void 0),l([p({json:{write:!0}})],Sr.prototype,"viewId",void 0),l([p({type:Boolean,json:{write:!0}})],Sr.prototype,"processAsMultidimensional",void 0),Sr=KR=l([k("esri.rest.support.ImageIdentifyParameters")],Sr);const o7=Sr;var XR;let Sy=XR=class extends Q{constructor(){super(...arguments),this.geometries=null,this.rasterId=null}writeGeometry(e,t,r){t.geometries={geometryType:"esriGeometryPoint",geometries:e.map(i=>i.toJSON())}}clone(){var e;return new XR({geometries:((e=this.geometries)==null?void 0:e.map(t=>t.clone()))??[],rasterId:this.rasterId})}};l([p({type:[Ae],json:{write:!0}})],Sy.prototype,"geometries",void 0),l([se("geometries")],Sy.prototype,"writeGeometry",null),l([p({type:Ke,json:{write:!0}})],Sy.prototype,"rasterId",void 0),Sy=XR=l([k("esri.rest.support.ImagePixelLocationParameters")],Sy);const f$e=Sy;var QR;let rd=QR=class extends Sa{constructor(){super(...arguments),this.type="point",this.geometry=null,this.is3D=!1}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}get measureOperation(){const{is3D:e,geometry:t}=this;return t.type==="point"?e?"point-3D":"point":e?"centroid-3D":"centroid"}clone(){return new QR(B({geometry:this.geometry,is3D:this.is3D,mosaicRule:this.mosaicRule,pixelSize:this.pixelSize,raster:this.raster}))}};l([p({types:Vi,json:{name:"fromGeometry",read:Xr}})],rd.prototype,"geometry",void 0),l([se("geometry")],rd.prototype,"writeGeometry",null),l([p({type:Do.apiValues,json:{read:Do.read,write:Do.write}})],rd.prototype,"measureOperation",null),l([p({json:{read:!0}})],rd.prototype,"is3D",void 0),rd=QR=l([k("esri.rest.support.ImagePointParameters")],rd);const y$e=rd;var eC;let wn=eC=class extends Q{constructor(){super(...arguments),this.geometry=null,this.interpolation="nearest",this.mosaicRule=null,this.outFields=null,this.pixelSize=null,this.returnFirstValueOnly=!0,this.sampleDistance=null,this.sampleCount=null,this.sliceId=null,this.timeExtent=null}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]=e.toJSON())}set locations(e){if(e!=null&&e.length){const t=new jv({spatialReference:e[0].spatialReference});t.points=e.map(r=>[r.x,r.y]),this._set("locations",e),this.geometry=t}}clone(){return new eC(B({geometry:this.geometry,locations:this.locations,interpolation:this.interpolation,mosaicRule:this.mosaicRule,outFields:this.outFields,raster:this.raster,returnFirstValueOnly:this.returnFirstValueOnly,sampleDistance:this.sampleDistance,sampleCount:this.sampleCount,sliceId:this.sliceId,pixelSize:this.pixelSize,timeExtent:this.timeExtent}))}};l([p({types:Vi,json:{read:Xr}})],wn.prototype,"geometry",void 0),l([se("geometry")],wn.prototype,"writeGeometry",null),l([p()],wn.prototype,"locations",null),l([p({type:String,json:{type:bp.jsonValues,read:bp.read,write:bp.write}})],wn.prototype,"interpolation",void 0),l([p({type:Hs,json:{write:!0}})],wn.prototype,"mosaicRule",void 0),l([p({type:[String],json:{write:!0}})],wn.prototype,"outFields",void 0),l([p({type:Ae,json:{write:!0}})],wn.prototype,"pixelSize",void 0),l([p({type:String,json:{write:!0}})],wn.prototype,"raster",void 0),l([p({type:Boolean,json:{write:!0}})],wn.prototype,"returnFirstValueOnly",void 0),l([p({type:Number,json:{write:!0}})],wn.prototype,"sampleDistance",void 0),l([p({type:Number,json:{write:!0}})],wn.prototype,"sampleCount",void 0),l([p({type:Number,json:{write:!0}})],wn.prototype,"sliceId",void 0),l([p({type:is,json:{read:{source:"time"},write:{target:"time"}}})],wn.prototype,"timeExtent",void 0),wn=eC=l([k("esri.rest.support.ImageSampleParameters")],wn);const m$e=wn;let id=class extends It(Q){constructor(){super(...arguments),this.geometries=[],this.rasterIds=null,this.outSpatialReference=null}writeGeometries(t,r,i){r.geometries=t!=null&&t.length?{geometryType:Rn(t[0]),geometries:t.map(n=>({...n.toJSON(),spatialReference:void 0}))}:null}};l([p({types:[Vi]})],id.prototype,"geometries",void 0),l([se("geometries")],id.prototype,"writeGeometries",null),l([p({type:[Ke],json:{write:!0}})],id.prototype,"rasterIds",void 0),l([p({type:xe,json:{name:"outSR",write:!0}})],id.prototype,"outSpatialReference",void 0),id=l([k("esri.rest.support.ImageToMapMultirayParameters")],id);const g$e=id;let gu=class extends It(Q){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.outSpatialReference=null,this.depthOffset=0,this.adjust=!1}writeGeometry(t,r,i){t!=null&&(r.geometryType=Rn(t),r[i]={...t.toJSON(),spatialReference:void 0})}};l([p({types:Vi,json:{read:Xr,write:!0}})],gu.prototype,"geometry",void 0),l([se("geometry")],gu.prototype,"writeGeometry",null),l([p({json:{write:!0}})],gu.prototype,"rasterId",void 0),l([p({type:xe,json:{name:"outSR",write:!0}})],gu.prototype,"outSpatialReference",void 0),l([p({json:{name:"options.DOff",write:!0}})],gu.prototype,"depthOffset",void 0),l([p({json:{name:"options.Adjust",write:!0}})],gu.prototype,"adjust",void 0),gu=l([k("esri.rest.support.ImageToMapParameters")],gu);const v$e=gu;let Y2=class extends It(Q){constructor(){super(...arguments),this.referenceUri=null}};l([p({type:String,json:{name:"uri",write:!0}})],Y2.prototype,"referenceUri",void 0),Y2=l([k("esri.rest.support.ImageUrlParameters")],Y2);const w$e=Y2;let nd=class extends It(Q){constructor(){super(...arguments),this.geometry=null,this.rasterId=null,this.visibleOnly=!1}writeGeometry(t,r,i){t!=null&&(r.geometryType=Rn(t),r[i]=JSON.stringify(t))}};l([p({types:Vi,json:{read:Xr,write:!0}})],nd.prototype,"geometry",void 0),l([se("geometry")],nd.prototype,"writeGeometry",null),l([p({json:{write:!0}})],nd.prototype,"rasterId",void 0),l([p({json:{name:"options.VisibleOnly",write:!0}})],nd.prototype,"visibleOnly",void 0),nd=l([k("esri.rest.support.MapToImageParameters")],nd);const b$e=nd;var tC;let xy=tC=class extends Q{constructor(){super(...arguments),this.geometry=null,this.rasterId=void 0}writeGeometry(e,t,r){e!=null&&(t.geometryType=Rn(e),t[r]={...e.toJSON(),spatialReference:void 0})}clone(){const e=B({geometry:this.geometry,rasterId:this.rasterId});return new tC(e)}};l([p({types:Vi,json:{name:"fromGeometry",read:Xr,write:!0}})],xy.prototype,"geometry",void 0),l([se("geometry")],xy.prototype,"writeGeometry",null),l([p({json:{write:!0}})],xy.prototype,"rasterId",void 0),xy=tC=l([k("esri.rest.support.MeasureFromImageParameters")],xy);const a7=xy,Ia=()=>oe.getLogger("esri.views.2d.engine.flow.dataUtils"),_$e=10;async function S$e(e,t,r,i){const n=performance.now(),s=x$e(t,r),o=performance.now(),a=I$e(t,s,r.width,r.height),u=performance.now(),c=$$e(a),h=performance.now(),d=e==="Streamlines"?E$e(c,_$e):A$e(c),y=performance.now();return Me("esri-2d-profiler")&&(Ia().info("I.1","_createFlowFieldFromData (ms)",Math.round(o-n)),Ia().info("I.2","_getStreamlines (ms)",Math.round(u-o)),Ia().info("I.3","createAnimatedLinesData (ms)",Math.round(h-u)),Ia().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(y-h)),Ia().info("I.5","createFlowMesh (ms)",Math.round(y-n)),Ia().info("I.6","Mesh size (bytes)",d.vertexData.buffer.byteLength+d.indexData.buffer.byteLength)),await Promise.resolve(),Ut(i),d}function x$e(e,t){const r=M$e(t.data,t.width,t.height,e.smoothing);return e.interpolate?(i,n)=>{const s=Math.floor(i),o=Math.floor(n);if(s<0||s>=t.width)return[0,0];if(o<0||o>=t.height)return[0,0];const a=i-s,u=n-o,c=s,h=o,d=s<t.width-1?s+1:s,y=o<t.height-1?o+1:o,v=r[2*(h*t.width+c)],w=r[2*(h*t.width+d)],b=r[2*(y*t.width+c)],_=r[2*(y*t.width+d)],x=r[2*(h*t.width+c)+1],T=r[2*(h*t.width+d)+1];return[(v*(1-u)+b*u)*(1-a)+(w*(1-u)+_*u)*a,(x*(1-u)+r[2*(y*t.width+c)+1]*u)*(1-a)+(T*(1-u)+r[2*(y*t.width+d)+1]*u)*a]}:(i,n)=>{const s=Math.round(i),o=Math.round(n);return s<0||s>=t.width||o<0||o>=t.height?[0,0]:[r[2*(o*t.width+s)],r[2*(o*t.width+s)+1]]}}function T$e(e,t,r,i,n,s,o,a,u){const c=[];let h=r,d=i,y=0,[v,w]=t(h,d);v*=e.velocityScale,w*=e.velocityScale;const b=Math.sqrt(v*v+w*w);let _,x;c.push({x:h,y:d,t:y,speed:b});for(let T=0;T<e.verticesPerLine;T++){let[I,M]=t(h,d);I*=e.velocityScale,M*=e.velocityScale;const $=Math.sqrt(I*I+M*M);if($<e.minSpeedThreshold)return c;const A=I/$,R=M/$;if(h+=A*e.segmentLength,d+=R*e.segmentLength,y+=e.segmentLength/$,Math.acos(A*_+R*x)>e.maxTurnAngle)return c;if(e.collisions){const L=Math.round(h*u),C=Math.round(d*u);if(L<0||L>o-1||C<0||C>a-1)return c;const U=s[C*o+L];if(U!==-1&&U!==n)return c;s[C*o+L]=n}c.push({x:h,y:d,t:y,speed:$}),_=A,x=R}return c}function I$e(e,t,r,i){const n=[],s=new sV,o=1/Math.max(e.lineCollisionWidth,1),a=Math.round(r*o),u=Math.round(i*o),c=new Int32Array(a*u);for(let d=0;d<c.length;d++)c[d]=-1;const h=[];for(let d=0;d<i;d+=e.lineSpacing)for(let y=0;y<r;y+=e.lineSpacing)h.push({x:y,y:d,sort:s.getFloat()});h.sort((d,y)=>d.sort-y.sort);for(const{x:d,y}of h)if(s.getFloat()<e.density){const v=T$e(e,t,d,y,n.length,c,a,u,o);if(v.length<2)continue;n.push(v)}return n}function M$e(e,t,r,i){if(i===0)return e;const n=Math.round(3*i),s=new Array(2*n+1);let o=0;for(let c=-n;c<=n;c++){const h=Math.exp(-c*c/(i*i));s[c+n]=h,o+=h}for(let c=-n;c<=n;c++)s[c+n]/=o;const a=new Float32Array(e.length);for(let c=0;c<r;c++)for(let h=0;h<t;h++){let d=0,y=0;for(let v=-n;v<=n;v++){if(h+v<0||h+v>=t)continue;const w=s[v+n];d+=w*e[2*(c*t+(h+v))],y+=w*e[2*(c*t+(h+v))+1]}a[2*(c*t+h)]=d,a[2*(c*t+h)+1]=y}const u=new Float32Array(e.length);for(let c=0;c<t;c++)for(let h=0;h<r;h++){let d=0,y=0;for(let v=-n;v<=n;v++){if(h+v<0||h+v>=r)continue;const w=s[v+n];d+=w*a[2*((h+v)*t+c)],y+=w*a[2*((h+v)*t+c)+1]}u[2*(h*t+c)]=d,u[2*(h*t+c)+1]=y}return u}function $$e(e,t){const r=new sV,i=e.reduce((u,c)=>u+c.length,0),n=new Float32Array(4*i),s=new Array(e.length);let o=0,a=0;for(const u of e){const c=o;for(const h of u)n[4*o]=h.x,n[4*o+1]=h.y,n[4*o+2]=h.t,n[4*o+3]=h.speed,o++;s[a++]={startVertex:c,numberOfVertices:u.length,totalTime:u[u.length-1].t,timeSeed:r.getFloat()}}return{lineVertices:n,lineDescriptors:s}}function E$e(e,t){const{lineVertices:i,lineDescriptors:n}=e;let s=0,o=0;for(const v of n)s+=2*v.numberOfVertices,o+=6*(v.numberOfVertices-1);const a=new Float32Array(s*9),u=new Uint32Array(o);let c=0,h=0;function d(){u[h++]=c-2,u[h++]=c,u[h++]=c-1,u[h++]=c,u[h++]=c+1,u[h++]=c-1}function y(v,w,b,_,x,T,I,M){const $=c*9;let A=0;a[$+A++]=v,a[$+A++]=w,a[$+A++]=1,a[$+A++]=b,a[$+A++]=T,a[$+A++]=I,a[$+A++]=_/2,a[$+A++]=x/2,a[$+A++]=M,c++,a[$+A++]=v,a[$+A++]=w,a[$+A++]=-1,a[$+A++]=b,a[$+A++]=T,a[$+A++]=I,a[$+A++]=-_/2,a[$+A++]=-x/2,a[$+A++]=M,c++}for(const v of n){const{totalTime:w,timeSeed:b}=v;let _=null,x=null,T=null,I=null,M=null,$=null;for(let A=0;A<v.numberOfVertices;A++){const R=i[4*(v.startVertex+A)],L=i[4*(v.startVertex+A)+1],C=i[4*(v.startVertex+A)+2],U=i[4*(v.startVertex+A)+3];let F=null,j=null,q=null,K=null;if(A>0){F=R-_,j=L-x;const X=Math.sqrt(F*F+j*j);if(F/=X,j/=X,A>1){let ne=F+M,re=j+$;const ae=Math.sqrt(ne*ne+re*re);ne/=ae,re/=ae;const he=Math.min(1/(ne*F+re*j),t);ne*=he,re*=he,q=-re,K=ne}else q=-j,K=F;q!==null&&K!==null&&(y(_,x,T,q,K,w,b,U),d())}_=R,x=L,T=C,M=F,$=j,I=U}y(_,x,T,-$,M,w,b,I)}return{vertexData:a,indexData:u}}function A$e(e){const{lineVertices:n,lineDescriptors:s}=e;let o=0,a=0;for(const X of s){const ne=X.numberOfVertices-1;o+=4*ne*2,a+=6*ne*2}const u=new Float32Array(o*16),c=new Uint32Array(a);let h,d,y,v,w,b,_,x,T,I,M,$,A,R,L=0,C=0;function U(){c[C++]=L-8,c[C++]=L-7,c[C++]=L-6,c[C++]=L-7,c[C++]=L-5,c[C++]=L-6,c[C++]=L-4,c[C++]=L-3,c[C++]=L-2,c[C++]=L-3,c[C++]=L-1,c[C++]=L-2}function F(X,ne,re,ae,he,de,fe,Se,Ee,Fe,ht,Lt,Nt,Ir){const st=L*16;let St=0;for(const ei of[1,2])for(const rn of[1,2,3,4])u[st+St++]=X,u[st+St++]=ne,u[st+St++]=re,u[st+St++]=ae,u[st+St++]=fe,u[st+St++]=Se,u[st+St++]=Ee,u[st+St++]=Fe,u[st+St++]=ei,u[st+St++]=rn,u[st+St++]=Nt,u[st+St++]=Ir,u[st+St++]=he/2,u[st+St++]=de/2,u[st+St++]=ht/2,u[st+St++]=Lt/2,L++}function j(X,ne){let re=T+M,ae=I+$;const he=Math.sqrt(re*re+ae*ae);re/=he,ae/=he;const de=T*re+I*ae;re/=de,ae/=de;let fe=M+A,Se=$+R;const Ee=Math.sqrt(fe*fe+Se*Se);fe/=Ee,Se/=Ee;const Fe=M*fe+$*Se;fe/=Fe,Se/=Fe,F(h,d,y,v,-ae,re,w,b,_,x,-Se,fe,X,ne),U()}function q(X,ne,re,ae,he,de){if(T=M,I=$,M=A,$=R,T==null&&I==null&&(T=M,I=$),w!=null&&b!=null){A=X-w,R=ne-b;const fe=Math.sqrt(A*A+R*R);A/=fe,R/=fe}T!=null&&I!=null&&j(he,de),h=w,d=b,y=_,v=x,w=X,b=ne,_=re,x=ae}function K(X,ne){T=M,I=$,M=A,$=R,T==null&&I==null&&(T=M,I=$),T!=null&&I!=null&&j(X,ne)}for(const X of s){h=null,d=null,y=null,v=null,w=null,b=null,_=null,x=null,T=null,I=null,M=null,$=null,A=null,R=null;const{totalTime:ne,timeSeed:re}=X;for(let ae=0;ae<X.numberOfVertices;ae++)q(n[4*(X.startVertex+ae)],n[4*(X.startVertex+ae)+1],n[4*(X.startVertex+ae)+2],n[4*(X.startVertex+ae)+3],ne,re);K(ne,re)}return{vertexData:u,indexData:c}}function l7(e,t){const r=t.pixels,{width:i,height:n}=t,s=new Float32Array(i*n*2),o=t.mask||new Uint8Array(i*n*2);if(t.mask||o.fill(255),e==="vector-uv")for(let a=0;a<i*n;a++)s[2*a]=r[0][a],s[2*a+1]=-r[1][a];else if(e==="vector-magdir")for(let a=0;a<i*n;a++){const u=r[0][a],c=jO(r[1][a]),h=Math.cos(c-Math.PI/2),d=Math.sin(c-Math.PI/2);s[2*a]=h*u,s[2*a+1]=d*u}return{data:s,mask:o,width:i,height:n}}async function oUe(e,t,r,i,n,s){const o=performance.now(),a=Xn(t.spatialReference);if(!a){const M=await u7(e,t,r,i,n,s);return Me("esri-2d-profiler")&&Ia().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-o)),Me("esri-2d-profiler")&&Ia().info("I.9","Number of parts",1),M}const[u,c]=a.valid,h=c-u,d=Math.ceil(t.width/h),y=t.width/d,v=Math.round(r/d);let w=t.xmin;const b=[],_=performance.now();for(let M=0;M<d;M++){const $=new Ne({xmin:w,xmax:w+y,ymin:t.ymin,ymax:t.ymax,spatialReference:t.spatialReference});b.push(u7(e,$,v,i,n,s)),w+=y}const x=await Promise.all(b);Me("esri-2d-profiler")&&Ia().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-_)),Me("esri-2d-profiler")&&Ia().info("I.9","Number of parts",x.length);const T={data:new Float32Array(r*i*2),mask:new Uint8Array(r*i),width:r,height:i};let I=0;for(const M of x){for(let $=0;$<M.height;$++)for(let A=0;A<M.width;A++)I+A>=r||(T.data[2*($*r+I+A)]=M.data[2*($*M.width+A)],T.data[2*($*r+I+A)+1]=M.data[2*($*M.width+A)+1],T.mask[$*r+I+A]=M.mask[$*M.width+A]);I+=M.width}return Me("esri-2d-profiler")&&Ia().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-o)),T}async function u7(e,t,r,i,n,s){var c;const o={requestProjectedLocalDirections:!0,signal:s};if(n!=null&&(o.timeExtent=n),e.type==="imagery"){await e.load({signal:s});const h=e.rasterInfo.dataType,d=await e.fetchImage(t,r,i,o);return((c=d==null?void 0:d.pixelData)==null?void 0:c.pixelBlock)==null?{data:new Float32Array(r*i*2),mask:new Uint8Array(r*i),width:r,height:i}:l7(h,d.pixelData.pixelBlock)}await e.load({signal:s});const a=e.serviceRasterInfo.dataType,u=await e.fetchPixels(t,r,i,o);return(u==null?void 0:u.pixelBlock)==null?{data:new Float32Array(r*i*2),mask:new Uint8Array(r*i),width:r,height:i}:l7(a,u.pixelBlock)}const R$e=new Set(["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff"]),C$e=bV(Ws,{min:0,max:255});function O$e(e){if(!e)return null;const t=JSON.stringify(e).match(/"rasterFunction":"(.*?")/gi),r=t==null?void 0:t.map(i=>i.replace('"rasterFunction":"',"").replace('"',""));return r?r.join("/"):null}const P$e=e=>{let t=class extends e{constructor(){super(...arguments),this._functionRasterInfos={},this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this._cachedRendererJson=null,this._serviceSupportsMosaicRule=null,this._rasterAttributeTableFieldPrefix="Raster.",this.adjustAspectRatio=null,this.bandIds=void 0,this.capabilities=null,this.compressionQuality=void 0,this.compressionTolerance=.01,this.copyright=null,this.defaultMosaicRule=null,this.definitionExpression=null,this.exportImageServiceParameters=null,this.rasterInfo=null,this.fields=null,this.fullExtent=null,this.hasMultidimensions=!1,this.imageMaxHeight=4100,this.imageMaxWidth=4100,this.interpolation=void 0,this.minScale=0,this.maxScale=0,this.multidimensionalInfo=null,this.multidimensionalSubset=null,this.noData=null,this.noDataInterpretation=void 0,this.objectIdField=null,this.geometryType="polygon",this.typeIdField=null,this.types=[],this.pixelFilter=null,this.raster=void 0,this.sourceType=null,this.viewId=void 0,this.symbolizer=null,this.rasterFunctionInfos=null,this.serviceDataType=null,this.spatialReference=null,this.pixelType=null,this.serviceRasterInfo=null,this.sourceJSON=null,this.url=null,this.version=void 0}initialize(){this._set("exportImageServiceParameters",new Ur({layer:this}))}readServiceSupportsMosaicRule(i,n){return this._isMosaicRuleSupported(n)}get _rasterFunctionNamesIndex(){const i=new Map;return!this.rasterFunctionInfos||this.rasterFunctionInfos!=null&&this.rasterFunctionInfos.length<1||this.rasterFunctionInfos!=null&&this.rasterFunctionInfos.forEach(n=>{i.set(n.name.toLowerCase().replaceAll(/ /gi,"_"),n.name)}),i}readBandIds(i,n){if(Array.isArray(i)&&i.length>0&&i.every(s=>typeof s=="number"))return i}readCapabilities(i,n){return this._readCapabilities(n)}writeCompressionQuality(i,n,s){i!=null&&this.format!=="lerc"&&(n[s]=i)}writeCompressionTolerance(i,n,s){this.format==="lerc"&&i!=null&&(n[s]=i)}readDefaultMosaicRule(i,n){return this._serviceSupportsMosaicRule?Hs.fromJSON(n):null}get fieldsIndex(){return this.fields?new DT(this.fields):null}set format(i){i&&R$e.has(i.toLowerCase())&&this._set("format",i.toLowerCase())}readFormat(i,n){return n.serviceDataType==="esriImageServiceDataTypeVector-UV"||n.serviceDataType==="esriImageServiceDataTypeVector-MagDir"||this.pixelFilter!=null?"lerc":"jpgpng"}readMinScale(i,n){return n.minLOD!=null&&n.maxLOD!=null?i:0}readMaxScale(i,n){return n.minLOD!=null&&n.maxLOD!=null?i:0}set mosaicRule(i){let n=i;n!=null&&n.mosaicMethod&&(n=Hs.fromJSON({...n.toJSON(),mosaicMethod:n.mosaicMethod,mosaicOperation:n.mosaicOperation})),this._set("mosaicRule",n)}readMosaicRule(i,n){const s=i||n.mosaicRule;return s?Hs.fromJSON(s):this._isMosaicRuleSupported(n)?Hs.fromJSON(n):null}writeMosaicRule(i,n,s){let o=this.mosaicRule;const a=this.definitionExpression;o?a&&a!==o.where&&(o=o.clone(),o.where=a):a&&(o=new Hs({where:a})),this._isValidCustomizedMosaicRule(o)&&(n[s]=o.toJSON())}writeNoData(i,n,s){i!=null&&typeof i=="number"&&(n[s]=C$e(i))}readObjectIdField(i,n){if(!i){const s=n.fields.find(o=>o.type==="esriFieldTypeOID"||o.type==="oid");i=s==null?void 0:s.name}return i}get parsedUrl(){return Pt(this.url)}readSourceType(i,n){return this._isMosaicDataset(n)?"mosaic-dataset":"raster-dataset"}set renderer(i){this.loaded&&(i=this._configRenderer(i)),this._set("renderer",i)}readRenderer(i,n,s){var u,c;const o=(c=(u=n==null?void 0:n.layerDefinition)==null?void 0:u.drawingInfo)==null?void 0:c.renderer,a=QTe(o,s);return a==null?null:(a.type==="vector-field"&&n.symbolTileSize&&!o.symbolTileSize&&(a.symbolTileSize=n.symbolTileSize),zZ(a)||oe.getLogger(this).warn("ArcGISImageService","Imagery layer doesn't support given renderer type."),a)}writeRenderer(i,n,s){n.layerDefinition=n.layerDefinition||{},n.layerDefinition.drawingInfo=n.layerDefinition.drawingInfo||{},n.layerDefinition.drawingInfo.renderer=i.toJSON(),i.type==="vector-field"&&(n.symbolTileSize=i.symbolTileSize)}get rasterFields(){var c;const i=this._rasterAttributeTableFieldPrefix,n=new Po({name:"Raster.ItemPixelValue",alias:"Item Pixel Value",domain:null,editable:!1,length:50,type:"string"}),s=new Po({name:"Raster.ServicePixelValue",alias:"Service Pixel Value",domain:null,editable:!1,length:50,type:"string"}),o=new Po({name:"Raster.ServicePixelValue.Raw",alias:"Raw Service Pixel Value",domain:null,editable:!1,length:50,type:"string"});let a=this.fields?B(this.fields):[];a.push(s),(c=this.capabilities)!=null&&c.operations.supportsQuery&&this.fields&&this.fields.length>0&&a.push(n),this.version>=10.4&&this.rasterFunctionInfos!=null&&this.rasterFunctionInfos.some(h=>h.name.toLowerCase()==="none")&&a.push(o),this.rasterFunctionInfos!=null&&this.rasterFunctionInfos.filter(h=>h.name.toLowerCase()!=="none").forEach(h=>{a.push(new Po({name:"Raster.ServicePixelValue."+h.name,alias:h.name,domain:null,editable:!1,length:50,type:"string"}))}),this._isVectorDataSet()&&(a.push(new Po({name:"Raster.Magnitude",alias:"Magnitude",domain:null,editable:!1,type:"double"})),a.push(new Po({name:"Raster.Direction",alias:"Direction",domain:null,editable:!1,type:"double"})));const{attributeTable:u}=this.rasterInfo??{};if(u!=null){const h=u.fields.filter(d=>d.type!=="esriFieldTypeOID"&&d.name.toLowerCase()!=="value").map(d=>{const y=B(d);return y.name=i+d.name,y});a=a.concat(h)}return a}get renderingRule(){return Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this.rasterFunction}set renderingRule(i){Ma(oe.getLogger(this),"renderingRule",{replacement:"rasterFunction",version:"4.27",warnOnce:!0}),this._set("rasterFunction",i)}set rasterFunction(i){let n=i;n!=null&&n.rasterFunction&&(n=vt.fromJSON({...n.toJSON(),rasterFunction:n.rasterFunction,rasterFunctionArguments:n.rasterFunctionArguments})),this._set("rasterFunction",n)}readRasterFunction(i,n){const s=n.rasterFunctionInfos;return n.renderingRule||s!=null&&s.length&&s[0].name!=="None"?this._isRFTJson(n.renderingRule)?vt.fromJSON({rasterFunctionDefinition:n.renderingRule}):vt.fromJSON(n.renderingRule||{rasterFunctionInfos:n.rasterFunctionInfos}):null}readSpatialReference(i,n){const s=i||n.extent.spatialReference;return s?xe.fromJSON(s):null}readPixelType(i){return am.fromJSON(i)||i}writePixelType(i,n,s){this.serviceRasterInfo!=null&&this.pixelType===this.serviceRasterInfo.pixelType||(n[s]=am.toJSON(i))}readVersion(i,n){let s=n.currentVersion;return s||(s=n.hasOwnProperty("fields")||n.hasOwnProperty("timeInfo")?10:9.3),s}applyFilter(i){let n=i;return this.pixelFilter&&(n=this._clonePixelData(i),this.pixelFilter(n)),n}async applyRenderer(i,n){let s=i;const{renderer:o,symbolizer:a,pixelFilter:u,bandIds:c}=this;if(!this._isPicture()&&o&&a&&!u){const h=JSON.stringify(this._cachedRendererJson)!==JSON.stringify(o.toJSON()),d=this._rasterJobHandler.instance;if(d){h&&(a.bind(),await d.updateSymbolizer(a,n),this._cachedRendererJson=o.toJSON());const y=await d.symbolize({bandIds:c,...i},n);s={extent:i.extent,pixelBlock:y}}else s={extent:i.extent,pixelBlock:a.symbolize({bandIds:c,...i})}}return s}destroy(){this._shutdownJobHandler()}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}async computeAngles(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsComputeAngles)throw new z("imagery-layer:compute-angles","this operation is not supported on the input image service");return i=rr(l$e,i).clone(),kMe(this.url,i,this._getRequestOptions(n))}async computePixelSpaceLocations(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsComputePixelLocation)throw new z("imagery-layer:compute-pixel-space-locations","this operation is not supported on the input image service");return i=rr(f$e,i).clone(),NMe(this.url,i,this._getRequestOptions(n))}async computeHistograms(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsComputeHistograms)throw new z("imagery-layer:compute-histograms","this operation is not supported on the input image service");return i=rr(FM,i).clone(),this._applyMosaicAndRenderingRules(i),FMe(this.url,i,this._getRequestOptions(n))}async computeStatisticsHistograms(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsComputeStatisticsHistograms)throw new z("imagery-layer:compute-statistics-histograms","this operation is not supported on the input image service");return i=rr(FM,i).clone(),this._applyMosaicAndRenderingRules(i),DMe(this.url,i,this._getRequestOptions(n))}async measureHeight(i,n){const s=await this._fetchCapabilities(n==null?void 0:n.signal);if(!(i.operationType==="base-and-top"?s.mensuration.supportsHeightFromBaseAndTop:i.operationType==="base-and-top-shadow"?s.mensuration.supportsHeightFromBaseAndTopShadow:s.mensuration.supportsHeightFromTopAndTopShadow))throw new z("imagery-layer:measure-height","this operation is not supported on the input image service");return i=rr(d$e,i).clone(),this._applyMosaicAndRenderingRules(i),UMe(this.url,i,this._getRequestOptions(n))}async measureAreaAndPerimeter(i,n){const s=await this._fetchCapabilities(n==null?void 0:n.signal);if(!(s.mensuration.supportsAreaAndPerimeter&&(!i.is3D||s.mensuration.supports3D)))throw new z("imagery-layer:measure-area-and-perimeter","this operation is not supported on the input image service");return i=rr(u$e,i).clone(),this._applyMosaicAndRenderingRules(i),VMe(this.url,i,this._getRequestOptions(n))}async measureDistanceAndAngle(i,n){const s=await this._fetchCapabilities(n==null?void 0:n.signal);if(!(s.mensuration.supportsDistanceAndAngle&&(!i.is3D||s.mensuration.supports3D)))throw new z("imagery-layer:measure-distance-and-angle","this operation is not supported on the input image service");return i=rr(p$e,i).clone(),this._applyMosaicAndRenderingRules(i),BMe(this.url,i,this._getRequestOptions(n))}async measurePointOrCentroid(i,n){const s=await this._fetchCapabilities(n==null?void 0:n.signal);if(!(s.mensuration.supportsPointOrCentroid&&(!i.is3D||s.mensuration.supports3D)))throw new z("imagery-layer:measure-point-or-centroid","this operation is not supported on the input image service");return i=rr(y$e,i).clone(),this._applyMosaicAndRenderingRules(i),GMe(this.url,i,this._getRequestOptions(n))}async measureLengthFromImage(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsMeasureFromImage)throw new z("imagery-layer:measure-length-from-image","this operation is not supported on the input image service");if(i.geometry.type!=="polyline")throw new z("imagery-layer:measure-length-from-image","this input geometry must be a polyline");return i=rr(a7,i).clone(),zMe(this.url,i,this._getRequestOptions(n))}async measureAreaFromImage(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsMeasureFromImage)throw new z("imagery-layer:measure-area-from-image","this operation is not supported on the input image service");if(i.geometry.type!=="polygon")throw new z("imagery-layer:measure-area-from-image","this input geometry must be a polygon");return i=rr(a7,i).clone(),qMe(this.url,i,this._getRequestOptions(n))}getField(i){const{fieldsIndex:n}=this;return n!=null?n.get(i):void 0}getFieldDomain(i,n){const s=this.getField(i);return s?s.domain:null}async fetchImage(i,n,s,o={}){if(i==null||n==null||s==null)throw new z("imagery-layer:fetch-image","Insufficient parameters for requesting an image. A valid extent, width and height values are required.");if(this.renderer||this.symbolizer){const d=await this._generateRasterInfo(this.rasterFunction,{signal:o.signal});d&&(this.rasterInfo=d)}const a=this.getExportImageServiceParameters(i,n,s,o.timeExtent);if(a==null){if(o.requestAsImageElement&&this._canRequestImageElement(this.format)){const x=document.createElement("canvas");return x.width=n,x.height=s,o.returnImageBitmap?{imageBitmap:await ux(x,`${r(this.parsedUrl)}/exportImage`,o.signal)}:{imageOrCanvasElement:x}}const{bandIds:d,rasterInfo:y}=this,v=((d==null?void 0:d.length)||y.bandCount)??0,w=n*s,b=y.pixelType,_=[];for(let x=0;x<v;x++)_.push(Ye.createEmptyBand(b,w));return{pixelData:{pixelBlock:new Ye({width:n,height:s,pixels:_,mask:new Uint8Array(w),pixelType:b}),extent:i}}}const u=!!o.requestAsImageElement&&!this.pixelFilter,c=u&&!!o.returnImageBitmap,h={imageServiceParameters:a,imageProps:{extent:i,width:n,height:s,format:this.format},requestAsImageElement:u,returnImageBitmap:c,signal:o.signal};return this._requestArrayBuffer(h)}fetchKeyProperties(i){return be(r(this.parsedUrl)+"/keyProperties",{query:this._getQueryParams({renderingRule:this.version>=10.3?i==null?void 0:i.rasterFunction:null})}).then(n=>n.data)}fetchRasterAttributeTable(i){return this.version<10.1?Promise.reject(new z("#fetchRasterAttributeTable()","Failed to get rasterAttributeTable")):be(r(this.parsedUrl)+"/rasterAttributeTable",{query:this._getQueryParams({renderingRule:this.version>=10.3?i==null?void 0:i.rasterFunction:null})}).then(n=>Tf.fromJSON(n.data))}getCatalogItemRasterInfo(i,n){const s={...n,query:this._getQueryParams()};return o$e(r(this.parsedUrl),i,s)}async getCatalogItemICSInfo(i,n){var ne,re,ae,he,de;const{data:s}=await be(r(this.parsedUrl)+"/"+i+"/info/ics",{query:this._getQueryParams(),...n}),o=s==null?void 0:s.ics;if(!o)return;let a=null;try{a=(await be(r(this.parsedUrl)+"/"+i+"/info",{query:this._getQueryParams(),...n})).data.extent}catch{}if(!a||!a.spatialReference)return{ics:o,icsToPixelTransform:null,icsExtent:null,northDirection:null};const u=this.version>=10.7?be(r(this.parsedUrl)+"/"+i+"/info/icstopixel",{query:this._getQueryParams(),...n}).then(fe=>fe.data).catch(()=>({})):{},c=a.spatialReference,h={geometries:JSON.stringify({geometryType:"esriGeometryEnvelope",geometries:[a]}),inSR:Ip(c),outSR:"0:"+i},d=be(r(this.parsedUrl)+"/project",{query:this._getQueryParams(h),...n}).then(fe=>fe.data).catch(()=>({})),y=5,v=(a.xmin+a.xmax)/2,w=(a.ymax-a.ymin)/(y+1),b=a.ymin+w,_=[];for(let fe=0;fe<y;fe++)_.push({x:v,y:b+w*fe});const x={geometries:JSON.stringify({geometryType:"esriGeometryPoint",geometries:_}),inSR:Ip(c),outSR:"0:"+i},T=be(r(this.parsedUrl)+"/project",{query:this._getQueryParams(x),...n}).then(fe=>fe.data).catch(()=>({})),I=await Promise.all([u,d,T]);let M=I[0].ipxf;if(M==null){const fe=(ne=o.geodataXform)==null?void 0:ne.xf_0;((re=fe==null?void 0:fe.name)==null?void 0:re.toLowerCase())==="topup"&&((ae=fe==null?void 0:fe.coefficients)==null?void 0:ae.length)===6&&(M={affine:{name:"ics [sensor: Frame] to pixel (column, row) transformation",coefficients:fe.coefficients,cellsizeRatio:0,type:"GeometricXform"}})}const $=Ne.fromJSON((de=(he=I[1])==null?void 0:he.geometries)==null?void 0:de[0]);$&&($.spatialReference=new xe({wkid:0,imageCoordinateSystem:o}));const A=I[2].geometries?I[2].geometries.filter(fe=>(fe==null?void 0:fe.x)!=null&&fe.y!=null&&fe.x!=="NaN"&&fe.y!=="NaN"):[],R=A.length;if(R<3)return{ics:o,icsToPixelTransform:M,icsExtent:$,northDirection:null};let L=0,C=0,U=0,F=0;for(let fe=0;fe<R;fe++)L+=A[fe].x,C+=A[fe].y,U+=A[fe].x*A[fe].x,F+=A[fe].x*A[fe].y;const j=(R*F-L*C)/(R*U-L*L);let q=0;const K=A[y-1].x>A[0].x,X=A[y-1].y>A[0].y;return j===1/0?q=X?90:270:j===0?q=K?0:180:j>0?q=K?180*Math.atan(j)/Math.PI:180*Math.atan(j)/Math.PI+180:j<0&&(q=X?180+180*Math.atan(j)/Math.PI:360+180*Math.atan(j)/Math.PI),{ics:o,icsToPixelTransform:M,icsExtent:$,northDirection:q}}async generateRasterInfo(i,n){var u;if(i=rr(vt,i),this.serviceRasterInfo&&(!i||((u=i.functionName)==null?void 0:u.toLowerCase())==="none"||this._isVectorFieldResampleFunction(i)))return this.serviceRasterInfo;const s=O$e(i);if(!s)throw new z("imagery-layer:generate-raster-info","the rendering rule is not supported");if(this._functionRasterInfos[s])return this._functionRasterInfos[s];const o={...n,query:this._getQueryParams()},a=n$e(r(this.parsedUrl),i,o);this._functionRasterInfos[s]=a;try{return await a}catch(c){throw this._functionRasterInfos[s]=null,c}}getExportImageServiceParameters(i,n,s,o){var _;i=i.clone().shiftCentralMeridian();const a=a0(i.spatialReference,r(this.parsedUrl));this.pixelType!==this.serviceRasterInfo.pixelType&&(this.exportImageServiceParameters.pixelType=this.pixelType);const u=this.exportImageServiceParameters.toJSON(),{bandIds:c,noData:h}=u;let{renderingRule:d}=u;const y=(_=this.rasterFunction)==null?void 0:_.rasterFunctionDefinition,v=!this.renderer||this.renderer.type==="raster-stretch";if(c!=null&&c.length&&this._hasRasterFunction(this.rasterFunction)&&!y&&v){const x={rasterFunction:"ExtractBand",rasterFunctionArguments:{BandIds:c}};if(d.rasterFunction==="Stretch")x.rasterFunctionArguments.Raster=d.rasterFunctionArguments.Raster,d.rasterFunctionArguments.Raster=x;else if(d.rasterFunction==="Colormap"){const T=d.rasterFunctionArguments.Raster;(T==null?void 0:T.rasterFunction)==="Stretch"?(x.rasterFunctionArguments.Raster=T.rasterFunctionArguments.Raster,T.rasterFunctionArguments.Raster=x):(x.rasterFunctionArguments.Raster=T,d.rasterFunctionArguments.Raster=x)}else x.rasterFunctionArguments.Raster=d,d=x;u.bandIds=void 0}else u.bandIds=c==null?void 0:c.join(",");h instanceof Array&&h.length>0&&(u.noData=h.join(","));const w=this._processMultidimensionalIntersection(null,o,this.exportImageServiceParameters.mosaicRule);if(w.isOutSide)return null;u.mosaicRule=w.mosaicRule!=null?JSON.stringify(w.mosaicRule):null,o=w.timeExtent,u.renderingRule=this._getRenderingRuleString(vt.fromJSON(d));const b={};if(o!=null){const{start:x,end:T}=o.toJSON();x&&T&&x===T?b.time=""+x:x==null&&T==null||(b.time=`${x??"null"},${T??"null"}`)}return{bbox:i.xmin+","+i.ymin+","+i.xmax+","+i.ymax,bboxSR:a,imageSR:a,size:n+","+s,...u,...b}}async getSamples(i,n){const s=await this._fetchCapabilities(n==null?void 0:n.signal);if(!(s!=null&&s.operations.supportsGetSamples))throw new z("imagery-layer:get-samples","getSamples operation is not supported on the input image service");i=rr(m$e,i).clone();const{raster:o}=this;return o&&i.raster==null&&(i.raster=o),jMe(this.url,i,this._getRequestOptions(n))}async identify(i,n){var u;if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsIdentify)throw new z("imagery-layer:identify","identify operation is not supported on the input image service");i=rr(o7,i).clone(),this.version<10.91&&((u=i.geometry)==null?void 0:u.type)==="extent"&&(i.geometry=Ss.fromExtent(i.geometry));const s=this._processMultidimensionalIntersection(i.geometry,i.timeExtent,i.mosaicRule||this.mosaicRule);if(s.isOutSide)throw new z("imagery-layer:identify","the request cannot be fulfilled when falling outside of the multidimensional subset");i.timeExtent=s.timeExtent,i.mosaicRule=s.mosaicRule;const{raster:o,rasterFunction:a}=this;return a&&i.rasterFunction==null&&(i.rasterFunction=a),o&&i.raster==null&&(i.raster=o),r7(this.url,i,this._getRequestOptions(n))}async imageToMap(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsImageToMap)throw new z("imagery-layer:image-to-map","imageToMap operation is not supported on the input image service");return i=rr(v$e,i),JMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async imageToMapMultiray(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsImageToMapMultiray)throw new z("imagery-layer:image-to-map-multiray","imageToMapMultiray operation is not supported on the input image service");return i=rr(g$e,i),ZMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async mapToImage(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsMapToImage)throw new z("imagery-layer:map-to-image","mapToImage operation is not supported on the input image service");return i=rr(b$e,i),YMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async findImages(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsFindImages)throw new z("imagery-layer:find-images","findImages operation is not supported on the input image service");return i=rr(a$e,i),XMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async getImageUrl(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsGetImageUrl)throw new z("imagery-layer:get-image-url","getImageUrl operation is not supported on the input image service");return i=rr(w$e,i),KMe(r(this.parsedUrl),i,this._getRequestOptions(n))}createQuery(){const i=new $i;return i.outFields=["*"],i.returnGeometry=!0,i.where=this.definitionExpression||"1=1",i}async queryBoundary(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsQueryBoundary)throw new z("imagery-layer:query-boundary","queryBoundary operation is not supported on the input image service");return i=rr(c$e,i??{outSpatialReference:this.spatialReference}).clone(),HMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async queryRasters(i,n){return{query:i,requestOptions:n}=await this._prepareForQuery(i,n),DSe(this.url,i,n)}async queryObjectIds(i,n){return{query:i,requestOptions:n}=await this._prepareForQuery(i,n),KJ(this.url,i,n)}async queryGPSInfo(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsQueryGPSInfo)throw new z("imagery-layer:query-gps-info","queryGPSInfo operation is not supported on the input image service");return i=rr(h$e,i??{outSpatialReference:this.spatialReference}).clone(),WMe(r(this.parsedUrl),i,this._getRequestOptions(n))}async queryRasterCount(i,n){return{query:i,requestOptions:n}=await this._prepareForQuery(i,n),YJ(this.url,i,n)}async queryVisibleRasters(i,n){var $,A,R,L;if(!i)throw new z("imagery-layer: query-visible-rasters","missing query parameter");await this.load();const{pixelSize:s,returnDomainValues:o,returnTopmostRaster:a,showNoDataRecords:u}=n||{pixelSize:null,returnDomainValues:!1,returnTopmostRaster:!1,showNoDataRecords:!1};let c=!1,h=null,d=null;const y="raster.servicepixelvalue",v=this._rasterFunctionNamesIndex;if(i.outFields!=null&&(c=i.outFields.some(C=>!C.toLowerCase().includes(y)),this.version>=10.4)){const C=i.outFields.filter(F=>F.toLowerCase().includes(y)&&F.length>y.length).map(F=>{const j=F.slice(y.length+1);return[this._updateRenderingRulesFunctionName(j,v),j]});h=C.map(F=>new vt({functionName:F[0]})),d=C.map(F=>F[1]);const{rasterFunction:U}=this;h.length===0?U!=null&&U.functionName?(h.push(U),d.push(U.functionName)):h=null:U!=null&&U.functionName&&!h.some(F=>F.functionName===U.functionName)&&(h.push(U),d.push(U.functionName))}const w=i.outSpatialReference==null||i.outSpatialReference.equals(this.spatialReference),{multidimensionalSubset:b}=this;let _=i.timeExtent||this.timeExtent;if(b){const{isOutside:C,intersection:U}=OM(b,{geometry:i.geometry,timeExtent:i.timeExtent,multidimensionalDefinition:($=this.exportImageServiceParameters.mosaicRule)==null?void 0:$.multidimensionalDefinition});if(C)throw new z("imagery-layer:query-visible-rasters","the request cannot be fulfilled when falling outside of the multidimensional subset");(U==null?void 0:U.timeExtent)!=null&&(_=U.timeExtent)}const x=this._combineMosaicRuleWithTimeExtent(this.exportImageServiceParameters.mosaicRule,_);let T=i.geometry;this.version<10.91&&(T==null?void 0:T.type)==="extent"&&(T=Ss.fromExtent(T));const I=this._getQueryParams({geometry:T,timeExtent:_,mosaicRule:x,rasterFunction:this.version<10.4?this.rasterFunction:null,rasterFunctions:h,pixelSize:s,returnCatalogItems:c,returnGeometry:w,raster:this.raster,maxItemCount:a?1:null});delete I.f;const M=new o7(I);try{await this._generateRasterInfo(this.rasterFunction);const C=await r7(this.url,M,{signal:n==null?void 0:n.signal,query:{...this.customParameters}}),U=i.outFields,F=C.value!=null&&C.value.toLowerCase().includes("nodata");if(!(c&&!w&&((A=C==null?void 0:C.catalogItems)!=null&&A.features.length)&&(u||!F)))return this._processVisibleRastersResponse(C,{returnDomainValues:o,templateRRFunctionNames:d,showNoDataRecords:u,templateFields:U});const j=this.objectIdField||"ObjectId",q=((R=C.catalogItems)==null?void 0:R.features)??[],K=q.map(re=>{var ae;return(ae=re.attributes)==null?void 0:ae[j]}),X=new $i({objectIds:K,returnGeometry:!0,outSpatialReference:i.outSpatialReference,outFields:[j]}),ne=await this.queryRasters(X);return(L=ne==null?void 0:ne.features)!=null&&L.length&&ne.features.forEach(re=>{q.forEach(ae=>{ae.attributes[j]===re.attributes[j]&&(ae.geometry=new Ss(re.geometry),i.outSpatialReference!=null&&(ae.geometry.spatialReference=i.outSpatialReference))})}),this._processVisibleRastersResponse(C,{returnDomainValues:o,templateRRFunctionNames:d,showNoDataRecords:u,templateFields:U})}catch{throw new z("imagery-layer:query-visible-rasters","encountered error when querying visible rasters")}}async fetchVariableStatisticsHistograms(i,n){const s=be(r(this.parsedUrl)+"/statistics",{query:this._getQueryParams({variable:i}),signal:n}).then(u=>{var c;return(c=u.data)==null?void 0:c.statistics}),o=be(r(this.parsedUrl)+"/histograms",{query:this._getQueryParams({variable:i}),signal:n}).then(u=>{var c;return(c=u.data)==null?void 0:c.histograms}),a=await Promise.all([s,o]);return a[0]&&a[0].forEach(u=>{u.avg=u.mean,u.stddev=u.standardDeviation}),{statistics:a[0]||null,histograms:a[1]||null}}async createFlowMesh(i,n){const s=this._rasterJobHandler.instance;return s?s.createFlowMesh(i,n):S$e(i.meshType,i.simulationSettings,i.flowData,n.signal!=null?n.signal:new AbortController().signal)}getMultidimensionalSubsetVariables(i){const n=i??this.serviceRasterInfo.multidimensionalInfo;return QIe(this.multidimensionalSubset,n)}async _fetchService(i){await this._fetchServiceInfo(i),this.rasterInfo||(this.rasterInfo=this.serviceRasterInfo);const n=this.sourceJSON,s=this.serviceRasterInfo!=null?Promise.resolve(this.serviceRasterInfo):i$e(r(this.parsedUrl),n,{signal:i,query:this._getQueryParams()}).then(u=>(this._set("serviceRasterInfo",u),this._set("multidimensionalInfo",u.multidimensionalInfo),s$e(u,n),u)),o=this._hasRasterFunction(this.rasterFunction)?this._generateRasterInfo(this.rasterFunction,{signal:i}):null,a=this._getRasterFunctionInfos();return Promise.all([s,o,a]).then(u=>{u[1]?this._set("rasterInfo",u[1]):this._set("rasterInfo",u[0]),u[2]&&this._set("rasterFunctionInfos",u[2]),this.renderer&&!this._isSupportedRenderer(this.renderer)&&(this._set("renderer",null),oe.getLogger(this).warn("ArcGISImageService","Switching to the default renderer. Renderer applied is not valid for this Imagery Layer")),this._set("renderer",this._configRenderer(this.renderer)),this.addHandles([Ue(()=>this.rasterFunction,h=>{(this.renderer||this.symbolizer||this.popupEnabled&&this.popupTemplate)&&this._generateRasterInfo(h).then(d=>{d&&(this.rasterInfo=d)})})]);const{serviceRasterInfo:c}=this;c.multidimensionalInfo!=null&&this._updateMultidimensionalDefinition(c)})}_combineMosaicRuleWithTimeExtent(i,n){var b;const s=this.timeInfo,{multidimensionalInfo:o}=this.serviceRasterInfo;if(i==null||o==null||n==null||(s==null?void 0:s.startField)==null)return i;const{startField:a}=s,u=o.variables.some(_=>_.dimensions.some(x=>x.name===a))?a:"StdTime";if(i=i.clone(),this.sourceType==="mosaic-dataset")return i.multidimensionalDefinition=(b=i.multidimensionalDefinition)==null?void 0:b.filter(_=>_.dimensionName!==u),this._cleanupMultidimensionalDefinition(i);i.multidimensionalDefinition=i.multidimensionalDefinition||[];const c=i.multidimensionalDefinition.filter(_=>_.dimensionName===u),h=n.start!=null?n.start.getTime():null,d=n.end!=null?n.end.getTime():null,y=h==null||d==null||h===d,v=y?[h||d]:[[h,d]],w=this.version>=10.8;if(c.length)c.forEach(_=>{_.dimensionName===u&&(w?(_.dimensionName=null,_.isSlice=!1,_.values=[]):(_.isSlice=y,_.values=v))});else if(!w){const _=i.multidimensionalDefinition.filter(x=>x.variableName!=null&&x.dimensionName==null);_.length?_.forEach(x=>{x.dimensionName=u,x.isSlice=y,x.values=v}):i.multidimensionalDefinition.push(new Nm({variableName:"",dimensionName:u,isSlice:y,values:v}))}return this._cleanupMultidimensionalDefinition(i)}_cleanupMultidimensionalDefinition(i){return i==null?null:(i.multidimensionalDefinition&&(i.multidimensionalDefinition=i.multidimensionalDefinition.filter(n=>!(!n.variableName&&!n.dimensionName)),i.multidimensionalDefinition.length===0&&(i.multidimensionalDefinition=null)),this.sourceType!=="mosaic-dataset"&&i.multidimensionalDefinition==null?null:i)}async _prepareForQuery(i,n){if(!(await this._fetchCapabilities(n==null?void 0:n.signal)).operations.supportsQuery)throw new z("imagery-layer:query-rasters","query operation is not supported on the input image service");return i=i!=null?rr($i,i):this.createQuery(),n=this._getRequestOptions(n),this.raster&&(n.query={...n.query,raster:this.raster}),{query:i,requestOptions:n}}async _initJobHandler(){if(this._rasterJobHandler.connectionPromise!=null)return this._rasterJobHandler.connectionPromise;const i=new JIe;this._rasterJobHandler.connectionPromise=i.initialize().then(()=>{this._rasterJobHandler.instance=i},()=>{}),await this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null}_isSupportedRenderer(i){const{rasterInfo:n,rasterFunction:s}=this;return i.type==="unique-value"&&this._hasRasterFunction(s)&&(n==null?void 0:n.bandCount)===1&&["u8","s8"].includes(n.pixelType)||n!=null&&i!=null&&Y3e(n).includes(i.type)}async _fetchCapabilities(i){return this.capabilities||await this._fetchServiceInfo(i),this.capabilities}async _fetchServiceInfo(i){var s;let n=this.sourceJSON;if(!n){const{data:o,ssl:a}=await be(r(this.parsedUrl),{query:this._getQueryParams(),signal:i});n=o,this.sourceJSON=n,a&&(this.url=this.url.replace(/^http:/i,"https:"))}if(((s=n.capabilities)==null?void 0:s.toLowerCase().split(",").map(o=>o.trim()).indexOf("tilesonly"))>-1)throw new z("imagery-layer:fetch-service-info","use ImageryTileLayer to open tiles-only image services");this.read(n,{origin:"service",url:this.parsedUrl})}_isMosaicDataset(i){var n;return i.serviceSourceType?i.serviceSourceType==="esriImageServiceSourceTypeMosaicDataset":((n=i.fields)==null?void 0:n.length)>0}_isMosaicRuleSupported(i){var o;if(!i)return!1;const n=this._isMosaicDataset(i),s=i.currentVersion>=10.71&&i.hasMultidimensions&&!(((o=i.fields)==null?void 0:o.length)>1);return n||s}_isVectorFieldResampleFunction(i){if(i==null)return!1;const{functionName:n,functionArguments:s}=i,o=(n==null?void 0:n.toLowerCase())==="resample",a=(s==null?void 0:s.ResampleType)||(s==null?void 0:s.resampleType);return o&&(a===7||a===10)}_isPicture(){return!this.format||this.format.includes("jpg")||this.format.includes("png")}_configRenderer(i){var o,a;const n=this._isPicture(),{rasterInfo:s}=this;if(!n&&!this.pixelFilter||this._isVectorDataSet()){if(!this.bandIds&&s.bandCount>=3){const c=xY(s);!c||s.bandCount===3&&c[0]===0&&c[1]===1&&c[2]===2||(this.bandIds=c)}i||(i=Z3e(s,{bandIds:this.bandIds,variableName:this.rasterFunction?null:(a=(o=this.mosaicRule)==null?void 0:o.multidimensionalDefinition)==null?void 0:a[0].variableName}));const u=oMe(i.toJSON());this.symbolizer?(this.symbolizer.rendererJSON=u,this.symbolizer.rasterInfo=s):this.symbolizer=new mMe({rendererJSON:u,rasterInfo:s}),this.symbolizer.bind().success||(this.symbolizer=null)}return i}_clonePixelData(i){return i==null?i:{extent:i.extent&&i.extent.clone(),pixelBlock:i.pixelBlock!=null?i.pixelBlock.clone():null}}_getQueryParams(i){(i==null?void 0:i.renderingRule)!=null&&typeof i.renderingRule!="string"&&(i.renderingRule=this._getRenderingRuleString(i.renderingRule));const{raster:n,viewId:s}=this;return{raster:n,viewId:s,f:"json",...i,...this.customParameters}}_getRequestOptions(i){return{...i,query:{...i==null?void 0:i.query,...this.customParameters}}}_decodePixelBlock(i,n,s){return this._rasterJobHandler.instance?this._rasterJobHandler.instance.decode({data:i,options:n}):Zj(i,n,s)}async _getRasterFunctionInfos(i){var s;const n=this.sourceJSON.rasterFunctionInfos;return this.loaded?n:n&&this.version>=10.3?n.length===1&&n[0].name.toLowerCase()==="none"?n:(s=(await be(r(this.parsedUrl)+"/rasterFunctionInfos",{query:this._getQueryParams(),signal:i})).data)==null?void 0:s.rasterFunctionInfos:null}_canRequestImageElement(i){return!this.pixelFilter&&(!i||i.includes("png"))}async _requestArrayBuffer(i){const{imageProps:n,requestAsImageElement:s,returnImageBitmap:o,signal:a}=i;if(s&&this._canRequestImageElement(n.format)){const b=`${r(this.parsedUrl)}/exportImage`,{data:_}=await be(b,{responseType:o?"blob":"image",query:this._getQueryParams({f:"image",...this.refreshParameters,...i.imageServiceParameters}),signal:a});return _ instanceof Blob?{imageBitmap:await ux(_,b,a),params:n}:{imageOrCanvasElement:_,params:n}}const u=this._initJobHandler(),c=be(r(this.parsedUrl)+"/exportImage",{responseType:"array-buffer",query:this._getQueryParams({f:"image",...i.imageServiceParameters}),signal:a}),h=(await Promise.all([c,u]))[0].data,d=n.format||"jpgpng";let y=d;if(y!=="bsq"&&y!=="bip"&&(y=B3e(h)),!y)throw new z("imagery-layer:fetch-image","unsupported format signature "+String.fromCharCode.apply(null,new Uint8Array(h)));const v={signal:a};return{pixelData:{pixelBlock:await(d==="gif"||d==="bmp"||d.includes("png")&&(y==="png"||y==="jpg")?Zj(h,{useCanvas:!0,...n},v):this._decodePixelBlock(h,{width:n.width,height:n.height,planes:null,pixelType:null,noDataValue:null,format:d},v)),extent:n.extent},params:n}}_generateRasterInfo(i,n){return this.generateRasterInfo(i,n).catch(()=>null)}_isValidCustomizedMosaicRule(i){var n;return i&&JSON.stringify(i.toJSON())!==JSON.stringify((n=this.defaultMosaicRule)==null?void 0:n.toJSON())}_updateMultidimensionalDefinition(i){var s;if(this._isValidCustomizedMosaicRule(this.mosaicRule))return;let n=XIe(i,{multidimensionalSubset:this.multidimensionalSubset});if(n!=null&&n.length>0){this.mosaicRule=this.mosaicRule||new Hs;const o=this.mosaicRule.multidimensionalDefinition;!this.sourceJSON.defaultVariableName&&this.rasterFunction&&((s=this.rasterFunction.functionName)==null?void 0:s.toLowerCase())!=="none"&&n.forEach(a=>a.variableName=""),n=n.filter(({variableName:a,dimensionName:u})=>a&&a!=="*"||u),!(o!=null&&o.length)&&n.length&&(this.mosaicRule.multidimensionalDefinition=n)}}_processVisibleRastersResponse(i,n){var I,M,$;n=n||{};const s=i.value,{templateRRFunctionNames:o,showNoDataRecords:a,returnDomainValues:u,templateFields:c}=n,h=i.processedValues;let d=(I=i.catalogItems)==null?void 0:I.features,y=(($=(M=i.properties)==null?void 0:M.Values)==null?void 0:$.map(A=>A.replaceAll(/ /gi,", ")))||[];const v=this.objectIdField||"ObjectId",w=typeof s=="string"&&s.toLowerCase().includes("nodata"),b=[];if(s&&!d&&!w){const A={};A[v]=0,y=[s],d=[new Da(this.fullExtent,null,A)]}if(!d)return[];let _,x,T;this._updateResponseFieldNames(d,c),w&&!a&&(d=[]);for(let A=0;A<d.length;A++){if(_=d[A],s!=null){if(x=y[A],T=this.rasterFunction&&h&&h.length>0&&o&&o.length>0&&o.includes(this.rasterFunction.functionName)?h[o.indexOf(this.rasterFunction.functionName)]:s,x.toLowerCase()==="nodata"&&!a)continue;const R="Raster.ItemPixelValue",L="Raster.ServicePixelValue";_.attributes[R]=x,_.attributes[L]=T,this._updateFeatureWithMagDirValues(_,x);const C=this.fields&&this.fields.length>0;let U=this.rasterFunction&&this.serviceRasterInfo.attributeTable!=null?C?x:s:T;this.rasterFunction||(U=C?x:s),this._updateFeatureWithRasterAttributeTableValues(_,U)}if(_.sourceLayer=_.layer=this,u&&this._updateFeatureWithDomainValues(_),o&&h&&o.length===h.length)for(let R=0;R<o.length;R++){const L="Raster.ServicePixelValue."+o[R];_.attributes[L]=h[R]}b.push(d[A])}return b}_processMultidimensionalIntersection(i,n,s){const{multidimensionalSubset:o}=this;if(!o)return{isOutSide:!1,timeExtent:n,mosaicRule:s=this._combineMosaicRuleWithTimeExtent(s,n)};if(o){const{isOutside:a,intersection:u}=OM(o,{geometry:i,timeExtent:n});if(a)return{isOutSide:!0,timeExtent:null,mosaicRule:null};(u==null?void 0:u.timeExtent)!=null&&(n=u.timeExtent)}if(s=this._combineMosaicRuleWithTimeExtent(s,n),s==null?void 0:s.multidimensionalDefinition){const{isOutside:a}=OM(o,{multidimensionalDefinition:s.multidimensionalDefinition});if(a)return{isOutSide:!0,timeExtent:null,mosaicRule:null}}return{isOutSide:!1,timeExtent:n,mosaicRule:s}}_updateFeatureWithRasterAttributeTableValues(i,n){const s=this.rasterInfo.attributeTable||this.serviceRasterInfo.attributeTable;if(s==null)return;const{features:o,fields:a}=s,u=a.map(h=>h.name).find(h=>h.toLowerCase()==="value");if(!u)return;const c=o.filter(h=>h.attributes[u]===(n!=null?parseInt(n,10):null));c&&c[0]&&a.forEach(h=>{const d=this._rasterAttributeTableFieldPrefix+h.name;i.attributes[d]=c[0].attributes[h.name]})}_updateFeatureWithMagDirValues(i,n){if(!this._isVectorDataSet())return;const s=n.split(/,\s*/).map(h=>parseFloat(h)),o=s.map(h=>[h]),a=s.map(h=>({minValue:h,maxValue:h,noDataValue:null})),u=new Ye({height:1,width:1,pixelType:"f32",pixels:o,statistics:a});this.pixelFilter!=null&&this.pixelFilter({pixelBlock:u,extent:new Ne(0,0,0,0,this.spatialReference)});const c=this.serviceDataType==="esriImageServiceDataTypeVector-MagDir"?[u.pixels[0][0],u.pixels[1][0]]:CP([u.pixels[0][0],u.pixels[1][0]]);i.attributes["Raster.Magnitude"]=c[0],i.attributes["Raster.Direction"]=c[1]}_updateFeatureWithDomainValues(i){const n=this.fields&&this.fields.filter(s=>s.domain&&s.domain.type==="coded-value");n!=null&&n.forEach(s=>{const o=i.attributes[s.name];if(o!=null){const a=s.domain.codedValues.find(u=>u.code===o);a&&(i.attributes[s.name]=a.name)}})}_updateResponseFieldNames(i,n){if(!n||n.length<1)return;const s=this.fieldsIndex;s!=null&&i.forEach(o=>{var a;if(o!=null&&o.attributes)for(const u of n){const c=(a=s.get(u))==null?void 0:a.name;c&&c!==u&&(o.attributes[u]=o.attributes[c],delete o.attributes[c])}})}_getRenderingRuleString(i){if(i){let n=i.toJSON();return n=n.rasterFunctionDefinition??n,(n.thumbnail||n.thumbnailEx)&&(n.thumbnail=n.thumbnailEx=null),JSON.stringify(n)}return null}_hasRasterFunction(i){return(i==null?void 0:i.functionName)!=null&&i.functionName.toLowerCase()!=="none"}_updateRenderingRulesFunctionName(i,n){if(!i||i.length<1)return;if(i==="Raw")return i.replace("Raw","None");const s=i.toLowerCase().replaceAll(/ /gi,"_");return n.has(s)?n.get(s):i}_isRFTJson(i){return(i==null?void 0:i.name)&&i.arguments&&i.function&&i.hasOwnProperty("functionType")}_isVectorDataSet(){return this.serviceDataType==="esriImageServiceDataTypeVector-UV"||this.serviceDataType==="esriImageServiceDataTypeVector-MagDir"}_applyMosaicAndRenderingRules(i){const{raster:n,mosaicRule:s,rasterFunction:o}=this;o&&i instanceof FM&&i.rasterFunction==null&&(i.rasterFunction=o),s&&i.mosaicRule==null&&(i.mosaicRule=s),n&&i.raster==null&&(i.raster=n)}_readCapabilities(i){var x;const n=i.capabilities?i.capabilities.toLowerCase().split(",").map(T=>T.trim()):["image","catalog"],{currentVersion:s,advancedQueryCapabilities:o,maxRecordCount:a}=i,u=n.includes("image"),c=i.serviceDataType==="esriImageServiceDataTypeElevation",h=!(!i.spatialReference&&!((x=i.extent)!=null&&x.spatialReference)),d=n.includes("edit"),y=n.includes("mensuration")&&h,v=i.mensurationCapabilities==null?[]:i.mensurationCapabilities.toLowerCase().split(",").map(T=>T.trim()),w=y&&v.includes("basic"),b=this._isMosaicDataset(i)&&n.includes("catalog"),_=n.includes("download");return{data:{supportsAttachment:!1},operations:{supportsComputeHistograms:u,supportsExportImage:u,supportsIdentify:u,supportsImageToMap:s>=11.2&&b,supportsImageToMapMultiray:s>=11.2&&b,supportsMapToImage:s>=11.2&&b,supportsFindImages:s>=11.2&&b,supportsGetImageUrl:s>=11.2&&_,supportsMeasure:y,supportsMeasureFromImage:s>=11.2,supportsDownload:_,supportsQuery:b&&i.fields&&i.fields.length>0,supportsGetSamples:s>=10.2&&u,supportsProject:s>=10.3&&u,supportsComputeStatisticsHistograms:s>=10.4&&u,supportsQueryBoundary:s>=10.6&&u,supportsCalculateVolume:s>=10.7&&c,supportsComputePixelLocation:s>=10.7&&b,supportsComputeAngles:s>=10.91,supportsQueryGPSInfo:s>=11.2&&b,supportsAdd:d,supportsDelete:d,supportsEditing:d,supportsUpdate:d,supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsChangeTracking:!1,supportsQueryAttachments:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsExceedsLimitStatistics:!1,supportsQueryAnalytics:!1,supportsQueryTopFeatures:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:a,maxRecordCountFactor:void 0,supportsStatistics:!!(o!=null&&o.supportsStatistics),supportsOrderBy:!!(o!=null&&o.supportsOrderBy),supportsDistinct:!!(o!=null&&o.supportsDistinct),supportsPagination:!!(o!=null&&o.supportsPagination),supportsStandardizedQueriesOnly:!!(o!=null&&o.useStandardizedQueries),supportsPercentileStatistics:!!(o!=null&&o.supportsPercentileStatistics),supportsCentroid:!!(o!=null&&o.supportsReturningGeometryCentroid),supportsDistance:!!(o!=null&&o.supportsQueryWithDistance),supportsExtent:!!(o!=null&&o.supportsReturningQueryExtent),supportsGeometryProperties:!!(o!=null&&o.supportsReturningGeometryProperties),supportsHavingClause:!!(o!=null&&o.supportsHavingClause),supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsMaxRecordCountFactor:!1,supportsSqlExpression:!1,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!1,supportsCacheHint:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!!(o!=null&&o.supportsDefaultSR),supportsFullTextSearch:!1,supportsCompactGeometry:!1,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0},mensuration:{supportsDistanceAndAngle:w,supportsAreaAndPerimeter:w,supportsPointOrCentroid:w,supportsHeightFromBaseAndTop:y&&v.includes("base-top height"),supportsHeightFromBaseAndTopShadow:y&&v.includes("base-top shadow height"),supportsHeightFromTopAndTopShadow:y&&v.includes("top-top shadow height"),supports3D:y&&v.includes("3d")}}}};function r(i){return(i==null?void 0:i.path)??""}return l([p({clonable:!1})],t.prototype,"_functionRasterInfos",void 0),l([p({clonable:!1})],t.prototype,"_rasterJobHandler",void 0),l([p({clonable:!1})],t.prototype,"_cachedRendererJson",void 0),l([p({readOnly:!0})],t.prototype,"_serviceSupportsMosaicRule",void 0),l([te("_serviceSupportsMosaicRule",["currentVersion","fields"])],t.prototype,"readServiceSupportsMosaicRule",null),l([p({readOnly:!0})],t.prototype,"_rasterAttributeTableFieldPrefix",void 0),l([p({readOnly:!0})],t.prototype,"_rasterFunctionNamesIndex",null),l([p()],t.prototype,"adjustAspectRatio",void 0),l([p({type:[Ke],json:{write:!0}})],t.prototype,"bandIds",void 0),l([te("bandIds")],t.prototype,"readBandIds",null),l([p({readOnly:!0,json:{read:!1}})],t.prototype,"capabilities",void 0),l([te("service","capabilities",["capabilities","currentVersion","serviceDataType"])],t.prototype,"readCapabilities",null),l([p({type:Number})],t.prototype,"compressionQuality",void 0),l([se("compressionQuality")],t.prototype,"writeCompressionQuality",null),l([p({type:Number})],t.prototype,"compressionTolerance",void 0),l([se("compressionTolerance")],t.prototype,"writeCompressionTolerance",null),l([p({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),l([p({readOnly:!0,dependsOn:["_serviceSupportsMosaicRule"]})],t.prototype,"defaultMosaicRule",void 0),l([te("defaultMosaicRule",["defaultMosaicMethod"])],t.prototype,"readDefaultMosaicRule",null),l([p({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],t.prototype,"definitionExpression",void 0),l([p({readOnly:!0,constructOnly:!0})],t.prototype,"exportImageServiceParameters",void 0),l([p()],t.prototype,"rasterInfo",void 0),l([p({readOnly:!0,type:[Po]})],t.prototype,"fields",void 0),l([p({readOnly:!0})],t.prototype,"fieldsIndex",null),l([p({type:["png","png8","png24","png32","jpg","bmp","gif","jpgpng","lerc","tiff"],json:{write:!0}})],t.prototype,"format",null),l([te("service","format",["serviceDataType"])],t.prototype,"readFormat",null),l([p({type:Ne})],t.prototype,"fullExtent",void 0),l([p({readOnly:!0})],t.prototype,"hasMultidimensions",void 0),l([p({json:{read:{source:"maxImageHeight"}}})],t.prototype,"imageMaxHeight",void 0),l([p({json:{read:{source:"maxImageWidth"}}})],t.prototype,"imageMaxWidth",void 0),l([p({type:String,json:{type:bp.jsonValues,read:bp.read,write:bp.write}})],t.prototype,"interpolation",void 0),l([p()],t.prototype,"minScale",void 0),l([te("service","minScale")],t.prototype,"readMinScale",null),l([p()],t.prototype,"maxScale",void 0),l([te("service","maxScale")],t.prototype,"readMaxScale",null),l([p({type:Hs})],t.prototype,"mosaicRule",null),l([te("mosaicRule",["mosaicRule","defaultMosaicMethod"])],t.prototype,"readMosaicRule",null),l([se("mosaicRule")],t.prototype,"writeMosaicRule",null),l([p()],t.prototype,"multidimensionalInfo",void 0),l([p({type:bIe,json:{write:!0}})],t.prototype,"multidimensionalSubset",void 0),l([p({json:{type:Ke}})],t.prototype,"noData",void 0),l([se("noData")],t.prototype,"writeNoData",null),l([p({type:String,json:{type:G1.jsonValues,read:G1.read,write:G1.write}})],t.prototype,"noDataInterpretation",void 0),l([p({type:String,readOnly:!0,json:{read:{source:["fields"]}}})],t.prototype,"objectIdField",void 0),l([te("objectIdField")],t.prototype,"readObjectIdField",null),l([p({readOnly:!0})],t.prototype,"geometryType",void 0),l([p({})],t.prototype,"typeIdField",void 0),l([p({})],t.prototype,"types",void 0),l([p({readOnly:!0})],t.prototype,"parsedUrl",null),l([p({type:Function})],t.prototype,"pixelFilter",void 0),l([p()],t.prototype,"raster",void 0),l([p({readOnly:!0})],t.prototype,"sourceType",void 0),l([te("sourceType",["serviceSourceType","fields"])],t.prototype,"readSourceType",null),l([p()],t.prototype,"viewId",void 0),l([p({types:TR,json:{name:"layerDefinition.drawingInfo.renderer",origins:{"web-scene":{types:IR,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:i=>({enabled:i&&i.type!=="vector-field"&&i.type!=="flow"})}}}}})],t.prototype,"renderer",null),l([te("renderer")],t.prototype,"readRenderer",null),l([se("renderer")],t.prototype,"writeRenderer",null),l([p({clonable:!1})],t.prototype,"symbolizer",void 0),l([p(ox)],t.prototype,"opacity",void 0),l([p({readOnly:!0})],t.prototype,"rasterFields",null),l([p({constructOnly:!0})],t.prototype,"rasterFunctionInfos",void 0),l([p({type:vt})],t.prototype,"renderingRule",null),l([p({type:vt,json:{name:"renderingRule"}})],t.prototype,"rasterFunction",null),l([te("rasterFunction",["renderingRule","rasterFunctionInfos"])],t.prototype,"readRasterFunction",null),l([p({readOnly:!0})],t.prototype,"serviceDataType",void 0),l([p({readOnly:!0,type:xe})],t.prototype,"spatialReference",void 0),l([te("spatialReference",["spatialReference","extent"])],t.prototype,"readSpatialReference",null),l([p({json:{type:am.jsonValues}})],t.prototype,"pixelType",void 0),l([te("pixelType")],t.prototype,"readPixelType",null),l([se("pixelType")],t.prototype,"writePixelType",null),l([p({constructOnly:!0,type:GT})],t.prototype,"serviceRasterInfo",void 0),l([p()],t.prototype,"sourceJSON",void 0),l([p(Qv)],t.prototype,"url",void 0),l([p({readOnly:!0})],t.prototype,"version",void 0),l([te("version",["currentVersion","fields","timeInfo"])],t.prototype,"readVersion",null),t=l([k("esri.layers.mixins.ArcGISImageService")],t),t};var vl;(function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"})(vl||(vl={}));let js=class extends zp(IT(Zp(qp(Jp(P$e(xf(rw(tw(kl(It(Yu))))))))))){constructor(...t){super(...t),this.isReference=null,this.operationalLayerType="ArcGISImageServiceLayer",this.popupEnabled=!0,this.popupTemplate=null,this.type="imagery",this._debouncedSaveOperations=Bx(async(r,i,n)=>{const{save:s,saveAs:o}=await ge(()=>import("./imageryUtils-GMZjiKLG.js"),__vite__mapDeps([123,124,125,126,127,1,2,128]));switch(r){case vl.SAVE:return s(this,i);case vl.SAVE_AS:return o(this,n,i)}})}normalizeCtorArgs(t,r){return typeof t=="string"?{url:t,...r}:t}load(t){const r=t!=null?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"]},t).catch(Ti).then(()=>this._fetchService(r))),Promise.resolve(this)}get legendEnabled(){return!this._isPreviewLayer&&(this._get("legendEnabled")??!0)}set legendEnabled(t){this._set("legendEnabled",t)}get listMode(){return this._isPreviewLayer?"hide":this._get("listMode")}set listMode(t){this._set("listMode",t)}writeOperationalLayerType(t,r,i){var s;const n=((s=this.renderer)==null?void 0:s.type)==="vector-field";r[i]=n?"ArcGISImageServiceVectorLayer":"ArcGISImageServiceLayer"}get defaultPopupTemplate(){return this.createPopupTemplate()}get _isPreviewLayer(){var t;return!(!this.raster||!((t=this.url)!=null&&t.toLowerCase().includes("/rasterrendering/imageserver")))}createPopupTemplate(t){var c;const r=this.rasterFields,i=this.title,n=new Set;let s=!1,o=!1;this.capabilities&&(s=this.capabilities.operations.supportsQuery&&this.fields&&this.fields.length>0,o=this.serviceDataType==="esriImageServiceDataTypeVector-UV"||this.serviceDataType==="esriImageServiceDataTypeVector-MagDir");const a=new Set;s&&a.add("raster.itempixelvalue");for(const h of r){const d=h.name.toLowerCase();a.has(d)||d.includes("raster.servicepixelvalue.")||n.add(h.name)}o&&n.add("raster.magnitude").add("raster.direction");const u=TP({fields:r,title:i},{...t,visibleFieldNames:n});return u!=null&&u.fieldInfos&&((c=this.rasterInfo)!=null&&c.pixelType.startsWith("f"))&&u.fieldInfos.forEach(({format:h,fieldName:d})=>{h&&/^raster\.(item|service)pixelvalue/i.test(d)&&(h.places=2)}),u}queryFeatures(t,r){return this.queryRasters(t,r).then(i=>{if(i!=null&&i.features)for(const n of i.features)n.layer=n.sourceLayer=this;return i})}queryFeatureCount(t,r){return this.queryRasterCount(t,r)}redraw(){this.emit("redraw")}async save(t){return this._debouncedSaveOperations(vl.SAVE,t)}async saveAs(t,r){return this._debouncedSaveOperations(vl.SAVE_AS,r,t)}serviceSupportsSpatialReference(t){return IP(this,t)}write(t,r){if(!this._isPreviewLayer)return super.write(t,r);if(r!=null&&r.messages){const i=`${r.origin}/${r.layerContainerType||"operational-layers"}`;r.messages.push(new z("layer:unsupported",`Imagery preview layer (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${i}'`,{layer:this}))}return null}};l([p(j4)],js.prototype,"legendEnabled",null),l([p({type:["show","hide"]})],js.prototype,"listMode",null),l([p({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],js.prototype,"isReference",void 0),l([p({type:["ArcGISImageServiceLayer"],json:{origins:{"web-map":{type:["ArcGISImageServiceLayer","ArcGISImageServiceVectorLayer"],read:!1,write:{target:"layerType",ignoreOrigin:!0}}}}})],js.prototype,"operationalLayerType",void 0),l([se("web-map","operationalLayerType")],js.prototype,"writeOperationalLayerType",null),l([p(Xv)],js.prototype,"popupEnabled",void 0),l([p({type:Up,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],js.prototype,"popupTemplate",void 0),l([p({readOnly:!0})],js.prototype,"defaultPopupTemplate",null),l([p({readOnly:!0,json:{read:!1}})],js.prototype,"type",void 0),l([p({readOnly:!0})],js.prototype,"_isPreviewLayer",null),js=l([k("esri.layers.ImageryLayer")],js);const OY=js,lUe=Object.freeze(Object.defineProperty({__proto__:null,default:OY},Symbol.toStringTag,{value:"Module"}));var rC;let sd=rC=class extends Q{constructor(e){super(e),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new rC({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};l([p({type:String,json:{write:!0}})],sd.prototype,"expression",void 0),l([p({type:String,json:{write:!0}})],sd.prototype,"name",void 0),l([p({type:["boolean","date","number","string"],json:{write:!0}})],sd.prototype,"returnType",void 0),l([p({type:String,json:{write:!0}})],sd.prototype,"title",void 0),sd=rC=l([k("esri.form.ExpressionInfo")],sd);const L$e=sd;let od=class extends Q{constructor(t){super(t),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};l([p({type:String,json:{write:!0}})],od.prototype,"description",void 0),l([p({type:String,json:{write:!0}})],od.prototype,"label",void 0),l([p()],od.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],od.prototype,"visibilityExpression",void 0),od=l([k("esri.form.elements.Element")],od);const mf=od;var iC;let K2=iC=class extends Q{constructor(e){super(e),this.type=null}clone(){return new iC({type:this.type})}};l([p({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],K2.prototype,"type",void 0),K2=iC=l([k("esri.form.elements.inputs.AttachmentInput")],K2);const k$e=K2;var nC;let ad=nC=class extends mf{constructor(e){super(e),this.attachmentKeyword=null,this.editableExpression=null,this.input=null,this.type="attachment"}clone(){return new nC({attachmentKeyword:this.attachmentKeyword,description:this.description,editableExpression:this.editableExpression,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};l([p({type:String,json:{write:!0}})],ad.prototype,"attachmentKeyword",void 0),l([p({type:String,json:{write:!0}})],ad.prototype,"editableExpression",void 0),l([p({type:k$e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],ad.prototype,"input",void 0),l([p({type:["attachment"],json:{read:!1,write:!0}})],ad.prototype,"type",void 0),ad=nC=l([k("esri.form.elements.AttachmentElement")],ad);const c7=ad;let X2=class extends Q{constructor(t){super(t),this.type=null}};l([p()],X2.prototype,"type",void 0),X2=l([k("esri.form.elements.inputs.Input")],X2);const Xu=X2;let i1=class extends Xu{constructor(t){super(t),this.maxLength=null,this.minLength=0}};l([p({type:Number,json:{write:!0}})],i1.prototype,"maxLength",void 0),l([p({type:Number,json:{write:!0}})],i1.prototype,"minLength",void 0),i1=l([k("esri.form.elements.inputs.TextInput")],i1);const qP=i1;var sC;let Q2=sC=class extends qP{constructor(e){super(e),this.type="barcode-scanner"}clone(){return new sC({maxLength:this.maxLength,minLength:this.minLength})}};l([p({type:["barcode-scanner"],json:{read:!1,write:!0}})],Q2.prototype,"type",void 0),Q2=sC=l([k("esri.form.elements.inputs.BarcodeScannerInput")],Q2);const N$e=Q2;var oC;let Ty=oC=class extends Xu{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="combo-box"}clone(){return new oC({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};l([p({type:String,json:{write:!0}})],Ty.prototype,"noValueOptionLabel",void 0),l([p({type:Boolean,json:{write:!0}})],Ty.prototype,"showNoValueOption",void 0),l([p({type:["combo-box"],json:{read:!1,write:!0}})],Ty.prototype,"type",void 0),Ty=oC=l([k("esri.form.elements.inputs.ComboBoxInput")],Ty);const D$e=Ty;var aC;function p7(e){return e??null}function h7(e){return e??null}let il=aC=class extends Xu{constructor(e){super(e),this.max=null,this.min=null,this.type="date-picker"}readMax(e,t){return p7(t.max)}writeMax(e,t){t.max=h7(e)}readMin(e,t){return p7(t.min)}writeMin(e,t){t.min=h7(e)}clone(){return new aC({max:this.max,min:this.min})}};l([p({type:String,json:{type:String,write:!0}})],il.prototype,"max",void 0),l([te("max")],il.prototype,"readMax",null),l([se("max")],il.prototype,"writeMax",null),l([p({type:String,json:{type:String,write:!0}})],il.prototype,"min",void 0),l([te("min")],il.prototype,"readMin",null),l([se("min")],il.prototype,"writeMin",null),l([p({type:["date-picker"],json:{read:!1,write:!0}})],il.prototype,"type",void 0),il=aC=l([k("esri.form.elements.inputs.DatePickerInput")],il);const F$e=il;var lC;function jM(e){return e??null}function UM(e){return e??null}let ds=lC=class extends Xu{constructor(e){super(e),this.includeTimeOffset=!0,this.max=null,this.min=null,this.timeResolution="minutes",this.type="datetimeoffset-picker"}readMax(e,t){return jM(t.max)}writeMax(e,t){t.max=UM(e)}readMin(e,t){return jM(t.min)}writeMin(e,t){t.min=UM(e)}readTimeResolution(e,t){return jM(t.timeResolution)}writeTimeResolution(e,t){t.timeResolution=UM(e)}clone(){return new lC({includeTimeOffset:this.includeTimeOffset,max:this.max,min:this.min,timeResolution:this.timeResolution})}};l([p({type:Boolean,json:{write:!0}})],ds.prototype,"includeTimeOffset",void 0),l([p({type:String,json:{type:String,write:!0}})],ds.prototype,"max",void 0),l([te("max")],ds.prototype,"readMax",null),l([se("max")],ds.prototype,"writeMax",null),l([p({type:String,json:{type:String,write:!0}})],ds.prototype,"min",void 0),l([te("min")],ds.prototype,"readMin",null),l([se("min")],ds.prototype,"writeMin",null),l([p({type:String,json:{type:String,write:!0}})],ds.prototype,"timeResolution",void 0),l([te("timeResolution")],ds.prototype,"readTimeResolution",null),l([se("timeResolution")],ds.prototype,"writeTimeResolution",null),l([p({type:["datetimeoffset-picker"],json:{read:!1,write:!0}})],ds.prototype,"type",void 0),ds=lC=l([k("esri.form.elements.inputs.DateTimeOffsetPickerInput")],ds);const j$e=ds;var uC;function d7(e){return e!=null?new Date(e):null}function f7(e){return e?e.getTime():null}let ya=uC=class extends Xu{constructor(e){super(e),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(e,t){return d7(t.max)}writeMax(e,t){t.max=f7(e)}readMin(e,t){return d7(t.min)}writeMin(e,t){t.min=f7(e)}clone(){return new uC({includeTime:this.includeTime,max:this.max,min:this.min})}};l([p({type:Boolean,json:{write:!0}})],ya.prototype,"includeTime",void 0),l([p({type:Date,json:{type:Number,write:!0}})],ya.prototype,"max",void 0),l([te("max")],ya.prototype,"readMax",null),l([se("max")],ya.prototype,"writeMax",null),l([p({type:Date,json:{type:Number,write:!0}})],ya.prototype,"min",void 0),l([te("min")],ya.prototype,"readMin",null),l([se("min")],ya.prototype,"writeMin",null),l([p({type:["datetime-picker"],json:{read:!1,write:!0}})],ya.prototype,"type",void 0),ya=uC=l([k("esri.form.elements.inputs.DateTimePickerInput")],ya);const U$e=ya;var cC;let Iy=cC=class extends Xu{constructor(e){super(e),this.noValueOptionLabel=null,this.showNoValueOption=!0,this.type="radio-buttons"}clone(){return new cC({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};l([p({type:String,json:{write:!0}})],Iy.prototype,"noValueOptionLabel",void 0),l([p({type:Boolean,json:{write:!0}})],Iy.prototype,"showNoValueOption",void 0),l([p({type:["radio-buttons"],json:{read:!1,write:!0}})],Iy.prototype,"type",void 0),Iy=cC=l([k("esri.form.elements.inputs.RadioButtonsInput")],Iy);const V$e=Iy;var pC;let My=pC=class extends Xu{constructor(e){super(e),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new pC({offValue:this.offValue,onValue:this.onValue})}};l([p({type:[String,Number],json:{write:!0}})],My.prototype,"offValue",void 0),l([p({type:[String,Number],json:{write:!0}})],My.prototype,"onValue",void 0),l([p({type:["switch"],json:{read:!1,write:!0}})],My.prototype,"type",void 0),My=pC=l([k("esri.form.elements.inputs.SwitchInput")],My);const G$e=My;var hC;let eS=hC=class extends qP{constructor(e){super(e),this.type="text-area"}clone(){return new hC({maxLength:this.maxLength,minLength:this.minLength})}};l([p({type:["text-area"],json:{read:!1,write:!0}})],eS.prototype,"type",void 0),eS=hC=l([k("esri.form.elements.inputs.TextAreaInput")],eS);const B$e=eS;var dC;let tS=dC=class extends qP{constructor(e){super(e),this.type="text-box"}clone(){return new dC({maxLength:this.maxLength,minLength:this.minLength})}};l([p({type:["text-box"],json:{read:!1,write:!0}})],tS.prototype,"type",void 0),tS=dC=l([k("esri.form.elements.inputs.TextBoxInput")],tS);const z$e=tS;var fC;function VM(e){return e??null}function GM(e){return e??null}let Us=fC=class extends Xu{constructor(e){super(e),this.max=null,this.min=null,this.timeResolution="minutes",this.type="time-picker"}readMax(e,t){return VM(t.max)}writeMax(e,t){t.max=GM(e)}readMin(e,t){return VM(t.min)}writeMin(e,t){t.min=GM(e)}readTimeResolution(e,t){return VM(t.timeResolution)}writeTimeResolution(e,t){t.timeResolution=GM(e)}clone(){return new fC({max:this.max,min:this.min,timeResolution:this.timeResolution})}};l([p({type:String,json:{type:String,write:!0}})],Us.prototype,"max",void 0),l([te("max")],Us.prototype,"readMax",null),l([se("max")],Us.prototype,"writeMax",null),l([p({type:String,json:{type:String,write:!0}})],Us.prototype,"min",void 0),l([te("min")],Us.prototype,"readMin",null),l([se("min")],Us.prototype,"writeMin",null),l([p({type:String,json:{type:String,write:!0}})],Us.prototype,"timeResolution",void 0),l([te("timeResolution")],Us.prototype,"readTimeResolution",null),l([se("timeResolution")],Us.prototype,"writeTimeResolution",null),l([p({type:["time-picker"],json:{read:!1,write:!0}})],Us.prototype,"type",void 0),Us=fC=l([k("esri.form.elements.inputs.TimePickerInput")],Us);const q$e=Us,H$e={base:Xu,key:"type",typeMap:{"barcode-scanner":N$e,"combo-box":D$e,"date-picker":F$e,"datetime-picker":U$e,"datetimeoffset-picker":j$e,"radio-buttons":V$e,switch:G$e,"text-area":B$e,"text-box":z$e,"time-picker":q$e}};var yC;let Mo=yC=class extends mf{constructor(e){super(e),this.domain=null,this.editableExpression=null,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field",this.valueExpression=null}get editable(){return this._get("editable")??!0}set editable(e){this._set("editable",e)}clone(){return new yC({description:this.description,domain:this.domain,editable:this.editable,editableExpression:this.editableExpression,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,valueExpression:this.valueExpression,visibilityExpression:this.visibilityExpression})}};l([p({types:UJ,json:{read:{reader:jT},write:!0}})],Mo.prototype,"domain",void 0),l([p({type:Boolean,json:{write:!0}})],Mo.prototype,"editable",null),l([p({type:String,json:{write:!0}})],Mo.prototype,"editableExpression",void 0),l([p({type:String,json:{write:!0}})],Mo.prototype,"fieldName",void 0),l([p({type:String,json:{write:!0}})],Mo.prototype,"hint",void 0),l([p({types:H$e,json:{read:{source:"inputType"},write:{target:"inputType"}}})],Mo.prototype,"input",void 0),l([p({type:String,json:{write:!0}})],Mo.prototype,"requiredExpression",void 0),l([p({type:String,json:{read:!1,write:!0}})],Mo.prototype,"type",void 0),l([p({type:String,json:{write:!0}})],Mo.prototype,"valueExpression",void 0),Mo=yC=l([k("esri.form.elements.FieldElement")],Mo);const y7=Mo;var mC;let vu=mC=class extends mf{constructor(e){super(e),this.displayCount=null,this.displayType="list",this.editableExpression=null,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new mC({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editableExpression:this.editableExpression,label:this.label,orderByFields:B(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};l([p({type:Number,json:{write:!0}})],vu.prototype,"displayCount",void 0),l([p({type:["list"],json:{write:!0}})],vu.prototype,"displayType",void 0),l([p({type:String,json:{write:!0}})],vu.prototype,"editableExpression",void 0),l([p({type:[h4],json:{write:!0}})],vu.prototype,"orderByFields",void 0),l([p({type:Number,json:{write:!0}})],vu.prototype,"relationshipId",void 0),l([p({type:["relationship"],json:{read:!1,write:!0}})],vu.prototype,"type",void 0),vu=mC=l([k("esri.form.elements.RelationshipElement")],vu);const m7=vu;var gC;let $y=gC=class extends mf{constructor(e){super(e),this.text=null,this.textFormat="plain-text",this.type="text"}clone(){return new gC({text:this.text,textFormat:this.textFormat,visibilityExpression:this.visibilityExpression})}};l([p({type:String,json:{write:!0}})],$y.prototype,"text",void 0),l([p({type:String,json:{write:!0}})],$y.prototype,"textFormat",void 0),l([p({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],$y.prototype,"type",void 0),$y=gC=l([k("esri.form.elements.TextElement")],$y);const g7=$y;function PY(e){return{typesWithGroup:{base:mf,key:"type",typeMap:{attachment:c7,field:y7,group:e,relationship:m7,text:g7}},typesWithoutGroup:{base:mf,key:"type",typeMap:{attachment:c7,field:y7,relationship:m7,text:g7}}}}function LY(e,t,r=!0){if(!e)return null;const i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter(n=>i[n.type]).map(n=>i[n.type].fromJSON(n))}function kY(e,t,r=!0){if(!e)return null;const i=r?t.typesWithGroup.typeMap:t.typesWithoutGroup.typeMap;return e.filter(n=>i[n.type]).map(n=>n.toJSON())}function NY(e,t,r=!0){return e?e.map(i=>Tl(r?t.typesWithGroup:t.typesWithoutGroup,i)):null}var vC;let dl=vC=class extends mf{constructor(e){super(e),this.elements=null,this.initialState="expanded",this.type="group"}castElements(e){return NY(e,BM,!1)}readElements(e,t){return LY(t.formElements,BM,!1)}writeElements(e,t){t.formElements=kY(e,BM,!1)}clone(){return new vC({description:this.description,elements:B(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};l([p({json:{write:!0}})],dl.prototype,"elements",void 0),l([Tt("elements")],dl.prototype,"castElements",null),l([te("elements",["formElements"])],dl.prototype,"readElements",null),l([se("elements")],dl.prototype,"writeElements",null),l([p({type:["collapsed","expanded"],json:{write:!0}})],dl.prototype,"initialState",void 0),l([p({type:String,json:{read:!1,write:!0}})],dl.prototype,"type",void 0),dl=vC=l([k("esri.form.elements.GroupElement")],dl);const BM=PY(dl),W$e=dl;var wC;const zM=PY(W$e);let ma=wC=class extends Q{constructor(e){super(e),this.description=null,this.elements=null,this.expressionInfos=null,this.preserveFieldValuesWhenHidden=!1,this.title=null}castElements(e){return NY(e,zM)}readElements(e,t){return LY(t.formElements,zM)}writeElements(e,t){t.formElements=kY(e,zM)}clone(){return new wC({description:this.description,expressionInfos:B(this.expressionInfos),elements:B(this.elements),title:this.title,preserveFieldValuesWhenHidden:this.preserveFieldValuesWhenHidden})}};l([p({type:String,json:{write:!0}})],ma.prototype,"description",void 0),l([p({json:{write:!0}})],ma.prototype,"elements",void 0),l([Tt("elements")],ma.prototype,"castElements",null),l([te("elements",["formElements"])],ma.prototype,"readElements",null),l([se("elements")],ma.prototype,"writeElements",null),l([p({type:[L$e],json:{write:!0}})],ma.prototype,"expressionInfos",void 0),l([p({type:Boolean,json:{default:!1,write:!0}})],ma.prototype,"preserveFieldValuesWhenHidden",void 0),l([p({type:String,json:{write:!0}})],ma.prototype,"title",void 0),ma=wC=l([k("esri.form.FormTemplate")],ma);const J$e=ma;function v7(e,t,r){if(e.hasM==null||e.hasZ)for(const i of t)for(const n of i)n.length>2&&(n[2]*=r)}function Z$e(e,t,r){if(!e&&!t||!r)return;const i=vm(r);w7(e,r,i),w7(t,r,i)}function w7(e,t,r){if(e)for(const i of e)Y$e(i.geometry,t,r)}function Y$e(e,t,r){if(!(e!=null&&e.spatialReference)||fi(e.spatialReference,t))return;const i=vm(e.spatialReference)/r;if(i!==1){if("x"in e)e.z!=null&&(e.z*=i);else if("rings"in e)v7(e,e.rings,i);else if("paths"in e)v7(e,e.paths,i);else if("points"in e&&(e.hasM==null||e.hasZ))for(const n of e.points)n.length>2&&(n[2]*=i)}}let K$e=0,Eu=class extends El.LoadableMixin(pT($e)){constructor(t){super(t),this._idToClientGraphic=null,this.type="memory"}load(t){const r=t!=null?t.signal:null;return this.addResolvingPromise(this._startWorker(r)),Promise.resolve(this)}destroy(){var t;(t=this._connection)==null||t.close(),this._connection=null}get _workerGeometryType(){var r;const t=(r=this.layer)==null?void 0:r.geometryType;return t?this._geometryTypeRequiresClientGraphicMapping(t)?"polygon":t:null}applyEdits(t){return this.load().then(()=>this._applyEdits(t))}openPorts(){return this.load().then(()=>this._connection.openPorts())}async queryFeatures(t,r={}){await this.load(r);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,r);nR(t,this.layer.spatialReference,i);const n=Tf.fromJSON(i);if(!this._requiresClientGraphicMapping())return n;const s=this.layer.objectIdField;for(const o of n.features){const a=o.attributes[s],u=this._idToClientGraphic.get(a);u&&(o.geometry=u.geometry)}return n.geometryType=this.layer.geometryType,n}async queryFeaturesJSON(t,r={}){if(this._requiresClientGraphicMapping())throw new z("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(r);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,r);return nR(t,this.layer.spatialReference,i),i}queryFeatureCount(t,r={}){return this.load(r).then(()=>this._connection.invoke("queryFeatureCount",t?t.toJSON():null,r))}queryObjectIds(t,r={}){return this.load(r).then(()=>this._connection.invoke("queryObjectIds",t?t.toJSON():null,r))}queryExtent(t,r={}){return this.load(r).then(()=>this._connection.invoke("queryExtent",t?t.toJSON():null,r)).then(i=>({count:i.count,extent:Ne.fromJSON(i.extent)}))}querySnapping(t,r={}){return this.load(r).then(()=>this._connection.invoke("querySnapping",t,r))}async _applyEdits(t){if(!this._connection)throw new z("feature-layer-source:edit-failure","Memory source not loaded");const r=this.layer.objectIdField;let i=null;const n=[],s=[];await Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);const o=h=>"objectId"in h&&h.objectId!=null?h.objectId:"attributes"in h&&h.attributes[r]!=null?h.attributes[r]:null;if(t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures)for(const h of t.deleteFeatures){const d=o(h);d!=null&&n.push(d)}const a=t.updateFeatures&&this._idToClientGraphic?new Map:null;if(t.updateFeatures){for(const h of t.updateFeatures)if(s.push(this._serializeFeature(h)),a){const d=o(h);d!=null&&a.set(d,h)}}Z$e(i?i.features:null,s,this.layer.spatialReference);const{fullExtent:u,featureEditResults:c}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:s,deletes:n});return this.fullExtent=u,i&&i.finish(c.uidToObjectId),this._updateClientGraphicIds(a,c),this._createEditsResult(c)}async _prepareClientMapping(t,r){if(this._layerOrSourceGeometryType!=="mesh"||t==null)return;const i=[];for(const{geometry:n}of t)n==null||n.type!=="mesh"||n.hasExtent||n.loaded||i.push(n.load({signal:r}));i.length&&await Promise.all(i)}_updateClientGraphicIds(t,r){if(this._idToClientGraphic){if(t)for(const i of r.updateResults){if(!i.success)continue;const n=t.get(i.objectId);n!=null&&this._addIdToClientGraphic(n)}for(const i of r.deleteResults)i.success&&this._idToClientGraphic.delete(i.objectId)}}_createEditsResult(t){return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(t){const r=t.success===!0?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:r?new z("feature-layer-source:edit-failure",r.description,{code:r.code}):null}}_prepareAddFeatures(t){const r=new Map,i=new Array(t.length);let n=null;for(let o=0;o<t.length;o++){const a=t[o],u=this._serializeFeature(a);n||a.geometry==null||(n=a.geometry.type),i[o]=u,r.set(`${u.uid}`,a)}const s=this;return{features:i,inferredGeometryType:n,finish(o){const a=s.sourceJSON.objectIdField;for(const u in o){const c=o[u],h=r.get(u);h&&(h.attributes||(h.attributes={}),c===-1?delete h.attributes[a]:h.attributes[a]=c,s._addIdToClientGraphic(h))}}}}_addIdToClientGraphic(t){var n;if(!this._idToClientGraphic)return;const r=this.sourceJSON.objectIdField,i=(n=t.attributes)==null?void 0:n[r];i!=null&&this._idToClientGraphic.set(i,t)}get _layerOrSourceGeometryType(){var t,r;return((t=this.layer)==null?void 0:t.geometryType)??((r=this.sourceJSON)==null?void 0:r.geometryType)}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this._layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(t){return this._geometryTypeRequiresClientGraphicMapping(t.type)}_geometryTypeRequiresClientGraphicMapping(t){return t==="mesh"||t==="multipatch"||t==="extent"}_serializeFeature(t){const{attributes:r}=t,i=this._geometryForSerialization(t),n=(K$e++).toString();return i?{uid:n,geometry:i.toJSON(),attributes:r}:{uid:n,attributes:r}}_geometryForSerialization(t){const{geometry:r}=t;return r==null?null:this._geometryRequiresClientGraphicMapping(r)?r.extent?Ss.fromExtent(r.extent):null:r}async _startWorker(t){this._connection=await eY("MemorySourceWorker",{strategy:Me("feature-layers-workers")?"dedicated":"local",signal:t,registryTarget:this});const{fields:r,spatialReference:i,objectIdField:n,hasM:s,hasZ:o,timeInfo:a,dateFieldsTimeZone:u}=this.layer,c=this.layer.originOf("spatialReference")==="defaults";await this._prepareClientMapping(this.items,t);const h=this._prepareAddFeatures(this.items);this.addHandles(this.on("before-changes",w=>{oe.getLogger(this).error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),w.preventDefault()}));const d={features:h.features,fields:r==null?void 0:r.map(w=>w.toJSON()),geometryType:AD.toJSON(this._workerGeometryType),hasM:this._layerOrSourceGeometryType!=="mesh"&&s,hasZ:this._layerOrSourceGeometryType==="mesh"||o,objectIdField:n,spatialReference:c?null:i&&i.toJSON(),timeInfo:(a==null?void 0:a.toJSON())??null,dateFieldsTimeZone:u},y=await this._connection.invoke("load",d,{signal:t});for(const w of y.warnings)oe.getLogger(this.layer).warn("#load()",`${w.message} (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{warning:w});y.featureErrors.length&&oe.getLogger(this.layer).warn("#load()",`Encountered ${y.featureErrors.length} validation errors while loading features. (title: '${this.layer.title||"no title"}', id: '${this.layer.id??"no id"}')`,{errors:y.featureErrors});const v=y.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(h.inferredGeometryType)&&(v.geometryType=AD.toJSON(h.inferredGeometryType)),this.sourceJSON=v,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),h.finish(y.assignedObjectIds)}};l([HO({Type:Da,ensureType:Lr(Da)})],Eu.prototype,"itemType",void 0),l([p()],Eu.prototype,"type",void 0),l([p({constructOnly:!0})],Eu.prototype,"layer",void 0),l([p({readOnly:!0})],Eu.prototype,"_workerGeometryType",null),l([p()],Eu.prototype,"sourceJSON",void 0),Eu=l([k("esri.layers.graphics.sources.MemorySource")],Eu);const X$e="randomUUID"in crypto;function HP(){if(X$e)return crypto.randomUUID();const e=crypto.getRandomValues(new Uint16Array(8));e[3]=4095&e[3]|16384,e[4]=16383&e[4]|32768;const t=r=>e[r].toString(16).padStart(4,"0");return t(0)+t(1)+"-"+t(2)+"-"+t(3)+"-"+t(4)+"-"+t(5)+t(6)+t(7)}function dUe(){return`{${HP().toUpperCase()}}`}function Q$e(){return`{${HP()}}`}const eEe=Q$e(),DY=new Map,FY=new Map;async function fUe(e,t,r){if(!e||!r)return!1;if(!t)return!0;const i=new URL(e).host;let n=DY.get(i);if(!n){const s=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,"");n=(await be(s,{responseType:"json",query:{f:"json"}})).data.defaultVersionName}return n===t}async function yUe(e,t,r=!1){var s,o;if(!e||!t)return!0;const i=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=(s=FY.get(i))==null?void 0:s.entries();if(n){for(const[a,u]of n)if(u.name===t){const c=!((o=u.stack)!=null&&o.hasForwardEdits());if(!c&&r){const[{deleteForwardEdits:h},{default:d}]=await Promise.all([ge(()=>import("./deleteForwardEdits-DZhSgQpc.js"),__vite__mapDeps([129,1,2])),ge(()=>import("./DeleteForwardEditsParameters-CTDhZVo-.js"),__vite__mapDeps([130,1,2]))]);return h(i,a,new d({sessionId:eEe,moment:u.moment}))}return c}}return!0}function tEe(e,t){var n;if(!e)return!1;const r=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),i=(n=FY.get(r))==null?void 0:n.entries();if(i){for(const[s,o]of i)if(o.name===t)return o.lockType==="edit"}return!1}const WP=new Zu.EventEmitter;function rEe(e){return WP.on("apply-edits",new WeakRef(e))}function iEe(e){return WP.on("update-moment",new WeakRef(e))}function mUe(e,t,r=null,i=!1){const n=ro();return i=t==null||i,WP.emit("apply-edits",{serviceUrl:e,layerId:t,gdbVersion:r,mayReceiveServiceEdits:i,result:n.promise}),n}const jY="esri.layers.mixins.EditBusLayer",UY=Symbol(jY);function gUe(e){return e!=null&&typeof e=="object"&&UY in e}function ng(e){return e!=null&&typeof e=="object"&&"gdbVersion"in e}function qM(e,t,r){const i=new URL(e).host,n=DY.get(i),s=o=>!o||o===n;return s(t)&&s(r)||t===r}const nEe=e=>{var t;let r=class extends e{constructor(...i){super(...i),this[t]=!0,this._applyEditsHandler=n=>{const{serviceUrl:s,layerId:o,gdbVersion:a,mayReceiveServiceEdits:u,result:c}=n,h=s===this.url,d=o!=null&&this.layerId!=null&&o===this.layerId,y=ng(this),v=ng(this)&&qM(s,a,this.gdbVersion);if(!h||y&&!v||!d&&!u)return;const w=c.then(b=>{var x;if(d&&(b.addedFeatures.length||b.updatedFeatures.length||b.deletedFeatures.length||b.addedAttachments.length||b.updatedAttachments.length||b.deletedAttachments.length))return this.emit("edits",B(b)),b;const _=(x=b.editedFeatures)==null?void 0:x.find(({layerId:T})=>T===this.layerId);if(_){const{adds:T,updates:I,deletes:M}=_.editedFeatures,$={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:T?T.map(({attributes:A})=>({objectId:this.objectIdField&&A[this.objectIdField],globalId:this.globalIdField&&A[this.globalIdField]})):[],deletedFeatures:M?M.map(({attributes:A})=>({objectId:this.objectIdField&&A[this.objectIdField],globalId:this.globalIdField&&A[this.globalIdField]})):[],updatedFeatures:I?I.map(({current:{attributes:A}})=>({objectId:this.objectIdField&&A[this.objectIdField],globalId:this.globalIdField&&A[this.globalIdField]})):[],editedFeatures:B(b.editedFeatures),exceededTransferLimit:!1,historicMoment:B(b.historicMoment)};return this.emit("edits",$),$}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:B(b.editedFeatures),exceededTransferLimit:!1,historicMoment:B(b.historicMoment)}}).then(b=>("historicMoment"in this&&this.historicMoment!==b.historicMoment&&tEe(s,a)&&(this.historicMoment=b.historicMoment),b));this.emit("apply-edits",{result:w})},this._updateMomentHandler=n=>{const{serviceUrl:s,gdbVersion:o,moment:a}=n,u=s===this.url,c=ng(this),h=ng(this)&&qM(s,o,this.gdbVersion),d=ng(this)&&!qM(s,this.gdbVersion,null);u&&c&&h&&d&&"historicMoment"in this&&this.historicMoment!==a&&(this.historicMoment=a)},this.when().then(()=>{this.addHandles(rEe(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(iEe(this._updateMomentHandler))},()=>{})}};return t=UY,r=l([k(jY)],r),r};var bC;const HM=new We({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),WM=new We({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let nl=bC=class extends Q{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:r,spatialRelationship:i,timeExtent:n,objectIds:s,units:o,distance:a}=this;return new $i({geometry:B(r),objectIds:B(s),spatialRelationship:i,timeExtent:B(n),where:t,units:o,distance:a,...e})}clone(){const{where:e,geometry:t,spatialRelationship:r,timeExtent:i,objectIds:n,units:s,distance:o}=this;return new bC({geometry:B(t),objectIds:B(n),spatialRelationship:r,timeExtent:B(i),where:e,units:s,distance:o})}};l([p({type:String,json:{write:!0}})],nl.prototype,"where",void 0),l([p({types:Vi,json:{write:!0}})],nl.prototype,"geometry",void 0),l([p({type:HM.apiValues,json:{name:"spatialRel",read:{reader:HM.read},write:{allowNull:!1,writer:HM.write,overridePolicy(){return{enabled:this.geometry!=null}}}}})],nl.prototype,"spatialRelationship",void 0),l([p({type:Number,json:{write:{overridePolicy(e){return{enabled:e!=null&&this.geometry!=null}}}}})],nl.prototype,"distance",void 0),l([p({type:[Number],json:{write:!0}})],nl.prototype,"objectIds",void 0),l([p({type:WM.apiValues,json:{read:WM.read,write:{writer:WM.write,overridePolicy(e){return{enabled:e!=null&&this.geometry!=null}}}}})],nl.prototype,"units",void 0),l([p({type:is,json:{write:!0}})],nl.prototype,"timeExtent",void 0),nl=bC=l([k("esri.layers.support.FeatureFilter")],nl);const sEe=nl;var _C;const b7={read:{reader:k4},write:{writer:N4,overridePolicy(){return{allowNull:this.excludedEffect!=null,isRequired:this.excludedEffect==null}}}},_7={read:{reader:k4},write:{writer:N4,overridePolicy(){return{allowNull:this.includedEffect!=null,isRequired:this.includedEffect==null}}}},S7={name:"showExcludedLabels",default:!0};let ld=_C=class extends Q{constructor(e){super(e),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(e,t){var i,n;const r=super.write(e,t);if(t!=null&&t.origin){if(r.filter){const s=Object.keys(r.filter);if(s.length>1||s[0]!=="where")return(i=t.messages)==null||i.push(new z("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:t.layer,effect:this})),null}if("showExcludedLabels"in r)return(n=t.messages)==null||n.push(new z("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:t.layer,effect:this})),null}return r}clone(){return new _C({filter:this.filter!=null?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};l([p({type:sEe,json:{write:{allowNull:!0,writer(e,t,r,i){const n=e==null?void 0:e.write({},i);n&&Object.keys(n).length!==0?En(r,n,t):En(r,null,t)}}}})],ld.prototype,"filter",void 0),l([p({json:{write:!0,origins:{"web-map":b7,"portal-item":b7}}})],ld.prototype,"includedEffect",void 0),l([p({json:{write:!0,origins:{"web-map":_7,"portal-item":_7}}})],ld.prototype,"excludedEffect",void 0),l([p({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":S7,"portal-item":S7}}})],ld.prototype,"excludedLabelsVisible",void 0),ld=_C=l([k("esri.layers.support.FeatureEffect")],ld);const oEe=ld,x7={write:{allowNull:!0}},aEe=e=>{let t=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return l([p({type:oEe,json:{origins:{"web-map":x7,"portal-item":x7}}})],t.prototype,"featureEffect",void 0),t=l([k("esri.layers.mixins.FeatureEffectLayer")],t),t};var n1;const bx=Qr()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),VY=bx.jsonValues.slice();Ooe(VY,"orthometric");const H1=Qr()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let ga=n1=class extends Q{constructor(e){super(e),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(e,t,r){return bx.write(e,t,r)}readHeightModel(e,t,r){return bx.read(e)||(r!=null&&r.messages&&r.messages.push(lEe(e,{context:r})),null)}readHeightUnit(e,t,r){return H1.read(e)||(r!=null&&r.messages&&r.messages.push(T7(e,{context:r})),null)}readHeightUnitService(e,t,r){return OG(e)||H1.read(e)||(r!=null&&r.messages&&r.messages.push(T7(e,{context:r})),null)}readVertCRS(e,t){return t.vertCRS||t.ellipsoid||t.geoid}clone(){return new n1({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(e){return!!e&&(this===e||this.heightModel===e.heightModel&&this.heightUnit===e.heightUnit&&this.vertCRS===e.vertCRS)}static deriveUnitFromSR(e,t){const r=Kue(t);return new n1({heightModel:e.heightModel,heightUnit:r??void 0,vertCRS:e.vertCRS})}write(e,t){return t={origin:"web-scene",...t},super.write(e,t)}static fromJSON(e){if(!e)return null;const t=new n1;return t.read(e,{origin:"web-scene"}),t}};function T7(e,t){return new eo("height-unit:unsupported",`Height unit of value '${e}' is not supported`,t)}function lEe(e,t){return new eo("height-model:unsupported",`Height model of value '${e}' is not supported`,t)}l([p({type:bx.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:VY,default:"ellipsoidal"}}}})],ga.prototype,"heightModel",void 0),l([se("web-scene","heightModel")],ga.prototype,"writeHeightModel",null),l([te(["web-scene","service"],"heightModel")],ga.prototype,"readHeightModel",null),l([p({type:H1.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:H1.jsonValues,write:H1.write}}}})],ga.prototype,"heightUnit",void 0),l([te("web-scene","heightUnit")],ga.prototype,"readHeightUnit",null),l([te("service","heightUnit")],ga.prototype,"readHeightUnitService",null),l([p({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],ga.prototype,"vertCRS",void 0),l([te("service","vertCRS",["vertCRS","ellipsoid","geoid"])],ga.prototype,"readVertCRS",null),ga=n1=l([k("esri.geometry.HeightModelInfo")],ga);const ZT=ga;let wu=class extends It(Q){constructor(t){super(t),this.creatorField=null,this.creationDateField=null,this.editorField=null,this.editDateField=null,this.realm=null,this.timeZone=null}};l([p()],wu.prototype,"creatorField",void 0),l([p()],wu.prototype,"creationDateField",void 0),l([p()],wu.prototype,"editorField",void 0),l([p()],wu.prototype,"editDateField",void 0),l([p()],wu.prototype,"realm",void 0),l([p(xm("dateFieldsTimeReference",!0))],wu.prototype,"timeZone",void 0),wu=l([k("esri.layers.support.EditFieldsInfo")],wu);const uEe=wu;let fl=class extends It(Q){constructor(t){super(t)}};l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"name",void 0),l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"fields",void 0),l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"isAscending",void 0),l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"indexType",void 0),l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"isUnique",void 0),l([p({constructOnly:!0,json:{write:!0}})],fl.prototype,"description",void 0),fl=l([k("esri.layers.support.FeatureIndex")],fl);async function cEe(e,t,r){t=t.clone(),e.capabilities.query.supportsMaxRecordCountFactor&&(t.maxRecordCountFactor=GY(e));const i=pEe(e),n=e.capabilities.query.supportsPagination;t.start=0,t.num=i;let s=null;for(;;){const o=await e.source.queryFeaturesJSON(t,r);if(s==null?s=o:s.features=s.features.concat(o.features),s.exceededTransferLimit=o.exceededTransferLimit,!n||!o.exceededTransferLimit)break;t.start+=i}return s}function pEe(e){return GY(e)*hEe(e)}function hEe(e){return e.capabilities.query.maxRecordCount||2e3}function GY(e){return e.capabilities.query.supportsMaxRecordCountFactor?$i.MAX_MAX_RECORD_COUNT_FACTOR:1}const SC=new We({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function dEe(e,t,r,i){const n=await Xp(e);if(await JP(e,t,i),!n.addAttachment)throw new z(i,"Layer source does not support addAttachment capability");return n.addAttachment(t,r)}function JP(e,t,r){var s,o;const{attributes:i}=t,{objectIdField:n}=e;return(o=(s=e.capabilities)==null?void 0:s.data)!=null&&o.supportsAttachment?t?i?n&&i[n]?Promise.resolve():Promise.reject(new z(r,`feature is missing the identifying attribute ${n}`)):Promise.reject(new z(r,"'attributes' are required on a feature to query attachments")):Promise.reject(new z(r,"A feature is required to add/delete/update attachments")):Promise.reject(new z(r,"this layer doesn't support attachments"))}async function fEe(e,t,r,i,n){const s=await Xp(e);if(await JP(e,t,n),!s.updateAttachment)throw new z(n,"Layer source does not support updateAttachment capability");return s.updateAttachment(t,r,i)}async function yEe(e,t,r){const{applyEdits:i}=await ge(()=>import("./editingSupport-ChjpwLAv.js"),__vite__mapDeps([131,1,2])),n=await e.load(),{source:s,globalIdField:o}=n;let a=r;return n.type==="feature"&&n.infoFor3D&&t.deleteFeatures!=null&&o!=null&&(a={...a,globalIdToObjectId:await OEe(e,t.deleteFeatures,o)}),i(n,s,t,r)}async function mEe(e,t,r){const{uploadAssets:i}=await ge(()=>import("./editingSupport-ChjpwLAv.js"),__vite__mapDeps([131,1,2])),n=await e.load();return i(n,n.source,t,r)}async function gEe(e,t,r,i){const n=await Xp(e);if(await JP(e,t,i),!n.deleteAttachments)throw new z(i,"Layer source does not support deleteAttachments capability");return n.deleteAttachments(t,r)}async function vEe(e,t,r){const i=(await e.load({signal:t==null?void 0:t.signal})).source;if(!i.fetchRecomputedExtents)throw new z(r,"Layer source does not support fetchUpdates capability");return i.fetchRecomputedExtents(t)}async function wEe(e,t,r,i){var v,w;t=vZ.from(t),await e.load();const n=e.source,s=e.capabilities;if(!((v=s==null?void 0:s.data)!=null&&v.supportsAttachment))throw new z(i,"this layer doesn't support attachments");const{attachmentTypes:o,objectIds:a,globalIds:u,num:c,size:h,start:d,where:y}=t;if(!((w=s==null?void 0:s.operations)!=null&&w.supportsQueryAttachments)&&((o==null?void 0:o.length)>0||(u==null?void 0:u.length)>0||(h==null?void 0:h.length)>0||c||d||y))throw new z(i,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",t);if(!(a!=null&&a.length||u!=null&&u.length||y))throw new z(i,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",t);if(!n.queryAttachments)throw new z(i,"Layer source does not support queryAttachments capability",t);return n.queryAttachments(t)}async function bEe(e,t,r,i){const n=await Xp(e);if(!n.queryObjectIds)throw new z(i,"Layer source does not support queryObjectIds capability");return n.queryObjectIds($i.from(t)??e.createQuery(),r)}async function _Ee(e,t,r,i){const n=await Xp(e);if(!n.queryFeatureCount)throw new z(i,"Layer source does not support queryFeatureCount capability");return n.queryFeatureCount($i.from(t)??e.createQuery(),r)}async function SEe(e,t,r,i){const n=await Xp(e);if(!n.queryExtent)throw new z(i,"Layer source does not support queryExtent capability");return n.queryExtent($i.from(t)??e.createQuery(),r)}async function xEe(e,t,r,i){const n=await Xp(e);if(!n.queryRelatedFeatures)throw new z(i,"Layer source does not support queryRelatedFeatures capability");return n.queryRelatedFeatures(zP.from(t),r)}async function TEe(e,t,r,i){const n=await Xp(e);if(!n.queryRelatedFeaturesCount)throw new z(i,"Layer source does not support queryRelatedFeaturesCount capability");return n.queryRelatedFeaturesCount(zP.from(t),r)}async function IEe(e){const t=e.source;if(t!=null&&t.refresh)try{const{dataChanged:r,updates:i}=await t.refresh();if(i!=null&&(e.sourceJSON={...e.sourceJSON,...i},e.read(i,{origin:"service",url:e.parsedUrl})),r)return!0}catch{}if(e.definitionExpression)try{return(await AB(e.definitionExpression,e.fieldsIndex)).hasDateFunctions}catch{}return!1}function MEe(e){var o,a;const t=new $i,r=(o=e.capabilities)==null?void 0:o.data,i=(a=e.capabilities)==null?void 0:a.query;t.historicMoment=e.historicMoment,t.gdbVersion=e.gdbVersion,t.returnGeometry=!0,i&&(t.compactGeometryEnabled=i.supportsCompactGeometry,t.defaultSpatialReferenceEnabled=i.supportsDefaultSpatialReference),r&&(r.supportsZ&&e.returnZ!=null&&(t.returnZ=e.returnZ),r.supportsM&&e.returnM!=null&&(t.returnM=e.returnM)),t.outFields=["*"];const{timeOffset:n,timeExtent:s}=e;return t.timeExtent=n!=null&&s!=null?s.offset(-n.value,n.unit):s||null,t.multipatchOption=e.geometryType==="multipatch"?"xyFootprint":null,t}function BY(e){const{globalIdField:t,fields:r}=e;if(t)return t;if(r){for(const i of r)if(i.type==="esriFieldTypeGlobalID")return i.name}}function zY(e){const{objectIdField:t,fields:r}=e;if(t)return t;if(r){for(const i of r)if(i.type==="esriFieldTypeOID")return i.name}}function $Ee(e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}async function Xp(e){return(await e.load()).source}async function EEe(e,t){if(!pt||pt.findCredential(e))return;let r;try{const i=await fH(e,t);i&&(r=await pt.checkSignInStatus(`${i}/sharing`))}catch{}if(r)try{const i=t!=null?t.signal:null;await pt.getCredential(e,{signal:i})}catch{}}async function AEe(e,t,r){var n;const i=(n=e.parsedUrl)==null?void 0:n.path;i&&e.authenticationTriggerEvent===t&&await EEe(i,r)}function REe(e){var t;return!((t=e.sourceJSON)!=null&&t.isMultiServicesView)&&(e.userHasUpdateItemPrivileges||e.editingEnabled)}const JM=Vm({types:Uq});function ZP(e,t){var r;if(e.defaultSymbol)return(r=e.types)!=null&&r.length?new s0({defaultSymbol:JM(e.defaultSymbol,e,t),field:e.typeIdField,uniqueValueInfos:e.types.map(i=>({id:i.id,symbol:JM(i.symbol,i,t)}))}):new n0({symbol:JM(e.defaultSymbol,e,t)})}function CEe(e){var i,n,s;let t=(i=e.sourceJSON)==null?void 0:i.cacheMaxAge;if(!t)return!1;const r=(s=(n=e.editingInfo)==null?void 0:n.lastEditDate)==null?void 0:s.getTime();return r==null||(t*=1e3,Date.now()-r<t)}async function OEe(e,t,r){if(t==null)return null;const i=[],{objectIdField:n}=e;if(t.forEach(c=>{let h=null;if("attributes"in c){const{attributes:d}=c;h={globalId:d[r],objectId:d[n]!=null&&d[n]!==-1?d[n]:null}}else h={globalId:c.globalId,objectId:c.objectId!=null&&c.objectId!==-1?c.objectId:null};h.globalId!=null&&(h.objectId!=null&&h.objectId!==-1||i.push(h.globalId))}),i.length===0)return null;const s=e.createQuery();s.where=i.map(c=>`${r}='${c}'`).join(" OR "),s.returnGeometry=!1,s.outFields=[n,r],s.cacheHint=!1;const o=await qme(cEe(e,s));if(!o.ok)return null;const a=new Map,u=o.value.features;for(const c of u){const h=c.attributes[r],d=c.attributes[n];h!=null&&d!=null&&d!==-1&&a.set(h,d)}return a}let Ey=class extends It(Q){constructor(t){super(t),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};l([p({type:String,json:{read:{source:"shapeAreaFieldName"}}})],Ey.prototype,"shapeAreaField",void 0),l([p({type:String,json:{read:{source:"shapeLengthFieldName"}}})],Ey.prototype,"shapeLengthField",void 0),l([p({type:String,json:{read:e=>ov.read(e)||Gu.read(e)}})],Ey.prototype,"units",void 0),Ey=l([k("esri.layers.support.GeometryFieldsInfo")],Ey);const PEe=Ey,I7=new We({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),M7=new We({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let $o=class extends It(Q){constructor(t){super(t),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};l([p({json:{read:I7.read,write:I7.write}})],$o.prototype,"cardinality",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"composite",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"id",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"keyField",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"keyFieldInRelationshipTable",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"name",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"relatedTableId",void 0),l([p({json:{read:!0,write:!0}})],$o.prototype,"relationshipTableId",void 0),l([p({json:{read:M7.read,write:M7.write}})],$o.prototype,"role",void 0),$o=l([k("esri.layers.support.Relationship")],$o);const LEe=$o;let bu=class extends It(Q){constructor(t){super(t),this.code=null,this.defaultValues={},this.domains=null,this.name=null}readDomains(t){if(!t)return null;const r={};for(const i of Object.keys(t))r[i]=jT(t[i]);return r}writeDomains(t,r){var n;if(!t)return;const i={};for(const s of Object.keys(t))t[s]&&(i[s]=(n=t[s])==null?void 0:n.toJSON());r.domains=i}};l([p({type:Number,json:{write:!0}})],bu.prototype,"code",void 0),l([p({type:Object,json:{write:!0}})],bu.prototype,"defaultValues",void 0),l([p({json:{write:!0}})],bu.prototype,"domains",void 0),l([te("domains")],bu.prototype,"readDomains",null),l([se("domains")],bu.prototype,"writeDomains",null),l([p({type:String,json:{write:!0}})],bu.prototype,"name",void 0),bu=l([k("esri.layers.support.Subtype")],bu);const kEe=bu,NEe=e=>{let t=class extends e{constructor(){super(...arguments),this.copyright=null,this.capabilities=null,this.dateFieldsTimeZone=null,this.datesInUnknownTimezone=!1,this.definitionExpression=null,this.displayField=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.floorInfo=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.globalIdField=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.indexes=new($e.ofType(fl)),this.isTable=!1,this.layerId=void 0,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.preferredTimeZone=null,this.relationships=null,this.returnM=void 0,this.returnZ=void 0,this.serviceDefinitionExpression=null,this.serviceItemId=null,this.sourceJSON=null,this.spatialReference=xe.WGS84,this.subtypeField=null,this.subtypes=null,this.trackIdField=null,this.version=void 0}get authenticationTriggerEvent(){if(!this.url)return null;const{capabilities:r}=this;if(r){const{query:n,operations:s,editing:o}=r;if(!n.supportsQueryByOthers||!n.supportsQueryByAnonymous||s.supportsEditing&&!(o.supportsUpdateByOthers&&o.supportsUpdateByAnonymous&&o.supportsDeleteByOthers&&o.supportsDeleteByAnonymous))return"load"}if(this.userHasUpdateItemPrivileges){if(CEe(this))return"load";if(this.hasUpdateItemRestrictions)return r.operations.supportsQuery?"editing":"load"}if(this.userHasFullEditingPrivileges&&this.hasFullEditingRestrictions)return"editing";const i=this.editFieldsInfo;return(i!=null&&i.creatorField||i!=null&&i.editorField)&&(r!=null&&r.operations.supportsEditing)?"editing":null}readCapabilitiesFromService(r,i){return xP(i,this.url)}readEditingInfo(r,i){const{editingInfo:n}=i;return n?{lastEditDate:n.lastEditDate!=null?new Date(n.lastEditDate):null}:null}get effectiveCapabilities(){var o;const r=this.capabilities;if(!r)return null;const i=B(r),{operations:n,editing:s}=i;return(o=this.sourceJSON)!=null&&o.isMultiServicesView?(this.userHasUpdateItemPrivileges&&(n.supportsQuery=!0),i):this.userHasUpdateItemPrivileges?(n.supportsAdd=n.supportsDelete=n.supportsEditing=n.supportsQuery=n.supportsUpdate=s.supportsDeleteByOthers=s.supportsGeometryUpdate=s.supportsUpdateByOthers=!0,i):(this.userHasFullEditingPrivileges&&n.supportsEditing&&(n.supportsAdd=n.supportsDelete=n.supportsUpdate=s.supportsGeometryUpdate=!0),i)}readGlobalIdFieldFromService(r,i){return BY(i)}get hasFullEditingRestrictions(){var s;const r=this.capabilities;if(!r||(s=this.sourceJSON)!=null&&s.isMultiServicesView)return!1;const{operations:i,editing:n}=r;return i.supportsEditing&&!(i.supportsAdd&&i.supportsDelete&&i.supportsUpdate&&n.supportsGeometryUpdate)}get hasUpdateItemRestrictions(){var s;const r=this.capabilities;if(!r)return!1;const{operations:i,editing:n}=r;return(s=this.sourceJSON)!=null&&s.isMultiServicesView?!i.supportsQuery:!(i.supportsAdd&&i.supportsDelete&&i.supportsEditing&&i.supportsQuery&&i.supportsUpdate&&n.supportsDeleteByOthers&&n.supportsGeometryUpdate&&n.supportsUpdateByOthers)}readIsTableFromService(r,i){return i.type==="Table"}readMaxScale(r,i){return i.effectiveMaxScale||r||0}readMinScale(r,i){return i.effectiveMinScale||r||0}readObjectIdFieldFromService(r,i){return zY(i)}readServiceDefinitionExpression(r,i){return i.definitionQuery||i.definitionExpression}set url(r){const i=Z1e({layer:this,url:r,nonStandardUrlAllowed:!0,logger:oe.getLogger(this)});this._set("url",i.url),i.layerId!=null&&this._set("layerId",i.layerId)}writeUrl(r,i,n,s){Y1e(this,r,null,i,s)}readVersion(r,i){return $Ee(i)}};return l([p({readOnly:!0})],t.prototype,"authenticationTriggerEvent",null),l([p({type:String,json:{origins:{service:{read:{source:"copyrightText"}}}}})],t.prototype,"copyright",void 0),l([p({readOnly:!0,json:{read:!1,origins:{service:{read:{source:["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"]}}}}})],t.prototype,"capabilities",void 0),l([te("service","capabilities")],t.prototype,"readCapabilitiesFromService",null),l([p(xm("dateFieldsTimeReference"))],t.prototype,"dateFieldsTimeZone",void 0),l([p({type:Boolean})],t.prototype,"datesInUnknownTimezone",void 0),l([p({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],t.prototype,"definitionExpression",void 0),l([p({type:String,json:{origins:{service:{read:{source:"displayField"}}}}})],t.prototype,"displayField",void 0),l([p({readOnly:!0,type:uEe})],t.prototype,"editFieldsInfo",void 0),l([p({readOnly:!0})],t.prototype,"editingInfo",void 0),l([te("editingInfo")],t.prototype,"readEditingInfo",null),l([p({readOnly:!0})],t.prototype,"effectiveCapabilities",null),l([p((()=>{const r=B(jge),i=r.json.origins;return i["web-map"]={read:!1,write:!1},i["portal-item"]={read:!1,write:!1},r})())],t.prototype,"elevationInfo",void 0),l([p({type:mZ,json:{name:"layerDefinition.floorInfo",write:!0,origins:{"web-scene":{name:"layerDefinition.floorInfo",write:{enabled:!0,layerContainerTypes:An}}}}})],t.prototype,"floorInfo",void 0),l([p({type:Ne,json:{origins:{service:{read:{source:"extent"}}}}})],t.prototype,"fullExtent",void 0),l([p()],t.prototype,"gdbVersion",void 0),l([p({readOnly:!0,type:PEe,json:{read:{source:"geometryProperties"}}})],t.prototype,"geometryFieldsInfo",void 0),l([p({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:SC.read}}}})],t.prototype,"geometryType",void 0),l([p({type:String})],t.prototype,"globalIdField",void 0),l([te("service","globalIdField",["globalIdField","fields"])],t.prototype,"readGlobalIdFieldFromService",null),l([p({readOnly:!0})],t.prototype,"hasFullEditingRestrictions",null),l([p({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasM",void 0),l([p({readOnly:!0})],t.prototype,"hasUpdateItemRestrictions",null),l([p({type:Boolean,json:{origins:{service:{read:!0}}}})],t.prototype,"hasZ",void 0),l([p({readOnly:!0,type:ZT})],t.prototype,"heightModelInfo",void 0),l([p({type:Date})],t.prototype,"historicMoment",void 0),l([p({type:$e.ofType(fl),readOnly:!0})],t.prototype,"indexes",void 0),l([p({readOnly:!0})],t.prototype,"isTable",void 0),l([te("service","isTable",["type"])],t.prototype,"readIsTableFromService",null),l([p({type:Number,json:{origins:{service:{read:{source:"id"}},"portal-item":{read:!1,write:{target:"id"}}},read:!1}})],t.prototype,"layerId",void 0),l([p(Bge)],t.prototype,"maxScale",void 0),l([te("service","maxScale",["maxScale","effectiveMaxScale"])],t.prototype,"readMaxScale",null),l([p(Gge)],t.prototype,"minScale",void 0),l([te("service","minScale",["minScale","effectiveMinScale"])],t.prototype,"readMinScale",null),l([p({type:String})],t.prototype,"objectIdField",void 0),l([te("service","objectIdField",["objectIdField","fields"])],t.prototype,"readObjectIdFieldFromService",null),l([p(xm("preferredTimeReference"))],t.prototype,"preferredTimeZone",void 0),l([p({type:[LEe],readOnly:!0})],t.prototype,"relationships",void 0),l([p({type:Boolean})],t.prototype,"returnM",void 0),l([p({type:Boolean})],t.prototype,"returnZ",void 0),l([p({readOnly:!0,json:{write:!1}})],t.prototype,"serverGens",void 0),l([p({readOnly:!0})],t.prototype,"serviceDefinitionExpression",void 0),l([te("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],t.prototype,"readServiceDefinitionExpression",null),l([p({type:String,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],t.prototype,"serviceItemId",void 0),l([p()],t.prototype,"sourceJSON",void 0),l([p({type:xe,json:{origins:{service:{read:{source:"extent.spatialReference"}}}}})],t.prototype,"spatialReference",void 0),l([p({type:String,readOnly:!0,json:{origins:{service:{read:!0}}}})],t.prototype,"subtypeField",void 0),l([p({type:[kEe],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],t.prototype,"subtypes",void 0),l([p({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],t.prototype,"trackIdField",void 0),l([p(Qv)],t.prototype,"url",null),l([se("url")],t.prototype,"writeUrl",null),l([p({json:{origins:{service:{read:!0}},read:!1}})],t.prototype,"version",void 0),l([te("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],t.prototype,"readVersion",null),t=l([k("esri.layers.mixins.FeatureLayerBase")],t),t};let Ay=class extends It(Q){constructor(t){super(t),this.expression=null,this.title=null,this.returnType=null}};l([p({type:String,json:{write:!0}})],Ay.prototype,"expression",void 0),l([p({type:String,json:{write:!0}})],Ay.prototype,"title",void 0),l([p({type:String,json:{write:!0}})],Ay.prototype,"returnType",void 0),Ay=l([k("esri.layers.support.ExpressionInfo")],Ay);const YP=Ay;var xC;let _u=xC=class extends Q{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new xC({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:B(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};l([p({type:Boolean,json:{write:!0}})],_u.prototype,"isAutoGenerated",void 0),l([p({type:String,json:{write:!0}})],_u.prototype,"name",void 0),l([p({type:String,json:{write:!0}})],_u.prototype,"alias",void 0),l([p({type:String,json:{write:!0}})],_u.prototype,"onStatisticField",void 0),l([p({type:YP,json:{write:!0}})],_u.prototype,"onStatisticExpression",void 0),l([p({type:String,json:{write:!0}})],_u.prototype,"statisticType",void 0),_u=xC=l([k("esri.layers.support.AggregateField")],_u);const gf=_u;let _p=class extends Q{constructor(){super(...arguments),this.type=null}};l([p({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],_p.prototype,"type",void 0),_p=l([k("esri.layers.support.FeatureReduction")],_p);var TC;const DEe="esri.layers.support.FeatureReductionBinning";let Bn=TC=class extends _p{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(e,t,r){const i=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());En(r,i,t)}readRenderer(e,t,r){var n;const i=(n=t.drawingInfo)==null?void 0:n.renderer;return i?gv(i,t,r)??void 0:ZP(t,r)}clone(){return new TC({fields:B(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:B(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:B(this.popupTemplate),renderer:B(this.renderer)})}};l([Ce({binning:"binning"})],Bn.prototype,"type",void 0),l([Ce({geohash:"geohash"})],Bn.prototype,"binType",void 0),l([p({type:Number,range:{min:1,max:9},json:{write:!0}})],Bn.prototype,"fixedBinLevel",void 0),l([p({type:[cw],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],Bn.prototype,"labelingInfo",void 0),l([p(F4)],Bn.prototype,"labelsVisible",void 0),l([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],Bn.prototype,"maxScale",void 0),l([p(Xv)],Bn.prototype,"popupEnabled",void 0),l([p({type:Up,json:{name:"popupInfo",write:!0}})],Bn.prototype,"popupTemplate",void 0),l([p({type:[gf],json:{write:!0}})],Bn.prototype,"fields",void 0),l([se("fields")],Bn.prototype,"writeFields",null),l([p({types:aw,json:{write:{target:"drawingInfo.renderer"}}})],Bn.prototype,"renderer",void 0),l([te("renderer",["drawingInfo.renderer"])],Bn.prototype,"readRenderer",null),Bn=TC=l([k(DEe)],Bn);const qY=Bn;var IC;const FEe="esri.layers.support.FeatureReductionCluster";function $7(e){var t;return e.type==="simple"&&!((t=e.visualVariables)!=null&&t.length)}let ci=IC=class extends Q{constructor(e){super(e),this.type="cluster",this.clusterRadius=wt("80px"),this.clusterMinSize=wt("12px"),this.clusterMaxSize=wt("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=[]}readRenderer(e,t,r){var n,s;const i=(n=t.drawingInfo)==null?void 0:n.renderer;return(s=i==null?void 0:i.authoringInfo)!=null&&s.isAutoGenerated?null:i?$7(i)?null:gv(i,t,r)??void 0:ZP(t,r)}readSymbol(e,t,r){var n,s;const i=(n=t.drawingInfo)==null?void 0:n.renderer;if((s=i==null?void 0:i.authoringInfo)!=null&&s.isAutoGenerated)return null;if(i&&$7(i)){const o=gv(i,t,r);return o==null?void 0:o.symbol}return null}writeSymbol(e,t,r,i){var s,o;const n=(o=(s=this.renderer)==null?void 0:s.authoringInfo)==null?void 0:o.isAutoGenerated;if(!this.renderer||n){const a=new n0({symbol:e});t.drawingInfo={renderer:a.write({},i)}}}writeFields(e,t,r){const i=e.filter(n=>n.statisticType!=="avg_angle").map(n=>n.toJSON());En(r,i,t)}readFields(e,t,r){return e.filter(i=>!i.isAutoGenerated).map(i=>gf.fromJSON(i))}clone(){return new IC({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:B(this.labelingInfo),labelsVisible:this.labelsVisible,fields:B(this.fields),maxScale:this.maxScale,renderer:B(this.renderer),symbol:B(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:B(this.popupTemplate)})}};l([p({type:["cluster"],readOnly:!0,json:{write:!0}})],ci.prototype,"type",void 0),l([p({type:Number,cast:e=>e==="auto"?e:wt(e),json:{write:!0}})],ci.prototype,"clusterRadius",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],ci.prototype,"clusterMinSize",void 0),l([p({type:Number,cast:wt,json:{write:!0}})],ci.prototype,"clusterMaxSize",void 0),l([p({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],ci.prototype,"maxScale",void 0),l([p(Xv)],ci.prototype,"popupEnabled",void 0),l([p({type:Up,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],ci.prototype,"popupTemplate",void 0),l([p({types:aw,json:{write:{target:"drawingInfo.renderer"}}})],ci.prototype,"renderer",void 0),l([te("renderer",["drawingInfo.renderer"])],ci.prototype,"readRenderer",null),l([p({types:Wme})],ci.prototype,"symbol",void 0),l([te("symbol",["drawingInfo.renderer"])],ci.prototype,"readSymbol",null),l([se("symbol")],ci.prototype,"writeSymbol",null),l([p({type:[cw],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],ci.prototype,"labelingInfo",void 0),l([p(F4)],ci.prototype,"labelsVisible",void 0),l([p({type:[gf],json:{write:!0}})],ci.prototype,"fields",void 0),l([se("fields")],ci.prototype,"writeFields",null),l([te("fields")],ci.prototype,"readFields",null),ci=IC=l([k(FEe)],ci);const HY=ci;var MC;let rS=MC=class extends _p{constructor(e){super(e),this.type="selection"}clone(){return new MC}};l([p({type:["selection"]})],rS.prototype,"type",void 0),rS=MC=l([k("esri.layers.support.FeatureReductionSelection")],rS);const E7=rS,A7={key:"type",base:_p,typeMap:{cluster:HY,binning:qY}},jEe={types:{key:"type",base:_p,typeMap:{selection:E7,cluster:HY,binning:qY}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:A7},"portal-item":{types:A7},"web-scene":{types:{key:"type",base:_p,typeMap:{selection:E7}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:An}}}}},Jf={Base64:0,Hex:1,String:2,Raw:3},cm=8,WY=(1<<cm)-1;function gp(e,t){const r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function UEe(e){const t=[];for(let r=0,i=e.length*cm;r<i;r+=cm)t[r>>5]|=(e.charCodeAt(r/cm)&WY)<<r%32;return t}function VEe(e){const t=[];for(let r=0,i=32*e.length;r<i;r+=cm)t.push(String.fromCharCode(e[r>>5]>>>r%32&WY));return t.join("")}function GEe(e){const t="0123456789abcdef",r=[];for(let i=0,n=4*e.length;i<n;i++)r.push(t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15));return r.join("")}function BEe(e){const t="=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=[];for(let n=0,s=4*e.length;n<s;n+=3){const o=(e[n>>2]>>n%4*8&255)<<16|(e[n+1>>2]>>(n+1)%4*8&255)<<8|e[n+2>>2]>>(n+2)%4*8&255;for(let a=0;a<4;a++)8*n+6*a>32*e.length?i.push(t):i.push(r.charAt(o>>6*(3-a)&63))}return i.join("")}function zEe(e,t){return e<<t|e>>>32-t}function YT(e,t,r,i,n,s){return gp(zEe(gp(gp(t,e),gp(i,s)),n),r)}function an(e,t,r,i,n,s,o){return YT(t&r|~t&i,e,t,n,s,o)}function ln(e,t,r,i,n,s,o){return YT(t&i|r&~i,e,t,n,s,o)}function un(e,t,r,i,n,s,o){return YT(t^r^i,e,t,n,s,o)}function cn(e,t,r,i,n,s,o){return YT(r^(t|~i),e,t,n,s,o)}function qEe(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let r=1732584193,i=-271733879,n=-1732584194,s=271733878;for(let o=0;o<e.length;o+=16){const a=r,u=i,c=n,h=s;r=an(r,i,n,s,e[o],7,-680876936),s=an(s,r,i,n,e[o+1],12,-389564586),n=an(n,s,r,i,e[o+2],17,606105819),i=an(i,n,s,r,e[o+3],22,-1044525330),r=an(r,i,n,s,e[o+4],7,-176418897),s=an(s,r,i,n,e[o+5],12,1200080426),n=an(n,s,r,i,e[o+6],17,-1473231341),i=an(i,n,s,r,e[o+7],22,-45705983),r=an(r,i,n,s,e[o+8],7,1770035416),s=an(s,r,i,n,e[o+9],12,-1958414417),n=an(n,s,r,i,e[o+10],17,-42063),i=an(i,n,s,r,e[o+11],22,-1990404162),r=an(r,i,n,s,e[o+12],7,1804603682),s=an(s,r,i,n,e[o+13],12,-40341101),n=an(n,s,r,i,e[o+14],17,-1502002290),i=an(i,n,s,r,e[o+15],22,1236535329),r=ln(r,i,n,s,e[o+1],5,-165796510),s=ln(s,r,i,n,e[o+6],9,-1069501632),n=ln(n,s,r,i,e[o+11],14,643717713),i=ln(i,n,s,r,e[o],20,-373897302),r=ln(r,i,n,s,e[o+5],5,-701558691),s=ln(s,r,i,n,e[o+10],9,38016083),n=ln(n,s,r,i,e[o+15],14,-660478335),i=ln(i,n,s,r,e[o+4],20,-405537848),r=ln(r,i,n,s,e[o+9],5,568446438),s=ln(s,r,i,n,e[o+14],9,-1019803690),n=ln(n,s,r,i,e[o+3],14,-187363961),i=ln(i,n,s,r,e[o+8],20,1163531501),r=ln(r,i,n,s,e[o+13],5,-1444681467),s=ln(s,r,i,n,e[o+2],9,-51403784),n=ln(n,s,r,i,e[o+7],14,1735328473),i=ln(i,n,s,r,e[o+12],20,-1926607734),r=un(r,i,n,s,e[o+5],4,-378558),s=un(s,r,i,n,e[o+8],11,-2022574463),n=un(n,s,r,i,e[o+11],16,1839030562),i=un(i,n,s,r,e[o+14],23,-35309556),r=un(r,i,n,s,e[o+1],4,-1530992060),s=un(s,r,i,n,e[o+4],11,1272893353),n=un(n,s,r,i,e[o+7],16,-155497632),i=un(i,n,s,r,e[o+10],23,-1094730640),r=un(r,i,n,s,e[o+13],4,681279174),s=un(s,r,i,n,e[o],11,-358537222),n=un(n,s,r,i,e[o+3],16,-722521979),i=un(i,n,s,r,e[o+6],23,76029189),r=un(r,i,n,s,e[o+9],4,-640364487),s=un(s,r,i,n,e[o+12],11,-421815835),n=un(n,s,r,i,e[o+15],16,530742520),i=un(i,n,s,r,e[o+2],23,-995338651),r=cn(r,i,n,s,e[o],6,-198630844),s=cn(s,r,i,n,e[o+7],10,1126891415),n=cn(n,s,r,i,e[o+14],15,-1416354905),i=cn(i,n,s,r,e[o+5],21,-57434055),r=cn(r,i,n,s,e[o+12],6,1700485571),s=cn(s,r,i,n,e[o+3],10,-1894986606),n=cn(n,s,r,i,e[o+10],15,-1051523),i=cn(i,n,s,r,e[o+1],21,-2054922799),r=cn(r,i,n,s,e[o+8],6,1873313359),s=cn(s,r,i,n,e[o+15],10,-30611744),n=cn(n,s,r,i,e[o+6],15,-1560198380),i=cn(i,n,s,r,e[o+13],21,1309151649),r=cn(r,i,n,s,e[o+4],6,-145523070),s=cn(s,r,i,n,e[o+11],10,-1120210379),n=cn(n,s,r,i,e[o+2],15,718787259),i=cn(i,n,s,r,e[o+9],21,-343485551),r=gp(r,a),i=gp(i,u),n=gp(n,c),s=gp(s,h)}return[r,i,n,s]}function JY(e,t=Jf.Hex){const r=t||Jf.Base64,i=qEe(UEe(e),e.length*cm);switch(r){case Jf.Raw:return i;case Jf.Hex:return GEe(i);case Jf.String:return VEe(i);case Jf.Base64:return BEe(i)}}const HEe=()=>oe.getLogger("esri.views.2d.layers.support.clusterUtils");Me.add("esri-cluster-arcade-enabled",!0);const WEe=Me("esri-cluster-arcade-enabled"),JEe=new Set(["simple-line","simple-fill","picture-fill"]);function R7(e,t){let r=t.clone();if(!ZEe(r))return r;if(t.getSymbols().some(i=>JEe.has(i.type))&&(r=new n0({symbol:new Ll})),r.authoringInfo||(r.authoringInfo=new sw),r.authoringInfo.isAutoGenerated=!0,"visualVariables"in r){const i=(r.visualVariables||[]).filter(n=>n.valueExpression!=="$view.scale");i.forEach(n=>{n.type==="rotation"?n.field?n.field=gh(e,n.field,"avg_angle","number"):n.valueExpression&&(n.field=sg(e,n.valueExpression,"avg_angle","number"),n.valueExpression=null):n.normalizationField?(n.field=gh(e,n.field,"avg_norm","number",n.normalizationField),n.normalizationField=null):n.field?n.field=gh(e,n.field,"avg","number"):n.valueExpression&&(n.field=sg(e,n.valueExpression,"avg","number"),n.valueExpression=null)}),r.visualVariables=i}switch(r.type){case"simple":break;case"pie-chart":for(const i of r.attributes)i.field?i.field=gh(e,i.field,"sum","number"):i.valueExpression&&(i.field=sg(e,i.valueExpression,"sum","number"),i.valueExpression=null);break;case"unique-value":r.field?r.field=gh(e,r.field,"mode","string"):r.valueExpression&&(r.field=sg(e,r.valueExpression,"mode","string"),r.valueExpression=null);break;case"class-breaks":r.normalizationField?(r.field=gh(e,r.field,"avg_norm","number",r.normalizationField),r.normalizationField=null):r.field?r.field=gh(e,r.field,"avg","number"):r.valueExpression&&(r.field=sg(e,r.valueExpression,"avg","number"),r.valueExpression=null)}return r}const ZEe=e=>{const t=r=>HEe().error(new z("Unsupported-renderer",r,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const r=e.normalizationType;if(r!=="field")return t(`FeatureReductionCluster does not support a normalizationType of ${r}`),!1}break;case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!WEe){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some(r=>!(!("valueExpression"in r)||!r.valueExpression)))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function YEe(e,t,r){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const i=r,n="field",s=t.toLowerCase()+",norm:"+n+","+i.toLowerCase();return"cluster_avg_"+JY(s)}}}function sg(e,t,r,i){const n=JY(t),s=r==="mode"?`cluster_type_${n}`:r==="sum"?`cluster_sum_${n}`:`cluster_avg_${n}`;return e.some(o=>o.name===s)||e.push(new gf({name:s,isAutoGenerated:!0,onStatisticExpression:new YP({expression:t,returnType:i}),statisticType:r})),s}function gh(e,t,r,i,n){if(t==="cluster_count"||e.some(o=>o.name===t))return t;const s=YEe(r,t,n);return e.some(o=>o.name===s)||(r==="avg_norm"?e.push(new gf({name:s,isAutoGenerated:!0,onStatisticExpression:new YP({expression:`$feature.${t} / $feature.${n}`,returnType:i}),statisticType:"avg"})):e.push(new gf({name:s,isAutoGenerated:!0,onStatisticField:t,statisticType:r}))),s}const KEe=e=>{let t=class extends e{constructor(...r){super(...r),this.addHandles(Ue(()=>this.renderer,()=>{if(this.featureReduction){const i=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",i)}},di))}set featureReduction(r){const i=this._normalizeFeatureReduction(r);this._set("featureReduction",i)}set renderer(r){}_withClusterVariable(r,i,n){const s=r.clone();return"visualVariables"in s&&(s.visualVariables||(s.visualVariables=[]),s.visualVariables.some(o=>o.type==="size")||s.visualVariables.push(new r0({field:"cluster_count",stops:[new _2({value:1}),new _2({useMinValue:!0,size:i}),new _2({useMaxValue:!0,size:n})]}))),s}_normalizeFeatureReduction(r){var d;if((r==null?void 0:r.type)!=="cluster")return r;const i=r.clone(),n=[new gf({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],s=(i.fields??[]).filter(y=>!y.isAutoGenerated),o=r.renderer&&!((d=r.renderer.authoringInfo)!=null&&d.isAutoGenerated),{clusterMinSize:a,clusterMaxSize:u}=i;if(o){i.fields=[...n,...s];const y=this._withClusterVariable(i.renderer,a,u);return i.effectiveFeatureRenderer=y,i.effectiveClusterRenderer=y,i}if(r.symbol){if(i.fields=[...n,...s],i.renderer=null,!this.renderer)return i.effectiveFeatureRenderer=null,i.effectiveClusterRenderer=null,i;const y=R7(n,this.renderer),v=this._withClusterVariable(y,a,u),w="visualVariables"in v&&v.visualVariables?v.visualVariables:[],b=new n0({symbol:r.symbol,visualVariables:w});return i.fields=[...n,...s],i.effectiveFeatureRenderer=v,i.effectiveClusterRenderer=b,i}if(!this.renderer)return r;const c=R7(n,this.renderer);i.fields=[...n,...s],i.renderer=c;const h=this._withClusterVariable(c,a,u);return i.effectiveFeatureRenderer=h,i.effectiveClusterRenderer=h,i}};return l([p(jEe)],t.prototype,"featureReduction",null),t=l([k("esri.layers.mixins.FeatureReductionLayer")],t),t};var $C;const ZM=new We({asc:"ascending",desc:"descending"});let Ry=$C=class extends Q{constructor(e){super(e),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new $C({field:this.field,valueExpression:this.valueExpression,order:this.order})}};l([p({type:String,json:{write:!0}})],Ry.prototype,"field",void 0),l([p({type:String,json:{write:!0}})],Ry.prototype,"valueExpression",void 0),l([p({type:ZM.apiValues,json:{read:ZM.read,write:ZM.write}})],Ry.prototype,"order",void 0),Ry=$C=l([k("esri.layers.support.OrderByInfo")],Ry);const ZY=Ry;function XEe(e,t,r){if(!e)return null;const i=e.find(s=>!!s.field);if(!i)return null;const n=new ZY;return n.read(i,r),[n]}function QEe(e,t,r,i){const n=e.find(s=>!!s.field);n&&En(r,[n.toJSON()],t)}const eAe=e=>{let t=class extends e{constructor(){super(...arguments),this.orderBy=null}};return l([p({type:[ZY],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:XEe},write:{target:"layerDefinition.orderBy",writer:QEe}}})],t.prototype,"orderBy",void 0),t=l([k("esri.layers.mixins.OrderedLayer")],t),t};let s1=class extends De{constructor(){super(...arguments),this.updating=!1,this.status="unknown"}};l([p()],s1.prototype,"updating",void 0),l([p()],s1.prototype,"status",void 0),s1=l([k("esri.layers.support.PublishingInfo")],s1);const tAe=s1,YY="esri.layers.mixins.PublishableLayer",rAe=Symbol(YY),iAe=e=>{var t;let r=class extends e{constructor(){super(...arguments),this[t]=!0}get publishingInfo(){if(this.destroyed)return null;const i=this._get("publishingInfo");if(i)return i;const n=new tAe;return this._checkPublishingStatus(n),n}_checkPublishingStatus(i){let o=0;const a=async c=>{let h;i.updating=!0;try{h=await this.fetchPublishingStatus()}catch{h="unavailable"}h!=="published"&&h!=="unavailable"||(i.status==="publishing"&&this.refresh(),u.remove()),i.status=h,i.updating=!1,u.removed||(o=setTimeout(a,c,c+125))},u={removed:!1,remove(){this.removed=!0,clearTimeout(o)}};this.when().catch(()=>u.remove()),a(250),this.addHandles(u)}};return t=rAe,l([p({readOnly:!0,clonable:!1})],r.prototype,"publishingInfo",null),r=l([k(YY)],r),r};function nAe(){return{fields:{type:[Po],value:null,set:function(e){if(e&&Me("big-integer-warning-enabled")){const t=e.filter(r=>r.type==="big-integer"||r.type==="oid"&&(r.length||0)>=8);if(t.length){const r=t.map(i=>`'${i.name}'`).join(", ");oe.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${r}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return DT.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){var t;const e=this._userOutFields;if(!(e!=null&&e.length))return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const r of e)((t=this.fieldsIndex)==null?void 0:t.has(r))||oe.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${r} found in outFields`,{layer:this,outFields:e});return sT(this.fieldsIndex,e)}}}}async function sAe(e,t,r){const i=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(i&&i.type==="unique-value"&&i.styleOrigin){const n=await yT(i.populateFromStyle());if(Ut(r),n.ok===!1){const s=n.error;t!=null&&t.messages&&t.messages.push(new eo("renderer:style-reference",`Failed to create unique value renderer from style reference: ${s.message}`,{error:s,context:t})),e.clear("renderer",t==null?void 0:t.origin)}}}const jn="FeatureLayer";function h_(e,t){return new z("layer:unsupported",`Layer (${e.title}, ${e.id}) of type '${e.declaredClass}' ${t}`,{layer:e})}function C7(e){return e&&e instanceof $e}const YM=nAe();function KM(e,t,r){const i=!!(r!=null&&r.writeLayerSchema);return{enabled:i,ignoreOrigin:i}}let Pe=class extends NEe(KEe(aEe(iAe(nEe(zp(eAe(IT(Zp(xf(tw(qp(Jp(kl(rw($T(It(Yu))))))))))))))))){constructor(...e){super(...e),this.charts=null,this.copyright=null,this.displayField=null,this.dynamicDataSource=null,this.fields=null,this.fieldsIndex=null,this.formTemplate=null,this.fullExtent=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.resourceInfo=null,this.screenSizePerspectiveEnabled=!0,this.spatialReference=xe.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.type="feature",this.typeIdField=null,this.types=null,this.visible=!0,this._debouncedSaveOperations=Bx(async(t,r,i)=>{const{save:n,saveAs:s}=await ge(()=>import("./featureLayerUtils-BWRzCnP0.js"),__vite__mapDeps([132,1,2,125,126,124,127,128,18,16]));switch(t){case vl.SAVE:return n(this,r);case vl.SAVE_AS:return s(this,i,r)}})}destroy(){var e;(e=this.source)==null||e.destroy()}normalizeCtorArgs(e,t){return typeof e=="string"?{url:e,...t}:e}load(e){var i;const t=e!=null?e.signal:null;if((i=this.portalItem)!=null&&i.loaded&&this.source)return this.addResolvingPromise(this.createGraphicsSource(t).then(n=>this.initLayerProperties(n))),Promise.resolve(this);const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},e).catch(Ti).then(async()=>{if(this.url&&this.layerId==null&&/FeatureServer|MapServer\/*$/i.test(this.url)){const n=await this._fetchFirstValidLayerId(t);n!=null&&(this.layerId=n)}if(!this.url&&!this._hasMemorySource())throw new z("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this.initLayerProperties(await this.createGraphicsSource(t))}).then(()=>AEe(this,"load",e));return this.addResolvingPromise(r),Promise.resolve(this)}readCapabilities(e,t){return t=t.layerDefinition||t,xP(t,this.url)}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")??0)+1}get editingEnabled(){var e;return!(this.loaded&&!((e=this.capabilities)!=null&&e.operations.supportsEditing))&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}readEditingEnabled(e,t){return this._readEditingEnabled(t,!1)}readEditingEnabledFromWebMap(e,t,r){return this._readEditingEnabled(t,!0,r)}writeEditingEnabled(e,t){this._writeEditingEnabled(e,t,!1)}writeEditingEnabledToWebMap(e,t,r,i){this._writeEditingEnabled(e,t,!0,i)}get effectiveEditingEnabled(){return REe(this)}readIsTable(e,t){return(t=(t==null?void 0:t.layerDefinition)??t).type==="Table"||!t.geometryType}writeIsTable(e,t,r,i){i!=null&&i.writeLayerSchema&&En(r,e?"Table":"Feature Layer",t)}readGlobalIdField(e,t){return BY(t.layerDefinition||t)}readObjectIdField(e,t){return zY(t.layerDefinition||t)}get parsedUrl(){const e=Pt(this.url);return e!=null&&(this.dynamicDataSource!=null?e.path=jo(e.path,"dynamicLayer"):this.layerId!=null&&(e.path=jo(e.path,this.layerId.toString()))),e}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(e){y8(e,this.fieldsIndex),this._set("renderer",e)}readRenderer(e,t,r){var n;t=t.layerDefinition||t;const i=(n=t.drawingInfo)==null?void 0:n.renderer;if(i){const s=gv(i,t,r)??void 0;return s||oe.getLogger(this).error("Failed to create renderer",{rendererDefinition:t.drawingInfo.renderer,layer:this,context:r}),s}return ZP(t,r)}set source(e){const t=this._get("source");t!==e&&(C7(t)&&this._resetMemorySource(t),C7(e)&&this._initMemorySource(e),this._set("source",e))}castSource(e){return e?Array.isArray(e)||e instanceof $e?new Eu({layer:this,items:e}):e:null}readSource(e,t){const r=Tf.fromJSON(t.featureSet);return new Eu({layer:this,items:(r==null?void 0:r.features)??[]})}readTemplates(e,t){const r=t.editFieldsInfo,i=r==null?void 0:r.creatorField,n=r==null?void 0:r.editorField;return e=e==null?void 0:e.map(s=>vP.fromJSON(s)),this._fixTemplates(e,i),this._fixTemplates(e,n),e}readTitle(e,t){var n,s,o;const r=((n=t.layerDefinition)==null?void 0:n.name)??t.name,i=t.title||((s=t.layerDefinition)==null?void 0:s.title);if(r){const a=(o=this.portalItem)==null?void 0:o.title;if(this.sublayerTitleMode==="item-title")return this.url?W1e(this.url,r):r;let u=r;if(!u&&this.url){const c=zu(this.url);c!=null&&(u=c.title)}return u?(this.sublayerTitleMode==="item-title-and-service-name"&&a&&a!==u&&(u=a+" - "+u),q4(u)):void 0}if(this.sublayerTitleMode==="item-title"&&i)return i}readTitleFromWebMap(e,t){var r;return t.title||((r=t.layerDefinition)==null?void 0:r.name)}readTypeIdField(e,t){let r=(t=t.layerDefinition||t).typeIdField;if(r&&t.fields){r=r.toLowerCase();const i=t.fields.find(n=>n.name.toLowerCase()===r);i&&(r=i.name)}return r}readTypes(e,t){e=(t=t.layerDefinition||t).types;const r=t.editFieldsInfo,i=r==null?void 0:r.creatorField,n=r==null?void 0:r.editorField;return e==null?void 0:e.map(s=>(s=wP.fromJSON(s),this._fixTemplates(s.templates,i),this._fixTemplates(s.templates,n),s))}readVisible(e,t){var r;return((r=t.layerDefinition)==null?void 0:r.defaultVisibility)!=null?!!t.layerDefinition.defaultVisibility:t.visibility!=null?!!t.visibility:void 0}async addAttachment(e,t){return dEe(this,e,t,jn)}async updateAttachment(e,t,r){return fEe(this,e,t,r,jn)}async applyEdits(e,t){return yEe(this,e,t)}async uploadAssets(e,t){return mEe(this,e,t)}on(e,t){return super.on(e,t)}createPopupTemplate(e){return TP(this,e)}async createGraphicsSource(e){if(this._hasMemorySource()&&this.source)return this.source.load({signal:e});const{default:t}=await hl(ge(()=>import("./FeatureLayerSource-BWltbyo2.js"),__vite__mapDeps([133,1,2,35,36,37,50,131,73,71])),e);return new t({layer:this}).load({signal:e})}createQuery(){const e=MEe(this);e.dynamicDataSource=this.dynamicDataSource;const t=this.subtypeCode!=null?`${this.subtypeField} = ${this.subtypeCode}`:null,r=WO(this.definitionExpression,t);return e.where=r||"1=1",e}async deleteAttachments(e,t){return gEe(this,e,t,jn)}async fetchRecomputedExtents(e){return vEe(this,e,jn)}getFeatureType(e){const{typeIdField:t,types:r}=this;if(!t||!e)return null;const i=e.attributes?e.attributes[t]:void 0;if(i==null)return null;let n=null;return r==null||r.some(s=>{const{id:o}=s;return o!=null&&(o.toString()===i.toString()&&(n=s),!!n)}),n}getFieldDomain(e,t){const r=t==null?void 0:t.feature,i=this.getFeatureType(r);if(i){const n=i.domains&&i.domains[e];if(n&&n.type!=="inherited")return n}return this._getLayerDomain(e)}getField(e){return this.fieldsIndex.get(e)}async queryAttachments(e,t){return wEe(this,e,t,jn)}async queryFeatures(e,t){const r=await this.load(),i=await r.source.queryFeatures($i.from(e)??r.createQuery(),t);if(i!=null&&i.features)for(const n of i.features)n.layer=n.sourceLayer=r;return i}async queryObjectIds(e,t){return bEe(this,e,t,jn)}async queryFeatureCount(e,t){return _Ee(this,e,t,jn)}async queryExtent(e,t){return SEe(this,e,t,jn)}async queryRelatedFeatures(e,t){return xEe(this,e,t,jn)}async queryRelatedFeaturesCount(e,t){return TEe(this,e,t,jn)}async queryTopFeatures(e,t){var s;const{source:r,capabilities:i}=await this.load();if(!r.queryTopFeatures||!((s=i==null?void 0:i.query)!=null&&s.supportsTopFeaturesQuery))throw new z(jn,"Layer source does not support queryTopFeatures capability");const n=await r.queryTopFeatures(p_.from(e),t);if(n!=null&&n.features)for(const o of n.features)o.layer=o.sourceLayer=this;return n}async queryTopObjectIds(e,t){const{source:r,capabilities:i}=await this.load();if(!r.queryTopObjectIds||!(i!=null&&i.query.supportsTopFeaturesQuery))throw new z(jn,"Layer source does not support queryTopObjectIds capability");return r.queryTopObjectIds(p_.from(e),t)}async queryTopFeaturesExtent(e,t){var n;const{source:r,capabilities:i}=await this.load();if(!r.queryTopExtents||!((n=i==null?void 0:i.query)!=null&&n.supportsTopFeaturesQuery))throw new z(jn,"Layer source does not support queryTopExtents capability");return r.queryTopExtents(p_.from(e),t)}async queryTopFeatureCount(e,t){var n;const{source:r,capabilities:i}=await this.load();if(!r.queryTopCount||!((n=i==null?void 0:i.query)!=null&&n.supportsTopFeaturesQuery))throw new z(jn,"Layer source does not support queryFeatureCount capability");return r.queryTopCount(p_.from(e),t)}read(e,t){const r=e.featureCollection;if((r||e.type==="Feature Collection")&&(this.resourceInfo=e),r){const i=r.layers;i&&i.length===1&&(super.read(i[0],t),r.showLegend!=null&&super.read({showLegend:r.showLegend},t))}super.read(e,t),t&&t.origin==="service"&&(this.revert(["objectIdField","fields","timeInfo","dateFieldsTimeZone"],"service"),this.spatialReference||this.revert(["spatialReference"],"service"))}write(e,t){t={...t,origin:(t==null?void 0:t.origin)??void 0,writeLayerSchema:(t==null?void 0:t.writeLayerSchema)??this._hasMemorySource()};const{origin:r,layerContainerType:i,messages:n}=t;if(this.dynamicDataSource)return n==null||n.push(h_(this,"using a dynamic data source cannot be written to web scenes, web maps and feature service items")),null;if(this.isTable){if((r==="web-map"||r==="web-scene")&&i!=="tables")return n==null||n.push(h_(this,`a table source can only be written to tables, not ${i}`)),null;if(this._hasMemorySource())return n==null||n.push(h_(this,"using an in-memory table source cannot be written to web scenes and web maps")),null}else if(this.loaded&&(r==="web-map"||r==="web-scene")&&i==="tables")return n==null||n.push(h_(this,"using a non-table source cannot be written to tables in web maps or web scenes")),null;return super.write(e,t)}clone(){if(this._hasMemorySource())throw new z(jn,`FeatureLayer (title: ${this.title}, id: ${this.id}) created using in-memory source cannot be cloned`);return super.clone()}serviceSupportsSpatialReference(e){var t;return!!this.loaded&&(((t=this.source)==null?void 0:t.type)==="memory"||IP(this,e))}async save(e){return this._debouncedSaveOperations(vl.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(vl.SAVE_AS,t,e)}_readEditingEnabled(e,t,r){var n;let i=(n=e.layerDefinition)==null?void 0:n.capabilities;return i?this._hasEditingCapability(i):(i=e.capabilities,t&&(r==null?void 0:r.origin)==="web-map"&&!this._hasMemorySource()&&i?this._hasEditingCapability(i):void 0)}_hasEditingCapability(e){return e.toLowerCase().split(",").map(t=>t.trim()).includes("editing")}_writeEditingEnabled(e,t,r,i){var n,s;if(!e){const o=(s=(n=this.capabilities)==null?void 0:n.operations)!=null&&s.supportsSync?"Query,Sync":"Query";En("layerDefinition.capabilities",o,t),r&&!(i!=null&&i.writeLayerSchema)&&(t.capabilities=o)}}_getLayerDomain(e){const t=this.fieldsIndex.get(e);return t?t.domain:null}_fetchFirstValidLayerId(e){return be(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:e}).then(t=>{const r=t.data;if(r)return this.findFirstValidLayerId(r)})}async initLayerProperties(e){var t;return this._set("source",e),e.sourceJSON&&(this.sourceJSON=e.sourceJSON,this.read(e.sourceJSON,{origin:"service",portalItem:this.portalItem,portal:(t=this.portalItem)==null?void 0:t.portal,url:this.parsedUrl})),this._verifySource(),this._verifyFields(),y8(this.renderer,this.fieldsIndex),Vz(this.timeInfo,this.fieldsIndex),sAe(this,{origin:"service"})}async hasDataChanged(){return IEe(this)}async fetchPublishingStatus(){const e=this.source;return e!=null&&e.fetchPublishingStatus?e.fetchPublishingStatus():"unavailable"}_verifyFields(){var t,r;const e=((t=this.parsedUrl)==null?void 0:t.path)??"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+e+")"),this.isTable||this._hasMemorySource()||e.search(/\/FeatureServer\//i)!==-1||(r=this.fields)!=null&&r.some(i=>i.type==="geometry")||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+e+")")}_fixTemplates(e,t){e&&e.forEach(r=>{var n;const i=(n=r.prototype)==null?void 0:n.attributes;i&&t&&delete i[t]})}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new z("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new z("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(e){e.forEach(t=>{t.layer=this,t.sourceLayer=this}),this.addHandles([e.on("after-add",t=>{t.item.layer=this,t.item.sourceLayer=this}),e.on("after-remove",t=>{t.item.layer=null,t.item.sourceLayer=null})],"fl-source")}_resetMemorySource(e){e.forEach(t=>{t.layer=null,t.sourceLayer=null}),this.removeHandles("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}findFirstValidLayerId(e){return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}};l([te("service","capabilities")],Pe.prototype,"readCapabilities",null),l([p({json:{origins:{"web-scene":{write:!1}},write:!0}})],Pe.prototype,"charts",void 0),l([p({readOnly:!0})],Pe.prototype,"createQueryVersion",null),l([p({json:{read:{source:"layerDefinition.copyrightText"}}})],Pe.prototype,"copyright",void 0),l([p({json:{read:{source:"layerDefinition.displayField"}}})],Pe.prototype,"displayField",void 0),l([p({types:Hd,readOnly:!0})],Pe.prototype,"defaultSymbol",void 0),l([p({type:Wn})],Pe.prototype,"dynamicDataSource",void 0),l([p({type:Boolean})],Pe.prototype,"editingEnabled",null),l([te(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],Pe.prototype,"readEditingEnabled",null),l([te("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],Pe.prototype,"readEditingEnabledFromWebMap",null),l([se(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],Pe.prototype,"writeEditingEnabled",null),l([se("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],Pe.prototype,"writeEditingEnabledToWebMap",null),l([p({readOnly:!0})],Pe.prototype,"effectiveEditingEnabled",null),l([p({...YM.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:KM}}}}})],Pe.prototype,"fields",void 0),l([p(YM.fieldsIndex)],Pe.prototype,"fieldsIndex",void 0),l([p({type:J$e,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],Pe.prototype,"formTemplate",void 0),l([p({json:{read:{source:"layerDefinition.extent"}}})],Pe.prototype,"fullExtent",void 0),l([p({json:{origins:{"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:KM,writer(e,t,r){const i=e?SC.toJSON(e):null;i&&En(r,i,t)}}}},read:{source:"layerDefinition.geometryType",reader:SC.read}}})],Pe.prototype,"geometryType",void 0),l([p({json:{read:{source:"layerDefinition.hasM"}}})],Pe.prototype,"hasM",void 0),l([p({json:{read:{source:"layerDefinition.hasZ"}}})],Pe.prototype,"hasZ",void 0),l([p(pH)],Pe.prototype,"id",void 0),l([p({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],Pe.prototype,"infoFor3D",void 0),l([p({json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],Pe.prototype,"isTable",void 0),l([te("service","isTable",["type","geometryType"]),te("isTable",["layerDefinition.type","layerDefinition.geometryType"])],Pe.prototype,"readIsTable",null),l([se("web-map","isTable")],Pe.prototype,"writeIsTable",null),l([p(F4)],Pe.prototype,"labelsVisible",void 0),l([p({type:[cw],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:_M,write:!1},"web-scene":{name:"layerDefinition.drawingInfo.labelingInfo",read:_M,write:{enabled:!0,layerContainerTypes:An}}},name:"layerDefinition.drawingInfo.labelingInfo",read:_M,write:!0}})],Pe.prototype,"labelingInfo",void 0),l([p((()=>{const e=B(Uge);return e.json.origins["portal-item"]={write:{target:"layerDefinition.drawingInfo.transparency",writer(t,r,i){En(i,lT(t),r)}}},e})())],Pe.prototype,"opacity",void 0),l([p(j4)],Pe.prototype,"legendEnabled",void 0),l([p({type:["show","hide"],json:(()=>{const e=B(hH.json);return e.origins["portal-item"]={read:!1,write:!1},e})()})],Pe.prototype,"listMode",void 0),l([te("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],Pe.prototype,"readGlobalIdField",null),l([p({json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:KM}}}}})],Pe.prototype,"objectIdField",void 0),l([te("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],Pe.prototype,"readObjectIdField",null),l([p({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],Pe.prototype,"operationalLayerType",void 0),l([p(YM.outFields)],Pe.prototype,"outFields",void 0),l([p({readOnly:!0})],Pe.prototype,"parsedUrl",null),l([p({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],Pe.prototype,"path",void 0),l([p(Xv)],Pe.prototype,"popupEnabled",void 0),l([p({type:Up,json:{name:"popupInfo",write:!0}})],Pe.prototype,"popupTemplate",void 0),l([p({readOnly:!0})],Pe.prototype,"defaultPopupTemplate",null),l([p({types:aw,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:LJ,name:"layerDefinition.drawingInfo.renderer",write:{layerContainerTypes:An,overridePolicy:(e,t,r)=>({ignoreOrigin:r==null?void 0:r.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(e,t,r)=>({ignoreOrigin:r==null?void 0:r.writeLayerSchema})}}})],Pe.prototype,"renderer",null),l([te("service","renderer",["drawingInfo.renderer","defaultSymbol"]),te("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],Pe.prototype,"readRenderer",null),l([p()],Pe.prototype,"resourceInfo",void 0),l([p((()=>{const e=B(Fge);return e.json.origins["portal-item"]={read:!1,write:!1},e})())],Pe.prototype,"screenSizePerspectiveEnabled",void 0),l([p({clonable:!1})],Pe.prototype,"source",null),l([Tt("source")],Pe.prototype,"castSource",null),l([te("portal-item","source",["featureSet"]),te("web-map","source",["featureSet"])],Pe.prototype,"readSource",null),l([p({json:{read:{source:"layerDefinition.extent.spatialReference"}}})],Pe.prototype,"spatialReference",void 0),l([p({type:Number})],Pe.prototype,"subtypeCode",void 0),l([p({type:[vP]})],Pe.prototype,"templates",void 0),l([te("templates",["editFieldsInfo","creatorField","editorField","templates"])],Pe.prototype,"readTemplates",null),l([p({type:LH})],Pe.prototype,"timeInfo",void 0),l([p()],Pe.prototype,"title",void 0),l([te("service","title",["name"]),te("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],Pe.prototype,"readTitle",null),l([te("web-map","title",["layerDefinition.name","title"])],Pe.prototype,"readTitleFromWebMap",null),l([p({type:String})],Pe.prototype,"sublayerTitleMode",void 0),l([p({json:{read:!1}})],Pe.prototype,"type",void 0),l([p({type:String})],Pe.prototype,"typeIdField",void 0),l([te("service","typeIdField"),te("typeIdField",["layerDefinition.typeIdField"])],Pe.prototype,"readTypeIdField",null),l([p({type:[wP]})],Pe.prototype,"types",void 0),l([te("service","types",["types"]),te("types",["layerDefinition.types"])],Pe.prototype,"readTypes",null),l([p({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],Pe.prototype,"visible",void 0),l([te("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],Pe.prototype,"readVisible",null),Pe=l([k("esri.layers.FeatureLayer")],Pe);const KY=Pe,oAe=Object.freeze(Object.defineProperty({__proto__:null,default:KY},Symbol.toStringTag,{value:"Module"})),aAe=[{level:1,resolution:.3515625,scale:13977056600717944e-8},{level:2,resolution:.17578125,scale:6988528300358972e-8},{level:3,resolution:.087890625,scale:3494264150179486e-8},{level:4,resolution:.0439453125,scale:1747132075089743e-8},{level:5,resolution:.02197265625,scale:8735660375448715e-9},{level:6,resolution:.010986328125,scale:4.3678301877243575e6},{level:7,resolution:.0054931640625,scale:2.1839150938621787e6},{level:8,resolution:.00274658203125,scale:1.0919575469310894e6},{level:9,resolution:.001373291015625,scale:545978.7734655447},{level:10,resolution:.0006866455078125,scale:272989.38673277234},{level:11,resolution:.0003433227539062,scale:136494.69336636632},{level:12,resolution:.0001716613769531,scale:68247.34668318316},{level:13,resolution:858306884766e-16,scale:34123.67334161145},{level:14,resolution:429153442383e-16,scale:17061.836670805726},{level:15,resolution:214576721191e-16,scale:8530.918335382985},{level:16,resolution:107288360596e-16,scale:4265.45916771137}],lAe={dpi:96,rows:256,cols:256,compressionQuality:0,origin:{x:-180,y:90},spatialReference:{wkid:4490},lods:aAe},uAe=[{level:0,resolution:.3515625,scale:13977056600717944e-8},{level:1,resolution:.17578125,scale:6988528300358972e-8},{level:2,resolution:.087890625,scale:3494264150179486e-8},{level:3,resolution:.0439453125,scale:1747132075089743e-8},{level:4,resolution:.02197265625,scale:8735660375448715e-9},{level:5,resolution:.010986328125,scale:4.3678301877243575e6},{level:6,resolution:.0054931640625,scale:2.1839150938621787e6},{level:7,resolution:.00274658203125,scale:1.0919575469310894e6},{level:8,resolution:.001373291015625,scale:545978.7734655447},{level:9,resolution:.0006866455078125,scale:272989.38673277234},{level:10,resolution:.0003433227539062,scale:136494.69336636632},{level:11,resolution:.0001716613769531,scale:68247.34668318316},{level:12,resolution:858306884766e-16,scale:34123.67334161145},{level:13,resolution:429153442383e-16,scale:17061.836670805726},{level:14,resolution:214576721191e-16,scale:8530.918335382985},{level:15,resolution:107288360596e-16,scale:4265.45916771137},{level:16,resolution:53644180298e-16,scale:2132.729583855685},{level:17,resolution:26822090149e-16,scale:1066.3647919278426},{level:18,resolution:13411045074e-16,scale:533.1823959440429},{level:19,resolution:6705522537e-16,scale:266.59119797202146},{level:20,resolution:3352761269e-16,scale:133.2955990058892},{level:21,resolution:1676380634e-16,scale:66.64779948306612},{level:22,resolution:838190317e-16,scale:33.32389974153306}],cAe={dpi:96,rows:512,cols:512,compressionQuality:0,origin:{x:-180,y:90},spatialReference:{wkid:4490},lods:uAe},pAe=[{level:2,resolution:.3515625,scale:13977056600717944e-8},{level:3,resolution:.17578125,scale:6988528300358972e-8},{level:4,resolution:.087890625,scale:3494264150179486e-8},{level:5,resolution:.0439453125,scale:1747132075089743e-8},{level:6,resolution:.02197265625,scale:8735660375448715e-9},{level:7,resolution:.010986328125,scale:4.3678301877243575e6},{level:8,resolution:.0054931640625,scale:2.1839150938621787e6},{level:9,resolution:.00274658203125,scale:1.0919575469310894e6},{level:10,resolution:.001373291015625,scale:545978.7734655447},{level:11,resolution:.0006866455078125,scale:272989.38673277234},{level:12,resolution:.0003433227539062,scale:136494.69336636632},{level:13,resolution:.0001716613769531,scale:68247.34668318316},{level:14,resolution:858306884766e-16,scale:34123.67334161145},{level:15,resolution:429153442383e-16,scale:17061.836670805726},{level:16,resolution:214576721191e-16,scale:8530.918335382985},{level:17,resolution:107288360596e-16,scale:4265.45916771137}],hAe={rows:256,cols:256,compressionQuality:0,origin:{x:-180,y:90},spatialReference:{wkid:4490},lods:pAe};class XY{constructor(t,r){this.view=t}getLayerId(t){return(t==null?void 0:t.id)||""}show(t){const r=this.getLayerId(t);if(!r)return;let i=this.view.map.findLayerById(r);i?i.visible=!0:(i=this.createLayer(t,r),i&&this.view.map.add(i))}hide(t){const r=this.getLayerId(t);if(!r)return;const i=this.view.map.findLayerById(r);i&&(i.visible=!1)}setOpacity(t,r){const i=this.getLayerId(t);if(!i)return;const n=this.view.map.findLayerById(i);n&&(n.opacity=r)}getOpacity(t){const r=this.getLayerId(t);if(r){const i=this.view.map.findLayerById(r);if(i)return i.opacity}return(t==null?void 0:t.opacity)||1}createLayer(t,r){let i=null;switch((t==null?void 0:t.layerType)||""){case"geoserverWMS":i=this.createWMSLayer(t,r);break;case"geoserverWMTS_WMTSLayer":i=this.createWMTSLayerByWMTSLayer(t,r);break;case"geoserverWMTS_WebTileLayer":i=this.createWMTSLayerByWebTileLayer(t,r);break;case"geoserver_vector_tile_VectorTileLayer":i=this.createVectorTileLayer(t,r);break;case"geoserverWFS_?":i=null;break;case"arcgis_MapServer(Dynamic)_MapImageLayer":i=this.createMapImageLayer(t,r);break;case"arcgis_MapServer(Tile)_TileLayer":i=this.createTileLayer(t,r);break;case"arcgis_WMS_WMSLayer":i=this.createWMSLayer(t,r);break;case"arcgis_FeatureServer_FeatureLayer":i=this.createFeatureLayer(t,r);break;case"arcgis_imageServer_ImageryLayer":i=this.createImageryLayer(t,r);break;case"arcgis_WMTS_?":i=this.createWMTSLayerByWMTSLayer(t,r);break}return i&&(i.opacity=t.opacity||1),i}createWMSLayer(t,r,i){const n={id:r,url:t.url,spatialReference:this.view.spatialReference,title:t.name};return t.layerTable&&(n.sublayers=[{name:t.layerTable}]),i&&(n.imageFormat=i),new GH(n)}createWMTSLayerByWMTSLayer(t,r){debugger;return new ZH({url:"https://gibs.earthdata.nasa.gov/wmts/epsg4326/best",copyright:"<a href='https://earthdata.nasa.gov'>Earthdata</a> by NASA",activeLayer:{id:"SRTM_Color_Index"}})}createWMTSLayerByWebTileLayer(t,r){return new MT({id:r,urlTemplate:t.urlTemplate,tileInfo:lAe,spatialReference:this.view.spatialReference,title:t.name})}createVectorTileLayer(t,r){const i={id:r,title:t.name,style:{version:8,sources:{abc:{type:"vector",capabilities:"TileOnly",tiles:[t.urlTemplate],tileInfo:{...cAe}}},layers:[{id:t.name+"a",type:"fill",paint:{"fill-color":["match",["get","DJ"],"小1型","#ff0000","中型","#00ff00","大型","#0000ff","#cccccc"],"fill-outline-color":"#ff0000"},"source-layer":t.layerTable,source:"abc",minzoom:0,maxzoom:24}]}};debugger;return new iJ(i)}createMapImageLayer(t,r){debugger;const i={id:r,url:t.url,title:t.name,sublayers:[{id:2,visible:!1},{id:1,visible:!0},{id:0,visible:!1}]};return new xZ(i)}createTileLayer(t,r){return new IZ({id:r,url:t.url,spatialReference:this.view.spatialReference,title:t.name})}createImageryLayer(t,r){return new OY({id:r,url:t.url,title:t.name})}createFeatureLayer(t,r){return new KY({id:r,url:`${t.url}/${t.layerTable}`,spatialReference:this.view.spatialReference,title:t.text})}}const Qp=Poe("map",{state:()=>({view:null,activeTool:"",subViews:[],activeView:null,mapAndToolBoxDom:null,multiViewTeleportBoxDom:null,mapSwipeTeleportBoxDom:null}),getters:{},actions:{setView(e){this.view=e},setActiveTool(e){this.activeTool=e},addSubView(e){this.subViews.includes(e)||this.subViews.push(e)},removeSubView(e){const t=this.subViews.indexOf(e);t!=-1&&this.subViews.splice(t,1)},setActiveView(e){this.activeView=e},setMapAndToolBoxDom(e){this.mapAndToolBoxDom=e},setMultiViewTeleportBoxDom(e){this.multiViewTeleportBoxDom=e},setMapSwipeTeleportBoxDom(e){this.mapSwipeTeleportBoxDom=e}}}),EC=[{id:"1",layerType:"geoserverWMS",url:"http://xxx.xxx.x.xxx:xxxx/AgServer/abc/wms",name:"geoserver_wms"},{disabled:!0,id:"2",layerType:"geoserverWMTS_WMTSLayer",name:"geoserver_wmts_WMTSLayer",url:"http://xxx.xxx.x.xxx:xxxx/AgServer/abc/wms",layerTable:"abc:city_aqdx_sk"},{id:"3",layerType:"geoserverWMTS_WebTileLayer",name:"geoserver_wmts_WebTileLayer",type:"wmts",urlTemplate:"http://xxx.xxx.x.xxx:xxxx/AgServer/gwc/service/wmts?layer=abc%3Acity_aqdx_sk&style=&tilematrixset=EPSG%3A4490&Service=WMTS&Request=GetTile&Version=1.0.0&Format=image%2Fpng&TileMatrix=EPSG%3A4490%3A{level}&TileCol={col}&TileRow={row}",layerTable:"city_aqdx_sk"},{id:"4",layerType:"geoserver_vector_tile_VectorTileLayer",name:"geoserver_vector_tile_VectorTileLayer",type:"vector_tile",tileInfoType:"tileInfo4490",urlTemplate:"http://xxx.xxx.x.xxx:xxxx/AgServer/gwc/service/wmts/rest/abc:city_aqdx_sk/EPSG:4490/EPSG:4490:{z}/{y}/{x}?format=application/vnd.mapbox-vector-tile",layerTable:"city_aqdx_sk"},{id:"6",layerType:"arcgis_MapServer(Tile)_TileLayer",name:"arcgis_MapServer(Tile)_TileLayer",type:"xxx",url:"https://services.arcgisonline.com/arcgis/rest/services/World_Terrain_Base/MapServer"},{id:"7",layerType:"arcgis_WMS_WMSLayer",name:"arcgis_WMS_WMSLayer",type:"xxx",url:"https://ows.terrestris.de/osm/service",layerTable:"OSM-WMS"},{id:"8",layerType:"arcgis_WMTS_?",name:"arcgis_WMTS_?",type:"wmts",url:"https://gibs.earthdata.nasa.gov/wmts/epsg4326/best",layerTable:"SRTM_Color_Index"},{id:"9",layerType:"arcgis_imageServer_ImageryLayer",name:"arcgis_imageServer_ImageryLayer",type:"image",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/NLCDLandCover2001/ImageServer",layerTable:"SRTM_Color_Index"},{id:"10",layerType:"arcgis_FeatureServer_FeatureLayer",name:"arcgis_FeatureServer_FeatureLayer",type:"xxx",url:"https://sampleserver6.arcgisonline.com/arcgis/rest/services/USA/MapServer",layerTable:"0"}],dAe={class:"abc"},fAe={class:"custom-tree-node"},yAe={class:"el-tree-node__label"},mAe={class:"slider-box"},gAe={class:"btn-box"},O7="id",vAe=Lp({name:"LayerTree",__name:"index",setup(e){const t=Qp(),{view:r}=Rv(t),i=Ot(!0),n=Ot(),s=Ot(EC),o={label:"name",class:"layer-tree-node",disabled:"disabled"},a=Ot([]),u=Ot(!1),c=Ot(null),h=Ot(1);let d=null;const y=(b,_,x)=>{console.log(b,_,x),b[O7],_?d.show(b):d.hide(b)},v=b=>{c.value=b,h.value=d.getOpacity(b),u.value=!0},w=()=>{c.value.opacity=h.value,d.setOpacity(c.value,h.value),u.value=!1};return Cv(r,b=>{b&&(d=new XY(r.value))}),(b,_)=>{const x=Zt("Coin"),T=Zt("el-icon"),I=Zt("el-tooltip"),M=Zt("Watermelon"),$=Zt("el-tree"),A=Zt("el-scrollbar"),R=Zt("el-slider"),L=Zt("el-button"),C=Zt("el-dialog");return La(),kp("div",null,[ut(I,{effect:"light",content:"图层树",placement:"bottom"},{default:ir(()=>[ut(T,{class:"fold-btn",onClick:_[0]||(_[0]=U=>i.value=!i.value)},{default:ir(()=>[ut(x)]),_:1})]),_:1}),jd(gr("div",dAe,[ut(A,{"max-height":"600"},{default:ir(()=>[ut($,{ref_key:"layerTreeRef",ref:n,data:s.value,props:o,"default-expand-all":!0,"node-key":O7,"default-checked-keys":a.value,"show-checkbox":"",onCheckChange:y},{default:ir(({node:U,data:F})=>[gr("span",fAe,[gr("span",yAe,oV(U.label),1),ut(I,{content:"透明度设置",effect:"light",placement:"right"},{default:ir(()=>[ut(T,{onClick:j=>v(F)},{default:ir(()=>[ut(M)]),_:2},1032,["onClick"])]),_:2},1024)])]),_:1},8,["data","default-checked-keys"])]),_:1})],512),[[Ud,!i.value]]),ut(C,{class:"layer-opacity-settig-dialog",modelValue:u.value,"onUpdate:modelValue":_[3]||(_[3]=U=>u.value=U),title:"透明度设置",width:"400"},{default:ir(()=>[gr("div",mAe,[ut(R,{modelValue:h.value,"onUpdate:modelValue":_[1]||(_[1]=U=>h.value=U),"show-input":"",min:0,max:1,step:.1},null,8,["modelValue"])]),gr("div",gAe,[ut(L,{onClick:w},{default:ir(()=>[mS("确定")]),_:1}),ut(L,{onClick:_[2]||(_[2]=U=>u.value=!1)},{default:ir(()=>[mS("取消")]),_:1})])]),_:1},8,["modelValue"])])}}}),wAe=Um(vAe,[["__scopeId","data-v-0b763c91"]]);async function bAe(e){if(!e)return;const t=e.includes("-vector")?e.slice(0,e.indexOf("-vector")):e.includes("-3d")?e.slice(0,e.indexOf("-3d")):e,r=await o4("esri/t9n/basemaps");return r[e]||r[t]}const AC={satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/30d6b8271e1849cd9c3042060001f425/resources/styles/root.json",layerType:"VectorTileLayer",title:"Hybrid Reference Layer",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get"dark-gray"(){return{...this["dark-gray-vector"],id:"dark-gray"}},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},get gray(){return{...this["gray-vector"],id:"gray"}},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},get streets(){return{...this["streets-vector"],id:"streets"}},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},get topo(){return{...this["topo-vector"],id:"topo"}},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Rt("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"topo-3d":{id:"topo-3d",is3d:!0,get thumbnailUrl(){return Rt("esri/images/basemap/topo-3d.png")},baseMapLayers:[{id:"topo-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/1e7d1784d1ef4b79ba6764d0bd6c3150/resources/styles/root.json",layerType:"VectorTileLayer",title:"Topographic",visibility:!0,opacity:1},{id:"topo-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"topo-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-3d":{id:"navigation-3d",is3d:!0,get thumbnailUrl(){return Rt("esri/images/basemap/navigation-3d.jpg")},baseMapLayers:[{id:"navigation-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/ccc904ff872b4144b94934e55e32784b/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation",visibility:!0,opacity:1},{id:"navigation-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-3d":{id:"streets-3d",is3d:!0,get thumbnailUrl(){return Rt("esri/images/basemap/streets-3d.png")},baseMapLayers:[{id:"streets-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/198298c4c64c4cb19de5b46aa00c198d/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"streets-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"streets-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"osm-3d":{id:"osm-3d",is3d:!0,get thumbnailUrl(){return Rt("esri/images/basemap/osm-3d.png")},baseMapLayers:[{id:"osm-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/8628d259c9d14bdc848771c23c513940/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap",visibility:!0,opacity:1},{id:"osm-3d-trees",title:"Trees",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Trees_Thematic_v1/SceneServer",itemId:"f75fef56b2d944fe92ef9f7737b4f953",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"osm-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"gray-3d":{id:"gray-3d",is3d:!0,get thumbnailUrl(){return Rt("esri/images/basemap/gray-3d.png")},baseMapLayers:[{id:"gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/01a14b466345455ba4176d2e6390db92/resources/styles/root.json",layerType:"VectorTileLayer",title:"Streets",visibility:!0,opacity:1},{id:"gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_DarkLabels_v1/SceneServer",itemId:"a84404ad39c64c328d0596e361ec459b",layerType:"ArcGISSceneServiceLayer"},{id:"gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"navigation-dark-3d":{id:"navigation-dark-3d",itemId:"5a1365328b4943f09a54cf5fd1205707",is3d:!0,baseMapLayers:[{id:"navigation-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/451a1777ab3f4bf095fae24a117439d9/resources/styles/root.json",layerType:"VectorTileLayer",title:"Navigation Dark"},{id:"navigation-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"navigation-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"streets-dark-3d":{id:"streets-dark-3d",itemId:"8a4efa2c20484ec9b4557895e65736ff",is3d:!0,baseMapLayers:[{id:"streets-dark-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/bc599b6d741a4ac084b7eea7bf8c5938/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Streets Night (for 3D)"},{id:"streets-dark-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"streets-dark-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"dark-gray-3d":{id:"dark-gray-3d",itemId:"a8b7322a5fe94002bb0f5e0eeb0c5c18",is3d:!0,baseMapLayers:[{id:"dark-gray-3d-base-layer",styleUrl:"https://www.arcgis.com/sharing/rest/content/items/4178f71acb934fb89f169e7d667c20c6/resources/styles/root.json",layerType:"VectorTileLayer",title:"OpenStreetMap Dark Gray Canvas (for 3D)"},{id:"dark-gray-3d-places-and-labels",title:"Places and Labels",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_LightLabels_v1/SceneServer/layers/0",itemId:"f364b70b012a4da5a4b5921e193eac4a",layerType:"ArcGISSceneServiceLayer"},{id:"dark-gray-3d-buildings",title:"Buildings",url:"https://basemaps3d.arcgis.com/arcgis/rest/services/OpenStreetMap3D_Buildings_v1/SceneServer",itemId:"ca0470dbbddb4db28bad74ed39949e25",layerType:"ArcGISSceneServiceLayer"}]},"arcgis-imagery":{get thumbnailUrl(){return Rt("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return Rt("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return Rt("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return Rt("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return Rt("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return Rt("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return Rt("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return Rt("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return Rt("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return Rt("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]},"arcgis-human-geography":{title:"Human Geography",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Base",title:"Human Geography Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Detail",title:"Human Geography Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeography:Label",title:"Human Geography Label",isReference:!0}]},"arcgis-human-geography-dark":{title:"Human Geography (Dark)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Base",title:"Human Geography Dark Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Detail",title:"Human Geography Dark Detail",isReference:!0},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:HumanGeographyDark:Label",title:"Human Geography Dark Label",isReference:!0}]}},_Ae=new Set(["ar","bs","ca","hr","cs","da","nl","en","et","fi","fr","de","el","he","hu","id","it","ja","ko","lv","lt","nb","pl","ro","ru","sr","es","sv","th","tr","uk","vi"]);let zc=class extends De{constructor(t){super(t),this.id=null,this.language=null,this.places=null,this.serviceUrl="https://basemapstyles-api.arcgis.com/arcgis/rest/services/styles/v2/webmaps",this.worldview=null}getLanguageParamValue(){if(this.language)return this.language;const t=Zs().toLowerCase();switch(t){case"pt-br":return"pt-BR";case"pt-pt":return"pt-PT";case"zh-cn":return"zh-CN";case"zh-hk":return"zh-HK";case"zh-tw":return"zh-TW"}const r=rhe(t);return r==="pt"?"pt-BR":r&&_Ae.has(r)?r:"global"}};l([p()],zc.prototype,"id",void 0),l([p()],zc.prototype,"language",void 0),l([p()],zc.prototype,"places",void 0),l([p()],zc.prototype,"serviceUrl",void 0),l([p()],zc.prototype,"worldview",void 0),zc=l([k("esri.support.BasemapStyle")],zc);const SAe=zc,xAe=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),TAe=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","media","ogc-feature","oriented-imagery","route","stream","subtype-group","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function IAe(e){return e.layerContainerType==="basemap"?xAe:e.layerContainerType==="operational-layers"?TAe:null}function MAe(e,t){if(t.restrictedWebMapWriting){const r=IAe(t);return r==null||r.has(e.type)&&!ST(e)}return!0}function $Ae(e,t){var r;if(t)if(ST(e)){const i=Av("featureCollection.layers",t),n=(r=i==null?void 0:i[0])==null?void 0:r.layerDefinition;n&&P7(e,n)}else e.type!=="group"&&P7(e,t)}function P7(e,t){"maxScale"in e&&(t.maxScale=IS(e.maxScale)??void 0),"minScale"in e&&(t.minScale=IS(e.minScale)??void 0)}function EAe(e,t){if($Ae(e,t),t&&(t.id=e.id,"blendMode"in e&&(t.blendMode=e.blendMode,t.blendMode==="normal"&&delete t.blendMode),t.opacity=IS(e.opacity)??void 0,t.title=e.title||"Layer",t.visibility=e.visible,"legendEnabled"in e&&e.type!=="wmts"))if(ST(e)){const r=t.featureCollection;r&&(r.showLegend=e.legendEnabled)}else t.showLegend=e.legendEnabled}function L7(e,t,r){if(!e.persistenceEnabled)return null;if(!("write"in e)||!e.write)return r!=null&&r.messages&&r.messages.push(new z("layer:unsupported",`Layers (${e.title}, ${e.id}) of type '${e.declaredClass}' cannot be persisted`,{layer:e})),null;if(ST(e)&&!e.isTable)t=e.resourceInfo;else if(MAe(e,r)){const i={};return e.write(i,r)?i:null}return t!=null&&EAe(e,t=B(t)),t}var o1;let AAe=0;const RAe="esri.Basemap";let Vs=o1=class extends Fv(El){constructor(e){super(e),this.id=null,this.portalItem=null,this.spatialReference=null,this.style=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+AAe++,this.baseLayers=new $e,this.referenceLayers=new $e;const t=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type==="elevation"&&oe.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a basemap layer and will therefore be ignored.`)},r=i=>{i.parent=null};this.addHandles([this.baseLayers.on("after-add",i=>t(i.item)),this.referenceLayers.on("after-add",i=>t(i.item)),this.baseLayers.on("after-remove",i=>r(i.item)),this.referenceLayers.on("after-remove",i=>r(i.item))])}initialize(){this.when().catch(e=>{oe.getLogger(this).error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.baseLayers.toArray();for(const r of e)r.destroy();const t=this.referenceLayers.toArray();for(const r of t)r.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),this.portalItem=cr(this.portalItem)}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set baseLayers(e){this._set("baseLayers",pf(e,this._get("baseLayers")))}_writeBaseLayers(e,t,r){const i=[];e&&(r={...r,layerContainerType:"basemap"},this.baseLayers.forEach(n=>{const s=L7(n,r.webmap?r.webmap.getLayerJSONFromResourceInfo(n):null,r);s!=null&&i.push(s)}),this.referenceLayers.forEach(n=>{const s=L7(n,r.webmap?r.webmap.getLayerJSONFromResourceInfo(n):null,r);s!=null&&(n.type!=="scene"&&(s.isReference=!0),i.push(s))})),t.baseMapLayers=i}set referenceLayers(e){this._set("referenceLayers",pf(e,this._get("referenceLayers")))}writeTitle(e,t){t.title=e||"Basemap"}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return CT(this,e=>{e(this.baseLayers,this.referenceLayers)})}clone(){const e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.map(t=>DN(t)?t.clone():t),referenceLayers:this.referenceLayers.map(t=>DN(t)?t.clone():t)};return this.loaded&&(e.loadStatus="loaded"),new o1({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}write(e,t){var r;return e=e||{},t!=null&&t.origin||(t={origin:"web-map",...t}),super.write(e,t),!this.loaded&&((r=this.resourceInfo)!=null&&r.data.baseMapLayers)&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(i=>{const n=B(i);return n.url&&io(n.url)&&(n.url=`https:${n.url}`),n.templateUrl&&io(n.templateUrl)&&(n.templateUrl=`https:${n.templateUrl}`),n})),e}async _loadFromSource(e){const{resourceInfo:t,portalItem:r,style:i}=this;Ut(e);const n=[];if(t){const s=t.context?t.context.url:null;if(n.push(this._loadLayersFromJSON(t.data,s,e)),t.data.id&&!t.data.title){const o=t.data.id;n.push(bAe(o).then(a=>{a&&this.read({title:a},t.context)}))}}else r?n.push(this._loadFromItem(r,e)):i&&n.push(this._loadFromStylesService(i,e));await Promise.all(n)}async _loadLayersFromJSON(e,t,r){var u,c;const i=(u=this.resourceInfo)==null?void 0:u.context,n=((c=this.portalItem)==null?void 0:c.portal)||(i==null?void 0:i.portal)||null,s=OAe[(i==null?void 0:i.origin)||""]??"web-map",{populateOperationalLayers:o}=await ge(async()=>{const{populateOperationalLayers:h}=await import("./layersCreator-rNfBQ72y.js");return{populateOperationalLayers:h}},__vite__mapDeps([23,1,2,14,15,16])),a=[];if(Ut(r),e.baseMapLayers&&Array.isArray(e.baseMapLayers)){const h={context:{...i,origin:s,url:t,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},d=w=>s==="web-scene"&&w.layerType==="ArcGISSceneServiceLayer"||w.isReference,y=o(this.baseLayers,e.baseMapLayers.filter(w=>!d(w)),h);a.push(y);const v=o(this.referenceLayers,e.baseMapLayers.filter(d),h);a.push(v)}await Promise.allSettled(a)}async _loadFromItem(e,t){const r=await e.load(t),i=await r.fetchData("json",t),n=Pt(e.itemUrl??"");return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:CAe[e.type||""]??"web-map",portal:e.portal||ts.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||ts.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,t)}async _loadFromStylesService(e,t){const r=`${e.serviceUrl}/${e.id}`,i=(await be(r,{query:{language:e.getLanguageParamValue(),places:e.places,worldview:e.worldview},signal:t==null?void 0:t.signal})).data,n=Pt(r);return this._set("resourceInfo",{data:i.baseMap??{},context:{origin:"web-map",url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:i.spatialReference},this.resourceInfo.context),this._loadLayersFromJSON(this.resourceInfo.data,n,t)}static fromId(e){const t=AC[e];return t?t.itemId?new o1({portalItem:{id:t.itemId,portal:{url:"https://www.arcgis.com"}}}):o1.fromJSON(t,{origin:t.is3d?"web-scene":"web-map"}):null}};l([p({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(e,t,r,i){this._writeBaseLayers(e,t,i)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:$e}},writer(e,t,r,i){this._writeBaseLayers(e,t,i)}}}}}})],Vs.prototype,"baseLayers",null),l([p({type:String,json:{origins:{"web-scene":{write:!0}}}})],Vs.prototype,"id",void 0),l([p({type:A1})],Vs.prototype,"portalItem",void 0),l([p()],Vs.prototype,"referenceLayers",null),l([p({readOnly:!0})],Vs.prototype,"resourceInfo",void 0),l([p({type:xe})],Vs.prototype,"spatialReference",void 0),l([p({type:SAe})],Vs.prototype,"style",void 0),l([p()],Vs.prototype,"thumbnailUrl",void 0),l([p({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Vs.prototype,"title",void 0),l([se("title")],Vs.prototype,"writeTitle",null),Vs=o1=l([k(RAe)],Vs);const CAe={"Web Scene":"web-scene","Web Map":"web-map","Link Chart":"link-chart"},OAe={"web-scene":"web-scene","web-map":"web-map","link-chart":"link-chart"},W1=Vs,PAe=Object.freeze(Object.defineProperty({__proto__:null,default:W1},Symbol.toStringTag,{value:"Module"}));var RC;let iS=RC=class extends Q{constructor(e){super(e),this.type="none"}clone(){return new RC({type:this.type})}};l([Ce({none:"none",stayAbove:"stay-above"})],iS.prototype,"type",void 0),iS=RC=l([k("esri.ground.NavigationConstraint")],iS);var CC;let Su=CC=class extends Fv(El){constructor(e){super(e),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new $e;const t=i=>{i.parent&&i.parent!==this&&"remove"in i.parent&&i.parent.remove(i),i.parent=this,i.type!=="elevation"&&i.type!=="base-elevation"&&oe.getLogger(this).error(`Layer '${i.title}, id:${i.id}' of type '${i.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)},r=i=>{i.parent=null};this.addHandles([this.layers.on("after-add",i=>t(i.item)),this.layers.on("after-remove",i=>r(i.item))])}initialize(){this.when().catch(e=>{Ei(e)||oe.getLogger(this).error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const e=this.layers.removeAll();for(const t of e)cr(t);this.layers.destroy()}normalizeCtorArgs(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e={...e}).resourceInfo),e}set layers(e){this._set("layers",pf(e,this._get("layers")))}writeLayers(e,t,r,i){const n=[];e&&(i={...i,layerContainerType:"ground"},e.forEach(s=>{if("write"in s){const o={};d_e(s)().write(o,i)&&n.push(o)}else i!=null&&i.messages&&i.messages.push(new z("layer:unsupported",`Layers (${s.title}, ${s.id}) of type '${s.declaredClass}' cannot be persisted in the ground`,{layer:s}))})),t.layers=n}load(e){return this.addResolvingPromise(this._loadFromSource(e)),Promise.resolve(this)}loadAll(){return CT(this,e=>{e(this.layers)})}async queryElevation(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:r}=await ge(()=>import("./ElevationQuery-DRKv2UOr.js"),__vite__mapDeps([134,1,2]));Ut(t);const i=new r,n=this.layers.filter(k7).toArray();return i.queryAll(n,e,t)}async createElevationSampler(e,t){await this.load({signal:t==null?void 0:t.signal});const{ElevationQuery:r}=await ge(()=>import("./ElevationQuery-DRKv2UOr.js"),__vite__mapDeps([134,1,2]));Ut(t);const i=new r,n=this.layers.filter(k7).toArray();return i.createSamplerAll(n,e,t)}clone(){const e={opacity:this.opacity,surfaceColor:B(this.surfaceColor),navigationConstraint:B(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new CC({resourceInfo:this.resourceInfo}).set(e)}read(e,t){this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),super.read(e,t)}_loadFromSource(e){const t=this.resourceInfo;return t?this._loadLayersFromJSON(t.data,t.context,e):Promise.resolve()}async _loadLayersFromJSON(e,t,r){const i=(t==null?void 0:t.origin)||"web-scene",n=(t==null?void 0:t.portal)||null,s=(t==null?void 0:t.url)||null,{populateOperationalLayers:o}=await ge(async()=>{const{populateOperationalLayers:u}=await import("./layersCreator-rNfBQ72y.js");return{populateOperationalLayers:u}},__vite__mapDeps([23,1,2,14,15,16]));Ut(r);const a=[];if(e.layers&&Array.isArray(e.layers)){const u={context:{origin:i,url:s,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};a.push(o(this.layers,e.layers,u))}await Promise.allSettled(a)}};function LAe(e){return e&&"createElevationSampler"in e}function k7(e){return e.type==="elevation"||LAe(e)}l([p({json:{read:!1}})],Su.prototype,"layers",null),l([se("layers")],Su.prototype,"writeLayers",null),l([p({readOnly:!0})],Su.prototype,"resourceInfo",void 0),l([p({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Ke,read:{reader:pv,source:"transparency"},write:{writer:(e,t)=>{t.transparency=lT(e)},target:"transparency"}}})],Su.prototype,"opacity",void 0),l([p({type:ve,json:{type:[Ke],write:(e,t)=>{t.surfaceColor=e.toJSON().slice(0,3)}}})],Su.prototype,"surfaceColor",void 0),l([p({type:iS,json:{write:!0}})],Su.prototype,"navigationConstraint",void 0),Su=CC=l([k("esri.Ground")],Su);const _x=Su;function kAe(e){var t,r;return!(!(e&&typeof e=="object"&&"loaded"in e&&e.loaded&&((r=(t=Hge(e))==null?void 0:t.operations)!=null&&r.supportsEditing)&&"type"in e)||"editingEnabled"in e&&!Jge(e))}const N7=()=>oe.getLogger("esri.support.basemapUtils");function NAe(){return{}}function DAe(e){for(const t in e){const r=e[t];cr(r),delete e[t]}}function FAe(e,t){let r;if(typeof e=="string"){const i=e in AC,n=!i&&e.includes("/");if(!i&&!n){const s=Object.entries(AC).filter(([o,a])=>Kt.apiKey&&!a.classic||!Kt.apiKey&&(a.classic||a.is3d)).map(([o])=>`"${o}"`).sort().join(", ");return N7().warn(`Unable to find basemap definition for: ${e}. Try one of these: ${s}`),null}t&&(r=t[e]),r||(r=i?W1.fromId(e):new W1({style:{id:e}}),t&&(t[e]=r))}else r=Lr(W1,e);return r!=null&&r.destroyed&&(N7().warn("The provided basemap is already destroyed",{basemap:r}),r=null),r}function jAe(e){return new ff({getCollections:()=>[e.tables,e.layers],getChildrenFunction:t=>{const r=[];return"tables"in t&&r.push(t.tables),"layers"in t&&r.push(t.layers),r},itemFilterFunction:t=>{const r=t.parent;return!!r&&"tables"in r&&r.tables.includes(t)}})}function XM(e){for(const t of e.values())t==null||t.destroy();e.clear()}const D7={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function UAe(e){let t=null;if(typeof e=="string")if(e in D7){const r=D7[e];t=new _x({resourceInfo:{data:{layers:[r]}}})}else oe.getLogger("esri.support.groundUtils").warn(`Unable to find ground definition for: ${e}. Try "world-elevation"`);else t=Lr(_x,e);return t}function OC(e,t,r){let i,n;if(e)for(let s=0,o=e.length;s<o;s++){if(i=e.at(s),(i==null?void 0:i[t])===r)return i;if((i==null?void 0:i.type)==="group"&&(n=OC(i.layers,t,r),n))return n}}const VAe=e=>{let t=class extends e{constructor(...r){super(...r),this.layers=new $e;const i=o=>{o.parent&&"remove"in o.parent&&o.parent.remove(o)},n=o=>{o.parent=this,this.layerAdded(o),o.type!=="elevation"&&o.type!=="base-elevation"||oe.getLogger(this).error(`Layer 'title:${o.title}, id:${o.id}' of type '${o.type}' is not supported as an operational layer and will therefore be ignored.`)},s=o=>{o.parent=null,this.layerRemoved(o)};this.addHandles([this.layers.on("before-add",o=>i(o.item)),this.layers.on("after-add",o=>n(o.item)),this.layers.on("after-remove",o=>s(o.item))])}destroy(){const r=this.layers.toArray();for(const i of r)i.destroy();this.layers.destroy()}set layers(r){this._set("layers",pf(r,this._get("layers")))}add(r,i){const n=this.layers;if(i=n.getNextIndex(i),r instanceof Yu){const s=r;s.parent===this?this.reorder(s,i):n.add(s,i)}else Dp(r)?r.then(s=>{this.destroyed||this.add(s,i)}):oe.getLogger(this).error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(r,i){const n=this.layers;let s=n.getNextIndex(i);r.slice().forEach(o=>{o.parent!==this?(n.add(o,s),s+=1):this.reorder(o,s)})}findLayerById(r){return OC(this.layers,"id",r)}findLayerByUid(r){return OC(this.layers,"uid",r)}remove(r){return this.layers.remove(r)}removeMany(r){return this.layers.removeMany(r)}removeAll(){return this.layers.removeAll()}reorder(r,i){return this.layers.reorder(r,i)}layerAdded(r){}layerRemoved(r){}};return l([p()],t.prototype,"layers",null),t=l([k("esri.support.LayersMixin")],t),t};function PC(e,t,r){if(e)for(let i=0,n=e.length;i<n;i++){const s=e.at(i);if(s[t]===r)return s;if((s==null?void 0:s.type)==="group"){const o=PC(s.tables,t,r);if(o)return o}}}const GAe=e=>{let t=class extends e{constructor(...r){super(...r),this.tables=new $e,this.addHandles([this.tables.on("after-add",i=>{const n=i.item;n.parent&&n.parent!==this&&"tables"in n.parent&&n.parent.tables.remove(n),n.parent=this,n.type!=="feature"&&oe.getLogger(this).error(`Layer 'title:${n.title}, id:${n.id}' of type '${n.type}' is not supported as a table and will therefore be ignored.`)}),this.tables.on("after-remove",i=>{i.item.parent=null})])}destroy(){const r=this.tables.toArray();for(const i of r)i.destroy();this.tables.destroy()}set tables(r){this._set("tables",pf(r,this._get("tables")))}findTableById(r){return PC(this.tables,"id",r)}findTableByUid(r){return PC(this.tables,"uid",r)}};return l([p()],t.prototype,"tables",null),t=l([k("esri.support.TablesMixin")],t),t};let va=class extends GAe(VAe(Zu.EventedMixin(De))){constructor(t){super(t),this.allLayers=new ff({getCollections:()=>{var r,i,n;return[(r=this.basemap)==null?void 0:r.baseLayers,(i=this.ground)==null?void 0:i.layers,this.layers,(n=this.basemap)==null?void 0:n.referenceLayers]},getChildrenFunction:r=>"layers"in r?r.layers:null}),this.allTables=jAe(this),this.basemap=null,this.editableLayers=new ff({getCollections:()=>[this.allLayers],itemFilterFunction:kAe}),this.ground=new _x,this._basemapCache=NAe()}destroy(){DAe(this._basemapCache),this._basemapCache=null,this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),this.basemap=cr(this.basemap),cr(this.ground),this._set("ground",null)}castBasemap(t){return FAe(t,this._basemapCache)}castGround(t){return UAe(t)??this._get("ground")}findLayerById(t){return this.allLayers.find(r=>r.id===t)}findTableById(t){return this.allTables.find(r=>r.id===t)}};l([p({readOnly:!0,dependsOn:[]})],va.prototype,"allLayers",void 0),l([p({readOnly:!0})],va.prototype,"allTables",void 0),l([p({type:W1,json:{read:{source:"baseMap"},write:{target:"baseMap"}}})],va.prototype,"basemap",void 0),l([Tt("basemap")],va.prototype,"castBasemap",null),l([p({readOnly:!0})],va.prototype,"editableLayers",void 0),l([p({type:_x,nonNullable:!0})],va.prototype,"ground",void 0),l([Tt("ground")],va.prototype,"castGround",null),l([p()],va.prototype,"undoRedo",void 0),va=l([k("esri.Map")],va);const KP=va;let ud=class extends oE{constructor(t){super(t),this.row=0,this.column=0,this.rows=1,this.columns=1}equals(t){return t!=null&&this.row===t.row&&this.rows===t.rows&&this.column===t.column&&this.columns===t.columns}};l([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"row",void 0),l([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"column",void 0),l([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"rows",void 0),l([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],ud.prototype,"columns",void 0),ud=l([k("esri.CameraLayout")],ud);const QY=ud;let XP=class{constructor(t,r){this.min=t,this.max=r,this.range=r-t}ndiff(t,r=0){return Math.ceil((t-r)/this.range)*this.range+r}_normalize(t,r,i,n=0,s=!1){return(i-=n)<t?i+=this.ndiff(t-i):i>r&&(i-=this.ndiff(i-r)),s&&i===r&&(i=t),i+n}normalize(t,r=0,i=!1){return this._normalize(this.min,this.max,t,r,i)}clamp(t,r=0){return ka(t-r,this.min,this.max)+r}monotonic(t,r,i){return t<r?r:r+this.ndiff(t-r,i)}minimalMonotonic(t,r,i){return this._normalize(t,t+this.range,r,i)}center(t,r,i){return r=this.monotonic(t,r,i),this.normalize((t+r)/2,i)}diff(t,r,i){return this.monotonic(t,r,i)-t}shortestSignedDiff(t,r){t=this.normalize(t);const i=(r=this.normalize(r))-t,n=r<t?this.minimalMonotonic(t,r)-t:r-this.minimalMonotonic(r,t);return Math.abs(i)<Math.abs(n)?i:n}contains(t,r,i){return r=this.minimalMonotonic(t,r),(i=this.minimalMonotonic(t,i))>t&&i<r}};function QP(e){for(const t in e){const r=e[t];r instanceof Function&&(e[t]=r.bind(e))}return e}QP(new XP(0,2*Math.PI));QP(new XP(-Math.PI,Math.PI));const BAe=QP(new XP(0,360));let sl=class extends It(Q){constructor(...t){super(...t),this.position=new Ae([0,0,0]),this.heading=0,this.tilt=0,this.fov=55,this.layout=new QY}normalizeCtorArgs(t,r,i,n){if(t&&typeof t=="object"&&("x"in t||Array.isArray(t))){const s={position:t};return r!=null&&(s.heading=r),i!=null&&(s.tilt=i),n!=null&&(s.fov=n),s}return t}writePosition(t,r,i,n){const s=t.clone();s.x=Ws(t.x||0),s.y=Ws(t.y||0),s.z=t.hasZ?Ws(t.z||0):t.z,r[i]=s.write({},n)}readPosition(t,r){const i=new Ae;return i.read(t,r),i.x=Ws(i.x||0),i.y=Ws(i.y||0),i.z=i.hasZ?Ws(i.z||0):i.z,i}equals(t){return t!=null&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)&&this.layout.equals(t.layout)}};l([p({type:Ae,json:{write:{isRequired:!0}}})],sl.prototype,"position",void 0),l([se("position")],sl.prototype,"writePosition",null),l([te("position")],sl.prototype,"readPosition",null),l([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Tt(e=>BAe.normalize(Ws(e)))],sl.prototype,"heading",void 0),l([p({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),Tt(e=>ka(Ws(e),-180,180))],sl.prototype,"tilt",void 0),l([p({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],sl.prototype,"fov",void 0),l([p({type:QY,nonNullable:!0,json:{read:!1,write:!1}})],sl.prototype,"layout",void 0),sl=l([k("esri.Camera")],sl);const zAe=sl;var LC;let qc=LC=class extends Q{constructor(e){super(e),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(e){return(e%=360)<0&&(e+=360),e}clone(){return new LC({rotation:this.rotation,scale:this.scale,targetGeometry:this.targetGeometry!=null?this.targetGeometry.clone():null,camera:this.camera!=null?this.camera.clone():null})}};function QM(){return{enabled:!this.camera}}l([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:QM}}}}})],qc.prototype,"rotation",void 0),l([Tt("rotation")],qc.prototype,"castRotation",null),l([p({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:QM}}}}})],qc.prototype,"scale",void 0),l([p({types:Vi,json:{read:Xr,write:!0,origins:{"web-scene":{read:Xr,write:{overridePolicy:QM}}}}})],qc.prototype,"targetGeometry",void 0),l([p({type:zAe,json:{write:!0}})],qc.prototype,"camera",void 0),qc=LC=l([k("esri.Viewpoint")],qc);const xl=qc,nS={widthBreakpoint:{getValue(e){const t=e.viewSize[0],r=e.breakpoints,i=this.values;return t<=r.xsmall?i.xsmall:t<=r.small?i.small:t<=r.medium?i.medium:t<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const t=e.viewSize[1],r=e.breakpoints,i=this.values;return t<=r.xsmall?i.xsmall:t<=r.small?i.small:t<=r.medium?i.medium:t<=r.large?i.large:i.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const t=e.viewSize,r=t[0],i=t[1],n=this.values;return i>=r?n.portrait:n.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},e$={xsmall:544,small:768,medium:992,large:1200};function qAe(e){const t=e;return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}function t$(e,t){return t?nS[e].valueToClassName[t].split(" "):[]}const HAe=e=>{let t=class extends e{constructor(...r){super(...r),this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=e$}initialize(){this.addHandles(Ue(()=>[this.breakpoints,this.size],()=>this._updateClassNames(),Xi))}destroy(){this.destroyed||this._removeActiveClassNames()}set breakpoints(r){if(r===this._get("breakpoints"))return;const i=qAe(r);if(!i){const n=JSON.stringify(e$,null,2);console.warn("provided breakpoints are not valid, using defaults:"+n)}r=i?r:e$,this._set("breakpoints",{...r})}_updateClassNames(){if(!this.container)return;const r=Jn.acquire(),i=Jn.acquire();let n,s=!1;for(n in nS){const o=this[n],a=nS[n].getValue({viewSize:this.size,breakpoints:this.breakpoints});o!==a&&(s=!0,this[n]=a,t$(n,o).forEach(u=>i.push(u)),t$(n,a).forEach(u=>r.push(u)))}s&&(this._applyClassNameChanges(r,i),Jn.release(r),Jn.release(i))}_applyClassNameChanges(r,i){const n=this.container;n&&(i.forEach(s=>n.classList.remove(s)),r.forEach(s=>n.classList.add(s)))}_removeActiveClassNames(){const r=this.container;if(!r)return;let i;for(i in nS)t$(i,this[i]).forEach(n=>r.classList.remove(n))}};return l([p()],t.prototype,"breakpoints",null),l([p()],t.prototype,"orientation",void 0),l([p()],t.prototype,"widthBreakpoint",void 0),l([p()],t.prototype,"heightBreakpoint",void 0),t=l([k("esri.views.BreakpointsOwner")],t),t};function eL(e){return typeof e=="string"?document.getElementById(e):e??null}function eK(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function F7(e,t){const r=t.parentNode;r&&r.insertBefore(e,t)}function j7(e,t){for(;;){const r=e.firstChild;if(!r)break;t.appendChild(r)}}let Xd=class extends De{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(t,r,i={}){return this._installWatch(t,r,i,Ue)}addWhen(t,r,i={}){return this._installWatch(t,r,i,hf)}addOnCollectionChange(t,r,{initial:i=!1,final:n=!1}={}){const s=++this._handleId;return this.addHandles([rs(t,"after-changes",this._createSyncUpdatingCallback(),di),rs(t,"change",r,{onListenerAdd:i?o=>r({added:o.toArray(),removed:[]}):void 0,onListenerRemove:n?o=>r({added:[],removed:o.toArray()}):void 0})],s),Xt(()=>this.removeHandles(s))}addPromise(t){if(t==null)return t;const r=++this._handleId;this.addHandles(Xt(()=>{this._pendingPromises.delete(t)&&(this._pendingPromises.size!==0||this.hasHandles(d_)||this._set("updating",!1))}),r),this._pendingPromises.add(t),this._set("updating",!0);const i=()=>this.removeHandles(r);return t.then(i,i),t}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(t,r,i={},n){const s=++this._handleId;i.sync||this._installSyncUpdatingWatch(t,s);const o=n(t,r,i);return this.addHandles(o,s),Xt(()=>this.removeHandles(s))}_installSyncUpdatingWatch(t,r){const i=this._createSyncUpdatingCallback(),n=Ue(t,i,{sync:!0,equals:()=>!1});return this.addHandles(n,r),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(d_),++this._scheduleHandleId;const t=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles(Bm(()=>{t===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(d_))}),d_)}}};l([p({readOnly:!0})],Xd.prototype,"updating",void 0),Xd=l([k("esri.core.support.UpdatingHandles")],Xd);const d_=-42;/*!
 * @esri/arcgis-html-sanitizer - v3.0.1 - Tue Nov 15 2022 09:46:54 GMT-0800 (Pacific Standard Time)
 * Copyright (c) 2022 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2018 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 */var WAe=function(e){if(typeof e!="object"||e===null||Object.prototype.toString.call(e)!=="[object Object]")return!1;var t=Object.getPrototypeOf(e);if(t===null)return!0;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t},Id={exports:{}},Nr={},Sv={exports:{}},If={};function tK(){var e={};return e["align-content"]=!1,e["align-items"]=!1,e["align-self"]=!1,e["alignment-adjust"]=!1,e["alignment-baseline"]=!1,e.all=!1,e["anchor-point"]=!1,e.animation=!1,e["animation-delay"]=!1,e["animation-direction"]=!1,e["animation-duration"]=!1,e["animation-fill-mode"]=!1,e["animation-iteration-count"]=!1,e["animation-name"]=!1,e["animation-play-state"]=!1,e["animation-timing-function"]=!1,e.azimuth=!1,e["backface-visibility"]=!1,e.background=!0,e["background-attachment"]=!0,e["background-clip"]=!0,e["background-color"]=!0,e["background-image"]=!0,e["background-origin"]=!0,e["background-position"]=!0,e["background-repeat"]=!0,e["background-size"]=!0,e["baseline-shift"]=!1,e.binding=!1,e.bleed=!1,e["bookmark-label"]=!1,e["bookmark-level"]=!1,e["bookmark-state"]=!1,e.border=!0,e["border-bottom"]=!0,e["border-bottom-color"]=!0,e["border-bottom-left-radius"]=!0,e["border-bottom-right-radius"]=!0,e["border-bottom-style"]=!0,e["border-bottom-width"]=!0,e["border-collapse"]=!0,e["border-color"]=!0,e["border-image"]=!0,e["border-image-outset"]=!0,e["border-image-repeat"]=!0,e["border-image-slice"]=!0,e["border-image-source"]=!0,e["border-image-width"]=!0,e["border-left"]=!0,e["border-left-color"]=!0,e["border-left-style"]=!0,e["border-left-width"]=!0,e["border-radius"]=!0,e["border-right"]=!0,e["border-right-color"]=!0,e["border-right-style"]=!0,e["border-right-width"]=!0,e["border-spacing"]=!0,e["border-style"]=!0,e["border-top"]=!0,e["border-top-color"]=!0,e["border-top-left-radius"]=!0,e["border-top-right-radius"]=!0,e["border-top-style"]=!0,e["border-top-width"]=!0,e["border-width"]=!0,e.bottom=!1,e["box-decoration-break"]=!0,e["box-shadow"]=!0,e["box-sizing"]=!0,e["box-snap"]=!0,e["box-suppress"]=!0,e["break-after"]=!0,e["break-before"]=!0,e["break-inside"]=!0,e["caption-side"]=!1,e.chains=!1,e.clear=!0,e.clip=!1,e["clip-path"]=!1,e["clip-rule"]=!1,e.color=!0,e["color-interpolation-filters"]=!0,e["column-count"]=!1,e["column-fill"]=!1,e["column-gap"]=!1,e["column-rule"]=!1,e["column-rule-color"]=!1,e["column-rule-style"]=!1,e["column-rule-width"]=!1,e["column-span"]=!1,e["column-width"]=!1,e.columns=!1,e.contain=!1,e.content=!1,e["counter-increment"]=!1,e["counter-reset"]=!1,e["counter-set"]=!1,e.crop=!1,e.cue=!1,e["cue-after"]=!1,e["cue-before"]=!1,e.cursor=!1,e.direction=!1,e.display=!0,e["display-inside"]=!0,e["display-list"]=!0,e["display-outside"]=!0,e["dominant-baseline"]=!1,e.elevation=!1,e["empty-cells"]=!1,e.filter=!1,e.flex=!1,e["flex-basis"]=!1,e["flex-direction"]=!1,e["flex-flow"]=!1,e["flex-grow"]=!1,e["flex-shrink"]=!1,e["flex-wrap"]=!1,e.float=!1,e["float-offset"]=!1,e["flood-color"]=!1,e["flood-opacity"]=!1,e["flow-from"]=!1,e["flow-into"]=!1,e.font=!0,e["font-family"]=!0,e["font-feature-settings"]=!0,e["font-kerning"]=!0,e["font-language-override"]=!0,e["font-size"]=!0,e["font-size-adjust"]=!0,e["font-stretch"]=!0,e["font-style"]=!0,e["font-synthesis"]=!0,e["font-variant"]=!0,e["font-variant-alternates"]=!0,e["font-variant-caps"]=!0,e["font-variant-east-asian"]=!0,e["font-variant-ligatures"]=!0,e["font-variant-numeric"]=!0,e["font-variant-position"]=!0,e["font-weight"]=!0,e.grid=!1,e["grid-area"]=!1,e["grid-auto-columns"]=!1,e["grid-auto-flow"]=!1,e["grid-auto-rows"]=!1,e["grid-column"]=!1,e["grid-column-end"]=!1,e["grid-column-start"]=!1,e["grid-row"]=!1,e["grid-row-end"]=!1,e["grid-row-start"]=!1,e["grid-template"]=!1,e["grid-template-areas"]=!1,e["grid-template-columns"]=!1,e["grid-template-rows"]=!1,e["hanging-punctuation"]=!1,e.height=!0,e.hyphens=!1,e.icon=!1,e["image-orientation"]=!1,e["image-resolution"]=!1,e["ime-mode"]=!1,e["initial-letters"]=!1,e["inline-box-align"]=!1,e["justify-content"]=!1,e["justify-items"]=!1,e["justify-self"]=!1,e.left=!1,e["letter-spacing"]=!0,e["lighting-color"]=!0,e["line-box-contain"]=!1,e["line-break"]=!1,e["line-grid"]=!1,e["line-height"]=!1,e["line-snap"]=!1,e["line-stacking"]=!1,e["line-stacking-ruby"]=!1,e["line-stacking-shift"]=!1,e["line-stacking-strategy"]=!1,e["list-style"]=!0,e["list-style-image"]=!0,e["list-style-position"]=!0,e["list-style-type"]=!0,e.margin=!0,e["margin-bottom"]=!0,e["margin-left"]=!0,e["margin-right"]=!0,e["margin-top"]=!0,e["marker-offset"]=!1,e["marker-side"]=!1,e.marks=!1,e.mask=!1,e["mask-box"]=!1,e["mask-box-outset"]=!1,e["mask-box-repeat"]=!1,e["mask-box-slice"]=!1,e["mask-box-source"]=!1,e["mask-box-width"]=!1,e["mask-clip"]=!1,e["mask-image"]=!1,e["mask-origin"]=!1,e["mask-position"]=!1,e["mask-repeat"]=!1,e["mask-size"]=!1,e["mask-source-type"]=!1,e["mask-type"]=!1,e["max-height"]=!0,e["max-lines"]=!1,e["max-width"]=!0,e["min-height"]=!0,e["min-width"]=!0,e["move-to"]=!1,e["nav-down"]=!1,e["nav-index"]=!1,e["nav-left"]=!1,e["nav-right"]=!1,e["nav-up"]=!1,e["object-fit"]=!1,e["object-position"]=!1,e.opacity=!1,e.order=!1,e.orphans=!1,e.outline=!1,e["outline-color"]=!1,e["outline-offset"]=!1,e["outline-style"]=!1,e["outline-width"]=!1,e.overflow=!1,e["overflow-wrap"]=!1,e["overflow-x"]=!1,e["overflow-y"]=!1,e.padding=!0,e["padding-bottom"]=!0,e["padding-left"]=!0,e["padding-right"]=!0,e["padding-top"]=!0,e.page=!1,e["page-break-after"]=!1,e["page-break-before"]=!1,e["page-break-inside"]=!1,e["page-policy"]=!1,e.pause=!1,e["pause-after"]=!1,e["pause-before"]=!1,e.perspective=!1,e["perspective-origin"]=!1,e.pitch=!1,e["pitch-range"]=!1,e["play-during"]=!1,e.position=!1,e["presentation-level"]=!1,e.quotes=!1,e["region-fragment"]=!1,e.resize=!1,e.rest=!1,e["rest-after"]=!1,e["rest-before"]=!1,e.richness=!1,e.right=!1,e.rotation=!1,e["rotation-point"]=!1,e["ruby-align"]=!1,e["ruby-merge"]=!1,e["ruby-position"]=!1,e["shape-image-threshold"]=!1,e["shape-outside"]=!1,e["shape-margin"]=!1,e.size=!1,e.speak=!1,e["speak-as"]=!1,e["speak-header"]=!1,e["speak-numeral"]=!1,e["speak-punctuation"]=!1,e["speech-rate"]=!1,e.stress=!1,e["string-set"]=!1,e["tab-size"]=!1,e["table-layout"]=!1,e["text-align"]=!0,e["text-align-last"]=!0,e["text-combine-upright"]=!0,e["text-decoration"]=!0,e["text-decoration-color"]=!0,e["text-decoration-line"]=!0,e["text-decoration-skip"]=!0,e["text-decoration-style"]=!0,e["text-emphasis"]=!0,e["text-emphasis-color"]=!0,e["text-emphasis-position"]=!0,e["text-emphasis-style"]=!0,e["text-height"]=!0,e["text-indent"]=!0,e["text-justify"]=!0,e["text-orientation"]=!0,e["text-overflow"]=!0,e["text-shadow"]=!0,e["text-space-collapse"]=!0,e["text-transform"]=!0,e["text-underline-position"]=!0,e["text-wrap"]=!0,e.top=!1,e.transform=!1,e["transform-origin"]=!1,e["transform-style"]=!1,e.transition=!1,e["transition-delay"]=!1,e["transition-duration"]=!1,e["transition-property"]=!1,e["transition-timing-function"]=!1,e["unicode-bidi"]=!1,e["vertical-align"]=!1,e.visibility=!1,e["voice-balance"]=!1,e["voice-duration"]=!1,e["voice-family"]=!1,e["voice-pitch"]=!1,e["voice-range"]=!1,e["voice-rate"]=!1,e["voice-stress"]=!1,e["voice-volume"]=!1,e.volume=!1,e["white-space"]=!1,e.widows=!1,e.width=!0,e["will-change"]=!1,e["word-break"]=!0,e["word-spacing"]=!0,e["word-wrap"]=!0,e["wrap-flow"]=!1,e["wrap-through"]=!1,e["writing-mode"]=!1,e["z-index"]=!1,e}function JAe(e,t,r){}function ZAe(e,t,r){}var YAe=/javascript\s*\:/img;function KAe(e,t){return YAe.test(t)?"":t}If.whiteList=tK();If.getDefaultWhiteList=tK;If.onAttr=JAe;If.onIgnoreAttr=ZAe;If.safeAttrValue=KAe;var XAe={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var i,n;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,n=e.length;i<n;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(e){return String.prototype.trimRight?e.trimRight():e.replace(/(\s*$)/g,"")}},og=XAe;function QAe(e,t){e=og.trimRight(e),e[e.length-1]!==";"&&(e+=";");var r=e.length,i=!1,n=0,s=0,o="";function a(){if(!i){var h=og.trim(e.slice(n,s)),d=h.indexOf(":");if(d!==-1){var y=og.trim(h.slice(0,d)),v=og.trim(h.slice(d+1));if(y){var w=t(n,o.length,y,v,h);w&&(o+=w+"; ")}}}n=s+1}for(;s<r;s++){var u=e[s];if(u==="/"&&e[s+1]==="*"){var c=e.indexOf("*/",s+2);if(c===-1)break;s=c+1,n=s+1,i=!1}else u==="("?i=!0:u===")"?i=!1:u===";"?i||a():u===`
`&&a()}return og.trim(o)}var e5e=QAe,f_=If,t5e=e5e;function U7(e){return e==null}function r5e(e){var t={};for(var r in e)t[r]=e[r];return t}function rK(e){e=r5e(e||{}),e.whiteList=e.whiteList||f_.whiteList,e.onAttr=e.onAttr||f_.onAttr,e.onIgnoreAttr=e.onIgnoreAttr||f_.onIgnoreAttr,e.safeAttrValue=e.safeAttrValue||f_.safeAttrValue,this.options=e}rK.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,i=r.whiteList,n=r.onAttr,s=r.onIgnoreAttr,o=r.safeAttrValue,a=t5e(e,function(u,c,h,d,y){var v=i[h],w=!1;if(v===!0?w=v:typeof v=="function"?w=v(d):v instanceof RegExp&&(w=v.test(d)),w!==!0&&(w=!1),d=o(h,d),!!d){var b={position:c,sourcePosition:u,source:y,isWhite:w};if(w){var _=n(h,d,b);return U7(_)?h+":"+d:_}else{var _=s(h,d,b);if(!U7(_))return _}}});return a};var i5e=rK;(function(e,t){var r=If,i=i5e;function n(o,a){var u=new i(a);return u.process(o)}t=e.exports=n,t.FilterCSS=i;for(var s in r)t[s]=r[s]})(Sv,Sv.exports);var tL={indexOf:function(e,t){var r,i;if(Array.prototype.indexOf)return e.indexOf(t);for(r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return-1},forEach:function(e,t,r){var i,n;if(Array.prototype.forEach)return e.forEach(t,r);for(i=0,n=e.length;i<n;i++)t.call(r,e[i],i,e)},trim:function(e){return String.prototype.trim?e.trim():e.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(e){var t=/\s|\n|\t/,r=t.exec(e);return r?r.index:-1}},n5e=Sv.exports.FilterCSS,s5e=Sv.exports.getDefaultWhiteList,Sx=tL;function iK(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}}var nK=new n5e;function o5e(e,t,r){}function a5e(e,t,r){}function l5e(e,t,r){}function u5e(e,t,r){}function sK(e){return e.replace(p5e,"&lt;").replace(h5e,"&gt;")}function c5e(e,t,r,i){if(r=pK(r),t==="href"||t==="src"){if(r=Sx.trim(r),r==="#")return"#";if(!(r.substr(0,7)==="http://"||r.substr(0,8)==="https://"||r.substr(0,7)==="mailto:"||r.substr(0,4)==="tel:"||r.substr(0,11)==="data:image/"||r.substr(0,6)==="ftp://"||r.substr(0,2)==="./"||r.substr(0,3)==="../"||r[0]==="#"||r[0]==="/"))return""}else if(t==="background"){if(y_.lastIndex=0,y_.test(r))return""}else if(t==="style"){if(V7.lastIndex=0,V7.test(r)||(G7.lastIndex=0,G7.test(r)&&(y_.lastIndex=0,y_.test(r))))return"";i!==!1&&(i=i||nK,r=i.process(r))}return r=hK(r),r}var p5e=/</g,h5e=/>/g,d5e=/"/g,f5e=/&quot;/g,y5e=/&#([a-zA-Z0-9]*);?/gim,m5e=/&colon;?/gim,g5e=/&newline;?/gim,y_=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a):/gi,V7=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,G7=/u\s*r\s*l\s*\(.*/gi;function oK(e){return e.replace(d5e,"&quot;")}function aK(e){return e.replace(f5e,'"')}function lK(e){return e.replace(y5e,function(r,i){return i[0]==="x"||i[0]==="X"?String.fromCharCode(parseInt(i.substr(1),16)):String.fromCharCode(parseInt(i,10))})}function uK(e){return e.replace(m5e,":").replace(g5e," ")}function cK(e){for(var t="",r=0,i=e.length;r<i;r++)t+=e.charCodeAt(r)<32?" ":e.charAt(r);return Sx.trim(t)}function pK(e){return e=aK(e),e=lK(e),e=uK(e),e=cK(e),e}function hK(e){return e=oK(e),e=sK(e),e}function v5e(){return""}function w5e(e,t){typeof t!="function"&&(t=function(){});var r=!Array.isArray(e);function i(o){return r?!0:Sx.indexOf(e,o)!==-1}var n=[],s=!1;return{onIgnoreTag:function(o,a,u){if(i(o))if(u.isClosing){var c="[/removed]",h=u.position+c.length;return n.push([s!==!1?s:u.position,h]),s=!1,c}else return s||(s=u.position),"[removed]";else return t(o,a,u)},remove:function(o){var a="",u=0;return Sx.forEach(n,function(c){a+=o.slice(u,c[0]),u=c[1]}),a+=o.slice(u),a}}}function b5e(e){for(var t="",r=0;r<e.length;){var i=e.indexOf("<!--",r);if(i===-1){t+=e.slice(r);break}t+=e.slice(r,i);var n=e.indexOf("-->",i);if(n===-1)break;r=n+3}return t}function _5e(e){var t=e.split("");return t=t.filter(function(r){var i=r.charCodeAt(0);return i===127?!1:i<=31?i===10||i===13:!0}),t.join("")}Nr.whiteList=iK();Nr.getDefaultWhiteList=iK;Nr.onTag=o5e;Nr.onIgnoreTag=a5e;Nr.onTagAttr=l5e;Nr.onIgnoreTagAttr=u5e;Nr.safeAttrValue=c5e;Nr.escapeHtml=sK;Nr.escapeQuote=oK;Nr.unescapeQuote=aK;Nr.escapeHtmlEntities=lK;Nr.escapeDangerHtml5Entities=uK;Nr.clearNonPrintableCharacter=cK;Nr.friendlyAttrValue=pK;Nr.escapeAttrValue=hK;Nr.onIgnoreTagStripAll=v5e;Nr.StripTagBody=w5e;Nr.stripCommentTag=b5e;Nr.stripBlankChar=_5e;Nr.cssFilter=nK;Nr.getDefaultCSSWhiteList=s5e;var KT={},op=tL;function S5e(e){var t=op.spaceIndex(e),r;return t===-1?r=e.slice(1,-1):r=e.slice(1,t+1),r=op.trim(r).toLowerCase(),r.slice(0,1)==="/"&&(r=r.slice(1)),r.slice(-1)==="/"&&(r=r.slice(0,-1)),r}function x5e(e){return e.slice(0,2)==="</"}function T5e(e,t,r){var i="",n=0,s=!1,o=!1,a=0,u=e.length,c="",h="";e:for(a=0;a<u;a++){var d=e.charAt(a);if(s===!1){if(d==="<"){s=a;continue}}else if(o===!1){if(d==="<"){i+=r(e.slice(n,a)),s=a,n=a;continue}if(d===">"){i+=r(e.slice(n,s)),h=e.slice(s,a+1),c=S5e(h),i+=t(s,i.length,c,h,x5e(h)),n=a+1,s=!1;continue}if(d==='"'||d==="'")for(var y=1,v=e.charAt(a-y);v.trim()===""||v==="=";){if(v==="="){o=d;continue e}v=e.charAt(a-++y)}}else if(d===o){o=!1;continue}}return n<e.length&&(i+=r(e.substr(n))),i}var I5e=/[^a-zA-Z0-9\\_:.-]/gim;function M5e(e,t){var r=0,i=0,n=[],s=!1,o=e.length;function a(y,v){if(y=op.trim(y),y=y.replace(I5e,"").toLowerCase(),!(y.length<1)){var w=t(y,v||"");w&&n.push(w)}}for(var u=0;u<o;u++){var c=e.charAt(u),h,d;if(s===!1&&c==="="){s=e.slice(r,u),r=u+1,i=e.charAt(r)==='"'||e.charAt(r)==="'"?r:E5e(e,u+1);continue}if(s!==!1&&u===i){if(d=e.indexOf(c,u+1),d===-1)break;h=op.trim(e.slice(i+1,d)),a(s,h),s=!1,u=d,r=u+1;continue}if(/\s|\n|\t/.test(c))if(e=e.replace(/\s|\n|\t/g," "),s===!1)if(d=$5e(e,u),d===-1){h=op.trim(e.slice(r,u)),a(h),s=!1,r=u+1;continue}else{u=d-1;continue}else if(d=A5e(e,u-1),d===-1){h=op.trim(e.slice(r,u)),h=B7(h),a(s,h),s=!1,r=u+1;continue}else continue}return r<e.length&&(s===!1?a(e.slice(r)):a(s,B7(op.trim(e.slice(r))))),op.trim(n.join(" "))}function $5e(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="="?t:-1}}function E5e(e,t){for(;t<e.length;t++){var r=e[t];if(r!==" ")return r==="'"||r==='"'?t:-1}}function A5e(e,t){for(;t>0;t--){var r=e[t];if(r!==" ")return r==="="?t:-1}}function R5e(e){return e[0]==='"'&&e[e.length-1]==='"'||e[0]==="'"&&e[e.length-1]==="'"}function B7(e){return R5e(e)?e.substr(1,e.length-2):e}KT.parseTag=T5e;KT.parseAttr=M5e;var C5e=Sv.exports.FilterCSS,wa=Nr,dK=KT,O5e=dK.parseTag,P5e=dK.parseAttr,sS=tL;function m_(e){return e==null}function L5e(e){var t=sS.spaceIndex(e);if(t===-1)return{html:"",closing:e[e.length-2]==="/"};e=sS.trim(e.slice(t+1,-1));var r=e[e.length-1]==="/";return r&&(e=sS.trim(e.slice(0,-1))),{html:e,closing:r}}function k5e(e){var t={};for(var r in e)t[r]=e[r];return t}function N5e(e){var t={};for(var r in e)Array.isArray(e[r])?t[r.toLowerCase()]=e[r].map(function(i){return i.toLowerCase()}):t[r.toLowerCase()]=e[r];return t}function fK(e){e=k5e(e||{}),e.stripIgnoreTag&&(e.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),e.onIgnoreTag=wa.onIgnoreTagStripAll),e.whiteList||e.allowList?e.whiteList=N5e(e.whiteList||e.allowList):e.whiteList=wa.whiteList,e.onTag=e.onTag||wa.onTag,e.onTagAttr=e.onTagAttr||wa.onTagAttr,e.onIgnoreTag=e.onIgnoreTag||wa.onIgnoreTag,e.onIgnoreTagAttr=e.onIgnoreTagAttr||wa.onIgnoreTagAttr,e.safeAttrValue=e.safeAttrValue||wa.safeAttrValue,e.escapeHtml=e.escapeHtml||wa.escapeHtml,this.options=e,e.css===!1?this.cssFilter=!1:(e.css=e.css||{},this.cssFilter=new C5e(e.css))}fK.prototype.process=function(e){if(e=e||"",e=e.toString(),!e)return"";var t=this,r=t.options,i=r.whiteList,n=r.onTag,s=r.onIgnoreTag,o=r.onTagAttr,a=r.onIgnoreTagAttr,u=r.safeAttrValue,c=r.escapeHtml,h=t.cssFilter;r.stripBlankChar&&(e=wa.stripBlankChar(e)),r.allowCommentTag||(e=wa.stripCommentTag(e));var d=!1;r.stripIgnoreTagBody&&(d=wa.StripTagBody(r.stripIgnoreTagBody,s),s=d.onIgnoreTag);var y=O5e(e,function(v,w,b,_,x){var T={sourcePosition:v,position:w,isClosing:x,isWhite:Object.prototype.hasOwnProperty.call(i,b)},I=n(b,_,T);if(!m_(I))return I;if(T.isWhite){if(T.isClosing)return"</"+b+">";var M=L5e(_),$=i[b],A=P5e(M.html,function(R,L){var C=sS.indexOf($,R)!==-1,U=o(b,R,L,C);return m_(U)?C?(L=u(b,R,L,h),L?R+'="'+L+'"':R):(U=a(b,R,L,C),m_(U)?void 0:U):U});return _="<"+b,A&&(_+=" "+A),M.closing&&(_+=" /"),_+=">",_}else return I=s(b,_,T),m_(I)?c(_):I},c);return d&&(y=d.remove(y)),y};var D5e=fK;(function(e,t){var r=Nr,i=KT,n=D5e;function s(a,u){var c=new n(u);return c.process(a)}t=e.exports=s,t.filterXSS=s,t.FilterXSS=n,function(){for(var a in r)t[a]=r[a];for(var u in i)t[u]=i[u]}();function o(){return typeof self<"u"&&typeof DedicatedWorkerGlobalScope<"u"&&self instanceof DedicatedWorkerGlobalScope}o()&&(self.filterXSS=e.exports)})(Id,Id.exports);var F5e=function(){function e(t,r){var i=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(s,o,a,u){return s==="a"&&o==="href"||(s==="img"||s==="source")&&o==="src"?i.sanitizeUrl(a):Id.exports.safeAttrValue(s,o,a,u)}},this._entityMap={"&":"&#x38;","<":"&#x3C;",">":"&#x3E;",'"':"&#x22;","'":"&#x27;","/":"&#x2F;"};var n;t&&!r?n=t:t&&r?(n=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach(function(s){s==="whiteList"?n.whiteList=i._extendObjectOfArrays([i.arcgisWhiteList,t.whiteList||{}]):n[s]=t[s]})):(n=Object.create(this.arcgisFilterOptions),n.whiteList=this.arcgisWhiteList),this.xssFilterOptions=n,this._xssFilter=new Id.exports.FilterXSS(n)}return e.prototype.sanitize=function(t,r){switch(r===void 0&&(r={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,r);default:return r.allowUndefined&&typeof t>"u"?void 0:null}},e.prototype.sanitizeUrl=function(t,r){var i=(r??{}).isProtocolRequired,n=i===void 0?!0:i,s=this._trim(t.substring(0,t.indexOf(":"))),o=t==="/",a=/^#/.test(t),u=s&&this.allowedProtocols.indexOf(s.toLowerCase())>-1;return o||a||u?Id.exports.escapeAttrValue(t):!s&&!n?Id.exports.escapeAttrValue("https://".concat(t)):""},e.prototype.sanitizeHTMLAttribute=function(t,r,i,n){return typeof this.xssFilterOptions.safeAttrValue=="function"?this.xssFilterOptions.safeAttrValue(t,r,i,n):Id.exports.safeAttrValue(t,r,i,n)},e.prototype.validate=function(t,r){r===void 0&&(r={});var i=this.sanitize(t,r);return{isValid:t===i,sanitized:i}},e.prototype.encodeHTML=function(t){var r=this;return String(t).replace(/[&<>"'\/]/g,function(i){return r._entityMap[i]})},e.prototype.encodeAttrValue=function(t){var r=/^[a-zA-Z0-9]$/;return String(t).replace(/[\x00-\xFF]/g,function(i,n){return r.test(i)?i:"&#x".concat(Number(t.charCodeAt(n)).toString(16),";")})},e.prototype._extendObjectOfArrays=function(t){var r={};return t.forEach(function(i){Object.keys(i).forEach(function(n){Array.isArray(i[n])&&Array.isArray(r[n])?r[n]=r[n].concat(i[n]):r[n]=i[n]})}),r},e.prototype._iterateOverObject=function(t,r){var i=this;r===void 0&&(r={});try{var n=!1,s=void 0;if(Array.isArray(t))s=t.reduce(function(a,u){var c=i.validate(u,r);return c.isValid?a.concat([u]):(n=!0,a.concat([c.sanitized]))},[]);else if(WAe(t)){var o=Object.keys(t);s=o.reduce(function(a,u){var c=t[u],h=i.validate(c,r);return h.isValid?a[u]=c:(n=!0,a[u]=h.sanitized),a},{})}else return r.allowUndefined&&typeof t>"u"?void 0:null;return n?s:t}catch{return null}},e.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},e}();const XT=new Map;function yK(){XT.clear()}function j5e(e){return XT.get(e)}function U5e(e,t){XT.set(e,t)}function r$(e){XT.delete(e)}const V5e=()=>oe.getLogger("esri.widgets.support.widgetUtils");function G5e(...e){const t=Jn.acquire();for(let i=0;i<e.length;i++){const n=e[i],s=typeof n;if(s==="string")t.push(n);else if(Array.isArray(n))t.push.apply(t,n);else if(s==="object")for(const o in n)n[o]&&t.push(o)}const r=t.join(" ");return Jn.release(t),r}(()=>{const e=new Map,t=new ResizeObserver(i=>{var n;yK();for(const s of i)(n=e.get(s.target))==null||n(s)}),r=(i,n,s)=>(e.has(i)&&V5e().error("Already observing element",i),e.set(i,n),t.observe(i,s),Xt(()=>{t.unobserve(i),e.delete(i)}));return(i,n,s)=>{let o=null;return Lv([Ue(()=>typeof i=="function"?i():i,a=>{o==null||o.remove(),a&&(o=r(a,n,s))},Ta),Xt(()=>o==null?void 0:o.remove())])}})();function B5e(e){const t=e==null?void 0:e.closest("[dir]");return t!==null&&t instanceof HTMLElement&&t.dir==="rtl"||document.dir==="rtl"}function OUe(e){const t="data-node-ref";this[e.getAttribute(t)]=null}function PUe(e){const t="data-node-ref";this[e.getAttribute(t)]=e}const z5e=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"],q5e=z5e.reduce((e,t)=>(e[t]=[],e),{}),H5e=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","d","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],mK=new F5e({whiteList:q5e,onTagAttr:(e,t,r)=>{const i=`${t}="${r}"`;if(H5e.includes(t))return i},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function W5e(e){return e==="Enter"||e===" "}const gK="http://www.w3.org/",QT=`${gK}2000/svg`,vK=`${gK}1999/xlink`;let z7=[],rL=(e,t)=>{let r={};return Object.keys(e).forEach(i=>{r[i]=e[i]}),t&&Object.keys(t).forEach(i=>{r[i]=t[i]}),r},iL=(e,t)=>e.vnodeSelector===t.vnodeSelector&&(e.properties&&t.properties?e.properties.key===t.properties.key&&e.properties.bind===t.properties.bind:!e.properties&&!t.properties),wK=e=>{if(typeof e!="string")throw new Error("Style values must be strings")},J5e=(e,t,r)=>{if(t.vnodeSelector!==""){for(let i=r;i<e.length;i++)if(iL(e[i],t))return i}return-1},i$=(e,t,r,i)=>{let n=e[t];if(n.vnodeSelector==="")return;let s=n.properties;if(!(s&&(s.key===void 0?s.bind:s.key))){for(let o=0;o<e.length;o++)if(o!==t){let a=e[o];if(iL(a,n))throw new Error(`${r.vnodeSelector} had a ${n.vnodeSelector} child ${i==="added"?i:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)}}},Z5e=e=>{if(e.properties){let t=e.properties.enterAnimation;t&&t(e.domNode,e.properties)}},kC=[],NC=!1,bK=e=>{(e.children||[]).forEach(bK),e.properties&&e.properties.afterRemoved&&e.properties.afterRemoved.apply(e.properties.bind||e.properties,[e.domNode])},q7=()=>{NC=!1,kC.forEach(bK),kC.length=0},H7=e=>{kC.push(e),NC||(NC=!0,typeof window<"u"&&"requestIdleCallback"in window?window.requestIdleCallback(q7,{timeout:16}):setTimeout(q7,16))},W7=e=>{let t=e.domNode;if(e.properties){let r=e.properties.exitAnimation;if(r)return t.style.pointerEvents="none",void r(t,()=>{t.parentNode&&(t.parentNode.removeChild(t),H7(e))},e.properties)}t.parentNode&&(t.parentNode.removeChild(t),H7(e))},Y5e=(e,t,r)=>{if(!t)return;let i=r.eventHandlerInterceptor,n=Object.keys(t),s=n.length;for(let o=0;o<s;o++){let a=n[o],u=t[a];if(a==="className")throw new Error('Property "className" is not supported, use "class".');if(a==="class")FC(e,u,!0);else if(a==="classes"){let c=Object.keys(u),h=c.length;for(let d=0;d<h;d++){let y=c[d];u[y]&&e.classList.add(y)}}else if(a==="styles"){let c=Object.keys(u),h=c.length;for(let d=0;d<h;d++){let y=c[d],v=u[y];v&&(wK(v),r.styleApplyer(e,y,v))}}else if(a!=="key"&&u!=null){let c=typeof u;c==="function"?(a.lastIndexOf("on",0)===0&&(i&&(u=i(a,u,e,t)),a==="oninput"&&function(){let h=u;u=function(d){h.apply(this,[d]),d.target["oninput-value"]=d.target.value}}()),e[a]=u):r.namespace===QT?a==="href"?e.setAttributeNS(vK,a,u):e.setAttribute(a,u):c==="string"&&a!=="value"?a==="innerHTML"?e[a]=mK.sanitize(u):DC(e)&&a in e?e[a]=u:e.setAttribute(a,u):e[a]=u}}};function DC(e){if(!(e instanceof Element&&e.tagName.includes("-")))return!1;const t=window.customElements.get(e.tagName.toLowerCase());return!!t&&e instanceof t}let xx,K5e=(e,t,r)=>{if(t)for(let i of t)Jy(i,e,void 0,r)},_K=(e,t,r)=>{K5e(e,t.children,r),t.text&&(e.textContent=t.text),Y5e(e,t.properties,r),t.properties&&t.properties.afterCreate&&t.properties.afterCreate.apply(t.properties.bind||t.properties,[e,r,t.vnodeSelector,t.properties,t.children])},Jy=(e,t,r,i)=>{let n,s=0,o=e.vnodeSelector,a=t.ownerDocument;if(o==="")n=e.domNode=a.createTextNode(e.text),r!==void 0?t.insertBefore(n,r):t.appendChild(n);else{for(let u=0;u<=o.length;++u){let c=o.charAt(u);if(u===o.length||c==="."||c==="#"){let h=o.charAt(s-1),d=o.slice(s,u);h==="."?n.classList.add(d):h==="#"?n.id=d:(d==="svg"&&(i=rL(i,{namespace:QT})),i.namespace!==void 0?n=e.domNode=a.createElementNS(i.namespace,d):(n=e.domNode=e.domNode||a.createElement(d),d==="input"&&e.properties&&e.properties.type!==void 0&&n.setAttribute("type",e.properties.type)),r!==void 0?t.insertBefore(n,r):n.parentNode!==t&&t.appendChild(n)),s=u+1}}_K(n,e,i)}},FC=(e,t,r)=>{t&&t.split(" ").forEach(i=>{i&&e.classList.toggle(i,r)})},X5e=(e,t,r,i)=>{if(!r)return;let n=!1,s=Object.keys(r),o=s.length;for(let a=0;a<o;a++){let u=s[a],c=r[u],h=t[u];if(u==="class")h!==c&&(FC(e,h,!1),FC(e,c,!0));else if(u==="classes"){let d=e.classList,y=Object.keys(c),v=y.length;for(let w=0;w<v;w++){let b=y[w],_=!!c[b];_!==!!h[b]&&(n=!0,_?d.add(b):d.remove(b))}}else if(u==="styles"){let d=Object.keys(c),y=d.length;for(let v=0;v<y;v++){let w=d[v],b=c[w];b!==h[w]&&(n=!0,b?(wK(b),i.styleApplyer(e,w,b)):i.styleApplyer(e,w,""))}}else if(c||typeof h!="string"||(c=""),u!=="value"||DC(e)){if(c!==h){let d=typeof c;d==="function"&&i.eventHandlerInterceptor||(i.namespace===QT?u==="href"?e.setAttributeNS(vK,u,c):e.setAttribute(u,c):d==="string"?u==="innerHTML"?e[u]=mK.sanitize(c):u==="role"&&c===""?e.removeAttribute(u):DC(e)&&u in e?e[u]=c:e.setAttribute(u,c):e[u]!==c&&(e[u]=c),n=!0)}}else{let d=e[u];d!==c&&(e["oninput-value"]?d===e["oninput-value"]:c!==h)&&(e[u]=c,e["oninput-value"]=void 0),c!==h&&(n=!0)}}return n},Q5e=(e,t,r,i,n)=>{if(r===i)return!1;i=i||z7;let s,o=(r=r||z7).length,a=i.length,u=0,c=0,h=!1;for(;c<a;){let d=u<o?r[u]:void 0,y=i[c];if(d!==void 0&&iL(d,y))h=xx(d,y,n)||h,u++;else{let v=J5e(r,y,u+1);if(v>=0){for(s=u;s<v;s++)W7(r[s]),i$(r,s,e,"removed");h=xx(r[v],y,n)||h,u=v+1}else Jy(y,t,u<o?r[u].domNode:void 0,n),Z5e(y),i$(i,c,e,"added")}c++}if(o>u)for(s=u;s<o;s++)W7(r[s]),i$(r,s,e,"removed");return h};xx=(e,t,r)=>{let i=e.domNode,n=!1;if(e===t)return!1;let s=!1;if(t.vnodeSelector===""){if(t.text!==e.text){let o=i.ownerDocument.createTextNode(t.text);return i.parentNode.replaceChild(o,i),t.domNode=o,n=!0,n}t.domNode=i}else t.vnodeSelector.lastIndexOf("svg",0)===0&&(r=rL(r,{namespace:QT})),e.text!==t.text&&(s=!0,t.text===void 0?i.removeChild(i.firstChild):i.textContent=t.text),t.domNode=i,s=Q5e(t,i,e.children,t.children,r)||s,s=X5e(i,e.properties,t.properties,r)||s,t.properties&&t.properties.afterUpdate&&t.properties.afterUpdate.apply(t.properties.bind||t.properties,[i,r,t.vnodeSelector,t.properties,t.children]);return s&&t.properties&&t.properties.updateAnimation&&t.properties.updateAnimation(i,t.properties,e.properties),n};let ag=(e,t)=>({getLastRender:()=>e,update:r=>{if(e.vnodeSelector!==r.vnodeSelector)throw new Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let i=e;e=r,xx(i,r,t)},domNode:e.domNode});const eRe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{t.charAt(0)==="-"?e.style.setProperty(t,r):e.style[t]=r}};let Cy=e=>rL(eRe,e),vp={create:(e,t)=>(t=Cy(t),Jy(e,document.createElement("div"),void 0,t),ag(e,t)),append:(e,t,r)=>(r=Cy(r),Jy(t,e,void 0,r),ag(t,r)),insertBefore:(e,t,r)=>(r=Cy(r),Jy(t,e.parentNode,e,r),ag(t,r)),merge:(e,t,r)=>(r=Cy(r),t.domNode=e,_K(e,t,r),ag(t,r)),replace:(e,t,r)=>(r=Cy(r),Jy(t,e.parentNode,e,r),e.parentNode.removeChild(e),ag(t,r))},SK,tRe=(e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r};SK=Array.prototype.find?(e,t)=>e.find(t):(e,t)=>e.filter(t)[0];let rRe=(e,t)=>{let r=e;return t.forEach(i=>{r=r&&r.children?SK(r.children,n=>n.domNode===i):void 0}),r},iRe=(e,t,r)=>{let i=function(n){r("domEvent",n);let s=t(),o=tRe(n.currentTarget,s.domNode);o.reverse();let a,u=rRe(s.getLastRender(),o);return e.scheduleRender(),u&&(a=u.properties[`on${n.type}`].apply(u.properties.bind||this,arguments)),r("domEventProcessed",n),a};return(n,s,o,a)=>i},J7=e=>{let t,r,i=Cy(e),n=i.performanceLogger,s=!0,o=!1,a=[],u=[],c=(d,y,v)=>{let w,b=()=>w;i.eventHandlerInterceptor=iRe(t,b,n),w=d(y,v(),i),a.push(w),u.push(v)},h=()=>{if(r=void 0,s){s=!1,n("renderStart",void 0);for(let d=0;d<a.length;d++){let y=u[d]();n("rendered",void 0),a[d].update(y),n("patched",void 0)}n("renderDone",void 0),s=!0}};return t={renderNow:h,scheduleRender:()=>{r||o||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),o=!0},resume:()=>{o=!1,s=!0,t.scheduleRender()},append:(d,y)=>{c(vp.append,d,y)},insertBefore:(d,y)=>{c(vp.insertBefore,d,y)},merge:(d,y)=>{c(vp.merge,d,y)},replace:(d,y)=>{c(vp.replace,d,y)},detach:d=>{for(let y=0;y<u.length;y++)if(u[y]===d)return u.splice(y,1),a.splice(y,1)[0];throw new Error("renderFunction was not found")}},t},Hc=class extends De{constructor(){super(...arguments),this.items=new $e,this._watchUpdatingTracking=new Xd,this._callbacks=new Map,this._projector=J7(),this._hiddenProjector=J7()}get needsRender(){return this.items.length>0}get updating(){var t;return((t=this._watchUpdatingTracking)==null?void 0:t.updating)??!1}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(()=>this.items,r=>{for(const i of r.added){const n=()=>i.render();this._callbacks.set(i,n),this._projector.append(this.surface,n)}for(const i of r.removed){const n=this._projector.detach(this._callbacks.get(i));this.surface.removeChild(n.domNode),this._callbacks.delete(i)}})}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach(t=>this._projector.detach(t)),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const r=this._hiddenSurface,i=this._hiddenProjector;let n;const s=()=>(n=t.render(),n);i.append(r,s),i.renderNow();const o={left:0,top:0,right:0,bottom:0};if(n!=null&&n.domNode){const a=n.domNode.getBoundingClientRect();o.left=a.left,o.top=a.top,o.right=a.right,o.bottom=a.bottom}for(i.detach(s);r.firstChild;)r.removeChild(r.firstChild);return o}overlaps(t,r){const i=this.computeBoundingRect(t),n=this.computeBoundingRect(r);return Math.max(i.left,n.left)<=Math.min(i.right,n.right)&&Math.max(i.top,n.top)<=Math.min(i.bottom,n.bottom)}get hasVisibleItems(){return this.items.some(t=>t.visible)}async prepare(){await document.fonts.load(this._fontString()).catch(()=>{})}renderCanvas(t,r){const i=!!(r!=null&&r.disableDecorations);if(!this.items.some(s=>s.visible&&!(i&&s.isDecoration)))return;const n=t.getContext("2d");n.save(),n.font=this._fontString(),this.items.forEach(s=>{i&&s.isDecoration||(n.save(),s.renderCanvas(n),n.restore())}),n.restore()}_fontString(){return`10px ${getComputedStyle(this.surface).fontFamily}`}};l([p({readOnly:!0})],Hc.prototype,"surface",void 0),l([p({readOnly:!0})],Hc.prototype,"items",void 0),l([p({readOnly:!0})],Hc.prototype,"needsRender",null),l([p({readOnly:!0})],Hc.prototype,"_watchUpdatingTracking",void 0),l([p({readOnly:!0})],Hc.prototype,"updating",null),Hc=l([k("esri.views.overlay.ViewOverlay")],Hc);const Z7=Hc,n$=[0,0];function nRe(e){const t=(e.ownerDocument||window.document).defaultView,r=e.getBoundingClientRect();return n$[0]=r.left+((t==null?void 0:t.pageXOffset)??0),n$[1]=r.top+((t==null?void 0:t.pageYOffset)??0),n$}function Y7(e){e&&(eK(e),e.parentNode&&e.parentNode.removeChild(e))}function sRe(e){const t=document.createElement("div");return e.appendChild(t),t}const lg=16,g_=750,oRe=512,aRe=2,lRe=e=>{let t=class extends e{constructor(...r){super(...r),this._freqInfo={freq:lg,time:g_},this._overlayRenderTaskHandle=null,this.height=0,this.messagesCommon=null,this.overlay=null,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.addHandles([Ue(()=>this.cursor,i=>{const{surface:n}=this;n&&n.setAttribute("data-cursor",i)}),Ue(()=>this.navigating,i=>{const{surface:n}=this;n&&n.setAttribute("data-navigating",i.toString())})])}initialize(){const r=Me("mac"),i=async()=>{r&&(await gT(()=>this.ready),this.messagesCommon=await o4("esri/t9n/common").catch(()=>{}))};i(),this.addHandles([Ue(()=>this.ui,(n,s)=>this._handleUIChange(n,s),Xi),this.on("focus",()=>this.notifyChange("focused")),this.on("blur",()=>this.notifyChange("focused")),JO(i),Ue(()=>[this.surface,this.messagesCommon],()=>{var n,s,o;r&&((o=this.surface)==null||o.setAttribute("aria-label",((s=(n=this.messagesCommon)==null?void 0:n.ariaLabels)==null?void 0:s.navigationMacVoiceOver)??""))})])}destroy(){this.destroyed||(this.ui=cr(this.ui),this.container=null)}get container(){return this._get("container")??null}set container(r){const i=this._get("container"),n=eL(r);if(n||typeof r!="string"||oe.getLogger(this).error("#container",`element with id '${r}' not found`),i===n)return;if(this._stopMeasuring(),i&&(i.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay&&(this.overlay.destroy(),this._set("overlay",null)),this.root&&(Y7(this.root),this._set("root",null)),this.userContent&&(j7(this.userContent,i),Y7(this.userContent),this._set("userContent",null))),!n)return this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),void this._set("container",null);n.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",j7(n,s),n.appendChild(s),this._set("userContent",s);const o=document.createElement("div");o.className="esri-view-root",n.insertBefore(o,n.firstChild),this._set("root",o);const a=document.createElement("div");a.className="esri-view-surface",a.setAttribute("role","application"),a.tabIndex=0,o.appendChild(a),this._set("surface",a);const u=new Z7;o.appendChild(u.surface),this._set("overlay",u),this.addHandles(Ue(()=>u.needsRender,c=>{c&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=ym({render:()=>{var h;return(h=this.overlay)==null?void 0:h.render()}}):this._overlayRenderTaskHandle=Tr(this._overlayRenderTaskHandle)})),this.forceDOMReadyCycle(),this._set("container",n),this._startMeasuring()}get focused(){const r=document.activeElement===this.surface;return document.hasFocus()&&r}get size(){return[this.width,this.height]}blur(){var r;(r=this.surface)==null||r.blur()}focus(){var r;(r=this.surface)==null||r.focus()}pageToContainer(r,i,n){const s=this.position;return r-=s?s[0]:0,i-=s?s[1]:0,n?(n[0]=r,n[1]=i):n=[r,i],n}containerToPage(r,i,n){const s=this.position;return r+=s?s[0]:0,i+=s?s[1]:0,n?(n[0]=r,n[1]=i):n=[r,i],n}_handleUIChange(r,i){this.removeHandles("ui"),i&&i!==r&&i.destroy(),r&&(r.view=this,this.addHandles(Ue(()=>this.root,n=>{r.container=n?sRe(n):null},Xi),"ui")),this._set("ui",r)}_stopMeasuring(){this.removeHandles("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const r=this._freqInfo;r.freq=lg,r.time=g_,this.addHandles([Dv(window,"resize",()=>{r.freq=lg,r.time=g_}),ym({prepare:i=>{const n=this._measure(),s=this._freqInfo;if(s.time+=i.deltaTime,n&&(s.freq=lg,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const o=this._position();s.freq=o||n?lg:Math.min(g_,s.freq*aRe),!n&&s.freq>=oRe&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const r=this.container,i=r?r.clientWidth:0,n=r?r.clientHeight:0;if(i===0||n===0)return this.suspended||this._set("suspended",!0),!1;const s=this.width,o=this.height;return i===s&&n===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",i),this._set("height",n),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:o,width:i,height:n}),!0)}_position(){const r=this.container,i=this.position,n=r&&nRe(r);return!!n&&(!i||n[0]!==i[0]||n[1]!==i[1])&&(this._set("position",[n[0],n[1]]),!0)}forceDOMReadyCycle(){}};return l([p()],t.prototype,"container",null),l([p({readOnly:!0})],t.prototype,"focused",null),l([p({readOnly:!0})],t.prototype,"height",void 0),l([p()],t.prototype,"messagesCommon",void 0),l([p({type:Z7})],t.prototype,"overlay",void 0),l([p({readOnly:!0})],t.prototype,"position",void 0),l([p({readOnly:!0})],t.prototype,"resizing",void 0),l([p({readOnly:!0})],t.prototype,"root",void 0),l([p({value:null,readOnly:!0})],t.prototype,"size",null),l([p({readOnly:!0})],t.prototype,"surface",void 0),l([p({readOnly:!0})],t.prototype,"suspended",void 0),l([p()],t.prototype,"ui",void 0),l([p({readOnly:!0})],t.prototype,"userContent",void 0),l([p({readOnly:!0})],t.prototype,"width",void 0),l([p()],t.prototype,"widthBreakpoint",void 0),t=l([k("esri.views.DOMContainer")],t),t};let uRe=class{constructor(t,r){this._owner=r,this._properties={},this._afterDispatchHandle=null;for(const i in t){const n=t[i],s=new DV(n,void 0,void 0,2,2);this._properties[i]={pool:s,acquired:[]}}this._afterDispatchHandle=fle(()=>this._release())}destroy(){this._afterDispatchHandle&&(this._afterDispatchHandle.remove(),this._afterDispatchHandle=null);for(const t in this._properties){const r=this._properties[t];for(const i of r.acquired)lD(i)||r.pool.release(i);r.pool.destroy(),r.pool=null,r.acquired=null}this._properties=null,this._owner=null}get(t){const r=this._owner._get(t),i=this._properties[t];let n=i.pool.acquire();for(i.acquired.push(n);n===r;)i.acquired.push(n),n=i.pool.acquire();return n}_release(){for(const t in this._properties){const r=this._properties[t];let i=0;for(const n of r.acquired)lD(n)?r.acquired[i++]=n:r.pool.release(n);r.acquired.length=i}}};const cRe=Me("mac")?"Meta":"Ctrl",pRe=new Set(["Alt","Ctrl","Meta","Shift","Primary"]),hRe=e=>pRe.has(e);let dRe=class{constructor(t,r=[]){this.eventType=t,this.keyModifiers=r}matches(t){if(t.type!==this.eventType)return!1;if(this.keyModifiers.length===0)return!0;const r=t.modifiers;for(const i of this.keyModifiers)if(!r.has(i))return!1;return!0}};const K7=()=>oe.getLogger("esri.views.input.InputHandler");let Ai=class{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const r=this._incoming[t];for(const i of r)this._incomingEventMatches.push(i.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map(t=>t.eventType)),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?K7().error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback(r=>this._handleEvent(r)),t.setUninstallCallback(()=>this._onUninstall()),this._manager=t)}onUninstall(){}registerIncoming(t,r,i){let n;typeof r=="function"?(i=r,n=[]):n=r||[];const s=typeof t=="string"?new dRe(t,n):t,o=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},a=h=>{const d=this._incoming[h.match.eventType];if(d){const y=d.indexOf(h);d.splice(y,1),o(),this._manager&&this._manager.updateDependencies()}},u=new fRe(s,i,{onPause:a,onRemove:a,onResume:h=>{const d=this._incoming[h.match.eventType];d&&!d.includes(h)&&(d.push(h),o(),this._manager&&this._manager.updateDependencies())}});let c=this._incoming[s.eventType];return c||(c=[],this._incoming[s.eventType]=c),c.push(u),o(),this._manager&&this._manager.updateDependencies(),u}registerOutgoing(t){if(this._outgoing[t])throw new Error("There is already a callback registered for this outgoing InputEvent: "+t);const r=new yRe(t,{onEmit:(i,n,s,o)=>{var a;(a=this._manager)==null||a.emit(i.eventType,n,s,o)},onRemove:i=>{var n;delete this._outgoing[i.eventType],(n=this._manager)==null||n.updateDependencies()}});return this._outgoing[t]=r,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),r}startCapturingPointer(t){var r;(r=this._manager)==null||r.setPointerCapture(t,!0)}stopCapturingPointer(t){var r;(r=this._manager)==null||r.setPointerCapture(t,!1)}refreshHasPendingInputs(){var t;(t=this._manager)==null||t.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):K7().error("This InputHandler is not registered with an InputManager")}_handleEvent(t){var i;const r=this._incoming[t.type];if(r){for(const n of r)if(n.match.matches(t)&&((i=n.callback)==null||i.call(n,t),t.shouldStopPropagation()))break}}},fRe=class{constructor(t,r,i){this.match=t,this._callback=r,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}},yRe=class{constructor(t,r){this.eventType=t,this._removed=!1,this._handler=r}emit(t,r,i){this._removed||this._handler.onEmit(this,t,r,i)}remove(){this._removed=!0,this._handler.onRemove(this)}},mRe=class extends Ai{constructor(t){super(!0),this._onChange=t,this._value="mouse",this._x=null,this._y=null,this.registerIncoming("pointer-move",r=>{this._update(r.data)})}_update(t){const r=t.native.pointerType==="touch"?"touch":"mouse",{x:i,y:n}=t;r===this._value&&this._x===i&&this._y===n||(this._value=r,this._x=i,this._y=n,this._onChange(r,i,n))}},gRe=class{constructor(t,r){this._observable=new Vv,this._value=t,this._equalityFunction=r}get value(){return Ge(this._observable),this._value}set value(t){this._equalityFunction(t,this._value)||(this._value=t,this._observable.notify())}mutate(t){t(this._value),this._observable.notify()}};function xK(e,t=iV){return new gRe(e,t)}let vRe=class extends Ai{get multiTouchActive(){return this._multiTouchActive.value}constructor(){super(!0),this._activeTouchPointerIds=new Set,this._multiTouchActive=xK(!1),this._onPointerAdd=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.add(t.native.pointerId),this._update())},this._onPointerRemove=({data:t})=>{t.pointerType==="touch"&&(this._activeTouchPointerIds.delete(t.native.pointerId),this._update())},this.registerIncoming("pointer-down",this._onPointerAdd),this.registerIncoming("pointer-up",this._onPointerRemove),this.registerIncoming("pointer-capture-lost",this._onPointerRemove),this.registerIncoming("pointer-cancel",this._onPointerRemove)}_update(){this._multiTouchActive.value=this._activeTouchPointerIds.size>1}},Eo=class extends De{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._handlersPriority=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=cRe,this._latestPointerType="mouse",this._propertiesPool=new uRe({latestPointerLocation:_Re},this),this.latestPointerLocation=null,this._paused=!1,this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const r of t)this.uninstallHandlers(r);this.eventSource.destroy(),this._currentPropagation=null,this._propertiesPool.destroy()}get hasPendingInputs(){return this._handlers.some(t=>t.handler.hasPendingInputs)}get latestPointerType(){return this._latestPointerType}get multiTouchActive(){return this._multiTouchHandler.multiTouchActive}get updating(){return this.hasPendingInputs||this._paused}installHandlers(t,r,i=Sp.INTERNAL){if(this._nameToGroup[t])return void oe.getLogger(this).error("There is already an InputHandler group registered under the name `"+t+"`");if(r.length===0)return void oe.getLogger(this).error("Can't register a group of zero handlers");const n={name:t,handlers:r.map(s=>({handler:s,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null}))};this._nameToGroup[t]=n;for(let s=n.handlers.length-1;s>=0;s--){const o=n.handlers[s];this._handlers.push(o),o.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(a,u,c,h,d)=>{this._emitInputEvent(o.priorityIndex+1,a,u,c,d,h)},setPointerCapture:(a,u)=>{this._setPointerCapture(n,o,a,u)},setEventCallback:a=>{o.eventCallback=a},setUninstallCallback:a=>{o.uninstallCallback=a},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const r=this._nameToGroup[t];r?(r.handlers.forEach(i=>{var n;i.removed=!0,(n=i.uninstallCallback)==null||n.call(i)}),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):oe.getLogger(this).error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return this._nameToGroup[t]!==void 0}isModifierKeyDown(t){return this._activeKeyModifiers&&this._activeKeyModifiers.has(t)}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,r=new Set;this._handlersPriority=[];for(let i=this._handlers.length-1;i>=0;i--){const n=this._handlers[i];n.priorityIndex=i,this._handlersPriority.push(n)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const n=this._handlersPriority[i];n.priorityIndex=i;let s=n.handler.hasSideEffects;if(!s){for(const o of n.handler.outgoingEventTypes)if(t.has(o)){s=!0;break}}if(s)for(const o of n.handler.incomingEventMatches){t.add(o.eventType);for(const a of o.keyModifiers)hRe(a)||r.add(a)}n.active=s}this._sourceEvents=t,this._keyModifiers=r,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointer(t,r,i){this._latestPointerType=t;const n=this._get("latestPointerLocation");if(n==null||n.x!==r||n.y!==i){const s=this._propertiesPool.get("latestPointerLocation");s.x=r,s.y=i,this._set("latestPointerLocation",s)}}_onEventReceived(t,r){if(t==="pointer-capture-lost"){const s=r;this._pointerCaptures.delete(s.native.pointerId)}this._updateKeyModifiers(t,r);const i=this.test.timestamp!=null?this.test.timestamp:r.native?r.native.timestamp:void 0,n=r.native?r.native.cancelable:void 0;this._emitInputEventFromSource(t,r,i,n)}_updateKeyModifiers(t,r){if(!r)return;let i=!1;const n=()=>{if(!i){const a=new Set;this._activeKeyModifiers.forEach(u=>{a.add(u)}),this._activeKeyModifiers=a,i=!0}},s=(a,u)=>{u&&!this._activeKeyModifiers.has(a)?(n(),this._activeKeyModifiers.add(a)):!u&&this._activeKeyModifiers.has(a)&&(n(),this._activeKeyModifiers.delete(a))};if(t==="key-down"||t==="key-up"){const a=r.key;this._keyModifiers.has(a)&&s(a,t==="key-down")}const o=r.native;s("Alt",!(!o||!o.altKey)),s("Ctrl",!(!o||!o.ctrlKey)),s("Shift",!(!o||!o.shiftKey)),s("Meta",!(!o||!o.metaKey)),s("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerHandler=new mRe((t,r,i)=>this._setLatestPointer(t,r,i)),this._multiTouchHandler=new vRe,this.installHandlers("input-manager-logic",[this._latestPointerHandler,this._multiTouchHandler],Sp.ALWAYS),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Sp.INTERNAL)}_setPointerCapture(t,r,i,n){const s=t.name+"-"+r.priorityIndex,o=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,o),n?(o.add(s),o.size===1&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):o.has(s)&&(o.delete(s),o.size===0&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter(t=>!t.removed),this.updateDependencies()}_emitInputEventFromSource(t,r,i,n){this._emitInputEvent(0,t,r,i,n)}_emitInputEvent(t,r,i,n,s,o){const a=n!==void 0?n:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),u=s!==void 0&&s,c={event:new wRe(r,i,a,o||this._activeKeyModifiers,u),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(c):this._doNewPropagation(c)}_doNewPropagation(t){this._currentPropagation={events:new vx,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){var r,i,n;this._paused=!1;const t=this._currentPropagation;if(t){for(;t.events.length>0;){const{event:s,priorityIndex:o}=t.events.pop(),a=(r=s.data)==null?void 0:r.eventId;if(!(a!=null&&this._stoppedPropagationEventIds.has(a)))for(t.currentHandler=this._handlersPriority[o];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!s.shouldStopPropagation()&&((n=(i=t.currentHandler).eventCallback)==null||n.call(i,s)),s.shouldStopPropagation()){a!=null&&this._stoppedPropagationEventIds.add(a);break}if(s.shouldPausePropagation(()=>this._continuePropagation()))return void this._pausePropagation({event:s,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const r=new vx;r.push(t);const i=this._currentPropagation;if(i){for(;i.events.length;)r.push(i.events.pop());i.events=r,i.currentHandler=null,this._paused=!0}}_compareHandlerPriority(t,r){if(t.handler.hasSideEffects!==r.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==r.groupPriority)return t.groupPriority>r.groupPriority?-1:1;for(const i of t.handler.incomingEventMatches)for(const n of r.handler.incomingEventMatches){if(i.eventType!==n.eventType)continue;const s=i.keyModifiers.filter(o=>n.keyModifiers.includes(o));if(s.length===i.keyModifiers.length!=(s.length===n.keyModifiers.length))return i.keyModifiers.length>n.keyModifiers.length?-1:1}return t.priorityIndex>r.priorityIndex?-1:1}_sortHandlersPriority(t){const r=[];for(const i of t){let n=0;for(;n<r.length&&this._compareHandlerPriority(i,r[n])>=0;)n++;r.splice(n,0,i)}return r}get debug(){const t=r=>{const i=this._setPointerCapture;this._setPointerCapture=()=>{},r(),this._setPointerCapture=i};return{injectEvent:(r,i)=>{t(()=>{this._onEventReceived(r,i)})},disablePointerCapture:t}}};l([p({readOnly:!0})],Eo.prototype,"hasPendingInputs",null),l([p({constructOnly:!0})],Eo.prototype,"eventSource",void 0),l([p({constructOnly:!0})],Eo.prototype,"recognizers",void 0),l([p()],Eo.prototype,"_latestPointerType",void 0),l([p()],Eo.prototype,"latestPointerType",null),l([p()],Eo.prototype,"multiTouchActive",null),l([p({readOnly:!0})],Eo.prototype,"latestPointerLocation",void 0),l([p()],Eo.prototype,"_paused",void 0),l([p({readOnly:!0})],Eo.prototype,"updating",null),Eo=l([k("esri.views.input.InputManager")],Eo);let wRe=class{constructor(t,r,i,n,s){this.type=t,this.data=r,this.timestamp=i,this.modifiers=n,this.cancelable=s,this._propagationState=ap.NONE,this._resumeCallback=null}stopPropagation(){this._propagationState|=ap.STOPPED}shouldStopPropagation(){return(this._propagationState&ap.STOPPED)!=0}async(t){this._propagationState|=ap.PAUSED;const r=(i,n)=>{this._propagationState&=~ap.PAUSED;const s=this._resumeCallback;if(this._resumeCallback=null,s&&s(),n)throw i;return i};return(typeof t=="function"?t():t).then(i=>r(i,!1),i=>r(i,!0))}shouldPausePropagation(t){return!!(this._propagationState&ap.PAUSED)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}};var ap;(function(e){e[e.NONE=0]="NONE",e[e.STOPPED=1]="STOPPED",e[e.PAUSED=2]="PAUSED"})(ap||(ap={}));const Sp={ALWAYS:1,DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};let bRe=class{};const _Re=bRe;function qa(e){return e!=null&&"open"in e&&"declaredClass"in e}function X7(e){return e!=null&&"declaredClass"in e&&"dockOptions"in e}const SRe=e=>{let t=class extends e{constructor(){super(...arguments),this._popupSetupTask=null,this.popup={},this.popupEnabled=!0}initialize(){this.addHandles([Ue(()=>[this.ui,this.popup],([r,i],n)=>{const s="popup",o="manual";if(n){const[a,u]=n;a&&qa(u)&&(u.view=null,X7(u)&&a.remove(u,s))}r&&qa(i)&&(i.view=this,X7(i)&&r.add(i,{key:s,position:o,internal:!0}))},Xi),this.on("click",r=>{this.popup&&this.popupEnabled&&(r.pointerType!=="mouse"||r.button===0)&&(!qa(this.popup)&&"autoOpenEnabled"in this.popup&&this.popup.autoOpenEnabled===!1||(qa(this.popup)?this.popup.viewModel.handleViewClick(r):r.async(async()=>{await this.setupPopup(),qa(this.popup)&&!this.destroyed&&this.ready&&this.popupEnabled&&this.popup.viewModel.handleViewClick(r)})))},Sp.WIDGET)]),gT(()=>this.ready&&this.popupEnabled&&!this.updating).then(()=>{ge(()=>import("./Popup-3dHL6NAG.js"),__vite__mapDeps([135,1,2,4,61]))})}destroy(){this.destroyed||this.closePopup()}async openPopup(r){if(qa(this.popup))return this.popup.open(r);try{if(await this.setupPopup(),!this.popup)return void oe.getLogger(this).error(new z("view:null-popup","Popup is null and can't be opened"));this.popup.open(r)}catch{}}closePopup(){var r;(r=this._popupSetupTask)==null||r.abort(),qa(this.popup)&&this.popup.close()}async fetchPopupFeatures(r,i){return await this.when(),this._popupHitsToFeatures(await this._getPopupHits(r,i),i)}async setupPopup(){var r;if((r=this._popupSetupTask)==null||r.abort(),this.popup&&!qa(this.popup))return this._popupSetupTask=mT(async i=>{const{default:n}=await ge(()=>import("./Popup-3dHL6NAG.js"),__vite__mapDeps([135,1,2,4,61]));if(Ut(i),!this.popup||qa(this.popup))return;const s=this.popup;delete s.open,delete s.close,this.popup=new n(s)}),this._popupSetupTask.promise}async _popupHitsToFeatures({location:r,hits:i},n){const s=[],o=[];let a=!1;const u=Wae(n,Me("popup-view-fetch-timeout")??TRe),c=y=>{const v=new xRe(y);return o.push(v),s.push(v.promise),v},h=y=>{const v=o.at(-1);return v&&v.layerView===y&&!a?v:c(y)};for(const y of i)"graphic"in y?(h(y.layerView).graphics.push(y.graphic),a=!1):(s.push(y.layerView.fetchPopupFeaturesAtLocation(y.mapPoint,u)),a=!0);o.map(y=>y.resolve(u));const d=Hae(s).then(y=>y.filter(v=>!!v).flat());return{pendingFeatures:s,allGraphicsPromise:d,location:r}}async _getPopupHits(r,i){const{hits:n,location:s}=await this.popupHitTest(r);Ut(i);const o=[];for(const a of n)if("graphic"in a){if(this._isValidPopupGraphic(a.graphic,i)){const u=this._isValidPopupGraphicsLayerView(a.layerView)?a.layerView:void 0;o.push({graphic:a.graphic,layerView:u})}}else this._isValidPopupLocationLayerView(a.layerView)&&o.push({mapPoint:a.mapPoint,layerView:a.layerView});return{hits:o,location:s}}_isValidPopupGraphic(r,i){return r&&!!r.getEffectivePopupTemplate(i!=null&&i.defaultPopupTemplateEnabled)}_isValidPopupGraphicsLayerView(r){return!r||(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesFromGraphics"in r}_isValidPopupLocationLayerView(r){return(!("layer"in r)||!r.suspended)&&"fetchPopupFeaturesAtLocation"in r}};return l([p({cast(r){return!r||qa(r)||typeof r=="object"&&(r.open=i=>(fm(oe.getLogger(this),"view.popup is no longer created by default. view.popup.open() will stop working when the popup isn't created",{replacement:"Use view.openPopup() instead.",version:"4.27"}),this.openPopup(i)),r.close=()=>(fm(oe.getLogger(this),"view.popup is no longer created by default. view.popup.close() will stop working when the popup isn't created",{replacement:"Use view.closePopup() instead.",version:"4.27"}),this.closePopup())),r}})],t.prototype,"popup",void 0),l([p()],t.prototype,"popupEnabled",void 0),t=l([k("esri.views.PopupView")],t),t};let xRe=class{constructor(t){this.layerView=t,this._resolver=ro(),this.graphics=[]}get promise(){return this._resolver.promise}resolve(t){const{layerView:r,graphics:i,_resolver:n}=this;if(!r)return n.resolve(i),n.promise;let s;return r.fetchPopupFeaturesFromGraphics(i,t).catch(o=>(s=o,null)).then(o=>{o?n.resolve(o):n.reject(s)}),n.promise}};const TRe=5e3;let J1=class extends $e{constructor(t){super(t),this.addHandles([this.on("before-add",r=>{r.item==null&&r.preventDefault()}),this.on("after-add",r=>this._own(r.item)),this.on("after-remove",r=>this._release(r.item))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new($e.ofType(this.itemType.Type))(t):new $e(t)}};function Q7(e,t){return{type:e,cast:bq,set(r){const i=pf(r,this._get(t),e);i.owner=this,this._set(t,i)}}}l([p()],J1.prototype,"owner",null),J1=l([k("esri.core.support.OwningCollection")],J1);let Tx=class extends J1{constructor(t){super(t),this.addHandles(this.on("before-add",r=>{r.item!=null&&r.item.parent===this.owner&&(oe.getLogger(this).warn("Analysis inside the collection must be unique. Not adding this element again."),r.preventDefault())}))}_own(t){t.parent=this.owner}_release(t){t.parent=null}};Tx=l([k("esri.support.AnalysesCollection")],Tx);let Z1=class extends J1{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};l([HO({Type:Da,ensureType:Lr(Da)})],Z1.prototype,"itemType",void 0),Z1=l([k("esri.support.GraphicsCollection")],Z1);let Wc=class extends De{constructor(t){super(t),this.view=null,this.baseLayerViews=new $e,this.referenceLayerViews=new $e,this._loadingHandle=Ue(()=>{var r,i;return(i=(r=this.view)==null?void 0:r.map)==null?void 0:i.basemap},r=>{r&&r.load().catch(()=>{})},Xi)}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);for(const t of this.baseLayerViews)t.destroy();this.baseLayerViews.length=0;for(const t of this.referenceLayerViews)t.destroy();this.referenceLayerViews.length=0}get suspended(){return!this.view||this.view.suspended}get updating(){var r,i;if(this.view&&this.view.suspended)return!1;const t=(i=(r=this.view)==null?void 0:r.map)==null?void 0:i.basemap;return!!t&&!!t.loaded&&(this.baseLayerViews.some(n=>n.updating)||this.referenceLayerViews.some(n=>n.updating))}};l([p({constructOnly:!0})],Wc.prototype,"view",void 0),l([p({readOnly:!0})],Wc.prototype,"baseLayerViews",void 0),l([p({readOnly:!0})],Wc.prototype,"referenceLayerViews",void 0),l([p({readOnly:!0})],Wc.prototype,"suspended",null),l([p({type:Boolean,readOnly:!0})],Wc.prototype,"updating",null),Wc=l([k("esri.views.BasemapView")],Wc);function IRe(e){return"tryRecycleWith"in e}let MRe=class{constructor(t,r,i){this.layer=t,this.view=r,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=ro(),this._started=!1,this.done=!1,this.promise=this._deferred.promise,bs(this._controller.signal,()=>{const n=new z("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(n)})}tryRecycle(t){if(!this.done||!this.layerView||!IRe(this.layerView))return null;const r=this.layer.type,i=this._controller.signal;for(let n=0;n<t.length;n++){const s=t[n];if(s.type!==r)continue;const o=this.layerView.tryRecycleWith(s,{signal:i});if(o){t.splice(n,1),this.layer=s;const a=this.layerView,u=a.view;return this.promise=Promise.race([o.then(()=>(Ut(this._controller.signal),s.emit("layerview-destroy",{view:u,layerView:a}),u.emit("layerview-destroy",{view:u,layerView:a}),s.emit("layerview-create",{view:u,layerView:a}),u.emit("layerview-create",{view:u,layerView:a}),a)),new Promise((c,h)=>bs(this._controller.signal,()=>h(Pr())))]),this.promise}}return null}destroy(){this._controller.abort();const{layerView:t}=this;if(t){const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:r,layerView:t})}this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null,this._map=null}async start(){var n,s;if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:r,view:i}=this;this._map=i.map;try{let o,a;if(await r.load({signal:t}),r.prefetchResources&&await r.prefetchResources({signal:t}),ERe(r))o=await r.createLayerView(i,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(r))throw new z("layer:view-not-supported","No layerview implementation was found");const h=await this.layerViewImporter.importLayerView(r);Ut(t),o="default"in h?new h.default({layer:r,view:i}):new h({layer:r,view:i})}const u=()=>{a=Tr(a),o.destroyed||o.destroy(),o.layer=null,o.parent=null,o.view=null,this.done=!0};a=bs(t,u),Ut(t);try{await o.when()}catch(h){throw u(),h}if(!((s=(n=this._map)==null?void 0:n.allLayers)==null?void 0:s.includes(r)))return u(),void this._deferred.reject(new z("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=o,r.emit("layerview-create",{view:i,layerView:o}),i.emit("layerview-create",{layer:r,layerView:o}),this.done=!0,this._deferred.resolve(o)}catch(o){r.emit("layerview-create-error",{view:i,error:o}),i.emit("layerview-create-error",{layer:r,error:o}),this.done=!0,this._deferred.reject(new z("layerview:create-error","layerview creation failed",{layer:r,error:o}))}}},Ao=class extends De{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._recyclingInfoMap=new Map,this._watchUpdatingTracking=new Xd,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var i;const r=(i=this.view.map)==null?void 0:i.allLayers;if(r)for(const n of r)this.layerViewImporter.hasLayerViewModule(n)&&this.layerViewImporter.importLayerView(n)},this._reschedule=()=>this.destroyed?Promise.reject():(this._workPromise==null&&(this._workPromise=ro(),this._workPromise.promise.catch(()=>{})),this.removeHandles("reschedule"),this.addHandles(Bm(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var u,c,h;if(this.destroyed)return;const r=this.view.map;if(this._map!==r&&(this.clear(),this._map=r),this._workPromise==null)return void this.notifyChange("updating");this.removeHandles("reschedule"),this.removeHandles("collection-change");const i=new Set,n=[],s=this.view.ready,o=d=>{if(d!=null){for(const y of d)if(y){i.add(y);const v=this._layerLayerViewInfoMap.get(y);v&&s?v.start():v||this._recyclingInfoMap.has(y)||n.push(y),"layers"in y&&y.layers&&o(y.layers)}}};for(const d of this._rootCollectionNames)o(Ra(this,d));for(const[d,y]of this._layerLayerViewInfoMap)if(!i.has(d)){this._layerLayerViewInfoMap.delete(y.layer);const v=y.tryRecycle(n);v?(this.notifyChange("updating"),this._recyclingInfoMap.set(y.layer,y),v.then(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(y.layer),this._layerLayerViewInfoMap.set(y.layer,y),this._reschedule()}).catch(()=>{this.notifyChange("updating"),this._recyclingInfoMap.delete(y.layer),y.destroy(),this._reschedule()})):y.destroy()}for(const[d,y]of this._recyclingInfoMap)i.has(d)||(this.notifyChange("updating"),this._recyclingInfoMap.delete(y.layer),y.destroy());for(const d of n)this._createLayerView(d);this._refreshCollections();const a=[(u=r==null?void 0:r.ground)==null?void 0:u.layers,(c=r==null?void 0:r.basemap)==null?void 0:c.baseLayers,(h=r==null?void 0:r.basemap)==null?void 0:h.referenceLayers,r==null?void 0:r.layers].filter(d=>!!d);i.forEach(d=>"layers"in d&&a.push(d.layers)),this.addHandles(a.map(d=>this._watchUpdatingTracking.addOnCollectionChange(()=>d,this._reschedule)),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.addHandles([rs(()=>{var t,r;return(r=(t=this.view)==null?void 0:t.map)==null?void 0:r.allLayers},"change",this._preloadLayerViewModules,{onListenerAdd:this._preloadLayerViewModules}),Ue(()=>{const t=this.view,r=t==null?void 0:t.map;return[r==null?void 0:r.basemap,r==null?void 0:r.ground,r==null?void 0:r.layers,t==null?void 0:t.ready]},()=>this._reschedule(),Ta)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),XM(this._recyclingInfoMap),XM(this._layerLayerViewInfoMap),this._watchUpdatingTracking.destroy(),this._map=null,this._workPromise!=null&&(this._workPromise.reject(Pr()),this._workPromise=null)}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return this._workPromise!=null||this._watchUpdatingTracking.updating||Dx(this._layerLayerViewInfoMap,t=>!t.done)||this._recyclingInfoMap.size>0}get updatingRemaining(){let t=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++t;return t}clear(){this.destroyed||(XM(this._layerLayerViewInfoMap),this._refreshCollections())}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t)){if(this._recyclingInfoMap.has(t))return this._recyclingInfoMap.get(t).promise;throw new z("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t})}return this._layerLayerViewInfoMap.get(t).promise}_refreshCollections(){for(const[t,r]of this._layersToLayerViews)this._populateLayerViewsOwners(Ra(this,t),Ra(this,r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,r,i){if(!t||!r)return void(r&&r.removeAll());let n=0;for(const s of t){const o=this._layerLayerViewInfoMap.get(s);if(!(o!=null&&o.layerView))continue;const a=o.layerView;a.layer=s,a.parent=i,r.at(n)!==a&&r.splice(n,0,a),s.layers&&this._populateLayerViewsOwners(s.layers,a.layerViews,a),n+=1}n<r.length&&r.splice(n,r.length)}_createLayerView(t){t.load().catch(()=>{}),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const r=new MRe(t,this.view,this.layerViewImporter);r.promise.then(()=>this._refreshCollections(),i=>{i&&(Ei(i)||i.name==="cancelled:layerview-create")||oe.getLogger(this).error(`Failed to create layerview for layer title:'${t.title??"no title"}', id:'${t.id??"no id"}' of type '${t.type}'.`,{layer:t,error:i}),this._refreshCollections()}),this._layerLayerViewInfoMap.set(t,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};l([p()],Ao.prototype,"_workPromise",void 0),l([p({readOnly:!0})],Ao.prototype,"_watchUpdatingTracking",void 0),l([p({readOnly:!0})],Ao.prototype,"_layersToLayerViews",null),l([p({readOnly:!0})],Ao.prototype,"_rootCollectionNames",null),l([p()],Ao.prototype,"layerViewImporter",void 0),l([p()],Ao.prototype,"supportsGround",void 0),l([p({readOnly:!0})],Ao.prototype,"updating",null),l([p({readOnly:!0})],Ao.prototype,"updatingRemaining",null),l([p({constructOnly:!0})],Ao.prototype,"view",void 0),Ao=l([k("esri.views.LayerViewManager")],Ao);const $Re=Ao;function ERe(e){return"createLayerView"in e&&e.createLayerView!=null}let Gs=class extends De{constructor(t){super(t),this.factor=1.5,this.offset=Yn(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};l([p({type:Number})],Gs.prototype,"factor",void 0),l([p({nonNullable:!0})],Gs.prototype,"offset",void 0),l([p()],Gs.prototype,"position",void 0),l([p({type:Number,range:{min:0}})],Gs.prototype,"size",void 0),l([p()],Gs.prototype,"maskUrl",void 0),l([p()],Gs.prototype,"maskEnabled",void 0),l([p()],Gs.prototype,"overlayUrl",void 0),l([p()],Gs.prototype,"overlayEnabled",void 0),l([p({readOnly:!0})],Gs.prototype,"version",null),l([p({type:Boolean})],Gs.prototype,"visible",void 0),Gs=l([k("esri.views.Magnifier")],Gs);const TK=Gs;let oS=class{constructor(t){this._observable=new Vv,this._map=new Map(t)}get size(){return Ge(this._observable),this._map.size}clear(){this._map.size>0&&(this._map.clear(),this._observable.notify())}delete(t){const r=this._map.delete(t);return r&&this._observable.notify(),r}entries(){return Ge(this._observable),this._map.entries()}forEach(t,r){Ge(this._observable),this._map.forEach((i,n)=>t.call(r,i,n,this),r)}get(t){return Ge(this._observable),this._map.get(t)}has(t){return Ge(this._observable),this._map.has(t)}keys(){return Ge(this._observable),this._map.keys()}set(t,r){return this._map.set(t,r),this._observable.notify(),this}values(){return Ge(this._observable),this._map.values()}[Symbol.iterator](){return Ge(this._observable),this._map[Symbol.iterator]()}get[Symbol.toStringTag](){return this._map[Symbol.toStringTag]}},xu=class extends Zu.EventedAccessor{constructor(t){super(t),this._selectionMap=new oS,this._trashCan=[],this._layerEditHandles=new $e,this._vizTaskId=0,this.showHighlight=!0}initialize(){this.addHandles([Ue(()=>[this.view,this.showHighlight],()=>this._refreshVisualization()),rs(()=>this.sources,"change",r=>{const i=this._selectionMap;for(const n of r.removed)i.delete(n);this._refreshListeners(),this._refreshVisualization()},{onListenerAdd:()=>this._refreshListeners()})]);const t=new $e;this.view.when().then(()=>{this.view.map.allLayers.flatten(r=>"sublayers"in r&&r.sublayers?r.sublayers:null).forEach(r=>{(v_(r)&&!zge(r)||qf(r))&&t.add(r)}),this._set("sources",t)})}destroy(){this._layerEditHandles.drain(Tr)}get selections(){return Array.from(this._selectionMap.entries()).map(t=>{const[r,i]=t;return{layer:r,selection:[...i.selection]}})}get count(){let t=0;for(const r of this._selectionMap.values())t+=r.selection.length;return t}get hasSelection(){return this.count>0}get sources(){return this._get("sources")}set sources(t){this._set("sources",t)}async getSelectedFeatures(t,r={},i="layerView"){const{view:n,selections:s}=this,o=(t!==void 0?s.filter(a=>t.includes(a.layer)):s).filter(a=>a.selection.length>0).map(async a=>{const{layer:u,selection:c}=a,h=qf(u)?u.parent:u;if(h==null||!eU(h))return null;if(i==="layer")return tU(h,c,r);const d=await n.whenLayerView(h);return tU(d,c,r)});return(await Promise.all(o)).filter(a=>a!==null)}updateSelection(t){const r=new Map;for(const[s,o]of this._selectionMap)r.set(s,[...o.selection]);let i=!1;const n=t.current.concat(t.added);for(const s of n){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(v_(o)||qf(o))&&a!==null){const u=Ov(r,o,()=>[]);u.includes(a)||(u.push(a),i=!0)}}for(const s of t.removed){const o=s.sourceLayer,a=s.getObjectId();if(this.sources.includes(o)&&(v_(o)||qf(o))&&a!==null){const u=r.get(o),c=u==null?void 0:u.indexOf(a);c!==void 0&&c>=0&&(u==null||u.splice(c,1),i=!0)}}if(i){const{_selectionMap:s,_trashCan:o}=this,a=[];for(const[u,c]of r){const h=s.get(u);h!==void 0&&o.push(h),s.set(u,{selection:c}),a.push({layer:u,selection:c,...FN(h!==void 0?h.selection:[],c)})}this._onSelectionChange(a)}}setSelection(t,r){this._setSelection(t,r)}getSelection(t){const r=this._selectionMap.get(t);return r==null?void 0:r.selection}appendToSelection(t,r){const i=this._selectionMap.get(t),n=i!==void 0?[...i.selection]:[];for(const s of r)n.includes(s)||n.push(s);this._setSelection(t,n)}removeFromSelection(t,r){const i=this._selectionMap.get(t);if(!i)return;const n=[];for(const s of i.selection)r.includes(s)||n.push(s);this._setSelection(t,n)}toggleInSelection(t,r){const i=this._selectionMap.get(t);if(!i||i.selection.length===0)return void this._setSelection(t,r);const n=new Set(i.selection),s=new Set(r),o=ole(n,s);this._setSelection(t,Array.from(o))}clear(){const t=this._selectionMap.values();this._trashCan.push(...t);const r=[];for(const[i,n]of this._selectionMap.entries())r.push({layer:i,added:[],removed:[...n.selection],selection:[]});this._selectionMap.clear(),this._onSelectionChange(r)}_onSelectionChange(t){this._refreshVisualization(),this.emit("selection-change",{view:this.view,changes:t})}_refreshVisualization(){var o;if(this.view==null||this.sources==null)return;for(this._vizTaskId++;this._trashCan.length>0;){const a=this._trashCan.pop();(o=a==null?void 0:a.highlightHandle)==null||o.remove()}const{sources:t,view:r,_selectionMap:i,showHighlight:n}=this,s=this._vizTaskId;for(const a of t){const u=i.get(a),c=qf(a)?a.parent:a;c!=null&&eU(c)&&r.whenLayerView(c).then(h=>{var d;(d=u==null?void 0:u.highlightHandle)==null||d.remove(),u!==void 0&&n&&s===this._vizTaskId&&"highlight"in h&&typeof h.highlight=="function"&&u.selection.length>0&&(u.highlightHandle=h.highlight(u.selection,"selection"))})}}_refreshListeners(){this._layerEditHandles.drain(Tr);for(const t of this.sources){const r=qf(t)?t.parent:t;if(r!=null&&v_(r)){const i=r.on("edits",n=>{this._handleEditChanges(n,t)});this._layerEditHandles.push(i)}}}_handleEditChanges(t,r){if(t.deletedFeatures!==void 0&&t.deletedFeatures.length>0&&this._selectionMap.has(r)){const i=t.deletedFeatures.filter(n=>n.error==null).map(n=>n.objectId).filter(Qn);this.removeFromSelection(r,i)}}_setSelection(t,r){if(!this.sources.includes(t))throw new Error(`Cannot set selection on layer ${t.title} because it is not in 'sources'`);const i=this._selectionMap.get(t);if(i===void 0||!RRe(i,{selection:r})){i!==void 0&&this._trashCan.push(i),this._selectionMap.set(t,{selection:[...r]});const n={layer:t,selection:[...r],...FN(i!==void 0?i.selection:[],r)};this._onSelectionChange([n])}}};l([p({readOnly:!0,nonNullable:!0})],xu.prototype,"selections",null),l([p({readOnly:!0,nonNullable:!0})],xu.prototype,"count",null),l([p({constructOnly:!0,nonNullable:!0})],xu.prototype,"view",void 0),l([p({readOnly:!0,nonNullable:!0})],xu.prototype,"hasSelection",null),l([p()],xu.prototype,"showHighlight",void 0),l([p()],xu.prototype,"sources",null),xu=l([k("esri.views.SelectionManager")],xu);const v_=e=>e.createQuery!==void 0&&e.on!==void 0,ARe=e=>e.layer!==void 0,eU=e=>(e==null?void 0:e.when)!==void 0,RRe=(e,t)=>{if(e==null&&t==null)return!0;if(e!=null&&t==null||e==null&&t!=null)return!1;if(e!=null&&t!=null&&e.selection!=null&&t.selection!=null){const r=[...e.selection],i=[...t.selection];if(r.length!==i.length)return!1;r.sort(),i.sort();for(let n=0;n<r.length;n++)if(r[n]!==i[n])return!1}return!0},tU=async(e,t,r={})=>{let i;if(ARe(e)){const n=e;i=n===void 0?null:await n.queryFeatures(new $i({...r,objectIds:t})).then(s=>({data:s,layer:e.layer}))}else{const n=e;i=n===void 0?null:await n.queryFeatures(new $i({...r,objectIds:t})).then(s=>({data:s,layer:n}))}return i},CRe=xu;let a1=class extends It(De){constructor(t){super(t),this.accentColor=new ve([255,127,0]),this.textColor=new ve([255,255,255])}};l([p({type:ve,nonNullable:!0})],a1.prototype,"accentColor",void 0),l([p({type:ve,nonNullable:!0})],a1.prototype,"textColor",void 0),a1=l([k("esri.views.Theme")],a1);const jC=a1;var rU;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right"})(rU||(rU={}));const IK=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],MK={};function $K(e){return!!MK[e]}function ORe(e){for(const t of e)if(!$K(t))return!1;return!0}IK.forEach(e=>{MK[e]=!0});let PRe=class{constructor(t){this._handlers=new Map,this._counter=0,this._handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this._handlers.forEach(({handler:r,priority:i},n)=>{var s;return(s=this.inputManager)==null?void 0:s.installHandlers(n,[r],i)})}disconnect(){this.inputManager&&this._handlers.forEach((t,r)=>{var i;return(i=this.inputManager)==null?void 0:i.uninstallHandlers(r)}),this.inputManager=null}destroy(){this.disconnect(),this._handlers.clear(),this.view=null}on(t,r,i,n){const s=Array.isArray(t)?t:t.split(",");if(!ORe(s))return s.some($K)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let o,a;Array.isArray(r)?a=r:(o=r,a=[]),typeof i=="function"?o=i:n=i,n=n??Sp.DEFAULT;const u=this._createUniqueGroupName(),c=new LRe(this.view,s,a,o);this._handlers.set(u,{handler:c,priority:n});for(const h of s){const d=this._handlerCounts.get(h)||0;this._handlerCounts.set(h,d+1)}return this.inputManager&&this.inputManager.installHandlers(u,[c],n),Xt(()=>this._removeHandler(u,s))}hasHandler(t){return!!this._handlerCounts.get(t)}_removeHandler(t,r){if(this._handlers.has(t)){this._handlers.delete(t);for(const i of r){const n=this._handlerCounts.get(i);n===void 0?console.error("Trying to remove handler for event that has no handlers registered: ",i):n===1?this._handlerCounts.delete(i):this._handlerCounts.set(i,n-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}_createUniqueGroupName(){return this._counter+=1,`viewEvents_${this._counter}`}},LRe=class extends Ai{constructor(t,r,i,n){super(!0),this._latestDragStart=void 0,this.view=t;for(const s of r)switch(s){case"click":this.registerIncoming("click",i,o=>n(this._wrapClick(o)));break;case"double-click":this.registerIncoming("double-click",i,o=>n(this._wrapDoubleClick(o)));break;case"immediate-click":this.registerIncoming("immediate-click",i,o=>n(this._wrapImmediateClick(o)));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,o=>n(this._wrapImmediateDoubleClick(o)));break;case"hold":this.registerIncoming("hold",i,o=>n(this._wrapHold(o)));break;case"drag":this.registerIncoming("drag",i,o=>{const a=this._wrapDrag(o);a&&n(a)});break;case"key-down":this.registerIncoming("key-down",i,o=>n(this._wrapKeyDown(o)));break;case"key-up":this.registerIncoming("key-up",i,o=>n(this._wrapKeyUp(o)));break;case"pointer-down":this.registerIncoming("pointer-down",i,o=>n(this._wrapPointer(o,"pointer-down")));break;case"pointer-move":this.registerIncoming("pointer-move",i,o=>n(this._wrapPointer(o,"pointer-move")));break;case"pointer-up":this.registerIncoming("pointer-up",i,o=>n(this._wrapPointer(o,"pointer-up")));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,o=>n(this._wrapPointerDrag(o)));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,o=>n(this._wrapMouseWheel(o)));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,o=>n(this._wrapPointer(o,"pointer-enter")));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,o=>n(this._wrapPointer(o,"pointer-leave")));break;case"gamepad":this.registerIncoming("gamepad",i,o=>{n(this._wrapGamepad(o))});break;case"focus":this.registerIncoming("focus",i,o=>{n(this._wrapFocus(o))});break;case"blur":this.registerIncoming("blur",i,o=>{n(this._wrapBlur(o))})}}_wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:r=>t.async(r),preventDefault:()=>t.preventDefault()}}_wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:r=>t.async(r),preventDefault:()=>t.preventDefault()}}_wrapClick(t){const{pointerType:r,button:i,buttons:n,x:s,y:o,native:a,eventId:u}=t.data,{cancelable:c,timestamp:h}=t;return{type:"click",pointerType:r,button:i,buttons:n,x:s,y:o,native:a,timestamp:h,screenPoint:Yn(s,o),mapPoint:this._getMapPoint(s,o),eventId:u,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:d=>t.async(d),preventDefault:()=>t.preventDefault()}}_wrapDoubleClick(t){const{pointerType:r,button:i,buttons:n,x:s,y:o,native:a,eventId:u}=t.data,{cancelable:c,timestamp:h}=t;return{type:"double-click",pointerType:r,button:i,buttons:n,x:s,y:o,native:a,timestamp:h,mapPoint:this._getMapPoint(s,o),eventId:u,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:d=>t.async(d),preventDefault:()=>t.preventDefault()}}_wrapImmediateClick(t){const{pointerType:r,button:i,buttons:n,x:s,y:o,native:a,eventId:u}=t.data,c=a.pointerId,{cancelable:h,timestamp:d}=t;return{type:"immediate-click",pointerId:c,pointerType:r,button:i,buttons:n,x:s,y:o,native:a,timestamp:d,mapPoint:this._getMapPoint(s,o),eventId:u,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:y=>t.async(y),preventDefault:()=>t.preventDefault()}}_wrapImmediateDoubleClick(t){const{pointerType:r,button:i,buttons:n,x:s,y:o,native:a,eventId:u}=t.data,c=a.pointerId,{cancelable:h,timestamp:d}=t;return{type:"immediate-double-click",pointerId:c,pointerType:r,button:i,buttons:n,x:s,y:o,native:a,timestamp:d,mapPoint:this._getMapPoint(s,o),eventId:u,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:y=>t.async(y),preventDefault:()=>t.preventDefault()}}_wrapHold(t){const{pointerType:r,button:i,buttons:n,x:s,y:o,native:a}=t.data,{cancelable:u,timestamp:c}=t;return{type:"hold",pointerType:r,button:i,buttons:n,x:s,y:o,native:a,timestamp:c,mapPoint:this._getMapPoint(s,o),cancelable:u,stopPropagation:()=>t.stopPropagation(),async:h=>t.async(h),preventDefault:()=>t.preventDefault()}}_getMapPoint(t,r){return this.view.toMap(Yn(t,r),{exclude:[]})}_wrapDrag(t){const r=t.data,{x:i,y:n}=r.center,{action:s,pointerType:o,button:a}=r;if(s==="start"&&(this._latestDragStart=r),!this._latestDragStart)return;const u=r.pointer.native,c=r.buttons,{cancelable:h,timestamp:d}=t,y={x:this._latestDragStart.center.x,y:this._latestDragStart.center.y};return s==="end"&&(this._latestDragStart=void 0),{type:"drag",action:s,x:i,y:n,origin:y,pointerType:o,button:a,buttons:c,radius:r.radius,angle:oB(r.angle),native:u,timestamp:d,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:v=>t.async(v),preventDefault:()=>t.preventDefault()}}_wrapKeyDown(t){const{key:r,repeat:i,native:n}=t.data,{cancelable:s,timestamp:o}=t;return{type:"key-down",key:r,repeat:i,native:n,timestamp:o,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:a=>t.async(a),preventDefault:()=>t.preventDefault()}}_wrapKeyUp(t){const{key:r,native:i}=t.data,{cancelable:n,timestamp:s}=t;return{type:"key-up",key:r,native:i,timestamp:s,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:o=>t.async(o),preventDefault:()=>t.preventDefault()}}_wrapPointer(t,r){const{x:i,y:n,button:s,buttons:o,native:a,eventId:u}=t.data,c=a.pointerId,h=a.pointerType,{cancelable:d,timestamp:y}=t;return{type:r,x:i,y:n,pointerId:c,pointerType:h,button:s,buttons:o,native:a,timestamp:y,eventId:u,cancelable:d,stopPropagation:()=>t.stopPropagation(),async:v=>t.async(v),preventDefault:()=>t.preventDefault()}}_wrapPointerDrag(t){const{x:r,y:i,buttons:n,native:s,eventId:o}=t.data.currentEvent,{button:a}=t.data.startEvent,u=t.data.startEvent.native.pointerId,c=t.data.startEvent.native.pointerType,h=t.data.action,d={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:y,timestamp:v}=t;return{type:"pointer-drag",x:r,y:i,pointerId:u,pointerType:c,button:a,buttons:n,action:h,origin:d,native:s,timestamp:v,eventId:o,cancelable:y,stopPropagation:()=>t.stopPropagation(),async:w=>t.async(w),preventDefault:()=>t.preventDefault()}}_wrapMouseWheel(t){const{cancelable:r,data:i,timestamp:n}=t,{x:s,y:o,deltaY:a,native:u}=i;return{type:"mouse-wheel",x:s,y:o,deltaY:a,native:u,timestamp:n,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:c=>t.async(c),preventDefault:()=>t.preventDefault()}}_wrapGamepad(t){const{action:r,state:i,device:n}=t.data,{cancelable:s,timestamp:o}=t,{buttons:a,axes:u}=i;return{type:"gamepad",device:n,timestamp:o,action:r,buttons:a,axes:u,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:c=>t.async(c),preventDefault:()=>t.preventDefault()}}};var xv,iU,nU;(function(e){e[e.USER=0]="USER",e[e.MANAGER=1]="MANAGER"})(xv||(xv={})),function(e){e[e.None=0]="None",e[e.Unfocused=1]="Unfocused",e[e.Focused=2]="Focused",e[e.Unselected=4]="Unselected",e[e.Selected=8]="Selected",e[e.All=15]="All"}(iU||(iU={})),function(e){e[e.None=0]="None",e[e.Custom1=16]="Custom1",e[e.Custom2=32]="Custom2",e[e.Custom3=64]="Custom3",e[e.Custom4=128]="Custom4",e[e.Custom5=256]="Custom5",e[e.Custom6=512]="Custom6",e[e.Custom7=1024]="Custom7",e[e.Custom8=2048]="Custom8",e[e.Custom9=4096]="Custom9",e[e.Custom10=8192]="Custom10",e[e.Custom11=16384]="Custom11",e[e.Custom12=32768]="Custom12",e[e.All=65520]="All"}(nU||(nU={}));function kRe(e){return[e.on("before-add",t=>{const r=t.item;if(r==null||e.includes(r))return oe.getLogger("esri.views.interactive.interactiveToolUtils").warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault();r.onAdd()}),e.on("after-remove",t=>{const r=t.item;r.active&&(r.view.activeTool=null),r.destroy()})]}function UC(e){return e.visible&&e.getEditableFlag!=null&&e.getEditableFlag(xv.USER)&&e.getEditableFlag(xv.MANAGER)}function ol(e){return Yn(e.x,e.y)}function EK(e,t){var i;const r=(i=e instanceof HTMLElement?e:e.surface)==null?void 0:i.getBoundingClientRect();return r?Yn(t.clientX-r.left,t.clientY-r.top):Yn(0,0)}function AK(e,t){return t instanceof Event?EK(e,t):ol(t)}function RK(e){if(e instanceof Event)return!0;if(typeof e=="object"&&"type"in e)switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}let NRe=class{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._revertToNullActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}hasFocusedManipulators(){return this._grabbedManipulators.size>0||this._draggedManipulators.size>0}handleInputEvent(t,r){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":sU(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(i(),t.action==="end"&&(this._stopDrag=!1));break;case"pointer-down":{if(!oU(t))break;const n=ol(t),s=this._intersect(n,t.pointerType,r.forEachTool);if(s==null)break;const o=s.manipulator,a=s.tool;o==null||a==null||!o.interactive||o.grabbable&&o.grabbableForEvent(t)||!o.grabbing||o.dragging||this._releaseManipulatorBeforeDragging(o,t,r),o!=null&&a!=null&&o.interactive&&o.grabbable&&o.grabbableForEvent(t)&&!o.grabbing&&(this._grabbedManipulators.set(t.pointerId,{manipulator:o,tool:a,start:n,pointerType:t.pointerType}),this._grabbedManipulators.size===1&&r.activeTool==null&&(this._revertToNullActiveTool=!0,r.setActiveTool(s.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:n}),i());break}case"pointer-up":this._draggedManipulators.has(t.pointerId)||this._handlePointerEnd(t,r);break;case"pointer-drag":{if(!oU(t))break;const n=this._grabbedManipulators.get(t.pointerId),s=n==null?void 0:n.manipulator,o=n==null?void 0:n.tool;if(s==null||o==null)break;const a=ol(t);a.x=ka(a.x,0,r.view.width),a.y=ka(a.y,0,r.view.height);const u=n.start,c=this._draggedManipulators.get(t.pointerId);switch(t.action){case"start":case"update":t.action!=="update"&&this._grabbedManipulators.size!==1||(s.dragging=!0,c?s.events.emit("drag",{action:"update",start:u,screenPoint:a}):s.events.emit("drag",{action:"start",start:u,screenPoint:a,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{tool:o,manipulator:s,start:u}));break;case"end":s.dragging=!1,c&&s.events.emit("drag",{action:"end",start:u,screenPoint:a}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,r)}i();break}case"immediate-click":{const n=ol(t),s=this._intersect(n,t.pointerType,r.forEachTool);if(DRe(t)||r.forEachTool(c=>{if((s==null||s.tool!==c||c.automaticManipulatorSelection)&&c.manipulators){let h=!1;c.manipulators.forEach(({manipulator:d})=>{d.selected&&(d.selected=!1,h=!0)}),h&&c.onManipulatorSelectionChanged&&c.onManipulatorSelectionChanged()}}),s==null)break;const{manipulator:o,tool:a}=s;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.onManipulatorSelectionChanged&&a.onManipulatorSelectionChanged());const u=t.native.shiftKey;o.events.emit("immediate-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:u,stopPropagation:i}),s$(o,i);break}case"click":{const n=ol(t),s=this._intersect(n,t.pointerType,r.forEachTool),o=s==null?void 0:s.manipulator;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit(t.type,{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:a}),i();break}case"double-click":{const n=ol(t),s=this._intersect(n,t.pointerType,r.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit("double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:i}),s$(o,i);break}case"immediate-double-click":{const n=ol(t),s=this._intersect(n,t.pointerType,r.forEachTool),o=s!=null?s.manipulator:null;if(o==null||!o.interactive)break;const a=t.native.shiftKey;o.events.emit("immediate-double-click",{screenPoint:n,button:t.button,pointerType:t.pointerType,shiftKey:a,stopPropagation:i}),s$(o,i);break}}this._onFocusChange(r.forEachTool)}_releaseManipulatorBeforeDragging(t,r,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:r.pointerType,screenPoint:ol(r)}),this._grabbedManipulators.forEach(({manipulator:n},s)=>{n===t&&this._grabbedManipulators.delete(s)}),this._afterManipulatorRelease(i.setActiveTool)}_handlePointerEnd(t,r){var n;const i=(n=this._grabbedManipulators.get(t.pointerId))==null?void 0:n.manipulator;i!=null&&i.grabbing&&(i.grabbing=!1,i.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:ol(t)}),this._grabbedManipulators.delete(t.pointerId),this._afterManipulatorRelease(r.setActiveTool))}_cursorFromMap(t){let r=null;return Dx(t,({manipulator:i})=>!(i==null||!i.interactive)&&(i.grabbing&&i.grabCursor?(r=i.grabCursor,!0):!!i.cursor&&(r=i.cursor,!0))),r}_onFocusChange(t){this._updateCursor(),this._updateFocusedManipulatorTools(t)}_updateCursor(){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators)||"pointer":this._cursor=null}_updateFocusedManipulatorTools(t){const r=new Set,i=new Set;this._grabbedManipulators.forEach(({tool:n})=>{r.add(n)}),this._hoveredManipulators.forEach(({tool:n})=>{i.add(n)}),t(n=>{n.hasGrabbedManipulators=r.has(n),n.hasHoveredManipulators=i.has(n);const s=this._grabbedManipulators.values(),o=$ae(s,({tool:a})=>a===n);n.firstGrabbedManipulator=o!=null?o.manipulator:null})}clearPointers(t,{forEachTool:r,setActiveTool:i},n=!0,s){const o=(a,u)=>a===t&&(s==null||s===u);this._grabbedManipulators.forEach(({tool:a,manipulator:u,pointerType:c},h)=>{o(a,u)&&(this._grabbedManipulators.delete(h),u.grabbing=!1,u.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:c}))}),this._draggedManipulators.forEach(({tool:a,manipulator:u},c)=>{o(a,u)&&(this._draggedManipulators.delete(c),u.dragging=!1,u.events.emit("drag",{action:"cancel"}))}),n&&this._hoveredManipulators.forEach(({tool:a,manipulator:u},c)=>{o(a,u)&&(this._hoveredManipulators.delete(c),u.hovering=!1)}),this._afterManipulatorRelease(i),this._onFocusChange(r)}_intersect(t,r,i){let n=null;return i(s=>{if(s.manipulators==null||!UC(s))return!1;const o=s.manipulators.intersect(t,r);return o!=null&&(n={tool:s,manipulator:o},!0)}),n}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach((r,i)=>{this._updateHoveredStateForPointerAtScreenPosition(Yn(r.x,r.y),i,r.pointerType,t)})}handleHoverEvent(t,r){t.type!=="pointer-up"&&t.type!=="immediate-click"&&t.type!=="pointer-move"||!sU(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(ol(t),t.pointerId,t.pointerType,r)}_updateHoveredStateForPointerAtScreenPosition(t,r,i,n){var a;let s=this._intersect(t,i,n);const o=(a=this._hoveredManipulators.get(r))==null?void 0:a.manipulator;s==null||s.manipulator.interactive||(s=null),s!=null&&o===s.manipulator||(o!=null&&(o.hovering=!1),s!=null?(s.manipulator.hovering=!0,this._hoveredManipulators.set(r,s)):this._hoveredManipulators.delete(r),this._onFocusChange(n))}_afterManipulatorRelease(t){this._grabbedManipulators.size===0&&this._revertToNullActiveTool&&(t(null),this._revertToNullActiveTool=!1)}};function sU(e){return e==="mouse"}function oU(e){return e.pointerType!=="mouse"||e.button===0}function DRe(e){return!!e.native.shiftKey}function s$(e,t){e!=null&&e.consumesClicks&&t()}const aU="attached",o$="tools",lU=1e3;let al=class extends De{constructor(t){super(t),this._updatingHandles=new Xd,this._clock=Gm,this._manipulatorState=new NRe,this.tools=new $e,this.cursor=null,this._interacting=!1,this._interactingTimeout=lU,this._interactingTimeoutHandle=null,this._forEachTool=r=>{for(const i of this.tools.items)if(r(i))return}}initialize(){this.addHandles([this.view.on(IK,t=>{this._handleInputEvent(t)},Sp.TOOL),...kRe(this.tools),this.tools.on("before-add",({item:t})=>{this._updateToolEditableFlag(t)}),this.tools.on("before-remove",({item:t})=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()}),this.tools.on("change",()=>{this._refreshToolWatchers()})])}destroy(){this.activeTool=null,this.tools.drain(t=>t.destroy()),this._clearInteractingTimeout(),this._interacting=!1,this._updatingHandles.destroy()}get _manipulatorStateEventArgs(){return{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}}set activeTool(t){if(t!=null&&!this.view.ready)return void oe.getLogger(this).error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return;const r=this.activeTool;this._set("activeTool",t),r!=null&&r.deactivate(),t!=null&&t.activate(),this._removeIncompleteTools(t);for(const i of this.tools){this._updateToolEditableFlag(i);const n=UC(i);this.activeTool!=null&&n||this._manipulatorState.clearPointers(i,this._manipulatorStateEventArgs,!n)}this._updateCursor()}get updating(){return this._updatingHandles.updating||this.tools.some(t=>t.updating)}get interacting(){return this._interacting}_clearInteractingTimeout(){this._interactingTimeoutHandle=Tr(this._interactingTimeoutHandle)}_startInteractingTimeout(){this._clearInteractingTimeout(),this._interactingTimeoutHandle=this._clock.setTimeout(()=>this._interacting=!1,this._interactingTimeout)}attach(){var t;this.view.type==="3d"?this.addHandles([Ue(()=>{const{state:r}=this.view;return"camera"in r&&r.camera},()=>this._forEachManipulator(r=>r.onViewChange())),(t=this.view.elevationProvider)==null?void 0:t.on("elevation-change",r=>this._forEachManipulator(i=>i.onElevationChange(r)))],aU):this.addHandles(Ue(()=>this.view.extent,()=>this._forEachManipulator(r=>r.onViewChange())))}detach(){this.activeTool=null,this.tools.removeAll(),this.removeHandles(aU),this._clearInteractingTimeout(),this._interacting=!1}_forEachManipulator(t){this._forEachTool(r=>{r.manipulators&&r.manipulators.forEach(({manipulator:i})=>t(i,r))})}_handleInputEvent(t){let r=!1;const i={...t,stopPropagation:()=>{r=!0,t.stopPropagation()}};this.activeTool!=null?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool(n=>{!r&&n.visible&&n.handleInputEvent(i)}),!r&&t.type==="key-down"&&t.key==="Escape"&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,this._manipulatorStateEventArgs),r||this.activeTool==null||this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor(),t.type==="pointer-move"&&(this._manipulatorState.hasFocusedManipulators()||this.activeTool)&&(this._interacting=!0,this._startInteractingTimeout())}_refreshToolWatchers(){this.removeHandles(o$),this._forEachTool(t=>{if(t instanceof De){const r=Ue(()=>[t.cursor,t.visible,t.editable],()=>{UC(t)||this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs),this._updateCursor()});this.addHandles(r,o$)}t.manipulators&&this.addHandles([t.manipulators.on("after-remove",r=>{this._manipulatorState.clearPointers(t,this._manipulatorStateEventArgs,!0,r.item.manipulator)}),t.manipulators.on("change",()=>{this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})],o$)}),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateToolEditableFlag(t){var r;(r=t.setEditableFlag)==null||r.call(t,xv.MANAGER,this.activeTool==null||t===this.activeTool)}_updateCursor(){let t=this._manipulatorState.cursor;t==null&&this._forEachTool(r=>!(r.cursor==null||!r.visible)&&(t=r.cursor,!0)),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter(r=>(t==null||r!==t)&&!r.created&&r.removeIncompleteOnCancel).forEach(r=>{this.tools.remove(r)})}get test(){const t=this;return{setClock:r=>this._clock=r,set interactingTimeoutEnabled(r){t._interactingTimeout=r?lU:0},get interactingTimeoutEnabled(){return t._interactingTimeout!==0}}}};l([p({constructOnly:!0,nonNullable:!0})],al.prototype,"view",void 0),l([p({value:null})],al.prototype,"activeTool",null),l([p({readOnly:!0,type:$e})],al.prototype,"tools",void 0),l([p({readOnly:!0})],al.prototype,"cursor",void 0),l([p({readOnly:!0})],al.prototype,"updating",null),l([p()],al.prototype,"_interacting",void 0),l([p({readOnly:!0})],al.prototype,"interacting",null),al=l([k("esri.views.ToolViewManager")],al);let Oy=class extends De{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",t.mapping==="standard"?this._detectedDeviceType="standard":FRe.test(t.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=t.index}get native(){const t=navigator.getGamepads?navigator.getGamepads():[];return this.nativeIndex!=null&&this.nativeIndex<t.length?t[this.nativeIndex]:null}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return jRe[this.deviceType]}};l([p({nonNullable:!0,readOnly:!0})],Oy.prototype,"nativeIndex",void 0),l([p({type:String,readOnly:!0})],Oy.prototype,"deviceType",null),l([p({type:Number,readOnly:!0})],Oy.prototype,"axisThreshold",null),Oy=l([k("esri.views.input.gamepad.GamepadInputDevice")],Oy);const FRe=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),jRe={standard:.15,spacemouse:.025,unknown:0},nL=Oy;let l1=class extends De{constructor(...t){super(...t),this.devices=new $e,this.enabledFocusMode="document"}};l([p({type:$e.ofType(nL),readOnly:!0})],l1.prototype,"devices",void 0),l([p({type:["document","view","none"]})],l1.prototype,"enabledFocusMode",void 0),l1=l([k("esri.views.input.gamepad.GamepadSettings")],l1);const URe=l1;let aS=class extends De{constructor(){super(...arguments),this.gamepad=new URe}};l([p({readOnly:!0})],aS.prototype,"gamepad",void 0),aS=l([k("esri.views.input.Input")],aS);const VRe=aS;let Jc=class extends De{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};l([p({type:Boolean,nonNullable:!0})],Jc.prototype,"enabled",void 0),l([p({type:nL})],Jc.prototype,"device",void 0),l([p({type:["pan","zoom"],nonNullable:!0})],Jc.prototype,"mode",void 0),l([p({type:["forward-down","forward-up"],nonNullable:!0})],Jc.prototype,"tiltDirection",void 0),l([p({type:Number,nonNullable:!0})],Jc.prototype,"velocityFactor",void 0),Jc=l([k("esri.views.navigation.gamepad.GamepadSettings")],Jc);const CK=Jc;let cd=class extends De{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new CK,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};l([p({type:Boolean})],cd.prototype,"browserTouchPanEnabled",void 0),l([p({type:CK,nonNullable:!0})],cd.prototype,"gamepad",void 0),l([p({type:Boolean})],cd.prototype,"momentumEnabled",void 0),l([p({type:Boolean})],cd.prototype,"mouseWheelZoomEnabled",void 0),cd=l([k("esri.views.navigation.Navigation")],cd);const OK=cd;var uU;function GRe(e){var i;if(e.type==="integrated-mesh-3dtiles")return null;const t=e.url?zu(e.url):void 0;return!(((i=e.spatialReference)==null?void 0:i.vcsWkid)==null&&t!=null&&t.serverType==="ImageServer")&&PK(e)&&e.heightModelInfo?e.heightModelInfo:BRe(e)?ZT.deriveUnitFromSR(qRe,e.spatialReference):null}function PK(e){return"heightModelInfo"in e}function LK(e){if(e.type==="unknown"||!("capabilities"in e))return!1;switch(e.type){case"catalog":case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"oriented-imagery":case"wfs":case"knowledge-graph-sublayer":return!0;default:return!1}}function BRe(e){return LK(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):kK(e)}function zRe(e){return e.layers!=null||kK(e)||LK(e)||PK(e)}function kK(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"integrated-mesh-3dtiles":case"point-cloud":case"scene":case"voxel":return!0;case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"catalog":case"catalog-footprint":case"catalog-dynamic-group":case"csv":case"dimension":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"knowledge-graph":case"link-chart":case"knowledge-graph-sublayer":case"line-of-sight":case"map-image":case"map-notes":case"media":case"ogc-feature":case"open-street-map":case"oriented-imagery":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"video":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}(function(e){e[e.Ok=0]="Ok",e[e.Units=1]="Units",e[e.HeightModel=2]="HeightModel",e[e.CRS=3]="CRS",e[e.Unsupported=4]="Unsupported"})(uU||(uU={}));const qRe=new ZT({heightModel:"gravity-related-height"});var Ix;(function(e){e[e.Global=1]="Global",e[e.Local=2]="Local"})(Ix||(Ix={}));let VC,a$=null;async function HRe(e){a$||(a$=ge(()=>import("./geometryServiceUtils-BLCEGd90.js"),__vite__mapDeps([136,1,2,137])).then(t=>VC=t)),await a$,Ut(e)}async function NK(e,t,r,i){if(!e)return null;const n=e.spatialReference;return Hp()||Al(n,t)?Wp(e,t):VC?VC.projectGeometry(e,t,r,i):(await Promise.race([HRe(i),Ap(i)]),NK(e,t,r,i))}let Wt=class extends De{constructor(t){super(t),this.required={tileInfo:!1,heightModelInfo:!1,extent:!1},this.defaultSpatialReference=null,this.userSpatialReference=null,this.sourcePreloadCount=10,this.priorityCollection=null,this.requiresExtentInSpatialReference=!0,this.suspended=!1,this._projectExtentTask={task:null,input:null,output:null,spatialReference:null}}destroy(){this._projectExtentTask.task&&(this._projectExtentTask.task=X1(this._projectExtentTask.task)),this._set("map",null)}get ready(){return!this._spatialReferenceTask.updating&&!this._tileInfoTask.updating&&!this._extentTask.updating}get heightModelInfoReady(){return!this._heightModelInfoTask.updating}get spatialReference(){return this.userSpatialReference!=null?this.userSpatialReference:this._spatialReferenceTask.spatialReference}get extent(){return this._extentTask.extent}get heightModelInfo(){return this._heightModelInfoTask.heightModelInfo}get vcsWkid(){return this._heightModelInfoTask.vcsWkid}get latestVcsWkid(){return this._heightModelInfoTask.latestVcsWkid}get viewingMode(){return this.userSpatialReference==null||this.userSpatialReference.equals(this._spatialReferenceTask.spatialReference)?this._spatialReferenceTask.viewingMode:null}get tileInfo(){return this._tileInfoTask.tileInfo}get mapCollections(){var i,n,s,o;const t=(i=this.map)==null?void 0:i.call(this),r=[];return this.priorityCollection!=null&&r.push(this.priorityCollection),r.push({parent:t==null?void 0:t.basemap,layers:(n=t==null?void 0:t.basemap)==null?void 0:n.baseLayers},{layers:t==null?void 0:t.layers},{parent:t==null?void 0:t.ground,layers:(s=t==null?void 0:t.ground)==null?void 0:s.layers},{parent:t==null?void 0:t.basemap,layers:(o=t==null?void 0:t.basemap)==null?void 0:o.referenceLayers}),r}get _allLayers(){return this._collectLayers(this.mapCollections)}get _spatialReferenceTask(){if(this.suspended)return this._get("_spatialReferenceTask")??{updating:!1};const{layers:t,updating:r}=this._allLayers;let i=null;for(const s of t){const o=this._getSupportedSpatialReferences(s);if(o.length>0){const a=this._narrowDownSpatialReferenceCandidates(i,o);a!=null&&(i=a)}if(i!=null&&i.length===1)break}if(r&&(i==null||i.length!==1))return{updating:!0};const n=this._pickSpatialReferenceCandidate(i);return{spatialReference:n!=null?n.spatialReference:null,viewingMode:n!=null?n.viewingMode:null,updating:!1}}get _tileInfoTask(){var i,n,s,o,a,u,c;if(!this.required.tileInfo)return this._get("_tileInfoTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const{layers:t,updating:r}=this._collectLayers([{parent:(n=(i=this.map)==null?void 0:i.call(this))==null?void 0:n.basemap,layers:(a=(o=(s=this.map)==null?void 0:s.call(this))==null?void 0:o.basemap)==null?void 0:a.baseLayers},{layers:(c=(u=this.map)==null?void 0:u.call(this))==null?void 0:c.layers}]);if(t&&t.length>0&&"tileInfo"in t[0]){const h=t[0].tileInfo;return{tileInfo:h&&h.spatialReference.equals(this.spatialReference)?h:null,updating:!1}}return{updating:r}}get _heightModelInfoTask(){var i,n,s;if(!this.required.heightModelInfo||this.suspended&&((i=this._get("_heightModelInfoTask"))!=null&&i.heightModelInfo))return this._get("_heightModelInfoTask")??{updating:!1};const{layers:t,updating:r}=this._allLayers;for(const o of t)if(zRe(o)){const a=GRe(o);if(a)return{heightModelInfo:a,vcsWkid:(n=o.spatialReference)==null?void 0:n.vcsWkid,latestVcsWkid:(s=o.spatialReference)==null?void 0:s.latestVcsWkid,updating:!1}}return{updating:r}}get _extentCandidatesTask(){if(this.suspended||!this.required.extent)return this._get("_extentCandidatesTask")??{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const t=this._allLayers,r=t.updating,i=[];for(const n of t.layers){const s="fullExtents"in n&&n.fullExtents||(n.fullExtent!=null?[n.fullExtent]:[]),o=this.requiresExtentInSpatialReference?null:s[0],a=s.find(u=>u.spatialReference.equals(this.spatialReference))??o;if(a)return{candidates:[{extent:a,layer:n}],updating:!1};if(this._getSupportedSpatialReferences(n).length>0)for(const u of s)i.push({extent:u,layer:n})}return{candidates:i,updating:r}}get _extentTask(){const{candidates:t,updating:r}=this._extentCandidatesTask;if(r)return{updating:r};if(t==null||t.length===0)return{updating:!1};if(!this.spatialReference)return{updating:this._spatialReferenceTask.updating};const i=this._pickExtentCandidate(t),n=this.spatialReference;return i.extent.equals(this._projectExtentTask.input)&&n.equals(this._projectExtentTask.spatialReference)?{extent:this._projectExtentTask.output,updating:this._projectExtentTask.task!=null&&!this._projectExtentTask.task.finished}:(this._projectExtentTask.task!=null&&(this._projectExtentTask.task=X1(this._projectExtentTask.task)),this._projectExtentTask={input:i.extent.clone(),output:null,spatialReference:n.clone(),task:mT(async s=>{try{const o=await NK(i.extent,n,"portalItem"in i.layer?i.layer.portalItem:void 0,s);this._projectExtentTask={...this._projectExtentTask,task:null,output:o}}catch{if(to(s))return;this._projectExtentTask={...this._projectExtentTask,task:null}}})},{updating:!0})}_narrowDownSpatialReferenceCandidates(t,r){if(t==null)return r;const i=[],n=(s,o)=>s!=null?o!=null?s===o&&s:s:o;for(const s of t)for(const o of r){if(!s.spatialReference.equals(o.spatialReference))continue;const a=n(s.viewingMode,o.viewingMode);if(a!==!1){i.push({spatialReference:s.spatialReference,viewingMode:a});break}}return i.length>0?i:null}_pickSpatialReferenceCandidate(t){const r=this.defaultSpatialReference;return t==null||t.length<1?r!=null?{spatialReference:r,viewingMode:null}:null:(r!=null&&t.length>1&&t.some(({spatialReference:i})=>i.equals(r))&&(t=t.filter(({spatialReference:i})=>i.equals(r))),t.length>1&&t.some(({viewingMode:i})=>i!==Ix.Local)&&(t=t.filter(({viewingMode:i})=>i!==Ix.Local)),t[0])}_getSupportedSpatialReferences(t){const r="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(r.length===0)return[];const i=[];for(const n of r){const s=this.getSpatialReferenceSupport({spatialReference:n,layer:t});if(s!=null){const o=s.constraints!=null?s.constraints:[{spatialReference:n,viewingMode:null}];for(const{spatialReference:a,viewingMode:u}of o)this.requiresExtentInSpatialReference&&this.userSpatialReference!=null&&!a.equals(this.userSpatialReference)||i.push({spatialReference:a,viewingMode:u})}}return i}_pickExtentCandidate(t){const r=this.spatialReference;return t.find(({extent:i})=>r.equals(i.spatialReference))||t[0]}_collectLayers(t){var i;if(this._loadMaybe((i=this.map)==null?void 0:i.call(this))!=="loaded")return{layers:[],updating:!0};const r=new WRe;for(const n of t)if(this._collectCollection(n,r),r.preloading===this.sourcePreloadCount)break;return{layers:r.layers,updating:r.updating}}_collectCollection(t,r){if(t.layers){switch(this._loadMaybe(t.parent)){case"loading":return r.updating=!0,void++r.preloading;case"failed":return}for(const i of t.layers){switch(this._loadMaybe(i)){case"failed":continue;case"loading":r.updating=!0,++r.preloading;break;case"loaded":r.updating||r.layers.push(i),"layers"in i&&this._collectCollection({layers:i.layers},r)}if(r.preloading===this.sourcePreloadCount)break}}}_loadMaybe(t){return t&&"loadStatus"in t&&t.loadStatus!=null?t.loadStatus==="not-loaded"?(t.load().catch(r=>{Ei(r)||console.log(r)}),"loading"):t.loadStatus:"loaded"}};l([p()],Wt.prototype,"required",void 0),l([p({constructOnly:!0})],Wt.prototype,"map",void 0),l([p({constructOnly:!0})],Wt.prototype,"getSpatialReferenceSupport",void 0),l([p()],Wt.prototype,"defaultSpatialReference",void 0),l([p()],Wt.prototype,"userSpatialReference",void 0),l([p()],Wt.prototype,"sourcePreloadCount",void 0),l([p()],Wt.prototype,"priorityCollection",void 0),l([p()],Wt.prototype,"requiresExtentInSpatialReference",void 0),l([p()],Wt.prototype,"suspended",void 0),l([p({readOnly:!0})],Wt.prototype,"ready",null),l([p({readOnly:!0})],Wt.prototype,"heightModelInfoReady",null),l([p({readOnly:!0})],Wt.prototype,"spatialReference",null),l([p({readOnly:!0})],Wt.prototype,"extent",null),l([p({readOnly:!0})],Wt.prototype,"heightModelInfo",null),l([p({readOnly:!0})],Wt.prototype,"vcsWkid",null),l([p({readOnly:!0})],Wt.prototype,"latestVcsWkid",null),l([p({readOnly:!0})],Wt.prototype,"viewingMode",null),l([p({readOnly:!0})],Wt.prototype,"tileInfo",null),l([p({readOnly:!0})],Wt.prototype,"mapCollections",null),l([p({readOnly:!0})],Wt.prototype,"_allLayers",null),l([p({readOnly:!0})],Wt.prototype,"_spatialReferenceTask",null),l([p({readOnly:!0})],Wt.prototype,"_tileInfoTask",null),l([p({readOnly:!0})],Wt.prototype,"_heightModelInfoTask",null),l([p({readOnly:!0})],Wt.prototype,"_extentCandidatesTask",null),l([p()],Wt.prototype,"_extentTask",null),l([p()],Wt.prototype,"_projectExtentTask",void 0),Wt=l([k("esri.views.support.DefaultsFromMap")],Wt);let WRe=class{constructor(){this.layers=new Array,this.preloading=-1,this.updating=!1}};var u1;let je=u1=class extends Zu.EventedMixin(pT(De)){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.handles=new gO,this.updatingHandles=new Xd,this.allLayerViews=new ff({getCollections:()=>{var t,r,i;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,(r=this.groundView)==null?void 0:r.layerViews,this.layerViews,(i=this.basemapView)==null?void 0:i.referenceLayerViews]},getChildrenFunction:ZRe}),this.groundView=null,this.basemapView=null,this.fatalError=null,this.graphics=new Z1,this.analyses=new Tx,this.typeSpecificPreconditionsReady=!0,this.layerViews=new $e,this.magnifier=new TK,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new VRe,this.navigation=new OK,this.layerViewManager=null,this.analysisViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new PRe(this),this.persistableViewModels=new $e,this._isValid=!1,this._readyCycleForced=!1,this._lockedSpatialReference=null,this._userTimeZone=null,this._lockedTimeZone=null,this.theme=null,this.handles.add(Ue(()=>this.preconditionsReady,t=>{var i,n;const r=this.ready;if(t?(this._lockedSpatialReference=this.spatialReference,this._lockedTimeZone=this.timeZone,u1.views.add(this)):(this._lockedSpatialReference=null,u1.views.remove(this)),this.notifyChange("spatialReference"),!t&&r)(i=this.toolViewManager)==null||i.detach(),this.analysisViewManager!=null&&this.analysisViewManager.detach(),(n=this.layerViewManager)==null||n.clear(),this._teardown();else if(t&&!r){try{this._startup()}catch(s){return void queueMicrotask(()=>{console.error("View._startup failed",s),this.fatalError=new z("startup-error",null,s)})}this.analysisViewManager!=null&&this.analysisViewManager.attach(),this.toolViewManager.attach()}},di))}initialize(){this.addResolvingPromise(Promise.all([this.loadAsyncDependencies(),this.validate()]).then(()=>(this._isValid=!0,gT(()=>this.ready)))),this.basemapView=new Wc({view:this}),this.layerViewManager=new $Re({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new al({view:this}),this._setupSpatialReferenceLogger(),this.selectionManager=new CRe({view:this}),this.addHandles([Ue(()=>this.initialExtentRequired,e=>this.defaultsFromMap.required={...this.defaultsFromMap.required,extent:e},Ta),Ue(()=>this.ready,e=>{this.defaultsFromMap&&(this.defaultsFromMap.suspended=e,this.defaultsFromMap.userSpatialReference=e?this.spatialReference:this._userSpatialReference)},di),Ue(()=>this._userSpatialReference,e=>{this.defaultsFromMap&&(this.defaultsFromMap.userSpatialReference=e)},Ta)])}_setupSpatialReferenceLogger(){let e=null;this.addHandles([Ue(()=>{var t;return(t=this.defaultsFromMap)==null?void 0:t.ready},t=>{var i;const r=((i=this.map)==null?void 0:i.allLayers.length)>0;if(t&&!this.spatialReference&&r){if(e!=null)return;const n=Xt(()=>e=X1(e));e=mT(async s=>{try{await VV(this.spatialReferenceWarningDelay,null,s)}catch{return}finally{e=null}oe.getLogger(this).warn("#spatialReference","no spatial reference could be derived from the currently added map layers")}),this.addHandles(n,"spatial-reference-logger-task")}else this.removeHandles("spatial-reference-logger-task")},{sync:!0})])}destroy(){var e,t;this.destroyed||(u1.views.remove(this),this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=cr(this.graphics),this.analyses=cr(this.analyses),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),cr(this.analysisViewManager),this.toolViewManager=cr(this.toolViewManager),this.layerViewManager=cr(this.layerViewManager),this.selectionManager=cr(this.selectionManager),this.basemapView=cr(this.basemapView),(e=this.groundView)==null||e.destroy(),(t=this.layerViews)==null||t.forEach(r=>r.destroy()),this.layerViews.length=0,this.invalidate(),this._emitter.clear(),this.handles.destroy(),this.map=cr(this.map),this.updatingHandles.destroy())}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return oe.getLogger(this).error("#toMap()","Not implemented on this instance of View"),null}get activeTool(){var e;return(e=this.toolViewManager)==null?void 0:e.activeTool}set activeTool(e){this.toolViewManager&&(this.toolViewManager.activeTool=e)}get animation(){return this._get("animation")}set animation(e){this._set("animation",e)}get center(){return null}get _defaultsFromMapSettings(){return{}}get defaultsFromMap(){return new Wt({required:{tileInfo:!1,heightModelInfo:!1,extent:!1},map:()=>this.map,getSpatialReferenceSupport:e=>this.getSpatialReferenceSupport(e),...this._defaultsFromMapSettings})}get extent(){return this._get("extent")}set extent(e){this._set("extent",e)}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get navigating(){return!1}get preconditionsReady(){var e;return!(this.fatalError||!this._isValid||this._readyCycleForced||!this.map||El.isLoadable(this.map)&&!this.map.loaded||this.width===0||this.height===0||!this.spatialReference||!this._validateSpatialReference(this.spatialReference)||!this._lockedSpatialReference&&!((e=this.defaultsFromMap)!=null&&e.ready)||!this.typeSpecificPreconditionsReady)}get resolution(){return 0}set map(e){e!==this._get("map")&&(e!=null&&e.destroyed&&(oe.getLogger(this).warn("#map","The provided map is already destroyed",{map:e}),e=null),El.isLoadable(e)&&e.load().catch(()=>{}),this.constructed&&!this.destroyed&&(this.forceReadyCycle(),this._lockedSpatialReference=null),this._set("map",e))}get spatialReference(){var t,r;const e=this._userSpatialReference||this._lockedSpatialReference||this.getDefaultSpatialReference()||null;if(e&&((r=(t=this.defaultsFromMap)==null?void 0:t.required)!=null&&r.heightModelInfo)){const i=e.clone();return i.vcsWkid=this.defaultsFromMap.vcsWkid,i.latestVcsWkid=this.defaultsFromMap.latestVcsWkid,i}return e}set spatialReference(e){const t=!fi(e,this._get("spatialReference"));this._set("_userSpatialReference",e),t&&(this._set("spatialReference",e),this._spatialReferenceChanged(e))}_spatialReferenceChanged(e){}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get timeZone(){return this._userTimeZone??this._lockedTimeZone??this.getDefaultTimeZone()??Ml}set timeZone(e){const t=new Set(["etc/utc","etc/gmt","gmt"]),r=new Set(Intl.supportedValuesOf("timeZone").map(i=>i.toLowerCase()));this._userTimeZone=e,e===Ml||e===lf||t.has(e.toLowerCase())||r.has(e.toLowerCase())||oe.getLogger(this).warn("#timeZone",`the parsed value '${e}' may not be a valid IANA time zone`)}get tools(){var e;return(e=this.toolViewManager)==null?void 0:e.tools}get initialExtent(){var e;return(e=this.defaultsFromMap)==null?void 0:e.extent}get cursor(){var e;return((e=this.toolViewManager)==null?void 0:e.cursor)??this._cursor??"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor")}get size(){return[this.width,this.height]}get effectiveTheme(){return this.theme??new jC}whenLayerView(e){var t;return((t=this.layerViewManager)==null?void 0:t.whenLayerView(e))??Promise.reject()}getDefaultSpatialReference(){var e;return(e=this.defaultsFromMap)==null?void 0:e.spatialReference}getDefaultHeightModelInfo(){var e;return(this.map&&"heightModelInfo"in this.map?this.map.heightModelInfo:void 0)??((e=this.defaultsFromMap)==null?void 0:e.heightModelInfo)??null}getDefaultTimeZone(){return null}importLayerView(e){throw new z("importLayerView() not implemented")}hasLayerViewModule(e){return!1}async validate(){}async loadAsyncDependencies(){}invalidate(){this._isValid=!1}getSpatialReferenceSupport(){return{constraints:null}}_validateSpatialReference(e){return this.getSpatialReferenceSupport({spatialReference:e})!=null}when(e,t){return this.isResolved()&&!this.ready&&oe.getLogger(this).warn("#when()","Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use reactiveUtils.whenOnce(() => view.ready).then(...) instead."),super.when(e,t)}forceReadyCycle(){this.ready&&(hf(()=>this.destroyed||this.preconditionsReady===!1,()=>this._readyCycleForced=!1,{once:!0}),this._readyCycleForced=!0)}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e}tryFatalErrorRecovery(){this.fatalError=null}};je.views=new $e,l([p()],je.prototype,"_userSpatialReference",void 0),l([p()],je.prototype,"activeTool",null),l([p({readOnly:!0})],je.prototype,"allLayerViews",void 0),l([p()],je.prototype,"groundView",void 0),l([p()],je.prototype,"animation",null),l([p()],je.prototype,"basemapView",void 0),l([p()],je.prototype,"center",null),l([p({readOnly:!0})],je.prototype,"_defaultsFromMapSettings",null),l([p()],je.prototype,"defaultsFromMap",null),l([p()],je.prototype,"fatalError",void 0),l([p({type:Ne})],je.prototype,"extent",null),l([p(Q7(Z1,"graphics"))],je.prototype,"graphics",void 0),l([p(Q7(Tx,"analyses"))],je.prototype,"analyses",void 0),l([p({readOnly:!0,type:ZT})],je.prototype,"heightModelInfo",null),l([p({readOnly:!0})],je.prototype,"interacting",null),l([p({readOnly:!0})],je.prototype,"navigating",null),l([p({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_lockedSpatialReference","defaultsFromMap.ready","typeSpecificPreconditionsReady"]})],je.prototype,"preconditionsReady",null),l([p({readOnly:!0})],je.prototype,"typeSpecificPreconditionsReady",void 0),l([p({type:$e,readOnly:!0})],je.prototype,"layerViews",void 0),l([p()],je.prototype,"resolution",null),l([p({type:TK})],je.prototype,"magnifier",void 0),l([p({value:null,type:KP})],je.prototype,"map",null),l([p()],je.prototype,"padding",void 0),l([p({readOnly:!0})],je.prototype,"ready",void 0),l([p({type:xe})],je.prototype,"spatialReference",null),l([p()],je.prototype,"spatialReferenceWarningDelay",void 0),l([p()],je.prototype,"stationary",null),l([p({readOnly:!0})],je.prototype,"supportsGround",void 0),l([p({type:is})],je.prototype,"timeExtent",void 0),l([p({type:String,nonNullable:!0})],je.prototype,"timeZone",null),l([p()],je.prototype,"tools",null),l([p()],je.prototype,"toolViewManager",void 0),l([p({readOnly:!0})],je.prototype,"type",void 0),l([p({type:Number})],je.prototype,"scale",void 0),l([p({readOnly:!0})],je.prototype,"updating",void 0),l([p({readOnly:!0})],je.prototype,"initialExtentRequired",void 0),l([p({readOnly:!0})],je.prototype,"initialExtent",null),l([p()],je.prototype,"cursor",null),l([p({readOnly:!0})],je.prototype,"input",void 0),l([p({type:OK,nonNullable:!0})],je.prototype,"navigation",void 0),l([p()],je.prototype,"layerViewManager",void 0),l([p()],je.prototype,"analysisViewManager",void 0),l([p()],je.prototype,"selectionManager",void 0),l([p()],je.prototype,"width",void 0),l([p()],je.prototype,"height",void 0),l([p({readOnly:!0})],je.prototype,"resizing",void 0),l([p({value:null,readOnly:!0})],je.prototype,"size",null),l([p({readOnly:!0})],je.prototype,"suspended",void 0),l([p({readOnly:!0})],je.prototype,"viewEvents",void 0),l([p({readOnly:!0})],je.prototype,"persistableViewModels",void 0),l([p()],je.prototype,"_isValid",void 0),l([p()],je.prototype,"_readyCycleForced",void 0),l([p()],je.prototype,"_lockedSpatialReference",void 0),l([p()],je.prototype,"_userTimeZone",void 0),l([p()],je.prototype,"_lockedTimeZone",void 0),l([p({type:jC})],je.prototype,"theme",void 0),l([p({readOnly:!0,type:jC})],je.prototype,"effectiveTheme",null),je=u1=l([k("esri.views.View")],je);const JRe=je;function ZRe(e){return e.layerViews}let Zc=class extends sx{constructor(t){super(t),this.state="running",this.target=null,this._resolver=null}initialize(){this._resolver=ro(),this.addResolvingPromise(this._resolver.promise)}get done(){return this.state==="finished"||this.state==="stopped"}stop(){var t;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","stopped"),(t=this._resolver)==null||t.reject(new z("ViewAnimation stopped")))}finish(){var t;this.state!=="stopped"&&this.state!=="finished"&&(this._set("state","finished"),(t=this._resolver)==null||t.resolve())}update(t,r){r||(r=Dp(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",r)}};l([p({readOnly:!0})],Zc.prototype,"done",null),l([p({readOnly:!0,type:String})],Zc.prototype,"state",void 0),l([p()],Zc.prototype,"target",void 0),Zc=l([k("esri.views.ViewAnimation")],Zc),function(e){e.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"}}(Zc||(Zc={}));const GC=Zc;function YRe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function KRe(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function XRe(e,t,r,i,n,s,o){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=o,e}function sL(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5];let u=r*s-i*n;return u?(u=1/u,e[0]=s*u,e[1]=-i*u,e[2]=-n*u,e[3]=r*u,e[4]=(n*a-s*o)*u,e[5]=(i*o-r*a)*u,e):null}function QRe(e){return e[0]*e[3]-e[1]*e[2]}function DK(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=r[0],h=r[1],d=r[2],y=r[3],v=r[4],w=r[5];return e[0]=i*c+s*h,e[1]=n*c+o*h,e[2]=i*d+s*y,e[3]=n*d+o*y,e[4]=i*v+s*w+a,e[5]=n*v+o*w+u,e}function eI(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=Math.sin(r),h=Math.cos(r);return e[0]=i*h+s*c,e[1]=n*h+o*c,e[2]=i*-c+s*h,e[3]=n*-c+o*h,e[4]=a,e[5]=u,e}function oL(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=r[0],h=r[1];return e[0]=i*c,e[1]=n*c,e[2]=s*h,e[3]=o*h,e[4]=a,e[5]=u,e}function Tv(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=r[0],h=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=o,e[4]=i*c+s*h+a,e[5]=n*c+o*h+u,e}function FK(e,t){const r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=-r,e[3]=i,e[4]=0,e[5]=0,e}function jK(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function aL(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function eCe(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function tCe(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function rCe(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function UK(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function iCe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function nCe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e}function sCe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function oCe(e,t){const r=e[0],i=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=t[0],c=t[1],h=t[2],d=t[3],y=t[4],v=t[5],w=Bo();return Math.abs(r-u)<=w*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(i-c)<=w*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(n-h)<=w*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(s-d)<=w*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-y)<=w*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-v)<=w*Math.max(1,Math.abs(a),Math.abs(v))}const aCe=DK,lCe=UK;Object.freeze(Object.defineProperty({__proto__:null,add:rCe,copy:YRe,determinant:QRe,equals:oCe,exactEquals:sCe,frob:tCe,fromRotation:FK,fromScaling:jK,fromTranslation:aL,identity:KRe,invert:sL,mul:aCe,multiply:DK,multiplyScalar:iCe,multiplyScalarAndAdd:nCe,rotate:eI,scale:oL,set:XRe,str:eCe,sub:lCe,subtract:UK,translate:Tv},Symbol.toStringTag,{value:"Module"}));function ju(){return[1,0,0,1,0,0]}function uCe(e){return[e[0],e[1],e[2],e[3],e[4],e[5]]}function cCe(e,t,r,i,n,s){return[e,t,r,i,n,s]}function pCe(e,t){return new Float64Array(e,t,6)}const hCe=ju();Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:hCe,clone:uCe,create:ju,createView:pCe,fromValues:cCe},Symbol.toStringTag,{value:"Module"}));function Iv(e,t){return e[0]=t[0],e[1]=t[1],e}function Fi(e,t,r){return e[0]=t,e[1]=r,e}function VK(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Mv(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function GK(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function BK(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function dCe(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function fCe(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function yCe(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function mCe(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function gCe(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function fw(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function vCe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function tI(e,t){const r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function Mx(e,t){const r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function $x(e){const t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function zK(e){const t=e[0],r=e[1];return t*t+r*r}function qK(e,t){return e[0]=-t[0],e[1]=-t[1],e}function wCe(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function BC(e,t){const r=t[0],i=t[1];let n=r*r+i*i;return n>0&&(n=1/Math.sqrt(n),e[0]=t[0]*n,e[1]=t[1]*n),e}function HK(e,t){return e[0]*t[0]+e[1]*t[1]}function WK(e,t,r){const i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function bCe(e,t,r,i){const n=t[0],s=t[1];return e[0]=n+i*(r[0]-n),e[1]=s+i*(r[1]-s),e}function _Ce(e,t){t=t||1;const r=2*Xx()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function SCe(e,t,r){const i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n,e[1]=r[1]*i+r[3]*n,e}function xa(e,t,r){const i=t[0],n=t[1];return e[0]=r[0]*i+r[2]*n+r[4],e[1]=r[1]*i+r[3]*n+r[5],e}function xCe(e,t,r){const i=t[0],n=t[1];return e[0]=r[0]*i+r[3]*n+r[6],e[1]=r[1]*i+r[4]*n+r[7],e}function TCe(e,t,r){const i=t[0],n=t[1];return e[0]=r[0]*i+r[4]*n+r[12],e[1]=r[1]*i+r[5]*n+r[13],e}function ICe(e,t,r,i){const n=t[0]-r[0],s=t[1]-r[1],o=Math.sin(i),a=Math.cos(i);return e[0]=n*a-s*o+r[0],e[1]=n*o+s*a+r[1],e}function MCe(e,t){const r=e[0],i=e[1],n=t[0],s=t[1];let o=r*r+i*i;o>0&&(o=1/Math.sqrt(o));let a=n*n+s*s;a>0&&(a=1/Math.sqrt(a));const u=(r*n+i*s)*o*a;return u>1?0:u<-1?Math.PI:Math.acos(u)}function $Ce(e){return"vec2("+e[0]+", "+e[1]+")"}function ECe(e,t){return e[0]===t[0]&&e[1]===t[1]}function ACe(e,t){const r=e[0],i=e[1],n=t[0],s=t[1],o=Bo();return Math.abs(r-n)<=o*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-s)<=o*Math.max(1,Math.abs(i),Math.abs(s))}function RCe(e,t,r,i,n){let s=t[0]-r[0],o=t[1]-r[1];const a=(i[0]*s+i[1]*o)*(n-1);return s=i[0]*a,o=i[1]*a,e[0]=t[0]+s,e[1]=t[1]+o,e}const CCe=$x,lL=Mv,OCe=GK,PCe=BK,LCe=tI,kCe=Mx,NCe=zK;Object.freeze(Object.defineProperty({__proto__:null,add:VK,angle:MCe,ceil:dCe,copy:Iv,cross:WK,dist:LCe,distance:tI,div:PCe,divide:BK,dot:HK,equals:ACe,exactEquals:ECe,floor:fCe,inverse:wCe,len:CCe,length:$x,lerp:bCe,max:mCe,min:yCe,mul:OCe,multiply:GK,negate:qK,normalize:BC,projectAndScale:RCe,random:_Ce,rotate:ICe,round:gCe,scale:fw,scaleAndAdd:vCe,set:Fi,sqrDist:kCe,sqrLen:NCe,squaredDistance:Mx,squaredLength:zK,str:$Ce,sub:lL,subtract:Mv,transformMat2:SCe,transformMat2d:xa,transformMat3:xCe,transformMat4:TCe},Symbol.toStringTag,{value:"Module"}));function qr(){return[0,0]}function DCe(e){return[e[0],e[1]]}function yw(e,t){return[e,t]}function FCe(e,t=qr()){const r=Math.min(2,e.length);for(let i=0;i<r;++i)t[i]=e[i];return t}function jCe(e,t){return new Float64Array(e,t,2)}function JK(){return qr()}function ZK(){return yw(1,1)}function YK(){return yw(1,0)}function KK(){return yw(0,1)}const UCe=JK(),VCe=ZK(),GCe=YK(),BCe=KK();Object.freeze(Object.defineProperty({__proto__:null,ONES:VCe,UNIT_X:GCe,UNIT_Y:BCe,ZEROS:UCe,clone:DCe,create:qr,createView:jCe,fromArray:FCe,fromValues:yw,ones:ZK,unitX:YK,unitY:KK,zeros:JK},Symbol.toStringTag,{value:"Module"}));const XK=96,QK=39.37,zCe=180/Math.PI;function eX(e){return e.wkid?e:e.spatialReference||xe.WGS84}function uL(e,t){return t.type?Fi(e,t.x,t.y):Iv(e,t)}function tX(e){return Wu(e)}function pm(e,t,r=0){let i=e.width,n=e.height;if(r!==0){const a=jO(r),u=Math.abs(Math.cos(a)),c=Math.abs(Math.sin(a));i=e.width*u+e.height*c,n=e.width*c+e.height*u}const s=Math.max(1,t[0]),o=Math.max(1,t[1]);return Math.max(i/s,n/o)*QCe(e.spatialReference)}async function c1(e,t,r,i){var a,u;let n,s;if(!e||Array.isArray(e)&&!e.length)return null;if($e.isCollection(e)&&(e=e.toArray()),Array.isArray(e)&&e.length&&typeof e[0]=="object"){const c=e.every(y=>"attributes"in y),h=e.some(y=>!y.geometry);let d=e;if(c&&h&&t&&t.allLayerViews){const y=new Map;for(const _ of e){const x=_.layer,T=y.get(x)||[],I=_.attributes[x.objectIdField];I!=null&&T.push(I),y.set(x,T)}const v=[];y.forEach((_,x)=>{const T=t.allLayerViews.find(I=>I.layer.id===x.id);if(T&&"queryFeatures"in T){const I=x.createQuery();I.objectIds=_,I.returnGeometry=!0,v.push(T.queryFeatures(I))}});const w=await Promise.all(v),b=[];for(const _ of w)if(_&&_.features&&_.features.length)for(const x of _.features)x.geometry!=null&&b.push(x.geometry);d=b}for(const y of d)i=await c1(y,t,r,i);return i}if(Array.isArray(e)&&e.length===2&&typeof e[0]=="number"&&typeof e[1]=="number")n=new Ae(e);else if(e instanceof Ju)n=e;else if("geometry"in e){if(e.geometry)n=e.geometry;else if(e.layer){const c=e.layer,h=t.allLayerViews.find(d=>d.layer.id===c.id);if(h&&"queryFeatures"in h){const d=c.createQuery();d.objectIds=[e.attributes[c.objectIdField]],d.returnGeometry=!0;const y=await h.queryFeatures(d);n=(u=(a=y==null?void 0:y.features)==null?void 0:a[0])==null?void 0:u.geometry}}}if(n==null)return null;switch(n.type){case"point":s=new Ne({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference});break;case"extent":case"multipoint":case"polygon":case"polyline":s=iSe(n);break;default:s=n.extent}if(!s)return null;Hp()||Al(s.spatialReference,r)||await Ap();const o=Wp(s,r);return o?i=i?i.union(o):o:null}function qCe(e){var t;if(e&&(!Array.isArray(e)||typeof e[0]!="number")&&(typeof e=="object"||Array.isArray(e)&&typeof e[0]=="object")){if("layer"in e&&((t=e.layer)==null?void 0:t.minScale)!=null&&e.layer.maxScale!=null){const r=e.layer;return{min:r.minScale,max:r.maxScale}}if(Array.isArray(e)&&e.length&&e.every(r=>"layer"in r)){let r=0,i=0;for(const n of e){const s=n.layer;s!=null&&s.minScale&&s.maxScale&&(r=s.minScale<r?s.minScale:r,i=s.maxScale>i?s.maxScale:i)}return r&&i?{min:r,max:i}:null}}}function l$(e,t){return fi(eX(e),t)?e:Wp(e,t)}async function HCe(e,t){var _;if(!e||!t)return new xl({targetGeometry:new Ae,scale:0,rotation:0});let r=t.spatialReference;const{constraints:i,padding:n,viewpoint:s,size:o}=t,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let u=null;e instanceof xl?u=e:e.viewpoint?u=e.viewpoint:e.target&&e.target.declaredClass==="esri.Viewpoint"&&(u=e.target);let c=null;u!=null&&u.targetGeometry?c=u.targetGeometry:e instanceof Ne?c=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(c=await c1(e.center,t,r)||await c1(e.extent,t,r)||await c1(e.target,t,r)||await c1(e,t,r)),!c&&(s!=null&&s.targetGeometry)?c=s.targetGeometry:!c&&t.extent&&(c=t.extent),r||(r=eX(t.spatialReference||t.extent||c)),Hp()||fi(c.spatialReference,r)||Al(c.spatialReference,r)||await Ap();const h=l$(c,r),d="center"in h?h.center:h;t.pickClosestTarget!==!1&&d.type==="point"&&((_=s.targetGeometry)==null?void 0:_.type)==="point"&&(d.x=BJ(d.x,s.targetGeometry.x,d.spatialReference));let y=0;u?y=u.rotation:e.hasOwnProperty("rotation")?y=e.rotation:s&&(y=s.rotation);let v=0;if((u==null?void 0:u.targetGeometry)!=null&&u.targetGeometry.type==="point")v=u.scale;else if("scale"in e&&e.scale)v=e.scale;else if("zoom"in e&&e.zoom!==-1&&i&&i.effectiveLODs)v=i.zoomToScale(e.zoom);else if(Array.isArray(c)||c.type==="point"||c.type==="extent"&&c.width===0&&c.height===0){const x=l$(t.extent,r);v=x!=null?pm(x,a,y):t.extent?pm(t.extent,a,y):s.scale}else v=pm(l$(c.extent,r),a,y);const w=qCe(e.target??e);w&&(w.min&&w.min<v?v=w.min:w.max&&w.max>v&&(v=w.max));let b=new xl({targetGeometry:d,scale:v,rotation:y});return i&&(b=i.fit(b),i.constrainByGeometry(b),i.rotationEnabled||(b.rotation=s.rotation)),b}function ja(e,t){const r=e.targetGeometry,i=t.targetGeometry;return r.x=i.x,r.y=i.y,r.spatialReference=i.spatialReference,e.scale=t.scale,e.rotation=t.rotation,e}function WCe(e,t,r){return r?Fi(e,.5*(t[0]-r.right+r.left),.5*(t[1]-r.bottom+r.top)):fw(e,t,.5)}const JCe=function(){const e=qr();return function(t,r,i){const n=r.targetGeometry;uL(e,n);const s=.5*l0(r);return t.xmin=e[0]-s*i[0],t.ymin=e[1]-s*i[1],t.xmax=e[0]+s*i[0],t.ymax=e[1]+s*i[1],t.spatialReference=n.spatialReference,t}}();function ZCe(e,t,r,i,n){var s;return zC(e,t,r.center),e.scale=pm(r,i),(s=n==null?void 0:n.constraints)==null||s.constrain(e),e}function YCe(e,t,r,i){return hL(e,t,r,i),sL(e,e)}const rX=function(){const e=qr();return function(t,r,i){return lL(t,eOe(t,r),WCe(e,r,i))}}(),KCe=function(){const e=ju(),t=qr();return function(r,i,n,s){const o=l0(i),a=cL(i);return Fi(t,o,o),jK(e,t),eI(e,e,a),Tv(e,e,rX(t,n,s)),Tv(e,e,[0,s.top-s.bottom]),Fi(r,e[4],e[5])}}();function l0(e){return e.scale*XCe(e.targetGeometry)}function XCe(e){return e!=null&&$a(e.spatialReference)?1/(tX(e.spatialReference)*QK*XK):1}function cL(e){return DO(e.rotation)||0}function QCe(e){return $a(e)?tX(e)*QK*XK:1}function eOe(e,t){return fw(e,t,.5)}const pL=function(){const e=qr(),t=qr(),r=qr();return function(i,n,s,o,a,u){return qK(e,n),fw(t,s,.5*u),Fi(r,1/o*u,-1/o*u),aL(i,t),a&&eI(i,i,a),oL(i,i,r),Tv(i,i,e),i}}(),hL=function(){const e=qr();return function(t,r,i,n){const s=l0(r),o=cL(r);return uL(e,r.targetGeometry),pL(t,e,i,s,o,n)}}(),tOe=function(){const e=qr();return function(t,r,i,n){const s=l0(r);return uL(e,r.targetGeometry),pL(t,e,i,s,0,n)}}();function rOe(e){const t=Xn(e);return t?t.valid[1]-t.valid[0]:0}function iOe(e,t){return Math.round(rOe(e)/t)}const nOe=function(){const e=qr(),t=qr(),r=[0,0,0];return function(i,n,s){Mv(e,i,n),BC(e,e),Mv(t,i,s),BC(t,t),WK(r,e,t);let o=Math.acos(HK(e,t)/($x(e)*$x(t)))*zCe;return r[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),sOe=function(){const e=qr();return function(t,r,i,n){const s=t.targetGeometry;return ja(t,r),KCe(e,r,i,n),s.x+=e[0],s.y+=e[1],t}}(),zC=function(e,t,r){ja(e,t);const i=e.targetGeometry;return i.x=r.x,i.y=r.y,i.spatialReference=r.spatialReference,e},oOe=function(){const e=qr();return function(t,r,i,n,s){s||(s="center"),lL(e,i,n),fw(e,e,.5);const o=e[0],a=e[1];switch(s){case"center":Fi(e,0,0);break;case"left":Fi(e,-o,0);break;case"top":Fi(e,0,a);break;case"right":Fi(e,o,0);break;case"bottom":Fi(e,0,-a);break;case"top-left":Fi(e,-o,a);break;case"bottom-left":Fi(e,-o,-a);break;case"top-right":Fi(e,o,a);break;case"bottom-right":Fi(e,o,-a)}return rI(t,r,e),t}}();function yVe(e,t,r){return ja(e,t),e.rotation+=r,e}function aOe(e,t,r){return ja(e,t),e.rotation=r,e}const lOe=function(){const e=qr();return function(t,r,i,n,s){return ja(t,r),isNaN(i)||i===0||(nX(e,n,r,s),t.scale=r.scale*i,sX(e,e,t,s),rI(t,t,Fi(e,e[0]-n[0],n[1]-e[1]))),t}}();function cU(e,t,r){return ja(e,t),e.scale=r,e}const iX=function(){const e=qr();return function(t,r,i,n,s,o){return ja(t,r),isNaN(i)||i===0||(nX(e,s,r,o),t.scale=r.scale*i,t.rotation+=n,sX(e,e,t,o),rI(t,t,Fi(e,e[0]-s[0],s[1]-e[1]))),t}}(),mVe=function(){const e=qr(),t=qr();return function(r,i,n,s,o,a,u){return rX(t,a,u),VK(e,o,t),s?iX(r,i,n,s,e,a):lOe(r,i,n,e,a)}}(),nX=function(){const e=ju();return function(t,r,i,n){return xa(t,r,YCe(e,i,n,1))}}(),sX=function(){const e=ju();return function(t,r,i,n){return xa(t,r,hL(e,i,n,1))}}(),rI=function(){const e=qr(),t=ju();return function(r,i,n){ja(r,i);const s=l0(i),o=r.targetGeometry;return FK(t,cL(i)),oL(t,t,yw(s,s)),xa(e,n,t),o.x+=e[0],o.y+=e[1],r}}();let uOe=class{constructor(t,r,i,n){const s=t.targetGeometry,o=r.targetGeometry;n?typeof n=="string"&&(n=nbe(n)||Co.ease):n=Co.ease,this.easing=n,this.duration=i,this.sCenterX=s.x,this.sCenterY=s.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=o.x,this.tCenterY=o.y,this.tScale=r.scale,this.tRotation=r.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,r){const i=this.easing(r);let n,s,o,a;r>=1?(n=this.tCenterX,s=this.tCenterY,o=this.tRotation,a=this.tScale):(n=this.sCenterX+i*this.dCenterX,s=this.sCenterY+i*this.dCenterY,o=this.sRotation+i*this.dRotation,a=this.sScale+i*this.dScale),t.targetGeometry.x=n,t.targetGeometry.y=s,t.scale=a,t.rotation=o}},Yc=class extends De{constructor(t){super(t),this._animation=null,this.updateFunction=null,this.duration=200,this.transition=null,this.easing=Co.ease,this.view=null,this.viewpoint=new xl({targetGeometry:new Ae,scale:0,rotation:0}),this._updateTask=ym({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask=Tr(this._updateTask)}get animation(){return this._animation}set animation(t){this._animation=t,this.view&&(this.view.animation=t)}animate(t,r,i){this.stop();const n=this.viewpoint;ja(n,r),this.transition=new uOe(this.viewpoint,t.target,(i==null?void 0:i.duration)||this.duration,(i==null?void 0:i.easing)||this.easing);const s=()=>{var o,a;this.animation===t&&this._updateTask&&(t.state==="finished"&&((o=this.transition)==null||o.applyRatio(this.viewpoint,1),(a=this.view)!=null&&a.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,r){this.stop(),this.updateFunction=r,this.viewpoint=t;const i=new GC({target:t.clone()}),n=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(n,n),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){var i,n;const r=this.animation;if(r&&r.state!==GC.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else{const s=this.transition,o=(performance.now()-this._startTime)/s.duration,a=o>=1;s.applyRatio(this.viewpoint,o),a&&((i=this.animation)==null||i.finish())}(n=this.view)!=null&&n.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};l([p()],Yc.prototype,"duration",void 0),l([p()],Yc.prototype,"transition",void 0),l([p()],Yc.prototype,"easing",void 0),l([p()],Yc.prototype,"view",void 0),l([p()],Yc.prototype,"viewpoint",void 0),Yc=l([k("esri.views.2d.AnimationManager")],Yc);const cOe=Yc;let pOe=class{constructor(t){this.view=t,this._stationaryHandle=null,this._frameTaskHandle=null,this._updateParameters=null,this._updateRequested=!1,this.stationary=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters&&(this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions)},this.update=()=>{var o,a;if(this._updateRequested=!1,(o=this.view)==null?void 0:o.destroyed)return;const{allLayerViews:r,graphicsView:i,labelManager:n,state:{id:s}}=this.view;r.forEach(this._updateLayerView,this),n!=null&&(n.lastUpdateId!==s&&(n.viewChange(),n.lastUpdateId=s),n.updateRequested&&n.processUpdate(this._updateParameters)),i!=null&&(i.lastUpdateId!==s&&(i.viewChange(),i.lastUpdateId=s),i.updateRequested&&i.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||((a=this._frameTaskHandle)==null||a.pause())}}destroy(){this.stop()}start(){if(this._frameTaskHandle)return;const t=this.view;this.stationary=t.stationary,this._updateParameters={state:t.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:t.renderingOptions},this._stationaryHandle=Ue(()=>t.stationary,r=>{this.stationary=r,this.requestFrame()}),this._frameTaskHandle=ym(this),this.requestUpdate()}stop(){var t;this._frameTaskHandle&&(this._updateRequested=!1,(t=this._stationaryHandle)==null||t.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){var n;if(!t.attached)return void this.requestUpdate();const r=this.view.state,i=t.lastUpdateId;i!=null&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),i!==r.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=r.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&((n=t.layerViews)==null||n.forEach(this._updateLayerView,this))}},lS=class extends De{constructor(t){super(t),this._gotoTask=null}destroy(){this._gotoTask=null}async goTo(t,r){if(!t)return void oe.getLogger(this).error("#goTo()","target cannot be null or undefined");const i=new GC;this.view.animation=i,await gT(()=>this.view.ready,r);const n={animate:!0,...r},{extent:s,spatialReference:o,size:a,viewpoint:u,constraints:c,padding:h,allLayerViews:d}=this.view,y=HCe(t,{extent:s,spatialReference:o,size:a,viewpoint:u,constraints:c,padding:h,allLayerViews:d,pickClosestTarget:(r==null?void 0:r.pickClosestTarget)??!0});return i==null||i.update(y),this._gotoTask={},n.animate?this._gotoAnimated(y,n):this._gotoImmediate(y,n)}_gotoImmediate(t,r){const i=this._gotoTask,n=this.view.animation,s=t.then(o=>{if(Ut(r),i!==this._gotoTask)throw new z("view:goto-interrupted","Goto was interrupted");this.view.viewpoint=n.target=o,n.finish()});return this._cancellableGoTo(i,n,s,r)}_gotoAnimated(t,r){const i=this._gotoTask,n=this.view.animation;if(!n)return Promise.resolve();const s=t.then(o=>{if(Ut(r),i!==this._gotoTask)throw new z("view:goto-interrupted","Goto was interrupted");return n.update(o),this.view.animationManager.animate(n,this.view.viewpoint,r),n.when().then(()=>{},()=>{})});return this._cancellableGoTo(i,n,s,r)}_cancellableGoTo(t,r,i,n){const s=()=>t===this._gotoTask;return hl(i,n).finally(()=>{s()&&(r.done||r.stop())})}};l([p({constructOnly:!0})],lS.prototype,"view",void 0),lS=l([k("esri.views.2d.GoToManager")],lS);function ur(){return Promise.all([ge(()=>import("./webglDeps-H7qwN1d1.js"),__vite__mapDeps([138,91,1,2,90,139,140])),ge(()=>import("./mapViewDeps-CsV0qR1C.js"),__vite__mapDeps([141,1,2,92,93,40,94,89,90,91,95,45,96,97,142,143,144,145,140,119,138,139,146,101,147,88,7,69,25,148,149,48,150,39,151,152,153,154,155,156,157,158,159,104,160]))])}const ug=()=>ur().then(()=>ge(()=>import("./TileLayerView2D-C8D50RNM.js"),__vite__mapDeps([161,1,2,92,93,40,94,89,90,91,95,45,96,97,143,144,145,140,119,146,101,147,88,7,69,25,153,149,48,154,155,104,162,163,159,164,165,157,158,166,167,168]))),Zf=()=>ur().then(()=>ge(()=>import("./FeatureLayerView2D-K0WWBk9y.js").then(e=>e.F),__vite__mapDeps([169,1,2,144,96,90,164,158,92,93,40,94,89,91,95,45,97,159,145,140,119,98,142,143,153,170,168,166]))),pU={"base-dynamic":()=>ur().then(()=>ge(()=>import("./BaseDynamicLayerView2D-CxLhJZl1.js"),__vite__mapDeps([171,1,2,172,145,89,90,91,140,144,96,119,40,164,173,163,166]))),"base-tile":ug,"bing-maps":ug,catalog:()=>ur().then(()=>ge(()=>import("./CatalogLayerView2D-B7PhCfQ9.js"),__vite__mapDeps([174,1,2,164,144,96,90]))),"catalog-dynamic-group":()=>ur().then(()=>ge(()=>import("./CatalogDynamicGroupLayerView2D-DICMrhPJ.js"),__vite__mapDeps([175,1,2,164,144,96,90]))),"catalog-footprint":()=>ur().then(()=>ge(()=>import("./CatalogFootprintLayerView2D-CsP9liPJ.js"),__vite__mapDeps([176,1,2,169,144,96,90,164,158,92,93,40,94,89,91,95,45,97,159,145,140,119,98,142,143,153,170,168,166]))),csv:Zf,"geo-rss":()=>ur().then(()=>ge(()=>import("./GeoRSSLayerView2D-CRUyVzqp.js"),__vite__mapDeps([177,1,2,164,144,96,90,156,157,158,92,93,40,94,89,91,95,45,97,159,145,140,119,153,104,154,88,7,69,25,155]))),feature:Zf,geojson:Zf,graphics:()=>ur().then(()=>ge(()=>import("./GraphicsLayerView2D-DuIQ8Amz.js"),__vite__mapDeps([178,1,2,96,164,144,90,156,157,158,92,93,40,94,89,91,95,45,97,159,145,140,119,153,104,154,88,7,69,25,155,170]))),group:()=>ur().then(()=>ge(()=>import("./GroupLayerView2D-Bby6bPiL.js"),__vite__mapDeps([179,1,2,164,144,96,90]))),imagery:()=>ur().then(()=>ge(()=>import("./ImageryLayerView2D-CmFjuQSK.js"),__vite__mapDeps([180,1,2,181,91,90,140,145,89,144,96,119,40,164,154,92,93,94,95,45,97,88,7,69,25,153,155,165,157,158,159,104,172,163,173,110,168,166]))),"imagery-tile":()=>ur().then(()=>ge(()=>import("./ImageryTileLayerView2D-DoDTuPai.js"),__vite__mapDeps([182,1,2,181,91,90,140,145,89,144,96,119,40,164,183,159,184,110,168,166]))),kml:()=>ur().then(()=>ge(()=>import("./KMLLayerView2D-okK7_Ztw.js"),__vite__mapDeps([185,1,2,186,163,144,96,90,172,145,89,91,140,119,40,164,156,157,158,92,93,94,95,45,97,159,153,104,154,88,7,69,25,155,110,148,138,139,149,48,147,143,150,183]))),"knowledge-graph":()=>ur().then(()=>ge(()=>import("./KnowledgeGraphLayerView2D-CTYgxsoW.js"),__vite__mapDeps([187,1,2,164,144,96,90]))),"link-chart":()=>ur().then(()=>ge(()=>import("./KnowledgeGraphLayerView2D-CTYgxsoW.js"),__vite__mapDeps([187,1,2,164,144,96,90]))),"knowledge-graph-sublayer":Zf,"map-image":()=>ur().then(()=>ge(()=>import("./MapImageLayerView2D-BclaJFse.js"),__vite__mapDeps([188,1,2,172,145,89,90,91,140,144,96,119,40,164,154,92,93,94,95,45,97,88,7,69,25,153,155,165,157,158,159,104,173,163,166,167,168]))),"map-notes":()=>ur().then(()=>ge(()=>import("./MapNotesLayerView2D-B6AmjgR-.js"),__vite__mapDeps([189,1,2,96,164,144,90,156,157,158,92,93,40,94,89,91,95,45,97,159,145,140,119,153,104,154,88,7,69,25,155]))),media:()=>ur().then(()=>ge(()=>import("./MediaLayerView2D-UINaZJf3.js"),__vite__mapDeps([190,1,2,191,155,29,92,93,40,94,89,90,91,95,45,96,97,143,144,145,140,119,146,101,147,88,7,69,25,153,149,48,154,104,152,164]))),"ogc-feature":()=>ur().then(()=>ge(()=>import("./OGCFeatureLayerView2D-DxiFKoVe.js"),__vite__mapDeps([192,1,2,169,144,96,90,164,158,92,93,40,94,89,91,95,45,97,159,145,140,119,98,142,143,153,170,168,166]))),"open-street-map":ug,"oriented-imagery":Zf,route:()=>ur().then(()=>ge(()=>import("./RouteLayerView2D-hlC6JWk_.js"),__vite__mapDeps([193,1,2,194,96,164,144,90,156,157,158,92,93,40,94,89,91,95,45,97,159,145,140,119,153,104,154,88,7,69,25,155]))),stream:()=>ur().then(()=>ge(()=>import("./StreamLayerView2D-DIkpqXHC.js"),__vite__mapDeps([195,1,2,169,144,96,90,164,158,92,93,40,94,89,91,95,45,97,159,145,140,119,98,142,143,153,170,168,166]))),"subtype-group":()=>ur().then(()=>ge(()=>import("./SubtypeGroupLayerView2D-BK4w-XM2.js"),__vite__mapDeps([196,1,2,169,144,96,90,164,158,92,93,40,94,89,91,95,45,97,159,145,140,119,98,142,143,153,170,168,166]))),tile:ug,"vector-tile":()=>ur().then(()=>ge(()=>import("./VectorTileLayerView2D-GSnaL1w6.js"),__vite__mapDeps([197,1,2,94,90,151,143,97,91,140,119,145,89,144,96,40,159,68,120,164]))),video:()=>ur().then(()=>ge(()=>import("./VideoLayerView2D-C9mfIPEn.js"),__vite__mapDeps([198,1,2,199,164,144,96,90,156,157,158,92,93,40,94,89,91,95,45,97,159,145,140,119,153,104,154,88,7,69,25,155]))),wcs:()=>ur().then(()=>ge(()=>import("./ImageryTileLayerView2D-DoDTuPai.js"),__vite__mapDeps([182,1,2,181,91,90,140,145,89,144,96,119,40,164,183,159,184,110,168,166]))),"web-tile":ug,wfs:Zf,wms:()=>ur().then(()=>ge(()=>import("./WMSLayerView2D-DVY3MsXi.js"),__vite__mapDeps([200,1,2,172,145,89,90,91,140,144,96,119,40,164,173,163,166]))),wmts:()=>ur().then(()=>ge(()=>import("./WMTSLayerView2D-D4G91Is-.js"),__vite__mapDeps([201,1,2,162,163,144,96,90,145,89,91,140,119,40,159,164,166]))),"line-of-sight":null,"base-elevation":null,"building-scene":null,dimension:null,elevation:null,"integrated-mesh":null,"integrated-mesh-3dtiles":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function hOe(e){const t=e.declaredClass?e.declaredClass.slice(e.declaredClass.lastIndexOf(".")+1):"Unknown",r=t.replaceAll(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new z(`${r}:view-not-supported`,`${t} is not supported in 2D`)}const hU={hasLayerViewModule:e=>pU[e.type]!=null,importLayerView:e=>{const t=pU[e.type];if(t==null)throw hOe(e);return t(e)}};function dOe(e,t){const{spatialReference:r}=t,i=[t.x,t.y];let n=Number.POSITIVE_INFINITY,s=0,o=0;const a=[0,0],u=e.type==="extent"?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:e.rings;for(const c of u)for(let h=0;h<c.length-1;h++){Ece(a,i,c,h);const d=tI(i,a);d<n&&(n=d,s=a[0],o=a[1])}return{coordinate:new Ae({x:s,y:o,spatialReference:r}),distance:n}}var qC;let Md=qC=class extends d4(De){constructor(e){super(e),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){if(this.geometry==null||!this.spatialReference)return null;if(!this.spatialReference.equals(this.geometry.spatialReference))try{return Wp(this.geometry,this.spatialReference)}catch(e){return oe.getLogger(this).error("#constraints.geometry","could not project the geometry to the view's spatial reference",{geometry:this.geometry,spatialReference:this.spatialReference,error:e}),null}return this.geometry}constrain(e,t){if(this.normalizedGeometry==null)return e;const r=e.targetGeometry;if(this.normalizedGeometry.type==="extent"?Kx(this.normalizedGeometry,r):DG(this.normalizedGeometry,r))return e;const{coordinate:i}=dOe(this.normalizedGeometry,r);return i&&(e.targetGeometry=i),e}clone(){var e,t;return new qC({geometry:(e=this.geometry)==null?void 0:e.clone(),spatialReference:(t=this.spatialReference)==null?void 0:t.clone()})}};l([p({constructOnly:!0})],Md.prototype,"geometry",void 0),l([p({readOnly:!0})],Md.prototype,"normalizedGeometry",null),l([p({constructOnly:!0})],Md.prototype,"spatialReference",void 0),Md=qC=l([k("esri.views.2d.constraints.GeometryConstraint")],Md);var HC;let p1=HC=class extends d4(De){constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(e,t){return this.enabled&&t&&(this.rotationEnabled||(e.rotation=t.rotation)),e}clone(){return new HC({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};l([p()],p1.prototype,"enabled",void 0),l([p()],p1.prototype,"rotationEnabled",void 0),p1=HC=l([k("esri.views.2d.constraints.RotationConstraint")],p1);const oX=p1;var WC;let fs=WC=class extends d4(De){constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let e,{lods:t,minScale:r,maxScale:i,minZoom:n,maxZoom:s}=this,o=-1,a=-1,u=!1,c=!1;if(r!==0&&i!==0&&r<i&&([r,i]=[i,r]),!(t!=null&&t.length))return this._set("effectiveMinScale",r),void this._set("effectiveMaxScale",i);t=t.map(h=>h.clone()),t.sort((h,d)=>d.scale-h.scale),t.forEach((h,d)=>h.level=d);for(const h of t)!u&&r>0&&r>=h.scale&&(o=h.level,u=!0),!c&&i>0&&i>=h.scale&&(a=e?e.level:-1,c=!0),e=h;n===-1&&(n=r===0?0:o),s===-1&&(s=i===0?t.length-1:a),n=Math.max(n,0),n=Math.min(n,t.length-1),s=Math.max(s,0),s=Math.min(s,t.length-1),n>s&&([n,s]=[s,n]),r=t[n].scale,i=t[s].scale,t.splice(0,n),t.splice(s-n+1,t.length),t.forEach((h,d)=>{this._lodByScale[h.scale]=h,this._scales[d]=h.scale}),this._set("effectiveLODs",t),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",s),this._set("effectiveMinScale",r),this._set("effectiveMaxScale",i)}constrain(e,t){if(t&&e.scale===t.scale)return e;const r=this.effectiveMinScale,i=this.effectiveMaxScale,n=e.targetGeometry,s=t&&t.targetGeometry,o=i!==0&&e.scale<i,a=r!==0&&e.scale>r;if(o||a){const u=a?r:i;if(t&&s){const c=(u-t.scale)/(e.scale-t.scale);n.x=s.x+(n.x-s.x)*c,n.y=s.y+(n.y-s.y)*c}e.scale=u}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),r=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(r>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const r=Math.round(e-.5),i=Math.round(e);return t[i]+(i-e)*(t[r]-t[i])}scaleToZoom(e){if(!this.effectiveLODs)return-1;const t=this._scales;let r,i;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let n=0;n<t.length-1;n++){if(r=t[n],i=t[n+1],i===e)return n+this.effectiveMinZoom+1;if(r>e&&i<e)return n+this.effectiveMinZoom+1-(e-i)/(r-i)}return-1}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const r=Math.round(this.scaleToZoom(e));return this.zoomToScale(r+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const r=Math.round(this.scaleToZoom(e));return this.zoomToScale(r-1)}clone(){return new WC({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce((t,r)=>Math.abs(r-e)<=Math.abs(t-e)?r:t,this._scales[0])),this._lodByScale[e].scale}};l([p({readOnly:!0})],fs.prototype,"effectiveLODs",void 0),l([p({readOnly:!0})],fs.prototype,"effectiveMinZoom",void 0),l([p({readOnly:!0})],fs.prototype,"effectiveMaxZoom",void 0),l([p({readOnly:!0})],fs.prototype,"effectiveMinScale",void 0),l([p({readOnly:!0})],fs.prototype,"effectiveMaxScale",void 0),l([p()],fs.prototype,"lods",void 0),l([p()],fs.prototype,"minZoom",void 0),l([p()],fs.prototype,"maxZoom",void 0),l([p()],fs.prototype,"minScale",void 0),l([p()],fs.prototype,"maxScale",void 0),l([p()],fs.prototype,"snapToZoom",void 0),fs=WC=l([k("esri.views.2d.constraints.ZoomConstraint")],fs);const aX=fs,fOe={base:null,key:"type",typeMap:{extent:Ne,polygon:Ss}};let Vr=class extends De{constructor(t){super(t),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0,this.customConstraints=new $e}destroy(){this.view=null}get effectiveLODs(){return this._zoom.effectiveLODs}get effectiveMinScale(){return this._zoom.effectiveMinScale}get effectiveMaxScale(){return this._zoom.effectiveMaxScale}get effectiveMinZoom(){return this._zoom.effectiveMinZoom}get effectiveMaxZoom(){return this._zoom.effectiveMaxZoom}set geometry(t){t?this._set("geometry",t):this._set("geometry",null)}get version(){var t,r,i;return`${(t=this._zoom)==null?void 0:t.uid}/${(r=this._rotation)==null?void 0:r.uid}/${(i=this._geometry)==null?void 0:i.uid}`}get _geometry(){var r,i;const t=this._get("_geometry");return t&&this.geometry===t.geometry&&((r=this.view)==null?void 0:r.constraintsInfo.spatialReference)===t.spatialReference?t:new Md({geometry:this.geometry,spatialReference:(i=this.view)==null?void 0:i.constraintsInfo.spatialReference})}get _rotation(){return new oX({rotationEnabled:this.rotationEnabled})}get _zoom(){var u;const t=this._get("_zoom"),r=this.lods||((u=this.view)==null?void 0:u.constraintsInfo.lods),i=this.minZoom,n=this.maxZoom,s=this.minScale,o=this.maxScale,a=this.snapToZoom;return t&&t.lods===r&&t.minZoom===i&&t.maxZoom===n&&t.minScale===s&&t.maxScale===o&&t.snapToZoom===a?t:new aX({lods:r,minZoom:i,maxZoom:n,minScale:s,maxScale:o,snapToZoom:a})}canZoomInTo(t){const r=this.effectiveMaxScale;return r===0||t>=r}canZoomOutTo(t){const r=this.effectiveMinScale;return r===0||t<=r}constrain(t,r){return this._zoom.constrain(t,r),this._rotation.constrain(t,r),this._geometry.constrain(t,r),this.customConstraints.forEach(i=>i.constrain(t,r)),t}constrainByGeometry(t){return this._geometry.constrain(t),this.customConstraints.forEach(r=>{var i;return(i=r.applyPanConstraint)==null?void 0:i.call(r,t)}),t}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};l([p({readOnly:!0})],Vr.prototype,"effectiveLODs",null),l([p({readOnly:!0})],Vr.prototype,"effectiveMinScale",null),l([p({readOnly:!0})],Vr.prototype,"effectiveMaxScale",null),l([p({readOnly:!0})],Vr.prototype,"effectiveMinZoom",null),l([p({readOnly:!0})],Vr.prototype,"effectiveMaxZoom",null),l([p({types:fOe,value:null})],Vr.prototype,"geometry",null),l([p({type:[Et]})],Vr.prototype,"lods",void 0),l([p()],Vr.prototype,"minScale",void 0),l([p()],Vr.prototype,"maxScale",void 0),l([p()],Vr.prototype,"minZoom",void 0),l([p()],Vr.prototype,"maxZoom",void 0),l([p()],Vr.prototype,"rotationEnabled",void 0),l([p()],Vr.prototype,"snapToZoom",void 0),l([p({type:$e})],Vr.prototype,"customConstraints",void 0),l([p()],Vr.prototype,"view",void 0),l([p({readOnly:!0})],Vr.prototype,"version",null),l([p({type:Md,readOnly:!0})],Vr.prototype,"_geometry",null),l([p({type:oX})],Vr.prototype,"_rotation",null),l([p({readOnly:!0,type:aX})],Vr.prototype,"_zoom",null),Vr=l([k("esri.views.2d.MapViewConstraints")],Vr);const lX=Vr;function bc(e,t){return[e,t]}function vh(e,t,r){return e[0]=t,e[1]=r,e}function yOe(e,t,r,i,n){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}const Xo=new Rl("0/0/0/0");let mOe=class uX{static create(t,r,i=null){const n=Xn(t.spatialReference),s=r.origin||bc(t.origin.x,t.origin.y),o=bc(t.size[0]*r.resolution,t.size[1]*r.resolution),a=bc(-1/0,-1/0),u=bc(1/0,1/0),c=bc(1/0,1/0);i!=null&&(vh(a,Math.max(0,Math.floor((i.xmin-s[0])/o[0])),Math.max(0,Math.floor((s[1]-i.ymax)/o[1]))),vh(u,Math.max(0,Math.floor((i.xmax-s[0])/o[0])),Math.max(0,Math.floor((s[1]-i.ymin)/o[1]))),vh(c,u[0]-a[0]+1,u[1]-a[1]+1));const{cols:h,rows:d}=r;let y,v,w,b;return!i&&h&&d&&(vh(a,h[0],d[0]),vh(u,h[1],d[1]),vh(c,h[1]-h[0]+1,d[1]-d[0]+1)),t.isWrappable?(y=bc(Math.ceil(Math.round((n.valid[1]-n.valid[0])/r.resolution)/t.size[0]),c[1]),v=bc(Math.floor((n.origin[0]-s[0])/o[0]),a[1]),w=bc(y[0]+v[0]-1,u[1]),b=!0):(v=a,w=u,y=c,b=!1),new uX(r.level,r.resolution,r.scale,s,a,u,c,o,v,w,y,b)}constructor(t,r,i,n,s,o,a,u,c,h,d,y){this.level=t,this.resolution=r,this.scale=i,this.origin=n,this.first=s,this.last=o,this.size=a,this.norm=u,this.worldStart=c,this.worldEnd=h,this.worldSize=d,this.wrap=y}normalizeCol(t){if(!this.wrap)return t;const r=this.worldSize[0];return t<0?r-1-Math.abs((t+1)%r):t%r}denormalizeCol(t,r){return this.wrap?this.worldSize[0]*r+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,r,i=!1){Xo.set(r);const n=i?Xo.col:this.denormalizeCol(Xo.col,Xo.world),s=Xo.row;return yOe(t,this.getXForColumn(n),this.getYForRow(s+1),this.getXForColumn(n+1),this.getYForRow(s)),t}getTileCoords(t,r,i=!1){Xo.set(r);const n=i?Xo.col:this.denormalizeCol(Xo.col,Xo.world);return Array.isArray(t)?vh(t,this.getXForColumn(n),this.getYForRow(Xo.row)):(t.x=this.getXForColumn(n),t.y=this.getYForRow(Xo.row)),t}},$v=class{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}*keys(){const t=this.lodInfo;for(const{row:r,colFrom:i,colTo:n}of this.spans)for(let s=i;s<=n;s++){const o=t.getWorldForColumn(s);yield new Rl(t.level,r,t.normalizeCol(s),o)}}forEach(t,r){const{spans:i,lodInfo:n}=this,{level:s}=n;if(i.length!==0)for(const{row:o,colFrom:a,colTo:u}of i)for(let c=a;c<=u;c++)t.call(r,s,o,n.normalizeCol(c),n.getWorldForColumn(c))}};$v.pool=new Np($v);let u$=class{constructor(t,r,i){this.row=t,this.colFrom=r,this.colTo=i}};const dr=new Rl("0/0/0/0");let gOe=class cX{static create(t,r){t[1]>r[1]&&([t,r]=[r,t]);const[i,n]=t,[s,o]=r,a=s-i,u=o-n,c=u!==0?a/u:0,h=(Math.ceil(n)-n)*c,d=(Math.floor(n)-n)*c;return new cX(i,Math.floor(n),Math.ceil(o),c,a<0?h:d,a<0?d:h,a<0?s:i,a<0?i:s)}constructor(t,r,i,n,s,o,a,u){this.x=t,this.ymin=r,this.ymax=i,this.invM=n,this.leftAdjust=s,this.rightAdjust=o,this.leftBound=a,this.rightBound=u}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}};const Cs=[[0,0],[0,0],[0,0],[0,0]],vOe=1e-6;let wOe=class{constructor(t,r=null,i=t.lods[0].level,n=t.lods[t.lods.length-1].level){this.tileInfo=t,this.fullExtent=r,this.scales=[],this._infoByScale={},this._infoByLevel={};const s=t.lods.filter(a=>a.level>=i&&a.level<=n);this.minScale=s[0].scale,this.maxScale=s[s.length-1].scale;const o=this._lodInfos=s.map(a=>mOe.create(t,a,r));s.forEach((a,u)=>{this._infoByLevel[a.level]=o[u],this._infoByScale[a.scale]=o[u],this.scales[u]=a.scale},this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel[typeof t=="number"?t:t.level]}getTileBounds(t,r,i=!1){dr.set(r);const n=this._infoByLevel[dr.level];return n?n.getTileBounds(t,dr,i):t}getTileCoords(t,r,i=!1){dr.set(r);const n=this._infoByLevel[dr.level];return n?n.getTileCoords(t,dr,i):t}getTileCoverage(t,r=192,i=!0,n="closest"){if(!i&&(t.scale>this.minScale||t.scale<this.maxScale))return null;const s=n==="closest"?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),o=$v.pool.acquire(s),a=this._wrap;let u,c,h,d=1/0,y=-1/0;const v=o.spans;Cs[0][0]=Cs[0][1]=Cs[1][1]=Cs[3][0]=-r,Cs[1][0]=Cs[2][0]=t.size[0]+r,Cs[2][1]=Cs[3][1]=t.size[1]+r;for(const x of Cs)t.toMap(x,x),x[0]=s.getColumnForX(x[0]),x[1]=s.getRowForY(x[1]);const w=[];let b=3;for(let x=0;x<4;x++){if(Cs[x][1]===Cs[b][1]){b=x;continue}const T=gOe.create(Cs[x],Cs[b]);d=Math.min(T.ymin,d),y=Math.max(T.ymax,y),w[T.ymin]===void 0&&(w[T.ymin]=[]),w[T.ymin].push(T),b=x}if(d==null||y==null||y-d>100)return null;let _=[];for(u=d;u<y;){w[u]!=null&&(_=_.concat(w[u])),c=1/0,h=-1/0;for(let x=_.length-1;x>=0;x--){const T=_[x];c=Math.min(c,T.getLeftCol()),h=Math.max(h,T.getRightCol())}if(c=Math.floor(c),h=Math.floor(h),u>=s.first[1]&&u<=s.last[1])if(a)if(s.size[0]<s.worldSize[0]){const x=Math.floor(h/s.worldSize[0]);for(let T=Math.floor(c/s.worldSize[0]);T<=x;T++)v.push(new u$(u,Math.max(s.getFirstColumnForWorld(T),c),Math.min(s.getLastColumnForWorld(T),h)))}else v.push(new u$(u,c,h));else c>s.last[0]||h<s.first[0]||(c=Math.max(c,s.first[0]),h=Math.min(h,s.last[0]),v.push(new u$(u,c,h)));u+=1;for(let x=_.length-1;x>=0;x--){const T=_[x];T.ymax>=u?T.incrRow():_.splice(x,1)}}return o}getTileParentId(t){dr.set(t);const r=this._infoByLevel[dr.level],i=this._lodInfos.indexOf(r)-1;return i<0?null:(this._getTileIdAtLOD(dr,this._lodInfos[i],dr),dr.id)}getTileResolution(t){const r=this._infoByLevel[typeof t=="object"?t.level:t];return r?r.resolution:-1}getTileScale(t){const r=this._infoByLevel[t.level];return r?r.scale:-1}intersects(t,r){dr.set(r);const i=this._infoByLevel[dr.level],n=t.lodInfo;if(n.resolution>i.resolution){this._getTileIdAtLOD(dr,n,dr);const o=n.denormalizeCol(dr.col,dr.world);for(const a of t.spans)if(a.row===dr.row&&a.colFrom<=o&&a.colTo>=o)return!0}if(n.resolution<i.resolution){const[o,a,u,c]=t.spans.reduce((b,_)=>(b[0]=Math.min(b[0],_.row),b[1]=Math.max(b[1],_.row),b[2]=Math.min(b[2],_.colFrom),b[3]=Math.max(b[3],_.colTo),b),[1/0,-1/0,1/0,-1/0]),h=i.denormalizeCol(dr.col,dr.world),d=n.getColumnForX(i.getXForColumn(h)),y=n.getRowForY(i.getYForRow(dr.row)),v=n.getColumnForX(i.getXForColumn(h+1))-1,w=n.getRowForY(i.getYForRow(dr.row+1))-1;return!(d>c||v<u||y>a||w<o)}const s=n.denormalizeCol(dr.col,dr.world);return t.spans.some(o=>o.row===dr.row&&o.colFrom<=s&&o.colTo>=s)}normalizeBounds(t,r,i){if(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],this._wrap){const n=Xn(this.tileInfo.spatialReference),s=-i*(n.valid[1]-n.valid[0]);t[0]+=s,t[2]+=s}return t}getSmallestInfoForScale(t){const r=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>r[0])return this._infoByScale[r[0]];for(let i=1;i<r.length-1;i++)if(t>r[i]+vOe)return this._infoByScale[r[i-1]];return this._infoByScale[r[r.length-1]]}getClosestInfoForScale(t){const r=this.scales;return this._infoByScale[t]||(t=r.reduce((i,n)=>Math.abs(n-t)<Math.abs(i-t)?n:i,r[0])),this._infoByScale[t]}scaleToLevel(t){const r=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let i=r.length-1;i>=0;i--)if(t<r[i])return i===r.length-1?this._infoByScale[r[r.length-1]].level:this._infoByScale[r[i]].level+(r[i]-t)/(r[i]-r[i+1]);return this._infoByScale[r[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,r,i){const n=this._infoByLevel[i.level];return t.set(i),r.resolution<n.resolution?null:(r.resolution===n.resolution||(t.level=r.level,t.col=Math.floor(i.col*n.resolution/r.resolution+.01),t.row=Math.floor(i.row*n.resolution/r.resolution+.01)),t)}},bOe=class{constructor(t,r){this.item=t,this.controller=r,this.promise=null}},_Oe=class{constructor(t){this._schedule=null,this._task=null,this._deferreds=new oS,this._controllers=new oS,this._processingItems=new oS,this._pausedSignal=xK(!1),this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new vx(t.peeker),this.process=t.process;const r=t.scheduler;t.priority&&r&&(this._task=r.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule=Tr(this._schedule),this._task=Tr(this._task)}get updating(){var t;return!!((t=this._task)!=null&&t.updating)||this.running}get length(){return this._processingItems.size+this._queue.length}abort(t){const r=this._controllers.get(t);r&&r.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach(r=>t.push(r)),this._controllers.clear(),t.forEach(r=>r.abort()),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach((r,i)=>t(i))}get(t){const r=this._deferreds.get(t);return r?r.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._pausedSignal.value||(this._pausedSignal.value=!0,this._cancelNext())}push(t,r){const i=this.get(t);if(i)return i;const n=new AbortController;let s=null;r&&(s=bs(r,()=>n.abort()));const o=()=>{const h=this._processingItems.get(t);h&&h.controller.abort(),a(),c.reject(Pr())},a=()=>{u.remove(),s!=null&&s.remove(),this._removeItem(t),this._queue.remove(t),this._scheduleNext()},u=vO(n.signal,o),c=ro();return this._deferreds.set(t,c),this._controllers.set(t,n),c.promise.then(a,a),this._queue.push(t),this._scheduleNext(),c.promise}last(){return this._queue.last()}lastPromise(){const t=this.last();return t?this.get(t):null}peek(){return this._queue.peek()}popLast(){var r;const t=this._queue.popLast();return t&&((r=this._deferreds.get(t))==null||r.reject(Pr("Removed from queue")),this._removeItem(t)),t}reset(){const t=[];this._processingItems.forEach(r=>t.push(r)),this._processingItems.clear();for(const r of t)this._queue.push(r.item),r.controller.abort();this._scheduleNext()}resume(){this._pausedSignal.value&&(this._pausedSignal.value=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._pausedSignal.value&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_removeItem(t){this._deferreds.delete(t),this._controllers.delete(t),this._processingItems.delete(t)}_scheduleNext(){this._task||this._pausedSignal.value||this._schedule||(this._schedule=Bm(()=>{this._schedule=null,this._next()}))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,r){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(r))}_processError(t,r){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(r))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(t==null)return;let r;const i=new AbortController,n=new bOe(t,i);this._processingItems.set(t,n);try{r=this.process(t,i.signal)}catch(s){this._processError(n,s)}Dp(r)?(n.promise=r,r.then(s=>this._processResult(n,s),s=>this._processError(n,s))):this._processResult(n,r)}get test(){return{update:t=>this.runTask(t)}}};function SOe(e,t){return e.length=0,t.forEach(r=>e.push(r)),e}const c$=new Set,w_=[],Yf=new Map,dU=[0,0];let Kc=class extends De{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:r,strategy:i}=this;this._queue=new _Oe({concurrency:t,process:(n,s)=>{const o=this._keyToItem.get(n);return r(o,{signal:s})},peeker:i==="scale-first"?n=>this._peekByScaleFirst(n):n=>this._peekByCenterFirst(n)})}destroy(){this.clear(),this._queue=cr(this._queue)}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}abort(t){const r=typeof t=="string"?t:t.id;this._queue.abort(r)}clear(){this._queue.clear(),this._keyToItem.clear()}has(t){return typeof t=="string"?this._keyToItem.has(t):this._keyToItem.has(t.id)}isOngoing(t){const r=typeof t=="string"?t:t.id;return this.has(r)&&this._queue.isOngoing(r)}pause(){this._queue.pause()}push(t){const r=t.key.id;if(this._queue.has(r))return this._queue.get(r);const i=this._queue.push(r),n=()=>{this._keyToItem.delete(r)};return this._keyToItem.set(r,t),i.then(n,n),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const r=this.tileInfoView;let i=Number.NEGATIVE_INFINITY,n=Number.POSITIVE_INFINITY;t.forEach(h=>{const d=this._keyToItem.get(h),y=this.tileInfoView.getTileScale(d.key);Yf.has(y)||(Yf.set(y,[]),i=Math.max(y,i),n=Math.min(y,n)),Yf.get(y).push(d.key),c$.add(y)});let s=this.state.scale;Yf.has(s)||(SOe(w_,c$),w_.sort((h,d)=>h-d),s=w_.reduce((h,d)=>Math.abs(d-s)<Math.abs(h-s)?d:h,w_[0])),s=Math.min(s,i),s=Math.max(s,n);const o=Yf.get(s),a=r.getClosestInfoForScale(s),u=a.getColumnForX(this.state.center[0]),c=a.getRowForY(this.state.center[1]);return o.sort((h,d)=>{const y=a.denormalizeCol(h.col,h.world),v=a.denormalizeCol(d.col,d.world);return Math.sqrt((u-y)*(u-y)+(c-h.row)*(c-h.row))-Math.sqrt((u-v)*(u-v)+(c-d.row)*(c-d.row))}),c$.clear(),Yf.clear(),o[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const r=this.tileInfoView,i=this.state.center;let n,s=Number.POSITIVE_INFINITY;return t.forEach(o=>{const a=this._keyToItem.get(o);r.getTileCoords(dU,a.key);const u=tI(dU,i);u<s&&(s=u,n=a.key)}),n.id}};l([p({constructOnly:!0})],Kc.prototype,"concurrency",void 0),l([p({constructOnly:!0})],Kc.prototype,"process",void 0),l([p()],Kc.prototype,"state",void 0),l([p({constructOnly:!0})],Kc.prototype,"strategy",void 0),l([p({constructOnly:!0})],Kc.prototype,"tileInfoView",void 0),Kc=l([k("esri.views.2d.tiling.TileQueue")],Kc);const EVe=Kc;let xOe=class{constructor(t,r,i){this.maxSize=t,this._tileInfoView=r,this._removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}clear(){this._tilePerId.clear(),this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const r=this._tilePerId.get(t);if(!r)return;const i=r.key.level,n=this._tileKeysPerLevel[i];fU(this._tilePerId,t);for(let s=0;s<n.length;s++)if(n[s].id===t){n.splice(s,1);break}return r.visible=!0,r}add(t){t.visible=!1;const r=t.key,i=r.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,t);const n=r.level;this._tileKeysPerLevel[n]||(this._tileKeysPerLevel[n]=[]),this._tileKeysPerLevel[n].push(r)}prune(t,r,i){let n=this._tilePerId.size;if(n<=this.maxSize)return;let s=this._tileKeysPerLevel.length-1;for(;n>this.maxSize&&s>=0;)s!==t&&(n=this._pruneAroundCenterTile(n,r,i,s)),s--;n>this.maxSize&&(n=this._pruneAroundCenterTile(n,r,i,t))}_pruneAroundCenterTile(t,r,i,n){const s=this._tileKeysPerLevel[n];if(!s||s.length===0)return t;const{size:o,origin:a}=this._tileInfoView.tileInfo,u=i*o[0],c=i*o[1],h=[0,0],d=[0,0];for(s.sort((y,v)=>(h[0]=a.x+u*(y.col+.5),h[1]=a.y-c*(y.row+.5),d[0]=a.x+u*(v.col+.5),d[1]=a.y-c*(v.row+.5),Mx(h,r)-Mx(d,r)));s.length>0;){const y=s.pop();if(this._removeTile(y.id),--t===this.maxSize)break}return t}_removeTile(t){const r=this._tilePerId.get(t);this._removedFunc&&r&&this._removedFunc(r),fU(this._tilePerId,t)}};function fU(e,t){e.delete(t)}const wh=new Rl(0,0,0,0),Zl=new Map,bh=[],p$=[];let RVe=class{constructor(t){this._previousScale=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,t.resampling!=null&&(this.resampling=t.resampling),t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),t.buffer!=null&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new xOe(t.cacheSize,this.tileInfoView,r=>{this.releaseTile(r)}))}destroy(){this.tileIndex.clear()}update(t){var x,T;const{resampling:r,tileIndex:i}=this,{scale:n,center:s,resolution:o}=t.state,{minScale:a,maxScale:u}=this.tileInfoView,c=!t.stationary&&n>this._previousScale;if(this._previousScale=n,!r&&(n>a||n<u))return this.tiles.length=0,void this.clear();const h=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.resampling,this.coveragePolicy);if(!h)return this.tiles.length=0,void this.clear();const{spans:d,lodInfo:y}=h,{level:v}=y;this.tiles.length=0,i.forEach(I=>I.visible=!0);let w=0,b=0;if(d.length>0)for(const{row:I,colFrom:M,colTo:$}of d)for(let A=M;A<=$;A++){w++;const R=wh.set(v,I,y.normalizeCol(A),y.getWorldForColumn(A)).id;let L=i.get(R);if(L)L.isReady?(Zl.set(R,L),b++):c||this._addParentTile(R,Zl);else{if((x=this._tileCache)!=null&&x.has(R)){if(L=this._tileCache.pop(R),this.tileIndex.set(R,L),L.isReady){Zl.set(R,L),b++;continue}}else L=this.acquireTile(wh),this.tileIndex.set(R,L);c||this._addParentTile(R,Zl)}}const _=b===w;for(const[I,M]of i){if(Zl.has(I))continue;wh.set(I);const $=this.tileInfoView.intersects(h,wh),A=this.cachePolicy==="purge"?wh.level!==v:wh.level>v;!$||!c&&_?!A&&$||bh.push(M):M.isReady?A&&this.cachePolicy==="purge"&&this._hasReadyAncestor(wh,v)?bh.push(M):p$.push(M):A&&bh.push(M)}for(const I of p$)I.isReady&&Zl.set(I.key.id,I);for(const I of bh)this._tileCache?this._tileCache.add(I):this.releaseTile(I),i.delete(I.key.id);for(const I of Zl.values())this.tiles.push(I);for(const I of i.values())Zl.has(I.key.id)||(I.visible=!1);(T=this._tileCache)==null||T.prune(v,s,o),$v.pool.release(h),p$.length=0,bh.length=0,Zl.clear()}clear(){const{tileIndex:t}=this;for(const r of t.values())this.releaseTile(r);t.clear()}refresh(t){var r;for(const i of this.tileIndex.values())this.tiles.includes(i)?t(i):bh.push(i);for(const i of bh)this.releaseTile(i),this.tileIndex.delete(i.key.id);(r=this._tileCache)==null||r.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,r){var s;let i=t,n=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(n=this.tileIndex.get(i),n==null?void 0:n.isReady){r.has(n.key.id)||r.set(n.key.id,n);break}}else if((s=this._tileCache)!=null&&s.has(i)&&(n=this._tileCache.pop(i),this.tileIndex.set(i,n),n==null?void 0:n.isReady)){r.has(n.key.id)||r.set(n.key.id,n);break}}_hasReadyAncestor(t,r){const i=ws();this.tileInfoView.getTileBounds(i,t,!0);for(const n of this.tileIndex.values())if(n.isReady&&n.key.level>=r&&n.key.level<t.level){const s=ws();if(this.tileInfoView.getTileBounds(s,n.key,!0),Fpe(s,i))return!0}return!1}};function pX(){const e=new Float32Array(6);return e[0]=1,e[3]=1,e}function TOe(e){const t=new Float32Array(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function IOe(e,t,r,i,n,s){const o=new Float32Array(6);return o[0]=e,o[1]=t,o[2]=r,o[3]=i,o[4]=n,o[5]=s,o}function MOe(e,t){return new Float32Array(e,t,6)}function hX(e,t,r,i){const n=t[i],s=t[i+1];e[i]=r[0]*n+r[2]*s+r[4],e[i+1]=r[1]*n+r[3]*s+r[5]}function $Oe(e,t,r,i=0,n=0,s=2){const o=n||t.length/s;for(let a=i;a<o;a++)hX(e,t,r,a*s)}Object.freeze(Object.defineProperty({__proto__:null,clone:TOe,create:pX,createView:MOe,fromValues:IOe,transform:hX,transformMany:$Oe},Symbol.toStringTag,{value:"Module"}));function EOe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function AOe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function dX(e,t,r,i,n,s,o,a,u,c){return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e[4]=s,e[5]=o,e[6]=a,e[7]=u,e[8]=c,e}function fX(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function ROe(e,t){if(e===t){const r=t[1],i=t[2],n=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=n}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function COe(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],h=t[8],d=h*o-a*c,y=-h*s+a*u,v=c*s-o*u;let w=r*d+i*y+n*v;return w?(w=1/w,e[0]=d*w,e[1]=(-h*i+n*c)*w,e[2]=(a*i-n*o)*w,e[3]=y*w,e[4]=(h*r-n*u)*w,e[5]=(-a*r+n*s)*w,e[6]=v*w,e[7]=(-c*r+i*u)*w,e[8]=(o*r-i*s)*w,e):null}function OOe(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],h=t[8];return e[0]=o*h-a*c,e[1]=n*c-i*h,e[2]=i*a-n*o,e[3]=a*u-s*h,e[4]=r*h-n*u,e[5]=n*s-r*a,e[6]=s*c-o*u,e[7]=i*u-r*c,e[8]=r*o-i*s,e}function POe(e){const t=e[0],r=e[1],i=e[2],n=e[3],s=e[4],o=e[5],a=e[6],u=e[7],c=e[8];return t*(c*s-o*u)+r*(-c*n+o*a)+i*(u*n-s*a)}function dL(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],h=t[7],d=t[8],y=r[0],v=r[1],w=r[2],b=r[3],_=r[4],x=r[5],T=r[6],I=r[7],M=r[8];return e[0]=y*i+v*o+w*c,e[1]=y*n+v*a+w*h,e[2]=y*s+v*u+w*d,e[3]=b*i+_*o+x*c,e[4]=b*n+_*a+x*h,e[5]=b*s+_*u+x*d,e[6]=T*i+I*o+M*c,e[7]=T*n+I*a+M*h,e[8]=T*s+I*u+M*d,e}function JC(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],h=t[7],d=t[8],y=r[0],v=r[1];return e[0]=i,e[1]=n,e[2]=s,e[3]=o,e[4]=a,e[5]=u,e[6]=y*i+v*o+c,e[7]=y*n+v*a+h,e[8]=y*s+v*u+d,e}function yX(e,t,r){const i=t[0],n=t[1],s=t[2],o=t[3],a=t[4],u=t[5],c=t[6],h=t[7],d=t[8],y=Math.sin(r),v=Math.cos(r);return e[0]=v*i+y*o,e[1]=v*n+y*a,e[2]=v*s+y*u,e[3]=v*o-y*i,e[4]=v*a-y*n,e[5]=v*u-y*s,e[6]=c,e[7]=h,e[8]=d,e}function LOe(e,t,r){const i=r[0],n=r[1],s=r[2];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e[6]=s*t[6],e[7]=s*t[7],e[8]=s*t[8],e}function kOe(e,t,r){const i=r[0],n=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=n*t[3],e[4]=n*t[4],e[5]=n*t[5],e}function NOe(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function DOe(e,t){const r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=-r,e[4]=i,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function FOe(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function jOe(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function UOe(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=r+r,a=i+i,u=n+n,c=r*o,h=i*o,d=i*a,y=n*o,v=n*a,w=n*u,b=s*o,_=s*a,x=s*u;return e[0]=1-d-w,e[3]=h-x,e[6]=y+_,e[1]=h+x,e[4]=1-c-w,e[7]=v-b,e[2]=y-_,e[5]=v+b,e[8]=1-c-d,e}function VOe(e,t){const r=t[0],i=t[1],n=t[2],s=t[4],o=t[5],a=t[6],u=t[8],c=t[9],h=t[10],d=h*o-a*c,y=-h*s+a*u,v=c*s-o*u,w=r*d+i*y+n*v;if(!w)return null;const b=1/w;return e[0]=d*b,e[1]=(-h*i+n*c)*b,e[2]=(a*i-n*o)*b,e[3]=y*b,e[4]=(h*r-n*u)*b,e[5]=(-a*r+n*s)*b,e[6]=v*b,e[7]=(-c*r+i*u)*b,e[8]=(o*r-i*s)*b,e}function GOe(e,t){const r=t[0],i=t[1],n=t[2],s=t[3],o=t[4],a=t[5],u=t[6],c=t[7],h=t[8],d=t[9],y=t[10],v=t[11],w=t[12],b=t[13],_=t[14],x=t[15],T=r*a-i*o,I=r*u-n*o,M=r*c-s*o,$=i*u-n*a,A=i*c-s*a,R=n*c-s*u,L=h*b-d*w,C=h*_-y*w,U=h*x-v*w,F=d*_-y*b,j=d*x-v*b,q=y*x-v*_;let K=T*q-I*j+M*F+$*U-A*C+R*L;return K?(K=1/K,e[0]=(a*q-u*j+c*F)*K,e[1]=(u*U-o*q-c*C)*K,e[2]=(o*j-a*U+c*L)*K,e[3]=(n*j-i*q-s*F)*K,e[4]=(r*q-n*U+s*C)*K,e[5]=(i*U-r*j-s*L)*K,e[6]=(b*R-_*A+x*$)*K,e[7]=(_*M-w*R-x*I)*K,e[8]=(w*A-b*M+x*T)*K,e):null}function BOe(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function zOe(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function qOe(e){return Math.sqrt(e[0]**2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+e[6]**2+e[7]**2+e[8]**2)}function HOe(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function mX(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function WOe(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function JOe(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e}function ZOe(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function YOe(e,t){const r=e[0],i=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],h=e[8],d=t[0],y=t[1],v=t[2],w=t[3],b=t[4],_=t[5],x=t[6],T=t[7],I=t[8],M=Bo();return Math.abs(r-d)<=M*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-y)<=M*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(n-v)<=M*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(s-w)<=M*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-b)<=M*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(a-_)<=M*Math.max(1,Math.abs(a),Math.abs(_))&&Math.abs(u-x)<=M*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-T)<=M*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(h-I)<=M*Math.max(1,Math.abs(h),Math.abs(I))}function KOe(e){const t=Bo(),r=e[0],i=e[1],n=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],h=e[8];return Math.abs(1-(r*r+s*s+u*u))<=t&&Math.abs(1-(i*i+o*o+c*c))<=t&&Math.abs(1-(n*n+a*a+h*h))<=t}const XOe=dL,QOe=mX;Object.freeze(Object.defineProperty({__proto__:null,add:HOe,adjoint:OOe,copy:AOe,determinant:POe,equals:YOe,exactEquals:ZOe,frob:qOe,fromMat2d:jOe,fromMat4:EOe,fromQuat:UOe,fromRotation:DOe,fromScaling:FOe,fromTranslation:NOe,identity:fX,invert:COe,isOrthoNormal:KOe,mul:XOe,multiply:dL,multiplyScalar:WOe,multiplyScalarAndAdd:JOe,normalFromMat4:GOe,normalFromMat4Legacy:VOe,projection:BOe,rotate:yX,scale:LOe,scaleByVec2:kOe,set:dX,str:zOe,sub:QOe,subtract:mX,translate:JC,transpose:ROe},Symbol.toStringTag,{value:"Module"}));function uS(){const e=new Float32Array(9);return e[0]=1,e[4]=1,e[8]=1,e}function e4e(e){const t=new Float32Array(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function t4e(e,t,r,i,n,s,o,a,u){const c=new Float32Array(9);return c[0]=e,c[1]=t,c[2]=r,c[3]=i,c[4]=n,c[5]=s,c[6]=o,c[7]=a,c[8]=u,c}function r4e(e,t){return new Float32Array(e,t,9)}Object.freeze(Object.defineProperty({__proto__:null,clone:e4e,create:uS,createView:r4e,fromValues:t4e},Symbol.toStringTag,{value:"Module"}));function gX(){return new Float32Array(2)}function i4e(e){const t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}function Fm(e,t){const r=new Float32Array(2);return r[0]=e,r[1]=t,r}function n4e(e,t){return new Float32Array(e,t,2)}function vX(){return gX()}function wX(){return Fm(1,1)}function bX(){return Fm(1,0)}function _X(){return Fm(0,1)}const s4e=vX(),o4e=wX(),a4e=bX(),l4e=_X();Object.freeze(Object.defineProperty({__proto__:null,ONES:o4e,UNIT_X:a4e,UNIT_Y:l4e,ZEROS:s4e,clone:i4e,create:gX,createView:n4e,fromValues:Fm,ones:wX,unitX:bX,unitY:_X,zeros:vX},Symbol.toStringTag,{value:"Module"}));function u4e(e){return e instanceof Float32Array&&e.length>=2}function c4e(e){return Array.isArray(e)&&e.length>=2}function b_(e){return u4e(e)||c4e(e)}var ZC;const pn=[0,0];let Xc=ZC=class extends Q{constructor(e){super(e),this._viewpoint2D={center:qr(),rotation:0,scale:0,spatialReference:void 0},this.center=[0,0],this.extent=new Ne,this.id=0,this.inverseTransform=ju(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=ju(),this.transformNoRotation=ju(),this.displayMat3=uS(),this.displayViewMat3=uS(),this.viewMat3=uS(),this.viewMat2d=pX(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(e){this._set("pixelRatio",e),this._update()}set size(e){this._set("size",e),this._update()}set viewpoint(e){if(e){const t=this._viewpoint2D,r=e.targetGeometry;t.center[0]=r.x,t.center[1]=r.y,t.rotation=e.rotation,t.scale=e.scale,t.spatialReference=r.spatialReference}this._update()}copy(e){const t=this.size,r=this.viewpoint;return r&&t?(this.viewpoint=ja(r,e.viewpoint),this._set("size",Iv(t,e.size))):(this.viewpoint=e.viewpoint.clone(),this._set("size",[e.size[0],e.size[1]])),this._set("pixelRatio",e.pixelRatio),this}clone(){return new ZC({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(e,t,r){return b_(t)?xa(e,t,this.inverseTransform):(pn[0]=t,pn[1]=r,xa(e,pn,this.inverseTransform))}toScreen(e,t,r){return b_(t)?xa(e,t,this.transform):(pn[0]=t,pn[1]=r,xa(e,pn,this.transform))}toScreenNoRotation(e,t,r){return b_(t)?xa(e,t,this.transformNoRotation):(pn[0]=t,pn[1]=r,xa(e,pn,this.transformNoRotation))}toScreenClosest(e,t,r){b_(t)?(pn[0]=t[0],pn[1]=t[1]):(pn[0]=t,pn[1]=r);const[i]=pn,{center:n,extent:s,spatialReference:o,transform:a}=this;return(i<s.xmin||i>s.xmax)&&(pn[0]=BJ(i,n[0],o)),xa(e,pn,a)}getScreenTransform(e,t){const{center:r}=this._viewpoint2D,i=this._get("pixelRatio")||1,n=this._get("size");return pL(e,r,n,t,0,i),e}_update(){const{center:e,spatialReference:t,scale:r,rotation:i}=this._viewpoint2D,n=this._get("pixelRatio")||1,s=this._get("size"),o=new xl({targetGeometry:new Ae(e[0],e[1],t),scale:r,rotation:i});if(this._set("viewpoint",o),!s||!t||!r)return;this.resolution=l0(o),this.rotation=i,this.scale=r,this.spatialReference=t,Iv(this.center,e);const a=s[0]!==0?2/s[0]:0,u=s[1]!==0?-2/s[1]:0;dX(this.displayMat3,a,0,0,0,u,0,-1,1,1);const c=fX(this.viewMat3),h=Fm(s[0]/2,s[1]/2),d=Fm(-s[0]/2,-s[1]/2),y=DO(i);JC(c,c,h),yX(c,c,y),JC(c,c,d),dL(this.displayViewMat3,this.displayMat3,c);const v=aL(this.viewMat2d,h);return eI(v,v,y),Tv(v,v,d),JCe(this.extent,o,s),hL(this.transform,o,s,n),sL(this.inverseTransform,this.transform),tOe(this.transformNoRotation,o,s,n),this.worldScreenWidth=iOe(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};l([p({readOnly:!0})],Xc.prototype,"id",void 0),l([p({value:1,json:{write:!0}})],Xc.prototype,"pixelRatio",null),l([p({json:{write:!0}})],Xc.prototype,"size",null),l([p()],Xc.prototype,"spatialReference",void 0),l([p({type:xl,json:{write:!0}})],Xc.prototype,"viewpoint",null),Xc=ZC=l([k("esri.views.2d.ViewState")],Xc);const yU=Xc;var YC,KC;let Ru=YC=class extends De{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}clone(){return new YC({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}};l([p()],Ru.prototype,"left",void 0),l([p()],Ru.prototype,"top",void 0),l([p()],Ru.prototype,"right",void 0),l([p()],Ru.prototype,"bottom",void 0),Ru=YC=l([k("esri.views.2d.PaddedViewState.Padding")],Ru);let Py=KC=class extends yU{constructor(...e){super(...e),this.paddedViewState=new yU,this._updateContent=(()=>{const t=qr();return()=>{const r=this._get("size"),i=this._get("padding");if(!r||!i)return;const n=this.paddedViewState;Fi(t,i.left+i.right,i.top+i.bottom),Mv(t,r,t),Iv(n.size,t);const s=n.viewpoint;s&&(this.viewpoint=s)}})(),this.addHandles(Ue(()=>[this.size,this.padding],()=>this._updateContent(),di)),this.padding=new Ru,this.size=[0,0]}set padding(e){this._set("padding",e||new Ru)}set viewpoint(e){if(e){const t=e.clone();this.paddedViewState.viewpoint=e,sOe(t,e,this._get("size"),this._get("padding"));const r=this._viewpoint2D,i=t.targetGeometry;r.center[0]=i.x,r.center[1]=i.y,r.rotation=t.rotation,r.scale=t.scale,r.spatialReference=i.spatialReference,this._update()}}clone(){return new KC({padding:this.padding.clone(),size:this.size.slice(),viewpoint:this.paddedViewState.viewpoint.clone(),pixelRatio:this.pixelRatio})}};l([p()],Py.prototype,"paddedViewState",void 0),l([p({type:Ru})],Py.prototype,"padding",null),l([p()],Py.prototype,"viewpoint",null),Py=KC=l([k("esri.views.2d.PaddedViewState")],Py);const p4e=Py;let zn=class extends De{constructor(t){super(t),this.constraints=null,this.ready=!1,this.resizeAlign="center",this.addHandles([Ue(()=>{var r;return(r=this.constraints)==null?void 0:r.version},r=>{this.constraints&&r&&this.ready&&(this.state.viewpoint=this.constraints.fit(this.state.paddedViewState.viewpoint))},di)])}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:r}=this.state.paddedViewState;return this.state.commitProperty("id"),new Ae({x:t[0],y:t[1],spatialReference:r})}set center(t){if(t==null)return;if(!this.ready)return void this._set("center",t);let r;try{r=this._project(t,this.state.spatialReference)}catch(n){return void oe.getLogger(this).error(new z("mapview:invalid-center","could not project the value in the view's spatial reference",{input:t,error:n}))}const i=this.viewpoint;zC(i,i,r),this.viewpoint=i}get extent(){return this.ready?(this.state.commitProperty("id"),this.state.paddedViewState.extent.clone()):this._get("extent")}set extent(t){if(t==null)return;if(!t.width||!t.height)return void oe.getLogger(this).error(new z("mapview:invalid-extent","invalid extent size"));if(!this.ready)return this._set("extent",t),this._set("center",void 0),this._set("viewpoint",void 0),this._set("scale",void 0),void this._set("zoom",void 0);let r;try{r=this._project(t,this.state.spatialReference)}catch(n){return void oe.getLogger(this).error(new z("mapview:invalid-extent","could not project the value in the view's spatial reference",{error:n}))}const i=this.viewpoint;ZCe(i,i,r,this.state.size,{constraints:this.constraints}),this.viewpoint=i}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.ready?(this.state.commitProperty("id"),this.state.resolution):0}get rotation(){return this.ready?(this.state.commitProperty("id"),this.state.rotation):this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const r=this.viewpoint;aOe(r,r,t),this.viewpoint=r}get scale(){return this.ready?(this.state.commitProperty("id"),this.state.scale):this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",void 0);const i=this._get("extent");return void(i&&(this._set("extent",void 0),this._set("center",i.center)))}const r=this.viewpoint;cU(r,r,t),this.viewpoint=r}get viewpoint(){return this.ready?this.state.paddedViewState.viewpoint.clone():this._get("viewpoint")}set viewpoint(t){var s;if(t==null)return;if(!this.ready)return this._set("viewpoint",t),this._set("extent",void 0),this._set("center",void 0),this._set("zoom",void 0),void this._set("scale",void 0);let r,i;try{r=this._project(t,this.state.spatialReference),!t.scale||isNaN(t.scale)?i=new z("mapview:invalid-viewpoint",`invalid scale value of ${t.scale}`):t.targetGeometry==null&&(i=new z("mapview:invalid-viewpoint","geometry not defined"))}catch(o){i=new z("mapview:invalid-viewpoint","could not project the value in the view's spatial reference",{error:o})}if(i)return void oe.getLogger(this).error(i);this._scaleBeforeChangingSpatialReference=null;const n=new xl({targetGeometry:new Ae,scale:0,rotation:0});ja(n,r),(s=this.constraints)==null||s.constrain(n,this.state.paddedViewState.viewpoint),this.state.viewpoint=n,this._set("viewpoint",n)}get zoom(){var t;return this.ready?((t=this.constraints)==null?void 0:t.scaleToZoom(this.scale))??-1:this._get("zoom")}set zoom(t){var n,s;if(!(t>=0))return;if(!this.ready){this._set("zoom",t),this._set("scale",void 0);const o=this._get("extent");return void(o&&(this._set("extent",void 0),this._set("center",o.center)))}const r=((n=this.constraints)==null?void 0:n.zoomToScale(t))??0;if(!r)return void this._set("zoom",-1);const i=this.viewpoint;cU(i,i,r),this.viewpoint=i,this._set("zoom",((s=this.constraints)==null?void 0:s.scaleToZoom(this.scale))??-1)}getUserStartupOptions(t){if(!t[0]&&!t[1])return{center:void 0,rotation:void 0,scale:void 0};const{padding:r,constraints:i}=this,n=this._get("center"),s=this._get("extent"),o=this._get("scale"),a=this._get("rotation"),u=this._get("viewpoint"),c=this._get("zoom"),h=c!=null&&i!=null&&i.zoomToScale(c)||void 0;let d,y,v;const w=u==null?void 0:u.rotation,b=u==null?void 0:u.targetGeometry;(b==null?void 0:b.type)==="extent"?d=b:(b==null?void 0:b.type)==="point"&&(y=b,v=u==null?void 0:u.scale);const _=s??d;return{center:n??y??(_==null?void 0:_.center),rotation:a??w,scale:(o??h??v??(_&&pm(_,[t[0]-r.left-r.right,t[1]-r.top-r.bottom])))||void 0}}startup(t,r,i,n){var o;const s=t.targetGeometry;try{this._project(t,i)}catch(a){oe.getLogger(this).warn(new eo("mapview:startup-projection-error","projection of initial viewpoint to the view's spatial reference, defaulting to the initial viewpoint.",{center:s.toJSON(),spatialReference:i,error:a})),t.targetGeometry=n||new Ae({x:0,y:0,spatialReference:i})}(o=this.constraints)==null||o.fit(t),this._set("state",new p4e({padding:this.padding,size:r,viewpoint:t})),this._set("ready",!0)}teardown(){this._set("ready",!1);const{center:[t,r],spatialReference:i,rotation:n,scale:s}=this.state.paddedViewState,o=new Ae({x:t,y:r,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",o),this._set("zoom",-1),this._set("rotation",n),this._set("scale",s),this._set("state",null)}changeSpatialReference(t){var u;const r=this.state.paddedViewState.clone();if(this._scaleBeforeChangingSpatialReference==null)this._scaleBeforeChangingSpatialReference=r.scale;else{const c=r.viewpoint.clone();c.scale=this._scaleBeforeChangingSpatialReference,r.viewpoint=c}const i=r.clone(),[n,s]=r.center;let o=null;try{o=this._project(new Ae({x:n,y:s,spatialReference:r.spatialReference}),t)}catch(c){CO()||oe.getLogger(this).warn(new eo("mapview:spatial-reference-change","could not project the view's center to the new spatial reference",{center:o==null?void 0:o.toJSON(),spatialReference:t,error:c}))}o||(o=new Ae({x:0,y:0,spatialReference:t}));const a=zC(new xl({targetGeometry:new Ae,scale:0,rotation:0}),r.viewpoint,o);i.viewpoint=a;try{const h=[r.size[0]/2,r.size[1]/2],d=[h[0]+20,h[1]],y=r.toMap([0,0],d),{x:v,y:w}=this._project(new Ae({x:y[0],y:y[1],spatialReference:r.spatialReference}),t);y[0]=v,y[1]=w,i.toScreen(y,y);const b=nOe(h,y,d),_=Math.hypot(y[0]-h[0],y[1]-h[1])/20;!Number.isFinite(_)||Math.abs(_)>4?(a.rotation=0,a.targetGeometry=new Ae({x:0,y:0,spatialReference:t})):(a.scale*=_,a.scale>Me("mapview-srswitch-adjust-rotation-scale-threshold")?a.rotation=0:a.rotation+=Number.isFinite(b)?b:0)}catch{}(u=this._get("constraints"))==null||u.constrain(a,void 0),this._get("state").viewpoint=a}resize(t,r){var o;if(!this.ready)return;const i=this.state;let n=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();i.size=[t,r],oOe(n,n,s,this.state.paddedViewState.size,this.resizeAlign),n=((o=this.constraints)==null?void 0:o.constrain(n,void 0))??n,this.state.viewpoint=n}toMap(t){if(!this.ready)return null;const r=[0,0],[i,n]=this.state.toMap(r,[t.x,t.y]),s=this.state.spatialReference;return new Ae({x:i,y:n,spatialReference:s})}toScreen(t,r){if(!this.ready)return null;const i=this._project(t,this.state.spatialReference),n=[i.x,i.y];return(r==null?void 0:r.pickClosestTarget)===!1?this.state.toScreen(n,n):this.state.toScreenClosest(n,n),Yn(n[0],n[1])}_project(t,r){var s;const i=(t==null?void 0:t.targetGeometry)||t;if(!r)return t;if(!i)return null;if(r.imageCoordinateSystem||(s=i.spatialReference)!=null&&s.imageCoordinateSystem||fi(r,i.spatialReference))return t;const n=Wp(i,r);if(!n)throw new z("mapview:projection-not-possible","projecting input geometry to target spatial reference returned a null value",{geometry:i,spatialReference:r});return h4e(t)?(t.targetGeometry=n,t):n}};function h4e(e){return(e==null?void 0:e.declaredClass)==="esri.Viewpoint"}l([p({type:Ae})],zn.prototype,"center",null),l([p()],zn.prototype,"constraints",void 0),l([p({type:Ne})],zn.prototype,"extent",null),l([p({value:{top:0,right:0,bottom:0,left:0},cast:e=>({top:0,right:0,bottom:0,left:0,...e})})],zn.prototype,"padding",null),l([p()],zn.prototype,"ready",void 0),l([p()],zn.prototype,"resizeAlign",void 0),l([p({readOnly:!0})],zn.prototype,"resolution",null),l([p({type:Number})],zn.prototype,"rotation",null),l([p({type:Number})],zn.prototype,"scale",null),l([p({readOnly:!0})],zn.prototype,"state",void 0),l([p({type:xl})],zn.prototype,"viewpoint",null),l([p()],zn.prototype,"zoom",null),zn=l([k("esri.views.2d.ViewStateManager")],zn);function fL(e,t){switch(t){case"primary":return e.pointerType==="touch"||e.button===0;case"secondary":return e.pointerType!=="touch"&&e.button===2;case"tertiary":return e.pointerType!=="touch"&&e.button===1}}let mU=class extends Ai{constructor(t,r){super(!0),this._view=t,this.registerIncoming("double-click",r,i=>this._handleDoubleClick(i,r))}_handleDoubleClick(t,r){fL(t.data,"primary")&&(t.stopPropagation(),r?this._view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this._view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}},d4e=class extends Ai{constructor(t,r,i){super(!0),this.view=t,this.pointerType=r,this.registerIncoming("double-tap-drag",i,n=>this._handleDoubleTapDrag(n))}_handleDoubleTapDrag(t){const{data:r}=t,{pointerType:i}=r;if(i!==this.pointerType)return;t.stopPropagation();const{action:n,delta:s}=r,{view:o}=this,{mapViewNavigation:a}=o;switch(n){case"begin":{const{scale:u}=o;this._startScale=u,this._currentScale=u,this._previousDelta=s,a.begin();break}case"update":{if(this._previousDelta.y===s.y)return;this._previousDelta=s;const u=1.015**s.y,c=this._startScale*u,h=c/this._currentScale;a.setViewpointImmediate(h),this._currentScale=c;break}case"end":{const{constraints:u}=o,{effectiveLODs:c,snapToZoom:h}=u;if(!h||!c)return void a.end();const d=u.snapScale(this._currentScale),y=(s.y>0?Math.max(d,u.snapToPreviousScale(this._startScale)):Math.min(d,u.snapToNextScale(this._startScale)))/this._currentScale;a.zoom(y);break}}}},iI=class{constructor(t){this._callbacks=t,this._currentCount=0,this._callbacks.condition||(this._callbacks.condition=()=>!0)}handle(t){const r=t.data,i=r.pointers.size;switch(r.action){case"start":this._currentCount=i,this._emitStart(t);break;case"added":this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"update":this._emitUpdate(t);break;case"removed":this._startEvent&&this._emitEnd(this._previousEvent),this._currentCount=i,this._emitStart(t);break;case"end":this._emitEnd(t),this._currentCount=0}this._previousEvent=t}_emitStart(t){var r,i;this._startEvent=t,(i=(r=this._callbacks).condition)!=null&&i.call(r,this._currentCount,t)&&this._callbacks.start(this._currentCount,t,this._startEvent)}_emitUpdate(t){var r,i;(i=(r=this._callbacks).condition)!=null&&i.call(r,this._currentCount,t)&&this._callbacks.update(this._currentCount,t,this._startEvent)}_emitEnd(t){var r,i;(i=(r=this._callbacks).condition)!=null&&i.call(r,this._currentCount,t)&&this._callbacks.end(this._currentCount,t,this._startEvent),this._startEvent=null}},f4e=class extends Ai{constructor(t,r,i){super(!0),this.view=t,this.pointerAction=r,this.registerIncoming("drag",i,n=>this._handleDrag(n)),this.registerIncoming("pointer-down",()=>this.stopMomentumNavigation())}onInstall(t){super.onInstall(t),this._dragEventSeparator=new iI({start:(r,i)=>{this.view.mapViewNavigation.pan.begin(this.view,i.data),i.stopPropagation()},update:(r,i)=>{this.view.mapViewNavigation.pan.update(this.view,i.data),i.stopPropagation()},end:(r,i)=>{this.view.mapViewNavigation.pan.end(this.view,i.data),i.stopPropagation()},condition:(r,i)=>r===1&&fL(i.data,this.pointerAction)})}_handleDrag(t){const r=this.view.mapViewNavigation;r.pinch.zoomMomentum||r.pinch.rotateMomentum?this.stopMomentumNavigation():this._dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}},y4e=class extends Ai{constructor(t,r,i){super(!0),this._view=t,this.pointerAction=r;const n=this._view.mapViewNavigation;this._dragEventSeparator=new iI({start:(s,o)=>{n.rotate.begin(this._view,o.data),o.stopPropagation()},update:(s,o)=>{n.rotate.update(this._view,o.data),o.stopPropagation()},end:(s,o)=>{n.rotate.end(),o.stopPropagation()},condition:(s,o)=>s===1&&fL(o.data,this.pointerAction)}),this.registerIncoming("drag",i,s=>this._dragEventSeparator.handle(s))}};function Qo(e){let t=e*e;return e<0&&(t*=-1),t}function m4e(e){return e.translation[0]=0,e.translation[1]=0,e.translation[2]=0,e.heading=0,e.tilt=0,e}function g4e(e,t,r){const i=r,n=e.state,s=e.device,o=t.tiltDirection==="forward-down"?1:-1,a=1;return s.deviceType==="standard"?(i.translation[0]=Qo(n.axes[0]),i.translation[1]=Qo(n.axes[1]),i.translation[2]=Qo(n.buttons[7])-Qo(n.buttons[6]),i.heading=Qo(n.axes[2]),i.tilt=Qo(n.axes[3])):s.deviceType==="spacemouse"&&(i.translation[0]=1.2*Qo(n.axes[0]),i.translation[1]=1.2*Qo(n.axes[1]),i.translation[2]=2*-Qo(n.axes[2]),i.heading=1.2*Qo(n.axes[5]),i.tilt=1.2*Qo(n.axes[3])),i.tilt*=o,tB(i.translation,i.translation,a),i}function v4e(e){return e.translation[0]===0&&e.translation[1]===0&&e.translation[2]===0&&e.heading===0&&e.tilt===0&&e.zoom===0}let w4e=class extends Ai{constructor(t){super(!0),this._view=t,this._frameTask=null,this._watchHandles=new gO,this._currentDevice=null,this._transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this._handle=this.registerIncoming("gamepad",r=>this._handleGamePadEvent(r)),this._handle.pause()}onInstall(t){super.onInstall(t),this._watchHandles.add([Ue(()=>{var r;return(r=this._view.navigation.gamepad)==null?void 0:r.enabled},r=>{r?(this._handle.resume(),this._frameTask||(this._frameTask=ym({update:i=>this._frameUpdate(i.deltaTime)}))):(this._handle.pause(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null))},Xi)])}onUninstall(){this._watchHandles.removeAll(),this._frameTask&&(this._frameTask.remove(),this._frameTask=null),super.onUninstall()}_handleGamePadEvent(t){const r=this._view.navigation.gamepad.device;r&&t.data.device!==r||this._currentDevice&&this._currentDevice!==t.data.device||(t.data.action==="end"?(this._currentDevice=null,m4e(this._transformation)):(this._currentDevice=t.data.device,g4e(t.data,this._view.navigation.gamepad,this._transformation)))}_frameUpdate(t){const r=this._transformation;if(v4e(r))return;const i=this._view.viewpoint.clone(),n=this._view.navigation.gamepad.velocityFactor,s=_4e*n*t;rI(i,i,[r.translation[0]*s,-r.translation[1]*s]);const o=1+r.translation[2]*S4e*t,a=this._view.constraints.rotationEnabled?-r.heading*b4e*t:0,u=this._view.size,c=[u[0]/2,u[1]];iX(i,i,o,a,c,u);const h=this._view.constraints.constrain(i,this._view.viewpoint);this._view.viewpoint=h}};const b4e=.06,_4e=.7,S4e=6e-4;function SX(e){const t=()=>e(document.visibilityState==="visible");return document.addEventListener("visibilitychange",t),{remove:()=>document.addEventListener("visibilitychange",t)}}let x4e=class extends Ai{constructor(t,r,i){super(!0),this.view=t,this.keys=r,this._isSticky=!1,this._pressedKeys=new Set,this._timeout=void 0,this._currentDirection=void 0,this._stickyKeyDuration=200,this._handleKey=n=>{const s=this._keyMap[n.data.key];if(n.modifiers.has("Meta")||n.modifiers.has("Ctrl"))return void this._stopMovement();if(s==null)return;n.stopPropagation(),n.preventDefault();const o=n.type==="key-down";if(this._pressedKeys[o?"add":"delete"](s),o){if(this._direction===s)return;this._direction=s,this._isSticky=!1,this._setTimeout(()=>{this._isSticky&&this._handlePopKey()})}else{const a=this._timeout===void 0,u=this._pressedKeys.size>0;a||u?this._handlePopKey():this._isSticky=!0}},this._handlePopKey=()=>{this._direction=Array.from(this._pressedKeys).pop(),this._direction==null&&this._stopMovement()},this._stopMovement=()=>{this._isSticky=!1,this._direction=void 0,this._pressedKeys.clear(),this._setTimeout(void 0)},this._keyMap={[r.left]:"left",[r.right]:"right",[r.up]:"up",[r.down]:"down"},this.registerIncoming("key-down",i,this._handleKey),this.registerIncoming("key-up",i,this._handleKey),this.registerIncoming("blur",i,this._stopMovement),this._visibilityHandle=SX(n=>n?null:this._stopMovement())}onUninstall(){var t;this._stopMovement(),(t=this._visibilityHandle)==null||t.remove()}get _direction(){return this._currentDirection}set _direction(t){const r=this._currentDirection!=null;if(t!=null){if(r||this.view.mapViewNavigation.begin(),this._currentDirection!==t)switch(t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}}else r&&this.view.mapViewNavigation.stop();this._currentDirection=t}_setTimeout(t){clearTimeout(this._timeout),this._timeout=t===void 0?void 0:setTimeout(()=>{this._timeout=void 0,t()},this._stickyKeyDuration)}},T4e=class extends Ai{constructor(t,r,i){super(!0),this.view=t,this.keys=r,this._pressed=!1,this._keyToDirection={[r.clockwiseOption1]:"clockwise",[r.clockwiseOption2]:"clockwise",[r.counterClockwiseOption1]:"counterClockwise",[r.counterClockwiseOption2]:"counterClockwise",[r.resetOption1]:"reset",[r.resetOption2]:"reset"},this.registerIncoming("key-down",i,n=>this._handleKeyDown(n)),this.registerIncoming("key-up",i,n=>this._handleKeyUp(n)),this.registerIncoming("blur",i,()=>this._handleStop()),this._visibilityHandle=SX(n=>n?null:this._handleStop())}onUninstall(){var t;(t=this._visibilityHandle)==null||t.remove(),this._handleStop()}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleStop(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,r){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const n=this._keyToDirection[t.data.key];if(this._pressed=n!=null,this._pressed){if(t.preventDefault(),r)switch(this.view.mapViewNavigation.begin(),n){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}};var Zy;(function(e){e[e.IN=0]="IN",e[e.OUT=1]="OUT"})(Zy||(Zy={}));let I4e=class extends Ai{constructor(t,r,i){super(!0),this.view=t,this.keys=r,this._keysToZoomAction={},this.registerIncoming("key-down",i,n=>this._handleKeyDown(n)),r.zoomIn.forEach(n=>this._keysToZoomAction[n]=Zy.IN),r.zoomOut.forEach(n=>this._keysToZoomAction[n]=Zy.OUT)}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const r=t.modifiers;if(r.size>0&&!r.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const n=this._keysToZoomAction[i],{mapViewNavigation:s}=this.view;let o=null;switch(n){case Zy.IN:o=s.zoomIn();break;case Zy.OUT:o=s.zoomOut();break;default:return}s.begin(),o.then(()=>s.end()),t.stopPropagation()}};const M4e=.6;let $4e=class extends Ai{constructor(t,r){super(!0),this._view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",r,i=>this._handleMouseWheel(i))}_handleMouseWheel(t){if(!this._view.navigation.mouseWheelZoomEnabled||(t.preventDefault(),t.stopPropagation(),!this._canZoom))return;const r=this._view.mapViewNavigation,{x:i,y:n,deltaY:s}=t.data,o=1/M4e**(1/60*s),a=r.zoom(o,[i,n]);a&&(this._canZoom=!1,a.catch(()=>{}).then(()=>{this._canZoom=!0,r.end()}))}},E4e=class extends Ai{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",i=>this._handleDrag(i)),this.registerIncoming("pointer-down",()=>this._stopMomentumNavigation());const r=this.view.mapViewNavigation;this._dragEventSeparator=new iI({start:(i,n)=>{r.pinch.begin(this.view,n.data),n.stopPropagation()},update:(i,n)=>{r.pinch.update(this.view,n.data),n.stopPropagation()},end:(i,n)=>{r.pinch.end(this.view),n.stopPropagation()},condition:i=>i>=2})}_handleDrag(t){this._dragEventSeparator.handle(t)}_stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}};function gU(e){const t=e.native;return t?{buttons:t.buttons.map(r=>r.pressed?r.value||1:0),axes:t.axes.map(r=>C4e(r,e.axisThreshold))}:{buttons:[],axes:[]}}function A4e(e,t){if(e.axes.length!==t.axes.length||e.buttons.length!==t.buttons.length)return!1;for(let r=0;r<e.axes.length;r++)if(e.axes[r]!==t.axes[r])return!1;for(let r=0;r<e.buttons.length;r++)if(e.buttons[r]!==t.buttons[r])return!1;return!0}function R4e(e){for(let t=0;t<e.axes.length;t++)if(e.axes[t]!==0)return!1;for(let t=0;t<e.buttons.length;t++)if(e.buttons[t]!==0)return!1;return!0}function C4e(e,t){const r=Math.abs(e);return r<t?0:Math.sign(e)*(r-t)/(1-t)}let O4e=class{constructor(t,r){this._element=t,this._input=r,this._hasEventListeners=!1,this._onConnectGamepad=s=>{this._connectGamepad(s.gamepad)},this._onDisconnectGamepad=s=>{const o=s.gamepad,a=o.index,u=this._inputDevices[a];u&&(this._emitGamepadEvent(o,gU(u),!1),this._inputDevices.splice(a,1),this._latestUpdate.splice(a,1),this._input.gamepad.devices.remove(u),this.ensurePollingState())},this._frameTask=null,this._latestUpdate=new Array,this._inputDevices=new Array,this._callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this._forEachGamepad(s=>this._connectGamepad(s)),window.addEventListener("gamepadconnected",this._onConnectGamepad),window.addEventListener("gamepaddisconnected",this._onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this._onConnectGamepad),window.removeEventListener("gamepaddisconnected",this._onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get _eventsEnabled(){return this.supported&&this._inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this._callback=t}_connectGamepad(t){const r=new nL(t);r.deviceType!=="unknown"&&(this._inputDevices[t.index]=r,this._input.gamepad.devices.add(r)),this.ensurePollingState()}ensurePollingState(){this._eventsEnabled?this._startPolling():this._stopPolling()}_startPolling(){this._frameTask==null&&(this._frameTask=ym({update:()=>this._readGamepadState()}))}_stopPolling(){this._frameTask!=null&&(this._frameTask.remove(),this._frameTask=null,this._latestUpdate=new Array)}_readGamepadState(){const t=document.hasFocus(),r=this._element.contains(document.activeElement),i=this._input.gamepad.enabledFocusMode==="document"&&!t||this._input.gamepad.enabledFocusMode==="view"&&!r;this._forEachGamepad(n=>{const s=this._inputDevices[n.index];if(!s)return;const o=this._latestUpdate[n.index],a=gU(s),u=i||R4e(a);o&&(o.timestamp===n.timestamp||!o.active&&u||A4e(o.state,a))||this._emitGamepadEvent(n,a,!u)})}_forEachGamepad(t){const r=window.navigator.getGamepads();for(let i=0;i<r.length;i++){const n=r[i];this._validate(n)&&t(n)}}_emitGamepadEvent(t,r,i){const n=this._latestUpdate[t.index],s=n&&n.active;if(!s&&!i)return;const o=!s&&i?"start":s&&i?"update":"end";this._latestUpdate[t.index]={timestamp:t.timestamp,state:r,active:i},this._callback&&this._callback({device:this._inputDevices[t.index],state:r,action:o})}_validate(t){if(!t||!t.connected)return!1;for(let r=0;r<t.axes.length;r++)if(isNaN(t.axes[r]))return!1;return!0}};const vU=Me("edge"),P4e=Me("chrome"),L4e=Me("ff"),k4e=Me("safari"),wU="esri-view-surface",Kf={touchNone:`${wU}--touch-none`,touchPan:`${wU}--touch-pan`};let xX=class TX{constructor(t,r){this._input=r,this._active={},this._callback=()=>{},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new O4e(t,this._input),this._gamepadSource.onEvent=i=>this._callback("gamepad",i)}destroy(){this._callback=()=>{},this.activeEvents=null,this._activePointerCaptures.forEach(t=>{this._releasePointerCaptureSafe(t)}),this._gamepadSource=cr(this._gamepadSource),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const r in this._active)if(!t||!t.has(r)){const i=this._active[r];this._element.removeEventListener(h$[r],i),delete this._active[r]}t&&t.forEach(r=>{if(!this._active[r]&&h$[r]){const i=(this._eventHandlers[r]||this._handleDefault).bind(this,r);this._element.addEventListener(h$[r],i),this._active[r]=i}}),this._gamepadSource.hasEventListeners=(t==null?void 0:t.has("gamepad"))??!1}setPointerCapture(t,r){r?this._setPointerCatpureSafe(t.pointerId):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?Kf.touchNone:Kf.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?Kf.touchPan:Kf.touchNone)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(Kf.touchNone),this._element.classList.remove(Kf.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_setPointerCatpureSafe(t){try{this._element.setPointerCapture(t),this._activePointerCaptures.add(t)}catch{}}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch{}}_updateNormalizedPointerLikeEvent(t,r){const i=EK(this._element,t);return TX.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),r.x=i.x,r.y=i.y,r}_handleKey(t,r){const{key:i}=r;i&&t==="key-up"&&this._keyDownState.delete(i);const n={native:r,key:i,repeat:!!i&&this._keyDownState.has(i)};i&&t==="key-down"&&this._keyDownState.add(n.key),this._callback(t,n)}_handlePointer(t,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});this._callback(t,i)}_handlePointerPreventDefault(t,r){const i=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,pointerType:r.pointerType,button:r.button,buttons:r.buttons,eventId:this._eventId++});r.preventDefault(),this._callback(t,i)}_handleMouseWheel(t,r){let i=r.deltaY;switch(r.deltaMode){case 0:vU&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}vU?i*=.7:P4e||k4e?i*=.6:L4e&&(i*=1.375);const n=100,s=Math.abs(i);s>n&&(i=i/s*200/(1+Math.exp(-.02*(s-n))));const o=this._updateNormalizedPointerLikeEvent(r,{native:r,x:0,y:0,deltaY:i});this._callback(t,o)}_handlePointerCaptureLost(t,r){this._activePointerCaptures.delete(r.pointerId),this._handleDefault(t,r)}_handleDefault(t,r){const i={native:r};r.preventDefault(),this._callback(t,i)}_preventAltKeyDefault(t){t.key==="Alt"&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}};xX.test={disableSubpixelCoordinates:!1};const h$={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};let N4e=class extends Ai{constructor(){super(!0),this.registerIncoming("context-menu",t=>{t.data.native.preventDefault()})}};const Zi={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500,maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};function Ex(e,t){return Math.abs(t.x-e.x)+Math.abs(t.y-e.y)}function D4e(e,t){const r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)}function F4e(e,t){if(t?(t.radius=0,t.center.x=0,t.center.y=0):t={radius:0,center:Yn()},e.length===0)return t;if(e.length===1)return t.center.x=e[0].x,t.center.y=e[0].y,t;if(e.length===2){const[I,M]=e,[$,A]=[M.x-I.x,M.y-I.y];return t.radius=Math.sqrt($*$+A*A)/2,t.center.x=(I.x+M.x)/2,t.center.y=(I.y+M.y)/2,t}let r=0,i=0;for(let I=0;I<e.length;I++)r+=e[I].x,i+=e[I].y;r/=e.length,i/=e.length;const n=e.map(I=>I.x-r),s=e.map(I=>I.y-i);let o=0,a=0,u=0,c=0,h=0,d=0,y=0;for(let I=0;I<n.length;I++){const M=n[I],$=s[I],A=M*M,R=$*$;o+=A,a+=R,u+=M*$,c+=A*M,h+=R*$,d+=M*R,y+=$*A}const v=.5*(c+d),w=.5*(h+y),b=o*a-u*u,_=(v*a-w*u)/b,x=(o*w-u*v)/b,T=Yn(_+r,x+i);return{radius:Math.sqrt(_*_+x*x+(o+a)/e.length),center:T}}function Qd(e){const{native:t}=e,{pointerId:r,button:i,pointerType:n}=t;return n==="mouse"?`${r}:${i}`:`${n}`}let j4e=class extends Ai{constructor(t=Zi.maximumDoubleClickDelay,r=Zi.maximumDoubleClickDistance,i=Zi.maximumDoubleTouchDelay,n=Zi.maximumDoubleTouchDistance,s=Gm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=r,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=Yn(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new iI({start:(o,a)=>this._dragStart(o,a),update:(o,a)=>this._dragUpdate(a),end:(o,a)=>this._dragEnd(a)}),this.registerIncoming("drag",o=>this._dragEventSeparator.handle(o)),this.registerIncoming("pointer-down",o=>this._handlePointerDown(o)),this.registerIncoming("pointer-up",()=>this._handlePointerUp())}onUninstall(){this._pointerState.forEach(t=>{t.doubleTapTimeout=Tr(t.doubleTapTimeout)})}get hasPendingInputs(){return Dx(this._pointerState,t=>t.doubleTapTimeout!=null)}_clearPointerDown(t){const r=this._pointerState.get(t);r&&(r.doubleTapTimeout=Tr(r.doubleTapTimeout),this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,r,i){const{button:n,buttons:s,pointer:o,pointers:a,pointerType:u,timestamp:c}=i;return{action:t,delta:r,button:n,buttons:s,pointer:o,pointers:a,pointerType:u,timestamp:c}}_dragStart(t,r){if(!this._doubleTapDragReady||t!==1)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:n}=r,{center:s}=i;this._dragStartCenter=s;const o=this._createDoubleTapDragData("begin",Yn(0,0),i);this._doubleTapDrag.emit(o,void 0,n),r.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=t,{center:n}=r,s=Yn(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("update",s,r);this._doubleTapDrag.emit(o,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:r,modifiers:i}=t,{center:n}=r,s=Yn(n.x-this._dragStartCenter.x,n.y-this._dragStartCenter.y),o=this._createDoubleTapDragData("end",s,r);this._doubleTapDrag.emit(o,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:r}=t,i=Qd(r),n=this._pointerState.get(i),{pointerType:s}=r.native;if(n){const o=s==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;this._clearPointerDown(i),Ex(n.event.data,r)>o?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_storePointerDown(t){const{data:r}=t,{pointerType:i}=r.native,n=Qd(r),s=i==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._clearPointerDown(n),s);this._pointerState.set(n,{event:t,doubleTapTimeout:o}),this.refreshHasPendingInputs()}},U4e=class extends Ai{constructor(t){super(!1),this._navigationTouch=t,this._startStateModifiers=new Set,this._activePointerMap=new Map,this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this._handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this._handlePointerUpAndPointerLost.bind(this))}_createPayload(t,r,i,n){return{action:t,pointerType:this._pointerType,button:this._mouseButton,buttons:r.buttons,timestamp:n,pointers:V4e(this._activePointerMap),pointer:r,angle:i.angle,radius:i.radius,center:i.center}}_addPointer(t){const r=t.native.pointerId,i=__(this._activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this._activePointerMap.set(r,n);const s=cS(n,IX(this._activePointerMap));n.initialAngle=s,n.lastAngle=s,this._updatePointerAngles(i)}_updatePointer(t){if(t&&t.x==null&&t.y==null)return;const r=t.native.pointerId,i=this._activePointerMap.get(r);i?i.event=t:this._addPointer(t)}_removePointer(t){const r=__(this._activePointerMap).angle;this._activePointerMap.delete(t),this._updatePointerAngles(r)}_updatePointerAngles(t){const r=__(this._activePointerMap);this._activePointerMap.forEach(i=>{i.initialAngle=cS(i,r)-t,i.lastAngle=cS(i,r)-t})}_emitEvent(t,r,i){const n=__(this._activePointerMap);this._drag.emit(this._createPayload(t,r,n,i),void 0,this._startStateModifiers)}_handlePointerUpAndPointerLost(t){const r=t.data.native.pointerId,i=t.timestamp;this._activePointerMap.get(r)&&(this._activePointerMap.size===1?(this._updatePointer(t.data),!this._isCurrentDragSuppressed&&this._emitEvent("end",t.data,i),this._isDragging=!1,this._isCurrentDragSuppressed=!1,this._removePointer(r)):(this._removePointer(r),this._emitEvent("removed",t.data,t.timestamp)))}_handlePointerDrag(t){const r=t.data,i=r.currentEvent,n=t.timestamp;switch(r.action){case"start":case"update":this._isDragging?this._activePointerMap.has(i.native.pointerId)?(this._updatePointer(i),!this._isCurrentDragSuppressed&&this._emitEvent("update",i,n)):(this._addPointer(i),this._emitEvent("added",i,n),this._isCurrentDragSuppressed=this._isSuppressed):(this._updatePointer(i),this._pointerType=t.data.startEvent.pointerType,this._mouseButton=t.data.startEvent.button,this._startStateModifiers=t.modifiers,this._isDragging=!0,this._isCurrentDragSuppressed=this._isSuppressed,!this._isCurrentDragSuppressed&&this._emitEvent("start",i,n))}}get _isSuppressed(){return!!this._navigationTouch&&!this._navigationTouch.browserTouchPanEnabled&&this._pointerType==="touch"&&this._activePointerMap.size===1}};function IX(e){const t=[];return e.forEach(r=>{t.push(Yn(r.event.x,r.event.y))}),F4e(t)}function __(e){const t=IX(e);let r=0;return e.forEach(i=>{let n=cS(i,t),s=n-i.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=i.lastAngle+s,i.lastAngle=n;const o=n-i.initialAngle;r+=o}),r/=e.size||1,{angle:r,radius:t.radius,center:t.center}}function V4e(e){const t=new Map;return e.forEach((r,i)=>t.set(i,r.event)),t}function cS(e,t){const r=e.event,i=r.x-t.center.x,n=r.y-t.center.y;return Math.atan2(n,i)}var bU;(function(e){e[e.Left=0]="Left",e[e.Middle=1]="Middle",e[e.Right=2]="Right",e[e.Back=3]="Back",e[e.Forward=4]="Forward",e[e.Undefined=-1]="Undefined"})(bU||(bU={}));let G4e=class extends Ai{constructor(t=Zi.maximumDoubleClickDelay,r=Zi.maximumDoubleClickDistance,i=Zi.maximumDoubleTouchDelay,n=Zi.maximumDoubleTouchDistance,s=Gm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=r,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",this._handlePointerUp.bind(this))}onUninstall(){this._pointerState.forEach(t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()}),super.onUninstall()}_handlePointerDown(t){const r=t.data,i=Qd(r);if(!this._pointerState.has(i)){const n={downButton:r.native.button,x:r.x,y:r.y,immediateDoubleClick:null};this._pointerState.set(i,n),this.startCapturingPointer(r.native)}}_handlePointerUp(t){const r=t.data,i=Qd(r),n=this._pointerState.get(i);if(n&&n.downButton===r.native.button){const s=n.immediateDoubleClick,o=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;s?(s.timeoutHandle.remove(),Ex(s,t.data)>o?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,s.modifiers),this._removeState(r))):Ex(n,t.data)>o?this._removeState(r):this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,r){const i=t.data.native.pointerType==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay;r.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout(()=>this._removeState(t.data),i)}}_removeState(t){const r=Qd(t);this._pointerState.delete(r),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}},B4e=class extends Ai{constructor(t=Zi.maximumClickDelay,r=Zi.movementUntilMouseDrag,i=Zi.movementUntilPenDrag,n=Zi.movementUntilTouchDrag,s=Zi.holdDelay,o=Gm){super(!1),this._maximumClickDelay=t,this._movementUntilMouseDrag=r,this._movementUntilPenDrag=i,this._movementUntilTouchDrag=n,this._holdDelay=s,this._clock=o,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",a=>{this._handlePointerLoss(a,"pointer-up")}),this.registerIncoming("pointer-capture-lost",a=>{this._handlePointerLoss(a,"pointer-capture-lost")}),this.registerIncoming("pointer-cancel",a=>{this._handlePointerLoss(a,"pointer-cancel")}),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach(t=>{t.holdTimeout=Tr(t.holdTimeout)}),super.onUninstall()}_handlePointerDown(t){const r=t.data,i=r.native.pointerId;let n=null;this._pointerState.size===0&&(n=this._clock.setTimeout(()=>{const o=this._pointerState.get(i);if(o){if(!o.isDragging){const a=o.previousEvent;this._pointerHold.emit(a,void 0,t.modifiers),o.holdEmitted=!0}o.holdTimeout=null}},this._holdDelay));const s={startEvent:r,previousEvent:r,startTimestamp:t.timestamp,isDragging:!1,downButton:r.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,s),this.startCapturingPointer(r.native),this._moveHandle.resume(),this._pointerState.size>1&&this._startDragging(t)}_createPointerDragData(t,r,i){return{action:t,startEvent:r.startEvent,previousEvent:r.previousEvent,currentEvent:i}}_handlePointerMove(t){const r=t.data,i=r.native.pointerId,n=this._pointerState.get(i);n&&(n.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",n,r),void 0,n.modifiers):D4e(r,n.startEvent)>this._getDragThreshold(r.native.pointerType)&&this._startDragging(t),n.previousEvent=r)}_getDragThreshold(t){switch(t){case"touch":return this._movementUntilTouchDrag;case"pen":return this._movementUntilPenDrag;default:return this._movementUntilMouseDrag}}_startDragging(t){const r=t.data,i=r.native.pointerId;this._pointerState.forEach(n=>{n.holdTimeout!=null&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,r)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp))})}_handlePointerLoss(t,r){const i=t.data,n=i.native.pointerId,s=this._pointerState.get(n);s&&(s.holdTimeout!=null&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",s,r==="pointer-up"?i:s.previousEvent),void 0,s.modifiers):r==="pointer-up"&&s.downButton===i.native.button&&t.timestamp-s.startTimestamp<=this._maximumClickDelay&&!s.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(n),this.stopCapturingPointer(i.native),this._pointerState.size===0&&this._moveHandle.pause())}},z4e=class extends Ai{constructor(t=Zi.maximumDoubleClickDelay,r=Zi.maximumDoubleClickDistance,i=Zi.maximumDoubleTouchDelay,n=Zi.maximumDoubleTouchDistance,s=Gm){super(!1),this._maximumDoubleClickDelay=t,this._maximumDoubleClickDistance=r,this._maximumDoubleTouchDelay=i,this._maximumDoubleTouchDistance=n,this._clock=s,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this))}onUninstall(){this._pointerState.forEach(t=>t.doubleClickTimer=Tr(t.doubleClickTimer))}get hasPendingInputs(){return Dx(this._pointerState,t=>t.doubleClickTimer!=null)}_clearDoubleClickTimer(t,r){const i=this._pointerState.get(t);i&&(i.doubleClickTimer=Tr(i.doubleClickTimer),r&&this._click.emit(i.event.data,void 0,i.event.modifiers),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const r=this._pointerState.get(t);r.pointerDownCount===1&&this._click.emit(r.event.data,void 0,r.event.modifiers),r.doubleClickTimer=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}_getPointerId(t){const{pointerId:r,pointerType:i,button:n}=t.native;return i==="mouse"?`${r}:${n}`:`${i}`}_handleImmediateClick(t){const r=t.data,{pointerType:i}=r.native,n=this._getPointerId(r);if(!this._pointerState.has(n))return void this._startClick(t);const s=this._pointerState.get(n),{data:o,modifiers:a}=s.event,u=i==="touch"?this._maximumDoubleTouchDistance:this._maximumDoubleClickDistance;Ex(o,r)>u?(this._clearDoubleClickTimer(n,!0),this._startClick(t)):(this._clearDoubleClickTimer(n,!1),s.pointerDownCount===2&&this._doubleClick.emit(o,void 0,a))}_handlePointerDown(t){const r=Qd(t.data),i=this._pointerState.get(r);i&&(i.pointerDownCount+=1)}_startClick(t){const{data:r}=t,{native:{pointerType:i}}=r,n=Qd(r),s=i==="touch"?this._maximumDoubleTouchDelay:this._maximumDoubleClickDelay,o=this._clock.setTimeout(()=>this._doubleClickTimeoutExceeded(n),s);this._pointerState.set(n,{event:t,doubleClickTimer:o,pointerDownCount:1}),this.refreshHasPendingInputs()}};const S_={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let pd=class extends De{initialize(){const t=()=>{var r;return(r=this.view)==null?void 0:r.ready};this.addHandles([hf(()=>!t(),()=>this._disconnect()),hf(t,()=>this._connect())])}destroy(){this._disconnect()}get latestPointerType(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerType}get latestPointerLocation(){var t;return(t=this._inputManager)==null?void 0:t.latestPointerLocation}get multiTouchActive(){var t;return((t=this._inputManager)==null?void 0:t.multiTouchActive)??!1}isModifierKeyDown(t){var r;return((r=this._inputManager)==null?void 0:r.isModifierKeyDown(t))??!1}_disconnect(){this.view.viewEvents.disconnect(),this._inputManager=cr(this._inputManager)}_connect(){const t=this.view.surface,r=new xX(t,this.view.input),i=[new G4e,new B4e,new z4e,new U4e(this.view.navigation),new j4e],n=new Eo({eventSource:r,recognizers:i});n.installHandlers("prevent-context-menu",[new N4e],Sp.INTERNAL),n.installHandlers("navigation",[new E4e(this.view),new w4e(this.view),new $4e(this.view),new mU(this.view),new mU(this.view,[S_.counter]),new f4e(this.view,"primary"),new x4e(this.view,S_.pan),new I4e(this.view,S_.zoom),new T4e(this.view,S_.rotate),new y4e(this.view,"secondary"),new d4e(this.view,"touch")],Sp.INTERNAL),this.view.viewEvents.connect(n),this._source=r,this._inputManager=n,Ue(()=>{var s,o;return(o=(s=this.view)==null?void 0:s.navigation)==null?void 0:o.browserTouchPanEnabled},s=>{this._source&&(this._source.browserTouchPanningEnabled=!s)},Xi)}get test(){return{inputManager:this._inputManager}}};l([p()],pd.prototype,"view",void 0),l([p()],pd.prototype,"latestPointerType",null),l([p()],pd.prototype,"latestPointerLocation",null),l([p()],pd.prototype,"multiTouchActive",null),pd=l([k("esri.views.2d.input.MapViewInputManager")],pd);const q4e=pd;var _U,SU,xU,MX={exports:{}};_U=MX,SU=function(){function e(n,s,o,a,u){t(n,s,o||0,a||n.length-1,u||i)}function t(n,s,o,a,u){for(;a>o;){if(a-o>600){var c=a-o+1,h=s-o+1,d=Math.log(c),y=.5*Math.exp(2*d/3),v=.5*Math.sqrt(d*y*(c-y)/c)*(h-c/2<0?-1:1);t(n,s,Math.max(o,Math.floor(s-h*y/c+v)),Math.min(a,Math.floor(s+(c-h)*y/c+v)),u)}var w=n[s],b=o,_=a;for(r(n,o,s),u(n[a],w)>0&&r(n,o,a);b<_;){for(r(n,b,_),b++,_--;u(n[b],w)<0;)b++;for(;u(n[_],w)>0;)_--}u(n[o],w)===0?r(n,o,_):r(n,++_,a),_<=s&&(o=_+1),s<=_&&(a=_-1)}}function r(n,s,o){var a=n[s];n[s]=n[o],n[o]=a}function i(n,s){return n<s?-1:n>s?1:0}return e},(xU=SU())!==void 0&&(_U.exports=xU);const H4e=C4(MX.exports);function Ax(e,t){if(!(this instanceof Ax))return new Ax(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&(typeof t=="function"?this.toBBox=t:this._initFormat(t)),this.clear()}function W4e(e,t,r){if(!r)return t.indexOf(e);for(var i=0;i<t.length;i++)if(r(e,t[i]))return i;return-1}function Xf(e,t){h1(e,0,e.children.length,t,e)}function h1(e,t,r,i,n){n||(n=Ly(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var s,o=t;o<r;o++)s=e.children[o],d1(n,e.leaf?i(s):s);return n}function d1(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function TU(e,t){return e.minX-t.minX}function IU(e,t){return e.minY-t.minY}function d$(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function x_(e){return e.maxX-e.minX+(e.maxY-e.minY)}function J4e(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function Z4e(e,t){var r=Math.max(e.minX,t.minX),i=Math.max(e.minY,t.minY),n=Math.min(e.maxX,t.maxX),s=Math.min(e.maxY,t.maxY);return Math.max(0,n-r)*Math.max(0,s-i)}function f$(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function T_(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function Ly(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function MU(e,t,r,i,n){for(var s,o=[t,r];o.length;)(r=o.pop())-(t=o.pop())<=i||(s=t+Math.ceil((r-t)/i/2)*i,H4e(e,s,t,r,n),o.push(t,s,s,r))}Ax.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,r=[],i=this.toBBox;if(!T_(e,t))return r;for(var n,s,o,a,u=[];t;){for(n=0,s=t.children.length;n<s;n++)o=t.children[n],T_(e,a=t.leaf?i(o):o)&&(t.leaf?r.push(o):f$(e,a)?this._all(o,r):u.push(o));t=u.pop()}return r},collides:function(e){var t=this.data,r=this.toBBox;if(!T_(e,t))return!1;for(var i,n,s,o,a=[];t;){for(i=0,n=t.children.length;i<n;i++)if(s=t.children[i],T_(e,o=t.leaf?r(s):s)){if(t.leaf||f$(e,o))return!0;a.push(s)}t=a.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,r=e.length;t<r;t++)this.insert(e[t]);return this}var i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(e){return e!=null&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=Ly([]),this},remove:function(e,t){if(e==null)return this;for(var r,i,n,s,o=this.data,a=this.toBBox(e),u=[],c=[];o||u.length;){if(o||(o=u.pop(),i=u[u.length-1],r=c.pop(),s=!0),o.leaf&&(n=W4e(e,o.children,t))!==-1)return o.children.splice(n,1),u.push(o),this._condense(u),this;s||o.leaf||!f$(o,a)?i?(r++,o=i.children[r],s=!1):o=null:(u.push(o),c.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:TU,compareMinY:IU,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var r=[];e;)e.leaf?t.push.apply(t,e.children):r.push.apply(r,e.children),e=r.pop();return t},_build:function(e,t,r,i){var n,s=r-t+1,o=this._maxEntries;if(s<=o)return Xf(n=Ly(e.slice(t,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(s)/Math.log(o)),o=Math.ceil(s/Math.pow(o,i-1))),(n=Ly([])).leaf=!1,n.height=i;var a,u,c,h,d=Math.ceil(s/o),y=d*Math.ceil(Math.sqrt(o));for(MU(e,t,r,y,this.compareMinX),a=t;a<=r;a+=y)for(MU(e,a,c=Math.min(a+y-1,r),d,this.compareMinY),u=a;u<=c;u+=d)h=Math.min(u+d-1,c),n.children.push(this._build(e,u,h,i-1));return Xf(n,this.toBBox),n},_chooseSubtree:function(e,t,r,i){for(var n,s,o,a,u,c,h,d;i.push(t),!t.leaf&&i.length-1!==r;){for(h=d=1/0,n=0,s=t.children.length;n<s;n++)u=d$(o=t.children[n]),(c=J4e(e,o)-u)<d?(d=c,h=u<h?u:h,a=o):c===d&&u<h&&(h=u,a=o);t=a||t.children[0]}return t},_insert:function(e,t,r){var i=this.toBBox,n=r?e:i(e),s=[],o=this._chooseSubtree(n,this.data,t,s);for(o.children.push(e),d1(o,n);t>=0&&s[t].children.length>this._maxEntries;)this._split(s,t),t--;this._adjustParentBBoxes(n,s,t)},_split:function(e,t){var r=e[t],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var s=this._chooseSplitIndex(r,n,i),o=Ly(r.children.splice(s,r.children.length-s));o.height=r.height,o.leaf=r.leaf,Xf(r,this.toBBox),Xf(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(e,t){this.data=Ly([e,t]),this.data.height=e.height+1,this.data.leaf=!1,Xf(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,r){var i,n,s,o,a,u,c,h;for(u=c=1/0,i=t;i<=r-t;i++)o=Z4e(n=h1(e,0,i,this.toBBox),s=h1(e,i,r,this.toBBox)),a=d$(n)+d$(s),o<u?(u=o,h=i,c=a<c?a:c):o===u&&a<c&&(c=a,h=i);return h},_chooseSplitAxis:function(e,t,r){var i=e.leaf?this.compareMinX:TU,n=e.leaf?this.compareMinY:IU;this._allDistMargin(e,t,r,i)<this._allDistMargin(e,t,r,n)&&e.children.sort(i)},_allDistMargin:function(e,t,r,i){e.children.sort(i);var n,s,o=this.toBBox,a=h1(e,0,t,o),u=h1(e,r-t,r,o),c=x_(a)+x_(u);for(n=t;n<r-t;n++)s=e.children[n],d1(a,e.leaf?o(s):s),c+=x_(a);for(n=r-t-1;n>=t;n--)s=e.children[n],d1(u,e.leaf?o(s):s),c+=x_(u);return c},_adjustParentBBoxes:function(e,t,r){for(var i=r;i>=0;i--)d1(t[i],e)},_condense:function(e){for(var t,r=e.length-1;r>=0;r--)e[r].children.length===0?r>0?(t=e[r-1].children).splice(t.indexOf(e[r]),1):this.clear():Xf(e[r],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};let $U=class $X{constructor(t,r){this.key=new Rl(0,0,0,0),this.bounds=ws(),this.objectIds=new Set,this.key.set(r);const i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level}get lod(){return this.tileInfoView.getLODInfoAt(this.key)}get id(){return this.key.id}get extent(){return Ne.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createArcadeEvaluationOptions(t){return{$view:{scale:this.scale,timeZone:t}}}createChildTiles(){const t=this.key.getChildKeys(),r=Jn.acquire();for(let i=0;i<t.length;i++)r[i]=new $X(this.tileInfoView,t[i]);return r}getQuantizationParameters(){return JJ.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}};const _h={added:[],removed:[]},y$=new Set,Y4e=new Rl(0,0,0,0);function K4e(e,t){const r=Xn(t);if(!r)return null;const[i,n]=r.valid;return e[2]>n?[ws([e[0],e[1],n,e[3]]),ws([i,e[1],i+e[2]-n,e[3]])]:e[0]<i?[ws([i,e[1],e[2],e[3]]),ws([n-(i-e[0]),e[1],n,e[3]])]:null}let X4e=class extends Zu{constructor(t){super(),this._tiles=new Map,this._index=Ax(9,Me("esri-csp-restrictions")?r=>({minX:r.bounds[0],minY:r.bounds[1],maxX:r.bounds[2],maxY:r.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}getIntersectingTiles(t){if(!t||pB(t)===0||hB(t)===0)return[];const r=K4e(t,this.tileScheme.spatialReference);return r!=null?[...new Set([...this.boundsIntersections(r[0]),...this.boundsIntersections(r[1])])]:this.boundsIntersections(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const r={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const n=new $U(this.tileScheme,i);this._tiles.set(i,n),this._index.insert(n),r.added.push(n)}for(const i of t.removed)if(this.has(i)){const n=this.get(i);this._tiles.delete(i),this._index.remove(n),r.removed.push(n)}this.tiles.length=0,this._tiles.forEach(i=>this.tiles.push(i)),(r.added.length||r.removed.length)&&this.emit("update",r)}setViewState(t){const r=this.tileScheme.getTileCoverage(t,0);if(!r)return;const{spans:i,lodInfo:n}=r,{level:s}=n;if(i.length>0)for(const{row:o,colFrom:a,colTo:u}of i)for(let c=a;c<=u;c++){const h=Y4e.set(s,o,n.normalizeCol(c),n.getWorldForColumn(c)).id;if(y$.add(h),!this.has(h)){const d=new $U(this.tileScheme,h);this._tiles.set(h,d),this._index.insert(d),this.tiles.push(d),_h.added.push(d)}}for(let o=this.tiles.length-1;o>=0;o--){const a=this.tiles[o];y$.has(a.id)||(this._tiles.delete(a.id),this.tiles.splice(o,1),this._index.remove(a),_h.removed.push(a))}(_h.added.length||_h.removed.length)&&this.emit("update",_h),$v.pool.release(r),y$.clear(),_h.added.length=0,_h.removed.length=0}},Qc=class extends De{constructor(){super(...arguments),this.color=new ve([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25,this.multiHighlightEnabled=!1}equals(t){return this.color.equals(t.color)&&(this.haloColor||this.color).equals(t.haloColor||t.color)&&this.haloOpacity===t.haloOpacity&&this.fillOpacity===t.fillOpacity&&this.multiHighlightEnabled===t.multiHighlightEnabled}};l([p({type:ve})],Qc.prototype,"color",void 0),l([p({type:ve})],Qc.prototype,"haloColor",void 0),l([p()],Qc.prototype,"haloOpacity",void 0),l([p()],Qc.prototype,"fillOpacity",void 0),l([p()],Qc.prototype,"multiHighlightEnabled",void 0),Qc=l([k("esri.views.2d.support.HighlightOptions")],Qc);const EX=Qc;async function Q4e(e,t,r){const i=RK(t)?AK(e,t):t;if(!e.ready||isNaN(i.x)||isNaN(i.y))return{screenPoint:i,results:[]};let n=new Set;const s=new Set;let o=!1,a=null,u=null;r!=null&&r.include?AU(r.include,EU(e,y=>{n.add(y),m$(y,v=>s.add(v))},(y,v)=>{s.add(y),n.add(v)},y=>{a||(a=new Set),a.add(y)},y=>n.add(y),()=>o=!0)):(o=!0,n=new Set(e.allLayerViews),n.forEach(y=>{m$(y,v=>s.add(v))})),r!=null&&r.exclude&&AU(r.exclude,EU(e,y=>{n.delete(y),m$(y,v=>s.delete(v))},y=>s.delete(y),y=>{u||(u=new Set),u.add(y)}));const c=e.allLayerViews.filter(y=>!y.suspended&&n.has(y)).reverse(),h=e.toMap(i);let d=[...o?e.graphicsView.hitTest(h).map(y=>({type:"graphic",graphic:y,layer:null,mapPoint:h})):[],...await Promise.all(c.map(y=>y.hitTest(h,i)).toArray())].filter(Qn).flat().filter(Qn);return d=d.filter(y=>{var v;return y.type!=="graphic"||((v=y.layer)==null?void 0:v.type)!=="subtype-group"||s.has(y.graphic.layer)}),a&&(d=d.filter(y=>!("graphic"in y)||!y.graphic||(a==null?void 0:a.has(XC(y.graphic))))),u&&(d=d.filter(y=>!("graphic"in y)||!y.graphic||!(u!=null&&u.has(XC(y.graphic))))),{screenPoint:i,results:d}}function EU(e,t,r,i,n,s){return o=>{if(o instanceof Da){if(o.layer===e)s==null||s();else{const a=e.allLayerViews.find(u=>u.layer===o.layer);a&&(n==null||n(a))}i(XC(o))}else if(o.type==="subtype-sublayer"){const a=e.allLayerViews.find(u=>u.layer===o.parent);a&&r(o,a)}else{const a=e.allLayerViews.find(u=>u.layer===o);a&&t(a)}}}function AU(e,t){if(e)if(MS(e))for(const r of e)if(MS(r))for(const i of r)t(i);else t(r);else t(e)}function XC(e){var r,i;const t=e.getObjectId();return t?`${((r=e.layer)==null?void 0:r.uid)??((i=e.sourceLayer)==null?void 0:i.uid)??"MapView"}/${t}`:`"MapView/${e.uid}`}function m$({layer:e},t){e.type==="subtype-group"&&e.sublayers.forEach(r=>{t(r)})}function ePe(e,t,r){const{ctx:i,canvas:n}=AX(e,r),s=i.getImageData(0,0,e.width,e.height),o=iPe(n,t);return RX(n),{dataUrl:o,data:s}}function tPe(e,t){const{ctx:r,canvas:i}=AX(e,t),n=r.getImageData(0,0,e.width,e.height);return RX(i),n}function AX(e,t){const r=rPe();t.premultipliedAlpha&&lPe(e),r.width=e.width,r.height=e.height;const i=r.getContext("2d",{willReadFrequently:!0});return i.putImageData(e,0,0),t.flipY&&aPe(i),{ctx:i,canvas:r}}function RX(e){e.width=0,e.height=0}function rPe(){return g$==null&&(g$=document.createElement("canvas")),g$}let g$=null;function iPe(e,t){const r=uPe[t.format],i=t.quality/100;return e.toDataURL(r,i)}function nPe(e,t){const r=oPe(e),i=pPe[r];return{format:r,quality:ka(t??i,0,100)}}function sPe(e,t){return t/Math.max(e[0],e[1])}function eGe(e,t,r,i=0,n=0,s=e.width-i,o=e.height-n,a=!1){const{data:u}=e,{width:c,height:h,data:d}=t,y=s/c,v=o/h,w=Math.ceil(y/2),b=Math.ceil(v/2),_=e.width;for(let x=0;x<h;x++)for(let T=0;T<c;T++){const I=4*(T+(a?h-x-1:x)*c);let M=0,$=0,A=0,R=0,L=0,C=0;const U=(x+.5)*v;for(let F=Math.floor(x*v);F<(x+1)*v;F++){const j=Math.abs(U-(F+.5))/b,q=(T+.5)*y,K=j*j;for(let X=Math.floor(T*y);X<(T+1)*y;X++){const ne=Math.abs(q-(X+.5))/w,re=Math.sqrt(K+ne*ne);if(re>=1)continue;let ae=2*re*re*re-3*re*re+1;const he=4*(i+X+(n+F)*_);C+=ae*u[he+3],$+=ae,A+=ae*u[he],R+=ae*u[he+1],L+=ae*u[he+2],M+=ae}}d[I]=A/M,d[I+1]=R/M,d[I+2]=L/M,d[I+3]=C/$}return t}function oPe(e){switch(e){case"png":case"jpg":case"jpeg":return e;default:return cPe}}function aPe(e){e.save(),e.globalCompositeOperation="copy",e.scale(1,-1),e.translate(0,-e.canvas.height),e.drawImage(e.canvas,0,0),e.restore()}function lPe(e){const t=e.data,r=t.length;for(let i=0;i<r;i+=4){const n=t[i+3];if(n!==255&&n>0){const s=255/n;t[i]=t[i]*s,t[i+1]=t[i+1]*s,t[i+2]=t[i+2]*s}}}const uPe={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},RU=98,cPe="png",pPe={png:100,jpg:RU,jpeg:RU},CX={flipY:!0,premultipliedAlpha:!0};async function hPe(e,t){const r=await OX(e,t),{format:i,quality:n}=nPe(t==null?void 0:t.format,t==null?void 0:t.quality);return ePe(r,{format:i,quality:n,rotation:0,disableDecorations:!1},CX)}async function dPe(e,t){const r=await OX(e,t);return tPe(r,CX)}function OX(e,t){const r=mPe(t||{},yPe(e.stage,e.size),e.size,e.padding),i=fPe(t,e.allLayerViews);return e.stage.takeScreenshot(r,i,e.backgroundColor,t==null?void 0:t.rotation)}function fPe(e={},t){if(!e.layers)return;const r=[];return e.layers.forEach(i=>{const n=t.find(s=>s.layer.id===i.id);n!=null&&n.container&&r.push(n.container)}),r}function yPe(e,t){return Math.min(4,sPe(t,Math.min(4096,e.context.parameters.maxTextureSize)))}function mPe(e,t,r,i){e.ignorePadding&&(i={left:0,right:0,top:0,bottom:0});let n=null;e.width!=null&&e.height!=null?n=[e.width,e.height]:e.width==null&&e.height!=null?n=[e.height,e.height]:e.width!=null&&e.height==null?n=[e.width,e.width]:e.width==null&&e.height==null&&(n=null);const s=r[0]-(i.left+i.right),o=r[1]-(i.top+i.bottom);let a,u,c=e.area||{x:0,y:0,width:s,height:o};if(n){const h=s/o,d=n[0]/n[1];if(d>h){const y=c.width/d;c={x:c.x,y:Math.round(c.y+(c.height-y)/2),width:c.width,height:Math.round(y)}}else{const y=c.height*d;c={x:Math.round(c.x+(c.width-y)/2),y:c.y,width:Math.round(y),height:c.height}}}else n=[c.width,c.height];return n[0]>c.width?(a=Math.min(n[0]/c.width,t),u=n[0]/c.width/a):(a=1,u=n[0]/c.width),{cropArea:{x:Math.round((c.x+i.left)*a),y:Math.round((c.y+i.top)*a),width:Math.round(c.width*a),height:Math.round(c.height*a)},outputScale:u,resolutionScale:a}}const CU=160;let f1=class extends De{constructor(){super(...arguments),this._timer=void 0}get stationary(){return!this._timer}flip(){this._timestamp=performance.now(),this._timer==null&&(this._timer=setInterval(()=>{performance.now()-this._timestamp>=CU&&this.clear()},CU))}clear(){this._timer&&(clearInterval(this._timer),this._timer=void 0)}};l([p()],f1.prototype,"_timer",void 0),l([p()],f1.prototype,"stationary",null),f1=l([k("esri.views.2d.support.StationaryManager")],f1);const gPe=e=>e.includes("Brush");let PX=class{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),gPe(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark(`Esri.${t}`))}};function vPe(e){const t=u5();return t.available?e==="3d"&&t.majorPerformanceCaveat?new z("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):t.supportsHighPrecisionFragment?t.supportsVertexShaderSamplers?null:new z("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new z("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new z("webgl:required","WebGL2 is required but not supported.",new Error().stack)}function wPe(e){return e&&"nodeType"in e}function bPe(e){return e&&typeof e.render=="function"}const OU={component:"esri-component"};let hd=class extends De{constructor(){super(...arguments),this.widget=null}destroy(){var t;this.node=null,(t=this.widget)==null||t.destroy()}get id(){var t,r;return this._get("id")??((t=this.widget)==null?void 0:t.id)??((r=this.node)==null?void 0:r.id)}set id(t){this._set("id",t)}set node(t){const r=this._get("node");t!==r&&(t&&t.classList.add(OU.component),r&&r.classList.remove(OU.component),this._set("node",t))}castNode(t){var r;return(r=this.widget)==null||r.destroy(),t?typeof t=="string"||wPe(t)?(this._set("widget",null),eL(t)):(bPe(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};l([p()],hd.prototype,"id",null),l([p()],hd.prototype,"node",null),l([Tt("node")],hd.prototype,"castNode",null),l([p({readOnly:!0})],hd.prototype,"widget",void 0),hd=l([k("esri.views.ui.Component")],hd);const pS=hd,LX="calcite-mode-";function _Pe(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-mode-name").replaceAll(/\s|'|"/g,"")}function SPe(){return _Pe().startsWith("dark")}function xPe(){return`${LX}${SPe()?"dark":"light"}`}function TPe(e){IPe(e),e.classList.add(xPe())}function IPe(e){Array.from(e.classList).forEach(t=>{t.startsWith(LX)&&e.classList.remove(t)})}const MPe={left:0,top:0,bottom:0,right:0},kX={bottom:30,top:15,right:15,left:15},Yl="esri-ui",ls={ui:Yl,corner:`${Yl}-corner`,innerContainer:`${Yl}-inner-container`,manualContainer:`${Yl}-manual-container`,cornerContainer:`${Yl}-corner-container`,topLeft:`${Yl}-top-left`,topRight:`${Yl}-top-right`,bottomLeft:`${Yl}-bottom-left`,bottomRight:`${Yl}-bottom-right`};function $Pe(e){return e&&!e._started&&typeof e.postMixInProperties=="function"&&typeof e.buildRendering=="function"&&typeof e.postCreate=="function"&&typeof e.startup=="function"}function I_(e){return e===0?"0":`${e}px`}function v$(e){const t=typeof e=="object"&&e!==null&&Object.getPrototypeOf(e);return(t===null||t===Object.prototype)&&("component"in e||"index"in e||"position"in e)?e:null}function w$(e,{top:t,bottom:r,left:i,right:n}){e.style.top=t,e.style.bottom=r,e.style.left=i,e.style.right=n}let ll=class extends Zu.EventedAccessor{constructor(e){super(e),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentMap=new Map,this._locale=Zs(),this.view=null,this._applyViewPadding=()=>{const t=this.container;t&&w$(t,this._toPixelPosition(this._getViewPadding()))},this._applyUIPadding=()=>{const t=this._innerContainer;t&&w$(t,this._toPixelPosition(this.padding))},this._initContainers()}initialize(){this.addHandles([Ue(()=>{var e;return[(e=this.view)==null?void 0:e.padding,this.container]},this._applyViewPadding,Xi),Ue(()=>this.padding,this._applyUIPadding,Xi),Ue(()=>[this.container,this._locale],([e,t])=>{e&&e.setAttribute("lang",t)},Xi),JO(e=>{this._locale=e})])}destroy(){this.container=null;for(const e of this._components)e.destroy();this._components.length=0,this._componentMap.clear()}set container(e){const t=this._get("container");e!==t&&(e&&(e.classList.add(ls.ui),TPe(e),this._attachContainers(e)),t&&(t.classList.remove(ls.ui),w$(t,{top:"",bottom:"",left:"",right:""}),eK(t)),this._set("container",e))}get height(){var n;const e=((n=this.view)==null?void 0:n.height)??0;if(e===0)return e;const t=this._getViewPadding(),{top:r,bottom:i}=t;return Math.max(e-r-i,0)}get padding(){return this._get("padding")}set padding(e){this._overrideIfSome("padding",e)}castPadding(e){return typeof e=="number"?{bottom:e,top:e,right:e,left:e}:{...kX,...e}}get width(){var n;const e=((n=this.view)==null?void 0:n.width)??0;if(e===0)return e;const t=this._getViewPadding(),{left:r,right:i}=t;return Math.max(e-r-i,0)}add(e,t){let r,i,n;if(Array.isArray(e))return void e.forEach(o=>this.add(o,t));const s=v$(e);s&&({index:r,position:t,component:e,key:i}=s),t&&typeof t=="object"&&({index:r,key:i,position:t,internal:n}=t),!e||t&&!this._isValidPosition(t)||this._add(e,t,r,i,n)}remove(e,t){var i;if(!e)return;if(Array.isArray(e))return e.map(n=>this.remove(n,t));const r=this._find(e);if(r){if(this._componentMap.has(r)&&((i=this._componentMap.get(r))==null?void 0:i.key)!==t)return;const n=this._components.indexOf(r),s=r.node.parentNode;return s==null||s.removeChild(r.node),this._componentMap.delete(r),this._components.splice(n,1)[0]}}empty(e,t={removeInternal:!1}){if(Array.isArray(e)){for(const n of e)this.empty(n,t);return}const r=this._positionNameToContainerLookup[e??"manual"],i=Array.prototype.slice.call(r.children).map(n=>this._findByNode(n)).filter(n=>{var s;return n==null?!1:!(((s=this._componentMap.get(n))==null?void 0:s.internal)??!1)||t.removeInternal});for(const n of i)this.remove(n)}move(e,t){if(Array.isArray(e)&&e.forEach(s=>this.move(s,t)),!e)return;let r;const i=v$(e)||v$(t);if(i&&(r=i.index,t=i.position,e=i.component||e),t&&!this._isValidPosition(t))return;const n=this.remove(e);n&&this.add(n,{position:t,index:r})}find(e){if(!e)return null;const t=this._findById(e);return t&&(t.widget||t.node)}getComponents(e,t={includeInternal:!1}){return e?Array.isArray(e)?e.flatMap(r=>this._getComponentsAtPosition(r,t)):this._getComponentsAtPosition(e,t):this._components.filter(r=>{var i;return t.includeInternal||!((i=this._componentMap.get(r))!=null&&i.internal)}).map(({widget:r,node:i})=>r??i)}getPosition(e){for(const t in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[t].contains(e))return t;return null}_add(e,t,r,i,n){e instanceof pS||(e=new pS({node:e})),this._place({component:e,position:t,index:r}),this._components.push(e),this._componentMap.set(e,{key:i,internal:n})}_find(e){return e?e instanceof pS?this._findByComponent(e):typeof e=="string"?this._findById(e):this._findByNode(e.domNode||e):null}_getViewPadding(){var e;return((e=this.view)==null?void 0:e.padding)??MPe}_attachContainers(e){e.appendChild(this._innerContainer),e.appendChild(this._manualContainer)}_initContainers(){const e=document.createElement("div");e.classList.add(ls.innerContainer,ls.cornerContainer);const t=document.createElement("div");t.classList.add(ls.innerContainer,ls.manualContainer);const r=document.createElement("div");r.classList.add(ls.topLeft,ls.corner),e.appendChild(r);const i=document.createElement("div");i.classList.add(ls.topRight,ls.corner),e.appendChild(i);const n=document.createElement("div");n.classList.add(ls.bottomLeft,ls.corner),e.appendChild(n);const s=document.createElement("div");s.classList.add(ls.bottomRight,ls.corner),e.appendChild(s),this._innerContainer=e,this._manualContainer=t;const o=B5e();this._cornerNameToContainerLookup={"top-left":r,"top-right":i,"bottom-left":n,"bottom-right":s,"top-leading":o?i:r,"top-trailing":o?r:i,"bottom-leading":o?s:n,"bottom-trailing":o?n:s},this._positionNameToContainerLookup={manual:t,...this._cornerNameToContainerLookup}}_isValidPosition(e){return!!this._positionNameToContainerLookup[e]}_place(e){const t=e.position??"manual",{component:r,index:i}=e,n=this._positionNameToContainerLookup[t],s=i!=null&&i>-1;if($Pe(r.widget)&&r.widget.startup(),!s)return void n.appendChild(r.node);const o=Array.from(n.children);if(i===0)return void(n.firstChild?F7(r.node,n.firstChild):n.appendChild(r.node));i>=o.length?n.appendChild(r.node):F7(r.node,o[i])}_toPixelPosition(e){return{top:I_(e.top),left:I_(e.left),right:I_(e.right),bottom:I_(e.bottom)}}_findByComponent(e){return this._components.find(t=>t===e)??null}_findById(e){return this._components.find(({id:t})=>t===e)??null}_findByNode(e){return this._components.find(({node:t})=>t===e)??null}_getComponentsAtPosition(e,t){const r=this._positionNameToContainerLookup[e];return Array.prototype.slice.call(r.children).map(i=>this._findByNode(i)).filter(Qn).filter(i=>{var n;return t.includeInternal||!((n=this._componentMap.get(i))!=null&&n.internal)}).map(({widget:i,node:n})=>i??n)}};l([p()],ll.prototype,"_locale",void 0),l([p()],ll.prototype,"container",null),l([p()],ll.prototype,"height",null),l([p({value:kX})],ll.prototype,"padding",null),l([Tt("padding")],ll.prototype,"castPadding",null),l([p()],ll.prototype,"view",void 0),l([p()],ll.prototype,"width",null),ll=l([k("esri.views.ui.UI")],ll);const EPe=ll,APe={handleInterceptedEvent:(e,t,r,i)=>(e.scheduleRender(),t.properties[`on${i.type}`].apply(t.properties.bind||r,[i]))},RPe={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{t.charAt(0)==="-"?e.style.setProperty(t,r):e.style[t]=r}},CPe=e=>({...RPe,...e}),OPe=(e,t)=>{const r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r},PPe=(e,t)=>e.find(t),PU=(e,t,r=!1)=>{let i=e;return t.forEach((n,s)=>{const o=i!=null&&i.children?PPe(i.children,a=>a.domNode===n):void 0;r&&!o&&s!==t.length-1||(i=o)}),i},LPe=e=>{let t;const r={...APe,...e},i=CPe(r),n=i.performanceLogger;let s,o=!0,a=!1;const u=[],c=[],h=(y,v,w)=>{var x;let b;i.eventHandlerInterceptor=(T,I,M,$)=>function(A){let R;n("domEvent",A);const L=OPe(A.currentTarget,b.domNode),C=L.some(F=>{var j;return customElements.get((j=F==null?void 0:F.tagName)==null?void 0:j.toLowerCase())});if(A.eventPhase===Event.CAPTURING_PHASE||!C)L.reverse(),R=PU(b.getLastRender(),L);else{const F=A.composedPath(),j=F.slice(F.indexOf(A.currentTarget),F.indexOf(b.domNode)).reverse();R=PU(b.getLastRender(),j,!0)}let U;return R&&(U=r.handleInterceptedEvent(t,R,this,A)),n("domEventProcessed",A),U},(x=r.postProcessProjectionOptions)==null||x.call(r,i);const _=w();b=y(v,_,i),i.eventHandlerInterceptor=void 0,u.push(b),c.push(w),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(b,_)};let d=()=>{if(s=void 0,o){o=!1,n("renderStart",void 0);for(let y=0;y<u.length;y++){const v=c[y]();n("rendered",void 0),u[y].update(v),n("patched",void 0)}n("renderDone",void 0),o=!0}};return r.modifyDoRenderImplementation&&(d=r.modifyDoRenderImplementation(d,u,c)),t={renderNow:d,scheduleRender:()=>{s||a||(s=requestAnimationFrame(d))},stop:()=>{s&&(cancelAnimationFrame(s),s=void 0),a=!0},resume:()=>{a=!1,o=!0,t.scheduleRender()},append:(y,v)=>{h(vp.append,y,v)},insertBefore:(y,v)=>{h(vp.insertBefore,y,v)},merge:(y,v)=>{h(vp.merge,y,v)},replace:(y,v)=>{h(vp.replace,y,v)},detach:y=>{for(let v=0;v<c.length;v++)if(c[v]===y)return c.splice(v,1),u.splice(v,1)[0];throw new Error("renderFunction was not found")}},t};/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.9.0
 */const NX="calcite-mode-auto",DX="calcite-mode-dark",kPe="calcite-mode-light",nGe={autoMode:NX,darkMode:DX,lightMode:kPe,rtl:"calcite--rtl",calciteAnimate:"calcite-animate",calciteAnimateIn:"calcite-animate__in",calciteAnimateInUp:"calcite-animate__in-up",calciteAnimateInDown:"calcite-animate__in-down",calciteAnimateInRight:"calcite-animate__in-right",calciteAnimateInLeft:"calcite-animate__in-left",calciteAnimateInScale:"calcite-animate__in-scale"};var Pu={allRenderFn:!1,cmpDidLoad:!0,cmpDidUnload:!1,cmpDidUpdate:!0,cmpDidRender:!0,cmpWillLoad:!0,cmpWillUpdate:!0,cmpWillRender:!0,connectedCallback:!0,disconnectedCallback:!0,element:!0,event:!0,hasRenderFn:!0,lifecycle:!0,hostListener:!0,hostListenerTargetWindow:!0,hostListenerTargetDocument:!0,hostListenerTargetBody:!0,hostListenerTargetParent:!1,hostListenerTarget:!0,member:!0,method:!0,mode:!0,observeAttribute:!0,prop:!0,propMutable:!0,reflect:!0,scoped:!0,shadowDom:!0,slot:!0,cssAnnotations:!0,state:!0,style:!0,formAssociated:!1,svg:!0,updatable:!0,vdomAttribute:!0,vdomXlink:!0,vdomClass:!0,vdomFunctional:!0,vdomKey:!0,vdomListener:!0,vdomRef:!0,vdomPropOrAttr:!0,vdomRender:!0,vdomStyle:!0,vdomText:!0,watchCallback:!0,taskQueue:!0,hotModuleReplacement:!1,isDebug:!1,isDev:!1,isTesting:!1,hydrateServerSide:!1,hydrateClientSide:!1,lifecycleDOMEvents:!1,lazyLoad:!1,profile:!1,slotRelocation:!0,appendChildSlotFix:!1,cloneNodeFix:!1,hydratedAttribute:!1,hydratedClass:!0,scriptDataOpts:!1,scopedSlotTextContentFix:!1,shadowDomShim:!1,slotChildNodesFix:!1,invisiblePrehydration:!0,propBoolean:!0,propNumber:!0,propString:!0,constructableCSS:!0,cmpShouldUpdate:!0,devTools:!1,shadowDelegatesFocus:!0,initializeNextTick:!1,asyncLoading:!1,asyncQueue:!1,transformTagName:!1,attachStyles:!0,experimentalSlotFixes:!1},NPe=Object.defineProperty,DPe=(e,t)=>{for(var r in t)NPe(e,r,{get:t[r],enumerable:!0})},FPe=e=>{const t=new URL(e,Ui.$resourcesUrl$);return t.origin!==gw.location.origin?t.href:t.pathname},jPe=e=>Ui.$resourcesUrl$=e,LU={},UPe="http://www.w3.org/2000/svg",VPe="http://www.w3.org/1999/xhtml",GPe=e=>e!=null,yL=e=>(e=typeof e,e==="object"||e==="function");function BPe(e){var t,r,i;return(i=(r=(t=e.head)==null?void 0:t.querySelector('meta[name="csp-nonce"]'))==null?void 0:r.getAttribute("content"))!=null?i:void 0}var zPe={};DPe(zPe,{err:()=>FX,map:()=>qPe,ok:()=>QC,unwrap:()=>HPe,unwrapErr:()=>WPe});var QC=e=>({isOk:!0,isErr:!1,value:e}),FX=e=>({isOk:!1,isErr:!0,value:e});function qPe(e,t){if(e.isOk){const r=t(e.value);return r instanceof Promise?r.then(i=>QC(i)):QC(r)}if(e.isErr){const r=e.value;return FX(r)}throw"should never get here"}var HPe=e=>{if(e.isOk)return e.value;throw e.value},WPe=e=>{if(e.isErr)return e.value;throw e.value},vf=(e,t="")=>()=>{},JPe="slot-fb{display:contents}slot-fb[hidden]{display:none}",kU="http://www.w3.org/1999/xlink",jX=(e,t,...r)=>{let i=null,n=null,s=null,o=!1,a=!1;const u=[],c=d=>{for(let y=0;y<d.length;y++)i=d[y],Array.isArray(i)?c(i):i!=null&&typeof i!="boolean"&&((o=typeof e!="function"&&!yL(i))&&(i=String(i)),o&&a?u[u.length-1].$text$+=i:u.push(o?Rx(null,i):i),a=o)};if(c(r),t){t.key&&(n=t.key),t.name&&(s=t.name);{const d=t.className||t.class;d&&(t.class=typeof d!="object"?d:Object.keys(d).filter(y=>d[y]).join(" "))}}if(typeof e=="function")return e(t===null?{}:t,u,KPe);const h=Rx(e,null);return h.$attrs$=t,u.length>0&&(h.$children$=u),h.$key$=n,h.$name$=s,h},Rx=(e,t)=>{const r={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null};return r.$attrs$=null,r.$key$=null,r.$name$=null,r},ZPe={},YPe=e=>e&&e.$tag$===ZPe,KPe={forEach:(e,t)=>e.map(NU).forEach(t),map:(e,t)=>e.map(NU).map(t).map(XPe)},NU=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),XPe=e=>{if(typeof e.vtag=="function"){const r={...e.vattrs};return e.vkey&&(r.key=e.vkey),e.vname&&(r.name=e.vname),jX(e.vtag,r,...e.vchildren||[])}const t=Rx(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},QPe=e=>ELe.map(t=>t(e)).find(t=>!!t),eLe=(e,t)=>e!=null&&!yL(e)?t&4?e==="false"?!1:e===""||!!e:t&2?parseFloat(e):t&1?String(e):e:e,tLe=e=>e,sGe=(e,t,r)=>{const i=tLe(e);return{emit:n=>rLe(i,t,{bubbles:!!(r&4),composed:!!(r&2),cancelable:!!(r&1),detail:n})}},rLe=(e,t,r)=>{const i=Ui.ce(t,r);return e.dispatchEvent(i),i},DU=new WeakMap,iLe=(e,t,r)=>{let i=Px.get(e);CLe&&r?(i=i||new CSSStyleSheet,typeof i=="string"?i=t:i.replaceSync(t)):i=t,Px.set(e,i)},nLe=(e,t,r)=>{var i;const n=UX(t,r),s=Px.get(n);if(e=e.nodeType===11?e:Pa,s)if(typeof s=="string"){e=e.head||e;let o=DU.get(e),a;if(o||DU.set(e,o=new Set),!o.has(n)){{a=Pa.createElement("style"),a.innerHTML=s;const u=(i=Ui.$nonce$)!=null?i:BPe(Pa);u!=null&&a.setAttribute("nonce",u),e.insertBefore(a,e.querySelector("link"))}t.$flags$&4&&(a.innerHTML+=JPe),o&&o.add(n)}}else e.adoptedStyleSheets.includes(s)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,s]);return n},sLe=e=>{const t=e.$cmpMeta$,r=e.$hostElement$,i=t.$flags$,n=vf("attachStyles",t.$tagName$),s=nLe(r.shadowRoot?r.shadowRoot:r.getRootNode(),t,e.$modeName$);i&10&&(r["s-sc"]=s,r.classList.add(s+"-h"),i&2&&r.classList.add(s+"-s")),n()},UX=(e,t)=>"sc-"+(t&&e.$flags$&32?e.$tagName$+"-"+t:e.$tagName$),FU=(e,t,r,i,n,s)=>{if(r!==i){let o=qU(e,t),a=t.toLowerCase();if(t==="class"){const u=e.classList,c=jU(r),h=jU(i);u.remove(...c.filter(d=>d&&!h.includes(d))),u.add(...h.filter(d=>d&&!c.includes(d)))}else if(t==="style"){for(const u in r)(!i||i[u]==null)&&(u.includes("-")?e.style.removeProperty(u):e.style[u]="");for(const u in i)(!r||i[u]!==r[u])&&(u.includes("-")?e.style.setProperty(u,i[u]):e.style[u]=i[u])}else if(t!=="key")if(t==="ref")i&&i(e);else if(!e.__lookupSetter__(t)&&t[0]==="o"&&t[1]==="n"){if(t[2]==="-"?t=t.slice(3):qU(gw,a)?t=a.slice(2):t=a[2]+t.slice(3),r||i){const u=t.endsWith(VX);t=t.replace(aLe,""),r&&Ui.rel(e,t,r,u),i&&Ui.ael(e,t,i,u)}}else{const u=yL(i);if((o||u&&i!==null)&&!n)try{if(e.tagName.includes("-"))e[t]=i;else{const h=i??"";t==="list"?o=!1:(r==null||e[t]!=h)&&(e[t]=h)}}catch{}let c=!1;a!==(a=a.replace(/^xlink\:?/,""))&&(t=a,c=!0),i==null||i===!1?(i!==!1||e.getAttribute(t)==="")&&(c?e.removeAttributeNS(kU,t):e.removeAttribute(t)):(!o||s&4||n)&&!u&&(i=i===!0?"":i,c?e.setAttributeNS(kU,t,i):e.setAttribute(t,i))}}},oLe=/\s/,jU=e=>e?e.split(oLe):[],VX="Capture",aLe=new RegExp(VX+"$"),GX=(e,t,r)=>{const i=t.$elm$.nodeType===11&&t.$elm$.host?t.$elm$.host:t.$elm$,n=e&&e.$attrs$||LU,s=t.$attrs$||LU;for(const o of UU(Object.keys(n)))o in s||FU(i,o,n[o],void 0,r,t.$flags$);for(const o of UU(Object.keys(s)))FU(i,o,n[o],s[o],r,t.$flags$)};function UU(e){return e.includes("ref")?[...e.filter(t=>t!=="ref"),"ref"]:e}var ky,eO,jm,mL=!1,Cx=!1,gL=!1,zs=!1,Ox=(e,t,r,i)=>{var n;const s=t.$children$[r];let o=0,a,u,c;if(mL||(gL=!0,s.$tag$==="slot"&&(ky&&i.classList.add(ky+"-s"),s.$flags$|=s.$children$?2:1)),s.$text$!==null)a=s.$elm$=Pa.createTextNode(s.$text$);else if(s.$flags$&1)a=s.$elm$=Pa.createTextNode("");else{if(zs||(zs=s.$tag$==="svg"),a=s.$elm$=Pa.createElementNS(zs?UPe:VPe,s.$flags$&2?"slot-fb":s.$tag$),zs&&s.$tag$==="foreignObject"&&(zs=!1),GX(null,s,zs),GPe(ky)&&a["s-si"]!==ky&&a.classList.add(a["s-si"]=ky),s.$children$)for(o=0;o<s.$children$.length;++o)u=Ox(e,s,o,a),u&&a.appendChild(u);s.$tag$==="svg"?zs=!1:a.tagName==="foreignObject"&&(zs=!0)}return a["s-hn"]=jm,s.$flags$&3&&(a["s-sr"]=!0,a["s-cr"]=eO,a["s-sn"]=s.$name$||"",a["s-rf"]=(n=s.$attrs$)==null?void 0:n.ref,c=e&&e.$children$&&e.$children$[r],c&&c.$tag$===s.$tag$&&e.$elm$&&Ev(e.$elm$,!1)),a},Ev=(e,t)=>{Ui.$flags$|=1;const r=Array.from(e.childNodes);if(e["s-sr"]&&Pu.experimentalSlotFixes){let i=e;for(;i=i.nextSibling;)i&&i["s-sn"]===e["s-sn"]&&i["s-sh"]===jm&&r.push(i)}for(let i=r.length-1;i>=0;i--){const n=r[i];n["s-hn"]!==jm&&n["s-ol"]&&(xp(qX(n),n,vL(n)),n["s-ol"].remove(),n["s-ol"]=void 0,n["s-sh"]=void 0,gL=!0),t&&Ev(n,t)}Ui.$flags$&=-2},BX=(e,t,r,i,n,s)=>{let o=e["s-cr"]&&e["s-cr"].parentNode||e,a;for(o.shadowRoot&&o.tagName===jm&&(o=o.shadowRoot);n<=s;++n)i[n]&&(a=Ox(null,r,n,e),a&&(i[n].$elm$=a,xp(o,a,vL(t))))},zX=(e,t,r)=>{for(let i=t;i<=r;++i){const n=e[i];if(n){const s=n.$elm$;JX(n),s&&(Cx=!0,s["s-ol"]?s["s-ol"].remove():Ev(s,!0),s.remove())}}},lLe=(e,t,r,i,n=!1)=>{let s=0,o=0,a=0,u=0,c=t.length-1,h=t[0],d=t[c],y=i.length-1,v=i[0],w=i[y],b,_;for(;s<=c&&o<=y;)if(h==null)h=t[++s];else if(d==null)d=t[--c];else if(v==null)v=i[++o];else if(w==null)w=i[--y];else if(M_(h,v,n))Ny(h,v,n),h=t[++s],v=i[++o];else if(M_(d,w,n))Ny(d,w,n),d=t[--c],w=i[--y];else if(M_(h,w,n))(h.$tag$==="slot"||w.$tag$==="slot")&&Ev(h.$elm$.parentNode,!1),Ny(h,w,n),xp(e,h.$elm$,d.$elm$.nextSibling),h=t[++s],w=i[--y];else if(M_(d,v,n))(h.$tag$==="slot"||w.$tag$==="slot")&&Ev(d.$elm$.parentNode,!1),Ny(d,v,n),xp(e,d.$elm$,h.$elm$),d=t[--c],v=i[++o];else{for(a=-1,u=s;u<=c;++u)if(t[u]&&t[u].$key$!==null&&t[u].$key$===v.$key$){a=u;break}a>=0?(_=t[a],_.$tag$!==v.$tag$?b=Ox(t&&t[o],r,a,e):(Ny(_,v,n),t[a]=void 0,b=_.$elm$),v=i[++o]):(b=Ox(t&&t[o],r,o,e),v=i[++o]),b&&xp(qX(h.$elm$),b,vL(h.$elm$))}s>c?BX(e,i[y+1]==null?null:i[y+1].$elm$,r,i,o,y):o>y&&zX(t,s,c)},M_=(e,t,r=!1)=>e.$tag$===t.$tag$?e.$tag$==="slot"?e.$name$===t.$name$:r?!0:e.$key$===t.$key$:!1,vL=e=>e&&e["s-ol"]||e,qX=e=>(e["s-ol"]?e["s-ol"]:e).parentNode,Ny=(e,t,r=!1)=>{const i=t.$elm$=e.$elm$,n=e.$children$,s=t.$children$,o=t.$tag$,a=t.$text$;let u;a===null?(zs=o==="svg"?!0:o==="foreignObject"?!1:zs,o==="slot"&&!mL||GX(e,t,zs),n!==null&&s!==null?lLe(i,n,t,s,r):s!==null?(e.$text$!==null&&(i.textContent=""),BX(i,null,t,s,0,s.length-1)):n!==null&&zX(n,0,n.length-1),zs&&o==="svg"&&(zs=!1)):(u=i["s-cr"])?u.parentNode.textContent=a:e.$text$!==a&&(i.data=a)},HX=e=>{const t=e.childNodes;for(const r of t)if(r.nodeType===1){if(r["s-sr"]){const i=r["s-sn"];r.hidden=!1;for(const n of t)if(n!==r){if(n["s-hn"]!==r["s-hn"]||i!==""){if(n.nodeType===1&&(i===n.getAttribute("slot")||i===n["s-sn"])||n.nodeType===3&&i===n["s-sn"]){r.hidden=!0;break}}else if(n.nodeType===1||n.nodeType===3&&n.textContent.trim()!==""){r.hidden=!0;break}}}HX(r)}},Cu=[],WX=e=>{let t,r,i;for(const n of e.childNodes){if(n["s-sr"]&&(t=n["s-cr"])&&t.parentNode){r=t.parentNode.childNodes;const s=n["s-sn"];for(i=r.length-1;i>=0;i--)if(t=r[i],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==n["s-hn"]&&!Pu.experimentalSlotFixes)if(VU(t,s)){let o=Cu.find(a=>a.$nodeToRelocate$===t);Cx=!0,t["s-sn"]=t["s-sn"]||s,o?(o.$nodeToRelocate$["s-sh"]=n["s-hn"],o.$slotRefNode$=n):(t["s-sh"]=n["s-hn"],Cu.push({$slotRefNode$:n,$nodeToRelocate$:t})),t["s-sr"]&&Cu.map(a=>{VU(a.$nodeToRelocate$,t["s-sn"])&&(o=Cu.find(u=>u.$nodeToRelocate$===t),o&&!a.$slotRefNode$&&(a.$slotRefNode$=o.$slotRefNode$))})}else Cu.some(o=>o.$nodeToRelocate$===t)||Cu.push({$nodeToRelocate$:t})}n.nodeType===1&&WX(n)}},VU=(e,t)=>e.nodeType===1?e.getAttribute("slot")===null&&t===""||e.getAttribute("slot")===t:e["s-sn"]===t?!0:t==="",JX=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(JX)},xp=(e,t,r)=>{const i=e==null?void 0:e.insertBefore(t,r);return uLe(t,e),i},ZX=e=>e?e["s-rsc"]||e["s-si"]||e["s-sc"]||ZX(e.parentElement):void 0,uLe=(e,t)=>{var r,i,n;if(e&&t){const s=e["s-rsc"],o=ZX(t);s&&((r=e.classList)!=null&&r.contains(s))&&e.classList.remove(s),o&&(e["s-rsc"]=o,!((i=e.classList)!=null&&i.contains(o))&&((n=e.classList)==null||n.add(o)))}},cLe=(e,t,r=!1)=>{var i,n,s,o,a;const u=e.$hostElement$,c=e.$cmpMeta$,h=e.$vnode$||Rx(null,null),d=YPe(t)?t:jX(null,null,t);if(jm=u.tagName,c.$attrsToReflect$&&(d.$attrs$=d.$attrs$||{},c.$attrsToReflect$.map(([y,v])=>d.$attrs$[v]=u[y])),r&&d.$attrs$)for(const y of Object.keys(d.$attrs$))u.hasAttribute(y)&&!["key","ref","style","class"].includes(y)&&(d.$attrs$[y]=u[y]);d.$tag$=null,d.$flags$|=4,e.$vnode$=d,d.$elm$=h.$elm$=u.shadowRoot||u,ky=u["s-sc"],mL=(c.$flags$&1)!==0,eO=u["s-cr"],Cx=!1,Ny(h,d,r);{if(Ui.$flags$|=1,gL){WX(d.$elm$);for(const y of Cu){const v=y.$nodeToRelocate$;if(!v["s-ol"]){const w=Pa.createTextNode("");w["s-nr"]=v,xp(v.parentNode,v["s-ol"]=w,v)}}for(const y of Cu){const v=y.$nodeToRelocate$,w=y.$slotRefNode$;if(w){const b=w.parentNode;let _=w.nextSibling;{let x=(i=v["s-ol"])==null?void 0:i.previousSibling;for(;x;){let T=(n=x["s-nr"])!=null?n:null;if(T&&T["s-sn"]===v["s-sn"]&&b===T.parentNode){for(T=T.nextSibling;T===v||T!=null&&T["s-sr"];)T=T==null?void 0:T.nextSibling;if(!T||!T["s-nr"]){_=T;break}}x=x.previousSibling}}(!_&&b!==v.parentNode||v.nextSibling!==_)&&v!==_&&(!v["s-hn"]&&v["s-ol"]&&(v["s-hn"]=v["s-ol"].parentNode.nodeName),xp(b,v,_),v.nodeType===1&&(v.hidden=(s=v["s-ih"])!=null?s:!1)),v&&typeof w["s-rf"]=="function"&&w["s-rf"](v)}else v.nodeType===1&&(r&&(v["s-ih"]=(o=v.hidden)!=null?o:!1),v.hidden=!0)}}Cx&&HX(d.$elm$),Ui.$flags$&=-2,Cu.length=0}if(Pu.experimentalScopedSlotChanges&&c.$flags$&2)for(const y of d.$elm$.childNodes)y["s-hn"]!==jm&&!y["s-sh"]&&(r&&y["s-ih"]==null&&(y["s-ih"]=(a=y.hidden)!=null?a:!1),y.hidden=!0);eO=void 0},pLe=(e,t)=>{},wL=(e,t)=>(e.$flags$|=16,pLe(e,e.$ancestorComponent$),PLe(()=>hLe(e,t))),hLe=(e,t)=>{const r=e.$hostElement$,i=vf("scheduleUpdate",e.$cmpMeta$.$tagName$),n=r;if(!n)throw new Error(`Can't render component <${r.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let s;return t?s=hm(n,"componentWillLoad"):s=hm(n,"componentWillUpdate"),s=GU(s,()=>hm(n,"componentWillRender")),i(),GU(s,()=>fLe(e,n,t))},GU=(e,t)=>dLe(e)?e.then(t):t(),dLe=e=>e instanceof Promise||e&&e.then&&typeof e.then=="function",fLe=async(e,t,r)=>{const i=e.$hostElement$,n=vf("update",e.$cmpMeta$.$tagName$);i["s-rc"],r&&sLe(e);const s=vf("render",e.$cmpMeta$.$tagName$);yLe(e,t,i,r),s(),n(),mLe(e)},BU=null,yLe=(e,t,r,i)=>{try{BU=t,t=t.render&&t.render(),e.$flags$&=-17,e.$flags$|=2,(Pu.hasRenderFn||Pu.reflect)&&(Pu.vdomRender||Pu.reflect)&&(Pu.hydrateServerSide||cLe(e,t,i))}catch(u){mw(u,e.$hostElement$)}return BU=null,null},mLe=e=>{const t=e.$cmpMeta$.$tagName$,r=e.$hostElement$,i=vf("postUpdate",t),n=r;e.$ancestorComponent$,hm(n,"componentDidRender"),e.$flags$&64?(hm(n,"componentDidUpdate"),i()):(e.$flags$|=64,hm(n,"componentDidLoad"),i())},oGe=e=>{{const t=u0(e),r=t.$hostElement$.isConnected;return r&&(t.$flags$&18)===2&&wL(t,!1),r}},hm=(e,t,r)=>{if(e&&e[t])try{return e[t](r)}catch(i){mw(i)}},gLe=(e,t)=>u0(e).$instanceValues$.get(t),vLe=(e,t,r,i)=>{const n=u0(e),s=e,o=n.$instanceValues$.get(t),a=n.$flags$,u=s;r=eLe(r,i.$members$[t][0]);const c=Number.isNaN(o)&&Number.isNaN(r);if(r!==o&&!c){n.$instanceValues$.set(t,r);{if(i.$watchers$&&a&128){const d=i.$watchers$[t];d&&d.map(y=>{try{u[y](r,o,t)}catch(v){mw(v,s)}})}if((a&18)===2){if(u.componentShouldUpdate&&u.componentShouldUpdate(r,o,t)===!1)return;wL(n,!1)}}}},wLe=(e,t,r)=>{var i;const n=e.prototype;if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);const s=Object.entries(t.$members$);s.map(([o,[a]])=>{(a&31||a&32)&&Object.defineProperty(n,o,{get(){return gLe(this,o)},set(u){vLe(this,o,u,t)},configurable:!0,enumerable:!0})});{const o=new Map;n.attributeChangedCallback=function(a,u,c){Ui.jmp(()=>{var h;const d=o.get(a);if(this.hasOwnProperty(d))c=this[d],delete this[d];else{if(n.hasOwnProperty(d)&&typeof this[d]=="number"&&this[d]==c)return;if(d==null){const y=u0(this),v=y==null?void 0:y.$flags$;if(v&&!(v&8)&&v&128&&c!==u){const b=this,_=(h=t.$watchers$)==null?void 0:h[a];_==null||_.forEach(x=>{b[x]!=null&&b[x].call(b,c,u,a)})}return}}this[d]=c===null&&typeof this[d]=="boolean"?!1:c})},e.observedAttributes=Array.from(new Set([...Object.keys((i=t.$watchers$)!=null?i:{}),...s.filter(([a,u])=>u[0]&15).map(([a,u])=>{var c;const h=u[1]||a;return o.set(h,a),u[0]&512&&((c=t.$attrsToReflect$)==null||c.push([a,h])),h})]))}}return e},bLe=async(e,t,r,i)=>{let n;if(!(t.$flags$&32)){t.$flags$|=32,r.$lazyBundleId$;{n=e.constructor;const o=e.localName;customElements.whenDefined(o).then(()=>t.$flags$|=128)}if(n&&n.style){let o=n.style;typeof o!="string"&&(t.$modeName$=QPe(e),t.$modeName$&&(o=o[t.$modeName$]));const a=UX(r,t.$modeName$);if(!Px.has(a)){const u=vf("registerStyles",r.$tagName$);iLe(a,o,!!(r.$flags$&1)),u()}}}t.$ancestorComponent$,wL(t,!0)},zU=e=>{},_Le=e=>{if(!(Ui.$flags$&1)){const t=u0(e),r=t.$cmpMeta$,i=vf("connectedCallback",r.$tagName$);t.$flags$&1?(YX(e,t,r.$listeners$),t!=null&&t.$lazyInstance$?zU(t.$lazyInstance$):t!=null&&t.$onReadyPromise$&&t.$onReadyPromise$.then(()=>zU(t.$lazyInstance$))):(t.$flags$|=1,r.$flags$&12&&SLe(e),r.$members$&&Object.entries(r.$members$).map(([n,[s]])=>{if(s&31&&e.hasOwnProperty(n)){const o=e[n];delete e[n],e[n]=o}}),bLe(e,t,r)),i()}},SLe=e=>{const t=e["s-cr"]=Pa.createComment("");t["s-cn"]=!0,xp(e,t,e.firstChild)},xLe=async e=>{if(!(Ui.$flags$&1)){const t=u0(e);t.$rmListeners$&&(t.$rmListeners$.map(r=>r()),t.$rmListeners$=void 0)}},aGe=(e,t)=>{const r={$flags$:t[0],$tagName$:t[1]};r.$members$=t[2],r.$listeners$=t[3],r.$watchers$=e.$watchers$,r.$attrsToReflect$=[];const i=e.prototype.connectedCallback,n=e.prototype.disconnectedCallback;return Object.assign(e.prototype,{__registerHost(){$Le(this,r)},connectedCallback(){_Le(this),i&&i.call(this)},disconnectedCallback(){xLe(this),n&&n.call(this)},__attachShadow(){this.attachShadow({mode:"open",delegatesFocus:!!(r.$flags$&16)})}}),e.is=r.$tagName$,wLe(e,r)},lGe=(e,t)=>t,YX=(e,t,r,i)=>{r&&r.map(([n,s,o])=>{const a=ILe(e,n),u=TLe(t,o),c=MLe(n);Ui.ael(a,s,u,c),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>Ui.rel(a,s,u,c))})},TLe=(e,t)=>r=>{try{Pu.lazyLoad||e.$hostElement$[t](r)}catch(i){mw(i)}},ILe=(e,t)=>t&4?Pa:t&8?gw:t&16?Pa.body:e,MLe=e=>ALe?{passive:(e&1)!==0,capture:(e&2)!==0}:(e&2)!==0,KX=new WeakMap,u0=e=>KX.get(e),$Le=(e,t)=>{const r={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return YX(e,r,t.$listeners$),KX.set(e,r)},qU=(e,t)=>t in e,mw=(e,t)=>(0,console.error)(e,t),Px=new Map,ELe=[],gw=typeof window<"u"?window:{},Pa=gw.document||{head:{}},uGe=gw.HTMLElement||class{},Ui={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,r,i)=>e.addEventListener(t,r,i),rel:(e,t,r,i)=>e.removeEventListener(t,r,i),ce:(e,t)=>new CustomEvent(e,t)},ALe=(()=>{let e=!1;try{Pa.addEventListener("e",null,Object.defineProperty({},"passive",{get(){e=!0}}))}catch{}return e})(),RLe=e=>Promise.resolve(e),CLe=(()=>{try{return new CSSStyleSheet,typeof new CSSStyleSheet().replaceSync=="function"}catch{}return!1})(),tO=!1,rO=[],XX=[],QX=(e,t)=>r=>{e.push(r),tO||(tO=!0,t&&Ui.$flags$&4?OLe(iO):Ui.raf(iO))},HU=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(r){mw(r)}e.length=0},iO=()=>{HU(rO),HU(XX),(tO=rO.length>0)&&Ui.raf(iO)},OLe=e=>RLe().then(e),cGe=QX(rO,!1),PLe=QX(XX,!0);/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-design-system/blob/main/LICENSE.md for details.
 * v2.9.0
 */function WU(){const{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>e.contains(DX)||e.contains(NX)&&t?"dark":"light",i=o=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:o}})),n=o=>{s!==o&&i(o),s=o};let s=r();i(s),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>n(o.matches?"dark":"light")),new MutationObserver(()=>n(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function LLe(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?WU():document.addEventListener("DOMContentLoaded",()=>WU(),{once:!0}))}const kLe=LLe;kLe();let eQ;function NLe(){try{FPe(".")}catch{jPe(Js(Rt(eQ)))}}function bL(e){var r;const t=[];for(const i of Object.keys(e))customElements.get(`calcite-${i}`)||t.push((r=e[i])==null?void 0:r.call(e));return t.length>0?Promise.all(t):null}eQ="components/assets";const tQ=Symbol("widget"),rQ=Symbol("widget-test-data"),DLe=[],FLe={},Lx=new WeakMap;function iQ(e,t){let r=t.children;if(r!=null&&r.length)for(let n=0;n<r.length;++n)r[n]=iQ(e,r[n]);else r=DLe;const i=t.vnodeSelector;if(kx(i)){const n=t.properties||FLe,s=n.key||i;return{vnodeSelector:"div",properties:{key:s,afterCreate:jLe,afterUpdate:ULe,afterRemoved:nQ,parentWidget:e,widgetConstructor:i,widgetProperties:{...n,key:s,children:r}},children:void 0,text:void 0,domNode:null}}return t}function jLe(e,t,r,{parentWidget:i,widgetConstructor:n,widgetProperties:s}){var a;const o=new n(s);o.container=e,Lx.set(e,o),(a=o.afterCreate)==null||a.call(o,o,e),i.addHandles(Xt(()=>nQ(e))),queueMicrotask(()=>{o[rQ].projector.renderNow()})}function ULe(e,t,r,{widgetProperties:i}){var s;const n=Lx.get(e);n&&(n.set(i),(s=n.afterUpdate)==null||s.call(n,n,e))}function nQ(e){var r;const t=Lx.get(e);t&&((r=t.afterRemoved)==null||r.call(t,t,e),t.destroy(),Lx.delete(e))}function kx(e){return typeof e=="function"&&e[tQ]}const Pp={arrowDown:"esri-icon-arrow-down",arrowUp:"esri-icon-arrow-up",basemap:"esri-icon-basemap",bookmark:"esri-icon-bookmark",calendar:"esri-icon-calendar",checkMark:"esri-icon-check-mark",checkboxUnchecked:"esri-icon-checkbox-unchecked",close:"esri-icon-close",collapse:"esri-icon-collapse",defaultAction:"esri-icon-default-action",description:"esri-icon-description",directions:"esri-icon-directions",dockBottom:"esri-icon-dock-bottom",dockLeft:"esri-icon-dock-left",dockRight:"esri-icon-dock-right",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",download:"esri-icon-download",dragHorizontal:"esri-icon-drag-horizontal",dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",edit:"esri-icon-edit",elevationProfile:"esri-icon-elevation-profile",environmentSettings:"esri-icon-environment-settings",erase:"esri-icon-erase",error:"esri-icon-error",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",gear:"esri-icon-gear",handleHorizontal:"esri-icon-handle-horizontal",handleVertical:"esri-icon-handle-vertical",home:"esri-icon-home",icon:"esri-icon",launchLinkExternal:"esri-icon-launch-link-external",layerList:"esri-icon-layer-list",layers:"esri-icon-layers",left:"esri-icon-left",leftArrows:"esri-icon-left-arrow",leftTriangleArrow:"esri-icon-left-triangle-arrow",lineOfSight:"esri-icon-line-of-sight",link:"esri-icon-link",linkExternal:"esri-icon-link-external",linkHorizontal:"esri-icon-link-horizontal",loadingIndicator:"esri-icon-loading-indicator",locate:"esri-icon-locate",locateCircled:"esri-icon-locate-circled",locked:"esri-icon-locked",mapPin:"esri-icon-map-pin",maximize:"esri-icon-maximize",measure:"esri-icon-measure",measureArea:"esri-icon-measure-area",measureBuildingHeightShadow:"esri-icon-measure-building-height-shadow",measureLine:"esri-icon-measure-line",menu:"esri-icon-menu",minimize:"esri-icon-minimize",minus:"esri-icon-minus",nonVisible:"esri-icon-non-visible",northNavigation:"esri-icon-north-navigation",noticeTriangle:"esri-icon-notice-triangle",organization:"esri-icon-organization",pan:"esri-icon-pan",pan2:"esri-icon-pan2",partlyCloudy:"esri-icon-partly-cloudy",pause:"esri-icon-pause",play:"esri-icon-play",playCircled:"esri-icon-play-circled",plus:"esri-icon-plus",polyline:"esri-icon-polyline",printer:"esri-icon-printer",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",reverse:"esri-icon-reverse",right:"esri-icon-right",rightArrow:"esri-icon-right-arrow",rightTriangleArrow:"esri-icon-right-triangle-arrow",rotate:"esri-icon-rotate",save:"esri-icon-save",search:"esri-icon-search",settings2:"esri-icon-settings2",slice:"esri-icon-slice",swap:"esri-icon-swap",table:"esri-icon-table",timeClock:"esri-icon-time-clock",tracking:"esri-icon-tracking",trash:"esri-icon-trash",unlockedLinkHorizontal:"esri-icon-unlocked-link-horizontal",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",vertexGps:"esri-icon-vertex-gps",visible:"esri-icon-visible",zoomInFixed:"esri-icon-zoom-in-fixed",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomOutFixed:"esri-icon-zoom-out-fixed",zoomToObject:"esri-icon-zoom-to-object"},JU=new Set;function VLe(e){JU.add(e),e.finally(()=>JU.delete(e))}var sQ;const GLe="esri.widgets.Widget";let BLe=0;const zLe={widgetIcon:Pp.checkboxUnchecked};function oQ(e,t){for(const r in t)e[r]!=null&&(typeof e[r]=="object"&&typeof t[r]=="object"?oQ(e[r],t==null?void 0:t[r]):e[r]=t[r]);return e}const qLe=LPe({postProcessProjectionOptions(e){const t=e.eventHandlerInterceptor,r=/capture$/i;e.eventHandlerInterceptor=(i,n,s,o)=>{const a=t==null?void 0:t(i,n,s,o),u=r.test(i);if(!((i=i.replace(r,"")).toLowerCase()in s)||u){const c=i[2].toLowerCase()+i.slice(3),h=v=>a==null?void 0:a.call(s,v);s.addEventListener(c,h,u);const d=()=>s.removeEventListener(c,h,u),y=o.afterRemoved;o.afterRemoved=v=>{y==null||y(v),d()}}return a}},handleInterceptedEvent(e,t,r,i){const{eventPhase:n,type:s}=i,o=n===Event.CAPTURING_PHASE;let a=`on${s}${o?"capture":""}`;const u=t.properties;(u&&a in u||(a=`on${s[0].toUpperCase()}${s.slice(1)}${o?"Capture":""}`,u&&a in u))&&(yK(),e.scheduleRender(),u[a].call(u.bind||r,i))}});let b$=!1,pi=class extends pT(Zu.EventedAccessor){constructor(e,t){super(e,t),this._attached=!1,this._projector=qLe,this._readyForTrueRender=!1,this.iconClass=zLe.widgetIcon,this.icon=null,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=Bx(async()=>{var o;if((o=this._messageBundleProps)!=null&&o.length){const a=await Promise.allSettled(this._messageBundleProps.map(async({bundlePath:u,propertyName:c})=>{if(this.destroyed)return;let h=await o4(u);this.uiStrings&&Object.keys(this.uiStrings)&&(h=oQ(B(h),this.uiStrings)),this[c]=h}));if(this.destroyed)return;for(const u of a)u.status==="rejected"&&oe.getLogger(this).error("widget-intl:locale-error",this.declaredClass,u.reason)}await this.loadLocale()}),NLe();const r="esri-widget-uid-"+HP(),i=this.render.bind(this);this._trackingTarget=new zx(()=>{this.autoRenderingEnabled&&this.scheduleRender()});const n=()=>{var h;if(!this._readyForTrueRender||this.destroyed)return null;const o=i();let a=o.properties;a||(o.properties=a={});const{key:u}=a;if(u||(a.key=r),kx(o.vnodeSelector)){if(!this.visible)return{vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}}else this.visible?a.styles||(a.styles={}):(a.class="",a.styles={display:"none"}),a.styles.display||(a.styles.display="");let c=0;return(h=o.children)==null||h.forEach(d=>{if(kx(d.vnodeSelector))return;let{properties:y}=d;y||(d.properties=y={}),y.key||(y.key=`${this.id}--${c++}`)}),iQ(this,o)};this.render=()=>{if(b$)return n();let o=j5e(this)??null;if(o)return o;this._trackingTarget.clear(),b$=!0;try{o=Vu(this._trackingTarget,n)}catch(a){throw console.error(a),a}finally{b$=!1}return o&&U5e(this,o),o};const s=this.beforeFirstRender();s?this._resourcesFetch=s.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),VLe(this._resourcesFetch)}normalizeCtorArgs(e,t){const r={...e};return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){var t;const e=this.loadDependencies();return(t=this._messageBundleProps)!=null&&t.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(nD):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(cr(this._trackingTarget),cr(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,r$(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return eL(e)}get domNode(){return this.container}set domNode(e){this.container=e}get id(){var e;return this._get("id")||((e=this.container)==null?void 0:e.id)||Date.now().toString(16)+"-widget-"+BLe++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(sQ=tQ,rQ)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(r$(this),this._projector.scheduleRender())}own(e){LV(oe.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(e)}classes(...e){return G5e.apply(this,e)}renderNow(){r$(this),this._projector.renderNow()}_postInitialize(){var t;if(this.destroyed)return;this.scheduleRender(),(t=this._delegatedEventNames)!=null&&t.length&&this.addHandles(Ue(()=>this.viewModel,(r,i)=>{i&&this.removeHandles("delegated-events"),r&&Vx(r)&&this.addHandles(this._delegatedEventNames.map(n=>Dv(r,n,s=>{this.emit(n,s)})),"delegated-events")},Ta)),this.postInitialize();const e=async()=>{await this._loadLocale().catch(nD),this.scheduleRender()};this.addHandles([JO(e),Ue(()=>this.uiStrings,e),hf(()=>this.container,r=>{this.destroyed||this._attach(r)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){var t;this._attached&&(this._projector.detach(this.render),this._attached=!1),(t=e==null?void 0:e.parentNode)==null||t.removeChild(e)}};pi[sQ]=!0,l([p()],pi.prototype,"_readyForTrueRender",void 0),l([p({value:null})],pi.prototype,"container",null),l([Tt("container")],pi.prototype,"castContainer",null),l([p()],pi.prototype,"iconClass",void 0),l([p()],pi.prototype,"icon",void 0),l([p()],pi.prototype,"id",null),l([p()],pi.prototype,"label",null),l([p()],pi.prototype,"renderable",null),l([p()],pi.prototype,"uiStrings",void 0),l([p()],pi.prototype,"viewModel",void 0),l([p({value:!0})],pi.prototype,"visible",null),l([p()],pi.prototype,"key",void 0),l([p()],pi.prototype,"children",void 0),l([p()],pi.prototype,"afterCreate",void 0),l([p()],pi.prototype,"afterUpdate",void 0),l([p()],pi.prototype,"afterRemoved",void 0),pi=l([k(GLe)],pi);const vw=pi,HLe=new Map;function WLe(e){return HLe.get(e)}function ZU(e,t){return e&&"copyright"in e&&(!t||typeof e.originOf=="function"&&e.originOf("copyright")==="user")}function JLe(e,t){return e.length!==t.length||e.some((r,i)=>r.text!==t[i].text)}function cg(e,t,r){!r||!t||e.find(i=>i.layerView===t&&i.text===r)||e.push({text:r,layerView:t})}function ZLe(e){return e.type==="bing-maps"}const Kl=[];let Dy=class extends De{constructor(t){super(t),this._clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.removeHandles("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new $e,this.view=null,this._allLayerViewsChange=r=>{var n;this.removeHandles("suspension"),this.removeHandles("visible-geometry-changed");const i=(n=this.view)==null?void 0:n.allLayerViews;i&&(this.addHandles(i.map(s=>Ue(()=>{var o;return[s.suspended,(o=s.layer)==null?void 0:o.attributionVisible]},()=>this._updateAttributionItems())).toArray(),"suspension"),i.forEach(s=>{s.declaredClass==="esri.views.3d.layers.Tiles3DLayerView3D"&&this.addHandles(s.on("visible-geometry-changed",()=>this._updateAttributionItems()),"visible-geometry-changed")})),r!=null&&r.removed&&r.removed.forEach(s=>{this._pendingAttributions.delete(s),this._fetchedAttributionData.delete(s)}),this._updateAttributionItems()},this.addHandles([rs(()=>{var r;return(r=this.view)==null?void 0:r.allLayerViews},"change",r=>this._allLayerViewsChange(r),{onListenerAdd:()=>this._allLayerViewsChange(),onListenerRemove:this._clear}),hf(()=>{var r;return((r=this.view)==null?void 0:r.stationary)===!0},()=>this._updateAttributionItems())])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){var t;return(t=this.view)!=null&&t.ready?this._pendingAttributions.size>0?"loading":"ready":"disabled"}_updateAttributionItems(){const t=this.view,r=t==null?void 0:t.allLayerViews;if(Kl.length=0,!t||!r)return void this._clear();r.forEach(n=>{var a,u;if(n.suspended||!((a=n.layer)!=null&&a.attributionVisible))return;const s=n.layer;if(ZU(s,"user"))return void cg(Kl,n,s.copyright);if(s.hasAttributionData){if(this._fetchedAttributionData.has(n)){const c=this._fetchedAttributionData.get(n);return void(c?cg(Kl,n,this._getDynamicAttribution(c,t,s)):ZU(s)&&cg(Kl,n,s.copyright))}return void this._fetchAttributionData(n)}const o="portalItem"in s?(u=s.portalItem)==null?void 0:u.accessInformation:void 0;cg(Kl,n,o||s.copyright)});const i=r.find(n=>{var s;return((s=n.layer)==null?void 0:s.type)==="integrated-mesh-3dtiles"});if(this.view&&i){const n=WLe(this.view);if(n){const s=n.getAttributionText();for(let o=0;o<s.length;++o)cg(Kl,i,s[o])}}JLe(this.items,Kl)&&(this.items.removeAll(),this.items.addMany(Kl)),Kl.length=0,this.notifyChange("state")}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const r=await yT(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=r.ok?this._createContributionIndex(r.value,ZLe(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,r){const i=t.contributors,n={};if(!i)return n;for(let s=0;s<i.length;s++){const o=i[s],a=o.coverageAreas;if(!a)return;for(const u of a){const c=u.bbox,h=u.zoomMin-(r&&u.zoomMin?1:0),d=u.zoomMax-(r&&u.zoomMax?1:0),y=new Ne({xmin:c[1],ymin:c[0],xmax:c[3],ymax:c[2],spatialReference:xe.WGS84}),v={extent:ku(y),attribution:o.attribution||"",score:u.score!=null?u.score:100,id:s};for(let w=h;w<=d;w++)n[w]??(n[w]=[]),n[w].push(v)}}return n.maxKey=Math.max.apply(null,Object.keys(n)),n}_getDynamicAttribution(t,r,i){var h;const{extent:n,scale:s}=r;let o=((h=i.tileInfo)==null?void 0:h.scaleToZoom(s))??0;if(o=Math.min(t.maxKey??0,Math.round(o)),!n||o==null||o<=-1)return"";const a=t[o],u=Yx(n.center.clone().normalize(),r.spatialReference),c=new Set;return a?a.filter(d=>{const y=d.id,v=!c.has(y)&&u&&d.extent&&Kx(d.extent,u);return v&&c.add(y),v}).sort((d,y)=>y.score-d.score||d.objectId-y.objectId).map(d=>d.attribution).join(", "):""}};l([p({readOnly:!0,type:$e})],Dy.prototype,"items",void 0),l([p({readOnly:!0})],Dy.prototype,"state",null),l([p()],Dy.prototype,"view",void 0),Dy=l([k("esri.widgets.Attribution.AttributionViewModel")],Dy);const aQ=Dy,Fo={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",disabledElement:"esri-disabled-element",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",noBookmarksIcon:"esri-widget__no-bookmark-icon",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};function YLe(){return function(e,t){if(!e[t])throw new TypeError(`Cannot auto bind undefined function '${String(t)}'`);return{value:XLe(e[t])}}}function KLe(e){const t=e==null?void 0:e.type;return e instanceof KeyboardEvent||t==="keyup"||t==="keydown"||t==="keypress"}function XLe(e){return function(t,...r){KLe(t)?W5e(t.key)&&(t.preventDefault(),t.stopPropagation(),t.target.click()):e.call(this,t,...r)}}function ww(e){return(t,r)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}var QLe=function(e){return{vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}},lQ=function(e,t){for(var r=0,i=e.length;r<i;r++){var n=e[r];Array.isArray(n)?lQ(n,t):n!=null&&n!==!1&&(n.hasOwnProperty("vnodeSelector")||(n=QLe(n)),t.push(n))}},eke=function(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(r.length===1&&typeof r[0]=="string")return{vnodeSelector:e,properties:t||void 0,children:void 0,text:r[0],domNode:null};var n=[];return lQ(r,n),{vnodeSelector:e,properties:t||void 0,children:n,text:void 0,domNode:null}};function Ii(e,t,...r){return typeof e!="function"||kx(e)?eke(e,t,...r):e(t,...r)}function hGe(...e){return e}const Qf="esri-attribution",Sh={base:Qf,poweredBy:`${Qf}__powered-by`,sources:`${Qf}__sources`,open:`${Qf}--open`,sourcesOpen:`${Qf}__sources--open`,link:`${Qf}__link`,widgetIcon:Pp.description};let bn=class extends vw{constructor(t,r){super(t,r),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this._resizeObserver=new ResizeObserver(i=>i.forEach(({target:n})=>this._checkSourceTextOverflow(n))),this.iconClass=Sh.widgetIcon,this.icon=null,this.itemDelimiter=" | ",this.messages=null,this.viewModel=new aQ}initialize(){this.addHandles(rs(()=>{var t;return(t=this.viewModel)==null?void 0:t.items},"change",()=>this.scheduleRender()))}destroy(){var t;(t=this._resizeObserver)==null||t.disconnect()}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce((t,r)=>(t.includes(r.text)||t.push(r.text),t),[]).join(this.itemDelimiter)}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){const t={[Sh.open]:this._isOpen};return Ii("div",{bind:this,class:this.classes(Sh.base,Fo.widget,t),dir:"ltr",onclick:this._toggleState,onkeydown:this._toggleState},this._renderSourcesNode(),this._renderPoweredBy())}_renderPoweredBy(){return Ii("div",{class:Sh.poweredBy},"Powered by"," ",Ii("a",{class:Sh.link,href:"https://www.esri.com/",rel:"noreferrer",target:"_blank"},"Esri"))}_renderSourcesNode(){const t=this._isOpen,r=this._isInteractive,i=r?0:void 0,{attributionText:n}=this,s={[Sh.sourcesOpen]:t,[Fo.interactive]:r};return Ii("div",{afterCreate:this._afterSourcesNodeCreate,bind:this,class:this.classes(Sh.sources,s),innerHTML:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth,this._resizeObserver.observe(t)}_checkSourceTextOverflow(t){let r=!1;const{clientHeight:i,clientWidth:n,scrollWidth:s}=t,o=s>n,a=this._attributionTextOverflowed!==o;if(this._attributionTextOverflowed=o,a&&(r=!0),this._isOpen){const u=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,u&&(this._isOpen=!1,r=!0)}r&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};l([p()],bn.prototype,"_isOpen",void 0),l([p()],bn.prototype,"_isInteractive",null),l([p()],bn.prototype,"_attributionTextOverflowed",void 0),l([p()],bn.prototype,"_prevSourceNodeHeight",void 0),l([p({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],bn.prototype,"attributionText",null),l([p()],bn.prototype,"iconClass",void 0),l([p()],bn.prototype,"icon",void 0),l([p()],bn.prototype,"itemDelimiter",void 0),l([p()],bn.prototype,"label",null),l([p(),ww("esri/widgets/Attribution/t9n/Attribution")],bn.prototype,"messages",void 0),l([p()],bn.prototype,"view",null),l([p({type:aQ})],bn.prototype,"viewModel",void 0),l([YLe()],bn.prototype,"_toggleState",null),bn=l([k("esri.widgets.Attribution")],bn);const tke=bn;function rke(e){var t,r;return((t=e==null?void 0:e.spatialReference)==null?void 0:t.isWebMercator)||((r=e==null?void 0:e.spatialReference)==null?void 0:r.isGeographic)||!1}const ike=e=>{let t=class extends e{constructor(...r){super(...r),this.goToOverride=null,this.view=null}callGoTo(r){const{view:i}=this;return wp(i),this.goToOverride?this.goToOverride(i,r):i.goTo(r.target,r.options)}};return l([p()],t.prototype,"goToOverride",void 0),l([p()],t.prototype,"view",void 0),t=l([k("esri.widgets.support.GoTo")],t),t},nke="esri.widgets.CompassViewModel";let dd=class extends ike(De){constructor(t){super(t),this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this.addHandles(Ue(()=>this.view,this._updateRotationWatcher,Xi))}destroy(){this.view=null}get canShowNorth(){return rke(this.view)}get state(){var t;return!((t=this.view)!=null&&t.ready)||this.view.type==="2d"&&!this.view.constraints.rotationEnabled?"disabled":this.canShowNorth?"compass":"rotation"}reset(){var r,i;if(!((r=this.view)!=null&&r.ready))return;const t={};((i=this.view)==null?void 0:i.type)==="2d"?t.rotation=0:t.heading=0,this.callGoTo({target:t})}_updateForRotation(t){t!=null&&(this.orientation={z:t})}_updateForCamera(t){if(!t)return;const r=-t.heading;this.orientation={x:0,y:0,z:r}}_updateRotationWatcher(t){this.removeAllHandles(),t&&this.addHandles(t.type==="2d"?Ue(()=>t==null?void 0:t.rotation,this._updateForRotation,Xi):Ue(()=>t==null?void 0:t.camera,this._updateForCamera,Xi))}};l([p({readOnly:!0})],dd.prototype,"canShowNorth",null),l([p()],dd.prototype,"orientation",void 0),l([p({readOnly:!0})],dd.prototype,"state",null),l([p()],dd.prototype,"view",void 0),dd=l([k(nke)],dd);const uQ=dd,YU="esri-compass",_$={base:YU,widgetIcon:Pp.locateCircled,iconContainer:`${YU}__icon-container`};let ul=class extends vw{constructor(t,r){super(t,r),this.iconClass=_$.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new uQ,this._reset=()=>{this.viewModel.reset()},this._toRotationTransform=i=>({transform:`rotateZ(${i.z}deg)`})}loadDependencies(){return bL({button:()=>ge(()=>import("./calcite-button-CJHVCedX.js"),__vite__mapDeps([202,203,204,205,206,207,208,209,210,211,212,213,1,2])),icon:()=>ge(()=>import("./calcite-icon-ChWXkwhD.js"),__vite__mapDeps([214,212,204,205,211,1,2]))})}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(t){this.viewModel.goToOverride=t}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:r}=this.viewModel,i=r==="rotation"?"arrow-up":"compass-needle",n=this.icon??i,{messages:s}=this;return Ii("div",{class:this.classes(_$.base,Fo.widget)},Ii("calcite-button",{class:Fo.widgetButton,disabled:r==="disabled",kind:"neutral",label:s.reset,onclick:this._reset,round:!0,scale:"s",title:s.reset},Ii("div",{"aria-hidden":"true",class:_$.iconContainer,title:s.reset},Ii("calcite-icon",{icon:n,scale:"m",styles:this._toRotationTransform(t)}))))}};l([p()],ul.prototype,"goToOverride",null),l([p()],ul.prototype,"iconClass",void 0),l([p()],ul.prototype,"icon",void 0),l([p()],ul.prototype,"label",null),l([p(),ww("esri/widgets/Compass/t9n/Compass")],ul.prototype,"messages",void 0),l([p()],ul.prototype,"view",null),l([p({type:uQ})],ul.prototype,"viewModel",void 0),ul=l([k("esri.widgets.Compass")],ul);const ske=ul,KU="esri-navigation-toggle",S$={base:KU,widgetIcon:Pp.pan2,isLayoutHorizontal:`${KU}--horizontal`};let Fy=class extends De{constructor(t){super(t),this.navigationMode="pan",this.view=null}initialize(){this.addHandles(hf(()=>{var t;return(t=this.view)==null?void 0:t.inputManager},()=>this._setNavigationMode()))}destroy(){this.view=null}get state(){var t,r;return(t=this.view)!=null&&t.ready&&((r=this.view)==null?void 0:r.type)==="3d"?"ready":"disabled"}toggle(){this.state!=="disabled"&&(this.navigationMode=this.navigationMode!=="pan"?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){var r;const t=(r=this.view)==null?void 0:r.inputManager;t&&(t.primaryDragAction=this.navigationMode==="pan"?"pan":"rotate")}};l([p({readOnly:!0})],Fy.prototype,"state",null),l([p()],Fy.prototype,"navigationMode",void 0),l([p()],Fy.prototype,"view",void 0),Fy=l([k("esri.widgets.NavigationToggleViewModel")],Fy);const cQ=Fy;let cl=class extends vw{constructor(t,r){super(t,r),this.iconClass=S$.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new cQ,this.toggle=()=>this.viewModel.toggle(),this._panButton=null,this._rotateButton=null,this._toggle=()=>{var n;const i=((n=this.viewModel)==null?void 0:n.navigationMode)==="pan"?this._rotateButton:this._panButton;i==null||i.setFocus(),this.toggle()}}loadDependencies(){return bL({button:()=>ge(()=>import("./calcite-button-CJHVCedX.js"),__vite__mapDeps([202,203,204,205,206,207,208,209,210,211,212,213,1,2]))})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}get view(){return this.viewModel.view}set view(t){this.viewModel.view=t}render(){var n,s;const t=((n=this.viewModel)==null?void 0:n.state)==="disabled",r=((s=this.viewModel)==null?void 0:s.navigationMode)==="pan",i=this.messages.toggle;return Ii("div",{class:this.classes(S$.base,Fo.widget,{[S$.isLayoutHorizontal]:this.layout==="horizontal"})},Ii("calcite-button",{afterCreate:o=>{this._panButton=o},appearance:r?"outline-fill":"solid",class:Fo.widgetButton,disabled:t,iconStart:"move",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?void 0:-1,title:i}),Ii("calcite-button",{afterCreate:o=>{this._rotateButton=o},appearance:r?"solid":"outline-fill",class:Fo.widgetButton,disabled:t,iconStart:"rotate",kind:"neutral",label:i,onclick:this._toggle,tabIndex:r?-1:void 0,title:i}))}};l([p()],cl.prototype,"iconClass",void 0),l([p()],cl.prototype,"icon",void 0),l([p()],cl.prototype,"label",null),l([p({value:"vertical"})],cl.prototype,"layout",null),l([p(),ww("esri/widgets/NavigationToggle/t9n/NavigationToggle")],cl.prototype,"messages",void 0),l([p()],cl.prototype,"view",null),l([p({type:cQ})],cl.prototype,"viewModel",void 0),cl=l([k("esri.widgets.NavigationToggle")],cl);const oke=cl;let fd=class extends De{get canZoomIn(){var r,i,n;if(!((r=this.view)==null?void 0:r.ready))return!1;const t=(n=(i=this.view)==null?void 0:i.constraints)==null?void 0:n.effectiveMaxScale;return t===0||this._scale>t}get canZoomOut(){var i;const{view:e}=this;if(!(e==null?void 0:e.ready))return!1;const r=(i=e.constraints)==null?void 0:i.effectiveMinScale;return r===0||this._scale<r}get _scale(){var t,r,i;const e=(r=(t=this.view)==null?void 0:t.animation)==null?void 0:r.target;return(e&&"then"in e||e==null?void 0:e.scale)??((i=this.view)==null?void 0:i.scale)??0}};l([p({readOnly:!0})],fd.prototype,"canZoomIn",null),l([p({readOnly:!0})],fd.prototype,"canZoomOut",null),l([p()],fd.prototype,"view",void 0),l([p()],fd.prototype,"_scale",null),fd=l([k("esri.widgets.Zoom.ZoomConditions2D")],fd);const ake=fd;let jy=class extends De{get canZoomIn(){return!!this.view.ready}get canZoomOut(){return!!this.view.ready}};l([p({readOnly:!0})],jy.prototype,"canZoomIn",null),l([p({readOnly:!0})],jy.prototype,"canZoomOut",null),l([p()],jy.prototype,"view",void 0),jy=l([k("esri.widgets.Zoom.ZoomConditions3D")],jy);const lke=jy;let ep=class extends De{constructor(t){super(t)}destroy(){this.view=null}get canZoomIn(){return this._zoomConditions!=null&&this._zoomConditions.canZoomIn}get canZoomOut(){var t;return this._zoomConditions!=null&&((t=this._zoomConditions)==null?void 0:t.canZoomOut)}get state(){var t;return(t=this.view)!=null&&t.ready?"ready":"disabled"}set view(t){t?t.type==="2d"?this._zoomConditions=new ake({view:t}):t.type==="3d"&&(this._zoomConditions=new lke({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;t.type==="2d"?t.mapViewNavigation.zoomIn():k$(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;t.type==="2d"?t.mapViewNavigation.zoomOut():k$(t.goTo({zoomFactor:.5}))}};l([p()],ep.prototype,"_zoomConditions",void 0),l([p()],ep.prototype,"canZoomIn",null),l([p()],ep.prototype,"canZoomOut",null),l([p({readOnly:!0})],ep.prototype,"state",null),l([p()],ep.prototype,"view",null),ep=l([k("esri.widgets.Zoom.ZoomViewModel")],ep);const pQ=ep,x$={base:"esri-zoom",widgetIcon:Pp.zoomInMagnifyingGlass,horizontalLayout:"esri-zoom--horizontal"};let pl=class extends vw{constructor(t,r){super(t,r),this.iconClass=x$.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new pQ,this.zoomIn=()=>this.viewModel.zoomIn(),this.zoomOut=()=>this.viewModel.zoomOut()}loadDependencies(){return bL({button:()=>ge(()=>import("./calcite-button-CJHVCedX.js"),__vite__mapDeps([202,203,204,205,206,207,208,209,210,211,212,213,1,2]))})}get label(){var t;return((t=this.messages)==null?void 0:t.widgetLabel)??""}set label(t){this._overrideIfSome("label",t)}set layout(t){t!=="horizontal"&&(t="vertical"),this._set("layout",t)}set view(t){this.viewModel.view=t}get view(){return this.viewModel.view}render(){const t={[x$.horizontalLayout]:this.layout==="horizontal"},{canZoomIn:r,canZoomOut:i}=this.viewModel,{zoomIn:n,zoomOut:s}=this.messages;return Ii("div",{class:this.classes(x$.base,Fo.widget,t)},Ii("calcite-button",{class:Fo.widgetButton,disabled:!r,iconStart:"plus",kind:"neutral",label:n,onclick:this.zoomIn,title:n}),Ii("calcite-button",{class:Fo.widgetButton,disabled:!i,iconStart:"minus",kind:"neutral",label:s,onclick:this.zoomOut,title:s}))}};l([p()],pl.prototype,"iconClass",void 0),l([p()],pl.prototype,"icon",void 0),l([p()],pl.prototype,"label",null),l([p({value:"vertical"})],pl.prototype,"layout",null),l([p(),ww("esri/widgets/Zoom/t9n/Zoom")],pl.prototype,"messages",void 0),l([p()],pl.prototype,"view",null),l([p({type:pQ})],pl.prototype,"viewModel",void 0),pl=l([k("esri.widgets.Zoom")],pl);const uke=pl;function cke(e){return(e==null?void 0:e.view)!==void 0}let hS=class extends EPe{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-left","navigation-toggle":"top-left",zoom:"top-left"},this.components=[],this._updateViewAwareWidgets=r=>{this.components.forEach(i=>{const n=this._find(i),s=n==null?void 0:n.widget;cke(s)&&(s.view=r)})},this._componentsWatcher=(r,i)=>{this._removeComponents(i),this._addComponents(r),this._adjustPadding(r)}}initialize(){this.addHandles([Ue(()=>this.components,this._componentsWatcher,Xi),Ue(()=>this.view,this._updateViewAwareWidgets,Xi)])}_add(t,r,i,n,s){let o=t;if(typeof t=="string"&&this._defaultPositionLookup[t]){if(this._find(t))return;o=this._createComponent(t)}super._add(o,r,i,n,s)}_removeComponents(t){t.forEach(r=>{const i=this._find(r);i&&(this.remove(i),i.destroy())})}_adjustPadding(t){if(!t.includes("attribution")&&!this._isOverridden("padding")){const{top:r}=this.padding;this.padding=r}}_addComponents(t){this.constructed&&t.forEach(r=>this.add(this._createComponent(r),this._defaultPositionLookup[r]))}_createComponent(t){const r=this._createWidget(t);return new pS({id:t,node:r})}_createWidget(t){const{view:r}=this;switch(t){case"attribution":return new tke({view:r});case"compass":return new ske({view:r});case"navigation-toggle":return new oke({view:r});case"zoom":return new uke({view:r})}}};l([p()],hS.prototype,"components",void 0),hS=l([k("esri.views.ui.DefaultUI")],hS);const hQ=hS;let dS=class extends hQ{constructor(e){super(e),this.components=["attribution","zoom"]}};l([p()],dS.prototype,"components",void 0),dS=l([k("esri.views.ui.2d.DefaultUI2D")],dS);const dQ=dS;var nO;let fS=nO=class extends Q{constructor(e){super(e),this.color=new ve([0,0,0,1])}clone(){return new nO(B({color:this.color}))}};l([p({type:ve,json:{write:!0}})],fS.prototype,"color",void 0),fS=nO=l([k("esri.webmap.background.ColorBackground")],fS);const pke=fS;let fQ,yQ,mQ,gQ,vQ,wQ;async function hke(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:r,MapViewNavigation:i,MagnifierView2D:n,Stage:s}]=await Promise.all([ge(()=>import("./webglDeps-H7qwN1d1.js"),__vite__mapDeps([138,91,1,2,90,139,140])),ge(()=>import("./mapViewDeps-CsV0qR1C.js"),__vite__mapDeps([141,1,2,92,93,40,94,89,90,91,95,45,96,97,142,143,144,145,140,119,138,139,146,101,147,88,7,69,25,148,149,48,150,39,151,152,153,154,155,156,157,158,159,104,160]))]);yQ=e,mQ=t,gQ=r,vQ=i,wQ=n,fQ=s}let Qe=class extends HAe(SRe(lRe(JRe))){constructor(e){super(e),this._magnifierView=null,this.stage=null,this._resolveWhenReady=[],this.rootLayerViews=new ff({getCollections:()=>{var t,r;return[(t=this.basemapView)==null?void 0:t.baseLayerViews,this.layerViews,(r=this.basemapView)==null?void 0:r.referenceLayerViews]},getChildrenFunction:()=>null}),this.featuresTilingScheme=null,this.fullOpacity=1,this.goToManager=new lS({view:this}),this.graphicsView=null,this.stateManager=new zn({constraints:new lX({view:this})}),this.stationaryManager=new f1,this.labelManager=null,this.mapViewNavigation=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.supersampleScreenshotsEnabled=!0,this.supportsGround=!1,this.frameTask=new pOe(this),this.floors=new $e,this.highlightOptions=new EX,this.inputManager=new q4e({view:this}),this.map=null,this.spatialReferenceLocked=!1,this.timeline=new PX,this.type="2d",this.ui=new dQ,this.test={takeScreenshot:async t=>dPe(this._getScreenshotView(t),t)},this.padding={top:0,right:0,bottom:0,left:0},this.addHandles([Ue(()=>this.viewpoint,()=>this.stationaryManager.flip(),di),this.on("resize",t=>this.stateManager.resize(t.width,t.height))]),WIe()}destroy(){this._set("preconditionsReady",!1),this.frameTask=cr(this.frameTask),this.goToManager.destroy(),this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get graphicsTileStore(){return new X4e(this.featuresTilingScheme)}get constraintsInfo(){var r,i;const e=(r=this.defaultsFromMap)==null?void 0:r.tileInfo,t=this.spatialReference;return{lods:(i=e==null?void 0:e.spatialReference)!=null&&i.equals(t)?e.lods:null,spatialReference:t}}get state(){return this.stateManager.state}get initialExtentRequired(){var o;if(!this.stateManager)return!1;const{scale:e,constraints:t,center:r,viewpoint:i,extent:n}=this;let s=this.zoom;return!(this.map&&"initialViewProperties"in this.map&&((o=this.map.initialViewProperties)!=null&&o.viewpoint))&&!n&&(t!=null&&t.effectiveLODs||(s=-1),(!r||e===0&&s===-1)&&((i==null?void 0:i.targetGeometry)==null||i.targetGeometry.type!=="extent"&&!i.scale))}get _defaultsFromMapSettings(){return{required:{tileInfo:!0,heightModelInfo:!1,extent:!1},requiresExtentInSpatialReference:this.spatialReferenceLocked}}get typeSpecificPreconditionsReady(){const e=this._getDefaultViewpoint();if(!e)return!1;const t=e.targetGeometry,r=this.spatialReference;return SH(t.spatialReference,r)}set animation(e){const t=this._get("animation");if(e===t)return;if(t&&t.stop(),e!==this.animationManager.animation&&this.animationManager.stop(),!e||e.isFulfilled())return this._set("animation",null),void(this.frameTask.animationInProgress=!1);this._set("animation",e),this.frameTask.animationInProgress=!0;const r=()=>{var i;this.destroyed||(e===this._get("animation")&&(this._set("animation",null),(i=this.frameTask)==null||i.requestFrame()),this.frameTask.animationInProgress=!1)};e.when(r,r)}get background(){return V8(this.map)?this.map.initialViewProperties.background:null}set background(e){this._override("background",e)}get center(){var e;return((e=this.stateManager)==null?void 0:e.center)??null}set center(e){this.stateManager.center=e}get constraints(){var e;return(e=this.stateManager)==null?void 0:e.constraints}set constraints(e){e.view=this;const t=this.stateManager.constraints;this.stateManager.constraints=e,t==null||t.destroy()}get extent(){var e;return((e=this.stateManager)==null?void 0:e.extent)??null}set extent(e){this.stateManager.extent=e}get padding(){var e;return(e=this.stateManager)==null?void 0:e.padding}set padding(e){this.stateManager&&(this.stateManager.padding=e)}get rendering(){var e;return((e=this.stage)==null?void 0:e.renderRequested)??!1}get resizeAlign(){return this.stateManager.resizeAlign}set resizeAlign(e){this.stateManager.resizeAlign=e}get resolution(){return this.stateManager.resolution??0}get rotation(){return this.stateManager.rotation??0}set rotation(e){const{rotationEnabled:t}=this.constraints;this.constraints.rotationEnabled=!0,this.stateManager.rotation=e,this.constraints.rotationEnabled=t}get scale(){var e;return((e=this.stateManager)==null?void 0:e.scale)??0}set scale(e){this.stateManager&&(this.stateManager.scale=e)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing&&this.stationaryManager.stationary}get updating(){var t,r,i;const e=!this.destroyed&&(!this.layerViewManager||!this.labelManager||!this.graphicsView||this.layerViewManager.updating===!0||this.labelManager.updating===!0||this.graphicsView.updating===!0||this.allLayerViews.some(n=>!n.destroyed&&!("layerViews"in n)&&n.updating===!0));if(Me("esri-2d-log-updating")){const n=this.allLayerViews.reduce((s,o)=>({...s,[`${o.layer.id}(${o.layer.type})`]:!o.destroyed&&!("layerViews"in o)&&o.updating}),{});console.log(`Updating MapView: ${e}
-> Null LayerViewManager: ${!this.layerViewManager}
-> Null LabelManager: ${!this.labelManager}
-> Null GraphicsView: ${!this.graphicsView}
-> layerViewManager.updating: ${(t=this.layerViewManager)==null?void 0:t.updating}
-> labelManager.updating: ${(r=this.labelManager)==null?void 0:r.updating}
-> graphicsView.updating: ${(i=this.graphicsView)==null?void 0:i.updating}
-> allLayerViews: ${JSON.stringify(n)}
`)}return e}get viewpoint(){return this.stateManager.viewpoint??null}set viewpoint(e){this.stateManager.viewpoint=e,this.frameTask.requestFrame()}get zoom(){return this.stateManager.zoom??-1}set zoom(e){this.stateManager.zoom=e}get navigating(){var e;return((e=this.mapViewNavigation)==null?void 0:e.interacting)??!1}goTo(e,t){return this.goToManager.goTo(e,t)}async hitTest(e,t){return Q4e(this,e,t)}async takeScreenshot(e){return hPe(this._getScreenshotView(e),e)}toMap(e){if(!this.ready)return null;const t=RK(e)?AK(this,e):e;return this.stateManager.toMap(t)}toScreen(e,t){return this.stateManager.toScreen(e,t)}on(e,t,r,i){return this.inputManager&&this.viewEvents.on(e,t,r,i)||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){this.graphicsView&&this.graphicsView.graphicUpdateHandler(e)}whenReady(){return new Promise(e=>{this.ready?e(this):this._resolveWhenReady.push(e)})}forceDOMReadyCycle(){this.forceReadyCycle()}getDefaultSpatialReference(){var e,t,r;return this.map&&"initialViewProperties"in this.map&&((t=(e=this.map)==null?void 0:e.initialViewProperties)==null?void 0:t.spatialReference)||((r=this.defaultsFromMap)==null?void 0:r.spatialReference)||null}getDefaultTimeZone(){return V8(this.map)?this.map.initialViewProperties.timeZone:null}hasLayerViewModule(e){return hU.hasLayerViewModule(e)}importLayerView(e){return hU.importLayerView(e)}pixelSizeAt(){return this.ready?this.resolution:(oe.getLogger(this).error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}async popupHitTest(e){var u;const t=this.toMap(e),r=await this.hitTest(e),i=this.allLayerViews.toArray().reverse(),n=new globalThis.Map(i.map(c=>[c.layer.uid,c])),s=[];let o=0,a=0;for(;o<r.results.length||a<i.length;){const c=r.results.at(o);if(c&&c.type!=="graphic"){++o;continue}const h=n.get((u=(c==null?void 0:c.layer)??(c==null?void 0:c.graphic.layer))==null?void 0:u.uid);if((!c||h)&&a<i.length&&i.at(a)!==h){const d=i.at(a);"fetchPopupFeaturesAtLocation"in d&&s.push({mapPoint:t,layerView:d}),++a}else c&&(s.push({graphic:c.graphic,layerView:h}),++o)}return{hits:s,location:t}}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}async validate(){let e=vPe(this.type);if(Me("safari")&&Me("safari")<9&&(e=new z("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:Me("safari")})),e!=null)throw oe.getLogger(this).warn("#validate()",e.message),e}loadAsyncDependencies(){return hke()}_getDefaultViewpoint(){var b;const{constraints:e,initialExtent:t,map:r,padding:i,size:n}=this;if(!e)return null;const s=r&&"initialViewProperties"in r?r.initialViewProperties:void 0,o=this.stateManager.getUserStartupOptions(this.size),a=s==null?void 0:s.viewpoint,u=((b=a==null?void 0:a.targetGeometry)==null?void 0:b.extent)??t,c=u==null?void 0:u.center,h=(a==null?void 0:a.rotation)??0,d=(a==null?void 0:a.scale)||u&&pm(u,[n[0]-i.left-i.right,n[1]-i.top-i.bottom]),y=o.center??c,v=o.rotation??h,w=o.scale??d;return y&&w?new xl({targetGeometry:y,scale:w,rotation:v}):null}_startup(){var o;this.timeline.begin("MapView Startup");const e=this._getDefaultViewpoint();this.stateManager.startup(e,this.size,this.spatialReference,(o=this.defaultsFromMap.extent)==null?void 0:o.center),this.graphics.owner=this;const t=new fQ(this.surface,{canvas:this.renderCanvas,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline});this.stage=t,this._magnifierView=new wQ,this._magnifierView.magnifier=this.magnifier;const r=new gQ({view:this});this._set("labelManager",r);const i=new cOe({view:this});this._set("animationManager",i);const n=new vQ({view:this,animationManager:i});this._set("mapViewNavigation",n),this._setupSpatialReferenceDependentProperties(),this.addHandles([this.rootLayerViews.on("change",()=>this._updateStageChildren()),t.on("webgl-error",a=>this.fatalError=a.error),Ue(()=>this.stationary,a=>t.stationary=a,Ta),Ue(()=>this.background,a=>{t.backgroundColor=a==null?void 0:a.color,this._magnifierView.backgroundColor=a==null?void 0:a.color},Ta),Ue(()=>this.magnifier,a=>this._magnifierView.magnifier=a,Ta),Ue(()=>this.renderingOptions,a=>t.renderingOptions=a,Ta),Ue(()=>this.highlightOptions,a=>t.highlightOptions=a,Ta),Ue(()=>this.state.id,()=>t.state=this.state,Ta)],"map-view"),this._updateStageChildren();const s=this._resolveWhenReady;this._resolveWhenReady=[],s.forEach(a=>a(this)),this.timeline.end("MapView Startup"),this.frameTask.start(),this._set("ready",!0)}_teardown(){this._destroySpatialReferenceDependentProperties(),this.removeHandles("map-view"),this.mapViewNavigation.destroy(),this._set("mapViewNavigation",null),this.animation=null,this.animationManager.destroy(),this._set("animationManager",null),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this.stage.destroy(),this.stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,this.frameTask.stop(),this.stationaryManager.clear(),this._set("ready",!1),this.stateManager.teardown()}_updateStageChildren(){this.stage.removeAllChildren(),this.rootLayerViews.forEach(t=>{this.stage.addChild(t.container)});const e=this.graphicsView;this.stage.addChild(e.container),this.stage.addChild(this._magnifierView)}_setupSpatialReferenceDependentProperties(){const e=new wOe(Uo.create({spatialReference:this.spatialReference,size:512,numLODs:36}));this._set("featuresTilingScheme",e);const t=new yQ({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new mQ(e)});this._set("graphicsView",t)}_destroySpatialReferenceDependentProperties(){const e=this.graphicsView;this._set("graphicsView",null),e.destroy(),this._set("featuresTilingScheme",null)}_getScreenshotView(e){var s;const{allLayerViews:t,padding:r,size:i,stage:n}=this;return{allLayerViews:t,backgroundColor:e!=null&&e.ignoreBackground?null:(s=this.background)==null?void 0:s.color,padding:r,size:i,stage:n}}_spatialReferenceChanged(e){if(this.ready){this.frameTask.stop();for(const t of this.allLayerViews)t.processDetach();this._destroySpatialReferenceDependentProperties(),this.stateManager.changeSpatialReference(e),this.stage.state=this.state,this._setupSpatialReferenceDependentProperties();for(const t of this.allLayerViews)t.processAttach();this.frameTask.requestFrame(),this.frameTask.start(),this._updateStageChildren()}}};Qe.type="2d",l([p({readOnly:!0})],Qe.prototype,"animationManager",void 0),l([p({constructOnly:!0})],Qe.prototype,"deactivatedWebGLExtensions",void 0),l([p({constructOnly:!0})],Qe.prototype,"debugWebGLExtensions",void 0),l([p({readOnly:!0})],Qe.prototype,"featuresTilingScheme",void 0),l([p({readOnly:!0})],Qe.prototype,"fullOpacity",void 0),l([p()],Qe.prototype,"goToManager",void 0),l([p({readOnly:!0})],Qe.prototype,"graphicsTileStore",null),l([p()],Qe.prototype,"graphicsView",void 0),l([p()],Qe.prototype,"stateManager",void 0),l([p()],Qe.prototype,"constraintsInfo",null),l([p({readOnly:!0})],Qe.prototype,"state",null),l([p()],Qe.prototype,"initialExtentRequired",null),l([p()],Qe.prototype,"labelManager",void 0),l([p({readOnly:!0})],Qe.prototype,"mapViewNavigation",void 0),l([p({constructOnly:!0})],Qe.prototype,"renderCanvas",void 0),l([p()],Qe.prototype,"renderingOptions",void 0),l([p({constructOnly:!0})],Qe.prototype,"supersampleScreenshotsEnabled",void 0),l([p({readOnly:!0})],Qe.prototype,"supportsGround",void 0),l([p()],Qe.prototype,"_defaultsFromMapSettings",null),l([p({readOnly:!0})],Qe.prototype,"typeSpecificPreconditionsReady",null),l([p()],Qe.prototype,"animation",null),l([p({type:pke})],Qe.prototype,"background",null),l([p()],Qe.prototype,"center",null),l([p({type:lX})],Qe.prototype,"constraints",null),l([p()],Qe.prototype,"extent",null),l([p()],Qe.prototype,"floors",void 0),l([p({type:EX})],Qe.prototype,"highlightOptions",void 0),l([p({readOnly:!0})],Qe.prototype,"inputManager",void 0),l([p()],Qe.prototype,"map",void 0),l([p()],Qe.prototype,"padding",null),l([p({readOnly:!0})],Qe.prototype,"rendering",null),l([p()],Qe.prototype,"resizeAlign",null),l([p({readOnly:!0})],Qe.prototype,"resolution",null),l([p()],Qe.prototype,"rotation",null),l([p()],Qe.prototype,"scale",null),l([p({constructOnly:!0})],Qe.prototype,"spatialReferenceLocked",void 0),l([p()],Qe.prototype,"stationary",null),l([p({type:PX,readOnly:!0})],Qe.prototype,"timeline",void 0),l([p({readOnly:!0})],Qe.prototype,"type",void 0),l([p({readOnly:!0})],Qe.prototype,"updating",null),l([p()],Qe.prototype,"viewpoint",null),l([p()],Qe.prototype,"zoom",null),l([p({readOnly:!0})],Qe.prototype,"navigating",null),l([p(),Tt(e=>e instanceof hQ?e:rr(dQ,e))],Qe.prototype,"ui",void 0),Qe=l([k("esri.views.MapView")],Qe);const bQ=Qe,dke=Lp({name:"BaseMap",__name:"index",props:{},emits:["map-ready"],setup(e,{emit:t}){const r=t,i=Qp();Ot();const n=Ot();Ot(!1);const s=()=>{const o=new KP({}),a=new bQ({map:o,container:n.value,ui:{components:[]},zoom:4,constraints:{}});i.setView(gS(a)),window.aha=a,r("map-ready",a)};return lO(()=>{s()}),(o,a)=>(La(),kp("div",{ref_key:"mapBoxRef",ref:n,class:"map-box"},null,512))}}),fke=Um(dke,[["__scopeId","data-v-0b81e6c1"]]),yke=(e,t)=>{let r=null,i={...t,spatialReference:e.spatialReference};return delete i.type,delete i.name,delete i.mode,t.type==="wmts"&&(r=new MT({...i})),r?(r.configData=t,r):null};class mke{constructor(t,r=[]){this.view=t,this.config=hO.cloneDeep(r)}showGroup(t){var i;const r=this.config.find(n=>n.id===t);(i=r==null?void 0:r.layers)!=null&&i.length&&r.layers.forEach(n=>{this.showLayer(n)})}hideGroup(t){var i;const r=this.config.find(n=>n.id===t);(i=r==null?void 0:r.layers)!=null&&i.length&&r.layers.forEach(n=>{this.hideLayer(n)})}showLayer(t){debugger;let r=this.view.map.findLayerById(t.id);if(r)r.visible=!0;else if(r=this.createLayer(t),r){r.visible=!0;const i=t.metaData.loadNum;this.view.map.basemap.baseLayers.add(r,i)}}hideLayer(t){let r=this.view.map.findLayerById(t.id);r&&(r.visible=!1)}createLayer(t){return yke(this.view,t)}}const Uu=window.serverConfig,gke=window.baseLayerConfig;Uu==null||Uu.SERVICE_URL;Uu==null||Uu.API_PREFIX;Uu!=null&&Uu.WKID;const vke=e=>e.map(t=>(t.layers=t.layers.map(r=>(r.tileInfoType==="tileInfoTDT"&&(r.tileInfo=hAe),r.tileInfoType&&delete r.tileInfoType,r)),t)),XU=vke(gke.baseLayers),wke={class:"base-layer-switch-box"},bke={class:"el-dropdown-link"},$_="id",_ke=Lp({name:"BaseLayerSwitch",__name:"indexSwitch",setup(e){const t=Qp(),{view:r}=Rv(t),i=Ot(),n=Ot([]),s={label:"name",class:"base-layer-tree-node"},o=Ot([]);let a=null;const u=(h,d,y)=>{console.log(h,d,y);const v=h[$_];d?a.showGroup(v):a.hideGroup(v)},c=()=>{a=new mke(r==null?void 0:r.value,XU),n.value=[...XU];const h=[];n.value.forEach(d=>{if(d.defaultShow){const y=d[$_];h.push(d[$_]),a.showGroup(y)}}),o.value=[...h]};return Cv(r,h=>{debugger;c()}),(h,d)=>{const y=Zt("Place"),v=Zt("el-icon"),w=Zt("el-tree"),b=Zt("el-dropdown-menu"),_=Zt("el-dropdown");return La(),kp("div",wke,[ut(_,{trigger:"click"},{dropdown:ir(()=>[ut(b,null,{default:ir(()=>[ut(w,{ref_key:"baseLayerTreeRef",ref:i,style:{"max-width":"600px"},data:n.value,props:s,"default-expand-all":!0,"node-key":$_,"default-checked-keys":o.value,"show-checkbox":"",onCheckChange:u},null,8,["data","default-checked-keys"])]),_:1})]),default:ir(()=>[gr("span",bke,[ut(v,{color:"",size:""},{default:ir(()=>[ut(y)]),_:1})])]),_:1})])}}});function Ske(){function e(r,i){const n=r.data,s=document.createElement("canvas"),o=s.getContext("2d");return s.height=n.height,s.width=n.width,o.putImageData(n,0,0),o.font="20px Arial",o.fillStyle="#000",o.fillRect(0,n.height-40,o.measureText(i).width+20,30),o.fillStyle="#fff",o.fillText(i,10,n.height-20),s.toDataURL()}function t(r,i){if(window.navigator.msSaveOrOpenBlob){const n=atob(i.split(",")[1]),s=i.split(",")[0].split(":")[1].split(";")[0],o=new ArrayBuffer(n.length),a=new Uint8Array(o);for(let c=0;c<n.length;c++)a[c]=n.charCodeAt(c);const u=new Blob([o],{type:s});window.navigator.msSaveOrOpenBlob(u,r)}else{const n=document.createElement("a");n.setAttribute("href",i),n.setAttribute("download",r),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}}return{getImageWithText:e,downloadImage:t}}const xke=e=>(Loe("data-v-7222cc5a"),e=e(),koe(),e),Tke={class:"snapshotTeleportDiv"},Ike={class:"wrapper"},Mke=xke(()=>gr("div",null,null,-1)),$ke=Lp({name:"MapSnapshot",__name:"index",props:{},setup(e){const t=Qp(),{view:r,mapAndToolBoxDom:i}=Rv(t),{getImageWithText:n,downloadImage:s}=Ske(),o=Ot(!1),a=Ot(!1);let u=null;const c=Ot(""),h=Ot(null),d=Ot(null),y=Ot(!0),v=R=>{const L=d.value;L&&(R?(y.value=!1,L.style.left=`${R.x}px`,L.style.top=`${R.y}px`,L.style.width=`${R.width}px`,L.style.height=`${R.height}px`):y.value=!0)},w=Ot(null),b=Ot(!0),_=Ot(null),x=R=>{b.value=!1;const L=_.value;L.src=R.dataUrl},T=()=>{const R=(C,U,F)=>C<U?U:C>F?F:C;r.value.cursor="crosshair";let L=null;h.value=r.value.on("drag",C=>{var U;if(C.stopPropagation(),C.action!=="end"){const{width:F,height:j}=r.value,q=R(Math.min(C.origin.x,C.x),0,F),K=R(Math.max(C.origin.x,C.x),0,F),X=R(Math.min(C.origin.y,C.y),0,j),ne=R(Math.max(C.origin.y,C.y),0,j);L={x:q,y:X,width:K-q,height:ne-X},v(L)}else(U=h.value)==null||U.remove(),r.value.takeScreenshot({area:L,format:"png"}).then(F=>{u=F,x(F),r.value.cursor="default",v(null)})})},I=()=>{var R;(R=h.value)==null||R.remove(),r.value.cursor="default",v(null),b.value=!0},M=()=>{o.value&&(a.value=!a.value,a.value?T():I())},$=()=>{if(c.value){const R=n(u,c.value);s("map.png",R)}else s("map.png",u.dataUrl)},A=()=>{b.value=!0,a.value=!1};return Cv(r,R=>{R&&!o.value&&(o.value=!0)},{immediate:!0}),(R,L)=>{const C=Zt("Camera"),U=Zt("el-icon"),F=Zt("el-button");return La(),kp("div",{class:"snapshot-box",onClick:M},[ut(U,null,{default:ir(()=>[ut(C)]),_:1}),dm(i)?(La(),uO(cO,{key:0,to:dm(i)},[gr("div",Tke,[jd(gr("div",{ref_key:"maskRef",ref:d,class:"mask"},null,512),[[Ud,!y.value]]),jd(gr("div",{ref_key:"screenshotDivRef",ref:w,id:"screenshotDiv"},[gr("div",Ike,[gr("img",{ref_key:"screenshotImageRef",ref:_},null,512),Mke,ut(F,{onClick:$},{default:ir(()=>[mS("下载图片")]),_:1}),ut(F,{onClick:A},{default:ir(()=>[mS("返回")]),_:1})])],512),[[Ud,!b.value]])])],8,["to"])):pO("",!0)])}}}),Eke=Um($ke,[["__scopeId","data-v-7222cc5a"]]),_Q="multi_view_tool";class Ake{constructor(t,r,i){this.mainView=t,this.subViewRef=r,this.mapStore=i,this.subView=null,this.viewInstances=[t],this.syncWatchHandlers=[],this.layerController=null,this.sync=hO.debounce(this.sync.bind(this),50)}initMultiView(){const t=this.mainView.map.basemap||{},r=this.mainView.spatialReference,i=this.mainView.viewpoint,n=new KP({basemap:t}),s=new bQ({map:n,spatialReference:r,container:this.subViewRef,ui:{components:[]},constraints:{},viewpoint:i});this.subView=gS(s),this.viewInstances.push(this.subView),this.addSyncEvent(),window.ahaSubView=this.subView}destroyMultiView(){this.removeSyncEvent();for(let t=this.viewInstances.length-1;t>=0;t--){const r=this.viewInstances[t];r!=this.mainView&&(this.viewInstances.splice(t,1),r.map=null,r.destroy())}this.subView=null,window.ahaSubView=null}addSyncEvent(){this.removeSyncEvent();for(const t of this.viewInstances){const r=Ue(()=>[t.interacting,t.viewpoint,t.rotation],([i,n,s])=>{i&&(console.log("interacting"),this.mapStore.setActiveView(gS(t)),this.sync(t)),n&&this.sync(t)});this.syncWatchHandlers.push(r)}}sync(t){for(const r of this.viewInstances)r!==t&&(r.viewpoint=t.viewpoint,r.rotation=t.rotation)}removeSyncEvent(){this.syncWatchHandlers.forEach(t=>{t.remove()}),this.syncWatchHandlers=[]}}const Rke={class:"multi-view-box"},Cke={class:"layer-selector"},Oke={class:"tree-box"},Pke={class:"head"},Lke={class:"custom-tree-node"},kke={class:"el-tree-node__label"},Nke="id",Dke=Lp({name:"MultiView",__name:"index",setup(e){const t=Qp(),{view:r,multiViewTeleportBoxDom:i}=Rv(t),n=Ot(),s=Ot(!1),o=Ot(!0),a=Ot(EC),u={label:"name",class:"layer-tree-node",disabled:"disabled"},c=Ot([]);let h=null,d=null;const y=()=>{d=new Ake(r==null?void 0:r.value,i==null?void 0:i.value,t)},v=()=>{s.value=!s.value,s.value?(a.value=EC,t.setActiveView(gS(r.value)),d.initMultiView(),h=new XY(d.subView),t.addSubView(d.subView),t.setActiveTool(_Q)):(d.destroyMultiView(),t.removeSubView(d.subView),t.setActiveView(null),t.setActiveTool(""))},w=(b,_,x)=>{console.log(b,_,x),_?h.show(b):h.hide(b)};return lO(()=>{Cv([r,i],([b,_])=>{b&&_&&y()},{immediate:!0})}),(b,_)=>{const x=Zt("Grid"),T=Zt("el-icon"),I=Zt("Coin"),M=Zt("el-tooltip"),$=Zt("DArrowRight"),A=Zt("el-tree"),R=Zt("el-scrollbar");return La(),kp("div",{onClick:v},[ut(T,null,{default:ir(()=>[ut(x)]),_:1}),dm(i)?(La(),uO(cO,{key:0,to:dm(i)},[jd(gr("div",Rke,[gr("div",{ref_key:"subViewRef",ref:n,class:"sub-view-box"},null,512),gr("div",Cke,[ut(M,{effect:"light",content:"图层树",placement:"bottom"},{default:ir(()=>[jd(ut(T,{class:"fold-btn",onClick:_[0]||(_[0]=L=>o.value=!1)},{default:ir(()=>[ut(I)]),_:1},512),[[Ud,o.value]])]),_:1}),jd(gr("div",Oke,[gr("div",Pke,[ut(T,{class:"",onClick:_[1]||(_[1]=L=>o.value=!0)},{default:ir(()=>[ut($)]),_:1})]),ut(R,{"max-height":"100"},{default:ir(()=>[ut(A,{ref:"subViewLayerTreeRef","node-key":Nke,data:a.value,props:u,"default-checked-keys":c.value,"show-checkbox":"",onCheckChange:w},{default:ir(({node:L,data:C})=>[gr("span",Lke,[gr("span",kke,oV(L.label),1)])]),_:1},8,["data","default-checked-keys"])]),_:1})],512),[[Ud,!o.value]])])],512),[[Ud,s.value]])],8,["to"])):pO("",!0)])}}}),Fke=Um(Dke,[["__scopeId","data-v-8ceb52c2"]]),jke="map_swipe_tool";let yS=class extends Q{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};l([p({readOnly:!0})],yS.prototype,"version",null),yS=l([k("esri.views.layers.support.ClipArea")],yS);const Uke=yS;var sO;let yd=sO=class extends Uke{constructor(e){super(e),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new sO({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};l([p({type:[Number,String],json:{write:!0}})],yd.prototype,"left",void 0),l([p({type:[Number,String],json:{write:!0}})],yd.prototype,"right",void 0),l([p({type:[Number,String],json:{write:!0}})],yd.prototype,"top",void 0),l([p({type:[Number,String],json:{write:!0}})],yd.prototype,"bottom",void 0),yd=sO=l([k("esri.views.layers.support.ClipRect")],yd);const E_=yd;function Vke(e,t){const r=10**t;return Math.round(e*r)/r}const A_={left:0,right:0,top:0,bottom:0};let ys=class extends De{constructor(t){super(t),this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new $e,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new $e,this.view=null}initialize(){this.addHandles([Ue(()=>{var t;return[this.view,(t=this.view)==null?void 0:t.ready,this.position,this.direction]},()=>this._clipLayers(),Xi),rs(()=>this.leadingLayers,"change",()=>this._clipLeadingLayers()),rs(()=>this.trailingLayers,"change",()=>this._clipTrailingLayers())])}destroy(){this._removeExistingClips()}get position(){return 25}set position(t){const{precision:r,min:i,max:n}=this;this._set("position",Vke(Math.max(Math.min(t,n),i),r))}get state(){const{view:t}=this;return t&&t.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:t}=this;t.forEach(r=>this._clipLayer({layer:r,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:t}=this;t.forEach(r=>this._clipLayer({layer:r,type:"trailing"}))}async _getLayerView(t){const{view:r}=this;if(!t||!r)return null;const i=await r.whenLayerView(t);return"clips"in i?i:null}_getVerticalClipRect(t){const{position:r}=this;return t==="leading"?new E_({...A_,bottom:100-r+"%"}):t==="trailing"?new E_({...A_,top:`${r}%`}):null}_getHorizontalClipRect(t){const{position:r}=this;return t==="leading"?new E_({...A_,right:100-r+"%"}):t==="trailing"?new E_({...A_,left:`${r}%`}):null}_getClipRect(t){const{direction:r}=this;return r==="vertical"?this._getVerticalClipRect(t):r==="horizontal"?this._getHorizontalClipRect(t):null}async _clipLayer(t){const{_leadingClips:r,_trailingClips:i}=this,{layer:n,type:s}=t,o=s==="trailing"?i:s==="leading"?r:null,a=await this._getLayerView(n);if(!(a&&"clips"in a&&o&&a.hasOwnProperty("clips")))return;const u=o.get(a);u&&a.clips.remove(u);const c=this._getClipRect(s);c&&(o.set(a,c),a.clips.add(c))}_removeClips(t){const{_leadingClips:r,_trailingClips:i}=this,n=t==="trailing"?i:t==="leading"?r:null;n&&(n.forEach((s,o)=>{o&&o.hasOwnProperty("clips")&&o.clips.remove(s)}),n.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};l([p()],ys.prototype,"direction",void 0),l([p({type:$e,nonNullable:!0})],ys.prototype,"leadingLayers",void 0),l([p({readOnly:!0})],ys.prototype,"max",void 0),l([p({readOnly:!0})],ys.prototype,"min",void 0),l([p()],ys.prototype,"position",null),l([p()],ys.prototype,"precision",void 0),l([p({readOnly:!0})],ys.prototype,"state",null),l([p()],ys.prototype,"step",void 0),l([p()],ys.prototype,"stepMultiplier",void 0),l([p({type:$e,nonNullable:!0})],ys.prototype,"trailingLayers",void 0),l([p()],ys.prototype,"view",void 0),ys=l([k("esri.widgets.Swipe.SwipeViewModel")],ys);const SQ=ys,Xl="esri-swipe",ea={base:Xl,widgetIcon:Pp.upDownArrows,baseDisabled:`${Xl}--disabled`,vertical:`${Xl}--vertical`,horizontal:`${Xl}--horizontal`,container:`${Xl}__container`,divider:`${Xl}__divider`,handle:`${Xl}__handle`,handleHidden:`${Xl}__handle--hidden`,handleIcon:`${Xl}__handle-icon`},QU={handle:!0,divider:!0};let _n=class extends vw{constructor(e,t){super(e,t),this.disabled=!1,this.iconClass=ea.widgetIcon,this.icon=null,this.messages=null,this.viewModel=new SQ,this._pointerOffset=0,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){var e;return((e=this.messages)==null?void 0:e.dragLabel)??""}set dragLabel(e){this._overrideIfSome("dragLabel",e)}get label(){var e;return((e=this.messages)==null?void 0:e.widgetLabel)??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...QU,...e})}get visibleElements(){return this._get("visibleElements")||QU}render(){const{state:e,direction:t}=this.viewModel,r=e==="disabled"||this.disabled,i={[Fo.disabled]:r,[ea.baseDisabled]:r,[ea.vertical]:t==="vertical",[ea.horizontal]:t==="horizontal"};return Ii("div",{class:this.classes(ea.base,Fo.widget,i)},e==="disabled"?null:this._renderContainer())}_renderHandle(){const{direction:e}=this.viewModel,{visibleElements:t}=this,r={[Pp.dragHorizontal]:e==="vertical",[Pp.dragVertical]:e==="horizontal"},i=this.classes(ea.handle,!t.handle&&ea.handleHidden);return Ii("div",{class:i,key:"handle",role:"presentation"},Ii("span",{"aria-hidden":"true",class:this.classes(ea.handleIcon,r)}))}_renderDivider(){const{visibleElements:e}=this;return e&&e.divider?Ii("div",{class:ea.divider,key:"divider",role:"presentation"}):null}_renderContent(){return[this._renderDivider(),this._renderHandle()]}_renderContainer(){const{disabled:e,dragLabel:t,viewModel:r}=this,{max:i,min:n,direction:s,position:o}=r,a=`${o}%`,u={top:s==="vertical"?a:void 0,left:s==="vertical"?void 0:a},c=this._renderContent();return Ii("div",e?{class:ea.container,key:"container",role:"presentation",styles:u}:{afterCreate:this._afterContainerCreate,"aria-label":t,"aria-orientation":s,"aria-valuemax":`${i}`,"aria-valuemin":`${n}`,"aria-valuenow":`${o}`,"aria-valuetext":a,bind:this,class:ea.container,key:"container",onkeydown:this._onContainerKeyDown,role:"slider",styles:u,tabIndex:0,title:t,"touch-action":"none"},c)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:t}=this,r=e.target,i=(t==="vertical"?r.clientHeight:r.clientWidth)/2,n=r.getBoundingClientRect(),s=e.clientX-n.left,o=e.clientY-n.top;this._pointerOffset=t==="vertical"?o-i:s-i}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:t,container:r,direction:i}=this,{clientX:n,clientY:s}=e,{top:o,left:a,width:u,height:c}=r.getBoundingClientRect(),h=(i==="vertical"?s-o-t:n-a-t)/(i==="vertical"?c:u)*100;this.position=h}_getKeyPosition(e){const{key:t}=e,{position:r}=this,{max:i,min:n,step:s,stepMultiplier:o,direction:a}=this.viewModel,u=s*o;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(t)&&(e.preventDefault(),e.stopPropagation()),(a==="vertical"?t==="ArrowDown"||t==="ArrowRight":t==="ArrowUp"||t==="ArrowRight")?r+(e.shiftKey?u:s):(a==="vertical"?t==="ArrowUp"||t==="ArrowLeft":t==="ArrowDown"||t==="ArrowLeft")?r-(e.shiftKey?u:s):t==="Home"?n:t==="End"?i:(a==="vertical"?t==="PageDown":t==="PageUp")?r+u:(a==="vertical"?t==="PageUp":t==="PageDown")?r-u:null}_onContainerKeyDown(e){const t=this._getKeyPosition(e);typeof t=="number"&&(this.position=t)}};l([p()],_n.prototype,"direction",null),l([p()],_n.prototype,"disabled",void 0),l([p()],_n.prototype,"dragLabel",null),l([p()],_n.prototype,"iconClass",void 0),l([p()],_n.prototype,"icon",void 0),l([p()],_n.prototype,"label",null),l([p()],_n.prototype,"leadingLayers",null),l([p(),ww("esri/widgets/Swipe/t9n/Swipe")],_n.prototype,"messages",void 0),l([p()],_n.prototype,"position",null),l([p()],_n.prototype,"trailingLayers",null),l([p()],_n.prototype,"view",null),l([p({type:SQ})],_n.prototype,"viewModel",void 0),l([p()],_n.prototype,"visibleElements",null),_n=l([k("esri.widgets.Swipe")],_n);const Gke=_n;class Bke{constructor(t,r){this.view=t,this.updateTransferDataCallback=r,this.swipe=null,this.leftLayers=[],this.rightLayers=[],this.initLayerChangeWatcher()}initMapSwipe(t=50){var r;this.swipe=new Gke({view:this.view,leadingLayers:this.leftLayers,trailingLayers:this.rightLayers,direction:"horizontal",position:t}),(r=this.view)==null||r.ui.add(this.swipe)}destroyMapSwipe(){var t;(t=this.swipe)==null||t.destroy(),this.swipe=null}isLayerForSwipe(t){return t.visible&&t.type!=="graphics"}getCurrentLayerState(){return console.log("getCurrentLayerState---------------"),this.view.map.layers.map(t=>({id:t.id,title:t.title,visible:t.visible,layer:t}))}handleLayerChange(t){console.log("handleLayerChange---------------"),t.forEach(n=>{if(this.isLayerForSwipe(n)){const s=this.leftLayers.findIndex(a=>a.id==n.id)!=-1,o=this.rightLayers.findIndex(a=>a.id==n.id)!=-1;!s&&!o&&(this.leftLayers=[...this.leftLayers,n.layer])}else this.leftLayers=this.leftLayers.filter(s=>s.id!=n.id),this.rightLayers=this.rightLayers.filter(s=>s.id!=n.id)}),this.updateSwipeLayers();let r=[...this.leftLayers,...this.rightLayers].map(n=>({key:n.id,label:n.title||`图层${n.id.substring(0,5)}`}));r=r.length>0?r:[];let i=this.rightLayers.map(n=>n.id);this.updateTransferDataCallback(r,i)}initLayerChangeWatcher(){console.log("initLayerChangeWatcher---------------"),Ue(()=>this.getCurrentLayerState(),t=>this.handleLayerChange(t),{initial:!0})}updateSwipeLayers(){this.swipe&&(this.swipe.leadingLayers=this.leftLayers,this.swipe.trailingLayers=this.rightLayers,this.swipe.position+=.1,setTimeout(()=>{this.swipe.position-=.1},0))}updateSwipeLayersByTransfer(t){let r=[],i=[];[...this.leftLayers,...this.rightLayers].forEach(n=>{t.includes(n.id)?i.push(n):r.push(n)}),this.leftLayers=r,this.rightLayers=i,this.updateSwipeLayers()}}const zke={class:"map-swipe-box"},qke={class:"layer-selector"},Hke=Lp({name:"MapSwipe",__name:"index",setup(e){const t=Qp(),{view:r,mapSwipeTeleportBoxDom:i}=Rv(t),n=Ot(!1),s=()=>{const v=[];for(let w=1;w<=15;w++)v.push({key:w,label:`Option ${w}`,disabled:w%4===0});return v},o=Ot([]),a=Ot(s());let u=null;const c=()=>{u=new Bke(r==null?void 0:r.value,d)},h=()=>{n.value=!n.value,n.value?(u.initMapSwipe(),t.setActiveTool(jke)):(u.destroyMapSwipe(),t.setActiveTool(""))},d=(v,w)=>{o.value=w,a.value=hO.clone(v)},y=(v,w,b)=>{u.updateSwipeLayersByTransfer(v)};return lO(()=>{Cv([r,i],([v,w])=>{v&&w&&c()},{immediate:!0})}),(v,w)=>{const b=Zt("MagicStick"),_=Zt("el-icon"),x=Zt("el-transfer");return La(),kp("div",{onClick:h},[ut(_,null,{default:ir(()=>[ut(b)]),_:1}),dm(i)?(La(),uO(cO,{key:0,to:dm(i)},[jd(gr("div",zke,[gr("div",qke,[ut(x,{modelValue:o.value,"onUpdate:modelValue":w[0]||(w[0]=T=>o.value=T),data:a.value,titles:["左侧图层","右侧图层"],onChange:y},null,8,["modelValue","data"])])],512),[[Ud,n.value]])],8,["to"])):pO("",!0)])}}}),Wke={class:"tool-bar"},Jke=Lp({name:"ToolBar",__name:"ToolBar",setup(e){return Qp(),(t,r)=>{const i=Zt("el-tooltip");return La(),kp("div",Wke,[ut(i,{effect:"light",content:"底图切换",placement:"bottom"},{default:ir(()=>[ut(_ke,{class:"bar-btn"})]),_:1}),ut(i,{effect:"light",content:"地图截屏",placement:"bottom"},{default:ir(()=>[ut(Eke,{class:"bar-btn"})]),_:1}),ut(i,{effect:"light",content:"地图分屏",placement:"bottom"},{default:ir(()=>[ut(Fke,{class:"bar-btn"})]),_:1}),ut(i,{effect:"light",content:"地图卷帘",placement:"bottom"},{default:ir(()=>[ut(Hke,{class:"bar-btn"})]),_:1})])}}}),Zke=Um(Jke,[["__scopeId","data-v-4e9c3741"]]),Yke={class:"wrapper"},Kke={class:"layer-tree-wrapper"},Xke=Lp({name:"MapView",__name:"index",setup(e){const t=Qp(),r=Ot(null),i=Ot(null),n=Ot(null);t.setMapAndToolBoxDom(r),t.setMultiViewTeleportBoxDom(i),t.setMapSwipeTeleportBoxDom(n);const s=Noe(()=>t.activeTool===_Q?"half-box":"");return(o,a)=>(La(),kp("div",Yke,[gr("div",Kke,[ut(wAe)]),gr("div",{ref_key:"boxRef",ref:r,class:"map-and-tool-box"},[ut(fke,{class:jN(s.value)},null,8,["class"]),gr("div",{ref_key:"multiViewTeleportBoxRef",ref:i,class:jN(["teleport-box right",s.value])},null,2),gr("div",{ref_key:"mapSwipeTeleportBoxRef",ref:n,class:"teleport-box bottom-down"},null,512),ut(Zke)],512)]))}}),Qke=Um(Xke,[["__scopeId","data-v-1b0583b6"]]),xGe=Object.freeze(Object.defineProperty({__proto__:null,default:Qke},Symbol.toStringTag,{value:"Module"}));export{Ybe as $,cr as A,Da as B,BF as C,jF as D,UF as E,QF as F,fi as G,UCe as H,GF as I,pf as J,bq as K,Z8e as L,rs as M,C6 as N,xNe as O,Xi as P,ff as Q,iv as R,kle as S,be as T,zF as U,$e as V,MB as W,EX as X,ve as Y,ka as Z,ws as _,k1e as a,mr as a$,Xn as a0,rv as a1,rf as a2,Yb as a3,zO as a4,BO as a5,Bd as a6,qO as a7,SDe as a8,VJ as a9,nv as aA,Ti as aB,pt as aC,Ss as aD,Ea as aE,jv as aF,Ne as aG,Nx as aH,NDe as aI,n4 as aJ,hye as aK,JDe as aL,ZDe as aM,RDe as aN,CDe as aO,LDe as aP,PDe as aQ,$p as aR,ODe as aS,qDe as aT,sT as aU,Hp as aV,Ap as aW,Wp as aX,Wu as aY,Al as aZ,W$ as a_,Oce as aa,Dd as ab,aDe as ac,C4 as ad,A1 as ae,ts as af,x6e as ag,wG as ah,Ae as ai,fm as aj,Ut as ak,j2e as al,G5 as am,B5 as an,Txe as ao,Ixe as ap,Mxe as aq,gUe as ar,mUe as as,ro as at,Jge as au,Hge as av,dUe as aw,Nl as ax,YDe as ay,OO as az,Ei as b,K7e as b$,H$ as b0,Z$ as b1,US as b2,xe as b3,TH as b4,No as b5,g4 as b6,S8 as b7,TDe as b8,m8e as b9,pwe as bA,hwe as bB,vwe as bC,xwe as bD,pW as bE,uW as bF,cW as bG,Swe as bH,Ewe as bI,Awe as bJ,sB as bK,ppe as bL,Ope as bM,iE as bN,Fp as bO,Uv as bP,Xx as bQ,oDe as bR,$S as bS,Vce as bT,Qce as bU,XG as bV,nB as bW,tB as bX,epe as bY,Jle as bZ,JNe as b_,T8e as ba,ev as bb,H4e as bc,zp as bd,Zp as be,Dge as bf,Q7 as bg,Yu as bh,H1e as bi,BNe as bj,Pt as bk,J8e as bl,Jve as bm,sAe as bn,CH as bo,jo as bp,qNe as bq,jX as br,aGe as bs,uGe as bt,ZPe as bu,FPe as bv,K9e as bw,Ov as bx,Bo as by,uwe as bz,Z1 as c,Ye as c$,zJ as c0,pr as c1,p_ as c2,nR as c3,Rn as c4,Ip as c5,Zs as c6,iNe as c7,E2e as c8,Ym as c9,DT as cA,z2e as cB,Qfe as cC,WDe as cD,mT as cE,aje as cF,lZ as cG,aZ as cH,oje as cI,sje as cJ,Dfe as cK,Jz as cL,yf as cM,Go as cN,fye as cO,XDe as cP,pye as cQ,KDe as cR,$a as cS,cDe as cT,oZ as cU,oB as cV,kr as cW,Js as cX,lje as cY,Yx as cZ,qJ as c_,dG as ca,A2e as cb,q9e as cc,l9e as cd,df as ce,$1 as cf,fA as cg,W9e as ch,H9e as ci,Cn as cj,tn as ck,Q as cl,rr as cm,Nue as cn,R9e as co,L9e as cp,F8 as cq,dye as cr,uf as cs,Gye as ct,k9e as cu,Zu as cv,x8e as cw,dje as cx,bDe as cy,VS as cz,Rl as d,Qm as d$,_R as d0,S7e as d1,Zj as d2,mMe as d3,hMe as d4,qje as d5,Hje as d6,xTe as d7,Jje as d8,Wje as d9,De as dA,xf as dB,qp as dC,Jp as dD,kl as dE,te as dF,pH as dG,j4 as dH,Qv as dI,Ts as dJ,oo as dK,qd as dL,Ll as dM,_f as dN,wV as dO,Ux as dP,b4 as dQ,Jv as dR,hv as dS,Zn as dT,Kn as dU,vme as dV,Hx as dW,wme as dX,JY as dY,UNe as dZ,$8e as d_,Zje as da,S$e as db,ax as dc,eo as dd,cNe as de,cx as df,tue as dg,mm as dh,AO as di,hve as dj,$ae as dk,z4 as dl,Po as dm,JS as dn,q1e as dp,Z4 as dq,w8e as dr,I8e as ds,Ce as dt,HP as du,SNe as dv,wO as dw,Fv as dx,It as dy,qv as dz,Xt as e,JC as e$,KY as e0,mDe as e1,S1e as e2,_De as e3,fDe as e4,se as e5,$D as e6,Uo as e7,MT as e8,Et as e9,pue as eA,TO as eB,Il as eC,Vge as eD,Ns as eE,sEe as eF,Lv as eG,l2 as eH,KNe as eI,HNe as eJ,We as eK,El as eL,cxe as eM,AEe as eN,Z$e as eO,yUe as eP,tEe as eQ,fUe as eR,eEe as eS,is as eT,H4 as eU,VV as eV,X9e as eW,$i as eX,DSe as eY,vO as eZ,fX as e_,tw as ea,rw as eb,$T as ec,mpe as ed,ew as ee,jue as ef,spe as eg,ope as eh,$pe as ei,jge as ej,Bm as ek,oGe as el,cGe as em,sGe as en,Xr as eo,eY as ep,rNe as eq,Ju as er,Dp as es,Vy as et,ku as eu,z8e as ev,di as ew,f9 as ex,YF as ey,X1 as ez,N1e as f,Vm as f$,Fm as f0,yX as f1,kOe as f2,dL as f3,nD as f4,uS as f5,dDe as f6,KG as f7,gpe as f8,ROe as f9,cw as fA,_M as fB,ox as fC,Xv as fD,aw as fE,LJ as fF,Fge as fG,vP as fH,nAe as fI,GAe as fJ,VAe as fK,jAe as fL,_e as fM,L7 as fN,CT as fO,vl as fP,Mi as fQ,Ta as fR,gT as fS,nNe as fT,AD as fU,wP as fV,gv as fW,ZP as fX,Ke as fY,Bge as fZ,Gge as f_,Fi as fa,OOe as fb,dX as fc,Wi as fd,Iu as fe,zP as ff,b7e as fg,Uy as fh,PA as fi,vpe as fj,Lr as fk,Y2e as fl,Em as fm,BH as fn,LH as fo,lx as fp,Vz as fq,cf as fr,eAe as fs,KEe as ft,aEe as fu,IT as fv,y8 as fw,TP as fx,xm as fy,F4 as fz,oe as g,jO as g$,MEe as g0,J$e as g1,Ku as g2,s0 as g3,i0 as g4,Sje as g5,_je as g6,bje as g7,NEe as g8,nEe as g9,wce as gA,RF as gB,CF as gC,ZF as gD,OF as gE,ft as gF,l9 as gG,dFe as gH,fFe as gI,wFe as gJ,yFe as gK,mFe as gL,gFe as gM,vFe as gN,Fue as gO,LO as gP,kO as gQ,Jx as gR,Zx as gS,Bp as gT,CA as gU,y1e as gV,X8e as gW,W as gX,b0e as gY,mH as gZ,bT as g_,REe as ga,W1e as gb,dEe as gc,fEe as gd,yEe as ge,hl as gf,gEe as gg,vEe as gh,wEe as gi,bEe as gj,_Ee as gk,SEe as gl,xEe as gm,TEe as gn,IP as go,IEe as gp,Uge as gq,qr as gr,pNe as gs,Dv as gt,HF as gu,Yn as gv,eje as gw,LOe as gx,rOe as gy,FG as gz,wOe as h,hDe as h$,ET as h0,Tpe as h1,hpe as h2,iB as h3,FO as h4,G4 as h5,cR as h6,s9e as h7,m1 as h8,xSe as h9,R1e as hA,vDe as hB,wp as hC,yT as hD,Fpe as hE,kF as hF,NF as hG,PF as hH,DF as hI,Zbe as hJ,qA as hK,HA as hL,et as hM,NT as hN,qm as hO,Yi as hP,no as hQ,Uke as hR,E_ as hS,t0e as hT,pT as hU,Xd as hV,YH as hW,hNe as hX,TNe as hY,INe as hZ,GOe as h_,zce as ha,ipe as hb,Cpe as hc,Ppe as hd,UOe as he,Iwe as hf,kue as hg,gH as hh,Gue as hi,Ix as hj,lpe as hk,npe as hl,QG as hm,Wce as hn,uDe as ho,t0 as hp,rB as hq,S0e as hr,HS as hs,pDe as ht,Rt as hu,ZT as hv,q4 as hw,Z1e as hx,Y1e as hy,ZY as hz,L1e as i,lv as i$,R0e as i0,qce as i1,Hce as i2,Gce as i3,C0e as i4,qq as i5,q0e as i6,EOe as i7,QNe as i8,YNe as i9,Z9e as iA,_p as iB,E7 as iC,mZ as iD,pv as iE,nGe as iF,Bje as iG,Yje as iH,ww as iI,vw as iJ,bL as iK,Ii as iL,xPe as iM,bs as iN,to as iO,bl as iP,jNe as iQ,Lle as iR,_s as iS,qx as iT,WNe as iU,lGe as iV,$A as iW,sTe as iX,cj as iY,Vi as iZ,G8e as i_,$G as ia,EG as ib,KOe as ic,y0e as id,bo as ie,H0e as ig,Hq as ih,MSe as ii,Np as ij,wt as ik,Bu as il,oE as im,Tt as io,BAe as ip,Ws as iq,xH as ir,Eae as is,v4 as it,g8e as iu,y8e as iv,z9e as iw,jDe as ix,OEe as iy,Y9e as iz,l as j,c9e as j$,XF as j0,qF as j1,VF as j2,hje as j3,nj as j4,rFe as j5,Lce as j6,Pce as j7,rDe as j8,wDe as j9,Cye as jA,aH as jB,sge as jC,oge as jD,_Fe as jE,FF as jF,sFe as jG,aV as jH,gX as jI,vm as jJ,q8e as jK,qme as jL,zV as jM,RNe as jN,ANe as jO,CSe as jP,$Se as jQ,tje as jR,cje as jS,uje as jT,sle as jU,GA as jV,nle as jW,RSe as jX,gDe as jY,AB as jZ,Op as j_,Ax as ja,k$ as jb,Jbe as jc,Tje as jd,Ije as je,xje as jf,$J as jg,Ki as jh,Mpe as ji,LF as jj,U6e as jk,JF as jl,WF as jm,fje as jn,nje as jo,iZ as jp,sZ as jq,tZ as jr,v1 as js,L_ as jt,IDe as ju,LG as jv,mce as jw,xce as jx,Kx as jy,eDe as jz,k,JA as k$,O_e as k0,COe as k1,ICe as k2,bCe as k3,yw as k4,lDe as k5,DO as k6,d4 as k7,wf as k8,VNe as k9,LSe as kA,YJ as kB,KJ as kC,NOe as kD,oUe as kE,Kje as kF,kTe as kG,KF as kH,j6e as kI,i9 as kJ,r9 as kK,Sl as kL,O6e as kM,Y4 as kN,px as kO,R6e as kP,P6e as kQ,eW as kR,C6e as kS,awe as kT,EF as kU,Jn as kV,ZA as kW,WA as kX,ZFe as kY,KFe as kZ,YA as k_,UV as ka,FDe as kb,Qr as kc,Hd as kd,Zd as ke,u_e as kf,A9e as kg,TB as kh,iDe as ki,xK as kj,Pr as kk,FV as kl,Tr as km,gO as kn,sD as ko,Ove as kp,d6e as kq,Gx as kr,sme as ks,cB as kt,YG as ku,GNe as kv,Jf as kw,uxe as kx,XJ as ky,Wn as kz,i6e as l,FP as l$,Oo as l0,k6e as l1,qn as l2,N6e as l3,rR as l4,M6e as l5,E6e as l6,Br as l7,AF as l8,Kbe as l9,QTe as lA,FM as lB,XIe as lC,oY as lD,KIe as lE,oMe as lF,X3e as lG,QIe as lH,_7e as lI,xY as lJ,Z3e as lK,JIe as lL,u3e as lM,GT as lN,kje as lO,rhe as lP,ZNe as lQ,x7e as lR,B3e as lS,s$e as lT,Ro as lU,zje as lV,i$e as lW,NP as lX,T3e as lY,mY as lZ,gY as l_,H8e as la,MA as lb,t_e as lc,oq as ld,W8e as le,Xle as lf,x0e as lg,f0e as lh,m0e as li,nJ as lj,Hae as lk,_Oe as ll,J1e as lm,y7e as ln,m7e as lo,JZ as lp,CP as lq,d7e as lr,f7e as ls,AP as lt,Nm as lu,bIe as lv,vt as lw,TR as lx,IR as ly,Ma as lz,EVe as m,BDe as m$,lm as m0,I3e as m1,_3e as m2,zT as m3,bp as m4,uFe as m5,TFe as m6,Sp as m7,xl as m8,rI as m9,LV as mA,Wx as mB,Ra as mC,Kce as mD,Lpe as mE,eB as mF,Pfe as mG,Rfe as mH,yxe as mI,ome as mJ,Ml as mK,lf as mL,UFe as mM,oS as mN,xi as mO,D4 as mP,oFe as mQ,P9e as mR,x6 as mS,I6 as mT,Dxe as mU,u5 as mV,w1 as mW,oEe as mX,Mje as mY,HDe as mZ,VDe as m_,u8e as ma,rX as mb,VK as mc,iX as md,WCe as me,yVe as mf,nOe as mg,Iv as mh,mVe as mi,$v as mj,D6e as mk,e4e as ml,bd as mm,wd as mn,VFe as mo,v2e as mp,g2e as mq,BG as mr,ame as ms,v8e as mt,fv as mu,$O as mv,O0e as mw,A0e as mx,cpe as my,E0e as mz,Bx as n,eGe as n$,GDe as n0,zDe as n1,Ks as n2,QDe as n3,UDe as n4,Xje as n5,hFe as n6,XRe as n7,pX as n8,DK as n9,R9 as nA,C9 as nB,S9e as nC,_9e as nD,x9e as nE,T9e as nF,H_e as nG,O9 as nH,OFe as nI,KRe as nJ,oL as nK,eI as nL,Tv as nM,ju as nN,qu as nO,h9e as nP,AFe as nQ,cFe as nR,pFe as nS,RFe as nT,LFe as nU,PFe as nV,bFe as nW,IFe as nX,PX as nY,ym as nZ,kFe as n_,NFe as na,DFe as nb,FFe as nc,jFe as nd,MFe as ne,EFe as nf,$Fe as ng,QSe as nh,tNe as ni,SFe as nj,xFe as nk,CFe as nl,tFe as nm,R5 as nn,tE as no,cG as np,vW as nq,p9e as nr,bJ as ns,E9e as nt,_J as nu,m9e as nv,f9e as nw,$9e as nx,y9e as ny,A9 as nz,hf as o,nx as o$,zNe as o0,oSe as o1,yje as o2,gM as o3,vM as o4,AG as o5,HSe as o6,hSe as o7,gSe as o8,ESe as o9,MD as oA,Vje as oB,LZ as oC,jje as oD,T7e as oE,ig as oF,e7 as oG,DM as oH,MY as oI,Rm as oJ,Q$ as oK,Sye as oL,kDe as oM,vZ as oN,Fo as oO,PUe as oP,OUe as oQ,B5e as oR,Pp as oS,G5e as oT,u4 as oU,R2 as oV,Qje as oW,$ye as oX,SPe as oY,Tye as oZ,rx as o_,pje as oa,PIe as ob,U9e as oc,j9e as od,$U as oe,o0 as of,Nje as og,I7e as oh,nr as oi,rP as oj,uTe as ok,Oje as ol,iP as om,mTe as on,km as oo,Pje as op,Fje as oq,lMe as or,wj as os,Wy as ot,M7e as ou,vj as ov,gj as ow,Gje as ox,Dje as oy,Uje as oz,zu as p,s4e as p$,cv as p0,sNe as p1,hGe as p2,Vv as p3,Ge as p4,J7 as p5,t7e as p6,e7e as p7,ZTe as p8,YTe as p9,d9e as pA,lFe as pB,aFe as pC,I9e as pD,rF as pE,oF as pF,w9e as pG,b9e as pH,xF as pI,N6 as pJ,$6 as pK,E6 as pL,A6 as pM,Z6 as pN,SF as pO,IF as pP,D6 as pQ,uT as pR,yDe as pS,g9e as pT,v9e as pU,L6e as pV,nFe as pW,iFe as pX,M9e as pY,oNe as pZ,Rpe as p_,f4 as pa,Lye as pb,kye as pc,ike as pd,tDe as pe,q6 as pf,U6 as pg,Mce as ph,V6 as pi,W_e as pj,iF as pk,G6 as pl,xDe as pm,J6 as pn,pF as po,hF as pp,dF as pq,Upe as pr,nDe as ps,Ace as pt,fF as pu,sDe as pv,M8e as pw,FK as px,$Oe as py,xa as pz,Ue as q,o4e as q0,due as q1,b8e as q2,_8e as q3,J0e as q4,W0e as q5,VCe as q6,S8e as q7,Q8e as q8,t6e as q9,l6e as qa,c6e as qb,h6e as qc,t9e as qd,o9e as qe,Aje as qf,Rje as qg,lUe as qh,oAe as qi,xGe as qj,RVe as r,z as s,WO as t,r6e as u,Tf as v,Up as w,J9e as x,p as y,n0 as z};
